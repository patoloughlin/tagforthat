{"count":30243,"tag":"winforms","questions":[{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13281048,"title":"C# Updating form (richTextBox and toolStripStatusLabel) from Program thread","body":"<p>I'm trying to take a console application and build a gui for it. I've got the main functions of my GUI working and added the console application files to my new project. I changed the namespace of the files to match that of the winform application and moved the main function of the console application into the Program class defining it as a function taking a CSV path argument which it gets from the form.</p>\n\n<p>So it appears that program it functioning but Im having trouble getting the form to update. There are some Console.WriteLine() functions that I want to write to the toolStripStatusLabel and others to the richTextBox.</p>\n\n<p>I'm new to C# and the main program wasnt written by me but Im trying to build on it.</p>\n\n<p>Program.cs</p>\n\n<pre><code>Form1 Frm1 = new Form1();\nFrm1.UpdateStatusBar(\"Sorted jobs by EDD....\");\nFrm1.Refresh();\n</code></pre>\n\n<p>Form1.cs</p>\n\n<pre><code>public void UpdateStatusBar(string status)\n{\n    Form1 Frm1 = new Form1();\n    Frm1.toolStripStatusLabel1.Text = status;  \n}\n</code></pre>\n\n<p><a href=\"http://pastebin.com/HjnJ1YcF\" rel=\"nofollow\">Pastebin Program.cs</a>\nSee line 92.</p>\n\n<p><a href=\"http://pastebin.com/PyPEsmRD\" rel=\"nofollow\">Pastebin Form1.cs</a>\nSee line 88.</p>\n"},{"tags":["c#","winforms","caching","singleton"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13280912,"title":"Designing a caching schema for Winforms","body":"<p>I have a Winform application that I am trying to implement caching in order to speed up the process of reading data everytime one of my class methods get called. I am thinking of using a Singleton-like approach. I am thinking of something like this:</p>\n\n<pre><code>public class MyCache {\n    private MyDataClass _cacheData;\n    private static MyCache _cache;\n\n    public static MyCache CreateCache()\n    {\n        return _cache ?? new MyCache();\n    }\n\n    public void CacheData(MyDataClass data)\n    {\n        _cache = data;\n    }\n\n    public MyDataClass GetCache()\n    {\n        return _cache;\n    } \n}\n</code></pre>\n\n<p>Can someone tell me if this approach is good or if there is a better approach I should use?</p>\n"},{"tags":["vb.net","winforms","events","event-handling"],"answer_count":9,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":6157,"score":3,"question_id":4129925,"title":"Form.Load Event not firing, form showing","body":"<p>I fear that there is something obviously wrong with my code, but I have come across a situation where the <code>Form.Load</code> event is not firing when I create and show my form. The form is not subclassed (as I've seen some problems with that in some searches), and I am not getting any errors thrown when I step through the code in the debugger.</p>\n\n<p>I have a break point set on the IDE-created form load function (which does have the <code>Handles MyBase.Load</code> signature suffix) but the breakpoint is never reached and the form does display and work.</p>\n\n<p>The form is passed three arguments in the constructor but the <code>IntializeComponent()</code> function is called before anything else is done.</p>\n\n<pre><code>Public Sub New(ByVal argA As Object, ByVal argB As Object, ByVal mode As FormMode)\n\n    ' This call is required by the Windows Form Designer.\n    InitializeComponent()\n\n    ' Other code here,\n    ' No errors generated\n    '\n\nEnd Sub\n</code></pre>\n\n<p>The form load function is as follows, (but this is never actually executed as the event is not fired)</p>\n\n<pre><code>Private Sub frmInstrumentEditor_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load\n    If Not argA Is Nothing Then ' argA set in constructor\n          ' Operations using argA\n    End If\nEnd Sub\n</code></pre>\n\n<p>I might add I am using some databinding with some controls and the argA object, but if this was producing an error I thought I would have seen this (I have CLR Execpetions settings set to Thown in the debugger > exceptions winodw)</p>\n\n<p>Any ideas why this might be occurring?</p>\n\n<p>Your help is greatly appreciated!</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","database","winforms","data-binding"],"answer_count":5,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":847,"score":6,"question_id":5209661,"title":"C# - Should i use databinding?","body":"<p>Im developing applications in C# winforms, and have gone down the path of databinding my grids using a bindingsource. My question is:</p>\n\n<p>Is this the best approach to take? Should i manually populate the cells instead of letting the binding source do it for me? Could it lead to problems further down the track?</p>\n\n<p>If there any any situations where databinding would create issues that would be useful.</p>\n\n<p>One of my colleagues swears black and blue to NOT use databinding. I dont really trust what he says, so any pros/cons would be valuable.</p>\n\n<p>EDIT: In the situation of a multi-user applications connecting to a single database and editable datagrids, how would you solve concurrency issues for updating of data?</p>\n\n<p>Thanks</p>\n"},{"tags":["winforms","c#-4.0","uri","webclient"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13247435,"title":"WebClient returns 404 error, but this url works in the WebBrowser.Navigate method","body":"<p>I try to download a html file using <code>WebClient</code>. </p>\n\n<p>This is my code:</p>\n\n<pre><code>public string GetWebData(string url)\n{\n        string html = string.Empty;\n\n        using (WebClient client = new WebClient())\n        {\n            Uri innUri = null;\n            Uri.TryCreate(url, UriKind.RelativeOrAbsolute, out innUri);\n\n            try\n            {\n                client.Headers.Add(\"Accept-Language\", \" en-US\");\n                client.Headers.Add(\"Accept-Encoding\", \"gzip, deflate\");\n                client.Headers.Add(\"Accept\", \" text/html, application/xhtml+xml, */*\");\n                client.Headers.Add(\"User-Agent\", \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)\");\n\n                using (StreamReader str = new StreamReader(client.OpenRead(innUri)))\n                {\n                    html = str.ReadToEnd();\n                }\n            }\n            catch (WebException we)\n            {\n                throw we;\n            }\n\n            return html;\n        }\n    }\n</code></pre>\n\n<p>The URL is  <code>http://www.paginegialle.it/roma-rm/abbigliamento/alberto-aspesi-c</code>.</p>\n\n<p><img src=\"http://i.stack.imgur.com/PW7EL.png\" alt=\"enter image description here\"></p>\n\n<p>But I can navigate to this URL in IE9 and Firefox and Chrome browsers without problem. I use  Fiddler to solve this problem.</p>\n\n<p>I find the URL has changed after the <code>WebClient.Request</code> - see the image below:</p>\n\n<p>Actual url: <code>http://www.paginegialle.it/roma-rm/abbigliamento/alberto-aspesi-c.</code></p>\n\n<p><img src=\"http://i.stack.imgur.com/AbsqM.png\" alt=\"enter image description here\"></p>\n\n<p><img src=\"http://i.stack.imgur.com/jxmfA.jpg\" alt=\"enter image description here\"></p>\n\n<p>Please see the difference. I remove the dot in at the end of the url. But it's not working in the browsers (IE9, Firefox, Chrome). How to change the actual url to this url?</p>\n\n<p>Please help me.</p>\n"},{"tags":["c#",".net","winforms","krypton-toolkit"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1112,"score":2,"question_id":7916607,"title":"How to deselect the text of a combobox","body":"<p>I have a krypton combo box which I data bind with a list of key-value pairs. What's happening is that when i set the selected item in code, it is highlighting the text. How can i prevent this or deselect the text?</p>\n\n<p>I've tried </p>\n\n<pre><code>// 1\ncombo.Select(0,0);\n// 2\ncombo.Focus();\nanotherControl.Focus();\n// 3\ncombo.SelectionStart = 0;\ncombo.SelectionLength = combo.Text.Length;\n// 4 \ncombo.SelectionStart = combo.Text.Length;\ncombo.SelectionLength = 0;\n</code></pre>\n\n<p>Nothing wants to work.\nAny help appreciated.</p>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13279380,"title":"Prevent form loading until user input","body":"<p>So, management has decided to implement an idea to allow the user to choose the language for the program.  And the way they want it is, in my opinion, silly.  But, I can't change their mind.  Here's how it works.  The main form(<code>frmMain</code>) will start to load.  Before the <code>InitializeComponent()</code>, they want another form(<code>frmLanguage</code>) to load asking the user to select a language.  Now, I can get frmLanguage to pop up at the proper time.  My problem is, how do I prevent or pause frmMain from continuing to load once I've got frmLanguage displayed?</p>\n\n<pre><code>public FrmMain()\n{\n    var language = new FrmLanguage();\n    language.Show();\n\n    // I need to pause the FrmMain right here\n\n    InitializeComponent();\n}\n</code></pre>\n\n<p>I was thinking that threading might be the way to do this, but I've got zero experience with it, so I'm unsure that's even a correct line of thinking.  I don't want to do a <code>Sleep()</code> or similar, cause who knows how long the user will take to enter their choice.  Also, this will be a one-off popup.  I'll be changing a line in a pre-existing INI file so that this won't pop up if they've already selected a language.  Thanks for any and all help.</p>\n"},{"tags":["c#","winforms","chartfx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13035381,"title":"How to put ellipsis at the axis of chartfx graph?","body":"<p>I'm working on ChartFX for windows forms, have a problem. My application must works on screens that have an small size (i.e. 1440x900), I need to display several charts on the same screen (I cannot change it). So, when it happens the axis labels of my charts (charts of the ChartFX) looks cutted.</p>\n\n<p>Somebody does know how a can add ellipsis instead cut labels for the axis labels using chartFX ?</p>\n"},{"tags":[".net","winforms","text","drawing"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":84,"score":1,"question_id":8232954,"title":"What TextFormatFlags.TextBoxControl flag exactly does","body":"<p>I would like to understand what effect has enablig the flag <a href=\"http://msdn.microsoft.com/en-us/library/system.windows.forms.textformatflags%28v=vs.80%29.aspx\" rel=\"nofollow\">TextFormatFlags.TextBoxControl</a> when using the <a href=\"http://msdn.microsoft.com/en-us/library/w3cdh3zw.aspx\" rel=\"nofollow\">TextRenderer.DrawText</a> method is called.</p>\n\n<p>I have written an small program and I can't see difference between using it and don't using it.</p>\n\n<p>Also, I inpected the code with the .NET reflector and the flag is passed directly to the native method so I could see what is the effect.</p>\n"},{"tags":["vb.net","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":23,"score":2,"question_id":13184082,"title":"Panel Controls to Image","body":"<p>I am trying to save the contents of a panel to an image which is displayed on a picturebox.  I am using the drawtobitmap method as shown below:</p>\n\n<pre><code>Private Sub Button3_Click(sender As System.Object, e As System.EventArgs) Handles Button3.Click\n\n    Dim bmp As New Bitmap(Panel1.Width, Panel1.Height)\n    Panel1.DrawToBitmap(bmp, Panel1.ClientRectangle)\n    PictureBox1.BackgroundImage = bmp\n\nEnd Sub\n</code></pre>\n\n<p>The picturebox displays the image however the draw order is incorrect.</p>\n\n<p><img src=\"http://i.stack.imgur.com/uzrEc.png\" alt=\"enter image description here\"></p>\n\n<p>The box on the left is the panel with 3 buttons. The box on the right is the picturebox. Notice how the ordering differs. Does anyone have any suggestion of how to fix this so the ordering is the same as it appears on the panel?</p>\n"},{"tags":["c#","winforms",".net-4.5"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13278888,"title":"c# winforms - is InitializeComponent() function calling while refresh?","body":"<p>I want to ask about function <code>InitializeComponent()</code>. Is called after <code>Invalidate()</code> - invalidating component?</p>\n\n<p>Version: .net 4.5, VS 2012</p>\n"},{"tags":[".net","winforms","tabs","tabcontrol","delphi-prism"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13278682,"title":"How to display only tabs control header using Tabcontrol?","body":"<p>I only want tabs not the tabpages. So, how do you hide or delete tabpages but not the tab control headers? I just need tabs only.</p>\n\n<p>I am working with Framework 3.5.</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":76,"score":2,"question_id":11983111,"title":"Detect when new display is connected","body":"<p>I'm writing an application that requires two displays: one for the control panel, the other for the output. What I have is this: if there's only one display, the application shows both forms on it but if there are two, the output form goes to the other.\nThe problem is that this only happens when the application is started. In other words, if the application is already running before the second display is connected, nothing happens unless the user sends the output to the new display manually (assuming they know how to do it).\nWhat I want is that when a new display is connected, the output form is automatically sent to it even while the application is running. I think it has to do with polling a port in a thread but I don't know how to do it. Can anyone help with how to do it? If there is a better solution, I'll gladly welcome it.</p>\n\n<p>(I would have provided some part of the code but I'm typing this from a phone)</p>\n"},{"tags":["c#","winforms","messagebox"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13277952,"title":"Message Boxes Modal","body":"<p>I've been working at this on and off for a while but essentially I have a class that I call to display message boxes. </p>\n\n<p>I'm trying to get my message boxes to be modal, which is easily done if you specify the form to be modal to. </p>\n\n<p>So my form is declared like this</p>\n\n<pre><code>public partial class MainForm : Form\n</code></pre>\n\n<p>and it is instantiated like this</p>\n\n<pre><code>var mainForm = new MainForm();\n</code></pre>\n\n<p>So I have a class that contains methods which open message boxes like this</p>\n\n<pre><code>MainForm.ActiveForm.Invoke(new MethodInvoker(delegate\n{\n    MessageBox.Show(MainForm.ActiveForm, message, title, buttons, icon);\n}));\n</code></pre>\n\n<p>This works fine, but active form only works when the form is active.....</p>\n\n<p>Anyways is there an easy way around this?</p>\n"},{"tags":["winforms","usercontrols","bindingsource"],"answer_count":5,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":3312,"score":6,"question_id":982376,"title":"Using a BindingSource in a UserControl","body":"<p>I have a UserControl with multiple fields that I would like to have bound to a BindingSource.  I would also like the UserControl to expose some BindingSource property so that it can be dropped on a Form and be bound to the BindingSource on the form.  Is there an easy way to do this?  I realize that I can rebind all of the controls of the UserControl in its BindSource setter.  But this seems wrong.  Is there some BindingSource Proxy that will let me link the BindingSource in the user control to the BindingSource in the form?</p>\n"},{"tags":[".net","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13277070,"title":"How can I prevent my disabled winform from losing focus when returning from a dialog","body":"<p>I have a .net winforms application, where multiple forms are displayed at one time. One form is routinley disabled (this.enabled = false;). During this time, the form creates and shows a custom modal dialog. When the dialog is closed, the original form, the one that is disabled, loses focus. I removed the code that set the form as disabled, and when I tested that, the form kept the focus after returning from the dialog. Is there any way to have a disabled form open up a modal custom dialog, and then stay focused and on top of the other forms when the dialog is closed? </p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13276973,"title":"Fisrt line of private void listBox1_SelectedIndexChanged(object sender, EventArgs e) always gets an error","body":"<p>im trying delete an item on a listbox but when I press the button to delete it the first line of the code in the private void listBox1_SelectedIndexChanged(object sender, EventArgs e) gets an error.</p>\n\n<pre><code>private void listBox1_SelectedIndexChanged(object sender, EventArgs e)\n  {\n      textBox1.Text = listBox1.SelectedItem.ToString();   \n  }\n</code></pre>\n\n<p>here is the error\nObject reference not set to an instance of an object.</p>\n"},{"tags":["c#","winforms","treeview"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":753,"score":3,"question_id":10362988,"title":"Treeview flickering?","body":"<p>I came to know that by adding TreeView.BeginUpdate will prevent flickering of treeview, but when i added it in to my project all nodes of my treeview disappears, Can any body tell me why it happens, here is the code snippet where i used TreeView.BeginUpdate and TreeView.EndUpdate</p>\n\n<pre><code>  TreeNode treeNode = new TreeNode(\"Windows\");\n        treeView1.Nodes.Add(treeNode);\n        //\n        // Another node following the first node.\n        //\n        treeNode = new TreeNode(\"Linux\");\n        treeView1.Nodes.Add(treeNode);\n        //\n        // Create two child nodes and put them in an array.\n        // ... Add the third node, and specify these as its children.\n        //\n        TreeNode node2 = new TreeNode(\"C#\");\n        TreeNode node3 = new TreeNode(\"VB.NET\");\n        TreeNode[] array = new TreeNode[] { node2, node3 };\n        //\n        // Final node.\n        //\n        treeNode = new TreeNode(\"Dot Net Perls\", array);\n        treeView1.Nodes.Add(treeNode);\n</code></pre>\n"},{"tags":["c#","winforms","visual-studio-2010",".net-4.0","listbox"],"answer_count":5,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":5794,"score":1,"question_id":6504336,"title":"Get the value for a listbox item by index","body":"<p>This must be very easy but I am stuck.\nI have a listbox with X Items. Each Item has a text description (Whhich appears in the listbox) and its value(numerical). \nI want to be able to get the value property for an item, using the index number of the item.</p>\n"},{"tags":["c#",".net","vb.net","winforms","exception"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13276201,"title":"PDB file and error handling?","body":"<p>We have a windows form application running across different customers, when they get errors we log into a database &amp; using that stack information that is logged, we correct the issue.</p>\n\n<p>However there are issues that occur only in production, the stack shows for example</p>\n\n<blockquote>\n  <p>CalculateTotals(method name) :NullReferenceException: Object reference not set to instance of an object.</p>\n</blockquote>\n\n<p>The CalculateTotals is a method name, that has lots of sub-method calls &amp; more lines, i am not able to get the exact line # of the code where it fails.</p>\n\n<p>My application's PDB file is not sent to customers (when they do installation),</p>\n\n<p>how do i keep a copy of that .PDB file (may be in a remote location and \nnot make it part of installation) and use that to \ndebug the errors &amp; get the exact line?</p>\n"},{"tags":["c++","winforms","visual-c++"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":27,"score":-1,"question_id":13274989,"title":"Get variable from another form in Visual C++","body":"<p>I need to get a variable from another form in VC++. Here is the code I'm using:</p>\n\n<pre><code>Form1^ form1=Form1();\nMessageBox::Show(\"C: \"+region+\" IC: \"+form1-&gt;ItemCount);\n</code></pre>\n\n<p>Here is what happens when I build:</p>\n\n<pre><code>    1&gt;------ Build started: Project: Mario Kart Wii Hacking Tool 2, Configuration: Debug Win32 ------\n1&gt;  IM_P_2.cpp\n1&gt;c:\\users\\hannulat\\documents\\visual studio 2010\\projects\\mario kart wii hacking tool 2\\mario kart wii hacking tool 2\\Form1.h(118): error C2065: 'IM_P_2' : undeclared identifier\n1&gt;c:\\users\\hannulat\\documents\\visual studio 2010\\projects\\mario kart wii hacking tool 2\\mario kart wii hacking tool 2\\Form1.h(118): error C2065: 'im_p_2' : undeclared identifier\n1&gt;c:\\users\\hannulat\\documents\\visual studio 2010\\projects\\mario kart wii hacking tool 2\\mario kart wii hacking tool 2\\Form1.h(118): error C2061: syntax error : identifier 'IM_P_2'\n1&gt;c:\\users\\hannulat\\documents\\visual studio 2010\\projects\\mario kart wii hacking tool 2\\mario kart wii hacking tool 2\\Form1.h(119): error C2065: 'im_p_2' : undeclared identifier\n1&gt;c:\\users\\hannulat\\documents\\visual studio 2010\\projects\\mario kart wii hacking tool 2\\mario kart wii hacking tool 2\\Form1.h(119): error C2227: left of '-&gt;Show' must point to class/struct/union/generic type\n1&gt;          type is ''unknown-type''\n1&gt;c:\\users\\hannulat\\documents\\visual studio 2010\\projects\\mario kart wii hacking tool 2\\mario kart wii hacking tool 2\\IM_P_2.h(159): error C2440: 'initializing' : cannot convert from 'MarioKartWiiHackingTool2::Form1' to 'MarioKartWiiHackingTool2::Form1 ^'\n1&gt;          No user-defined-conversion operator available, or\n1&gt;          No user-defined-conversion operator available that can perform this conversion, or the operator cannot be called\n1&gt;  Mario Kart Wii Hacking Tool 2.cpp\n1&gt;c:\\users\\hannulat\\documents\\visual studio 2010\\projects\\mario kart wii hacking tool 2\\mario kart wii hacking tool 2\\IM_P_2.h(159): error C2065: 'Form1' : undeclared identifier\n1&gt;c:\\users\\hannulat\\documents\\visual studio 2010\\projects\\mario kart wii hacking tool 2\\mario kart wii hacking tool 2\\IM_P_2.h(159): error C2065: 'form1' : undeclared identifier\n1&gt;c:\\users\\hannulat\\documents\\visual studio 2010\\projects\\mario kart wii hacking tool 2\\mario kart wii hacking tool 2\\IM_P_2.h(159): error C3861: 'Form1': identifier not found\n1&gt;c:\\users\\hannulat\\documents\\visual studio 2010\\projects\\mario kart wii hacking tool 2\\mario kart wii hacking tool 2\\IM_P_2.h(160): error C2065: 'form1' : undeclared identifier\n1&gt;c:\\users\\hannulat\\documents\\visual studio 2010\\projects\\mario kart wii hacking tool 2\\mario kart wii hacking tool 2\\IM_P_2.h(160): error C2227: left of '-&gt;ItemCount' must point to class/struct/union/generic type\n1&gt;          type is ''unknown-type''\n1&gt;c:\\users\\hannulat\\documents\\visual studio 2010\\projects\\mario kart wii hacking tool 2\\mario kart wii hacking tool 2\\Form1.h(118): error C3673: 'MarioKartWiiHackingTool2::IM_P_2' : class does not have a copy-constructor\n1&gt;  Generating Code...\n========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ==========\n</code></pre>\n\n<p>What do I do?</p>\n\n<p>EDIT:\nThis is my Form1.h:\nIt is the first form shown (I add random things 'cause SO needs more explanations)</p>\n\n<pre><code>#pragma once\n#include &lt;float.h&gt;\n#include \"IM_P_2.h\"\nnamespace MarioKartWiiHackingTool2 {\n\n    using namespace System;\n    using namespace System::ComponentModel;\n    using namespace System::Collections;\n    using namespace System::Windows::Forms;\n    using namespace System::Data;\n    using namespace System::Drawing;\n\n    /// &lt;summary&gt;\n    /// Summary for Form1\n    /// &lt;/summary&gt;\n    public ref class Form1 : public System::Windows::Forms::Form\n    {\n    public:\n        Form1(void)\n        {\n            InitializeComponent();\n            //\n            //TODO: Add the constructor code here\n            //\n        }\n        int ItemCount;\n\n    protected:\n        /// &lt;summary&gt;\n        /// Clean up any resources being used.\n        /// &lt;/summary&gt;\n        ~Form1()\n        {\n            if (components)\n            {\n                delete components;\n            }\n        }\n    private: System::Windows::Forms::Label^  label1;\n    protected: \n    private: System::Windows::Forms::TextBox^  textBox1;\n    private: System::Windows::Forms::Button^  button1;\n\n    private:\n        /// &lt;summary&gt;\n        /// Required designer variable.\n        /// &lt;/summary&gt;\n        System::ComponentModel::Container ^components;\n\n#pragma region Windows Form Designer generated code\n        /// &lt;summary&gt;\n        /// Required method for Designer support - do not modify\n        /// the contents of this method with the code editor.\n        /// &lt;/summary&gt;\n        void InitializeComponent(void)\n        {\n            this-&gt;label1 = (gcnew System::Windows::Forms::Label());\n            this-&gt;textBox1 = (gcnew System::Windows::Forms::TextBox());\n            this-&gt;button1 = (gcnew System::Windows::Forms::Button());\n            this-&gt;SuspendLayout();\n            // \n            // label1\n            // \n            this-&gt;label1-&gt;AutoSize = true;\n            this-&gt;label1-&gt;Location = System::Drawing::Point(13, 13);\n            this-&gt;label1-&gt;Name = L\"label1\";\n            this-&gt;label1-&gt;Size = System::Drawing::Size(242, 13);\n            this-&gt;label1-&gt;TabIndex = 0;\n            this-&gt;label1-&gt;Text = L\"How many items do you want for your item wheel\\?\";\n            // \n            // textBox1\n            // \n            this-&gt;textBox1-&gt;Location = System::Drawing::Point(16, 30);\n            this-&gt;textBox1-&gt;Name = L\"textBox1\";\n            this-&gt;textBox1-&gt;Size = System::Drawing::Size(100, 20);\n            this-&gt;textBox1-&gt;TabIndex = 1;\n            // \n            // button1\n            // \n            this-&gt;button1-&gt;Location = System::Drawing::Point(123, 30);\n            this-&gt;button1-&gt;Name = L\"button1\";\n            this-&gt;button1-&gt;Size = System::Drawing::Size(75, 23);\n            this-&gt;button1-&gt;TabIndex = 2;\n            this-&gt;button1-&gt;Text = L\"Continue\";\n            this-&gt;button1-&gt;UseVisualStyleBackColor = true;\n            this-&gt;button1-&gt;Click += gcnew System::EventHandler(this, &amp;Form1::button1_Click);\n            // \n            // Form1\n            // \n            this-&gt;AutoScaleDimensions = System::Drawing::SizeF(6, 13);\n            this-&gt;AutoScaleMode = System::Windows::Forms::AutoScaleMode::Font;\n            this-&gt;ClientSize = System::Drawing::Size(284, 74);\n            this-&gt;Controls-&gt;Add(this-&gt;button1);\n            this-&gt;Controls-&gt;Add(this-&gt;textBox1);\n            this-&gt;Controls-&gt;Add(this-&gt;label1);\n            this-&gt;Name = L\"Form1\";\n            this-&gt;Text = L\"Item Wizard\";\n            this-&gt;ResumeLayout(false);\n            this-&gt;PerformLayout();\n\n        }\n#pragma endregion\n    private: System::Void button1_Click(System::Object^  sender, System::EventArgs^  e) {\n                if (textBox1-&gt;Text==\"\") {\n                    MessageBox::Show(\"Enter a number (you didn't enter anything)\");\n                    return;\n                }\n                int d;\n                Int32::TryParse(textBox1-&gt;Text, d);\n                /*if (!d) {\n                    MessageBox::Show(\"failed\");\n                }*/\n                if (!d) {\n                    MessageBox::Show(\"Enter a number (the thing you entered is not a number)\");\n                    return;\n                }\n                ItemCount=d;\n                IM_P_2^ im_p_2=gcnew IM_P_2(this);\n                im_p_2-&gt;Show();\n                this-&gt;Close();\n             }\n    };\n}\n</code></pre>\n\n<p>This is my IM_P_2.h:\nIt is the second form shown (I add random things 'cause SO needs more explanations LOL)</p>\n\n<pre><code>#pragma once\n#include \"Form1.h\"\nnamespace MarioKartWiiHackingTool2 {\n\n    using namespace System;\n    using namespace System::ComponentModel;\n    using namespace System::Collections;\n    using namespace System::Windows::Forms;\n    using namespace System::Data;\n    using namespace System::Drawing;\n\n    /// &lt;summary&gt;\n    /// Summary for IM_P_2\n    /// &lt;/summary&gt;\n    public ref class IM_P_2 : public System::Windows::Forms::Form\n    {\n    public:\n        IM_P_2(void)\n        {\n            InitializeComponent();\n            //\n            //TODO: Add the constructor code here\n            //\n        }\n        int region;\n\n    protected:\n        /// &lt;summary&gt;\n        /// Clean up any resources being used.\n        /// &lt;/summary&gt;\n        ~IM_P_2()\n        {\n            if (components)\n            {\n                delete components;\n            }\n        }\n    private: System::Windows::Forms::RadioButton^  radioButton1;\n    protected: \n    private: System::Windows::Forms::Label^  label1;\n    private: System::Windows::Forms::RadioButton^  radioButton2;\n    private: System::Windows::Forms::RadioButton^  radioButton3;\n    private: System::Windows::Forms::RadioButton^  radioButton4;\n    private: System::Windows::Forms::Button^  button1;\n\n    private:\n        /// &lt;summary&gt;\n        /// Required designer variable.\n        /// &lt;/summary&gt;\n        System::ComponentModel::Container ^components;\n\n#pragma region Windows Form Designer generated code\n        /// &lt;summary&gt;\n        /// Required method for Designer support - do not modify\n        /// the contents of this method with the code editor.\n        /// &lt;/summary&gt;\n        void InitializeComponent(void)\n        {\n            this-&gt;radioButton1 = (gcnew System::Windows::Forms::RadioButton());\n            this-&gt;label1 = (gcnew System::Windows::Forms::Label());\n            this-&gt;radioButton2 = (gcnew System::Windows::Forms::RadioButton());\n            this-&gt;radioButton3 = (gcnew System::Windows::Forms::RadioButton());\n            this-&gt;radioButton4 = (gcnew System::Windows::Forms::RadioButton());\n            this-&gt;button1 = (gcnew System::Windows::Forms::Button());\n            this-&gt;SuspendLayout();\n            // \n            // radioButton1\n            // \n            this-&gt;radioButton1-&gt;AutoSize = true;\n            this-&gt;radioButton1-&gt;Checked = true;\n            this-&gt;radioButton1-&gt;Location = System::Drawing::Point(12, 29);\n            this-&gt;radioButton1-&gt;Name = L\"radioButton1\";\n            this-&gt;radioButton1-&gt;Size = System::Drawing::Size(139, 17);\n            this-&gt;radioButton1-&gt;TabIndex = 0;\n            this-&gt;radioButton1-&gt;TabStop = true;\n            this-&gt;radioButton1-&gt;Text = L\"PAL (Europe / Australia)\";\n            this-&gt;radioButton1-&gt;UseVisualStyleBackColor = true;\n            // \n            // label1\n            // \n            this-&gt;label1-&gt;AutoSize = true;\n            this-&gt;label1-&gt;Location = System::Drawing::Point(13, 13);\n            this-&gt;label1-&gt;Name = L\"label1\";\n            this-&gt;label1-&gt;Size = System::Drawing::Size(132, 13);\n            this-&gt;label1-&gt;TabIndex = 1;\n            this-&gt;label1-&gt;Text = L\"What country do you use\\?\";\n            // \n            // radioButton2\n            // \n            this-&gt;radioButton2-&gt;AutoSize = true;\n            this-&gt;radioButton2-&gt;Location = System::Drawing::Point(12, 53);\n            this-&gt;radioButton2-&gt;Name = L\"radioButton2\";\n            this-&gt;radioButton2-&gt;Size = System::Drawing::Size(96, 17);\n            this-&gt;radioButton2-&gt;TabIndex = 2;\n            this-&gt;radioButton2-&gt;Text = L\"NTSC-U (USA)\";\n            this-&gt;radioButton2-&gt;UseVisualStyleBackColor = true;\n            // \n            // radioButton3\n            // \n            this-&gt;radioButton3-&gt;AutoSize = true;\n            this-&gt;radioButton3-&gt;Location = System::Drawing::Point(12, 77);\n            this-&gt;radioButton3-&gt;Name = L\"radioButton3\";\n            this-&gt;radioButton3-&gt;Size = System::Drawing::Size(100, 17);\n            this-&gt;radioButton3-&gt;TabIndex = 3;\n            this-&gt;radioButton3-&gt;Text = L\"NTSC-J (Japan)\";\n            this-&gt;radioButton3-&gt;UseVisualStyleBackColor = true;\n            // \n            // radioButton4\n            // \n            this-&gt;radioButton4-&gt;AutoSize = true;\n            this-&gt;radioButton4-&gt;Location = System::Drawing::Point(12, 101);\n            this-&gt;radioButton4-&gt;Name = L\"radioButton4\";\n            this-&gt;radioButton4-&gt;Size = System::Drawing::Size(101, 17);\n            this-&gt;radioButton4-&gt;TabIndex = 4;\n            this-&gt;radioButton4-&gt;Text = L\"NTSC-K (Korea)\";\n            this-&gt;radioButton4-&gt;UseVisualStyleBackColor = true;\n            // \n            // button1\n            // \n            this-&gt;button1-&gt;Location = System::Drawing::Point(12, 125);\n            this-&gt;button1-&gt;Name = L\"button1\";\n            this-&gt;button1-&gt;Size = System::Drawing::Size(75, 23);\n            this-&gt;button1-&gt;TabIndex = 5;\n            this-&gt;button1-&gt;Text = L\"Continue\";\n            this-&gt;button1-&gt;UseVisualStyleBackColor = true;\n            this-&gt;button1-&gt;Click += gcnew System::EventHandler(this, &amp;IM_P_2::button1_Click);\n            // \n            // IM_P_2\n            // \n            this-&gt;AutoScaleDimensions = System::Drawing::SizeF(6, 13);\n            this-&gt;AutoScaleMode = System::Windows::Forms::AutoScaleMode::Font;\n            this-&gt;ClientSize = System::Drawing::Size(284, 159);\n            this-&gt;Controls-&gt;Add(this-&gt;button1);\n            this-&gt;Controls-&gt;Add(this-&gt;radioButton4);\n            this-&gt;Controls-&gt;Add(this-&gt;radioButton3);\n            this-&gt;Controls-&gt;Add(this-&gt;radioButton2);\n            this-&gt;Controls-&gt;Add(this-&gt;label1);\n            this-&gt;Controls-&gt;Add(this-&gt;radioButton1);\n            this-&gt;Name = L\"IM_P_2\";\n            this-&gt;Text = L\"Item Wizard\";\n            this-&gt;ResumeLayout(false);\n            this-&gt;PerformLayout();\n\n        }\n#pragma endregion\n    private: System::Void button1_Click(System::Object^  sender, System::EventArgs^  e) {\n                 if (radioButton1-&gt;Checked==true) {\n                     region=0;\n                 }\n                 else if (radioButton2-&gt;Checked==true) {\n                     region=1;\n                 }\n                 else if (radioButton3-&gt;Checked==true) {\n                     region=2;\n                 }\n                 else if (radioButton4-&gt;Checked==true) {\n                     region=3;\n                 }\n                 Form1^ form1=gcnew Form1();\n                 MessageBox::Show(\"C: \"+region+\" IC: \"+form1-&gt;ItemCount);\n             }\n};\n}\n</code></pre>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":32,"score":3,"question_id":13274792,"title":"Filter DataGridView","body":"<p>ive searched the internet for a solution for my problem, me and my studygrp is making a datagridview that takes information from a classLibrary. all that works but now we got to filter it but all i can find is by bindingsource but thats not what i was thinking. i just want a simple filter so that u can enter something in a textbox and it shows it on the datagridview if it contains that information. ive tryed </p>\n\n<pre><code>try\n   {\n      ((DataTable)dataGridView1.DataSource).DefaultView.RowFilter = \"FromColumn like '%\" + textBox1.Text + \"%'\";\n   }\ncatch (Exception) { }\n</code></pre>\n\n<p>but it doesnt work like i want it to hmmn... anyone that can help?</p>\n"},{"tags":["c#","winforms","cmd","cmd.exe"],"answer_count":3,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":394,"score":4,"question_id":11767654,"title":"Sending commands to cmd prompt in C#","body":"<p>For one of my implementations I am working on a tool that is supposed to send/retrieve commands/results to/from the cmd window. Everything works fine but the Use case below fails to do anything. It seems as if my application is waiting for something (instead of displaying the result) </p>\n\n<p>From my tool I navigate to the python folder . From the python folder I try to launch  python.exe but at this point, my editor does not do anything. it simply keeps on waiting. </p>\n\n<p>For your kind consideration I am also linking the video here. It would be easier for you guys to understand what I am trying to say. </p>\n\n<p><a href=\"http://www.youtube.com/watch?v=MkGZOQSMXuM\" rel=\"nofollow\">View the Video here (on youtube)</a></p>\n\n<p>I am also attaching the code that I currently have. </p>\n\n<pre><code>            ProcessStartInfo info = new ProcessStartInfo(\"cmd.exe\");\n\n            string argument = null;\n            if (!string.IsNullOrEmpty(startingDirectory) &amp;&amp; System.IO.Directory.Exists(startingDirectory))\n            {\n               argument += @\"cd\\\";\n            }\n            else\n            {\n                argument += \"\\\"\";\n            }\n            info.Arguments = argument;\n            info.CreateNoWindow = true;\n            info.RedirectStandardError = true;\n            info.RedirectStandardInput = true;\n            info.RedirectStandardOutput = true;\n            info.UseShellExecute = false;\n             this.shellProcess = System.Diagnostics.Process.Start(info);\n            this.shellProcess.EnableRaisingEvents = true;\n            //this.InputStream.AutoFlush = true;\n            this.shellProcess.Exited += new EventHandler(ProcessExited);\n            this.ErrorBeginRead();\n            this.OutputBeginRead();\n\n private void OutputBeginRead()\n    {\n        this.shellProcess.StandardOutput.BaseStream.BeginRead(outputBuffer, 0, outputBuffer.Length, new AsyncCallback(this.OnOutputInput), this.shellProcess);\n    }\n\n        private void ErrorBeginRead()\n    {\n        this.shellProcess.StandardError.BaseStream.BeginRead(errorBuffer, 0, errorBuffer.Length, new AsyncCallback(this.OnErrorInput), this.shellProcess);\n    }\n</code></pre>\n\n<p>Thank you !</p>\n\n<p>EDIT:\nLaunching python is just an example. I need to use the same method for other normal cmd line commands as well.It would be nice, if somebody can point what i am doing wrong with the code that I have  or what I must do , in order to achieve the intended functionality. </p>\n\n<p>EDIT 2 : The normal cmd commands are working perfectly. The command line tools like python,perl are not working .</p>\n\n<p>Edit 3 : So I managed to do move a wee bit forward following Jamie's suggestions. The ui is not \"hanging\" anymore. but when i access the python interpreter , the interpreter's output is still not visible in my tool. Any suggestions why that might be happening ? </p>\n"},{"tags":["winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13275612,"title":"Call method when TextBox changes","body":"<p>I can't figure out how to implement this:</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/system.windows.forms.control.textchanged.aspx?cs-save-lang=1&amp;cs-lang=csharp#code-snippet-1\" rel=\"nofollow\" title=\"TextChanged\">TextChanged Event</a></p>\n\n<p>I just want to call a method when a particular TextBox changes. I'm implementing a suggestions box which searches for what you have typed against a list. So i need to constantly call a method when text box gets changed.</p>\n\n<p>Any help would be greatly appreciated, thanks!</p>\n"},{"tags":["c#",".net","winforms","keyevent"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":26,"score":2,"question_id":13274936,"title":"A Form's key events go missing","body":"<p>I have a bug in my application that I don't know how to how to attack. Basically, key events \"go missing\" after some time. I have added event handlers to KeyDown, KeyPressed and KeyUp that write to the console (both for the Form and one of its TextBoxes). Here's the correct order of things:</p>\n\n<pre><code>control_PreviewKeyDown\nShellForm_KeyDown\ncontrol_KeyDown\nShellForm_KeyPress\ncontrol_KeyPress\nShellForm_KeyUp\ncontrol_KeyUp\n</code></pre>\n\n<p>In the failed state (which I can't reproduce consistently), I get these events when pressing a key (TextBox has focus):</p>\n\n<pre><code>ShellForm_KeyUp\ncontrol_KeyUp\n</code></pre>\n\n<p>Form.KeyPreview is true.</p>\n\n<p>It's the same for all TextBoxes in the Form; they are not disabled and not set to readonly, but it's no longer possible to write text.</p>\n\n<p>Problem is, I don't really know where to begin.</p>\n"},{"tags":["c#","winforms","multithreading","listview"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13274990,"title":"C# Thread ListView","body":"<p>I'm a fairly new to .net and I'm still struggling to understand a lot things, and right now I'm trying to accomplish something relatively simple but I've failed every single time, I would like to add a Thread to my program, this Thread would be responsible to perform the Upload operations to a web server and keep my program responsive providing the feedback of the operations to my users by updating a ListView, where the users would see all the status of the file uploads.</p>\n\n<p>I don't know how to put this Thread inside the program to make it responsive, I couldn't find any examples so far and I'm trying to find a little sample to show me the use of Thread and WinForms in action.</p>\n"},{"tags":["winforms","visual-studio","popup","visual-studio-2012","tooltip"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13274474,"title":"How to create and show a infotip when clickng a label?","body":"<p>I'm using VSTUDIO2012, my problem seems simple but it's too hard for me,</p>\n\n<p><strong>EDIT</strong>: It's a \"windows forms application\"</p>\n\n<p>I have a label and when i click at the label i want to show a little info in a \"infotip\" or \"tooltip\" or \"ballontip\", i want to show a message like for 5-10 seconds... </p>\n\n<p>Someone can guide me about how to make this? or references on the web please? </p>\n\n<p><strong>EDIT2</strong>: I've tried this:</p>\n\n<pre><code>Private Sub Label1_Click(sender As Object, e As EventArgs) Handles Label1.Click\n\n    'MessageBox.Show(\"Use the 'Ctrl+C' hotkey to copy the\" &amp; vbNewLine &amp; \"mouse coordinates into the clipboard.\", \"Mouse XY by Elektro H@cker\")\nEnd Sub\n\nPrivate Sub ToolTip1_Popup(sender As Object, e As PopupEventArgs) Handles ToolTip1.Popup\n    ToolTip1.Show(\"Tooltip text goes here\", Label1)\nEnd Sub\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12403775,"title":"C# get original resource text for control","body":"<p>If I change the text of a button (say, \"Next\" to \"Finish\"), is there a way of finding the original text so I can put it back, by referring to the resources (i.e. retrieve the word \"Next\" from the resources)?</p>\n\n<p>Obviously I could store the original before changing it, but I am curious as to whether there is a more elegant way of referring to it (e.g. in the same way you refer to a resourced string: <code>global::MyProject.Properties.Resources.LeString</code>).</p>\n"},{"tags":["c#","winforms","visual-studio-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13230311,"title":"Why does MS Chart only display x-axis labels for some data points?","body":"<p>When I bind the data to the barchart. I am not able to see the labels in the X-axis for some bars. E.g: i bind four data to the chart. The chart is displaying only 2nd and 4th data label.</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":13260191,"title":"Winforms controls and \"generic\" events handlers. How can I do this?","body":"<p>In the demo of the ObjectListView control there is this code (in the \"Complex Example\" tab page) to allow for a custom editor (a ComboBox) (Adapted to my case and edited for clarity):</p>\n\n<pre><code>EventHandler CurrentEH;\nprivate void ObjectListView_CellEditStarting(object sender,\n                                             CellEditEventArgs e)\n{\n    if (e.Column == SomeCol)\n    {\n        ISomeInterface M = (e.RowObject as ObjectListView1Row).SomeObject; //(1)\n        ComboBox cb = new ComboBox();\n        cb.Bounds = e.CellBounds;\n        cb.DropDownStyle = ComboBoxStyle.DropDownList;\n        cb.DataSource = ISomeOtherObjectCollection;\n        cb.DisplayMember = \"propertyName\";\n        cb.DataBindings.Add(\"SelectedItem\", \n                            M, \"ISomeOtherObject\", false,\n                            DataSourceUpdateMode.Never);\n        e.Control = cb;\n        cb.SelectedIndexChanged += \n            CurrentEH = (object sender2, EventArgs e2) =&gt;\n                M.ISomeOtherObject = \n                    (ISomeOtherObject)((ComboBox)sender2).SelectedValue;   //(2)\n    }\n}\n\nprivate void ObjectListView_CellEditFinishing(object sender,\n                                               CellEditEventArgs e)\n{\n    if (e.Column == SomeCol)\n    {\n        // Stop listening for change events\n        ((ComboBox)e.Control).SelectedIndexChanged -= CurrentEH;\n        // Any updating will have been down in the SelectedIndexChanged\n        // event handler.\n        // Here we simply make the list redraw the involved ListViewItem\n        ((ObjectListView)sender).RefreshItem(e.ListViewItem);\n        // We have updated the model object, so we cancel the auto update\n        e.Cancel = true;\n    }\n}\n</code></pre>\n\n<p>I have too many other columns with combo editors inside objectlistviews to use a copy&amp; paste strategy (besides, copy&amp;paste is a serious source of bugs), so I tried to parameterize the code to keep the code duplication to a minimum. ObjectListView_CellEditFinishing is a piece of cake:</p>\n\n<pre><code>HashSet&lt;OLVColumn&gt; cbColumns = new HashSet&lt;OLVColumn&gt; (new OLVColumn[] { SomeCol, SomeCol2, ...};\n\nprivate void ObjectListView_CellEditFinishing(object sender,\n                                               CellEditEventArgs e)\n{\n    if (cbColumns.Contains(e.Column)) ...\n</code></pre>\n\n<p>but ObjectListView_CellEditStarting is the problematic.</p>\n\n<p>I guess in CellEditStarting I will have to discriminate each case separately:</p>\n\n<pre><code>private void ObjectListView_CellEditStarting(object sender,\n                                             CellEditEventArgs e)\n{\n    if (e.Column == SomeCol)\n        // code to create the combo, put the correct list as the datasource, etc.\n    else if (e.Column == SomeOtherCol)  \n        // code to create the combo, put the correct list as the datasource, etc.\n</code></pre>\n\n<p>And so on.</p>\n\n<p>But how can I parameterize the \"code to create the combo, put the correct list as the datasource, etc.\"? Problem lines are </p>\n\n<p>(1) Get SomeObject. the property NAME varies.</p>\n\n<p>(2) Set ISomeOtherObject, the property name varies too.</p>\n\n<p>The types vary too, but I can cover those cases with a generic method combined with a not so \"typesafe\" API (for instance, the cb.DataBindings.Add and cb.DataSource both use an <code>object</code>)</p>\n\n<p>Reflection? more lambdas? Any ideas? Any other way to do the same?</p>\n\n<p>PS: I want to be able to do something like this:</p>\n\n<pre><code>private void ObjectListView_CellEditStarting(object sender,\n                                             CellEditEventArgs e)\n{\n    if (e.Column == SomeCol)\n        SetUpCombo&lt;ISomeInterface&gt;(ISomeOtherObjectCollection,\n                                   \"propertyName\",\n                                   SomeObject,\n                                   ISomeOtherObject);\n\n    else if (e.Column == SomeOtherCol)  \n        SetUpCombo&lt;ISomeInterface2&gt;(ISomeOtherObject2Collection,\n                                   \"propertyName2\",\n                                   SomeObject2\n                                   ISomeOtherObject2);\n</code></pre>\n\n<p>and so on. Or something like that.</p>\n\n<p>I know, parameters SomeObject and ISomeOtherObject are not real parameters per see, but you get the idea of what I want. I want not to repeat the same code skeleton again and again and again.</p>\n\n<p>One solution would be \"preprocessor generics\" like C's DEFINE, but I don't thing c# has something like that.</p>\n\n<p>So, does anyone have some alternate ideas to solve this?</p>\n"},{"tags":["winforms","visual-studio","forms","visual-studio-2012"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":17,"score":-1,"question_id":13272744,"title":"VSTUDIO2012 How to make a \"borderstyle = none\" form MOVEABLE","body":"<p>I'm learnning vstudio 2012, I'm trying to make moveable a form with \"borderstyle = none\" but i can't.</p>\n\n<p>All the info that i found in Google talks about vb4 5 &amp; 6 about this problem, versions too earlier for me and i cannot use they (I don't know how to).</p>\n\n<p>my declaraments is very simple, i only need to make the window moveable by clicking on the app (anywhere on the form):</p>\n\n<pre><code>Public Class Form1\n\n    Private Sub Timer1_Tick(sender As Object, e As EventArgs) Handles Timer1.Tick\n        Label2.Text = \"X: \" &amp; MousePosition.X\n        Label3.Text = \"Y: \" &amp; MousePosition.Y\n\n    End Sub\n\n    Sub Form1_KeyPress(ByVal sender As Object, _\n      ByVal e As KeyPressEventArgs) Handles Me.KeyPress\n        If e.KeyChar &gt;= ChrW(3) Then\n            Clipboard.SetDataObject(Label2.Text &amp; \" \" &amp; Label3.Text)\n        End If\n    End Sub\n\nEnd Class\n</code></pre>\n\n<p>Any help please? thankyou for read</p>\n"},{"tags":["winforms","visual-c++","c++-cli","close"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13272348,"title":"Closing a form and opening another without closing the application","body":"<p>I want my code to close the current form and open another form without closing the application (in Visual C++ 2010 Express). Here's the code I'm trying to use:</p>\n\n<pre><code>Form2^ form2=gcnew Form2();\nform2-&gt;Show();\nthis-&gt;Close();\n</code></pre>\n\n<p>The application should be closed when all forms have been closed, so <code>this->Hide()</code> won't work.</p>\n"},{"tags":["c#","winforms","listview","listviewitem"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":342,"score":2,"question_id":3356224,"title":"C#: Prevent ListViewItem Image to be rendered selected","body":"<p>I was wondering whether it would be possible to have a ListView, in which items can be selected as usual with one difference. When a ListViewItem is selected, I would like to see the selection in the text label, however I would prefer the image to remain the same. The reason for this is, that currently the blue selection drawn ontop of the image looks horrible (the effect is even worse on transparent images!). </p>\n\n<p>I was hoping of not having to use the DrawItem handler, but I guess the hopes are slim. </p>\n\n<p>thanks a lot, </p>\n\n<p>best</p>\n\n<p>Frank</p>\n\n<p>EDIT: I thought I better add a screenshot showing the issue. I'm using the ListView in LargeIcon mode. </p>\n\n<p>** oups I'm not allowed to add pictures yet * so here the link to it. sorry for the inconvenience. <em>*</em> </p>\n\n<p><a href=\"http://cl.ly/adb9c6d29ffc0e2e1b5e\" rel=\"nofollow\">http://cl.ly/adb9c6d29ffc0e2e1b5e</a></p>\n\n<p>As you can see the selected element is 'Rate vs. Species'. However, I would love for the blue tint on the icon to disappear. </p>\n\n<p>Thanks again. </p>\n"},{"tags":["c#","winforms","clickonce"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":14,"score":2,"question_id":13272174,"title":"ClickOnce deployed application has blinking cursor but no focus","body":"<p>We have an application deployed via ClickOnce which has a weird problem.  When you start the application and we show our login dialog the User name field will have a blinking cursor as if the control has focus but as soon as you start typing nothing happens.  You have to actually click the dialog window to give it focus.  </p>\n\n<p>If you click away again though the User name field won't have a blinking cursor anymore so it's almost like the control has focus but not really?</p>\n\n<p>Has anyone ran into this problem?  We need our app to have focus when it starts...</p>\n\n<p>One thing to mention is we're actually using a UI framework (XF.UI.Smart) which has a ShellPresenter/ShellView idea.  The shell is being hidden while the login dialog shows.  Could this hiding of the main window be the problem?</p>\n"},{"tags":["winforms","c#-4.0","datagridview","datasource"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13269691,"title":"How to change datagridview column width after binding datasource?","body":"<p>How can one change <code>datagridview</code> column <code>width</code>? I have tried the following way but it does not work. Why is it unchanged?</p>\n\n<pre><code>  string[] strArrDoctor = new string[] {\"ID\", \"Name\", \"Specialization\", \"Contact No\", \"Experience(Years)\", \"Delete\" };\n           //strin of array which contains Patient table columns names\n            string[] strArrPatient = new string[] {\"ID\", \"Name\", \"Join Date\", \"Ailment\", \"Doctor ID\", \"Delete\" };\n            if (rBtnDoctor.Checked)\n            {\n                for (int intIndex = 0; intIndex &lt; dgvShowRecords.Columns.Count; intIndex++)\n                {\n                    //assigning Column names with our specified String of arrays\n                    dgvShowRecords.Columns[intIndex].HeaderText = strArrDoctor[intIndex];\n                }\n            }\n            else\n            {\n                for (int intIndex = 0; intIndex &lt; dgvShowRecords.Columns.Count;      intIndex++)\n                {\n                    dgvShowRecords.Columns[intIndex].HeaderText=strArrPatient[intIndex];\n                }\n            }\n            //dgvShowRecords is Datagridview Name\n            dgvShowRecords.Columns[\"Name\"].Resizable = DataGridViewTriState.True;\n            dgvShowRecords.Columns[\"Name\"].Width = 200;\n            dgvShowRecords.Columns[\"ID\"].Width = 20;\n</code></pre>\n\n<p>please anyone know reason why it is unchanged let me know.</p>\n\n<p><img src=\"http://i.stack.imgur.com/FJ4tH.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","wpf","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1915,"score":2,"question_id":4348408,"title":"how to close window form which is hosting WPF user control from within a WPF user control","body":"<p>I want to close a window form that is hosting a WPF user control. Something like this as used while closing a current form in window application. But for WPF application I am not able to get reference to user controls parent</p>\n\n<p>How to get Form which is hosting this control so that I can close my form</p>\n\n<p>this.Close()</p>\n"},{"tags":["c#","winforms","datagridview","telerik"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":13259013,"title":"Compare 2 different columns in the datagridview","body":"<p>In my datagridview, Four columns <code>1&amp;2</code> are read only col <code>3</code> &amp; <code>4</code> got number values. I want to compare that <code>4th</code> col must be greater that <code>3rd</code> column. \nFor example: \n<img src=\"http://i.stack.imgur.com/7fpSh.jpg\" alt=\"enter image description here\"></p>\n\n<p>If the <code>4</code> col value is less than the 3rd column then I want to propose message doesn't navigate to another control. </p>\n\n<p>My simple approach seems not working. How can i compare 2 specific columns for this kind of condition??</p>\n\n<pre><code>    private void datagridview_CellValidating(object sender, CellValidatingEventArgs e)\n    {\n        try\n        {\n\n            int bbor = datagridview.CurrentCell.ColumnIndex;\n            int ebor = datagridview.CurrentCell.RowIndex;\n            if (ebor &lt;= bbor)\n            {\n                MessageBox.Show(\"Please verify the value\");\n                e.Cancel = true;\n            }\n        }\n        catch (Exception exception)\n        {\n\n        }\n\n    }\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13271858,"title":"Can't see class within DLL","body":"<p>I have created a DLL to house a class that I want to use across multiple applications, as well the DBML created by LINQ.</p>\n\n<p>The problem I am having is that the class is not visible/usable from external applications when the compiled DLL is set as a reference, although all the LINQ objects are. Also, when I manually import the .cs file then I can use the class as expected.</p>\n\n<p>I have built the class as static, and the code is as follows:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\n\nusing System.ComponentModel;\nusing System.Data;\n\nnamespace OsgShared\n{\n    static class GlobalClass\n    {\n        public static USER CurrentUser { get; set; }\n\n        private static Dictionary&lt;string,int&gt; _SysDetIDs;\n        public static Dictionary&lt;string,int&gt; SysDetIDs { get { return _SysDetIDs; } }\n\n        private static Dictionary&lt;string, int&gt; _AccInfoTypeIDs;\n        public static Dictionary&lt;string, int&gt; AccInfoTypeIDs { get { return _AccInfoTypeIDs; } }\n\n        private static Dictionary&lt;string, int&gt; _AccGroupTypeIDs;\n        public static Dictionary&lt;string, int&gt; AccGroupTypeIDs { get { return _AccGroupTypeIDs; } }\n\n        private static Dictionary&lt;string, int&gt; _EntTypeIDs;\n        public static Dictionary&lt;string, int&gt; EntTypeIDs { get { return _EntTypeIDs; } }\n\n        /// &lt;summary&gt;\n        /// Populates Dictionary objects containing database reference data\n        /// &lt;/summary&gt;\n        public static void PopulateDictionaries()\n        {\n            _SysDetIDs = new Dictionary&lt;string,int&gt;();\n            _AccInfoTypeIDs = new Dictionary&lt;string,int&gt;();\n            _AccGroupTypeIDs = new Dictionary&lt;string,int&gt;();\n            _EntTypeIDs = new Dictionary&lt;string, int&gt;();\n\n            OsgDBDataContext db = new OsgDBDataContext();\n\n            // Populates Dictionaries here\n\n            db.Dispose();\n        }\n    }\n}\n</code></pre>\n\n<p>Is there anything obviously wrong with how I've set this class up that's preventing it from appearing when used via a DLL?</p>\n\n<p>Many thanks</p>\n"},{"tags":["winforms","c#-4.0","combobox","datasource"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13264627,"title":"How can Add items to Binded Datasource Combo Box?","body":"<p>Hi I am new to C#. I have tried following way to add new item to my bound ComboBox but it won't give any result.\nIs it possible to add new item to bound ComboBox (Here Problem is <code>ID</code> is <code>Bigint</code> data type but I want to add <code>Select ID</code>)?\nIf it  is possible, please provide piece of code</p>\n\n<pre><code>     try\n        {\n            objSqlExecute.OpenConnection();\n            string strQuery = objQueryManager.GetEmployeeRecords();\n                  //Add Extra Items to combo Box\n            cmbEmployeeID.Items.Add(\"Select Id\");\n\n            DataTable dtEmployee = objSqlExecute.GetRecordExecution(strQuery);\n                 // DataRow dtNew = dtEmployee.NewRow();\n                // dtNew[\"ID\"] = \"Select ID\";\n                // dtNew[\"FName\"] = \"\";\n            //dtEmployee.Rows.InsertAt(dtNew, 0);\n\n            cmbEmployeeID.DataSource = dtEmployee;\n            cmbEmployeeID.DisplayMember = \"ID\";\n            cmbEmployeeID.ValueMember = \"FName\";\n        }\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13270181,"title":"How end edit of a cell, changing its content when it's clicked?","body":"<p>I have changed a <code>DataGridViewCheckBoxCell</code> to contain a string at the right of the CheckBox that reflects the CheckBox value. When it's <code>true</code>, the string is \"Value1\"; when it's <code>false</code> the string should change to \"Value2\".</p>\n\n<p>The string value is changing only after the <code>DataGridViewCheckBoxCell</code> loses focus. I want the string value to change right after the CheckBox value changes. How can I do that?</p>\n\n<p>For reference, this is my personalized <code>DataGridViewCheckBoxCell</code> class:</p>\n\n<pre><code>public class MyDGVCheckBoxCell : DataGridViewCheckBoxCell\n{\n    public static string TRUE_VALUE = \"Excitada\";\n    public static string FALSE_VALUE = \"Monitorada\";\n\n    public MyDGVCheckBoxCell(bool isExcitada)\n    {\n        FalseValue = FALSE_VALUE;\n        TrueValue = TRUE_VALUE;\n        Value = isExcitada ? TRUE_VALUE : FALSE_VALUE;\n    }\n\n    protected override void Paint(Graphics graphics, Rectangle clipBounds, Rectangle cellBounds, int rowIndex, DataGridViewElementStates elementState, object value, object formattedValue, string errorText, DataGridViewCellStyle cellStyle, DataGridViewAdvancedBorderStyle advancedBorderStyle, DataGridViewPaintParts paintParts)\n    {\n        base.Paint(graphics, clipBounds, cellBounds, rowIndex, elementState, value, formattedValue, errorText, cellStyle, advancedBorderStyle, paintParts);\n\n        Rectangle contentBounds = this.GetContentBounds(rowIndex);\n\n        Point stringLocation = new Point();\n\n        stringLocation.Y = cellBounds.Y + 4;\n        stringLocation.X = cellBounds.X + contentBounds.Right + 1;\n\n        graphics.DrawString(this.Value.ToString(), Control.DefaultFont, System.Drawing.Brushes.Black, stringLocation);\n    }\n}\n</code></pre>\n"},{"tags":["c#",".net","winforms","image-processing"],"answer_count":0,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":26,"score":2,"question_id":13270031,"title":"Looking for high-level Instagram/Microsoft Word like image processing library","body":"<p>Currently, I am looking for a (commercial or free) .NET/C# image processing library for a WinForms project to apply customizable effects like Instagram or Microsoft Office Word does, e.g.:</p>\n\n<p><img src=\"http://i.stack.imgur.com/tg7VY.png\" alt=\"enter image description here\"></p>\n\n<p>I found plenty of image libraries like:</p>\n\n<ul>\n<li><a href=\"http://www.imagemagick.org/script/index.php\" rel=\"nofollow\">ImageMagick</a></li>\n<li><a href=\"http://www.leadtools.com/\" rel=\"nofollow\">Lead Tools</a></li>\n<li><a href=\"http://freeimage.sourceforge.net/\" rel=\"nofollow\">Free Image</a></li>\n<li><a href=\"https://www.atalasoft.com/products/dotimage-sdk-1\" rel=\"nofollow\">DotImage</a></li>\n<li>...</li>\n</ul>\n\n<p>Unfortunately, all these libraries seem to provide a rather low-level way of manipulating images. When it comes to high-level effects like borders, rotation, vintage filters like Instagram, etc., I found zero libraries.</p>\n\n<p>(Ironically, for JavaScript, <a href=\"http://stackoverflow.com/questions/8192317/create-instagram-esque-filters-with-javascript\">there are quite a few libraries out there</a>)</p>\n\n<p>Maybe there is no market for such a library, still I would love to have this function in my application without doing everything on my own.</p>\n\n<p><strong>Therefore my question is:</strong></p>\n\n<p>Is there a .NET library available to have a customizable and extendable way of applying various high-level filters to images?</p>\n"},{"tags":["c#","winforms","random","numbers"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13269757,"title":"Generating a number with 7 digits with the ability to have zeros at the front","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4325267/c-sharp-convert-int-to-string-with-padding-zeros\">C# convert int to string with padding zeros?</a>  </p>\n</blockquote>\n\n\n\n<p>I am trying to generate a random number however in the ranges I have included \"0000000, 9999999\" I want it to show these zeros when a number is generated for example the following outputs would be:</p>\n\n<p>\"00037544\"\n\"01659369\" \n\"75484957\"\n\"00000001\"</p>\n\n<p>I am using the:</p>\n\n<pre><code>    int num = rnd.Next(0000000, 9999999);\n</code></pre>\n\n<p>The problem with that is sometimes it will generate:</p>\n\n<p>\"1648\"\n\"947596\"\n\"18500\" etc</p>\n\n<p>Is there something that im missing? </p>\n\n<p>Thanks for looking</p>\n"},{"tags":["c#",".net","winforms","usercontrols","flowlayoutpanel"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":26,"score":5,"question_id":13265635,"title":"insert Usercontrol in FlowLayoutPanel","body":"<p>I have a <code>FlowLayoutPanel</code> and several <code>UserControl</code>s. Now I want one controll to be always at the bottom of my <code>FlowLayoutPanel</code>. So I want to add my UserControl just above the lowest controll. Is there an easy way to insert user controls in a <code>FlowLayoutPanel</code>?</p>\n\n<p>I'm currently thinking about removing the control at the bottom, and adding the control I want to add and  add the bottom control again. But this I do not think this is really the best way. Is there anyone here who could help me with some information on how to do this ?</p>\n"},{"tags":["c#","sql","winforms","telerik"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13182654,"title":"From DataTable to DataGridView including image path","body":"<p>I am building a small application. This application stores customer information and customer pictures.\nHere I have a problem where I want to show data from datatable to datagridview with pictures. My application does not store the image in a database, but stored in a folder. </p>\n\n<p>So in my database just store image path. But not full path, only the name of the folder or file. I use combine path on each name. It is easier to manage folders if the root directory has been changed compared to if I keep the full path.</p>\n\n<p>For example, if I want to display the image in picture box, I'll do this.</p>\n\n<pre><code>//consider the record has been selected from table\n\nclassDirectory cd = new classDirectory();\n\n// it will check current directory combine application name folder and branch name folder.\n\nstring branchFolderPath = cd.getBranchFolderPath(branchName); \n\nstring branchPanelPath = cd.getPanelFolderPath(branchFolderPath,panelName);\n\nstring customerPath = cd.getCustomerFolderPath(branchPanelPath,customerID + \" - \" + customerName);\n\nstring customerImage = path.Combine(customerPath,customerPicPath);\n\npicCustomer.Image = new Bitmap(customerImage);\n</code></pre>\n\n<p>After combine, it will return string <strong>\"C:\\Users\\My Name\\Documents\\My Application Name\\Branch Name\\Panel Name\\1235 - HIDAYAH\\Pictures\\HIDAYAH - Picture.jpg\"</strong></p>\n\n<p>So I can see the pictures.</p>\n\n<p>But, I do not know how to display the data in grid view.</p>\n\n<p>So only so far I've just made.</p>\n\n<pre><code>Customer.classDataBinding cdb = new Customer.classDataBinding();\n\nDataTable dataCustomer = cdb._listOfCustomer();\n\ndgvCustomer.DataSource = dataCustomer;\n\nthis.dgvCustomer.Columns[\"Customer Image\"].Width = 120; //For a while, this code return the string only.\nthis.dgvCustomer.Columns[\"Customer ID\"].Width = 120;\nthis.dgvCustomer.Columns[\"Name\"].Width = 120;\nthis.dgvCustomer.Columns[\"Branch\"].Width = 120;\nthis.dgvCustomer.Columns[\"Panel\"].Width = 120;\n</code></pre>\n\n<p>Code in <strong>cdb._listOfCustomer()</strong></p>\n\n<pre><code>  public DataTable _listOfCustomer()\n    {\n        cs.testConnection();\n\n        DataTable dtCustomer = new DataTable();\n\n        using (SqlConnection conn = new SqlConnection(cs.connString))\n        {\n            string query = \"SELECT tbl_customer.customerPicPath as [Customer Image], tbl_customer.customerID as [Customer ID],tbl_customer.customerName as Name, tbl_branch.branchName as Branch, tbl_panel.panelName as Panel FROM (tbl_branch INNER JOIN tbl_panel ON tbl_branch.branchID = tbl_panel.branchID) INNER JOIN tbl_customer ON tbl_panel.panelID = tbl_customer.panelID;\";\n\n            using (SqlDataAdapter adap = new SqlDataAdapter(query, conn))\n            {\n                adap.Fill(dtCustomer);\n\n            }\n        }\n\n        return dtCustomer;\n</code></pre>\n\n<p>Any suggestion? Hope someone can help me to resolve this problem. Thanks a lot!</p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13268564,"title":"Winform datagridview not refreshing","body":"<p>I've created a datagridview from the tools and chosed the datasource from db. By using dataset of a table I am displaying data in the datagridview. But When I add new data to the database my gridview still looks the same its not refreshing with the new data :( kindly assist. Thanks in advance</p>\n"},{"tags":[".net","wpf","winforms","telerik","windowsformshost"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13196454,"title":"Telerik RadPanorama control in a WindowsFormsHost control","body":"<p>I am building a WPF app where I work and I want to use the RadPanorama for the Start Screen or \"Launching Pad\" for the App.  I understand, and have seen the numerous threads, that there is no RadPanorama for WPF.  </p>\n\n<p>However, is there any reason I cannot embed one in a WindowsFormsHost?  </p>\n\n<p>Seems to work after a VERY quick little test but I am wondering if anyone has any feedback on doing it this way?  Somethings are very 'messy' to get at with out the Design Time support.  Is there a way around that? </p>\n"},{"tags":["c#","winforms","listbox","calling"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13268664,"title":"Sending information to listbox from a class to a Form","body":"<p>I am trying to send information to a listbox to a Form from a class. Sounds simple enough. However it just won't show anything after the method has run.</p>\n\n<p>This is my Class and Method 'Testclass' that is being called from form one</p>\n\n<pre><code>    public void testclass()\n    {\n        Form1 m = new Form1();\n        int tostng = \"36183464\";\n        m.listBox1.Items.Add(tostng).ToString();\n    }\n</code></pre>\n\n<p>in Form1 I have a listbox which has had it's modifiers set to \"Public\" so not errors pop up. It will run but nothing will be entered into the listbox. This code works when everything is all in Form1. </p>\n\n<p>Thank you for looking.</p>\n"},{"tags":["c#",".net","winforms","validation","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13262097,"title":"Validate cell's value on a custom datagridviewCell","body":"<p>I have a <code>DataGridView</code> with a custom <code>DataGridViewColumn</code>. The column is hosting a third-party component. I enter edit mode in the cell and modify its value and then I press enter key to validate the value. The problem is that I have to press enter key twice to validate the value. It seems like first enter key is to validate the value in the third-party's editor hosted in the cell, and second one to validate the <code>DataGridView</code>'s cell... So how to validate cell's value with only pressing enter key one time? </p>\n\n<p>Also I have seen strange behaviour, for example, the last <code>DataGridView</code>'s row does not behaves as the rest of the <code>DataGridView</code>'s cells. For last row, if I edit the value of a cell and then press enter key to validate, after validating value, it always remains in the same cell and in edit mode and cell's value gets selected so user can think that cell value is invalid when in fact it isn't. This does not happen with the rest of the rows. They need to press enter key twice to validate and cells do not remain in edit mode after validating.</p>\n"},{"tags":["c#",".net","winforms","buttonclick","axwindowsmediaplayer"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13268219,"title":"Accessing windows media player component on a form from another form","body":"<p>I'm making a C# application in which I have 2 forms: Form1 &amp; Form2. Form1 contains a windows media player COM component(axwindowsmediaplayer1), which I'm using to play songs on button click. \nNow, I want to invoke axwindowsmediaplayer1  from button click on Form2. I tried to make a static function(so that I can use it as Form1.function_name), but it gives error since axwindowsmediaplayer1 isn't static. </p>\n\n<p>How I can do this ? Please help. </p>\n"},{"tags":["c#",".net","winforms"],"answer_count":8,"favorite_count":8,"up_vote_count":17,"down_vote_count":0,"view_count":11784,"score":17,"question_id":388937,"title":"Determine Label Size based upon amount of text and font size in Winforms/C#","body":"<p>I'd like to know if there's a better approach to this problem. I want to resize a label (vertically) to accomodate certain amount of text. My label has a fixed width (about 60 chars wide before it must wrap), about 495 pixels. The font is also a fixed size (12points afaik), but the text is not. </p>\n\n<p>What I want to do is increase the Label Height when there's a \"NewLine\" or the text must wrap; the idea is that the text is fully visible in the label. The AutoSize doesn't work because it will grow in width, not in height. </p>\n\n<p>Of course I could count the number of NewLines and add:  Newlines * LineHeight, and then -given that I manage to put 60 chars per line, just divide the number of chars and add as many LineHeight pixels as needed.</p>\n\n<p>I was wondering if there was a more professional way to do it. Is my approach too \"lame\" ?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","winforms","listbox"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":529,"score":1,"question_id":7672776,"title":"C#, winform - List box selection using up and down arrow key?","body":"<p>I have list box, I am able to select the entries (Single select mode - one at a time) using keyboard and mouse, but when i use up and down arrow keys, its not selecting the list. But able to scroll the list with an underline below each entity the arrow key is related. Thanks </p>\n"},{"tags":["vb.net","winforms","visual-studio-2010","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13265217,"title":"Vb.Net Evaluate Exception When filtering Datagridview using Combobox and Textbox","body":"<p>I am in need of help once more, I am trying to search through my DGV using Combobox to get the name for the Column and textbox for the search query, I used this codes before and it worked but now I get the an EvaluateException saying \"Cannot perform 'Like' operation on System.Double and System.String.\" Here's what I'm doing.</p>\n\n<pre><code>     Dim dv As DataView = New DataView()\n          Dim CmSi = cmbSearch.SelectedItem\n          dv.Table = OutGoingDataSet.outgoingdeliveries\n          dv.RowFilter = CmSi &amp; \" Like '\" &amp; txtSearch.Text &amp; \"'\"\n          OutgoingDataGridView.DataSource = dv\n</code></pre>\n\n<p>any helps or tips would be much appreciated. Please and Thank You.</p>\n"},{"tags":["c#","winforms","autocomplete"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":204,"score":3,"question_id":12972761,"title":"textbox auto complete (Multi Line)","body":"<p>I am making a auto suggestion / complete textbox in C#, i followed below link, but text box isnt showing the suggestions</p>\n\n<p><a href=\"http://stackoverflow.com/questions/5648476/how-to-create-autosuggest-textbox-in-windows-forms\">How to create autosuggest textbox in windows forms?</a></p>\n\n<pre><code>//-------- Get all distinct description -----------------------------\nOleDbCommand command = new OleDbCommand(Queries.qry16, Connection);\nOleDbDataReader reader = command.ExecuteReader();\n\n//--------- Storing ------------------------------------\nwhile (reader.Read())\n{\n    namesCollection.Add(reader.GetValue(0).ToString());\n}\n\n//----------- Close after use ---------------------------------------\nreader.Close();\n\n//----------- Set the auto suggestion in description box ------------\ndescriptionBox.AutoCompleteMode = AutoCompleteMode.Suggest;\ndescriptionBox.AutoCompleteSource = AutoCompleteSource.CustomSource;\ndescriptionBox.AutoCompleteCustomSource = namesCollection;\n</code></pre>\n\n<p>Here is my code , it is in load function of winform. And the nameCollection initializtion is in constructor... kindly please help to make it working.</p>\n\n<p>I am editing my post rather then creating new... I have tried the my own code in single line textbox and it worked. Now i want the same in multi line... For research i googled more then 2 days trying different codes (one with intelli sense) but it didnt worked as auto suggestion available in textbox. Can any one give me suggestion to code the whole procedure to multi line.. Thank you.</p>\n"},{"tags":["c#","winforms","serialization","designer","initializecomponent"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":263,"score":1,"question_id":10272123,"title":"How can I customize the code generation of InitializeComponent? More specifically, how can I post-process all of the generated code?","body":"<p>I'm trying to customize the Windows Forms Designer's code generation for <code>InitializeComponent</code>. The MSDN article <a href=\"http://msdn.microsoft.com/en-us/library/ms973818.aspx\" rel=\"nofollow\" title=\"MSDN article: 'Customizing Code Generation in the .NET Framework Visual Designers'\">\"Customizing Code Generation in the .NET Framework Visual Designers\"</a> contains a section <a href=\"http://msdn.microsoft.com/en-us/library/ms973818.aspx#custcodegen_topic8\" rel=\"nofollow\" title=\"MSDN article: 'Customizing Code Generation in the .NET Framework Visual Designers', section 'Controlling Code Generation'\">\"Controlling Code Generation\"</a> that explains the basics of how this can be done.</p>\n\n<p>I've closely followed an example in the above article:</p>\n\n<pre><code>//using System.ComponentModel.Design.Serialization;\n\nclass SomeFormSerializer : CodeDomSerializer\n{\n    public override object Serialize(IDesignerSerializationManager manager,\n                                     object value)\n    {\n        // first, let the default serializer do its work:\n        var baseSerializer = (CodeDomSerializer)manager.GetSerializer(\n                             typeof(Form).BaseType, typeof(CodeDomSerializer));\n        object codeObject = baseSerializer.Serialize(manager, value);\n\n        // then, modify the generated CodeDOM -- add a comment as the 1st line:\n        if (codeObject is CodeStatementCollection)\n        {\n            var statements = (CodeStatementCollection)codeObject;\n            statements.Insert(0, new CodeCommentStatement(\"CODEDOM WAS HERE\"));\n        }\n\n        // finally, return the modified CodeDOM:\n        return codeObject;\n    }\n}\n</code></pre>\n\n<p>Now I hook this up to my form <code>SomeForm</code>:</p>\n\n<pre><code>[DesignerSerializer(typeof(SomeFormSerializer), typeof(CodeDomSerializer))]\nclass SomeForm : Form { … }\n</code></pre>\n\n<p>The Forms Designer might then generate the following <code>InitializeComponent</code> code:</p>\n\n<pre><code>private void InitializeComponent()\n{\n    … /* (general setup code, such as a call to `this.SuspendLayout`) */ \n\n    // \n    // someButton\n    // \n    … /* (someButton's properties are set) */\n\n    // CODEDOM WAS HERE!\n    // \n    // SomeForm\n    // \n    … /* (form's properties are set) */\n\n    … /* (general setup code, such as a call to `this.ResumeLayout`) */ \n}\n</code></pre>\n\n<p>Note that the comment <code>// CODEDOM WAS HERE</code> was not added as the very first line in <code>InitializeComponent</code>, but only as the first line of the code block that deals with the properties of the form object itself.</p>\n\n<p>What would I have to do if I wanted to be able to modify the generated CodeDOM of the whole method, and not just of the part that deals with a specific object? </p>\n\n<blockquote>\n  <p><strong>Background: Why do I want to do this?</strong> In Windows Forms, if one wants flexible value conversion during data binding, one usually has to resort to subscribing to the <code>Format</code> and <code>Parse</code> events of some particular <code>Binding</code> object. So I'm creating a specialized <code>Binding</code> subclass (let's call it <code>ConvertingBinding</code>) that simplifies this process a bit.</p>\n  \n  <p>Now, the issue is that when data bindings are set up in the Windows Forms Designer, the generated code creates instances of <code>Binding</code>; however, I would want the designer to instantiate my specialized subclass instead. My current approach is to let the designer create a CodeDOM tree first, then walk that tree and replace all instantiations of <code>Binding</code> by instantiations of <code>ConvertingBinding</code>.</p>\n</blockquote>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13265684,"title":"Change win app labels and text","body":"<p>I remember in <code>VB6</code> i was able to get the handle of a form of a software that's currently running, and change it from outside with some API functions.\nIs it possible to do with c#? how? The problem is that this software is in a different language. I want to change some of it to English.</p>\n"},{"tags":["c#",".net","winforms","performance","logging"],"answer_count":7,"favorite_count":4,"up_vote_count":1,"down_vote_count":0,"view_count":6020,"score":1,"question_id":5057567,"title":"How to do logging in c#?","body":"<p>I would like to implement logging in my application but would rather not use any outside frameworks like log4net.</p>\n\n<p>So I would like to do something like Dos's echo to file. What is the most effective way to do it?</p>\n\n<p>Is there a way to log unhandled exceptions logged without using an outside framework?</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13265618,"title":"Repeating controls in windows form application","body":"<p>I am developing a Windows Forms application to generate incentive reports for staff in different groups. In order to match the report template, I need to manually put controls in the form for only one staff. If I finished all the logic inside, how can I make it dynamic so that it could auto generate reports for all the staff by using same template?</p>\n"},{"tags":["c#",".net","winforms","datagridview","editmode"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13261895,"title":"Exit edit mode from a control hosted in a cell","body":"<p>I have a custom datagridviewcolumn, a custom control hosted in a cell. I want to programmatically exit edit mode and validate the current value in the cell (this value is correct). I have checked below ways but without success:</p>\n\n<pre><code>this.datagridview.currentCell.datagridview.endEdit()\nthis.EditingControlDataGridView.endEdit()\nthis.datagridview.endEdit();\n</code></pre>\n\n<p>also by forcing the current cell to change:</p>\n\n<pre><code>this.datagridview.currentCell = this.datagridview.Rows[rowIndex].Cells[columnIndex]\n</code></pre>\n\n<p>I need to programmatically force the commit of the pending value in the cell because for example, there are cases that I need to delete a row of datagridview but as cell (in the same row being deleted) is in edit mode, I cannot do it if I do not commit changes for the cell and exit edit mode before.</p>\n\n<p>Also, I have similar strange behaviour when I want to exit edit mode but, in this case, discarding the changes in the cell: depending on the state of my application, sometimes doing this.datagridview.CancelEdit() works and sometimes not.</p>\n\n<p>Using C#, .NET Framework 4.0, WinForms.</p>\n"},{"tags":["c#",".net","winforms","picturebox","imagelist"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13263608,"title":"populate PictureBox with Images using Foreach loop","body":"<p>In my project I have collection of PictureBoxes and a filled ImageList. I want to populate each pictureBox with the each Image in ImageList using <code>foreach</code> Loop. I know how to do using For loop but I dont know how to do it using foreach loop. I am asking this just for knowledge purpose. I think this can be achieved using Linq inside foreach loop but I am a beginner so I have no Idea how to do it.</p>\n\n<p>I tried the below code in for loop:</p>\n\n<pre><code>        for (intimgcount = 0; intimgcount &lt; intMaxPics; intimgcount++)\n        {                \n            pbxCollection[intimgcount].Image = imglst.Images[intimgcount];          \n        }     \n</code></pre>\n\n<p>the code which  I want to use in <code>foreach</code> loop is:</p>\n\n<pre><code>        var pbxCollection = new List&lt;PictureBox&gt;();  //PictureBox collection\n</code></pre>\n\n<p>EDIT:  How to set the positions of Picture Box collection in the form?</p>\n\n<p>I tried:</p>\n\n<pre><code>        var i = 0;\n        foreach (var pbx in pbxCollection)\n        {\n            pbx.Image = imglst.Images[i++];\n            //set location:\n            pbx.Width = 100;\n            pbx.Height = 100;\n            pbx.Location = new Point(0, pbx.Height * i);\n            //add to form:\n            this.Controls.Add(pbx);\n        }  \n</code></pre>\n"},{"tags":["winforms","datagridview","c#-2.0"],"answer_count":4,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":7075,"score":5,"question_id":1706454,"title":"C#: multiline text in datagridview control","body":"<p>Is it possible for the datagridview control to display multiline text in a textbox column?\nI am using visual studio 2005 C#.net.</p>\n"},{"tags":["c#","winforms","create-directory"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13264620,"title":"Inserting Selected Item on Specific Folder [SOLVED]","body":"<p>I have 2 buttons (Button1 - Browse ; Button2 - Upload) and 1 textBox </p>\n\n<p>Here is the scenario. When I click on Browse, it will open a window and will browse for a specific item.\nThe selected item will display on textbox.</p>\n\n<pre><code>private void Browse_Click(object sender, EventArgs e)\n{\n    btnSample.Title = \"Sample File Upload\";\n    btnSample.InitialDirectory = @\"c:\\\";\n    btnSample.Filter = \"TIF|*.tif|JPG|*.jpg|GIF|*.gif|PNG|*.png|BMP|*.bmp|PDF|*.pdf|XLS|*.xls|DOC|*.doc|XLSX|*.xlsx|DOCX|*.docx\";\n    btnSample.FilterIndex = 2;\n    btnSample.RestoreDirectory = true;\n    if (btnSample.ShowDialog() == DialogResult.OK)\n    {\n        textBox1.Text = btnSample.FileName;\n    }\n}\n</code></pre>\n\n<p>When I click on the Upload Button the file on the textbox will be on the created folder.\nI'm done with creating the folder. but my problem is how can i insert the selected file on the folder.</p>\n\n<pre><code>private void button4_Click(object sender, EventArgs e)\n{\n    string path = @\"C:\\SampleFolder\\NewFolder\";\n    if (!Directory.Exists(path))\n    {\n        Directory.CreateDirectory(path);\n        MessageBox.Show(\"Successfully Created New Directory\");\n    }\n    else\n    {\n        MessageBox.Show(\"Filename Exist\");\n    }\n}\n</code></pre>\n"},{"tags":["c#","winforms","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13264150,"title":"How do I change color of cell which have greater than zero value in datagrid","body":"<p><code>enter code here</code><p> i have two cell in grid i want to chage one cell color and value by zero when i entered in other cell greater then zero value </p></p>\n\n<pre><code>    private void grdDetail_CellBeginEdit(object sender, DataGridViewCellCancelEventArgs e)\n        { \n            if (this.IsLoadComplete) \n              { \n                UpdateValueofQtyCell(e.ColumnIndex); \n              } \n       }\n  private void UpdateValueofQtyCell(int index)\n        {\n            int cur_row = grdDetail.CurrentRow.Index;\n\n            if (index == 1)\n            {\n                grdDetail[1, cur_row].Style.BackColor = Color.White;\n                grdDetail[2, cur_row].Style.BackColor = Color.FromArgb(224, 224, 224);\n                grdDetail[2, cur_row].Value = 0;\n            }\n           else  if (index == 1)\n            {\n                grdDetail[2, cur_row].Style.BackColor = Color.White;\n                grdDetail[1 cur_row].Style.BackColor = Color.FromArgb(224, 224, 224);\n                grdDetail[1, cur_row].Value = 0;\n             }\n        }\n</code></pre>\n"},{"tags":["c#","winforms","datagridview","checkbox"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13263288,"title":"Unchecking the user checked checkbox in the datagridview cell","body":"<p>I have a column in my <code>DataGridView</code> which has the <code>DataGridViewCheckBoxColumn</code> as column template. When user checks the checkbox, I need to uncheck it programmatically if it fails some conditions. I have done this, but this uncheck logic only takes effect after I change the focus from the cell manually. I tried changing the focus programmatically but didn't work. Is there any solution for this?</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13263646,"title":"Menu in child process inside a tab not shown on mouse click","body":"<p>I am developing a chrome like application. I do have two applications Say Parent and Child Application. Child application contains menus. When i am attaching an instance of child application to a tab of parent application. Menu in child application is not shown on mouse click.</p>\n\n<p>Code snippet used for attaching process is</p>\n\n<pre><code>Process P = Process.GetProcessesByName(\"Child\");\nP.WaitForInputIdle();\nIntPtr handle = P.MainWindowHandle;\nSetParent(handle, this.tabPage1.Handle);\nMoveWindow(handle, rec.X, rec.Y, rec.Width, rec.Height, true);\n</code></pre>\n\n<p>I cannot make any changes to Child application.</p>\n"},{"tags":["winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13263846,"title":"Image upload in window application ? C#.net?","body":"<p>In window application, i have one registration form in that one option is to upload the photo of the user. So how can i do this, generally in web application we have File Upload control using this we can save the image in our project, like that i want to save the photo of the user in any drive of my system. can you help me. Thank you.</p>\n"},{"tags":["winforms","c#-4.0","wpf-controls","frames"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13248829,"title":"equivalent frame in windows application and navigate from page to another page?","body":"<p>what is equivalent \"frame\" in C# application?\nI must navigate from page to another page in windows application. I create master page and use some panel in page. I want to navigate from every panel to another page. how do i do?</p>\n"},{"tags":["c#","winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":69,"score":3,"question_id":13252643,"title":"Child Application Menu not shown in a Chrome like application","body":"<p>I am developing a chrome like application. I do have two applications Say Parent and Child Application. Child application contains menus. \nWhen i am attaching an instance of child application to a tab of parent application. Menu in child application is not shown on mouse click.</p>\n\n<p>Code snippet used for attaching process is</p>\n\n<pre><code>Process P = Process.GetProcessesByName(\"Child\");\nP.WaitForInputIdle();\nIntPtr handle = P.MainWindowHandle;\nSetParent(handle, this.tabPage1.Handle);\nMoveWindow(handle, rec.X, rec.Y, rec.Width, rec.Height, true);\n</code></pre>\n\n<p>I cannot make any changes to Child application.</p>\n"},{"tags":["c#","winforms","combobox"],"answer_count":2,"favorite_count":1,"up_vote_count":23,"down_vote_count":0,"view_count":18755,"score":23,"question_id":598447,"title":"How to disable editing of elements in combobox for c#?","body":"<p>I have some elements in a ComboBox (WinForms with C#). I want their content to be static so that a user cannot change the values inside when the application is ran. I also do not want the user adding new values to the ComboBox</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":62,"score":0,"question_id":13263099,"title":"pass object between forms c#","body":"<p>I am working on a form application that has two windows. In the main window, Form1 I create an instance of the class Treatment. I would like to pass that instance, once a image is clicked to the other window form2. So far I have:\nForm1:</p>\n\n<pre><code>public partial class Form1 : Form\n{\n\n    private Treatment treatment;\n\n//method where i inistantiate the treatment\nprivate void processTreatment(int id, Button button)\n    {\n        treatment = new Treatment(wirelessResult, id);\n        Alarm alarm = new Alarm(count, treatment);\n        wirelessResult.GenerateNumber();\n        alarm.setColor();\n        events.add(alarm);\n        if (getResult(treatment) == true)\n        {\n            storeSuccess(button);  \n        }\n        else if (getResult(treatment) == false)\n        {\n            storeFailed(button);\n        }\n    }\n// image clicked   \nprivate void treatmentStation1_Click(object sender, EventArgs e)\n    {\n\n        Form2 secondForm = new Form2(treatment);\n        secondForm.Show();\n    }\n</code></pre>\n\n<p>and in form2:</p>\n\n<pre><code>public partial class Form2 : Form\n{\n    private Treatment treatment;\n\n\n    public Form2()\n    {\n        InitializeComponent();\n\n    }\n\n    public Form2(Treatment treatment)\n    {\n        InitializeComponent();\n        this.treatment = treatment;\n    }\n  }\n}\n</code></pre>\n\n<p>I get 1 error : Error   1   Inconsistent accessibility: parameter type 'WasteTreatment.Treatment' is less accessible than method 'WasteTreatment.Form2.Form2(WasteTreatment.Treatment)'</p>\n\n<p>Someone can help me to fix this?</p>\n"},{"tags":["c#","winforms","rdlc"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":299,"score":0,"question_id":7412249,"title":"Khmer unicode doesn't display correctly in Microsoft Client Side Report(rdlc)","body":"<p>I building a winform application that records information using khmer unicode font. For my application i use c# with sqlserver and microsoft client report (rdlc) to generate reports. \nNow i have a problem with the rdlc report that does not display khmer unicode font correctly.\nIt displays like the image in the links below:</p>\n\n<p><a href=\"http://i1138.photobucket.com/albums/n522/sandeep251183/CRViewer.png\" rel=\"nofollow\">http://i1138.photobucket.com/albums/n522/sandeep251183/CRViewer.png</a></p>\n\n<p>It should look like this</p>\n\n<p><a href=\"http://i1138.photobucket.com/albums/n522/sandeep251183/CRExportHTML-1.png\" rel=\"nofollow\">http://i1138.photobucket.com/albums/n522/sandeep251183/CRExportHTML-1.png</a></p>\n\n<p>Can anyone find a solution for me?</p>\n"},{"tags":["c#",".net","winforms","visual-studio-2010"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":3,"view_count":1100,"score":-1,"question_id":9096078,"title":"How to download a file to a specific path in from a given url in a windows form?","body":"<p>I need to download pdf files from a specified links(url) to a specific folder in a windows application using winforms please any one can suggest me with a solution.</p>\n"},{"tags":["mysql","vb.net","winforms","visual-studio-2010","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":13225502,"title":"Updating Multiple Selected rows in DGV in VB.NET","body":"<p>I have a <code>DataBound</code> <code>DGV</code> it has 3 <code>Columns</code> namely <code>ID(not pk)</code>, <code>Name</code>, and <code>Status</code>. I have 2 Buttons <code>Add</code> and <code>Post</code>. Add, adds <code>Data</code> to the <code>DGV</code> and <code>DataBase(MySql)</code> but in <code>Status</code>, it adds <code>\"No\"</code>. What I want to do is for example I have 3 <code>Rows</code> in my  <code>DGV</code> and highlight those 3 and click <code>Post</code>, the value in <code>Status</code> will be changed to <code>\"Yes\"</code>. Here is what I have done so far, but I'm having trouble with the syntax for the <code>UPDATE QUERY</code>. <strong>THIS CODE WORKS NOW</strong></p>\n\n<pre><code>  Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load\n        'TODO: This line of code loads data into the 'TestDataSet.testing' table. You can move, or remove it, as needed.\n        Me.TestingTableAdapter.Fill(Me.TestDataSet.testing)\n        Using _conn As New MySqlConnection(\"Server = localhost; Username= root; Password =; Database = test\")\n\n            Using cmd\n                With cmd\n                    MsgBox(\"Connection Established\")\n                    .Connection = _conn\n                    .Parameters.Clear()\n                    .CommandText = \"Select Max(TransactionID) from testing\"\n                    _conn.Open()\n                    Dim dr As MySqlDataReader\n                    dr = cmd.ExecuteReader()\n                    If dr.Read() Then\n                        If IsDBNull(dr.Item(0)) Then\n                            txtNumber.Text = \"1\"\n                        Else\n\n                            txtName.Text = dr(0).ToString() + 1\n                        End If\n\n                    End If\n                End With\n            End Using\n        End Using\n\n        FillGrid()\n\n    End Sub\n\n    Private Sub FillGrid()\n\n\n\n        Using _conn As New MySqlConnection(\"Server = localhost; Username= root; Password =; Database = test\")\n            Using _comm As New MySqlCommand\n                With _comm\n                    .CommandText = \" SELECT `ID`, `TransactionID`, `Name`, `Posted` FROM `testing`\"\n                    .Connection = _conn\n                End With\n                Using _adapter As New MySqlDataAdapter(_comm)\n                    Try\n                        _conn.Open()\n                        Dim _ds As New DataSet\n                        _adapter.Fill(_ds)\n                        GVTransaction.DataSource = _ds.Tables(0)\n                    Catch ex As Exception\n\n                    End Try\n                End Using\n            End Using\n        End Using\n    End Sub\n\n    Private Sub btnAdd_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnAdd.Click\n        Using conn As New MySqlConnection(\"Server = localhost; Username= root; Password =; Database = test\")\n            Using cmd\n                With cmd\n                    MsgBox(\"Connection Established\")\n                    .Connection = conn\n                    .Parameters.Clear()\n                    .CommandText = \"INSERT INTO testing(TransactionID, Name, Posted) VALUES (@ID, @iName, @iPosted)\"\n                    .Parameters.Add(New MySqlParameter(\"@ID\", txtNumber.Text))\n                    .Parameters.Add(New MySqlParameter(\"@iName\", txtName.Text))\n                    .Parameters.Add(New MySqlParameter(\"@iPosted\", \"No\"))\n\n\n                End With\n                Try\n                    conn.Open()\n                    cmd.ExecuteNonQuery()\n                Catch ex As MySqlException\n                    MsgBox(ex.Message.ToString())\n                End Try\n            End Using\n        End Using\n\n        MsgBox(\"Data Added to the Database\")\n\n        Me.TestingTableAdapter.Dispose()\n\n        Me.TestingTableAdapter.Fill(Me.TestDataSet.testing)\n    End Sub\n\n    Private Sub btnPost_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnPost.Click\n\n\n        Dim _ID As New List(Of String)\n        Dim _Name As New List(Of String)\n        For Each _x As DataGridViewRow In TestingDataGridView.SelectedRows\n            _ID.Add(_x.Cells(\"GVTransactionID\").Value.ToString())\n            _Name.Add(\"'\" &amp; _x.Cells(\"GVName\").Value.ToString() &amp; \"'\")\n        Next\n        Dim inClause As String = String.Join(\",\", _ID.ToArray())\n        Dim inClause1 As String = String.Join(\",\", _Name.ToArray())\n        Dim _sqlUpdate As String = String.Format(\"UPDATE testing SET Posted = @Posted WHERE TransactionID IN ({0}) AND Name IN ({1})\", inClause, inClause1)\n\n        Using _conn As New MySqlConnection(\"Server = localhost; Username= root; Password =; Database = test\")\n            Using _commm As New MySqlCommand()\n                With _commm\n                    .CommandText = _sqlUpdate\n                    .Connection = _conn\n                    .CommandType = CommandType.Text\n                    .Parameters.AddWithValue(\"@Posted\", \"YES\")\n\n                End With\n                Try\n                    _conn.Open()\n                    _commm.ExecuteNonQuery()\n                    FillGrid()\n                Catch ex As MySqlException\n                    MsgBox(ex.StackTrace.ToString)\n                End Try\n\n            End Using\n        End Using\n    End Sub\nEnd Class\n</code></pre>\n\n<p>Any Helps or tips is greatly appreciated. Please and Thank you</p>\n"},{"tags":["vb.net","winforms","combobox"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":2576,"score":2,"question_id":1920598,"title":"How to expand combo box on focus event?","body":"<p>I want to automatically expand Combo box on focus event.\nI have set the <code>Droppeddown = True</code> in gotfocus event, but this has a side effect. When click event gets fired, it expands dropdown and closes immediately. How can I avoid it?</p>\n\n<p>Here is Code:</p>\n\n<pre><code>Private Sub cmbElectLoadPS_gotfocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles cmbElectLoadPS.GotFocus\n       cmbElectLoadPS.DroppedDown = True\nEnd Sub\n</code></pre>\n"},{"tags":["c#","asp.net","winforms","logging","log4net"],"answer_count":9,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":7533,"score":6,"question_id":2898120,"title":"Creating a new log file each day","body":"<p>As the title implies how can I create a new log file each day in C#? Now the program may not necessarily run all day and night but only get invoked during business hours. So I need to do two things.</p>\n\n<ol>\n<li>How can I create a new log file each day? The log file will be have the name in a format like MMDDYYYY.txt</li>\n<li>How can I create it just after midnight in case it is running into all hours of the night?</li>\n</ol>\n"},{"tags":["winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13261204,"title":"A data grid supporting folders? (example picture given)","body":"<p>I'm just wondering if I can do something like the picture below.</p>\n\n<p>Features needed:</p>\n\n<p>Editing fields and adding more of them.</p>\n\n<p>Support for folders, that can contain more of these fields.</p>\n\n<p><img src=\"http://i.stack.imgur.com/YYU8M.png\" alt=\"enter image description here\"></p>\n\n<p>I'm new to gui / graphical programming. Also normal programming but experience is quickly being picked up. So I'm just wondering if someone can point me in the right direction if there is one. Thanks in advance! </p>\n"},{"tags":["c#",".net","winforms"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":78,"score":0,"question_id":13242945,"title":"converting textbox string to int","body":"<p>I'm trying to compare and multiply 2 random number variables with the int value entered in textboxes. If it is the correct increment the correct answers it does not increase the number although it increment works alone but it does not work with the textbox.</p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n{\n    int x = Randomnumber.Next(12);\n    int z = Randomnumber.Next(12);\n\n    //int cv = +correct;\n    textBox2.Text = x.ToString();\n    textBox3.Text = z.ToString();\n\n    int s = x * z;\n    if (s == int.Parse(textBox4.Text))\n    {\n        correct++;\n        numbercorrect.Text = correct.ToString();\n    }\n}\n</code></pre>\n"},{"tags":["c#",".net","winforms","visual-studio-2010","controls"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13260688,"title":"how to remove the default control buttons from a windows form","body":"<p>The image describes what I am trying to do.</p>\n\n<p>I have a \"connect four\" game which works perfectly well but I want to remove the default buttons provided at the top right hand corner of the window. Any quick help on this?</p>\n\n<p><img src=\"http://i.stack.imgur.com/Ws3ss.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","winforms","path","treeview","directory"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":13259963,"title":"Why does Path.GetFileName() return the name of the correct folder, but Path.GetDirectoryName() returns it parent folder?","body":"<p>I have found that using Path.GetFileName() in the code below works as I intend and gives me the name of the correct folder, but if I use Path.GetDirectoryName() it returns the name of the parent (UserGeneratedContent) folder instead. Why does this occur when both methods are passed the same path as a string? And why does Path.GetFileName() work on directories?</p>\n\n<p>When I use Path.GetFileName() the text of the nodes in the Treeview are those of the folders it finds - this is what I want to happen, but if I use Path.GetDirectoryName() the text is the full path from @\"UserGeneratedContent\" on down for each node. Why does that happen?</p>\n\n<p>And lastly, can my code be improved?      </p>\n\n<pre><code>private void CheckForBaseFolder()\n    {\n\n        if (Directory.Exists(@\"UserGeneratedContent\"))\n        {\n\n            DirectoryInfo info = new DirectoryInfo(@\"UserGeneratedContent\");\n            DirectoryInfo[] subdirs = info.GetDirectories();\n\n            if (subdirs.Length != 0)\n            {\n\n                string path = Path.Combine(@\"UserGeneratedContent\", subdirs[0].ToString());\n\n                treeView1.Nodes.Add(CheckForSubFolders(path));\n\n                treeView1.SelectedNode = treeView1.Nodes[0];\n\n            }\n            else { MessageBox.Show(\"No User-Generated Folders Or Files Found\");}\n\n        }\n        else\n        {\n\n            Directory.CreateDirectory(@\"UserGeneratedContent\");\n\n        }\n\n    }\n\n    private TreeNode CheckForSubFolders(string path)\n    {\n\n        TreeNode folder = new TreeNode(path);\n\n        folder.Text = Path.GetFileName(path); // Works as intended, but.....\n        folder.Text = Path.GetDirectoryName(path); // Returns the name of the parent folder \n\n        foreach(var subdirectory in Directory.GetDirectories(path))\n        {\n\n            folder.Nodes.Add(CheckForSubFolders(subdirectory));\n\n        }\n\n        folder.ImageIndex = 0;\n        folder.SelectedImageIndex = 1;\n\n        return folder;\n\n    }\n</code></pre>\n"},{"tags":["c#","winforms","data-binding","datetime","nullable"],"answer_count":1,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":2705,"score":5,"question_id":1640306,"title":"Binding to a Nullable<DateTime> control property","body":"<p>We have a custom control that has a \"Value\" property of type System.Nullable (aka System.DateTime?).  We have an object with a \"Received\" property of the same type.  When we try to bind the control to the object, the following <em>InvalidCastException</em> is thrown:</p>\n\n<p><strong>Invalid cast from 'System.DateTime' to 'System.Nullable`1[[System.DateTime, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]'.</strong></p>\n\n<p>Here is what we're doing:</p>\n\n<p>Object property:</p>\n\n<pre><code>private System.DateTime? _dateTimeReceived;\npublic System.DateTime? DateTimeReceived\n{\n    get\n    {\n        return this._dateTimeReceived;\n    }\n    set\n    {\n        this._dateTimeReceived = value;\n        this.OnChanged(\"DateTimeReceived\", value); //Implements INotifyPropertyChanged and fires PropertyChanged event\n    }\n}\n</code></pre>\n\n<p>Control property:</p>\n\n<pre><code>private System.DateTime? _value;\n[System.ComponentModel.Category(\"Behavior\")]\n[System.ComponentModel.Description(\"The current date value for this control\")]\npublic new System.DateTime? Value\n{\n    get\n    {\n        return this._value;\n    }\n\n    set\n    {\n        this._value = value;\n    }\n}\n</code></pre>\n\n<p>In the application, here is where the exception is thrown:</p>\n\n<pre><code>this.dateReceived.DataBindings.Add(\"Value\", this._object, \"DateTimeReceived\");\n</code></pre>\n\n<p>As you can see, the object's property (this._object.DateTimeReceived) is a System.DateTime? type and the control's property (this.dateReceived.Value) is a System.DateTime? type.</p>\n\n<p>Why would this cause an <em>InvalidCastException</em>?  And how can we correct this so that it binds correctly?</p>\n\n<p><strong>Update 2009-10-29 14:26 CDT:</strong></p>\n\n<p>Here is the stack trace:</p>\n\n<blockquote>\n  <p>at System.Convert.DefaultToType(IConvertible value, Type targetType,\n  IFormatProvider provider)<br> at\n  System.DateTime.System.IConvertible.ToType(Type type, IFormatProvider\n  provider) <br> at System.Convert.ChangeType(Object value, Type\n  conversionType, IFormatProvider provider) <br> at\n  System.Windows.Forms.Binding.FormatObject(Object value)<br> at\n  System.Windows.Forms.Binding.PushData(Boolean force) <br> at\n  System.Windows.Forms.Binding.UpdateIsBinding() <br> at\n  System.Windows.Forms.Binding.CheckBinding() <br> at\n  System.Windows.Forms.Binding.SetListManager(BindingManagerBase\n  bindingManagerBase) <br> at\n  System.Windows.Forms.ListManagerBindingsCollection.AddCore(Binding\n  dataBinding) <br> at\n  System.Windows.Forms.BindingsCollection.Add(Binding binding) <br> at\n  System.Windows.Forms.BindingContext.UpdateBinding(BindingContext\n  newBindingContext, Binding binding)<br> at\n  System.Windows.Forms.Binding.SetBindableComponent(IBindableComponent\n  value)<br> at\n  System.Windows.Forms.ControlBindingsCollection.AddCore(Binding\n  dataBinding) <br> at\n  System.Windows.Forms.BindingsCollection.Add(Binding binding) <br> at\n  System.Windows.Forms.ControlBindingsCollection.Add(String\n  propertyName, Object dataSource, String dataMember, Boolean\n  formattingEnabled, DataSourceUpdateMode updateMode, Object nullValue,\n  String formatString, IFormatProvider formatInfo) <br> at\n  System.Windows.Forms.ControlBindingsCollection.Add(String\n  propertyName, Object dataSource, String dataMember)<br></p>\n</blockquote>\n"},{"tags":["c#","winforms","mouse"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13253041,"title":"Middle button click to scroll","body":"<p>How do I achieve this in a WinForms container control when the scroll bars are visible?</p>\n\n<p>Highlighted here (Google Chrome browser):</p>\n\n<p><img src=\"http://i.stack.imgur.com/SpnMB.png\" alt=\"enter image description here\"></p>\n\n<p>EDIT: This cursor is the only one that is visible on a screenshot. I hope it's clear what i mean.</p>\n\n<p>EDIT:\nTried this on my control. Does not work.</p>\n\n<pre><code>    const int WM_MBUTTONDOWN = 0x207;\n    protected override void WndProc(ref Message m)\n    {\n        if (m.Msg == WM_MBUTTONDOWN)\n            DefWndProc(ref m);\n        else\n            base.WndProc(ref m);\n    }\n</code></pre>\n"},{"tags":["c#",".net","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13258453,"title":"Running a Windows application as a Command Line application","body":"<p>I am working on a migration tool that is primarily a Windows Forms application. What I want to do is provide the ability to run the application as a sort of command line utility where parameters can be passed in and the migration occurs completely void of the GUI.  This seems straight forward enough and the entry point for my application looks like this:</p>\n\n<pre><code>    [STAThread]\n    static void Main(string[] args)\n    {\n        if (args.Length == 0)\n        {\n            Application.EnableVisualStyles();\n            Application.SetCompatibleTextRenderingDefault(false);\n            Application.Run(new MainWindow());\n        }\n        else\n        {\n            //Command Line Mode\n            Console.WriteLine(\"In Command Line Mode\");\n            Console.ReadLine();\n        }\n    }\n</code></pre>\n\n<p>The problem I am running into is that when execution passes into the else block the text is not wrote back to the user at the command prompt which is problematic as I want to update the user at the command prompt as various executions complete.  I could easily write a standalone console application but I was hoping to provide a single tool that allowed to different types of entries for a given scenario.  Is what I am looking to do possible and, if so, how is it achieved? </p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","winforms","textbox","treeview"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":280,"score":0,"question_id":11084027,"title":"C#:Search from treeview","body":"<p>I got a treeview data loaded from a XML file. I want to perform a search when the user types something in the textbox. Is that the right way of doing it?? I just want to filter the data. Please show me some example.</p>\n\n<p>The below code is not working.</p>\n\n<pre><code> textBox1.Enter += new EventHandler(txtSearch_TextChanged);\n\n private void txtSearch_TextChanged(object sender, EventArgs e)\n        {\n\n            foreach (TreeNode node in this.treeView1.Nodes)\n            {\n\n                if (node.Text.ToUpper().Contains(this.textBox1.Text.ToUpper()))\n                {\n\n                    treeView1.SelectedNode = node;\n\n                    break;\n\n                }\n  }\n</code></pre>\n"},{"tags":["c#","winforms","listview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":107,"score":0,"question_id":11230123,"title":"ListView Autosize based on whether or not contents exist","body":"<p>I have a <code>ListView</code> with a view of <code>View.Details</code> and I want to AutoSize the columns. I am aware of the <code>ColumnHeader</code>'s <code>AutoResize</code> method and currently I'm just iterating through them like so:</p>\n\n<pre><code>var lMode = ( listView.Items.Count == 0 ) ? ColumnHeaderAutoResizeStyle.HeaderSize : ColumnHeaderAutoResizeStyle.ColumnContent;\nforeach ( ColumnHeader lColumnHeader in listView.Columns )\n{\n    lColumnHeader.AutoResize(lMode);\n}\n</code></pre>\n\n<p>The problem with this technique is that if I have a column which happens to have no data in it, the width gets set to a point the header is no longer available. Is there a nice way of conditionally setting the <code>ColumnHeaderAutoResizeStyle</code> based on whether or not there are contents in the column?</p>\n\n<p>If there is something in the column I want to use <code>ColumnHeaderAutoResizeStyle.ColumnContent</code>, but if there is nothing in the column, I want to use <code>ColumnHeaderAutoResizeStyle.HeaderSize</code>.</p>\n"},{"tags":["c#","winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13257590,"title":"PrintpreviewDialog document fail to send printer?","body":"<p>I have a strange problem.  My print document appears in printprieviewdialoge but after clicking on print icon I am getting blank paper by printer.\nIs there problem of PrintPriviewDialoge?\nIf I send document to printer before getting in showdialog it works but after showdialog does not print.</p>\n\n<pre><code>for (int i = 0; i &lt; caixasFiscais.Count; i++)\n{\nCaixaECF caixa = new CaixaECF(loja, caixasFiscais[i], data1, data2);\nposicaoDaLinha = margemSup + (linhaAtual * Convert.ToInt32(fonteNormal.GetHeight(e.Graphics)));\ne.Graphics.DrawLine(new Pen(Brushes.LightSteelBlue, 30), margemEsq, posicaoDaLinha, margemDir, posicaoDaLinha);\ne.Graphics.DrawString(\"CAIXA FISCAL \" + caixa.numero, fonteNegrito, Brushes.Black, margemEsq, (posicaoDaLinha - 5.5f), new StringFormat());\ne.Graphics.DrawString(\"CREDITOS\", fonteNegrito, Brushes.Black, margemEsq + 150, (posicaoDaLinha - 5.5f), new StringFormat());\ne.Graphics.DrawString(\"DEBITOS\", fonteNegrito, Brushes.Black, margemEsq + 350, (posicaoDaLinha - 5.5f), new StringFormat());\ne.Graphics.DrawString(\"GAVETA\", fonteNegrito, Brushes.Black, margemEsq + 550, (posicaoDaLinha - 5.5f), new StringFormat());\nlinhaAtual++;}\n</code></pre>\n\n<p>i also tried to save as pdf file but same not saving data. but printpreviewdialog showing absolutely well report.</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":13223917,"title":"Why does ShowDialogue() fire Close() when setting Visible = false in Show()?","body":"<p>When I set Visible = false in the show event of a Form shown with ShowDialogue() the form will automatically call it's close event.  I don't want to close the form...just hide it.  So I have to call Show() instead.  But, this doesn't block.  </p>\n\n<p>Why does setting Visible = false causes form close to fire with ShowDialogue()?  Is this a bug?</p>\n"},{"tags":[".net","winforms","icons","color-depth"],"answer_count":1,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":132,"score":7,"question_id":12826990,"title":"WinForms app uses low-quality title bar icon on 16-bit display","body":"<p>On displays with 16-bit color depth (including Remote Desktop sessions set to 16-bit color), Windows Forms applications use a low-color-depth version of the assigned title-bar icon (<code>Form.Icon</code>). WPF applications and Windows Explorer, however, use the 24-bit color depth, if it exists.</p>\n\n<p>I first saw this in a Windows Forms application I'm currently working on. The icon I was using had 4-bit, 24-bit, and 32-bit variants defined.  On 16-bit displays, Windows Forms was using the ugly 4-bit version in the title bar instead of the nice-looking 24- or 32-bit version.</p>\n\n<p>To test and illustrate the behavior, I created a test icon with obviously different designs for each size and color format. I included 4-bit, 8-bit, 24-bit, and 32-bit variants.</p>\n\n<p>Here are the results on both 32-bit and 16-bit displays:</p>\n\n<h2>On 32-bit displays, all is well:</h2>\n\n<p><strong>Windows Explorer:</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/eDurb.png\" alt=\"Windows Explorer, 32-bit display\"></p>\n\n<p><strong>WPF Application:</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/VEush.png\" alt=\"WPF Application, 32-bit display\"></p>\n\n<p><strong>Windows Forms Application:</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/yAMSR.png\" alt=\"Windows Forms Application, 32-bit display\"></p>\n\n<h2>On 16-bit displays, Windows Forms displays a lower-color-depth variant of the icon than does WPF or Windows Explorer:</h2>\n\n<p><strong>Windows Explorer:</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/dVVmx.png\" alt=\"Windows Explorer, 16-bit display\"></p>\n\n<p><strong>WPF Application:</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/pU7gz.png\" alt=\"WPF Application, 16-bit display\"></p>\n\n<p><strong>Windows Forms Application:</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/wDIZO.png\" alt=\"Windows Forms Application, 16-bit display\"></p>\n\n<p>On 16-bit displays, Windows Explorer and WPF use the 24-bit format, but Windows Forms does not.  In this case, it used the 8-bit format. My real application icon did not have an 8-bit variant (but I'm going to make one now!), so Windows Forms used the 4-bit variant.</p>\n\n<p><strong>How can I make my Windows Forms application display the 24-bit version of an icon in its title bar on a 16-bit display?</strong></p>\n"},{"tags":["c#","winforms","satellite-assembly"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13255599,"title":"How to get location of current culture's satellite assembly?","body":"<p>My C#/WF application uses some files, which are different for different languages. These file <strong>can not</strong> be placed as resources in satellite assemblies. I wish however to put them in the same directories as the satellite assemblies reside, but I need to know actually where the assembly resides (including the situation, when default language embedded in the binary file is used).</p>\n\n<p>For example, when application switches automatically to polish language, I wish to retreive location:</p>\n\n<p>D:\\&lt;app folder&gt;\\pl-PL\\</p>\n\n<p>Is there a way to do so? Please note, that I wish to retreive this information from the assembly and not by guessing the folder location.</p>\n"},{"tags":["vb.net","winforms","anchor"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":116,"score":0,"question_id":10478742,"title":"Button anchor property does not work on autoscroll panel","body":"<p>I have an autoscroll panel with a button on it, the problem is that anchor property position of this button is not working as this property is set to 'Bottom and right' and always overlab     with panel's buttom.\nplease how do I resolve this issue.</p>\n"},{"tags":["winforms","visual-studio-2010"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1207,"score":3,"question_id":7010564,"title":"How can I to remove or reset the tab order in VS 2010","body":"<p>I have a tab order set, but have rearranged a lot of controls, added more, removed some. \nSo now when I click view Tab Order it show the tab oeders by cluttering the screen with tons of numbers. Is there a way to clear these and start over?\nI tried setting tabstop to false on the controls, hoping it would 'clear' their entries in the View Tab Order, but when I go back to view the tab order they still have numbers in them.</p>\n\n<p>Any assistance would be greatly appreciated.</p>\n"},{"tags":["c#","winforms","visual-studio-2005","tab-ordering"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1213,"score":1,"question_id":3063829,"title":"WinForms TabOrder tool: Broken or just confusing?","body":"<p>I have a form with a bunch of panels, and some panels inside groupboxes. When using the TabOrder tool in Vs2005, the controls outside of containers are given integers (0), the controls inside panels are given decimals (72.0), and the controls within panels within groupboxes are given three-part values (73.73.0). Unfortunately the resulting tab order has nothing to do with the order I clicked my controls.</p>\n\n<p>Does this tool simply not support nested containers? Am I doing something wrong? Perhaps holding Shift- or Ctrl- when I click (I've tried these with no success)?</p>\n\n<p>Am I going to be forced to manually type in three-part tab orders for all my controls? That would be a bummer.</p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":23,"score":2,"question_id":13254929,"title":"Can I have a DataGridView cell where I can type OR choose from a drop-down list?","body":"<p>This is my first time using the DataGridView, and it's a bit overwhelming (so many options!).</p>\n\n<p>I'd like to display a list of properties, one per row. Each row is a name/value pair. The names of the properties are fixed, but the user is free to enter any value.</p>\n\n<p>Now, since each property has a <strong>list of already-used values</strong>, I'd like those to be available to the user in a <strong>drop-down list</strong>. However, I'd also like the user to be able to <strong>type a new value</strong>. Ideally, the value should auto-complete as the user types.</p>\n\n<p>I've tried using a column with the DataGridViewComboBoxColumn style, and since a standard combo box supports the type-or-edit way of working, I though that this would work. However, it seems to <em>only</em> allow selecting from the list (plus, pressing a key will automatically select the first matching entry from the list). There seems to be no way to type a new value. </p>\n\n<p>Which of the 844 properties should I set? :-)</p>\n"},{"tags":["c#","winforms",".net-4.0"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":40,"score":-1,"question_id":13255802,"title":"TextBox values are not updated from external method?","body":"<p>I have a simple GUI with 6 textboxes.</p>\n\n<p>I have a method that takes 7 parameters, 1 being a long string and the other 6 being the textboxes.  The method looks like this:</p>\n\n<pre><code>SetTextBoxesFromTokens(string s, string a, string b, string c, string d, string e, string f)\n{\nstring[] tokens = s.Split('-');\n\na = tokens[0];\nb = tokens[1];\nc = tokens[2];\nd = tokens[3];\ne = tokens[4];\nf = tokens[5];\n}\n</code></pre>\n\n<p>I am calling the above method like so, but it is not updating the text boxes:</p>\n\n<pre><code>SetTextBoxesFromTokens(\"1-2-3-4-5-6\",\n        txtA.Text,txtB.Text,txtC.Text,txtD.Text,txtE.Text,txtF.Text);\n</code></pre>\n"},{"tags":["c#","winforms","coded-ui-tests"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13250842,"title":"How get checkbox or checked property from WinTreeItem into WinTree (Coded UI)?","body":"<p>I created Coded UI test which works with WinTree element.\nI need to check 'checked' prorerty from some WinTreeItem.</p>\n\n<p>'Checked' prorperty I can get from WinCheckBoxTreeItem, but I don't know how to get this checkbox.</p>\n\n<p>Maybe do you know way to convert WinTreeItem to WinCheckboxTreeItem or get WinCheckbox from WinTreeItem.</p>\n\n<p>You are only last hope! </p>\n\n<p>Thank you.</p>\n"},{"tags":[".net","winforms","deployment"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13256095,"title":"Deployment solution for Windows Applications","body":"<p>I have a tool that allows developers to deploy their applications in our environments in here and, when it comes to ASP.NET Applications they publish their entire application with a <strong>transformed web.config</strong>, for instance, a file without connection strings settings.</p>\n\n<p>This is done because we have one DEVELOPMENT ENVIRONMENT with a \"parent-level\" web.config which has the defined connectionstring pointing to the development database. Later on, when the developer wants to deploy his solution in the PRODUCTION ENVIRONMENT, because of the parent-level web.config, it point to the proper Production database.</p>\n\n<p>I'd like this behavior to be similar to Windows Applications. I know that probably I could put the connectionstrings in the machine.config file, but that file is a little too big and too critical to be touched. I'd like something like this:</p>\n\n<pre><code>|_PARENT FOLDER\n|---parent.app.config (with connectionstring)\n|___EXECUTABLE FOLDER\n|------MyExe.exe\n|------samelevel.app.config (without connectionstrings)\n</code></pre>\n\n<p>When the MyExe.exe executable tries to retrieve the connectionstring and finds out that there is none in the <strong>samelevel.app.config</strong> file, then it would automatically go into the parent level (or any other configured folder) and get it from the <strong>parent.app.config</strong> file.</p>\n\n<p>Is it possible to be done?</p>\n"},{"tags":["c#","winforms","find","bindingsource","multiple-columns"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5395,"score":0,"question_id":1767018,"title":"BindingSource.Find Multiple Columns","body":"<p>Is it possible to use the Find method of a BindingSource on multiple columns?  </p>\n\n<p>For example, say I have a gridview displaying current pets; two comboboxes, cboPetType and cboGender; and a button to create a new record into the Pet table based on the values of these two comboboxes.</p>\n\n<p>Now, let's say I only want one of each PetType/Gender combination (Dog - M, Cat - F, etc.).  So, if I have a Dog - M pet in my BindingSource and a user selects Dog and M from the comboboxes, I would like to stop the user to inform them that combination already exists.</p>\n\n<p>In the past, I have used the BindingSource.Find method to do something similar, but, as far as I can tell, that is only good for searching one column (i.e. BindingSource.Find(\"PetType\", cboPetType.SelectedValue);).</p>\n\n<p>Is it possible to search a bindingsource based on multiple columns?  If not, any suggestions to achieve my desired result?  Any advice is greatly appreciated!</p>\n"},{"tags":["winforms","usability"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":221,"score":1,"question_id":3163669,"title":"WinForms Usability and Best Practices","body":"<p>What are some of the different Usability tips/tricks and best practices followed<br>\nwith WinForms-based applications, or which are followed as a Standard?</p>\n\n<p>These might be anything like font styles/sizes/color, number of controls on form, showing processing, error checking, themes, layout of controls, etc.  </p>\n\n<p>Any resources/links or checklists? </p>\n\n<p>Thanks Everyone!</p>\n"},{"tags":["winforms","flicker","redraw"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13254213,"title":"How to prevent the redraw of a managed winform on programmatic resize?","body":"<p>I have a .net 4.0 winforms project where I need to programmatically set the bounds (aka size) of a window (System.Windows.Forms.Form) and add/remove controls to/from it, at the same time, without visible flicker. The form is not user-resizable, the only place where its size is changed is the this.Bounds = foo / this.DesktopBounds = foo / ... call.</p>\n\n<p>I already read about preventing flicker by sending WM_SETREDRAW using p/invoke, and about SuspendRedraw/SuspendLayout and friends. I still see flicker happening, and nailed the prob down to:</p>\n\n<p>Windows redraws the form on setting its bounds/size, even if redraw was disabled.</p>\n\n<p>I guess this is caused not by the form itself, but by the window manager somehow?</p>\n\n<p>So - is there a way to absolutely prevent redrawing anything, in any circumstances, and then re-enabling redraw and refresh manually afterwards? Kind of \"freeze window and display a snapshot\", change stuff, and \"replace snapshot with updated window (incl. position and size) in 1 go\" ?</p>\n\n<p>Thanks, cheers,\n  Tim</p>\n"},{"tags":["c#","winforms","webbrowser-control"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":807,"score":2,"question_id":11407992,"title":"Capture the mouse right click event of a web browser control","body":"<p>I would like to select all when a user right clicks on my web browser control.</p>\n\n<p>I am developing a win forms app, and use web browsers to display my information, because i can use html to style the words.</p>\n\n<p>The right click context menu is not working for me. The options on it are all irrelevant to my app.</p>\n\n<p>But the context menu after a select has been made i want to keep, the copy, cut, paste options.</p>\n\n<p>I can already select all:</p>\n\n<pre><code>getCurrentBrowser().Document.ExecCommand(\"SelectAll\", true, null);\n</code></pre>\n\n<p>I would just like to do it in the right click event of the web browser?</p>\n"},{"tags":[".net","windows","winforms","datagrid","compact-framework"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12143734,"title":"Make DataGrid cells readonly","body":"<p>There is DataGrid (WinForms / .NET CF 3.5) bounded with DataSource to list object.\nHow to disable data editing in cells?</p>\n"},{"tags":["c#","winforms","linq","recursion"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":103,"score":0,"question_id":13227170,"title":"Recursive Lookup of generic List C# using LINQ","body":"<p>I have generic list of a custom class which has 2 properties. These properties store the raltionship between on form and another form. The list is structured as a hierachical list (parent / child ) relationship. What I want to be able to do is get a list of all forms based on a parent form reference which will be passed to a function. I am thinking the best way to go about this is with a LINQ query using a recursive approach. I am sure someone can point me in the right direction</p>\n\n<p>This is the class used in the list </p>\n\n<pre><code>class FormStack    {\n\n    #region Declares\n\n    private Form _form;\n    private Form _parent;\n\n    #endregion\n\n    #region Constructor\n\n    static FormStack()\n    {\n    }\n\n    #endregion\n\n    public Form Form\n    {\n        get { return _form; }\n        set { _form = value; }\n    }\n\n    public Form Parent\n    {\n        get { return _parent; }\n        set { _parent = value; }\n    }\n\n}\n</code></pre>\n\n<p>So I would like to be able to Call a method and pass a form reference to the function and get all the children form related to this parent.</p>\n\n<p>This is some of the code I have been stumbling with</p>\n\n<pre><code>// create a lookup list\nvar list = formStack.ToLookup( p =&gt; object.ReferenceEquals( p.Parent, parent ) );\n\n// create a function\nFunc&lt;IEnumerable&lt;Form&gt;, IEnumerable&lt;Form&gt;&gt; recurse = null;\nrecurse = qs =&gt;\n{\n    return\n        qs\n            .Concat(\n                from q in qs\n                from q2 in recurse( list[] )\n                select q2 );\n};\n\n// filter the list\nvar children = recurse( list[parent] ).ToList();\n</code></pre>\n\n<p>I have a winform application which has standard CRUD functionality. Lets say there is a list of customers and each customer can have multiple address and each one of these addresses have multiple buildings, the way I have structured the forms is there is a list of customers, from this list you can open a detail form for a particular customer. This form has the details of the customer and all the addresses in a list. This list allows the user to now selected an address in the list and open the address details form which has a list of buildings and so on.... My problem is I want to close the customer detail and all the related forms for this customer. My idea was to keep of the relationship between the forms, but maybe I there is a better way???</p>\n"},{"tags":["c#","winforms","exception","xml-serialization","richtextbox"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":66,"score":0,"question_id":13253521,"title":"Couldn't capture all the exceptions at once C#","body":"<p>I'm de-serilaizing a xml file and I'm trying to capture all the exceptions art one using the below code but it's capturing just one exception. What is the mistake am i doing here??</p>\n\n<p>Code:</p>\n\n<pre><code>StringBuilder exBuilder;\nif (openFileDialog1.ShowDialog() == DialogResult.OK)\n{\n    var fileName = openFileDialog1.FileName;\n    mruOpenRseConfig.AddRecentFile(fileName);\n    try\n    {\n        ConfigDeserialized = MyConfig.DeserializeFromXmlFile(fileName);\n\n    }\n\n    catch (Exception ex)\n    {\n        if (ex is DataConsistencyException ||\n            ex is XmlException)\n        {\n            exBuilder.Clear();\n            exBuilder.Append(ex.Message + Environment.NewLine);\n\n            RichTextBox richTextBox = new RichTextBox();\n\n            richTextBox.Text = exBuilder;\n            richTextBox.Dock = DockStyle.Fill;\n\n\n            Form richMessageBox = new Form\n            {\n                StartPosition = FormStartPosition.CenterScreen,\n                ControlBox = true,\n                Text = \"Error in File\",\n                MaximizeBox = false,\n                MinimizeBox = false\n            };\n\n            richMessageBox.Controls.Add(richTextBox);\n\n            richMessageBox.ShowDialog();\n            return;\n        }\n        throw;\n    }\n}\n</code></pre>\n"},{"tags":["c#","winforms","listview"],"answer_count":6,"favorite_count":12,"up_vote_count":32,"down_vote_count":0,"view_count":113851,"score":32,"question_id":473148,"title":"C# listView, how do I add items to columns 2, 3 and 4 etc?","body":"<p>To add items to column 1 in my <code>listView</code> control (<code>Winform</code>) I'm using <code>listView1.Items.Add</code>, this works fine but how do I add items to columns 2 and 3 etc? It's the first time I've used <code>listView</code>.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","winforms","listview","selectedindex"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1218,"score":0,"question_id":6342790,"title":"Help with listView and .SelectedItem in C#","body":"<p>Within my winform(C#) I have listView with two columns, which is used to display the results from searching an array, which is the basic details of an array entry(All data within the array is type string). I am able to add and remove items to the listview, but I would like to be able to gain the value of the row that has been clicked within the listview. </p>\n\n<p>I am planning to use this to update the display full entry info, but I cannot gain the value of the selected item. I was reading elsewhere and saw people mentioning the .SelectedIndex property, but this property is not available to me when I am trying to code. </p>\n\n<p>I could use two listboxes instead of a listview, but the listview is much neater. Also, I am a sofware design (high school) student, and have been learning C# for one and a half years. I am competent at programming, but I start to get lost when things start to get very complex. </p>\n\n<p>Can anybody help?</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13252941,"title":"Displaying a large collection of large images","body":"<p>OK, I thought this was a fairly simple task, but apparently it isn't ...</p>\n\n<p>I have a folder with +1000 photos in it. These are all photos taken with a camera, each about 3 MB. Users need to be able to view these pictures (as a list), rename or delete them. That's it.</p>\n\n<p>A possible solution would be this control : <a href=\"http://www.codeproject.com/Articles/43265/ImageListView\" rel=\"nofollow\">ImageListView - CodeProject</a>\n<br>but because it has an Apache license, we can't use it.</p>\n\n<p>So how to do it? Any ideas or suggestions? I'm using .NET 2.0</p>\n\n<p>.... EDIT : .....................................</p>\n\n<p>OK, apparently we CAN use the Apache license. (Also see: <a href=\"http://stackoverflow.com/questions/1007338/can-i-use-a-library-under-the-apache-software-license-2-0-in-a-commercial-applic\">Can I use a library under the Apache Software License 2.0 in a commercial application?</a>) However, using the license is very confusing for me. I read the following guide but still don't exactly know how to apply it to  our project : <a href=\"http://blog.maestropublishing.com/how-to-apply-the-apache-20-license-to-your-pr\" rel=\"nofollow\">http://blog.maestropublishing.com/how-to-apply-the-apache-20-license-to-your-pr</a></p>\n\n<p>it says: </p>\n\n<blockquote>\n  <p>you need two files in the root or top directory of your distribution.  </p>\n</blockquote>\n\n<p>What's exactly meant by 'distribution'? Is that our installed application, and top directory meaning Program files/OurApp/ ?</p>\n\n<p>It also says:</p>\n\n<blockquote>\n  <p>Replace all [bracketed] items in the above notice statement. There are only two of these items so should not be hard for you to do.</p>\n</blockquote>\n\n<p>But that would give me a notice file, reading :</p>\n\n<blockquote>\n  <p>Copyright 2012 OUR_COMPANY</p>\n  \n  <p>Licensed under the Apache License, etc...</p>\n</blockquote>\n\n<p>But our app isn't licensed under the Apache license?</p>\n\n<p>I'm sorry but I'm very confused and don't want to make any mistakes with this legal stuff...\nWhat would I need to do exactly to be able to use this control?</p>\n"},{"tags":["c#","winforms","treeview"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":4609,"score":3,"question_id":800230,"title":"Windows Forms TreeView always selects a node on focus","body":"<p>The TreeView in Windows Forms always seems to want a node selected when it regains focus.  If I have no nodes selected, and that treeview gains focus, I'll get an <code>AfterSelect</code> event with the first node selected, even though I didn't select it using the keyboard, mouse, or programmatically.  The only workaround I can find is to check if the <code>TreeViewCancelEventArgs.Action</code> equals <code>TreeViewAction.Unknown</code> and then canceling the selection.  This seems really hacky, so I'm wondering if there's another way to fix this.</p>\n"},{"tags":["winforms","infragistics"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13253481,"title":"WinForms (Infragistics Controls) - Deploying tabs from right to left and changin RibbonGroup size","body":"<p>I'm using ultraToolbarsManager (by Infragistics) and I'm facing 2 problems:\n1. I can't find out how to deploy the tabs from right to left.\n2. I want to \"stretch\" one of 2 RibbonGroups to cover the entire Ribbon.</p>\n\n<p></p>\n"},{"tags":["c#",".net","winforms","embedded-resource"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13252565,"title":"When setting Build Action = Embedded resources in a resource file, \"Insufficient system resources\" error","body":"<p>VS:2008 C# Winforms project, I am working on.</p>\n\n<p>I added a file in resources and set its build action = Embedded Resources, then after I compiled the project, and an error occurred that insufficient system resources exist to complete the requested service.</p>\n\n<p>full description of Error:</p>\n\n<blockquote>\n  <p>Could not write to output file '&lt;>' -- 'Insufficient system resources exist to complete the requested service. '</p>\n</blockquote>\n\n<p>Can anybody tell me why this error occured and how to resolve this issue?</p>\n"},{"tags":["c#","winforms","custom-controls","propertygrid","design-time"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":153,"score":2,"question_id":13044221,"title":"Clear InnerList elements of a custom control property after delete custom control from a form in Design Mode","body":"<p>I add my created custom control to the new Windows Form and add some Tab to it by \"Tabs\" property. However, when I delete my custom control from Windows Form, elements of \"Tabs\" property are not removed. Please see below figures for more information:</p>\n\n<p><img src=\"http://i.stack.imgur.com/Kpsi9.png\" alt=\"My custom control &quot;Tabs&quot; property with its Collection Editor\"></p>\n\n<p><strong>Figure 1 - My custom control \"Tabs\" property with its Collection Editor</strong></p>\n\n<ol>\n<li>Blue Box: \"Tabs\" property of my custom control</li>\n<li>Red Box: Added elements to the \"Tabs\" property</li>\n</ol>\n\n<p>Figure 1 displays when I add some member to the Tabs property.</p>\n\n<p><img src=\"http://i.stack.imgur.com/zKbMV.png\" alt=\"Windows Form project controls after add some member to the Tabs property\"></p>\n\n<p><strong>Figure 2 - Windows Form project controls after add some member to the Tabs property</strong></p>\n\n<ol>\n<li>Red Box: My custom control</li>\n<li>Blue Box: Added elements to the Tabs property</li>\n</ol>\n\n<p><img src=\"http://i.stack.imgur.com/EKdFq.jpg\" alt=\"Windows Form project controls after delete my custom control from Windows Form\"></p>\n\n<p><strong>Figure 3 - Windows Form project controls after delete my custom control from Windows Form</strong></p>\n\n<ul>\n<li>Red Box: Added elements to the Tabs property</li>\n</ul>\n\n<p>As you can see in the figure 2 and 3, I add some member to the Tabs property and after delete my custom control from its parent control (Windows Form), Tabs property members have not been removed.</p>\n\n<p>My Tabs property is related to the Tabs class that derived from CollectionBase class and implement some methods such as Add, Remove, Clear and, etc. to it. And I call Clear and RemoveRange methods in the Dispose method, but it doesn't work.</p>\n\n<p>My codes as follows:</p>\n\n<pre><code>[Designer(\"System.Windows.Forms.Design.ParentControlDesigner, System.Design\", typeof(IDesigner))]\n[ToolboxItem(true), ToolboxBitmap(typeof(ToolboxIconResourceFinder), \"FloorsGrouping.bmp\")]\n[DisplayName(\"Floors Group\")]\n[Editor(\"WindowsFormsControlLibrary2.FloorsGrouping, WindowsFormsControlLibrary2, Version=1.0.0.0, Culture=neutral, PublicKeyToken=197889249da45bfc\", typeof(UITypeEditor))]\n[Description(\"Floorssssssss\")]\n[Category(\"Saino\")]\n//[DefaultEvent(\"\")]\n[DefaultProperty(\"Text\")]\n[DesignerCategory(\"Component\")] //Form //Designer //Empty String (\"\")\npublic partial class FloorsGrouping : Bar\n{\n    private static Font fntDefaultFont = SystemFonts.DefaultFont;\n    private static string strDefaultAccessibleDescription = \"\";\n    private static string strDefaultAccessibleName = \"\";\n\n    private bool canDockBottom = false;\n    private bool canDockTop = false;\n    private bool fadeEffect = true;\n    private int selectedDockTab = 0;\n    private eDotNetBarStyle style = eDotNetBarStyle.StyleManagerControlled;\n    private string text = \"Floors Grouping\";\n    private FloorsInformation floorsInformation = new FloorsInformation();\n    private Tabs tabs = new Tabs();\n    private SupportedLanguages language = SupportedLanguages.English;\n    private Styles groupingStyles = Styles.Classic;\n\n    public FloorsGrouping()\n    {\n        InitializeComponent();\n        ResetFont();\n        ResetAccessibleDescription();\n        ResetAccessibleName();\n    }\n\n    /// &lt;summary&gt;\n    /// Required designer variable.\n    /// &lt;/summary&gt;\n    private System.ComponentModel.IContainer components = null;\n\n    /// &lt;summary&gt;\n    /// Clean up any resources being used.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"disposing\"&gt;true if managed resources should be disposed; otherwise, false.&lt;/param&gt;\n    protected override void Dispose(bool disposing)\n    {\n        Tab.Clear();\n        Tab.RemoveRange(0, Tab.Count);\n        if (disposing &amp;&amp; (components != null))\n        {\n            components.Dispose();\n        }\n        base.Dispose(disposing);\n    }\n\n    private new void ResetFont()\n    {\n        Font = fntDefaultFont;\n    }\n\n    private new bool ShouldSerializeFont()\n    {\n        return !Font.Equals(fntDefaultFont);\n    }\n\n    [Category(\"Data\")]\n    [DisplayName(\"Tabs\")]\n    [Description(\"Tabsssssssssssss\")]\n    [DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]\n    [Editor(typeof(ItemsCollectionEditor), typeof(UITypeEditor))]\n    //[Editor(typeof(ItemsCollectionEditor&lt;SimilarFloorsInformation&gt;), typeof(UITypeEditor))]\n    //[Editor(typeof(CollectionEditor), typeof(UITypeEditor))]\n    public Tabs Tab\n    {\n        get\n        {\n            return tabs;\n        }\n    }\n\n    [Category(\"Behavior\")]\n    [DisplayName(\"ContainerControl\")]\n    [Description(\"It indicates container control high lighter is bound to. It should be set to parent form.\")]\n    //[DefaultValue(\"\")]\n    [DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]\n    [Browsable(false), ReadOnly(true)]\n    [EditorBrowsable(EditorBrowsableState.Never)]\n    public Control ContainerControl\n    {\n        get { return hltMain.ContainerControl; }\n        private set { hltMain.ContainerControl = this; }\n    }\n\n    protected override void OnParentChanged(EventArgs e)\n    {\n        ContainerControl = this;\n    }\n    protected override void OnCreateControl()\n    {\n        base.OnCreateControl();\n    }\n\n    protected override void OnControlRemoved(ControlEventArgs e)\n    {\n        //Tab.RemoveRange(0, tabs.Count);\n        //Parent.Refresh();\n        base.OnControlRemoved(e);\n    }\n\n    protected override void OnPaint(PaintEventArgs pe)\n    {\n        base.OnPaint(pe);\n    }\n}\n\n[DisplayName(\"Floors Information\")]\n[Description(\"Floors Informationnnnnnnnnnnnnnnn\")]\n[DefaultProperty(\"Text\")]\n[DesignerCategory(\"Component\")]\n[ToolboxItem(false)]\npublic class FloorsInformation : DockContainerItem\n{\n    /// &lt;summary&gt;\n    /// Required designer variable.\n    /// &lt;/summary&gt;\n    private System.ComponentModel.IContainer components = null;\n\n    private SimilarFloorsInformation similarFloorsInformation = new SimilarFloorsInformation();\n    private AllFloorsInformation allFloorsInformation = new AllFloorsInformation();\n    private string text = \"Floors Information\";\n\n    public FloorsInformation()\n    {\n    }\n\n    [Browsable(false), ReadOnly(true)]\n    [EditorBrowsable(EditorBrowsableState.Never)]\n    public new bool AutoCollapseOnClick\n    {\n        get { return base.AutoCollapseOnClick; }\n    }\n\n    [Browsable(false), ReadOnly(true)]\n    [EditorBrowsable(EditorBrowsableState.Never)]\n    public new Control Control\n    {\n        get { return base.Control; }\n    }\n\n    public new string Text\n    {\n        get\n        {\n            return text;\n        }\n        set\n        {\n            text = value;\n        }\n    }\n\n    [Category(\"Data\")]\n    [DisplayName(\"Similar Floors Panel\")]\n    [Description(\"Similar Floors Panellllllllllllllllllll\")]\n    [DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]\n    public SimilarFloorsInformation SimilarFloorsInfo\n    {\n        get\n        {\n            return similarFloorsInformation;\n        }\n        set\n        {\n            similarFloorsInformation = value;\n        }\n    }\n\n    [Category(\"Data\")]\n    [DisplayName(\"All Floors Group\")]\n    [Description(\"All Floors Groupppppppppppppp\")]\n    [DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]\n    public AllFloorsInformation AllFloorsInfo\n    {\n        get\n        {\n            return allFloorsInformation;\n        }\n        set\n        {\n            allFloorsInformation = value;\n        }\n    }\n\n    protected override void Dispose(bool disposing)\n    {\n        if (disposing &amp;&amp; (components != null))\n        {\n            components.Dispose();\n        }\n        base.Dispose(disposing);\n    }\n}\n\npublic class Tabs : CollectionBase\n{\n    public FloorsInformation this[int intIndex]\n    {\n        get\n        {\n            return (FloorsInformation)InnerList[intIndex];\n        }\n        set\n        {\n            InnerList[intIndex] = value;\n        }\n    }\n\n    public int Add(FloorsInformation finfItemType)\n    {\n        return InnerList.Add(finfItemType);\n    }\n\n    public new void Clear()\n    {\n        InnerList.Clear();\n    }\n\n    public bool Contains(FloorsInformation finfItemType)\n    {\n        return InnerList.Contains(finfItemType);\n    }\n\n    public void Remove(FloorsInformation finfItemType)\n    {\n        InnerList.Remove(finfItemType);\n    }\n\n    public new void RemoveAt(int intIndex)\n    {\n        InnerList.RemoveAt(intIndex);\n    }\n\n    public void RemoveRange(int intIndex, int intCount)\n    {\n        InnerList.RemoveRange(intIndex, intCount);\n    }\n\n    public void Insert(int intIndex, FloorsInformation finfItemType)\n    {\n        InnerList.Insert(intIndex, finfItemType);\n    }\n\n    public void Reverse()\n    {\n        InnerList.Reverse();\n    }\n\n    public void Reverse(int intIndex, int intCount)\n    {\n        InnerList.Reverse(intIndex, intCount);\n    }\n\n    public int IndexOf(FloorsInformation finfItemType)\n    {\n        return InnerList.IndexOf(finfItemType);\n    }\n\n    public void AddRange(FloorsInformation[] finfItemType)\n    {\n        InnerList.AddRange(finfItemType);\n    }\n\n    public FloorsInformation[] GetValues()\n    {\n        FloorsInformation[] finfItemType = new FloorsInformation[InnerList.Count];\n        InnerList.CopyTo(0, finfItemType, 0, InnerList.Count);\n        return finfItemType;\n    }\n\n    protected override void OnInsert(int intIndex, object objValue)\n    {\n        base.OnInsert(intIndex, objValue);\n    }\n\n    protected override void OnClear()\n    {\n        base.OnClear();\n    }\n}\n\npublic class ItemsCollectionEditor : CollectionEditor\n{\n    private Type[] typItems;\n\n    public ItemsCollectionEditor(Type typItem)\n        : base(typItem)\n    {\n        typItems = new Type[] { typeof(FloorsInformation) };\n    }\n\n    protected override Type[] CreateNewItemTypes()\n    {\n        return typItems;\n    }\n\n    protected override CollectionForm CreateCollectionForm()\n    {\n        CollectionForm collectionForm = base.CreateCollectionForm();\n        collectionForm.Text = \"Tabs Collection Editor\";\n        return collectionForm;\n        //return base.CreateCollectionForm();\n    }\n}\n</code></pre>\n\n<p>I want to do something like Bar controls of DevComponents.DotNetBar. Please see the following for more information:</p>\n\n<p><img src=\"http://i.stack.imgur.com/TqoHc.png\" alt=\"Add Bar control to the Windows Form\"></p>\n\n<p><strong>Figure 4 - Add Bar control to the Windows Form</strong></p>\n\n<ol>\n<li>Left Red Box: Added Bar control to the Windows Form</li>\n<li>Right Red Box: Added Bar control in the Property Grid of Visual\nStudio</li>\n</ol>\n\n<p>When Bar control is added to the Windows Form, Property Grid changes as you can see in the Figure 4.</p>\n\n<p><img src=\"http://i.stack.imgur.com/Xqv5u.png\" alt=\"Create Dock Tab by &quot;Bar Tasks&quot; option\"></p>\n\n<p><strong>Figure 5 - Create Dock Tab by \"Bar Tasks\" option</strong></p>\n\n<ul>\n<li>Red Box: \"Create Dock Tab\" option under \"Bar Tasks\"</li>\n</ul>\n\n<p>With \"Create Dock Tab\" option under \"Bar Tasks,\" we can create a new Dock Tab for add fresh controls to specific tab of Bar control as you can see in the Figure 5.</p>\n\n<p><img src=\"http://i.stack.imgur.com/43Sc5.png\" alt=\"Added Dock Container Item and its related Panel Dock Container\"></p>\n\n<p><strong>Figure 6 - Added Dock Container Item and its related Panel Dock Container</strong></p>\n\n<ol>\n<li>Red Box: Added Bar control in the Property Grid of Visual Studio</li>\n<li>Left Blue Box: Added Dock Container Item control to the Bar control</li>\n<li>Right Blue Box: Added Dock Container Item control in the Property\nGrid of Visual Studio</li>\n<li>Left Green Box: Added Panel Dock Container control to the Dock\nContainer Item control</li>\n<li>Right Green Box: Added Panel Dock Container control in the Property\nGrid of Visual Studio</li>\n</ol>\n\n<p><img src=\"http://i.stack.imgur.com/ClUj4.png\" alt=\"Added Dock Container Items and its related Panel Dock Containers\"></p>\n\n<p><strong>Figure 7 - Added Dock Container Items and its related Panel Dock Containers</strong></p>\n\n<ol>\n<li>Red Box: Please see Red Box of Figure 6</li>\n<li>Left Blue Box: Added Dock Container Item controls to the Bar\ncontrol</li>\n<li>Right Blue Box: Added Dock Container Item controls in the\nProperty Grid of Visual Studio</li>\n<li>Right Green Box: Added Panel Dock Container controls in the\nProperty Grid of Visual Studio</li>\n</ol>\n\n<p>Each time \"Create Dock Tab\" option is clicked under \"Bar Tasks,\" a new Dock Container Item control with its related Panel Dock Container control is made in the Bar control of DevComponents.DotNetBar (Please see Figure 6 and 7).</p>\n\n<p><img src=\"http://i.stack.imgur.com/2X82C.png\" alt=\"Property Grid of Visual Studio after delete Bar control\"></p>\n\n<p><strong>Figure 8 - Property Grid of Visual Studio after delete Bar control</strong></p>\n\n<ul>\n<li>Red Box: Windows Form control in the Property Grid of Visual Studio</li>\n</ul>\n\n<p>When Bar control is removed from Windows Form, all its related controls are removed with it, and only Windows Form remains.</p>\n\n<p>I want to remove my \"Tabs\" property members automatically after my custom control deletes from its Parent control (Windows Form).</p>\n"},{"tags":["c#","winforms","devexpress"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13235821,"title":"Display values from relation table in xtragrid","body":"<p>Iam having a problem with displaying values from relation table. For example I have table: Person and there I have columns like id, pet_id, name. Another table is Dog with id and name. I like to list all Persons with columns id, pet_id and name. But I like to have name of the dog in cell for column pet_id instead of id to Pet table. I created relation Person_Dog_Relation and in FieldName I choosed it from the list: Person_Dog_Relation.name but it didnt work. All cells in column pet_id are empty.</p>\n\n<p>How I can actualy fill the cells for column pet_id with dog names?</p>\n"},{"tags":[".net","winforms","skinning","winforms-interop","wndproc"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13251027,"title":"Changing border of the main form of the WinForm application","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2575216/resize-winform-with-no-border\">Resize WinForm, with no border?</a>  </p>\n</blockquote>\n\n\n\n<p>I want my WinForm application to NOT have any border. <strong>But still I want to be able to move the application using mouse, resize the application.</strong> </p>\n\n<p>How can I achieve this? </p>\n\n<p>I have gone through some blogs and questions on the Stackoverflow which talk about applying various themes to the WinForm by overriding <code>WndProc</code> method of the Windows <code>Form</code> class. E.g. <a href=\"http://customerborderform.codeplex.com/\" rel=\"nofollow\">http://customerborderform.codeplex.com/</a></p>\n\n<p>Note that I don't want to apply various skins or themes. I just want to make border disappear (or make thickness of the border as small as possible, as if there is just thin border around the main client area of the form). Please note that I do NOT want the title bar at all.</p>\n\n<p>I am using .NET 4.0.</p>\n"},{"tags":["c#","winforms","exception"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":37,"score":-1,"question_id":13251280,"title":"Problen with clearing DataGridView","body":"<p>to everyone!</p>\n\n<p>I have a program for homework. It has to realise a Windows program /Windows Form App/ which containts a data struct of: book name, ISBN, author name, book format, pages and price. User must can add, edit or remove a record, to search by ISBN, author and format, to create a new file, to read and write in file. </p>\n\n<p>On main window I have a DataGridView element which I want to show me all records in my hash table ( there are saved all books ). I don't now how to make it run-time or in new threat so I decided to create a new method and call it after the user add, edit or remove a record ( to refresh the grid ). </p>\n\n<p>Problem:\nWhen I open new text file ( there I must save the records when the program is not working ) there is no problem. Every record is shown in a grid, but when I try to clean the grid and the program throw this -> NullReferance Exception - Object reference not set to an instance of an object.</p>\n\n<p>Can I fix this? At the bottom you'll find a link, there is my project. I'm working for the first time with windows forms and I'm sure there is better way to do everything...</p>\n\n<p>Sorry for my very bad english :(</p>\n\n<p>This is archive (program is incompleate) - <a href=\"http://www11.zippyshare.com/v/18373605/file.html\" rel=\"nofollow\">http://www11.zippyshare.com/v/18373605/file.html</a></p>\n"},{"tags":["c#","winforms","tabcontrol","tabpage"],"answer_count":5,"favorite_count":7,"up_vote_count":27,"down_vote_count":0,"view_count":34167,"score":27,"question_id":552579,"title":"How to hide TabPage from TabControl","body":"<p>How to hide TabPage from TabControl in WinForms 2.0?</p>\n"},{"tags":["c#",".net","winforms","c#-4.0","combobox"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":95,"score":1,"question_id":12872488,"title":"show date in three combo boxes","body":"<p>I am beginner in .net. I need to show <code>day</code>, <code>month</code> and <code>year</code> in three different comboboxes. To make them fill i was trying hardcoded values from 1950 to present year. which i later realized that i need to check for also ferbruary(28 days), leap year and other issues. Is there any other way to do this without hardcoding the values.</p>\n\n<p>while searching for answer on internet i came across datepicker and monthcalendar which i dont want to use(because my project should be unique from my other friends who are using datepicker and monthcalendar). or else if you have any other suggestions instead of comboboxes please share.</p>\n\n<p><img src=\"http://i.stack.imgur.com/g4Fy5.png\" alt=\"enter image description here\"></p>\n\n<p>I am sure someone has asked this question before. I dont mind if you direct the link.</p>\n\n<p>EDITED after <em>nikhil agrawal's</em> answer:</p>\n\n<p><strong>Working Code:</strong> </p>\n\n<pre><code>cmbDay    ---&gt;  combobox\ncmbMonth  ---&gt;  combobox\ncmbYear   ---&gt;  combobox\n</code></pre>\n\n<p><em>FormLoad event</em></p>\n\n<pre><code>        this.cmbYear.Leave+=new EventHandler(cmbYear_Leave);\n        this.cmbDay.Leave += new EventHandler(cmbYear_Leave);\n        this.cmbMonth.Leave += new EventHandler(cmbYear_Leave);\n        //\n        for (int i = 1950; i &lt; 2012; i++)\n        {\n            cmbYear.Items.Add(i.ToString());\n        }\n        for (int i = 1; i &lt; 32; i++)\n        {\n            cmbDay.Items.Add(i.ToString());\n        }\n        //\n        cmbDay.SelectedIndex = 0;\n        cmbMonth.SelectedIndex = 0;\n        cmbYear.SelectedIndex = 0;\n</code></pre>\n\n<p><em>OnLeave Event</em></p>\n\n<pre><code>private void cmbYear_Leave(object sender, EventArgs e)\n    {\n        int day = DateTime.DaysInMonth(Convert.ToInt32(cmbYear.Text), cmbMonth.SelectedIndex+1);                       \n        if (day &lt;= cmbDay.SelectedIndex)\n        {\n            //alert message or your managing code.\n        }\n    }             \n</code></pre>\n\n<p>PS: <code>cmbMonth</code> is in string format (\"Jan\",\"Feb\",\"Mar\",...)</p>\n"},{"tags":["winforms","devexpress","text-editor"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13240257,"title":"DevExpress DateEdit in standalone mode on form: any way to eliminate highlight of the Month name?","body":"<p>When the user selects a date from the calendar view dropdown, the editor displays something like:\n            Monday, <code>November</code> 5, 2012</p>\n\n<p>with \"November\" in <code>reverse highlight</code>, as if the text were selected.  Is there a simple way to display plain text without that highlight?</p>\n"},{"tags":[".net","winforms","data-binding","nullable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13247240,"title":"Windows Forms databinding and nullable types","body":"<p>I know I'm using sunset technology here, but I'd like to find a solution to my problem nonetheless. </p>\n\n<p>I have an entity with some simple fields. I can bind textboxes on a form like this</p>\n\n<pre><code>nameTextBox.DataBindings.Add(new Binding(\"Text\", entity, \"Name\"));\n</code></pre>\n\n<p>I did the same for a date field,</p>\n\n<pre><code>evaluationDatePicker.DataBindings.Add(new Binding(\"Value\", entity, \"EvaluationDate\"));\n</code></pre>\n\n<p>and this too works fine as long as the EvaluationDate property is of type DateTime.</p>\n\n<p>However, if I now modify the entity and make EvaluationDate nullable, the binding becomes one-way. That is, the control reflects the property value (as long as it's not null), but it doesn't update the entity when I pick another date in the UI.</p>\n\n<p>In line with the recent Windows Forms policy of not throwing exceptions but rather pretend all is well even when things fail (a major annoyance in my book; Form_Load too now just swallows exceptions, though in this case of course we're way past Form_Load before the error occurs). So in fact I can't even tell if it's <em>trying</em> to do anything, but I have to assume it is, given that the two-way binding is working perfectly fine as long as the property isn't nullable.</p>\n\n<p>How can I overcome this?</p>\n\n<p>What I'm trying to do is write a base class for presenters in the application which has the ability to databind controls based on a simple naming convention. The presenter knows that for TextBox it should bind the Text property, for CheckBox it should bind \"Checked\", and so on. The mapping between properties and controls is done by convention - controls presenting a field should have the same name as the field plus the control type. Hence \"Name\" presented in a TextBox maps to \"NameTextBox\" (which is the convention I like to use anyway - I have never understood why people are still fond of prefixes specifically with GUI controls, but no other kind of code!?) and \"IsMarried\" in a checkbox would become \"IsMarriedCheckBox\". </p>\n\n<p>All of this allows the presenter to offer a method that accepts an object, \"datasource\", and a container where the controls to be bound are living. This makes for very rapid work adding a bunch of fields to a screen compared to having to use a bindingsource and write code, a solution which like mine does not give any compiler checks and does mean it's easy to break things by mistypes and property renames. </p>\n\n<p>But to make my little PoC I want to know what I can handle with this, and what sorts of things will still require other solutions. The whole thing would be considerably more valuable if it could support properties of nullable types, since we use them a lot. (Nor do I want to stop using them; bundling together the concept of \"has a value\" and if so \"which value\" is elegant and makes for less code, as well as more compiler help.) </p>\n\n<p>Is there a way? Anything I can hook into? Or possible to make a generic type of my own to replace Nullable&lt;T&gt;? Since I don't understand why it doesn't work without me having to do anything, it's difficult to imagine what might be worth trying to work around it.</p>\n"},{"tags":["winforms","fonts","monthcalendar"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13248835,"title":"Cannot change font in WinForms MonthCalendar control","body":"<pre><code>MonthCalendar1.Font = newFont\n</code></pre>\n\n<p>doesn't work if we assign a new font. The same default MS Sans Serif 8.25 is used.</p>\n\n<p>Is it a know issue, and how to overcome it?</p>\n"},{"tags":["c#","winforms","drawing"],"answer_count":2,"favorite_count":0,"up_vote_count":7,"down_vote_count":1,"view_count":159,"score":6,"question_id":12844870,"title":"When rotating shape, it stays together with the rotated one","body":"<p>I'm a student and i'm new around here. I have a course project to make a Paint-like program. I have a base class <em>Shape</em> with DrawSelf, Contains ect. methods and classes for Rectangle, Ellipse and Triangle for now. Also i have two other classed <em>DisplayProccesor</em> which is class for drawing, and <em>DialogProcessor</em>, which controls the dialog with the user. Theese are requirements for the project. </p>\n\n<pre><code>public class DisplayProcessor\n{\n\n    public DisplayProcessor()\n    {\n    }\n\n    /// &lt;summary&gt;\n    /// List of shapes\n    /// &lt;/summary&gt;\n    private List&lt;Shape&gt; shapeList = new List&lt;Shape&gt;();\n    public List&lt;Shape&gt; ShapeList\n    {\n        get { return shapeList; }\n        set { shapeList = value; }\n    }\n\n    /// &lt;summary&gt;\n    /// Redraws all shapes in shapeList\n    /// &lt;/summary&gt;\n    public void ReDraw(object sender, PaintEventArgs e)\n    {\n        e.Graphics.SmoothingMode = SmoothingMode.AntiAlias;\n        Draw(e.Graphics);\n    }\n\n    public virtual void Draw(Graphics grfx)\n    {\n        int n = shapeList.Count;\n        Shape shape;\n\n        for (int i = 0; i &lt;= n - 1; i++)\n        {\n            shape = shapeList[i];\n            DrawShape(grfx, shape);\n        }\n    }\n\n    public virtual void DrawShape(Graphics grfx, Shape item)\n    {\n        item.DrawSelf(grfx);\n    }\n}\n</code></pre>\n\n<p>And here`s the other one:</p>\n\n<pre><code>public class DialogProcessor : DisplayProcessor\n{\n    public DialogProcessor()\n    {\n    }\n\n    private Shape selection;\n    public Shape Selection\n    {\n        get { return selection; }\n        set { selection = value; }\n    }\n\n    private bool isDragging;\n    public bool IsDragging\n    {\n        get { return isDragging; }\n        set { isDragging = value; }\n    }\n\n    private PointF lastLocation;\n    public PointF LastLocation\n    {\n        get { return lastLocation; }\n        set { lastLocation = value; }\n    }\n\n   public void AddRandomRectangle()\n    {\n        Random rnd = new Random();\n        int x = rnd.Next(100, 1000);\n        int y = rnd.Next(100, 600);\n\n        RectangleShape rect = new RectangleShape(new Rectangle(x, y, 100, 200));\n        rect.FillColor = Color.White;\n\n        ShapeList.Add(rect);\n    }\n}\n</code></pre>\n\n<p>So, i want to rotate one shape, which is selected by the user.\nI try like this. It rotates it, but i get this: <a href=\"http://www.freeimagehosting.net/qj3zp\" rel=\"nofollow\">http://www.freeimagehosting.net/qj3zp</a></p>\n\n<pre><code>public class RectangleShape : Shape\n{\n\n    public override void DrawSelf(Graphics grfx)\n    {\n        grfx.TranslateTransform(Rectangle.X + Rectangle.Width / 2, Rectangle.Y + Rectangle.Height / 2);\n        grfx.RotateTransform(base.RotationAngle);\n        grfx.TranslateTransform( - (Rectangle.X + Rectangle.Width / 2), -( Rectangle.Y + Rectangle.Height / 2));\n        grfx.FillRectangle(new SolidBrush(FillColor), Rectangle.X, Rectangle.Y, Rectangle.Width, Rectangle.Height);\n        grfx.DrawRectangle(Pens.Black, Rectangle.X, Rectangle.Y, Rectangle.Width, Rectangle.Height);\n        grfx.ResetTransform();\n    }\n}\n</code></pre>\n"},{"tags":["c#","winforms","exception","richtextbox","message"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13233189,"title":"How to get name and cell position of data from where the exception arises","body":"<p>I managed to capture the exception by this way:</p>\n\n<pre><code>try\n{ \n//All my code///\n\n}\ncatch (DataConsistencyException exception)\n            {\n\n                //MessageBox.Show(exception.Message);\n                exBuilder.Clear();\n                exBuilder.Append(exception.Message + Environment.NewLine);\n\n                RichTextBox richTextBox = new RichTextBox();\n                richTextBox.Text = exBuilder.ToString();\n                richTextBox.Dock = DockStyle.Fill;\n                richTextBox.ReadOnly = true;\n                richTextBox.ForeColor = Color.Red;\n\n\n\n                Form richMessageBox = new Form\n                {\n                    StartPosition = FormStartPosition.CenterScreen,\n                    ControlBox = true,\n                    Text = \"Error in File\",\n                    MaximizeBox = false,\n                    MinimizeBox = false\n                };\n\n\n                Button Ok = new Button();\n                Ok.Text = \"Ok\";\n                Ok.Size = new Size(90, 90);\n                Ok.FlatStyle = FlatStyle.Flat;\n                Ok.Font = new Font(this.Font, FontStyle.Bold);\n                Ok.Location = new Point(75, 180);\n                Ok.Click += delegate\n                {\n                    richMessageBox.Close();\n                };\n\n\n                richMessageBox.Controls.Add(Ok);\n                richMessageBox.Controls.Add(richTextBox);\n                richMessageBox.ShowDialog();\n\n\n            }\n</code></pre>\n\n<p>I got many datagridviews\nHow can i get the  <code>name and cell position</code> i.e from where the exception arrises from the interface to the <code>richTextBox</code>?? Any help ???</p>\n\n<p>This like shows that we can get the stack no : <a href=\"http://stackoverflow.com/questions/3328990/c-sharp-get-line-number-which-thrown-expection\">C# get line number which thrown expection</a>\n<code>Note : I have modifed the previous question here</code></p>\n"},{"tags":["c#","winforms","mouse"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":69,"score":3,"question_id":13237593,"title":"Simulate Mouse Drag Programatically","body":"<p>I have a Windows Forms application with a control. The control consists of a chart panel with a canvas on which I paint. What I would like to do is to programatically mouse drag the panel so that I have a specific distance between the right edge of the canvas and the last item painted on the canvas. Ihave tried two approaches. The both work in the sense that the panel is dragged as desired BUT I cannot seem to be able to get the precision of movement I desire. I coded a mouse simulator and have tried two approaches.</p>\n\n<p>Approach 1:</p>\n\n<pre><code> if(this.ChartControl.ChartPanel.CanFocus)\n {\n      // ... Focus the chart panel to be adjusted.\n      this.ChartControl.ChartPanel.Focus();\n\n      // ... Move cursor to lastBarScreenCoordinates on the chart panel to be adjusted.\n      Cursor.Position = new Point(lastBarScreenCoordinates.X, lastBarScreenCoordinates.Y);\n\n      MouseSimulator.SetMouseDragThresholds();\n\n      // ... Move chart panel to required position.\n      MouseSimulator.LeftMouseButtonDown(lastBarScreenCoordinates.X, lastBarScreenCoordinates.Y);\n      MouseSimulator.MouseMove(lastBarScreenCoordinates.X-positionShift,\n           lastBarScreenCoordinates.Y);\n      MouseSimulator.LeftMouseButtonUp(lastBarScreenCoordinates.X-positionShift,\n           lastBarScreenCoordinates.Y);\n\n      MouseSimulator.ResetMouseDragThresholds(_cx_default, _cy_default);\n\n      // ... Redraw the chart panel.\n      this.ChartControl.ChartPanel.Refresh();\n\n      // ... Reset cursor to its starting position.\n      Cursor.Position = new Point(startingCursorX, startingCursorY);\n }\n</code></pre>\n\n<p>Approach 2:</p>\n\n<pre><code> if(this.ChartControl.ChartPanel.CanFocus)\n {\n      // ... Focus the chart panel to be adjusted.\n      this.ChartControl.ChartPanel.Focus();\n\n      // ... Move cursor to lastBarScreenCoordinates on the chart panel to be adjusted.\n      Cursor.Position = new Point(lastBarScreenCoordinates.X, lastBarScreenCoordinates.Y);\n\n      MouseSimulator.SetMouseDragThresholds();\n\n      // ... Move chart panel to required position.\n      MouseSimulator.LeftMouseButtonDown(lastBarScreenCoordinates.X, lastBarScreenCoordinates.Y);\n      Cursor.Position = new Point(lastBarScreenCoordinates.X-positionShift,\n           lastBarScreenCoordinates.Y);\n      WindowsCommunication.SendMessage(this.ChartControl.Handle, 0x200, IntPtr.Zero,IntPtr.Zero);\n      MouseSimulator.LeftMouseButtonUp(lastBarScreenCoordinates.X-positionShift,\n           lastBarScreenCoordinates.Y);\n\n      MouseSimulator.ResetMouseDragThresholds(_cx_default, _cy_default);\n\n      // ... Redraw the chart panel.\n      this.ChartControl.ChartPanel.Refresh();\n\n      // ... Reset cursor to its starting position.\n      Cursor.Position = new Point(startingCursorX, startingCursorY);\n }\n</code></pre>\n\n<p>I am using SendInput for simulating mouse clicks. Here is sample left mouse button down code ...</p>\n\n<pre><code> public static void LeftMouseButtonDown(int x, int y)\n {\n      INPUT mouseInput = new INPUT();\n      mouseInput.type = SendInputEventType.InputMouse;\n      mouseInput.mkhi.mi.dx = CalculateAbsoluteCoordinateX(x);\n      mouseInput.mkhi.mi.dy = CalculateAbsoluteCoordinateY(y);\n      mouseInput.mkhi.mi.mouseData = 0;\n      mouseInput.mkhi.mi.time = 0;\n      mouseInput.mkhi.mi.dwFlags = MouseEventFlags.MOUSEEVENTF_LEFTDOWN;\n      SendInput(1, ref mouseInput, Marshal.SizeOf(new INPUT()));\n }\n</code></pre>\n\n<p>And I calculate normalized absolute coordinates for the mouse as follows ...</p>\n\n<pre><code> private static int CalculateAbsoluteCoordinateX(int x)\n {\n      return ((x * 65536) + GetSystemMetrics(SystemMetric.SM_CXSCREEN) - 1) /\n           GetSystemMetrics(SystemMetric.SM_CXSCREEN);\n }\n</code></pre>\n\n<p>So here are the precision issues. If I use Approach 1 (mouse move), the measured distance between the last item painted and the right edge of the canvas is different from what I set in positionShift and the cursor position difference does not equal positionShift. I initially thought it was due to pointer ballistics issues so I tried using Approach 2. Approach 2 does give me precision in pointer positioning but I am still having dissiculty in that the panel moves but the distance between the last bar painted and the right edge of the canvas does not equal the positionShift amount as it should. It always seems to be off. I have been working on this for a long time now and am at my wits end. I am not sure what is going on here. Any suggestions as to how to imporove the precision in my canvas drag by simulated mouse drag would be greatly appreciated. Thank you.</p>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13248645,"title":"How to get all the values of the selected row of a Grid in Windows form?","body":"<p>I have created a windows form in which I have a grid \"gridVerificationQ\". This grid contains different columns whose values gets all the bank account information a person have. I want to get all the values of a grid row that is selected, but I am finding a hard time in getting it. I know its a very small thing but still i would appreciate the help provided. </p>\n"},{"tags":["c#","winforms","gmail"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":648,"score":1,"question_id":4885410,"title":"Gmail in windows Forms","body":"<p>Is there any services providing by google for getting emails in a windows application. If not, please give me a breif description for developing the same.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13248198,"title":"Virtual keyboard in my form. Preventing button focus","body":"<p>I'm trying to create a virtual NumPad in my form. When the user clicks any of the numpad buttons, the corresponding number should be sent to the currently focused TextBox (or any other text control).</p>\n\n<p>Simulating keystrokes aside, how can I prevent the numpad button, which is inside a numpad control, from stealing focus from the already focused TextBox?</p>\n\n<p>I've tried googling and searching SO but didn't find anything that helped me.</p>\n"},{"tags":["c#","winforms","objectlistview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13246696,"title":"How to check all items when I click group title?","body":"<p>I use <a href=\"http://objectlistview.sourceforge.net/cs/index.html\" rel=\"nofollow\">ObjectListView</a> to list all items. And I don't know how to receive the click event when I click the title of Group cell, which is generated by the ObjectListView. </p>\n\n<p>I want to implement the function which checks (or unchecks) all items in the clicked group.</p>\n\n<hr>\n\n<p>Edit: </p>\n\n<p>I overcomed by add one button to check/uncheck the selected items. The ObjectListView will select all items of the clicked group, so I invoke the check/uncheck behavior by a button.</p>\n\n<hr>\n\n<p>Edit:</p>\n\n<p>The GroupTaskClicked event doesn't work. The version of ObjectListView is v2.6.0 (2012/10/20), with visual studio 2010.</p>\n\n<p>Well, the GroupStateChanged event will fire, but it fires more than one time. I will explain more on my answer.</p>\n"},{"tags":["c#",".net","winforms","visual-studio-2010","visual-studio"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13238728,"title":"Mnemonic for ComboBox","body":"<p>How can we add <a href=\"http://msdn.microsoft.com/en-us/library/190kw3at%28v=vs.80%29.aspx\" rel=\"nofollow\">mnemonics</a> for <code>ComboBox</code>?</p>\n\n<p>For example, in a <code>CheckBox</code>, in the caption we can say '<code>Check&amp;BoxCaption</code>', notice the '&amp;' before 'B'. In the form, this 'B' gets underlined and we can access it by pressing Alt+B (as a keyboard shortcut).</p>\n\n<p>But how do we do this in case of <code>ComboBox</code>?</p>\n\n<p><img src=\"http://i.stack.imgur.com/zfxqL.png\" alt=\"Check mnemonic implemented on Visual Studio Options page in a label against a ComboBox\">\nCheck mnemonic implemented on Visual Studio Options page in a label against a <code>ComboBox</code></p>\n\n<p>I am guessing (checking the screenshot above), we create a mnemonic in the label against the <code>ComboBox</code>.\nHow do we link it to the <code>ComboBox</code>, in that case?</p>\n"},{"tags":["vb.net","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13246699,"title":"close windows form when users click outside","body":"<p>anybody have an idea how to write a code if the user clicks outside windows form, the form will automatically close? I.e., I had two forms, when i show form2 and then i click outside of it, form 2 will closed.</p>\n"},{"tags":["visual-studio","winforms","resources","windows-forms-designer"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":831,"score":6,"question_id":3619341,"title":"How do I get the Windows Forms Designer to use resources from external assembly?","body":"<p>I have some resources (images in this case) in a resource file that I use on controls in my Windows Forms project. The Visual Studio Resource Selection dialog doesn't have very good support for choosing images from resource files unless they're in specific locations, but you can edit the designer file directly, and this works just fine; the application compiles and runs correctly, and the Windows Forms Designer is smart enough to not mess up my hand-edited code.</p>\n\n<pre><code>// in an assembly named ResourceConsumer\nthis.button1.Image = global::ResourceConsumer.Properties.Resources.Close32x32;\n</code></pre>\n\n<p>Now I want to move those resources to an external assembly so they can be used by multiple applications. I can set up an assembly to expose its resources without a problem (as long as I'm using Visual Studio 2008 or later), and this works fine. When I change the designer code to reference the image from its new location, the code compiles and runs correctly, but now the Windows Forms Designer changes my code whenever it generates code; it embeds the binary of the image in the local resource file and references it from there.</p>\n\n<pre><code>// ResourceProducer is an external assembly containing resources\nthis.button1.Image = global::ResourceProducer.Properties.Resources.Exit32x32;\n</code></pre>\n\n<p>is changed by the Windows Forms Designer to:</p>\n\n<pre><code>this.button1.Image = ((System.Drawing.Image)(resources.GetObject(\"button1.Image\")));\n</code></pre>\n\n<p>The Windows Forms Designer seems to understand pulling a resource from within the same assembly, but not an external one. Is there any way to have the Windows Forms Designer allow me to use a resource from an external assembly?</p>\n"},{"tags":["c#","winforms","icons","clickonce"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13245056,"title":"Is there any way to change the icon of clickonce application in add/remove programs","body":"<p>I have one windows application which is deployed using clickonce technology. Is there any way to change the icon of that application which is shown in the image.<img src=\"http://i.stack.imgur.com/9MMmx.png\" alt=\"Icon\"></p>\n"},{"tags":["c#",".net","winforms","visual-studio-2010","button"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13241832,"title":"Comparing Winform Button Colors","body":"<p>I have got four buttons in my form among four three buttons (btn2 btn3 btn4) have same color.</p>\n\n<p>when btn1 is clicked it will check if btn2 btn3 and btn4 are of same color without explicitly stating what color to compare. but my condition does not seem to be right\nshould i state this</p>\n\n<p>the code I'm using is:</p>\n\n<pre><code>private void btn1_Click(object sender, EventArgs e)\n{\n    if (btn2.BackColor.Equals((btn3.BackColor) &amp;&amp; (btn4.BackColor)))\n       {\n         MessageBox.Show(\"ALL BUTTONS ARE OF SAME COLOR\");\n       } \n}\n</code></pre>\n"},{"tags":["c#",".net","winforms","c#-4.0"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13246492,"title":"interopservices v/s normal coding","body":"<p>I am trying to make a form borderless which can be resized and dragged.\n<br>Well I got two tutorials to do so <a href=\"http://www.codeproject.com/Articles/11114/Move-window-form-without-Titlebar-in-C\" rel=\"nofollow\"><strong>link1</strong></a> and <a href=\"http://www.codeproject.com/Articles/13571/Draggable-Form-Drag-a-Borderless-Form-by-Clicking\" rel=\"nofollow\"><strong>link2</strong></a> (and many more).\n<br>The first link has simple reference to <code>System.Runtime.InteropServices</code> with small code and <br> the second one is calling events like <code>MouseUp</code>,<code>MouseDown</code> and <code>MouseMove</code> with big code. </p>\n\n<p>I tried the two codes which are OK to me. As I am not good in C#, I cant determine which one is good based on performance. please suggest me with which I should go..</p>\n\n<p>Personally, I doubt using Interopservices (because I dont know anything about it).</p>\n"},{"tags":[".net","winforms","excel","clipboard","rtf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13089299,"title":"How to copy RTF text to clipboard for use in excel","body":"<p>Is it possible to copy a rtf string to the clipboard for excel. The formatting should be preserved as much as possible (e.g. text-color).</p>\n\n<p>The following .Net code is used to fill the clipboard</p>\n\n<pre><code>var dataObject = new DataObject();\ndataObject.SetData(DataFormats.Rtf, rtf);\nClipboard.SetDataObject(data_object);\n</code></pre>\n\n<ol>\n<li>Excel refuses the rtf clipboard content</li>\n<li>MS Word accepts the rtf content.</li>\n<li>When i paste into MSWord and copy from MSWord into Excel it works.</li>\n</ol>\n\n<p>What's the best way to convert the rtf to a format that excel accepts ?</p>\n\n<p>Remarks:\n  As @KreepN has suggested, System.Windows.Documents.TextRange can be used to convert RTF to HTML and vice versa. HTML is recognized by Excel.</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13245083,"title":"DragDrop to move a picture box at run time","body":"<p>I have a PictureBox called <code>pic</code>, placed inside another PictureBox called <code>picTrack</code>.</p>\n\n<p>My goal is to be able to let the user, at run time, change the position of <code>pic</code> by draging it.</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>    int x_offset = 0; // any better to do this without having a global variable?\n    int y_offset = 0;\n    void pic_MouseDown(object sender, MouseEventArgs e)\n    {\n        PictureBox me = (PictureBox)sender;\n        x_offset = me.Left - e.X;\n        y_offset = me.Top - e.Y;\n    }\n\n    void pic_MouseMove(object sender, MouseEventArgs e)\n    {\n        if (e.Button == System.Windows.Forms.MouseButtons.Left)\n        {\n            PictureBox me = (PictureBox)sender;\n            me.Left = e.X + x_offset; \n            me.Top = e.Y + y_offset;\n            picTrack.Invalidate();\n        }\n    }\n</code></pre>\n\n<p>This code only works at a very basic level. I have 2 problems with it:</p>\n\n<p>1.) <code>picTrack</code> is not updated if the user does not let go of the mouse button. Ghost images of <code>pic</code> can be seen while <code>pic</code> is getting moved around (it's like <code>pic</code> is having a tail).</p>\n\n<p>2.) <code>pic</code> is \"giggling\" (i.e. rapidly shaking left and right, up and down, around its location).</p>\n\n<p>How should I solve these 2 problems and create a more smooth drag &amp; drop? Thanks.</p>\n"},{"tags":["c#","asp.net","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13246348,"title":"Request.PhysicalApplicationPath equivalent on Window Form","body":"<p>I need to convert an asp.net application to window form. but here is the problem\nwhat is the equivalent of <b>Request.PhysicalApplicationPath</b></p>\n\n<pre><code>string repFilePath = Request.PhysicalApplicationPath + @\"\\CrystalReports\\SampleFile\\\" + strRepTemp;\n</code></pre>\n\n<p>and FindControl</p>\n\n<blockquote>\n  <p><code>CheckBox chk = (CheckBox)dataItem.FindControl(\"chkItem\");</code></p>\n</blockquote>\n\n<p>on Window Form..</p>\n\n<p>any idea?</p>\n\n<hr>\n\n<p>how can i convert this using datagridview on window form</p>\n\n<p>aspx.cs code</p>\n\n<pre><code> foreach (GridDataItem dataItem in RadGrid1.MasterTableView.Items)\n        {\n            string strDrawingID = dataItem.OwnerTableView.DataKeyValues[x][\"DrawingID\"].ToString();\n            CheckBox chk = (CheckBox)dataItem.FindControl(\"chkItem\");\n</code></pre>\n"},{"tags":["windows","vb.net","winforms","constructor"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13246142,"title":"how to deal with chaining constructors and InitializeComponent in a .net form","body":"<p>say I have two constructors for a windows form</p>\n\n<pre><code>Sub New (byref Foo as Foo)\n    InitializeComponent()\n    ...do some work\nEnd Sub\n</code></pre>\n\n<p>and </p>\n\n<pre><code>Sub New (byref Foo as Foo, Bar as Bar)\n    InitializeComponent()\n    _bar = Bar\n    Me.New(Foo)\nEnd Sub\n</code></pre>\n\n<p>When using the second constructor, InitializeComponent is called twice. Is that OK? Should I try and prevent it? How? </p>\n\n<p>You might say I could eliminate it from the second constructor, but is it OK for me to start making assignments (like _bar = Bar) before calling InitializeComponent? \nAre there any guidelines on what you should or shouldn't do before calling InitializeComponent? Or is it just safe to call it twice without any real consequences? </p>\n\n<p>Cheers!</p>\n"},{"tags":["c#","winforms","serialization","usercontrols"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":3995,"score":3,"question_id":4973506,"title":"Failed to Create Component .. Type is not Marked as Serializable","body":"<p>I'm creating a WinForms user control using Visual C# 2008 Express Edition.</p>\n\n<p>Everything was going on nicely until I found I could play with a <code>List&lt;&gt;</code> collection property from the properties window. After trying to change the collection and running the project, I started getting errors and did my best to get everything back to where it was when it was working.</p>\n\n<p>Now when I try and place an instance of the control onto a form, I get the following error.</p>\n\n<pre><code>Failed to create component 'ColorPicker'.  The error message follows:\n'System.Runtime.Serialization.SerializationException: Type 'WindowsFormsApplication1.ColorPicker+ColorData' in Assembly 'Test, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' is not marked as serializable.\n   at System.Runtime.Serialization.FormatterServices.InternalGetSerializableMembers(RuntimeType type)\n   at System.Runtime.Serialization.FormatterServices.GetSerializableMembers(Type type, StreamingContext context)\n   at System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.InitMemberInfo()\n   at System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.InitSerialize(Type objectType, ISurrogateSelector surrogateSelector, StreamingContext context, SerObjectInfoInit serObjectInfoInit, IFormatterConverter converter)\n   at System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.Serialize(Type objectType, ISurrogateSelector surrogateSelector, StreamingContext context, SerObjectInfoInit serObjectInfoInit, IFormatterConverter converter)\n  at System.Runtime.Serialization.Formatt...'\n</code></pre>\n\n<p>After dismissing this error, I start getting the following error, usually repeatedly until I use Task Manager to shut Visual C# down.</p>\n\n<pre><code>Code generation for property 'PaletteColors' failed.  Error was: 'Type 'WindowsFormsApplication1.ColorPicker+ColorData' in Assembly 'Test, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' is not marked as serializable.'\n</code></pre>\n\n<p>I tried flagging my ColorData class as <code>[Serializable]</code> but then started getting other errors. I don't recall the exact details but it doesn't really matter because I don't want this data serialized.</p>\n\n<p>I tried a new form and got the same error. So I created a completely new project and copied my class' code over to a new user control, and the error still occurs. Can anyone suggest what might be causing this error? I do not want this collection serialized.</p>\n\n<p>Here's the collection in question (these are lines in my user control--the ColorData class is nested in my user control).</p>\n\n<pre><code>public List&lt;ColorData&gt; PaletteColors { get; set; }\n\npublic class ColorData\n{\n    public string Text { get; set; }\n    public Color Color { get; set; }\n\n    public ColorData()\n    {\n        Text = String.Empty;\n        Color = Color.White;\n    }\n\n    public ColorData(string text, Color color)\n    {\n        Text = text;\n        Color = color;\n    }\n\n    public ColorData(KnownColor color)\n    {\n        Text = Enum.GetName(typeof(KnownColor), color);\n        Color = Color.FromKnownColor(color);\n    }\n\n    public override string ToString()\n    {\n        return Text;\n    }\n}\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13245425,"title":"Scroll events of Picturebox","body":"<p>Hi all I have dynamically bind picture in <code>Picturebox</code>. I have put <code>Picturebox</code> in <code>Panel</code>.</p>\n\n<p>I need to fire such events like, when I drag picture up and  down in panel then it will go up or down, and when I scroll picture through mouse then picture goes up or down or if press up and down keys then picture will go up or down.</p>\n\n<p>Which <em>events</em> I can used and how to handle them ? Can anyone please suggest me.</p>\n"},{"tags":[".net","winforms","visual-studio-2012"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":70,"score":3,"question_id":13214503,"title":"Target .NET 4.0 but .NET 4.5 is required","body":"<p>We recently moved to VS 2012, but we are required to keep on using .NET 4.0. A large part of our customer base is still using XP and .NET 4.5 is not supported on Windows XP.</p>\n\n<p>Now, all projects in the solution are targeting .NET 4.0 or lower. When we run the application it tells us to install the .NET 4.5 Framework, while only the .NET 4.0 is used?</p>\n\n<p>In the generated config file I see:</p>\n\n<pre><code>&lt;startup&gt;\n    &lt;supportedRuntime version=\"v4.0\" sku=\".NETFramework,Version=v4.5\" /&gt;\n&lt;/startup&gt;\n</code></pre>\n\n<p>If I change <code>Version=v4.5</code> to <code>Version=v4.0</code> manually in the config file, everything works fine and we can run the application, however it seems weird to have to do this? Can somebody explain to me what is causing the solution to ask for 4.5 while we develop for 4.0?</p>\n"},{"tags":["c#","winforms","datagridview","checkbox"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13242861,"title":"Check All Checkbox items on DataGridView [SOLVED]","body":"<p>here's the scenario,</p>\n\n<p>i have checkbox(Name:Check All ID:chkItems) and datagridview. And when i click on the checkbox. All checkbox on the gridview will also be checked.</p>\n\n<p>I've also added the checkbox column on the grid.</p>\n\n<pre><code>DataGridViewCheckBoxColumn CheckboxColumn = new DataGridViewCheckBoxColumn();\n            CheckBox chk = new CheckBox();\n            CheckboxColumn.Width = 20;\n            GridView1.Columns.Add(CheckboxColumn);\n</code></pre>\n\n<p>Here is the code behind of the checkbox. there is a problem on the row.Cell</p>\n\n<pre><code>private void chkItems_CheckedChanged(object sender, EventArgs e)\n        {\n            foreach (DataGridViewRow row in GridView1.Rows)\n            {\n                DataGridViewCheckBoxCell chk = e.row.Cells(0);\n                if (chk.Selected == false)\n                {\n                    row.Cells(0).Value = true;\n                }\n            }\n        }   \n</code></pre>\n\n<p>SOLVED (here is the solution)</p>\n\n<pre><code>private void chkItems_CheckedChanged(object sender, EventArgs e)\n        {   \n            foreach (DataGridViewRow row in GridView1.Rows)\n            {\n                DataGridViewCheckBoxCell chk = (DataGridViewCheckBoxCell)row.Cells[1];\n                if (chk.Selected == false)\n                {\n                    chk.Selected = true;\n                }\n            } \n        }   \n</code></pre>\n"},{"tags":["c#","winforms","multithreading","invoke"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13243291,"title":"Do you need two seperate InvokeRequired checks when working with 2 forms?","body":"<p>Given</p>\n\n<pre><code>Action closeLoadingAction = new Action(() =&gt;\n{\n  loadingForm.Close();\n  #region - may need to put into second Action\n  panelOnMainForm.Controls.AddRange(physdocControls.ToList&lt;Control&gt;().ToArray());\n  if (Handle != IntPtr.Zero)\n    User32DLL.SetForegroundWindow(this.Handle);//Handle is a property of the mainForm.\n  #endregion\n});\n</code></pre>\n\n<p>Sometimes I get handle not created exceptions even though I check the Invoke required.</p>\n\n<pre><code>if(loadingForm.InvokeRequired)\n   loadingForm.Invoke(closeLoadingAction);\nelse\n   closeLoadingAction();\n</code></pre>\n\n<p>The loading form runs on the same thread as the main form.  The code you see above runs in a seperate thread.  I suspect that I need another check for invoke against the main form. Do I need a second check or is what I have already safe?</p>\n"},{"tags":["winforms","c#-4.0","mschart"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2994,"score":1,"question_id":8136072,"title":"How to show tooltip on MS Chart","body":"<p>I am using MS Chart control to draw graphs on Winform.</p>\n\n<p>I want to show the current (x,y)  Value as tooltip on Mousedown on chartarea.</p>\n\n<p>How do I do that?</p>\n"},{"tags":["winforms","wcf","permissions","hosting"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":128,"score":1,"question_id":7259263,"title":"WCF Winform Hosting","body":"<p>I have a WCF service hosted in a Winforms application, it's running on a vista machine and I've used netsh to allow the application to listen on port 6003.</p>\n\n<p>I have a client application which can call the WCF service when it is running on the same machine.</p>\n\n<p>The problem is I cannot access the WCF service from any other PC on the network.</p>\n\n<p>I've run netstat and it's definately listening on the port.</p>\n\n<p>I'm using the basicHttpBinding, and it's .Net 4.</p>\n\n<p>Any help would be great.</p>\n\n<p>Regards</p>\n\n<p>Steve</p>\n"},{"tags":["c#","winforms","listview"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13242289,"title":"Write to only one column in a listView?","body":"<p>I have two columns in my listView, lets call them Column1, and Column2.</p>\n\n<p>Is it possible to add a bunch of items to column1 only, and make it so those items only go strictly under column1 and not column2?</p>\n\n<p>When I add items it adds an item to Column1, and then Column2 and I don't want that.</p>\n\n<p>How would I go about doing this? </p>\n\n<p>Here's some of my test code. I made an array with two strings. I want both of  those strings to go under column1 (each in their own row) and not under column2. When I test it, they still go under column1 AND column2 which is what I don't want.</p>\n\n<pre><code>string[] h = {\"Hi\",\"Hello\"};\nlistViewGoogleInsight.Items.Add(new ListViewItem(h));\n</code></pre>\n"},{"tags":["vb.net","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13235192,"title":"Me.FormClosing works on some forms but not others","body":"<p>I wish in my code to handle the case when the red X at the upper right of the form is clicked. To this end I consulted <a href=\"http://www.vbdotnetforums.com/windows-forms/29303-how-code-close-button-form.html\" rel=\"nofollow\">this</A> and created an event handler thus:-</p>\n\n<pre><code>Private Sub DoFoo (sender As System.Object, e As System.EventArgs) _\n                   Handles Me.FormClosing\n    ' Do things\nEnd Sub\n</code></pre>\n\n<p>but I have found (from setting breakpoints) that on certain forms this event handler is not invoked when the red X is clicked, whereas on others it is. The forms are all of type System.Windows.Forms.Form but naturally are different in most respects. Does anyone know what might be causing this and what to do about it?</p>\n\n<p><strong>Edit</strong></p>\n\n<p>In answer to Vitor's question, the form that isn't working is created thus:-</p>\n\n<pre><code>If my_form Is Nothing Then\n    my_form = New MyForm(parameters)\n    my_form.Title = \"Contour Plot Options\"\nElse\n    my_form.BringToFront\nEnd If\n\nmy_form.Show\n</code></pre>\n\n<p>Those that are behaving as expected are created like this:-</p>\n\n<pre><code>If my_working_form Is Nothing Then\n    my_working_form = New MyWorkingForm\nEnd If\n\nmy_working_form.Show\n</code></pre>\n\n<p>I can't see any <code>Visible</code> property to set or clear anywhere.</p>\n"},{"tags":["c#","winforms","gui","user-interface"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":52,"score":-3,"question_id":13240656,"title":"GUI Windows Form Application","body":"<p>I would like to know how can i make GUI like of Visual studio i mean the interface of Visual studio. Usually in form application we can follow simple form creation rules but the interface of VS is pretty different how can we design such interfaces?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":13238606,"title":"How MessageBox.Show make loop wait","body":"<p>I'm looking for a way to make my program wait for a page to load completely, before it keeps going and executes more code on the loaded document.</p>\n\n<p>I didn't find any good way to do it, but I remembered that when we use <code>MessageBox.Show(\"some string\");</code> the program stops/waits(?) and then keeps going, even in a loop.</p>\n\n<p>So when we have this loop:</p>\n\n<pre><code>for (int i = 0; i &lt; 10; i++)\n{\n    MessageBox.Show(\"i\");\n}\n</code></pre>\n\n<p>the <code>i++</code> will not run until I press the OK button.</p>\n\n<p>How were they able to do that?</p>\n"},{"tags":["winforms","richtextbox","rtf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13238734,"title":"RichTextBox SelectionFont is unexpectedly *not* null","body":"<p>I'd like to change the font size of a chunk of RTF without erasing the bold / italic / underline formatting (an issue similar to the one in <a href=\"http://stackoverflow.com/questions/5325918/how-do-i-maintain-richtext-formatting-bold-italic-etc-when-changing-any-one-el\">this question</a>). The accepted answer is to modify the selection of the text box until the <code>SelectionFont</code> propery is <strong>null</strong> in order to find runs of consistently formatted text which can be modified individually. Sounds reasonable. However the actual behavior of the RichTextBox control seems to be inconsistent with the documentation.</p>\n\n<p>In the documentation for <code>RichTextBox.SelectionFont</code> MSDN states:</p>\n\n<blockquote>\n  <p>If the current text selection has more than one font specified, this\n  property is <strong>null</strong>.</p>\n</blockquote>\n\n<p>However, this code which uses mixed bold / regular text doesn't behave as you'd expect:</p>\n\n<pre><code>var rtb = new RichTextBox {\n    Rtf = @\"{\\rtf1 This is \\b bold\\b0.}\"\n};\n\nrtb.SelectAll();\n// Now you'd expect rtb.SelectionFont to be null,\n// but it actually returns a Font object\n</code></pre>\n\n<p>Is there any other reliable way of formatting the text so that I can change the font size without clobbering the other formatting. (Manipulating the RTF directly is OK, I'm not absolutely set on using WinForms to achieve this).</p>\n"},{"tags":["c#","winforms"],"answer_count":4,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":8268,"score":6,"question_id":5416380,"title":"How do I disable form resizing for users in C# Winforms","body":"<p>How do I disable form resizing for users in C# Winforms .\nwhich property is used ?</p>\n\n<p>i tried </p>\n\n<p><code>AutoSize</code></p>\n\n<p><code>AutoSizeMode</code></p>\n\n<p>Any help ?</p>\n"},{"tags":["c#","winforms","devexpress","xtragrid","unbound"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":207,"score":0,"question_id":11972021,"title":"how to create an unbound column relate to a foreign key inside a grid","body":"<p>i would like to create dynamically an unbound column in an Xtragrid control devexpress ; there is the scenario : i have a grid bound with  data from Payment Datatable , fields are \" Payment_ID , Customer_ID \" so on and so forth , what i would like to do is , instead of having Customer_ID which is the foreign in this table , i want to have in it ,Customer_Name related to Customer_ID , to avoid confusion . someone Help Thanks(using winforms C#). below code used ; to populate the grid </p>\n\n<pre><code>          using System;\n          using System.Collections.Generic;\n          using System.ComponentModel;\n          using System.Drawing;\n          using System.Data;\n          using System.Linq;\n          using System.Text;\n          using System.Windows.Forms;\n          using System.Data.SqlClient;\n\n          namespace YoungWoman\n            {\n               public partial class Payment2 : UserControl\n                   {\n                          DataSet ds3 = new DataSet();\n                          SqlDataAdapter dapayment = new SqlDataAdapter();\n                          SqlConnection conne = SqlCoonectionSEtup.GetConnection;\n                          BindingSource PaymentBinding = new BindingSource();\n\n               public Payment2()\n                {\n                   InitializeComponent();\n                }\n\n               private void AddPayment_Click(object sender, EventArgs e)\n            {\n               Paymentfrm payent = new Paymentfrm(Utils.Formtype.add, 0);\n               payent.PaymentEvent += new EventHandler(RefreshingGrid);\n               payent.PayentlabelsEvent += new EventHandler(RefresHlabels);\n\n               payent.ShowDialog();\n\n            }\n\n               private void EditPayment_Click(object sender, EventArgs e)\n              {\n                 Paymentfrm pyt = new Paymentfrm(Utils.Formtype.edit, 1);\n               pyt.ShowDialog();\n              }\n                   void RefreshingGrid(object sender, EventArgs e)\n             {\n                  ds3.Tables[\"tblPaymentYW\"].Clear();\n                  SqlCommand cmd = new SqlCommand(\"SELECT * FROM PaymentYW\", conne);\n\n                       dapayment.SelectCommand = cmd;\n                        dapayment.Fill(ds3, \"tblPaymentYW\");\n                        DgPaymentYW.DataSource = ds3.Tables[\"tblPaymentYW\"];\n                        DgPaymentYW.RefreshDataSource();\n             }\n    void RefresHlabels(object sender, EventArgs e)\n    {\n        LoadData();\n    }\n\n\n    private void Payment2_Load(object sender, EventArgs e)\n    {\n        LoadData();\n\n\n\n    }\n\n    private void LoadData()\n    {\n        SqlCommand cmd = new SqlCommand(\"SELECT *FROM PaymentYW ORDER BY PaymentId \", conne);\n        dapayment.SelectCommand = cmd;\n        ds3.Clear();\n        dapayment.Fill(ds3, \"tblPaymentYW\");\n        PaymentBinding.DataSource = ds3.Tables[\"tblPaymentYW\"];\n        DgPaymentYW.DataSource = PaymentBinding;\n\n        this.PaymentIdlabelContro.DataBindings.Clear();\n        this.PaymentIdlabelContro.DataBindings.Add(new Binding(\"Text\", PaymentBinding, \"PaymentId\"));\n        ReservationIdlabelControl.DataBindings.Clear();\n        this.ReservationIdlabelControl.DataBindings.Add(new Binding(\"Text\", PaymentBinding, \"ReservationId\"));\n        LesseeIdlabelControl.DataBindings.Clear();\n        this.LesseeIdlabelControl.DataBindings.Add(new Binding(\"Text\", PaymentBinding, \"LesseeId\"));\n\n        DatelabelControl.DataBindings.Clear();\n\n        this.DatelabelControl.DataBindings.Add(new Binding(\"Text\", PaymentBinding, \"PaymentDate\"));\n        AmountlabelControl.DataBindings.Clear();\n        this.AmountlabelControl.DataBindings.Add(new Binding(\"Text\", PaymentBinding, \"AmountPaid\"));\n        BalancelabelControl.DataBindings.Clear();\n        this.BalancelabelControl.DataBindings.Add(new Binding(\"Text\", PaymentBinding, \"Balance\"));\n        gridView1.Columns[1].Visible = false;\n        gridView1.Columns[6].Visible = false;\n\n\n        DevExpress.Utils.FormatInfo fi = new DevExpress.Utils.FormatInfo();\n        fi.FormatType = DevExpress.Utils.FormatType.Numeric;\n        fi.FormatString = \"c2\";\n        gridView1.Columns[5].DisplayFormat.Assign(fi);\n        gridView1.Columns[4].DisplayFormat.Assign(fi);\n        Rowcount();\n        Priveleges();\n\n\n    }\n\n    void Rowcount()\n    {\n        RecordlabelControl.Text = \" Records : \" + (gridView1.RowCount);\n\n    }\n    void Priveleges()\n    {\n        if (SqlCoonectionSEtup.Priveleges == \"User\")\n        {\n            AddPayment.Enabled = false;\n            EditPayment.Enabled = false;\n            CancelBtn.Enabled = false;\n        }\n        else\n        {\n\n            AddPayment.Enabled = true;\n            EditPayment.Enabled = true;\n            CancelBtn.Enabled = true;\n\n        }\n    }\n\n}\n</code></pre>\n\n<p>}</p>\n"},{"tags":["c#","winforms","security"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13236940,"title":"Which passwordchar shows a black dot (•) in a winforms textbox using code?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4051302/which-passwordchar-shows-a-black-dot-in-a-winforms-textbox\">Which passwordchar shows a black dot (•) in a winforms textbox?</a><br>\n  <a href=\"http://stackoverflow.com/questions/6796157/unicode-encoding-for-string-literals-in-c11\">Unicode encoding for string literals in C++11</a>  </p>\n</blockquote>\n\n\n\n<p>I want to use code to reveal the password or make it a dot like •</p>\n\n<pre><code>textBoxNewPassword.PasswordChar = (char)0149;\n</code></pre>\n\n<p>How can I achieve this?</p>\n"},{"tags":["c#","winforms","events","graphics","gdi"],"answer_count":5,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":3965,"score":1,"question_id":3714146,"title":"How to draw a single line using MouseMove Event","body":"<p>I'm trying to draw a single line using <code>OnMouseMove()</code> event. My Problem is that everytime I move the mouse It leaves a trail. I tried to use the refresh method, but when I stop moving the mouse the line is gone. I don't want the line to be drawn <code>OnPaint();</code>, Just want to draw it <code>OnMouseMove()</code>. </p>\n\n<p><strong>EDIT:</strong> I'm using a transparent panel(cp.ExStyle |= 0x20;), so I cant use the <code>graphics.Clear()</code> and <code>BackColor()</code></p>\n\n<p>Here's a Sample Image without the <code>Refresh()</code>:</p>\n\n<p><img src=\"http://i.stack.imgur.com/ZGlcx.jpgBlockquote\" alt=\"alt text\"></p>\n\n<p>Here's my code:</p>\n\n<pre><code>private void panel1_MouseMove(object sender, MouseEventArgs e)\n{  \n   Graphics g = panel1.CreateGraphics();\n\n   g.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.AntiAlias;\n   using (var p = new Pen(Color.Black, 3))\n   {\n      p.StartCap = System.Drawing.Drawing2D.LineCap.ArrowAnchor;\n      p.EndCap = System.Drawing.Drawing2D.LineCap.ArrowAnchor;\n\n      g.DrawLine(p, st, e.Location);\n   }\n   Thread.Sleep(30);\n   Invalidate();\n   //this.Refresh();\n\n   g.Dispose();\n}\n</code></pre>\n\n<p>Regards</p>\n"},{"tags":["c#","winforms","visual-studio","control","design-time"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13198510,"title":"Shared data for component property at design time","body":"<p>I have a component which implements an <code>IExtenderProvider</code>. One property contains settings which should be the same for each instance of the component the user uses within his project.\n(And also editable at each instance)</p>\n\n<p>Whats the common way to share information over several instances of a user control at design time? To manually write it to the <code>app.config</code> is no solution because I need a GUI for this setting.</p>\n\n<p>Thanks in advance</p>\n\n<p>Findnix</p>\n\n<p>The mentioned static property works great if the property is just needed during design time, but in my case the property is also needed during runtime. \nIn this case each instance sets the value which was set during its design time to the static property. Which means that the value depends on the initialization order of the instances.</p>\n\n<p>Example:</p>\n\n<p>At Design Time:</p>\n\n<p>Adding the Component to form 1 and set the value to \"Form1\"</p>\n\n<p>Adding the Component to form 2 and set the value to \"Form2\"</p>\n\n<p>The value now is \"Form2\" in the designer for both instances,\nbut at runtime if both forms are loaded the value is allways the one which\nwas loaded as last one.</p>\n\n<p>This is because the designer does not change the initialization value for the instances.</p>\n"},{"tags":[".net","winforms","controls"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":670,"score":0,"question_id":2598956,"title":"A free WYSIWYG control for DotNet","body":"<p>I search a free and easy to drag&amp;drop in my winform WYSIWYG-Control.</p>\n\n<p>The background is, I don't have time I can spend on the control, it must be there and ready.</p>\n\n<p>DotNet.2 C#\nNO ASP!\nWinForm!</p>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13237504,"title":"panels won't dock where I want them to in winforms","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/154543/panel-dock-fill-ignoring-other-panel-dock-setting\">Panel.Dock Fill ignoring other Panel.Dock setting</a>  </p>\n</blockquote>\n\n\n\n<p>It seems that when I place my panels in winforms I get unexpected results.  If I have 3 panels and I dock them all to the top so that hopefully they are all 1 after the other, I instead get the last one docking to the VERY top of the application, not to the bottom of the last docked panel.</p>\n\n<p>I guess I am confused about how the dock property in winforms panels work!?  Every time I try to layout my application I get a headache because one panel wants to dock where I don't want it.</p>\n"},{"tags":["c#","winforms","image","picturebox"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2229,"score":1,"question_id":1383067,"title":"Picture Box image source is it possible?","body":"<p>Hi I want to set dynamic path to my picture box in winforms. Is it possible to do like this</p>\n\n<p>my image is here some thing like</p>\n\n<p><a href=\"http://www.indianorphanages.net/images/india-political-map.gif\" rel=\"nofollow\">http://www.indianorphanages.net/images/india-political-map.gif</a></p>\n\n<p>now I want to bind it to picture box (winforms)</p>\n\n<p>Is it possible?</p>\n"},{"tags":["winforms","application","directory"],"answer_count":6,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":32650,"score":8,"question_id":295687,"title":"Get Path to Execution Directory of Windows Forms Application","body":"<p>I would like to get the path to the execution directory of a windows forms application (ie: the directory in which the executable is located). Does anyone know of a built-in method in .Net to do this?</p>\n"},{"tags":["c#",".net","winforms","printing","crystal-reports"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":3816,"score":0,"question_id":6362230,"title":"Crystal Report | Printing | Default Printer","body":"<p>I am making one application where user will print invoices which I am displaying using Crystal Report.</p>\n\n<p>The user showed me his current application made using ForPro. In that application, under Printer Options form, one can see all the printers currently installed and the user could select default printer. When the invoice is made, the user presses the print button, then there is one dialog asking for no. of copies. When it's entered, the invoice gets printed directly, without any Print Dialog Box. If the user wants to change the printer again he/she will change it in the Printer Option form.</p>\n\n<p>I want to know if similar thing is possible in Crystal Report and need guidance on how to approach for it.</p>\n"},{"tags":["winforms","control","delphi-prism","mouseclick-event","numericupdown"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13235435,"title":"How to prevent key entry with NumericUpDown control?","body":"<p>I have a numericupdown control on a winform and I noticed while testing that not only you have the option of changing the value by pressing up and down key but also simply entering the values from your keyboard. </p>\n\n<p>I don't want that. I only want the user to be able to change the numericupdown's value only by clicking the up and down buttons within the box.</p>\n\n<p>So far I simply can't find a solution. </p>\n\n<p>Does anyone know how to do this?</p>\n\n<p>Thanks in advance,</p>\n"},{"tags":["c#","c++","winforms","dll","clr"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":108,"score":0,"question_id":10852445,"title":"Clr dll .net control","body":"<p>I need to dynamic loading some .NET control from DLL in runtime from C# winforms host project.</p>\n\n<p>for example:</p>\n\n<p>1.dll contrains control1</p>\n\n<p>2.dll contrains control2</p>\n\n<p>3.dll contrains control3</p>\n\n<p>host app may load any of this dll-s, get controls from dll and put it on self form.</p>\n\n<p>I tried:</p>\n\n<pre><code>__declspec(dllexport) TestCLRPlugin::Properties ^ GetControl()\n{\n    return gcnew TestCLRPlugin::Properties();\n}\n</code></pre>\n\n<p>but, clrcall methods can't be exported from dll.</p>\n"},{"tags":["c#","winforms","visual-studio-2008","event-handling"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":366,"score":2,"question_id":657419,"title":"Viewing all event handlers associated with a Button?","body":"<p>I have a number of Inherited User Controls, for each User Control I sometimes have overridden event Handlers for the Buttons on the Control. (To allow for Child specific behaviours to occur)</p>\n\n<p>Is there a way of viewing all the Event Handlers associated with a particular component?</p>\n\n<p>The problem being that on one of the Buttons, the event handler wass being called twice. I believe this was due to the fact that I had assigned the Click Event Handler twice, once in the parent and once in the child User Control. I remove the assignment in the child control and now nothing happens when I click the button (within the VS2008 designer)!</p>\n\n<p>Any and all help will be gratefully received!</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>The reason nothing happened is down to a verion control issue .... the child's overidden event handler was incorrect!</p>\n\n<p>But the main point still remains... Im not the only contributer to the codebase, and If I need to see which events are attributed to a component I cant explicitly at the moment. Especially with regards to Timers as we dynamically add and remove events that need t obe 'synchronised' to a single timer. It would be good to see which Events are tagged onto the Tick event?!</p>\n"},{"tags":["winforms","powershell"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13235358,"title":"How do I implement a timeout for my Windows form via Powershell?","body":"<p>I'm writing a simple Powershell script using the System.Windows.Forms .NET class to display basic computer information for my users.  This script will be placed on all desktops to give the user a way to easily get basic computer information for a helpdesk ticket.  So far it's working great however I now need to implement a timeout feature to it in case the user leaves it open.</p>\n\n<p>Here's what I have so far.  Can anyone tell me how best to close this form after a certain period?  I've found that the System.Windows.Form class has a Timer class but I don't see that as available in Powershell.  Am I missing something?</p>\n\n<pre><code>[void] [System.Reflection.Assembly]::LoadWithPartialName('System.Drawing') \n[void] [System.Reflection.Assembly]::LoadWithPartialName('System.Windows.Forms') \n\n$sLoggedInUser = (Get-WmiObject -Query \"SELECT * FROM Win32_Process WHERE Caption = 'explorer.exe'\").GetOwner().User;\n$sPcName = $($env:computername);\n$sLastBoot = (([wmi]'').ConvertToDateTime((Get-WmiObject -Query \"SELECT LastBootUpTime FROM Win32_OperatingSystem\").LastBootUpTime)).ToString();\n$sIp = (Get-WmiObject -Query \"SELECT IPAddress,IPEnabled FROM Win32_NetworkAdapterConfiguration\" | Where-Object { $_.IPEnabled -eq $true }).IPAddress\n\n$objForm = New-Object System.Windows.Forms.Form\n$objForm.FormBorderStyle = 'None';\n$objForm.Text = 'Computer Information'\n$objForm.Size = New-Object System.Drawing.Size(240,180) \n$objForm.StartPosition = 'CenterScreen'\n$objForm.Timer\n\n$OKButton = New-Object System.Windows.Forms.Button\n$OKButton.Location = New-Object System.Drawing.Size(75,140)\n$OKButton.Size = New-Object System.Drawing.Size(75,23)\n$OKButton.Text = \"OK\"\n$OKButton.Add_Click({$objForm.Close()})\n$objForm.Controls.Add($OKButton)\n\n$oPcLabel = New-Object System.Windows.Forms.Label\n$oPcLabel.Location = New-Object System.Drawing.Size(10,20) \n$oPcLabel.Size = New-Object System.Drawing.Size(280,20) \n$oPcLabel.Text = \"Computer Name: $($env:computername)\"\n\n$oUserLabel = New-Object System.Windows.Forms.Label\n$oUserLabel.Location = New-Object System.Drawing.Size(10,50) \n$oUserLabel.Size = New-Object System.Drawing.Size(280,20) \n$oUserLabel.Text = \"Logged In User: $sLoggedInUser\"\n\n$oLastBootLabel = New-Object System.Windows.Forms.Label\n$oLastBootLabel.Location = New-Object System.Drawing.Size(10,80) \n$oLastBootLabel.Size = New-Object System.Drawing.Size(280,20) \n$oLastBootLabel.Text = \"IP Address: $sIp\"\n\n$oIpLabel = New-Object System.Windows.Forms.Label\n$oIpLabel.Location = New-Object System.Drawing.Size(10,110) \n$oIpLabel.Size = New-Object System.Drawing.Size(280,20) \n$oIpLabel.Text = \"Last Bootup Time: $sLastBoot\"\n\n$objForm.Controls.Add($oPcLabel) \n$objForm.Controls.Add($oUserLabel)\n$objForm.Controls.Add($oLastBootLabel)\n$objForm.Controls.Add($oIpLabel)\n\n$objForm.Topmost = $True\n\n$objForm.Add_Shown({$objForm.Activate()})\n[void] $objForm.ShowDialog()\n</code></pre>\n"},{"tags":["c#",".net","winforms","visual-studio-2010","class"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13233431,"title":"how to access winform components from another class?","body":"<p>i have a form with one button and two labels</p>\n\n<p>and i have a separate class called myCounter</p>\n\n<p>i want the myCounter class to be able to access the labels in the form \nthrough a method called changeColor..</p>\n\n<p>how can make the labels available in this class</p>\n\n<p>the form </p>\n\n<pre><code>public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        public Color colTurn\n        {\n            get { return lblp1Turn.BackColor; }\n            set { lblp1Turn.BackColor = value; }\n        }\n\n        private void Form1_Load(object sender, EventArgs e)\n        {\n\n        }\n    }\n</code></pre>\n\n<p>the class </p>\n\n<pre><code>class myCounter\n{\n    private readonly Form1 Board;\n    public myCounter(Form1 Board)\n    {\n        this.Board = Board;\n    }\n\n    public int turn = 0;\n\n\n    public void changeColor()\n    {\n\n        if (turn == 0)\n        {\n            turn = 1;\n            lbl\n\n           //change color code here\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#",".net","winforms","events"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13233253,"title":"Load like event in Windows Forms for any control like textbox, checkbox?","body":"<p>In Windows Forms when a UserControl or Form first time becomes visible the Load event is fired.</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/system.windows.forms.usercontrol.load.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/system.windows.forms.usercontrol.load.aspx</a></p>\n\n<p>Is there any such event for controls like Checkbox, TextBox, Label ?</p>\n"},{"tags":["c#","arrays","winforms","indexes"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":48,"score":3,"question_id":13234164,"title":"Searching specific indexes in arrays for specific numbers","body":"<p>Hi there is there a way to check specific integer array indexes for specific numbers in C#; for example what I would love to have worked would be: </p>\n\n<pre><code>    if(si[6] || si[7] || si[8] == 3)\n     {\n      MessageBox.Show(\"3 detected\")\n     }\n    else\n    {\n     continue();\n    {\n</code></pre>\n\n<p>Obviously this doesn't work. Is there a clean way to do this? Thank you for looking.</p>\n"},{"tags":["c#","winforms","forms","minimize","maximize-window"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13233451,"title":"How to show a form again after hiding it?","body":"<p>I have two forms. I need to open a second form with a button. When I open form2 I hide form1. However when I try to show form1 again from form2 with a button it doesn't work. My form1 code is:</p>\n\n<pre><code>        Form2 form2 = new Form2();        \n        form2.ShowDialog();\n</code></pre>\n\n<p>Inside form2 code:</p>\n\n<pre><code>        Form1.ActiveForm.ShowDialog();\n</code></pre>\n\n<p>or </p>\n\n<pre><code>        Form1.ActiveForm.Show();\n</code></pre>\n\n<p>or </p>\n\n<pre><code>        form1.show(); (form1 doesn't exist in the current context)\n</code></pre>\n\n<p>doesn't work.\nI do not want to open a new form </p>\n\n<pre><code>        Form1 form1 = new Form1();   \n        form1.ShowDialog();\n</code></pre>\n\n<p>I want show the form which I hided before. \nAlternatively I can minimize it to taskbar </p>\n\n<pre><code>        this.WindowState = FormWindowState.Minimized;\n</code></pre>\n\n<p>and maximize it from form2 again. </p>\n\n<pre><code>        Form2.ActiveForm.WindowState = FormWindowState.Maximized;\n</code></pre>\n\n<p>however the way I am trying is again doesn't work.\nWhat is wrong with these ways?</p>\n"},{"tags":["c#",".net","winforms","datagridview","combobox"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":2485,"score":1,"question_id":6799296,"title":"Set default value in DataGridView combo box","body":"<p>I'm using <code>DataGridView</code> in windows form to allow the user to add n numbers of rows with values enter by the user. One of the column of <code>DataGridView</code> contains combo box, which is displaying its items by using database.</p>\n\n<p>I'm using the following code in Load event to connect <code>DataGridViewComboBox</code> with database :</p>\n\n<pre><code>private void PurchaseMaster_Load(object sender, EventArgs e)\n{\n    DataTable dt = itemBAL.GetTable();\n    bindingSource1.DataSource = dt;\n    ItemName.DataSource = bindingSource1;\n    ItemName.DisplayMember = \"Name\";\n    ItemName.ValueMember = \"ItemId\";\n    ItemName.DataPropertyName = \"ItemId\";\n    ItemName.AutoComplete = true;\n    ItemName.DefaultCellStyle.NullValue = dt.Rows[0][1].ToString();\n    ItemName.DefaultCellStyle.DataSourceNullValue = dt.Rows[0][0].ToString();\n}\n</code></pre>\n\n<p>But whenever I not select any value from <code>DataGridViewComboBox</code> and click on save button I find <code>null</code> value in the table corresponding to <code>DataGridViewComboBox</code> value. </p>\n\n<pre><code>foreach (DataGridViewRow row in dataGridView1.Rows)\n{\n    if (row.IsNewRow)\n        continue;\n\n    DataRow dtRow = dt.NewRow();\n    for (int i = 0; i &lt; dataGridView1.Columns.Count; i++)\n        dtRow[i] = row.Cells[i].Value == null ? DBNull.Value : row.Cell[i].Value;\n    dt.Rows.Add(dtRow);\n}\n</code></pre>\n\n<p>Could anyone please tell me why I'm getting null value in database for <code>DataGridViewcombobox</code> defult value, despite of using <code>DataSourceNullValue</code> property?</p>\n"},{"tags":["c#","winforms","datagridview","windows-applications"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13233273,"title":"Dynamically added linkcolumn and Event Handler for the link","body":"<p>A link column is dynamically added to datagridview in itz load event. (windows application). For every row in datagrid there will be a 'delete' link column. When it is clicked, the row related to that link should be deleted. Could u plz tell me how to write 'click' event handler for that dynamically added link column? </p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13198704,"title":"How can I get suspendlayout to work when adding controls?","body":"<p>I am adding controls after the shown event on Form.  The controls are showing up one at a time despite the fact I called <code>SuspendLayout()</code>.  How can I get the layout to suspend so the controls only display when they are all finished loading?</p>\n\n<pre><code> public partial class ControlCreateTest : Form\n{\n    public ControlCreateTest()\n    {\n        InitializeComponent();       \n    }\n\n    private void AsyncControlCreateTest_Shown(object sender, EventArgs e)\n    {\n        CreateControls();\n    } \n\n    private void CreateControls()\n    {\n        SuspendLayout();\n        int startPoint= 0;            \n        for (int i = 0; i &lt; 4; i++)\n        {          \n            UserControl control = new UserControl() { Text = i.ToString(), Height = 100, Width = 100 };\n            control.Load += control_Load;\n            Controls.Add(control);\n            control.Top = startPoint;\n            startPoint += control.Height;\n        }\n\n        ResumeLayout();\n        Text = \"Loading complete\";\n    }\n\n    void control_Load(object sender, EventArgs e)\n    {\n        Thread.Sleep(500);\n        RichTextBox newRichTextBox = new RichTextBox() { Height = 100, Width = 100 };\n        UserControl control = sender as UserControl;\n        control.Controls.Add(newRichTextBox);\n        newRichTextBox.Text = \"loaded\";\n    }     \n}\n</code></pre>\n\n<p><strong>UPDATE</strong><br />\nIt seems that once these forms begin loading...the visibility and suspend calls are thrown out the window immediately.  That is quite troublesome when the Load events are long running.</p>\n"},{"tags":["c#","winforms","listview","data-binding"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2479,"score":0,"question_id":2622413,"title":"Winform ListView databind","body":"<p>I have a Listview that uses databind. I set the DataSource property to a binding source. All works fine. The problem is that I need to have a column that is not databinded and contains only buttons that have the same handler for click event. To accomplish this I tried to add a subitem that is a button for each ListViewItem after InitializeComponent but doesn't work, nothing is displayed. Also I set the list view column type to Control.\nIf I add elements to ListView and isn't databinded that the buttons appear.</p>\n\n<p>So it will be a great help for me to know if buttons could be displayed in column that is not databinded when the listview uses databinding for rest of columns.</p>\n\n<p>Thanks!</p>\n"},{"tags":["vb.net","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13227565,"title":"Setting datagridviewcomboboxcell value","body":"<p>I have following code to bind combo box cell which works properlly:</p>\n\n<pre><code>Const colIndex As Integer = 1\n        Dim dgvcombo As DataGridViewComboBoxCell\n        dgvcombo = gvMain.Rows(_rowindex).Cells(\"SerialNumber\")\n        dtGrpBrand = getDataTable(\"select * from (select SSPERPSerialMaster.ProductID,SSPERPSerialMaster.SizeID,SSPERPSerialMaster.GaugeID, SSPERPSerialMaster.SerialID,SSPERPSerialMaster.SerialNumber,ISNULL(SSPERPSerialEntryOpening.Qty,0)+ISNULL(a.Stock,0) as [Closing Qty] \" &amp; _\n                        \"from SSPERPProductMaster \" &amp; _\n                        \"left join SSPERPSerialMaster on SSPERPSerialMaster.ProductID=SSPERPProductMaster.ProductID \" &amp; _\n                        \"left join SSPERPSerialEntryOpening on SSPERPSerialEntryOpening.SerialID=SSPERPSerialMaster.SerialID and SSPERPSerialMaster.ProductID=SSPERPSerialEntryOpening.ProductID \" &amp; _\n                        \"left join (select SerialId,SUM(ISNULL(case when AL='A' then Qty else - Qty end, 0)) as [Stock] from SSPERPStock group by SerialId) a on a.SerialId=SSPERPSerialMaster.SerialID) a \" &amp; _\n                        \"where a.[Closing Qty]&lt;&gt;0 and a.ProductID=\" &amp; gvMain.Rows(_rowindex).Cells(\"ProductId\").Value.ToString() &amp; \" and a.SizeID=\" &amp; gvMain.Rows(_rowindex).Cells(\"SizeId\").Value.ToString() &amp; \" and a.GaugeID=\" &amp; gvMain.Rows(_rowindex).Cells(\"GaugeId\").Value.ToString(), CompanyCon)\n        dtGrpBrand.Rows.Add()\n        dtGrpBrand.Rows(dtGrpBrand.Rows.Count - 1)(\"SerialNumber\") = \"-- Select --\"\n        dtGrpBrand.Rows(dtGrpBrand.Rows.Count - 1)(\"SerialId\") = 0\n        dgvcombo.AutoComplete = True\n        CType(gvMain.Rows(_rowindex).Cells(colIndex), DataGridViewComboBoxCell).DataSource = dtGrpBrand\n        CType(gvMain.Rows(_rowindex).Cells(colIndex), DataGridViewComboBoxCell).DisplayMember = \"SerialNumber\"\n        CType(gvMain.Rows(_rowindex).Cells(colIndex), DataGridViewComboBoxCell).ValueMember = \"SerialId\"\n        CType(gvMain.Rows(_rowindex).Cells(colIndex), DataGridViewComboBoxCell).Value = 0\n</code></pre>\n\n<p>this codes work perfectlly in my application while i have insert mode of data, but when user choose record from list, than i need to bond dynamically that cell of \"SerialNumber\",\nAt That time also i am properlly binding datagridviewcimboboxcell through this code, it binds my combobox cell properlly but when i give following code to set value it is not working and give me error:</p>\n\n<pre><code>gvMain.Rows(gvMain.Rows.Count - 1).Cells(\"SerialNumber\").Value = dtrow(\"SerialId\")\n</code></pre>\n\n<p>I have also tried following line to get selected value but no solution:</p>\n\n<pre><code>CType(gvMain.Rows(gvMain.Rows.Count - 1).Cells(\"SerialNumber\"), DataGridViewComboBoxCell).Value = dtrow(\"SerialId\")\n</code></pre>\n\n<p>Here gvmain is datagridview and dtrow is datarow</p>\n"},{"tags":["c#","winforms","radio","trackbar"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13232085,"title":"How can I control system sound volume with a TrackBar?","body":"<p>I'm a beginner and making an internet radio player and I want to control the volume with my own <code>TrackBar</code>. How is that possible? I haven't found any solutions to do this.</p>\n"},{"tags":["vb.net","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13228003,"title":"unable to hit the CheckBox_CheckedChanged event","body":"<p>I am trying to check one condition when i m checking a particular checkbox.below is the code</p>\n\n<pre>\nPrivate Sub CheckBox4_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles CheckBox4.CheckedChanged\n        If CheckBox4.Checked Then\n            check_CL()\n        End If</pre>\n\n<p>i put one debugger to check whether the control is going to this event or not but it's not going.please tell me what is the problem..</p>\n"},{"tags":["c#","winforms","gridview"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13231149,"title":"Datagridview not updating/refreshing","body":"<p>I have a DataDridView made of dataset of a table from the db. Now, when I add or delete a row it is updated in the database but the gridview does not deletes it. When I restart the application only then it is not visible in gridview.</p>\n\n<p>Please help</p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13230427,"title":"Creating Tables with Multiple Headers in DataGridView in C#","body":"<p>I would like to create a table with multiple headers using <code>DataGridView</code> in C#. I can create a table. However, I need multiple headers in the table. Attached is the screenshot of the table I would like to create. </p>\n\n<p>Any idea how to do it.</p>\n\n<p><img src=\"http://i.stack.imgur.com/Ashae.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#",".net","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13230220,"title":"Can't modify properties of ToolStripMenuItems in their onClick events","body":"<p>On my onClick event handler, i'm doing something like:</p>\n\n<pre><code>private void myToolStripItem_Click(object sender, EventArgs e)\n    {\n        Form form = (Form)(((taskBarToolStripMenuItem)sender).formReference);\n\n        if (form != this.ActiveMdiChild)\n        {\n            if (!form.Visible)\n                form.Show();\n            form.Activate();\n\n            ((taskBarToolStripMenuItem)sender).isSelected = true; //set it to true, so the renderer will draw them differently\n        }\n    }\n</code></pre>\n\n<p>taskBarToolStripMenuItem is a subclass of ToolStripMenuItem. When i get to my custom ToolStripSystemRenderer, items that i'm sure got its \"isSelected\" property changed to true remain with it as false. This happens to other properties, i tried Tag, Text, etc... Why? Thanks</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":71,"score":4,"question_id":13229637,"title":"Can't loop all controls in c#","body":"<p>I have a C# form with some types of controls, i throught this code for loop all <code>Labels</code> and re-parent:</p>\n\n<pre><code>private void MakeAllLabelTrans(Control frm, Control parent)\n{\n    foreach (Control ctl in frm.Controls)\n    {\n        if (ctl is Label)\n        {\n            ctl.Parent = parent;\n            // ctl.BackColor = Color.Transparent;\n        }\n        else if (ctl.HasChildren)\n        {\n            MakeAllLabelTrans(ctl, parent);\n        }\n    }\n}\n</code></pre>\n\n<p>and call as: <code>MakeAllLabelTrans(this, picBackground);</code> in Form_Load event, but some label was missed (i have puted a messagebox in the loop body - it really not in the loop), but i don't know why?</p>\n"},{"tags":["c#",".net","winforms","listview"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2886,"score":0,"question_id":969269,"title":"How do you check if the mouse click position was only inside an item in Column[0] in a listview under virtualmode?","body":"<p>C#: How do you check if the mouse click position was only inside an item in Column[0] in a listview under virtualmode?</p>\n\n<p>I can get the the Item object the mouse just clicked using ListView.GetItemAt, but after that, how could I check if it was clicked within column[0]?</p>\n"},{"tags":["c#",".net","winforms","encoding","special-characters"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":40,"score":3,"question_id":13230259,"title":"German special characters put into Byte array","body":"<p>I'm doing encrypt algotythm right now and I need to encrypt german words also. So I have to encrypt for example characters like: ü,ä or ö. </p>\n\n<p>Inside I've got a function: </p>\n\n<pre><code>private static byte[] getBytesArray(string data)\n{\n    byte[] array;\n    System.Text.ASCIIEncoding asciiEncoding = new System.Text.ASCIIEncoding();\n    array = asciiEncoding.GetBytes(data);            \n    return array;\n}\n</code></pre>\n\n<p>But when data is \"ü\", byte returned in array is 63 (so \"?\"). How can I return ü byte? </p>\n\n<p>I also tried: </p>\n\n<pre><code>private static byte[] MyGetBytesArray(string data)\n{\n    byte[] array;\n    System.Text.ASCIIEncoding asciiEncoding = new System.Text.ASCIIEncoding();\n\n    Encoding enc = new UTF8Encoding(true, true);\n    array = enc.GetBytes(data);\n\n    return array;\n}\n</code></pre>\n\n<p>but in this case I get 2 bytes in array: 195 and 188.</p>\n"},{"tags":["c#","winforms","datagridview","scrollbar"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13229589,"title":"Using one scroll bar to control two DataGridView","body":"<p>I am trying to control two DataGridView's with only one of the DataGridView vertical scroll bars being visible. </p>\n\n<p>I would appreciate any help.</p>\n\n<p>Thanks in advance,</p>\n"},{"tags":["c#","winforms","visual-studio-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13229519,"title":"What is the shortcut to auto import library in visual studio 2010, 2012 (if any- like Alt+Enter in Netbeans)?","body":"<p>I don't know where is the shortcut button to auto generate namespace import in C# winform/ window store... application, like the \"Alt+Enter\" shortcut in NetBean IDE. I and some of my friends who have programmed visual studio for several years but when we need to import library, we have to move the cursor after the Class code and click to show namespace like thí</p>\n\n<p><a href=\"http://i970.photobucket.com/albums/ae190/swenteiger7/howToPlayShortCut.png?t=1352108811\" rel=\"nofollow\">http://i970.photobucket.com/albums/ae190/swenteiger7/howToPlayShortCut.png?t=1352108811</a></p>\n\n<p>Thank you for your help :)</p>\n"},{"tags":["c#","wpf","winforms","visual-studio","icons"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13225933,"title":"The most easy way to use an Icon in every form of the project","body":"<p>I wanted to make my <code>Icon</code> universal for every <code>Form</code> of my <code>Visual Studio</code> project. I googled a lot. But solutions aren't as simple as I want. Yes, simpler was to <code>Inherit</code> <code>Form1</code>. But I have used this code and I think it's most simple.</p>\n\n<pre><code>public Form1()\n    {\n        InitializeComponent();\n        Icon icon = new Icon(\"resources\\\\icon.ico\");\n        this.Icon = icon;\n    }\n</code></pre>\n\n<p>And in other forms I did the same:</p>\n\n<pre><code>public Form2()\n    {\n        InitializeComponent();\n        Icon icon = new Icon(\"resources\\\\icon.ico\");\n        this.Icon = icon;\n    }\n</code></pre>\n\n<p>And it worked absolutely. But I an not sure about the performance and need help. What do you say, is the way harmful for performance of my software? As I'm using same Icon simultaneously.</p>\n"},{"tags":["c#",".net","winforms","datagridview"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13229386,"title":"how to make an updating datagridview freely scrollable","body":"<p>I've a <code>databound datagridiew</code> that I've implemented to update periodically. The problem is that when the <code>datagridviews</code> contents are updated the <code>datagridview</code> automatically jumps to display the last selected item.</p>\n\n<p>I've implemented the following code so the top row is always displayed:</p>\n\n<pre><code>dataGridView1.ClearSelection();\ndataGridView1.CurrentCell = null;\ndataGridView1.FirstDisplayedScrollingRowIndex = 0;\n</code></pre>\n\n<p>But it would be preferable if the entries in the <code>datagridview</code> could be scrolled freely whilst new entries are being added.</p>\n\n<p>N.B. if I remove the line:</p>\n\n<pre><code>dataGridView1.FirstDisplayedScrollingRowIndex = 0;\n</code></pre>\n\n<p>The <code>datagridview</code> will still jump to display the last selected row so I'm guessing there is another property I need to set but it can't find it!</p>\n"},{"tags":["c#","winforms","zip"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13208827,"title":"Read image file in Image object from zip file","body":"<p>I'm using <code>iconic.dll</code> file to read data from compressed files (.zip file extensions)</p>\n\n<p>Please check my code below</p>\n\n<pre><code>string zippath = txtFilePath.Text.Trim() + \"\\\\\" + foldername + \".zip\";\nArrayList arrFiles = new ArrayList();\nusing (ZipFile zip = ZipFile.Read(enrollment))\n{\n     foreach (ZipEntry e1 in zip)\n     {\n       arrFiles.Add(e1.ToString());\n     }\n}\n\nforeach (string path in arrFiles)\n{\n   Image img1 = Image.FromFile(path);  //geting error on this line\n   imageList.Images.Add(getThumbnaiImage(imageList.ImageSize.Width, img1));\n}\n</code></pre>\n\n<p>How can I read image files from a compressed folder?</p>\n"},{"tags":["sql-server","winforms","connection-string"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":344,"score":1,"question_id":7006098,"title":"ConnectionString for connecting to SQL Server Database?","body":"<p>I have an application (WinForms) which using SQL Server as its database.</p>\n\n<p>Now I am using <code>app.config</code> file to access <code>ConnectionString</code>.</p>\n\n<p>Have a look at my <code>app.config</code> file</p>\n\n<pre><code>&lt;configuration&gt;\n  &lt;connectionStrings&gt;\n    &lt;add name=\"dbConnectionString\" \n         connectionString=\"Data Source=abc-79f1f531c9f;Initial Catalog=ItemStockInParth;Integrated Security=True;Pooling=False\"\n         providerName=\"System.Data.SqlClient\"/&gt;\n  &lt;/connectionStrings&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>You can see that <code>Data Source=abc-79f1f531c9f</code>.</p>\n\n<p>Here ==> <code>abc-79f1f531c9f</code> is server name which is running on my (Developer's) PC.</p>\n\n<p>Now when application is being installed at client's site, the server name should be changed to the server name which is running on the client machine or server name which will client machine use.</p>\n\n<p>Then what should be the best criteria for handling this situation?</p>\n\n<p>Means I have to create one new form which asking user to enter their <code>Server Name</code> and as per that I creating our ConnectionString?</p>\n\n<p>Or dynamically getting the <code>servername</code>?</p>\n\n<p>Or just hard-code the <code>Server Name</code> of client machine (or server name which will client machine use) inside our <code>App.config</code> file?</p>\n\n<p>please help..... </p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12471550,"title":"how syncronize wpf richtextbox vertical scrolling with split container Panel2","body":"<p>In windows Froms I have a split container in Panle1 I have a WPF richtextbox so I want to synchronize the vertical scrolling of the richtextbox with Panel2 and vis versa help please I know how to synchronize scrolling for the Panels.</p>\n"},{"tags":["winforms","design"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":974,"score":1,"question_id":2924157,"title":"WinForm Design?","body":"<p>I'm coming from a web dev background, and do ok, but with WinForms, everything I make looks like crap.  Can you guys point me to resources with WinForm design principles that will make my WinForms easier on the eyes?</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","winforms","fonts","dpi"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":52,"score":3,"question_id":13228185,"title":"Winforms high DPI blurry fonts","body":"<p>I've created a simple Winforms application in C#. When I run the application on a machine with high DPI settings (e.g. 150%), the application gets scaled up. So far so good!\nBut instead of rendering the fonts with a higher font size, all texts are just scaled up, too. That of course leads to very blurry text (on all controls like buttons etc.).</p>\n\n<p>Shouldn't windows take care of rendering the texts correctly? For example my application's title bar is rendered crisp &amp; clear.</p>\n"},{"tags":["c#","winforms"],"answer_count":7,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":191,"score":2,"question_id":8270222,"title":"Is this a WinForm Control? ","body":"<p>I'm just wondering if this control can be used in my WinForm application. Please refer to the image below:</p>\n\n<p><img src=\"http://i.stack.imgur.com/PIv9Q.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","winforms","multithreading"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13228307,"title":"Member component of a form destruction in Windows Forms","body":"<p>I have a project in C#/Windows Forms, where I have a simple form with a <code>PictureBox</code> that i draw images to from a background thread. If I close the form while drawing is active the background thread crashes when trying to perform invoke to update the bitmap, which is quite logical. I tried putting an <code>AutoResetEvent</code> that  the destructor would wait on, so that destructor would not return until all drawing is done and the background thread knows it is supposed to exit. But I concluded that the crash happens before destructor is executed so I started to wonder, at what point are the components of the form destroyed? I assume that before the destructor? So what is a safe place to wait for the drawing to finish? Override <code>Dispose()</code> and do it there?</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":4382,"score":1,"question_id":6297282,"title":"How to Fix the bug Local processing Exception was unhandled when passing parameter to report rdlc winform?","body":"<p>I am doing college project. In that, they want a bonafide certificate. For that, I planned to pass <code>TextBox</code> string to report.</p>\n\n<p>I googled for passing parameter in a winform. Then I got this step by step process. I implement that.</p>\n\n<blockquote>\n  <p>Step:</p>\n  \n  <p>1: In Visual Studio 2010, open your\n  .rdlc file, and open “Report Data”\n  window (If you can not see this\n  window, go to View menu to open it);</p>\n  \n  <p>2: Right click the “Parameters” node,\n  and add a new Parameter, ie: named it\n  “content“;</p>\n  \n  <p>3: In your .rdlc file, add a textbox,\n  named it tbContent, and set its filed\n  express to :</p>\n  \n  <p>=Parameters!content.Value</p>\n  \n  <p>4: Go to your Form file which include\n  your reporterview control, and add the\n  following code:</p>\n\n<pre><code>       this.reportViewer1.LocalReport.ReportEmbeddedResource\n</code></pre>\n  \n  <p>= “TestReport.Report1.rdlc”;\n              ReportParameter rp = new ReportParameter(“content”,\n  this.textBox1.Text);\n              this.reportViewer1.LocalReport.SetParameters(new\n  ReportParameter[] { rp });\n              this.reportViewer1.RefreshReport();</p>\n  \n  <p>5: then you can pass the parameter\n  from the TextBox on the form to .rdlc\n  file;</p>\n</blockquote>\n\n<p>I added <code>using Microsoft.Reporting.WinForms;</code> assembly reference. </p>\n\n<pre><code> this.reportViewer1.LocalReport.ReportEmbeddedResource = \"Report1.rdlc\";\n\n            ReportParameter rp = new ReportParameter(\"content\", this.textBox1.Text);\n            this.reportViewer1.LocalReport.SetParameters(new ReportParameter[] { rp });\n            this.reportViewer1.RefreshReport();  \n</code></pre>\n\n<p>But it throws the exception:</p>\n\n<blockquote>\n  <p>Local processing Exception was\n  unhandled at<br>\n  this.reportViewer1.LocalReport.SetParameters(new\n  ReportParameter[] { rp }); \n  line.</p>\n</blockquote>\n\n<p>Here's the full error from the clipboard:</p>\n\n<pre><code>  Microsoft.Reporting.WinForms.LocalProcessingException was unhandled\n  Message=An error occurred during local report processing.\n  Source=Microsoft.ReportViewer.WinForms\n  StackTrace:\n       at Microsoft.Reporting.WinForms.LocalReport.EnsureExecutionSession()\n       at Microsoft.Reporting.WinForms.LocalReport.SetParameters(IEnumerable`1 parameters)\n       at Report.Form1.Form1_Load(Object sender, EventArgs e) in D:\\Jagadeeswaran\\Project\\Report\\Report\\Form1.cs:line 38\n       at System.Windows.Forms.Form.OnLoad(EventArgs e)\n       at System.Windows.Forms.Form.OnCreateControl()\n       at System.Windows.Forms.Control.CreateControl(Boolean fIgnoreVisible)\n       at System.Windows.Forms.Control.CreateControl()\n       at System.Windows.Forms.Control.WmShowWindow(Message&amp; m)\n       at System.Windows.Forms.Control.WndProc(Message&amp; m)\n       at System.Windows.Forms.ScrollableControl.WndProc(Message&amp; m)\n       at System.Windows.Forms.Form.WmShowWindow(Message&amp; m)\n       at System.Windows.Forms.Form.WndProc(Message&amp; m)\n       at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message&amp; m)\n       at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp; m)\n       at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)\n       at System.Windows.Forms.SafeNativeMethods.ShowWindow(HandleRef hWnd, Int32 nCmdShow)\n       at System.Windows.Forms.Control.SetVisibleCore(Boolean value)\n       at System.Windows.Forms.Form.SetVisibleCore(Boolean value)\n       at System.Windows.Forms.Control.set_Visible(Boolean value)\n       at System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 reason, ApplicationContext context)\n       at System.Windows.Forms.Application.ThreadContext.RunMessageLoop(Int32 reason, ApplicationContext context)\n       at System.Windows.Forms.Application.Run(Form mainForm)\n       at Report.Program.Main() in D:\\Jagadeeswaran\\Project\\Report\\Report\\Program.cs:line 18\n       at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)\n       at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)\n       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()\n       at System.Threading.ThreadHelper.ThreadStart_Context(Object state)\n       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)\n       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)\n       at System.Threading.ThreadHelper.ThreadStart()\n  InnerException: System.ApplicationException\n       Message=The report definition for report 'D:\\Jagadeeswaran\\Project\\Report\\Report\\bin\\Debug\\~/Report1.rdlc' has not been specified\n       Source=Microsoft.ReportViewer.Common\n       StackTrace:\n            at Microsoft.Reporting.PreviewStore.GetCompiledReport(CatalogItemContextBase context, Boolean rebuild, Byte[]&amp; reportDefinition, ControlSnapshot&amp; snapshot)\n            at Microsoft.Reporting.LocalService.GetCompiledReport(CatalogItemContextBase itemContext, Boolean rebuild, ControlSnapshot&amp; snapshot)\n            at Microsoft.Reporting.WinForms.LocalReport.EnsureExecutionSession()\n       InnerException: System.IO.DirectoryNotFoundException\n            Message=Could not find a part of the path 'D:\\Jagadeeswaran\\Project\\Report\\Report\\bin\\Debug\\~\\Report1.rdlc'.\n            Source=mscorlib\n            StackTrace:\n                 at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)\n                 at System.IO.FileStream.Init(String path, FileMode mode, FileAccess access, Int32 rights, Boolean useRights, FileShare share, Int32 bufferSize, FileOptions options, SECURITY_ATTRIBUTES secAttrs, String msgPath, Boolean bFromProxy, Boolean useLongPath)\n                 at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share)\n                 at Microsoft.ReportingServices.StandalonePreviewStore.GetReportDefinition(ReportID reportId)\n                 at Microsoft.Reporting.PreviewStore.GetCompiledReport(CatalogItemContextBase context, Boolean rebuild, Byte[]&amp; reportDefinition, ControlSnapshot&amp; snapshot)\n            InnerException: \n</code></pre>\n"},{"tags":["c#",".net","winforms"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":13158226,"title":"Allow only numbers and negative values","body":"<p>I have a <code>textbox</code> which needs only accept numbers (can be decimal values) and negative values.</p>\n\n<p>Currently I have something like this in <code>KeyPress</code> event</p>\n\n<pre><code>   if (!char.IsControl(e.KeyChar) &amp;&amp; !char.IsDigit(e.KeyChar) &amp;&amp; e.KeyChar != '.')\n    {\n        e.Handled = true;                \n    }\n</code></pre>\n\n<p>What else I should do in order to allow negative values?</p>\n\n<p>Thanks</p>\n"},{"tags":["mysql","vb.net","winforms","visual-studio-2010","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13227174,"title":"Updating Data in DGV in VB.NET using UPDATE Query","body":"<p>I asked a question earlier <a href=\"http://stackoverflow.com/questions/13225502/updating-multiple-selected-rows-in-dgv-in-vb-net\">Updating Multiple Selected rows in DGV in VB.NET</a> but I didn't quite get what I was looking for. I have a <code>DataBound DGV</code> it has 3 <code>Columns</code> namely <code>ID(not pk), Name, and Status</code>. I have 2 Buttons <code>Add and Post</code>. Add, adds Data to the DGV and DataBase(MySql) but in Status, it adds \"No\". What I want to do is for example I have 3 Rows in my DGV and highlight those 3 and click Post, the value in Status will be changed to \"Yes\". Here is what I have done so far, and it's able to change \"No\" to \"Yes\" in the <code>Column</code> <code>\"Posted\"</code>. The Problem is that even the non <code>selected</code> or <code>Highlighted</code> Rows, are also updated. I want only the <code>Highlighted</code> Rows to be updated. Any Hints or Tips Would be greatly appreciated. Please and thank you.</p>\n\n<pre><code>Using _conn As New MySqlConnection(\"Server = localhost; Username= root; Password =; Database = test\")\nUsing _comm As New MySqlCommand()\n    With _comm\n      .parameters.clear()\n      .Connection = _conn\n          For nRow = TestingDataGridView.SelectedRows.Count - 1 To 0 Step -1\n                .CommandText = \"UPDATE testing SET Posted = @iChange\"\n                .CommandType = CommandType.Text\n                .Parameters.AddWithValue(\"@iChange\", \"Yes\")\n            Next\n    End With\n    Try\n        _conn.Open()\n        _comm.ExecuteNonQuery()\n    Catch ex As MySqlException\n        MsgBox(ex.Message.ToString())\n    End Try\n\nEnd Using\n</code></pre>\n\n<p>End Using</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13227255,"title":"Select a folder with the SaveFileDialog","body":"<p>everyone.I'm just confused that how could i select a folder with the SaveFileDialog.Is there any way to customize the SaveFileDialog to allow select a folder?Looking forward to your suggestion.</p>\n"},{"tags":["c#","winforms"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13226393,"title":"show same form which was hidden before","body":"<p>In my project, there are two forms <code>frmLogin</code> and <code>frmMain</code>. After successful login from <code>frmLogin</code> I am showing the <code>frmMain</code> form to the user by doing something like this:</p>\n\n<p>In <code>frmLogin</code> form <code>button_click</code> event:</p>\n\n<pre><code>frmMain main = new frmMain();\nmain.Show();\nthis.Hide();\n</code></pre>\n\n<p>In <code>frmMain</code> when the user logs out I want to show the same <code>frmLogin</code> form (not the instance). How to do this?</p>\n\n<p>I tried this code: (<em>creating another instance of <code>frmLogin</code> which I don't want</em>)</p>\n\n<p>In <code>frmMain</code> form <code>button_click</code> event:</p>\n\n<pre><code>if (MessageBox.Show(\"Do you really want to log out?\", \"Alert\", MessageBoxButtons.YesNo).Equals(DialogResult.Yes))\n{\n    this.FormClosing -= frmMain_FormClosing;\n    //\n    Process p = new Process();\n    p.StartInfo.FileName = Application.ExecutablePath;\n    p.Start();\n    //\n    this.Dispose();\n}\n</code></pre>\n\n<p>I have also tried using <code>internal</code> specifier but no use.</p>\n\n<p>EDIT: As a trainee, I am not allowed to use <code>Static</code> keyword and altering <code>program.cs</code>. If the above approach requires restricted methods (which I have mentioned) then please suggest me an alternate approach.</p>\n"},{"tags":["c#","winforms","image-processing"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13225419,"title":"Zooming image in C#","body":"<p>I have a problem in zooming an image. I have successfully zoomed the image but the image breaks when it is scrolled up or down. </p>\n\n<pre><code>public partial class ImageDetail : UserControl\n{\n    public delegate void onClose();\n    public event onClose close;\n    Image pbImage;\n    public ImageDetail(Image img)\n    {            \n        InitializeComponent();\n        pictureBox.Image = img;\n        pbImage = img;\n        pictureBox.Width = this.pbImage.Width;\n        pictureBox.Height = this.pbImage.Height;\n        panel2.AutoScroll = true;\n        panel2.HorizontalScroll.Maximum = img.Width;\n        panel2.VerticalScroll.Maximum   = img.Height;\n        panel2.HorizontalScroll.Minimum = 0;\n        panel2.VerticalScroll.Minimum   = 0;\n        panel2.SetAutoScrollMargin(10, 10);            \n    }\n\n    private void label2_Click(object sender, EventArgs e)\n    {\n        if (close != null)\n            close(); \n    }        \n\n    private void DrawImage(int startX, int startY)\n    {            \n        if (this.pbImage == null) { return; }\n\n        Graphics pbGraphics = this.pictureBox.CreateGraphics();\n        BufferedGraphicsContext currentGraphicsContext = BufferedGraphicsManager.Current;\n        Rectangle targetRect = new Rectangle(startX, startY, (this.pbImage.Width + tmpWidth), (this.pbImage.Height + tmpHeight));\n        using (BufferedGraphics pbGDIBuffer = currentGraphicsContext.Allocate(pbGraphics, targetRect))\n        {\n            Rectangle drawRect = new Rectangle(startX, startY, (this.pbImage.Width + tmpWidth), (this.pbImage.Height + tmpHeight));\n\n            pbGDIBuffer.Graphics.DrawImageUnscaledAndClipped(this.pbImage, drawRect);\n            pbGDIBuffer.Render();                \n        }\n        pictureBox.Width = this.pbImage.Width + tmpWidth;\n        pictureBox.Height = this.pbImage.Height + tmpHeight;\n    }             \n\n    int tmpWidth = 0, tmpHeight = 0;\n    private void toolStripSplitButton1_ButtonClick(object sender, EventArgs e)\n    {\n        tmpWidth = tmpWidth + ((this.pbImage.Width * 20) / 100);\n        tmpHeight = tmpHeight + ((this.pbImage.Height * 20) / 100);\n\n        pictureBox.Width = this.pbImage.Width + tmpWidth;\n        pictureBox.Height = this.pbImage.Height + tmpHeight;\n        pictureBox.Refresh();\n        DrawImage(0, 0);\n    }\n\n    private void toolStripSplitButton2_ButtonClick(object sender, EventArgs e)\n    {\n        if(tmpWidth &gt; 0)\n            tmpWidth = tmpWidth - ((this.pbImage.Width * 20) / 100);\n        if(tmpHeight &gt; 0)\n            tmpHeight = tmpHeight - ((this.pbImage.Height * 20) / 100);\n        if (tmpHeight &lt; 0)\n            tmpHeight = 0;\n        if (tmpWidth &lt; 0)\n            tmpWidth = 0;\n        pictureBox.Refresh();\n        DrawImage(0, 0);                      \n    }\n\n    private void panel2_MouseDown(object sender, MouseEventArgs e)\n    {\n        pictureBox.Width = this.pbImage.Width + tmpWidth;\n        pictureBox.Height = this.pbImage.Height + tmpHeight;\n    }\n\n    private void panel2_MouseUp(object sender, MouseEventArgs e)\n    {\n        pictureBox.Width = this.pbImage.Width + tmpWidth;\n        pictureBox.Height = this.pbImage.Height + tmpHeight;\n    }\n\n}\n</code></pre>\n"},{"tags":["c#","winforms","visual-studio-2010","registry"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":34,"score":2,"question_id":13225841,"title":"Starting application on start-up, using the wrong path to load","body":"<p>I am using registry key to set my application to load on Windows Startup(after a user login).\nMy Code:</p>\n\n<pre><code>RegistryKey RegKey = Registry.LocalMachine;\nRegKey = RegKey.OpenSubKey(@\"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", true);\nRegKey.SetValue(\"AppName\", \"\\\"\" + @\"C:\\Users\\Name\\Desktop\" + \"\\\"\");\nRegKey.Close();\n</code></pre>\n\n<p>So with this code, my application load at startup, however the working directory is </p>\n\n<blockquote>\n  <p>C:\\Windows\\System32</p>\n</blockquote>\n\n<p>Does anyone know why ?</p>\n\n<p>This does not work for me because that program needs couple of files within the same directory as that one to operate. If the program loaded on my chosen directory(\"C:\\Users\\Name\\Desktop\") then the problem would not exist.</p>\n\n<p>Anyone has any suggestion for this ?</p>\n"},{"tags":["c#","winforms","text","panel","onpaint"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":13217138,"title":"Draw text on a Panel - SOLVED","body":"<p>OK, I fix everything, now is exactly what I want.\nI have a <code>textBox1</code>, <code>panel1</code>, and <code>drawTexta</code> (a button). </p>\n\n<p>When I click the button and choose a point in the panel, I want to draw the string from the <code>textBox1</code>. </p>\n\n<pre><code>private void panel1_Paint(object sender, PaintEventArgs e)\n{\n    using (SolidBrush br = new SolidBrush(Color.Red))\n    {\n        StringFormat sf = new StringFormat();\n        sf.FormatFlags = StringFormatFlags.DirectionRightToLeft;\n        e.Graphics.DrawString(textBox1.Text, this.Font, br, point1, sf);\n    }\n}\n\nprivate void panel1_MouseDown(object sender, MouseEventArgs e)\n{\n    point1 = new Point(e.X, e.Y);\n} \n\nbool flag = false;\nPoint point1 = new Point();\n\nprivate void drawTexta_Click(object sender, EventArgs e)\n{ \n    flag = true;\n    panel1.Refresh();\n}\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":61,"score":3,"question_id":13225702,"title":"c# format textboxes to currency when they lose focus","body":"<p>I have several lists of text boxes on a form each representing a column of a database. I want to update the form each time the user exits one of the boxes for price. the name of this list is priceBox[]. I am aware of the lostFocus event but I cant seem to figure a way to get it to work for a collection and this list can grow so I cant have a fixed number. I dont have any code for this yet. if it helps the text box controls are contained in a panel named panel1.</p>\n\n<p>I have tried searching and cant find anything on this. only for singular instances, like updating 1 text box. </p>\n\n<p>sorry if this is a duplicate but I did try to search. also I am new to c#.</p>\n\n<p>thanks. </p>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13189183,"title":"Add Panel control to form from class object","body":"<p>I'm still a bit green on C# so please forgive me if I'm asking the question in the wrong way.</p>\n\n<p>I'm writing a windows Forms program. I have a form with a Tab control on it. Inside the Tab control on one of the tabs is a FlowlayoutPanel control\nI have a class with various properties. This class represents the data on a contacts card, i.e. Name Address, Phone etc. and is designed to look like a Panel control. Here is some code:</p>\n\n<pre><code>public class clsContactCard\n{\n#region Fields (8) \n\n    private Color _backColour;\n    private BorderStyle _borderStyle;\n    private List&lt;string&gt; _detailLines = new List&lt;string&gt;();\n    private Color _foreColour;\n    private Size _size;\n    private string _subTitle;\n    private string _title;\n\n#endregion Fields \n\n#region Constructors (1) \n\n    public clsContactCard()\n    {}\n\n#endregion Constructors \n\n#region Properties (8) \n\n    public Color BackColour\n    {\n        get { return _backColour; }\n        set { _backColour = value; }\n    }\n\n    public BorderStyle BorderStyle\n    {\n        get { return _borderStyle; }\n        set { _borderStyle = value; }\n    }\n\n    public List&lt;string&gt; DetailLines\n    {\n        get { return _detailLines; }\n        set { _detailLines = value; }\n    }\n\n    public Color ForeColour\n    {\n        get { return _foreColour; }\n        set { _foreColour = value; }\n    }\n\n    public Size Size\n    {\n        get { return _size; }\n        set { _size = value; }\n    }\n\n    public string SubTitle\n    {\n        get { return _subTitle; }\n        set { _subTitle = value; }\n    }\n\n    public string Title\n    {\n        get { return _title; }\n        set { _title = value; }\n    }\n\n#endregion Properties \n\n    public Panel CreateCard()\n    {\n        // New Contact Card  \n        Point labelLoc = new Point(18, 11);             //Location for a label\n        Size labelSize = new Size(218, 16);             //default label size\n\n        Panel pnl = new Panel();                        //Instantiate a new Panel\n        pnl.BackColor = _backColour;                    //Set the new panel's properties\n        pnl.BorderStyle = _borderStyle;\n        pnl.Size = _size;\n        pnl.Visible = true;\n\n        //Title\n        Label l = new Label();                          //Create new label object\n        l.Name = \"uxTitle\";                             //Give it a name\n        l.Text = _title;                                //Assign it data from properties\n        l.Size = labelSize;                             //set its size &amp; font\n        l.Font = new Font(\"Microsoft Sans Serif\",10,FontStyle.Bold);\n        l.Location = labelLoc;                          //set its location\n        labelLoc.Y += labelSize.Height;                 //update next labels location\n        pnl.Controls.Add(l);                            //add label to panel controls\n\n        //Type\n        //Label l = new Label();\n        l.Name = \"uxSubTitle\";\n        l.Text = _subTitle;\n        l.Size = new Size(215, 15);\n        l.Font = new Font(\"Microsoft Sans Serif\",7,FontStyle.Regular);\n        l.Location = new Point(21, 27);\n        labelLoc.Y += labelSize.Height + 5;\n\n        //Detail lines\n        int lineCount = 0;\n        bool firstPhone = true;\n\n        foreach (string line in _detailLines)\n        {\n            if (SAPSCommon.Instance.IsNumeric(line.Trim()) &amp;&amp; firstPhone)\n            {\n                firstPhone = false;\n                labelLoc.Y += 5;\n            }\n            lineCount += 1;\n            //Label l = new Label();\n            l.Name = \"uxLine\" + lineCount;\n            l.Text = line;\n            l.Size = labelSize;\n            l.Font = new Font(\"Microsoft Sans Serif\",8,FontStyle.Regular);\n            l.Location = labelLoc;\n            labelLoc.Y += labelSize.Height + 5;\n        }\n        return pnl;\n    }\n}\n</code></pre>\n\n<p>The idea is to show the card object in a FlowLayoutPanel control akin to MS Outlook contacts list. I have the code to populate the object properties, but when I try to add the card object (panel) to the FlowlayoutPanel control the compiler complains about the types:</p>\n\n<blockquote>\n  <p>Error 2   Argument 1: cannot convert from 'SAPS.clsContactCard' to 'System.Windows.Forms.Control'</p>\n</blockquote>\n\n<p>The code is a s follows:</p>\n\n<pre><code>foreach (clsContacts contact in _pensioner.Contacts)\n{\n    clsContactCard card = new clsContactCard();\n    if (contact.OtherNames != \"\")\n    {\n        card.Title = string.Format(\"{0} {1} {2}\", contact.Givname, contact.OtherNames,\n                                   contact.Surname);\n    }\n    else\n    {\n        card.Title = string.Format(\"{0} {1}\", contact.Givname, contact.Surname);\n    }\n    card.SubTitle = contact.ContactTypeDescription;\n    card.DetailLines.Add(contact.Addr1);\n    string addr2 = contact.Addr2;\n    if (addr2.Length &gt;= 0) \n        card.DetailLines.Add(addr2);\n    card.DetailLines.Add(string.Format(\"{0} {1} {2}\", contact.Suburb, contact.State, contact.PCode).Trim());\n    string country = contact.Country;\n    if (country.Length &gt;= 0)\n        card.DetailLines.Add(country);\n    foreach(clsPhoneNumbers phone in contact.PhoneNumbers)\n    {\n        card.DetailLines.Add(string.Format(\"{0} - {1}\", phone.PhoneNumber, phone.PhoneType));\n    }\n    foreach(clsEmailAddresses email in contact.EmailAddresses)\n    {\n        card.DetailLines.Add(string.Format(\"{0} - {1}\", email.EmailAddress, email.EmailType));\n    }\n    card.CreateCard();\n\n    uxContactDetsFlp.Controls.Add(card);\n}\n</code></pre>\n\n<p>Can anyone shed a light on what I'm doing wrong and how to fix it? I thought the panel control could be added to the flowlayout panel.</p>\n"},{"tags":["c#","winforms","email"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13218022,"title":"Send Email without storing or prompting for password","body":"<p>I am building a Winform C# Desktop application for a client. I intend to include a  Contact form in the application through which  my client can contact me through the form. However I donot want to save the password in the application or prompt for the password from the client.</p>\n\n<p>Any idea how I can do it. Any useful pointers in the same direction would help me a lot.</p>\n"},{"tags":["c#","winforms","class","inheritance"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":61,"score":3,"question_id":13225110,"title":"Call to a Superclass function wich alters a component (label)","body":"<p>If a Superclass has a function A() which changes a Label to \"Hello World\". How can I get a subclass to call A() with the same result? As of now, I get no compile error, but the text won't change! </p>\n\n<p>Example code: </p>\n\n<pre><code>public partial class Form1 : Form\n{\n    public Form1()\n    {\n        InitializeComponent();            \n    }\n\n    private void button1_Click(object sender, EventArgs e)\n    {\n        FunctionA(\"Hello\");\n    }  \n\n    public void FunctionA(string s)\n    {\n        label1.Text = s;\n    }\n\n    private void button2_Click(object sender, EventArgs e)\n    {\n        Test t = new Test();\n    }\n}\n\nclass Test : Form1\n{\n    public Test()\n    {\n        FunctionA(\"World\");\n    }\n}\n</code></pre>\n"},{"tags":["c#","winforms","printing"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13225244,"title":"What is a good strategy for printing the contents of two panels of a windows form?","body":"<p>I have written a C# 4.0 Windows Forms Application that creates two panels which are both populated exclusively with text labels. I would like to add functionality to my application to print these panels exactly as they appear on the form, but I only want to print these panels and their contents, with no background or other parts of the form. </p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/6he9hz8c.aspx\" rel=\"nofollow\">This link</a> was especially helpful as an overview, but so far I'm only able to print what amounts to a screen capture of the form. The entire form is included, buttons, trim, background, and all. It looks like I need to \"rebuild\" the form by creating a graphics object (I use the term generically, as I'm not sure what specific graphics-related class I need to employ) and somehow transfer the contents of the panel into this object.</p>\n\n<p>My question is: what classes and/or methods should I research in order to build this graphical object? Also helpful to know: are there any handy tricks within the .NET framework or any libraries out there to automatically fit the result to a single page when building the PrintDocument object?</p>\n"},{"tags":["c#","winforms","gui","naming-conventions"],"answer_count":16,"favorite_count":17,"up_vote_count":32,"down_vote_count":0,"view_count":6040,"score":32,"question_id":1246546,"title":"Best practices for C# GUI naming conventions?","body":"<p>GUIs, whether written in WinForms or XAML, seem to have the most widely differing naming conventions between projects I see. For a simple <code>TextBox</code> for a person's name, I've seen various naming conventions:</p>\n\n<pre><code>TextBox tbName      // Hungarian notation\nTextBox txtName     // Alternative Hungarian\nTextBox NameTextBox // Not even camelCase\nTextBox nameTextBox // Field after field with TextBox on the end\nTextBox TextBoxName // Suggested in an answer...\nTextBox textBoxName // Suggested in an answer...\nTextBox name        // Deceptive since you need name.Text to get the real value\nTextBox textBox1    // Default name, as bad as you can get\n</code></pre>\n\n<p>I abide by the StyleCop rules for all my .cs files normally, and see others do so as well, but the GUI tends to break these rules or vary wildly. I haven't seen any Microsoft guidelines that specifically refer to GUI elements instead of just normal variables, or even examples that would apply outside of a console application. </p>\n\n<p><b>What are the best practices for naming elements in a GUI?</b></p>\n"},{"tags":["c#",".net","winforms","listview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":820,"score":0,"question_id":7620120,"title":"ListView subitems font not working","body":"<p>I have a listview in which I want to apply different font in different cells according to some condition. But I'm unable to do this. I tried these types of codes to add item.</p>\n\n<pre><code>ListViewItem entryListItem = listView_Standard.Items.Add(\"Items\");\n\n            // Set UseItemStyleForSubItems property to false to change \n            // look of subitems.\n            entryListItem.UseItemStyleForSubItems = false;\n\n            // Add the expense subitem.\n            ListViewItem.ListViewSubItem expenseItem =\n                entryListItem.SubItems.Add(\"Expense\");\n\n            // Change the expenseItem object's color and font.\n            expenseItem.ForeColor = System.Drawing.Color.Red;\n            expenseItem.Font = new System.Drawing.Font(\n                \"Arial\", 10, System.Drawing.FontStyle.Italic);\n\n            // Add a subitem called revenueItem \n            ListViewItem.ListViewSubItem revenueItem =\n                entryListItem.SubItems.Add(\"Revenue\");\n            revenueItem.BackColor = System.Drawing.Color.Red;\n\n            // Change the revenueItem object's color and font.\n            revenueItem.ForeColor = System.Drawing.Color.Blue;\n            revenueItem.Font = new System.Drawing.Font(\n                \"KF-Kiran\", 25, System.Drawing.FontStyle.Bold);\n</code></pre>\n\n<p>and </p>\n\n<pre><code>ListViewItem NewItem = new ListViewItem();\n             NewItem.UseItemStyleForSubItems = false;\n             NewItem.Text = \"foo\";\n             NewItem.SubItems.Add(\"bar\");\n             NewItem.SubItems.Add(\"1111111\");\n             NewItem.SubItems[1].Font = new Font(\"KF-Kiran\", 20);\nlistView_Standard.Items.Add(NewItem);\n</code></pre>\n\n<p>When I use 0th subitem to change font, new font is applied to whole row. But I want only particluarl cells to apply font.</p>\n"},{"tags":["c#",".net","winforms","gui","windows-7"],"answer_count":1,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":1825,"score":4,"question_id":8793445,"title":"Windows 7 style Dropshadow in borderless form","body":"<blockquote>\n  <p><em><strong>Short Version:</em></strong></p>\n</blockquote>\n\n<p><strong>Goal:</strong> A deep, dark, Windows 7 dropshadow in borderless WinForm in C#</p>\n\n<hr>\n\n<p><strong>Known existing solutions 1:</strong> Simple XP-style dropshadow using CreateParams.</p>\n\n<p><strong>Problem:</strong> To weak, to light, to ugly.</p>\n\n<hr>\n\n<p><strong>Known existing solutions 2:</strong> Replace GDI of form with bitmap.</p>\n\n<p><strong>Problem:</strong> Lose the ability to use controls, only functional as a splash screen.</p>\n\n<hr>\n\n<p><strong>Objective by this post:</strong> Find a median solution to this problem or an all together better one. </p>\n\n<p>.\n.\n.</p>\n\n<blockquote>\n  <p><em><strong>Long Version:</em></strong></p>\n</blockquote>\n\n<p>(Edit: I am referring to the drop-shadow going along the border of any windows form, if that wasn't clear.)\nI understand that there is a way to make XP style dropshadows in C# using: </p>\n\n<p><strong>C# Code 1 - Simple XP-style dropshadow (Problem: to light, to weak, to ugly)</strong></p>\n\n<pre><code>// Define the CS_DROPSHADOW constant\nprivate const int CS_DROPSHADOW = 0x00020000;\n\n// Override the CreateParams property\nprotected override CreateParams CreateParams\n{\n    get\n    {\n        CreateParams cp = base.CreateParams;\n        cp.ClassStyle |= CS_DROPSHADOW;\n        return cp;\n    }\n}\n</code></pre>\n\n<p>However, I am trying to figure out how to make them appear like the do in Windows 7 (deeper and larger shadows) and can't figure out the best way of doing this. </p>\n\n<p>I have a method now created that will let me override the entire form GDI and appear like a splash screen would (credit not mine):</p>\n\n<p><strong>C# Code 2: Replace form GDI with Bitmap (Problem: can't use form controls, hard to maintain GUI)</strong> </p>\n\n<pre><code>    public void SetBitmap(Bitmap bitmap, byte opacity)\n    {\n        if (bitmap.PixelFormat != PixelFormat.Format32bppArgb)\n            throw new ApplicationException(\"The bitmap must be 32ppp with alpha-channel.\");\n\n        // 1. Create a compatible DC with screen;\n        // 2. Select the bitmap with 32bpp with alpha-channel in the compatible DC;\n        // 3. Call the UpdateLayeredWindow.\n\n        IntPtr screenDc = Win32.GetDC(IntPtr.Zero);\n        IntPtr memDc = Win32.CreateCompatibleDC(screenDc);\n        IntPtr hBitmap = IntPtr.Zero;\n        IntPtr oldBitmap = IntPtr.Zero;\n\n        try\n        {\n            hBitmap = bitmap.GetHbitmap(Color.FromArgb(0));  // grab a GDI handle from this GDI+ bitmap\n            oldBitmap = Win32.SelectObject(memDc, hBitmap);\n\n            Win32.Size size = new Win32.Size(bitmap.Width, bitmap.Height);\n            Win32.Point pointSource = new Win32.Point(0, 0);\n            Win32.Point topPos = new Win32.Point(Left, Top);\n            Win32.BLENDFUNCTION blend = new Win32.BLENDFUNCTION();\n            blend.BlendOp = Win32.AC_SRC_OVER;\n            blend.BlendFlags = 0;\n            blend.SourceConstantAlpha = opacity;\n            blend.AlphaFormat = Win32.AC_SRC_ALPHA;\n\n            Win32.UpdateLayeredWindow(this.Handle, screenDc, ref topPos, ref size, memDc, ref pointSource, 0, ref blend, Win32.ULW_ALPHA);\n        }\n        finally\n        {\n            Win32.ReleaseDC(IntPtr.Zero, screenDc);\n            if (hBitmap != IntPtr.Zero)\n            {\n                Win32.SelectObject(memDc, oldBitmap);\n                Win32.DeleteObject(hBitmap);\n            }\n            Win32.DeleteDC(memDc);\n        }\n    }\n\n\n    protected override CreateParams CreateParams\n    {\n        get\n        {\n            CreateParams cp = base.CreateParams;\n            cp.ExStyle |= 0x00080000; // This form has to have the WS_EX_LAYERED extended style\n            return cp;\n        }\n    }\n</code></pre>\n\n<p>However, this does give me a full 32-bit background (as I require to add the dropshadow manually), but I lose the ability to create form elements that are visible. </p>\n\n<p>So basically, I am trying to figure out a median between these two methods. Something that will give me deep and dark drop shadows without losing other functionality / causing excessive repainting requirements. </p>\n"},{"tags":["c#","winforms","drawing"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13222630,"title":"Prevent paint from being called more than once","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/487661/how-do-i-suspend-painting-for-a-control-and-its-children\">How do I suspend painting for a control and its children?</a><br>\n  <a href=\"http://stackoverflow.com/questions/3718380/winforms-double-buffering\">Winforms Double Buffering</a>  </p>\n</blockquote>\n\n\n\n<p>I have a form that draws a bunch of user defined controls (81 of them) each of which contains another ten controls (total 8,100 ish). It all seems to be drawn sequentially (takes ~1 second or so).</p>\n\n<p>I've looked at <a href=\"http://stackoverflow.com/questions/7411099/c-sharp-winform-grid-rendering-slow-on-windows-7\">these</a> <a href=\"http://stackoverflow.com/questions/835100/winforms-suspendlayout-resumelayout-is-not-enough?answertab=oldest#tab-top\">two</a> questions, and followed the ier reccomendations (setting <code>this.DoubleBuffered = true</code> on both the form and the custom control, and <code>SetStyle(ControlStyles.OptimizedDoubleBuffer | ControlStyles.AllPaintingInWmPaint, true);</code> on the form, but that did not appear to do anything.</p>\n\n<p>Is there a way to save the paint function of the form, save it in a delegate, swap in a dummy function so that the form does not get redrawn AT ALL, and then putting the real function back and triggering it.</p>\n\n<p>I assume there is a more standard way of doing this, but I was unable to find it (it is not <code>SuspendLayout</code>/<code>ResumeLayout</code> those just deal with layout logic).</p>\n\n<p>How can I do this?</p>\n"},{"tags":["c#","winforms","combobox"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13221240,"title":"Combobox borderstyle","body":"<p>Hi I have set the combobox control's flatstyle to flat. </p>\n\n<p><strong>Is it possible to draw a border around this control?</strong> </p>\n\n<p>The control does not have a borderstyle property. Any suggestions would be appreciated. Side note: I wish to keep the flatstyle flat if at all possible.</p>\n"},{"tags":["c#","winforms","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":74,"score":2,"question_id":12769832,"title":"Datagridview to a specific excel cell","body":"<p>I got 2 datgridviews, trying to copy the header and it values to a excel sheet. The first loop is working fine for the first datagirdview</p>\n\n<pre><code>for (int i = 1; i &lt; dataGridView1.Columns.Count + 1; i++)\n            {\n                worksheet.Cells[7, i] = dataGridView1.Columns[i - 1].HeaderText;\n            }\n\n\n\n            // storing Each row and column value to excel sheet\n            for (int i = 0; i &lt; dataGridView1.Rows.Count - 1; i++)\n            {\n                for (int j = 0; j &lt; dataGridView1.Columns.Count; j++)\n                {\n                    worksheet.Cells[i + 8, j + 1] = dataGridView1.Rows[i].Cells[j].Value.ToString();\n                }\n            }\n</code></pre>\n\n<p>This is the second datagridview and I'm trying to copy the header and it's values.</p>\n\n<p>The first datagridview header values finished at 7nth row cell <code>D7</code>and the row values finished at 8th row cell <code>D8</code>. </p>\n\n<p>I want to put the second datagridview header from <code>E7</code> of 7nth row and the row values from <code>E8</code> of 8th row.</p>\n\n<pre><code>//Primary Continuation\n        for (int i = 7; i &lt; dataGridView2.Columns.Count + 1; i++)\n        {\n            worksheet.Cells[7, i] = dataGridView2.Columns[i - 1].HeaderText;\n        }\n\n\n\n        // storing Each row and column value to excel sheet\n        for (int i = 0; i &lt; dataGridView2.Rows.Count - 1; i++)\n        {\n            for (int j = 0; j &lt; dataGridView2.Columns.Count; j++)\n            {\n                worksheet.Cells[i + 8, j + 1] = dataGridView2.Rows[i].Cells[j].Value.ToString();\n            }\n        }\n</code></pre>\n"},{"tags":["c#","winforms","webbrowser-control","sessionid"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13220055,"title":"How to reopen or reset WebBrowser control?","body":"<p>I'm programming a Windows Forms Application with a <code>WebBrowser</code> control and I need to change <code>Session ID</code> on the web server. How can I do it? Is there any method to restart or reopen the browser?</p>\n"},{"tags":["c#","arrays","winforms","index"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13221309,"title":"Index was outside the bounds of the array - integers","body":"<p>I have just run across a problem which is common but I'm not sure why it's happening in this instance.</p>\n\n<pre><code>string s;\nint c1, c2, c3, c4;    \n\nprivate void button2_Click(object sender, EventArgs e)\n{\n    String number;\n    s = textBox1.Text;\n    int[] d = s.Select(c =&gt; (int)c - (int)'0').ToArray();\n\n    try\n    {\n        c1 = (4 * d[1] + 10 * d[2] + 9 * d[3] + 2 * d[4] + d[5] + 7 * d[6]) % 11;\n        c2 = (7 * d[1] + 8 * d[2] + 7 * d[3] + d[4] + 9 * d[5] + 6 * d[6]) % 11;\n        c3 = (9 * d[1] + d[2] + 7 * d[3] + 8 * d[4] + 7 * d[5] + 7 * d[6]) % 11;\n        c4 = (d[1] + 2 * d[2] + 9 * d[3] + 10 * d[4] + 4 * d[5] + d[6]) % 11;\n    }\n    catch (Exception ex)\n    {\n        MessageBox.Show(ex.Message);\n    }\n\n    number = d[1]+d[2]+d[3]+d[4]+d[5]+d[6]+c1+c2+c3+c4.ToString();\n    textBox2.Text = number;    \n}\n</code></pre>\n\n<p>It will accept the number in the first <code>TextBox</code>(es) fine. As soon as it moves onto the catch section it will pop up with an error <code>Index was outside the bounds of the array</code> Is there something obvious I'm missing? or is this quite unique to my program?</p>\n"},{"tags":["c#","winforms","dialog"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13220636,"title":"Confirm Dialog with options","body":"<p>I need some instructions on the best way to do this, I have some pseudo code.</p>\n\n<pre><code>/*form needs to be a drop down as below*/\n//    -------------------------------\n//   |                          X   |\n//    -------------------------------\n//   |     \"chose your option\"      |\n//   |                              |\n//   |       [choice 1 [v]]         |\n//   |                              |\n//   |   [ok]         [cancel]      |\n//    -------------------------------\n\nint optionchosen = confirmoptionbox();\nif (optionchosen==1){\n    //do something\n}\nif (optionchosen==2){\n    // do something else\n}\nif (optionchosen==3){\n    // third way\n}\n//etc etc\n</code></pre>\n\n<p>Now, I know how to do that with a new form (etc etc) but I was genuinely wondering if there was a more \"elegant\" option that doesn't involve heaps of things</p>\n"},{"tags":["c#","asp.net","winforms","oath2.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":125,"score":0,"question_id":8208542,"title":"Google Oath2 Login","body":"<p>Working in ASP.NET with C# for Windows Forms Applications, I'm looking to provide the login functionality through Google a/c by <code>Oath2</code>. Can any body help me with some sample or links to come out from the problem?</p>\n"},{"tags":["vb.net","winforms","usercontrols","controls","tabindex"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":3037,"score":2,"question_id":1110636,"title":"Multiple panels and groupboxes and tab order maintenance","body":"<p>I have a VB.NET (2005) application designed by my boss that uses a over 100 input and display controls (textboxes, comboxes, etc.), many with labels associated. My boss asked me to set the tab order, and then trap keypress so the user can use enter to navigate controls. I have 2 apps like this to work on.</p>\n\n<p>For the tab order, I could not use the View/TabOrder feature, since there are so many blue little tabindex popups showing, that I can not see any of the controls on the form to click. I tried clicking 'through' the popup with some success, but it still did not give me the tab order I wanted. The tab assistant that came with CodeSMART did not give me the result I wanted, either, so I could use it. </p>\n\n<p>The controls on this usercontrol are spread among many groups, which in turn are spread among several splitcontainer panels. The 1st panel in the main splitcontainer has 3 main groupboxes which are selected via a toolstripbutton ( which sets the desired groupbox to visible and turning the others to invisible.) </p>\n\n<p>Example:</p>\n\n<pre><code>Private Sub ShowMainPanel()\n    'Note: Panels are groupboxes\n    Me.MaterialPanel.Visible = False\n    Me.HaulPanel.Visible = False\n    Me.MainPanel.Visible = True\n\nEnd Sub\n</code></pre>\n\n<p>Each of these groupboxes contain more groupboxes, each of which contain 1 to 15 controls. Some are read only, but others need information from the user. The required controls have their tab stop set to true.</p>\n\n<p>So I MANUALLY set each of the main group panels tabindexes as 0 thru 2. Then for the 1st groupbox(mainpanel), I set the tabindex for each of it's controls and groupboxes that are contained within. The non-container type controls have their tabindexes set to 0 thru 25, and then the groupboxes (sub groups) on the mainpanel are 26 thru 48. I then went to each control in these sub groups and set tab index for those controls starting at 0 thru Control.count-1 for the group. </p>\n\n<p>In summary, my tab orders look like this (abbreviated):</p>\n\n<pre><code>mainPanel = 0\n  1st fields = 0.0\n  2ndfield = 0.1\n  3rd field = 0.2\n  1st group = 0.3\n    1st field in 1st grp1 = 0.3.0\n    2nd field in 1st grp1 = 0.3.1\n  2nd group = 0.4\n    1st field in 1st grp2 = 0.4.0\n    2nd field in 1st grp2 = 0.4.1\nmaterialPanel = 1\n  1st fields = 1.0\n  2ndfield = 1.1\n  3rd field = 1.2\n  1st group = 1.3\n    1st field in 1st grp1 = 1.3.0\n    2nd field in 1st grp1 = 1.3.1\n  2nd group = 1.4\n    1st field in 1st grp2 = 1.4.0\n    2nd field in 1st grp2 = 1.4.1\n</code></pre>\n\n<p>Note: I did not actually enter, for instance, 1.4.0 for a tabindex, but 0 for the control, 4 for the sub group and 1 for main group.</p>\n\n<p>I then set the zorder via the Document Outline panel in based on the tab order.</p>\n\n<p>Once I did all of this I was finally able to get the tab order I wanted to work for the mainpanel. </p>\n\n<p>But when I applied the same to the other 2 groupboxes (materialPanel and haulpanel), the tabs are completely ignored. Tab does not work at all within the app. for the 2nd to main groupboxes (MaterialPanel and HaulPanel). The app is Control Library so I use the built in UserTestContainer when debugging, and when one of the 2nd 2 groupboxes are showing, the tab key moves the focus out of the app and into the test container. </p>\n\n<p>This does not happen when on the 1st groupbox (MainPanel). It works fine.</p>\n\n<p>Setting this stuff out took me about 3-4 hours to tedious work. Due to the number of controls, this application is hard to work with, as anytime a change is made to the form designer, it takes a good 15-20 seconds to process it.</p>\n\n<p>Does anyone have a clue about what's going on here?</p>\n"},{"tags":["c#","winforms","datagridview","lookup","lookup-tables"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":55,"score":3,"question_id":13218357,"title":"Get specific value from look-up table?","body":"<p>This is the look-up class:</p>\n\n<pre><code>public class DistanceAngle\n{\n    public int distance;\n    public int distanceAngle;\n    public int valueOfBoth;\n\n    public static void getDisatnceAngleLookup()\n    {\n        List&lt;DistanceAngle&gt; distanceAngles = new List&lt;DistanceAngle&gt;\n                {\n                   new DistanceAngle{distance = -5400, distanceAngle = -220, valueOfSideAngle = 320},\n                   new DistanceAngle{distance = -5200, distanceAngle = -210, valueOfSideAngle =  290},\n                   new DistanceAngle{distance = -5000, distanceAngle = -200, valueOfSideAngle = 200},                                      \n                };\n\n        //Distance as Key Value and look for distanceAngle\n        Lookup&lt;int, int&gt; lookup = (Lookup&lt;int, int&gt;)distanceAngles.ToLookup((p =&gt; p.distance),\n                                                                    p =&gt; p.distanceAngle);\n\n        int count = lookup.Count;\n\n        // Select a collection of distanceAngles by indexing directly into the Lookup.\n        IEnumerable&lt;int&gt; cgroup = lookup[-5400];\n\n        // Output the results.\n        Console.WriteLine(\"\\nPackages that have a key of 'C':\");\n        foreach (int str in cgroup)\n            Console.WriteLine(str);\n    }\n}\n</code></pre>\n\n<p>From the interface, if the user enters <code>A = 6000 B = 400 C = -5400</code> by <code>B-A</code>.\nIf C value is equal to the <code>distance = -5400</code> from the LookUp calss then get the value <code>distanceAngle = -220</code>\nand fill to the datagrid  specific column from 1 to 5 cells.</p>\n\n<p>If C value is eqaual to the <code>distance = -5400</code> and get the value <code>valueOfSideAngle = 320</code>\nand fill to the datagrid specific column from 6 to 10 cells.</p>\n\n<p>This way I can get the column index : <code>datagridview1.Columns[\"columnName\"].Index;</code></p>\n\n<p>This is the function, where I'm performing the calculation:</p>\n\n<pre><code>private void b_calculate_Click(object sender, EventArgs e)\n    {\n\n        int value1;\n        int.TryParse(t_LongitudeRadTextBox.Text, NumberStyles.Any,\n                         CultureInfo.InvariantCulture.NumberFormat, out value1);\n\n        int value2;\n        int.TryParse(t_LongSecondaryRadTextBox.Text, NumberStyles.Any,\n                         CultureInfo.InvariantCulture.NumberFormat, out value2);\n\n        var value3 = value2 - value1;\n\n\n    }\n</code></pre>\n\n<p>How can I get the value from the lookup table which is equal to <code>value3</code>  and fill to the datagridview. Any help...!</p>\n"},{"tags":["c#","winforms","reportviewer","localreport"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":338,"score":1,"question_id":11050155,"title":"Print Layout can not display correctly in Report viewer","body":"<p>The report has been successfully generated, but I can not see its print layout. After I click the \"Print Layout\" button in Report Viewer, Error occurred:</p>\n\n<blockquote>\n  <p>\"An error occurred during local report processing, Parameter is not\n  valid.\"</p>\n</blockquote>\n\n<p>Then i click the \"Print Layout\" button again, it's ok to go back to the normal layout...</p>\n\n<p>Anyone can help?</p>\n\n<p>I'm using vs2010 reportviewer winform, and in my .rdlc file ,I did not pass any parameters to the report except bind the business obj as DataSource.</p>\n\n<p><strong>PS:</strong><br>\nAfter I delete the old rdlc file and create a new one, it works fine. Although the problem is gone, but i still don't know why!  If anyone who knows the reason tells me why, I'll be appreciated.</p>\n"},{"tags":["c#","winforms","task","task-parallel-library"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":90,"score":2,"question_id":12532281,"title":"Closing form with tasks running","body":"<p>I have a WinForms application that consists of a main UI thread and 4 tasks.  My main form has a private member level variable like this:</p>\n\n<pre><code>private bool keepThreadsRunning = false;\n</code></pre>\n\n<p>In the Load() event of my main form, I have the following:</p>\n\n<pre><code>keepThreadsRunning = true;\nvar task1Worker = Task.Factory.StartNew(() =&gt; DoStuff1());\nvar task2Worker = Task.Factory.StartNew(() =&gt; DoStuff2());\nvar task3Worker = Task.Factory.StartNew(() =&gt; DoStuff3());\nvar task4Worker = Task.Factory.StartNew(() =&gt; DoStuff4());\n</code></pre>\n\n<p>Inside of each of my DoStuff() methods, I basically have this:</p>\n\n<pre><code>while (keepThreadsRunning)\n{\n  // do work here\n  Thread.Sleep(30000); // a couple of my tasks only need to run every 30 seconds or so\n}\n</code></pre>\n\n<p>Lastly, in my Form_Closing() event handler, I have the following:</p>\n\n<pre><code>keepThreadsRunning = false;\nthis.Close();\n</code></pre>\n\n<p>Watching my application in task manager, it appears that the process is ending when I close my form but I'm a little confused about the four tasks.  Is my call to this.Close() really causing those tasks to terminate (even if they're in the Thread.Sleep() call when it happens)?  And is there a better way of accomplishing this than the way I'm coding it right now?</p>\n\n<p>EDIT - I've looked briefly at task cancellation (when my app exits) but my understanding is that my tasks would need to periodically check the cancellation token to determine if they've been cancelled.  Given that some of my tasks need to run every 30 seconds, I couldn't figure out how I'd implement that 30s wait (currently a Thread.Sleep()) and still have the task be checking the cancellation token.</p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13056698,"title":"How to override datagrdiview col cell strings Winforms","body":"<p>Actually I spent some time on the internet to look for a solution for my problem. I tried to look \"override datagrdiview col cell strings\" but I don't find any direct idea for this problem.</p>\n\n<p>I read a xml file and  display data in the col[0] in this format and it's a list(based on numbers of items, it'll load):</p>\n\n<p><code>Config0\nConfig1\nConfig2\nConfig3\nConfig4\nConfig5</code>\n..etc.. form the file.</p>\n\n<p>I want to display it  in the GUI, like this:</p>\n\n<p><code>Config1\nConfig2\nConfig3\nConfig4\nConfig5\nConfig6</code> etc....\nBut when I write it back to the file, I want to write with the original data text.</p>\n\n<p>How can i override the datagridview col cells string?? Please help me, thank you.</p>\n\n<p>Please don't give me down vote,  Please show me some example...!</p>\n"},{"tags":["c#","winforms","html-agility-pack"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13218914,"title":"Can I use HTML Agility Pack in Windows Forms Applications?","body":"<p>This is my first time doing my work with HAP, but I find a problem with <code>HtmlDocument</code> class, I can't use it, because intellisense tells me that it is ambiguous reference, this is the picture : \n<img src=\"http://i.stack.imgur.com/AmrWK.png\" alt=\"enter image description here\"></p>\n\n<p>I have imported the library needed it this code which are <code>using HTML_Agility;\nusing HtmlAgilityPack;</code> and I also add reference to its DLL file but it can't help me so much. Do you know why this happens and how to fix it?</p>\n"},{"tags":["c#","wpf","winforms","wpf-controls","activex"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13218455,"title":"How to use ActiveX in WPF Browser application?","body":"<p>i have project used  WPF WebBrowser application,can i do this in WPF WebBrowser application?</p>\n"},{"tags":["winforms","textbox","circle"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13218288,"title":"How To Create A Circle Shaped TextBox?","body":"<p>i created a small game - WinForm Application  ( Bingo for those of you who know the game )\nand i need some help please.\ni was wondering how can i create a textbox that is a circle shaped.\nand i do not meen to round the edges . \nmy goal is to show a 2-digit number in this textbox that represents the current ball that came up .\ni wanted to make it circle because of the shape of a bingo ball .</p>\n\n<p>can this be done ? or can you give (and show) me a different solution ?</p>\n\n<p>i added my current view of the game :</p>\n\n<p><a href=\"http://img138.imageshack.us/img138/8413/81894946.jpg\" rel=\"nofollow\">Players Screen</a></p>\n\n<p>thanks alot !</p>\n"},{"tags":["winforms","visual-studio-2010","generics"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":148,"score":1,"question_id":6185201,"title":"Hierarchy of generic WinForms","body":"<p>I have a following Form hiearchy:</p>\n\n<pre><code>class EditForm&lt;T&gt; : Form { }\n\nclass ConcreteForm : ConcreteFormDesignable { }\nclass ConcreteFormDesignable : EditForm&lt;int&gt; { }\n\nclass AdvEditForm&lt;T&gt; : EditForm&lt;T&gt; { } // &lt;-- ???\n\nclass AdvConcreteForm : AdvConcreteFormDesignable { }\nclass AdvConcreteFormDesignable : AdvEditForm&lt;int&gt; { }\n</code></pre>\n\n<p>How to make AdvEditForm designable?</p>\n\n<p><strong>EDIT (for Alex Aza):</strong></p>\n\n<p>It's not clear to me, what I should put into AdvEditForm.cs and AdvEditForm.Designer.cs exactly...</p>\n\n<p>AdvEditForm.Designer.cs:</p>\n\n<pre><code>public partial class NonGenericAdvEditForm { }\n</code></pre>\n\n<p>AdvEditForm.cs:</p>\n\n<pre><code>public partial class NonGenericAdvEditForm : AdvEditForm&lt;Object&gt; { }\npublic class AdvEditForm&lt;T&gt; : EditForm&lt;T&gt;  { }\n</code></pre>\n\n<p>But I don't understand from which class I should inherit AdvConcreteForm:</p>\n\n<pre><code>class AdvConcreteForm : AdvConcreteFormDesignable { }\nclass AdvConcreteFormDesignable : ??????? { }\n</code></pre>\n"},{"tags":["wpf","winforms","exception","activex","unhandled-exception"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13217250,"title":"\"XamlParsException Was Unhandled\" when use activex in wpf","body":"<p>I wrote  wpf application with browser.In Activex ,I set serialport.open() then EnableDTR=true. I know for implement activex  in wpf , must use from WindowsFormsHost class and I used. I want to in login page that is start page , when click on button ,the serialport is opened and EnableDTR is true!! but when program is running, that show XamlParsException was Unhandled!!!!</p>\n\n<p>LoginPage.xaml</p>\n\n<pre><code> public partial class LoginPage : Page\n    {\n        AXCONTROL.UserControl1 _browser;\n        public LoginPage()\n        {\n            InitializeComponent();\n            WindowsFormsHost host = new WindowsFormsHost();\n            _browser = new AXCONTROL.UserControl1();\n            host.Child = _browser;\n            this._Grid.Children.Add(host );\n            this.BtnLogin.Click += new RoutedEventHandler(_btnlogin);\n        }\n        void _btnlogin(object sender, RoutedEventArgs e)\n        {\n            serialPort1.Open();\n            serialPort1.DtrEnable = true;\n        }\n}\n</code></pre>\n\n<p>XMLParsException was Unhandel</p>\n\n<pre><code>'The invocation of the constructor on type 'Parking_Project.LoginPage' that matches the specified binding constraints threw an exception.' Line number '5' and line position '7'.\n</code></pre>\n"},{"tags":[".net","vb.net","winforms","picturebox"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2495,"score":0,"question_id":9113954,"title":"How to save PictureBox Image to SQL in VB.NET ( Windows Form )","body":"<p>I need to save a form in it user browse image &amp; set it to a  PictureBox But on another button I need save that image to SQL Server .I have a stored procedure with Insert Command (with Image Datatype)</p>\n\n<p><strong>Browser Image from Desktop, PictureBox Code</strong> :-</p>\n\n<pre><code>   Public Sub SelectImage()\n\n        With OpenFileDialog1\n            '.InitialDirectory = \"C:\\\"\n            .Filter = \"All Files|*.*|Bitmaps|*.bmp|GIFs|*.gif|JPEGs|*.jpg\"\n            .FilterIndex = 4\n        End With\n\n        If OpenFileDialog1.ShowDialog() = DialogResult.OK Then\n            PictureBox1.Image = Image.FromFile(OpenFileDialog1.FileName)\n            PictureBox1.SizeMode = PictureBoxSizeMode.StretchImage\n            PictureBox1.BorderStyle = BorderStyle.Fixed3D\n\n        End If\n    End Sub\n</code></pre>\n\n<p><strong>Save Button Code</strong> </p>\n\n<pre><code>Public Sub Insert_Update_Personal()\n        Dim UploadImage As Bitmap = PictureBox1.Image\n\n        Dim ds As DataSet = New DataSet()\n        Dim cmd As SqlCommand = New SqlCommand(\"sp_Insert_Update_Personal\", con)\n        con.Open()\n        cmd.CommandType = CommandType.StoredProcedure\n\n        cmd.Parameters.AddWithValue(\"@childrenage\", TextBox10.Text)\n        cmd.Parameters.AddWithValue(\"@picture\", UploadImage)\n        cmd.Parameters.AddWithValue(\"@hrcomments\", TextBox5.Text)\n\n        cmd.ExecuteNonQuery()\n        con.Close()\n        cmd.Dispose()\n    End Sub\n</code></pre>\n\n<p><strong>But When I run the form it gives me error  \"No mapping exists from object type System.Drawing.Bitmap to a known managed provider native type.\"</strong></p>\n"},{"tags":["c#","winforms","linq","data-binding","charts"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":41,"score":-1,"question_id":13216367,"title":"How to bind data to a chart in LINQ?","body":"<p>I am trying to create a bar chart by using LINQ. and I want to name the X and Y axis dyna But I don't know how to do that. if some one can please </p>\n"},{"tags":["c#","winforms","listbox"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13216488,"title":"Can't get list box to display SelectedText only displays \"system.windows.forms.listbox+selectedobjectcollection\"","body":"<p>I need some help i can't figure out whats wrong with my code, everytime i try to get the program to display the SelectedItems i get \"system.windows.forms.listbox+selectedobjectcollection\". I can get text from the combobox to the emailBankListBox1 but when i try to hop from the emailBanklistBox1 to listBox1 i get the text listed above. Any and all help is much appreciated. </p>\n\n<pre><code>private void addButton1_Click(object sender, EventArgs e)\n{\n    /*\n    int selectIndexInt = -1;\n\n    selectIndexInt = recipientComboBox.SelectedIndex;\n\n    if (selectIndexInt != -1)\n    {\n        emailBankListBox1.Items.Add(recipientComboBox.SelectedItem += \",\");\n    }\n\n    else\n    {\n\n    }\n    */\n    if (recipientComboBox.Text == \"\")\n    {\n        MessageBox.Show(\"Please enter a Recipient Email\");\n    }\n    else\n    {\n        emailBankListBox1.Items.Add(recipientComboBox.Text += \",\");\n    }\n    for (int i = 0; i &lt; emailBankListBox1.Items.Count; i++)\n    {\n        emailBankListBox1.SetSelected(i, true);\n    }\n}\n\nprivate void removeButton2_Click(object sender, EventArgs e)\n{\n    int selectIndexInt = -1;\n\n    selectIndexInt = emailBankListBox1.SelectedIndex;\n    if (selectIndexInt != -1)\n    {\n        emailBankListBox1.Items.RemoveAt(selectIndexInt);\n    }\n\n    else\n    {\n        MessageBox.Show(\"Select a name from the 'Recipients to recieve email' List\");\n    }\n}\n\nprivate void button5_Click(object sender, EventArgs e)\n{\n    this.Close();\n}\n\nprivate void button4_Click(object sender, EventArgs e)\n{\n\n    /* \n    for (int i = 0; i &lt; emailBankListBox1.Items.Count; i++)\n    {\n        emailBankListBox1.SetSelected(i, true);\n    }\n    */\n\n    var selectedString = emailBankListBox1.SelectedItems.ToString();\n    listBox1.Items.Add(selectedString);\n\n\n\n\n    /*\n    //Email sending\n    MailMessage myMail = new MailMessage();\n\n    myMail.To.Add(new MailAddress(emailBankListBox1.SelectedItems.ToString()));\n    myMail.From = new MailAddress(\"******m\", \"******\");\n    myMail.Subject = subjectTextBox.Text;\n    myMail.Body = bodyTextBox.Text;\n\n    SmtpClient smtp = new SmtpClient(\"smtp.gmail.com\");\n    smtp.Port = 587;\n    smtp.EnableSsl = true;\n    smtp.DeliveryMethod = SmtpDeliveryMethod.Network;\n    smtp.UseDefaultCredentials = false;\n    smtp.Credentials = new NetworkCredential(\"*********\", \"*****\");\n\n    try\n    {\n        smtp.Send(myMail);\n        MessageBox.Show(\"Message Sent\");\n    }   \n    catch\n    {\n        MessageBox.Show(\"Cannot send this message\");\n\n    }\n        */\n}\n\nprivate void recipientComboBox_SelectedValueChanged(object sender, EventArgs e)\n{\n\n    int selectIndexInt = -1;\n\n    selectIndexInt = recipientComboBox.SelectedIndex;\n\n    if (selectIndexInt != -1)\n    {\n        emailBankListBox1.Items.Add(recipientComboBox.SelectedItem += \",\");\n    }\n\n    else\n    {\n        if (recipientComboBox.Text == \"\")\n        {\n            MessageBox.Show(\"Please type or select a recipient E-mail\");\n        }\n    }\n    for (int i = 0; i &lt; emailBankListBox1.Items.Count; i++)\n    {\n        emailBankListBox1.SetSelected(i, true);\n    }\n\n}\n</code></pre>\n"},{"tags":["c#","wpf","winforms","activex"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13216388,"title":"how to create activex in wpf?","body":"<p>I want to create activex in wpf application. can I do this work?\nI wrote wpf application for parking company. now i need that use activex in my program but I wrote my activex in windows application. \nPlease help me.</p>\n"},{"tags":["c#","winforms","backgroundworker","invokerequired"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":34,"score":-1,"question_id":13215765,"title":"not yet another invoke required ( + background worker)","body":"<p>ive searched high and low for invoke required related posts on stack overflow.. its helped me learn a lot.. but i have a couple of questions.. not only relating to invoke required but also background worker.. bear with me please.. :)</p>\n\n<p>my application does something long and needs to update the gui in the process (progress bar, status bar, text boxes).. i used a thread but it gave the dreaded cross-thread exception when updating the UI.. i recently (kinda) got the hang of using invokerequired properly..[<a href=\"http://stackoverflow.com/questions/2367718/c-automating-the-invokerequired-code-pattern\">C#: Automating the InvokeRequired code pattern</a>].. the code ive used from this post is:</p>\n\n<pre><code>public static partial class CHelper\n{\n    public static void InvokeIfRequired(this Control oCtrl, MethodInvoker fnAction)\n    {\n        if (oCtrl.InvokeRequired)\n        {\n            oCtrl.Invoke(fnAction);\n        }\n        else\n        {\n            fnAction();\n        }\n    }\n}\n\npublic partial class Form1 : Form\n{\n    public void Test()\n    {\n        this.InvokeIfRequired(() =&gt;\n        {\n            Text = \"Window Title\";\n            button1.Text = \"Hello\";\n        });\n        button1.InvokeIfRequired(() =&gt;\n        {\n            Text = \"Window Title\";\n            button1.Text = \"Hello\";\n        });\n    }\n}\n</code></pre>\n\n<p>now here's something i noticed.. this.InvokeIfRequired and button1.InvokeIfRequired both do the same thing.. why is this so? i was expecting that the Text in button1.InvokeIfRequired would correspond to button1's text property.. but instead it refers to the parent form's.. to me this seems silly, unintuitive, and wrong.. or maybe im doing something wrong..</p>\n\n<hr>\n\n<p>another question.. i didnt get the hang of invokerequired back then so i resorted to using background worker.. and using progress event to update the gui.. </p>\n\n<pre><code>public partial class Form1 : Form\n{\n    private void backgroundWorker1_DoWork(object sender, DoWorkEventArgs e)\n    {\n        backgroundWorker1.ReportProgress(0, \"Hello World\");\n    }\n    private void backgroundWorker1_ProgressChanged(object sender, ProgressChangedEventArgs e)\n    {\n        if (e.UserState != null)\n        {\n            button1.Text = e.UserState as string;\n        }\n    }\n}\n</code></pre>\n\n<p>so far, it hasnt caused me problems.. i wanna know which of these two approaches is better? and why? also, is there a way to pass data to the prevous InvokeIfRequired function?</p>\n\n<p>thanks.. =)</p>\n\n<hr>\n\n<p>edit 01: <a href=\"http://stackoverflow.com/questions/4154380/is-there-any-difference-between-using-invoke-for-the-parent-form-or-for-the-targ?rq=1\">Is there any difference between using Invoke for the parent form or for the target control?</a>.. yes form.invoke and control.invoke is the same.. but why should it be? its not intuitive, and gives the wrong impression..</p>\n"},{"tags":["c#",".net","winforms","optimization","invoke"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13215946,"title":"Simplify winforms code cross thread calls","body":"<p>I'm developing a cross-thread application which have some methods within <code>Invoke</code>:</p>\n\n<pre><code>if (this.InvokeRequired)\n{\n    this.Invoke((Action)(() =&gt;\n    {\n        pbTotalProgress.Value = progress;\n        labe1.Text=\"SomeText\";\n    }));\n}\nelse\n{\n    pbTotalProgress.Value = progress;\n    labe1.Text=\"SomeText\";\n}\n</code></pre>\n\n<p>How can I write the code below a bit shorter?</p>\n"},{"tags":["c#","winforms"],"answer_count":4,"favorite_count":1,"up_vote_count":9,"down_vote_count":0,"view_count":4660,"score":9,"question_id":1295999,"title":"Event when a Window gets maximized/\"un-maximized\"?","body":"<p>Is there an Event that is fired when you maximize a WinForms Form or \"un-maximize\" it again?</p>\n\n<p>Before you say \"Resize\" or \"SizeChanged\": Those get only fired if the Size actually changes. If your window happens to be equal in size to the maximized window, they do not fire. Location looks like the next best bet, but that again feels like gambling on a coincidence.</p>\n"},{"tags":[".net","winforms","xna","window","location"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1109,"score":1,"question_id":3552707,"title":"Xna - get window location?","body":"<p>I'm trying to rig an XNA WinForms system so I can have a game editor, and I need to use the mouse for it. Since the XNA Mouse input class reports mouse position based off of the window's location, I need to place the form I have in the same spot. How can i get the location of the window that my XNA game uses?</p>\n"},{"tags":["winforms","visual-studio-2012","publish"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":217,"score":0,"question_id":13051605,"title":"Winforms: Not a Valid Win32 Application","body":"<p>I've created a simple Windows Form Application using VS2012 and I'm trying to install it to an XP machine.</p>\n\n<p>Unfortunately I get the following error message:</p>\n\n<blockquote>\n  <p>setup.exe is not a valid Win32 application.</p>\n</blockquote>\n\n<p>Admittedly, I did use the .net 4.5 framework which is an issue on XP machines. But I have now created a test application using .net 2.0 and get the same problem.</p>\n\n<p>I'm developing the app on a win7 x64 machine and tried setting the platform to x86 in the configuration manager with out any joy.</p>\n\n<p>Is this me or VS 2012? I've managed to install a test app using VS2010?</p>\n\n<p>I had a similar issue when I tried to work on a Lightswitch application using VS2012 and abandoned it.</p>\n\n<p>Any suggestions?</p>\n\n<p>Cheers,\nNumb</p>\n"},{"tags":[".net","vb.net","winforms","charts"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13215641,"title":"VB.Net Microsoft Chart - create multiple charts without displaying on form","body":"<p>I need to create a set of chart images to be imported into a PDF file. My program will display the first chart on a winform using MS Chart. I can save that using the SaveImage method.</p>\n\n<p>What I want to do is use the settings of the on-screen chart to generate and save images of related charts. I want to do this without displaying every chart as I create and save the image. I was hoping to be able to clone the displayed chart and then simply change the data source (I am using a datatable) and the legends/titles.</p>\n\n<p>Is there a way to do this?</p>\n\n<p>TIA,\nJohn</p>\n"},{"tags":["c#","winforms","wizard"],"answer_count":4,"favorite_count":8,"up_vote_count":13,"down_vote_count":0,"view_count":7197,"score":13,"question_id":2340566,"title":"Creating Wizards for Windows Forms in C#","body":"<p>I am new in Creating Wizards for Windows Forms Application in C# .Net. So i don't have any idea in wizard creation. Please give me some ideas about creating Multiple wizard.</p>\n\n<p>Regards, ravi</p>\n"},{"tags":["c#",".net","winforms","inotifypropertychanged"],"answer_count":10,"favorite_count":44,"up_vote_count":66,"down_vote_count":0,"view_count":10484,"score":66,"question_id":1315621,"title":"Implementing INotifyPropertyChanged - does a better way exist?","body":"<p>Microsoft should have implemented something snappy for INotifyPropertyChanged, like in the automatic properties, just specify {get;set;notify;}\nI think it makes a lot of sense to do it. Or are there any complications to do it? </p>\n\n<p>Can we ourselves implement something like 'notify' in our properties. Is there a graceful solution for implementing <strong>INotifyPropertyChanged</strong> in your class or the only way to do it is by raising the PropertyChanged event in each property.</p>\n\n<p>If not can we write something to autogenerate the peice of code to raise PropertyChanged  event?</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":13,"favorite_count":1,"up_vote_count":12,"down_vote_count":0,"view_count":15274,"score":12,"question_id":392098,"title":"How to make Combobox in winforms readonly","body":"<p>I do not want the user to be able to change the value displayed in the combobox. I have been using Enabled = false; but it is not very readable like when setting a Textbox.ReadOnly = true;</p>\n\n<p>Is there is a way of accomplishing this?</p>\n\n<p>Thanks,</p>\n\n<p>Kishore.</p>\n"},{"tags":["c#","winforms","datareader"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3073,"score":0,"question_id":5085031,"title":"combobox with for each loop","body":"<p>Hi I am a student do anybody know after populating the combobox with the database values. How to display the same value in the text box.   When I select a name in the combobox  the same name should be displayed in the text box I am using seleted item.  Here is the code.</p>\n\n<p>I am getting the error the following error using the foreach loop</p>\n\n<p>foreach statement cannot operate on variables of type 'object' because 'object' does not contain a public definition for 'GetEnumerator'    </p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Windows.Forms;\nusing System.Data.OleDb;\n\nnamespace DBExample\n{\n    public partial class Form1 : Form\n    {\n        private OleDbConnection dbConn; // Connectionn object\n        private OleDbCommand dbCmd;     // Command object\n        private OleDbDataReader dbReader;// Data Reader object\n        private Member aMember;\n        private string sConnection;\n        // private TextBox tb1;\n        // private TextBox tb2;\n\n        private string sql;\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        private void Form1_Load(object sender, EventArgs e)\n        {\n            try\n            {\n                // Construct an object of the OleDbConnection \n                // class to store the connection string \n                // representing the type of data provider \n                // (database) and the source (actual db)\n                sConnection =\n                    \"Provider=Microsoft.Jet.OLEDB.4.0;\" +\n                    \"Data Source=c:member.mdb\";\n                dbConn = new OleDbConnection(sConnection);\n                dbConn.Open();\n\n                // Construct an object of the OleDbCommand \n                // class to hold the SQL query. Tie the  \n                // OleDbCommand object to the OleDbConnection\n                // object\n                sql = \"Select * From memberTable Order \" +\n                      \"By LastName , FirstName \";\n                dbCmd = new OleDbCommand();\n                dbCmd.CommandText = sql;\n                dbCmd.Connection = dbConn;\n\n                // Create a dbReader object \n                dbReader = dbCmd.ExecuteReader();\n\n                while (dbReader.Read())\n                {\n                    aMember = new Member\n                            (dbReader[\"FirstName\"].ToString(),\n                             dbReader[\"LastName\"].ToString(),\n                             dbReader[\"StudentId\"].ToString(),\n                             dbReader[\"PhoneNumber\"].ToString());\n\n                    // tb1.Text = dbReader[\"FirstName\"].ToString();\n                    // tb2.Text = dbReader[\"LastName\"].ToString();\n\n                    // tb1.Text = aMember.X().ToString();\n\n\n                    //tb2.Text = aMember.Y(aMember.ID).ToString();  \n\n                    this.comboBox1.Items.Add(aMember.FirstName.ToString());\n\n                    // this.listBox1.Items.Add(aMember.ToString());\n                    // MessageBox.Show(aMember.ToString());\n                    // Console.WriteLine(aMember.ToString());\n                }\n                dbReader.Close();\n                dbConn.Close();\n            }\n\n            catch (System.Exception exc)\n            {\n                MessageBox.Show(\"show\" + exc);\n            }\n        }\n        private void DbGUI_Load(object sender, EventArgs e)\n        {\n\n        }\n\n\n        private void comboBox1_SelectedIndexChanged(object sender, EventArgs e)\n        {\n\n            this.textBox1.Text = comboBox1.SelectedItem.ToString();\n\n            textBox2.Text = string.Empty;\n            foreach (var item in comboBox1.SelectedItem)\n                textBox2.Text += item.ToString();\n        }\n\n\n        private void textBox2_TextChanged(object sender, EventArgs e)\n        {\n\n        }\n\n        private void textBox1_TextChanged(object sender, EventArgs e)\n        {\n\n        }\n    }\n\n\n\n\n\n\n}\n</code></pre>\n"},{"tags":["wpf","winforms","powershell","mmc","mmc3"],"answer_count":6,"favorite_count":2,"up_vote_count":12,"down_vote_count":0,"view_count":2119,"score":12,"question_id":473306,"title":"Benefits of developing MMC snap-ins instead of traditional GUI apps","body":"<p>What are the benefits of developing MMC snap-ins instead of traditional GUI apps? AFAIK the MMC snap-ins can be loaded remotely to control some server applications but I have never dived deep in this approach. What are the pros and cons of MMC snap-in approach over traditional Win Forms (or WPF) GUI applications?</p>\n\n<p>And btw lately PowerShell is getting a lot of attention and again AFAIK there are some relation between MMC snap-ins and PowerShell script but I don't know any further. Any ideas?</p>\n"},{"tags":["winforms","visual-c++","move"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":18,"score":-1,"question_id":13214156,"title":"How to move a form when user drags through panel, label, etc?","body":"<p>I wish to move whole form when user drags through the panel or label or any item i want.\nHow can i do this in VisualC++ ?\nI know to do so in VB, but i am working in VisualC++.\nAny help?</p>\n"},{"tags":["c#",".net","winforms","speech"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":13213652,"title":"Add another voice into .NET Speech","body":"<p>How can I add another voice into .NET Speech? I'd like to use Czech voice. I've found some <code>*.sis</code> files <code>Eliska22k.sis</code> but I don't know how to use it.</p>\n\n<pre><code>SpeechSynthesizer synth = new SpeechSynthesizer();\nforeach (var voice in synth.GetInstalledVoices())\n    Console.WriteLine(voice.VoiceInfo.Name);\n</code></pre>\n\n<p>Gives me only <code>Microsoft Anna</code>.</p>\n"},{"tags":["c#",".net","winforms","data-binding"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":245,"score":1,"question_id":7905651,"title":"How to DataBind a TextBox to a particular index in a List<>","body":"<p>I have standard databindings setup for all my TextBoxes to an Object like this:</p>\n\n<pre><code>TextBoxMenuID.DataBindings.Add(\"Text\", _selectedObject, \"ID\");\n</code></pre>\n\n<p>And I want to bind some of my TextBoxes to a List&lt;> index within that Object like this:</p>\n\n<pre><code>TextBoxQ1.DataBindings.Add(\"Text\", _selectedObject._qList[0].QuestionString, null);\n</code></pre>\n\n<p>The binding isn't working this way. Any ideas how to go about this kind of binding?</p>\n\n<p>Thanks,\nSleffTheRed</p>\n"},{"tags":[".net","visual-studio","winforms","datagridview","scrollbar"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":5853,"score":1,"question_id":472563,"title":"ScrollBar in DataGridView","body":"<p>I have a winform in vs2008 that contains a DataGridView. The datagrid contains a list with several columns. These are fixed width, exept one that I have set up to take whatever space is left and fill the width of the view. The winform is resizeable in all directions.</p>\n\n<p>The issue I am trying to solve is that when I increase the vertical size of the window the scrollbar disappears and the columns snap to the right to fill the extra space. What I would like to happen is that the vertical scrollBar never disappears. Setting ScrollBars to vertical in the properties of the DataGridView does not do this.</p>\n\n<p>Is this at all possible to achieve? And, if so, how do I get the vertical scrollbar to always be visible?</p>\n"},{"tags":["c#","winforms","tooltip","visibility"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1706,"score":1,"question_id":939579,"title":"Detect if Tooltip is shown?","body":"<p>I am manually displaying a System.Windows.Forms.Tooltip on a control using the show method, but how can I detect if a tooltip is currently shown?</p>\n\n<p>If I need to change the method for showing it to find out, that is fine.</p>\n"},{"tags":["c#","winforms","combobox","highlighting"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":81,"score":5,"question_id":13212179,"title":"Changing the Color of ComboBox highlighting","body":"<p>I am trying to work around changing the color of highlighting in a <code>ComboBox</code> dropdown on a C# <code>Windows Forms</code> application.\nI have searched the whole web for an answer, and the best option i found so far was to draw a rectangle of the desired color when the item that is selected is being drawn.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>Class Search\n{\n    Public Search()\n    {\n    }\n\n    private void addFilter()\n    {\n        ComboBox field = new ComboBox();\n\n        field.Items.AddRange(new string[] { \"Item1\", \"item2\" });\n        field.Text = \"Item1\";\n        field.DropDownStyle = ComboBoxStyle.DropDownList;\n        field.FlatStyle = FlatStyle.Flat;\n        field.BackColor = Color.FromArgb(235, 235, 235);\n        field.DrawMode = DrawMode.OwnerDrawFixed;\n        field.DrawItem += field_DrawItem;\n    }\n\n    private void field_DrawItem(object sender, DrawItemEventArgs e)\n    {\n        if (e.Index &gt;= 0)\n        {\n            ComboBox combo = sender as ComboBox;\n\n            if (e.Index == combo.SelectedIndex)\n                e.Graphics.FillRectangle(new SolidBrush(Color.Gray),\n                                         e.Bounds\n                                        );\n            else\n                e.Graphics.FillRectangle(new SolidBrush(combo.BackColor),\n                                         e.Bounds\n                                        );\n\n            e.Graphics.DrawString(combo.Items[e.Index].ToString(), e.Font,\n                                  new SolidBrush(combo.ForeColor),\n                                  new Point(e.Bounds.X, e.Bounds.Y)\n                                 );\n        }\n    }\n}\n</code></pre>\n\n<p>The problem with this code, is that once another Item in the dropdown is selected, the other Item I draw a rectangle is still with the color i want to highlight.\nThen i tried to save the last Item drawn and redraw it:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>Class Search\n{\n    private DrawItemEventArgs lastDrawn;\n\n    Public Search()\n    {\n        lastDrawn = null;\n    }\n\n    private void addFilter()\n    {\n        ComboBox field = new ComboBox();\n\n        field.Items.AddRange(new string[] { \"Item1\", \"item2\" });\n        field.Text = \"Item1\";\n        field.DropDownStyle = ComboBoxStyle.DropDownList;\n        field.FlatStyle = FlatStyle.Flat;\n        field.BackColor = Color.FromArgb(235, 235, 235);\n        field.DrawMode = DrawMode.OwnerDrawFixed;\n        field.DrawItem += field_DrawItem;\n    }\n\n    private void field_DrawItem(object sender, DrawItemEventArgs e)\n    {\n        if (e.Index &gt;= 0)\n        {\n            ComboBox combo = sender as ComboBox;\n            if (e.Index == combo.SelectedIndex)\n            {\n                e.Graphics.FillRectangle(new SolidBrush(Color.Gray), e.Bounds);\n                if(lastDrawn != null)\n                    lastDrawn.Graphics.FillRectangle(new SolidBrush(combo.BackColor),\n                                                 lastDrawn.Bounds\n                                                );\n                lastDrawn = e;\n            }\n            else\n                e.Graphics.FillRectangle(new SolidBrush(combo.BackColor),\n                                         e.Bounds\n                                        );\n\n            e.Graphics.DrawString(combo.Items[e.Index].ToString(), e.Font,\n                                  new SolidBrush(combo.ForeColor),\n                                  new Point(e.Bounds.X, e.Bounds.Y)\n                                 );\n        }\n    }\n}\n</code></pre>\n\n<p>This line returns an error because of lastDrawn.Bounds (incompatible type)</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>lastDrawn.Graphics.FillRectangle(new SolidBrush(combo.BackColor),\n                                                 lastDrawn.Bounds\n                                                );\n</code></pre>\n\n<p>I am feeling that changing the highlight color of the dropdown is impossible.\nThanks in advance!</p>\n"},{"tags":["c#","winforms","windows-installer"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13212815,"title":"using winform to pass installation path from winform to custom action","body":"<p>i am trying to create custom windows installer using windows forms. \nhow to create custom action which can accept installation path from windows form for installation. \ni am trying to assign value from windows form to <code>this.Context.Parameters[\"targetdir\"]</code> but the application is installing at default path i.e. <code>C:\\Program Files (x86)\\Microsoft\\Setup1</code>.</p>\n\n<pre><code>public override void Install(IDictionary savedState)\n        {\n            base.Install(savedState);\n            const string key_path = \"SOFTWARE\\\\VendorName\\\\MyAppName\";\n            const string key_value_name = \"InstallationDirectory\";\n\n            RegistryKey key = Registry.LocalMachine.OpenSubKey(key_path, RegistryKeyPermissionCheck.ReadWriteSubTree);\n\n            if (key == null)\n            {\n                key = Registry.LocalMachine.CreateSubKey(key_path);\n            }\n            this.Context.Parameters[\"targetdir\"] = default_installation_path;\n            string tgt_dir = this.Context.Parameters[\"targetdir\"];\n            key.SetValue(key_value_name, tgt_dir);\n        }\n</code></pre>\n\n<p>please help me i am new to installer class.</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13209116,"title":"How to manually set another form's location with textboxes?","body":"<p>On Form1 I have 2 textboxes, I want to edit the Form2's location with those. (textbox1 = X, textbox2 = Y)</p>\n\n<p>Thank you very much!</p>\n\n<p>Here is the codes I have done:</p>\n\n<pre><code>   private void button8_Click(object sender, EventArgs e)\n   {\n       frm2 = new Form2();\n       frm2.Top = int.Parse(textBox2.Text);\n       frm2.Left = int.Parse(textBox3.Text);\n   }\n</code></pre>\n\n<p>It isnt working, I think I should create a method in form2 ? sorry for my ignorance</p>\n"},{"tags":["c#","winforms","screen-resolution"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":13185557,"title":"My Windows forms application size is changing different notebooks","body":"<p>Coding my project was going well. But today i noticed a problem. My main notebook has full hd (1920x1080) resolution and i am coding my projects here. When i changed my main notebook's resolution as 1280x1024 or 1280x800 or 1024x768. There is no problem. My application's resolution is 1024x768 and it is not collapse. This is the printscreen.<img src=\"http://i.stack.imgur.com/PGYfE.jpg\" alt=\"Normal screen\"><br/>But my other notbook has 1366x768 resolution. And i am running my application this notebook. Oh! There is a disappointment. My applicaiton scren shifted.This is the bad printscreen.<img src=\"http://i.stack.imgur.com/Tx72q.jpg\" alt=\"Bad screen\"><br/>I do not understand why. Please could you help me, what can i do correcting this error?<br/>Kind regards.</p>\n"},{"tags":["c#","winforms","activex","webbrowser-control","ole"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":4292,"score":3,"question_id":2139765,"title":"OLE Container for .NET","body":"<p>I'm working on a project that requires me to load an OLE object and render it in a .NET WinForm app (C#). Unlike VB6 .NET has no built in OLE container, and the recommended approach is to use the WebBrowser control which supports displaying ActiveX content. The issue I have is the provider of the OLE object in question does not have an ActiveX control available.</p>\n\n<p>Simply put is there any way to load an OLE object onto a WebForm? Or will I need to write an ActiveX control that loads the OLE Object? If the latter, does anyone have an example of this, or recommended reading material?</p>\n\n<p>cheers,</p>\n\n<p>Marc.</p>\n"},{"tags":["c#","sql","winforms","string"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13211379,"title":"C# SQL login - Adding information fail","body":"<p>Ok so I have a string issue. Im not sure if its simple and ive just been stareing at it for ages and come to nothing, or it's something I can't avoid? </p>\n\n<p>So I am trying to login to an SQL server using C#. Once the login box shows up I pass the username and password to a connection class and the login is Sucessful. </p>\n\n<pre><code>    public void login(object sender, EventArgs e)\n    {\n        sqlconnect sql = new sqlconnect();\n\n        sql.us = textBox1.Text;\n        sql.pas = textBox2.Text;\n            try\n            {\n                sql.GetSqlConnection();\n                sql.myConnection.Open();\n                label3.Text = \"Connected\";\n                this.Hide();\n                fronthyb.Show();\n            }\n            catch (Exception ex)\n            {\n                MessageBox.Show(ex.Message);\n            }\n        }\n</code></pre>\n\n<p><strong>So below is my connection class:</strong></p>\n\n<pre><code>    public class sqlconnect\n{\n    public SqlConnection myConnection { get; set; }\n    public String us;\n    public String pas;\n    Settings1 set = new Settings1();\n\n\n    public SqlConnection GetSqlConnection()\n    {\n        if (myConnection == null)\n            myConnection = new SqlConnection(\"user id=\"+(us)+\"; password=\"+(pas)+\";server=\"+(set.SelectServer)+\";Trusted_Connection=\"+(set.SelectContype)+\";database=\"+(set.SelectDataBase)+\"; connection timeout=\"+(set.Condrop)+\"\");\n\n        return myConnection;\n    }\n\n\n}\n</code></pre>\n\n<p><strong>The issue now arrises when I attempt to add information to the database:</strong></p>\n\n<pre><code>     private void button1_Click(object sender, EventArgs e)\n    {\n\n            sql.GetSqlConnection();\n\n            SqlCommand cm = new SqlCommand(\"insert into dbo.Employee(FirstName, LastName, DoB, UserName, Email, Role, JobTitle, MemberOf) values (@FirstName, @LastName, @DoB, @UserName, @Email, @Role, @JobTitle, @MemberOf)\", sql.myConnection);\n            cm.Parameters.AddWithValue(\"@FirstName\", textBox2.Text);\n            cm.Parameters.AddWithValue(\"@LastName\", textBox3.Text);\n            cm.Parameters.AddWithValue(\"@DoB\", textBox5.Text);\n            sql.myConnection.Open();\n            cm.ExecuteNonQuery();\n            sql.myConnection.Close();\n            this.Close();\n</code></pre>\n\n<p>I havnt got any catches yet since its still in development but the program crashes and basically says the User is not allowed. I tested the strings in the connection classes and when i call them after I have logged in it returns nothing. So it seems like its being replaced with \"null\" at somepoint? Im not sure. Anyone see anything obvious? Sorry for the long question. Thank you. </p>\n"},{"tags":["c#",".net","windows","winforms","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":36,"score":0,"question_id":13209146,"title":"Shifting values ​​between Data Grid View","body":"<p>I have a problem. I create tabs in the newly created objects Data Grid (each has different information, which also calculate the average). The data in the Data Grid are written to the SQLite database. After reading the DGV creates a dynamic column from the arithmetic mean, I want to move without having to write to the database to another column. Is a good way would be to store data in an array? Please understand I am a beginner ...</p>\n"},{"tags":[".net","vb.net","winforms","mshtml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13210584,"title":"Unable to cast COM object of type 'System.__ComObject' to interface type 'mshtml.HTMLElementCollection","body":"<p>Am trying to use mshtml to fill a form on vb.net through the webbrowser control,</p>\n\n<pre><code>Dim doc As MSH.IHTMLDocument2 = DirectCast(wbMain.Document.DomDocument, MSH.IHTMLDocument2)\nDim buttons As MSH.HTMLElementCollection = doc.getElementsByTagName(\"button\")\nDim Inputs As MSH.HTMLElementCollection = doc.getElementsByTagName(\"input\")\n</code></pre>\n\n<p>but i get the following error</p>\n\n<blockquote>\n  <p>Unable to cast COM object of type 'System.__ComObject' to interface\n  type 'mshtml.HTMLElementCollection'. This operation failed because the\n  QueryInterface call on the COM component for the interface with IID\n  '{3050F56B-98B5-11CF-BB82-00AA00BDCE0B}' failed due to the following\n  error: No such interface supported (Exception from HRESULT: 0x80004002\n  (E_NOINTERFACE)).</p>\n</blockquote>\n\n<p>can anyone help me out with the possible solution?</p>\n"},{"tags":["vb.net","winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":22,"score":-1,"question_id":13182847,"title":"Hiding a SerialPort property in a PropertyGrid control (BrowsableAttribute not doing it)","body":"<p>I have a class, one of its properties is of type SerialPort.</p>\n\n<p>I am using a PropertyGrid to show the properties of my class, and I use BrowsableAttribute to hide some properties.</p>\n\n<p>However, I cannot hide the SerialPort property using BrowsableAttribute. It just show the property and all the subproperties.</p>\n\n<p>How could I hide it? I am using VB.NET. Thank you.</p>\n"},{"tags":["c#","winforms","hud"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":40,"score":0,"question_id":13209385,"title":"Creating a HUD for PokerStars using C#","body":"<p>I want to create a HUD for PokerStars similar to Holdem Manager:</p>\n\n<p><a href=\"http://www.winallpoker.com/wp-content/uploads/pokerstars-hud.jpg\" rel=\"nofollow\">Screenshot</a></p>\n\n<p>I'm using Visual Studio and C# language, and Windows 7 64-bit. The HUD will show some boxes with some information. The boxes must be draggable and semi-transparent, and the user can set their opacity. When the mouse hovers one of these boxes, additional information is displayed. I have no control over the PokerStars window that will have the HUD, that is I cannot edit it in Visual Studio.\nI need some advices about how to achieve this, and what is the best way to do this.</p>\n\n<p>My first attempt was about using Windows Forms with SetParent function via PInvoke, but transparency is not working:</p>\n\n<p>My HUD is just a set of semi-transparent boxes that must provide additional information to the window they are attached to. The problem is that I cannot make my hud element semi-transparent when it is inside another application's form. My hud element is a box that inherits from the Form class. It's nothing but a borderless form (BorderStyle is set to \"None\", 100% opacity) with some colored labels inside, no code was added when creating it. So, I have a main form class called Form1 and another form class called HUDBox which is the hud element I want to display inside Form1. Both inherit from the Form class.\nIf I set HUDBox object's opacity to anything less then 100%, the HUDBox object just won't display inside Form1 object. I also tried using TransparencyKey, SetWindowLong and SetLayeredWindowAttributes via PInvoke but it makes everything transparent, not just the HUDBox object. Here is the code:</p>\n\n<p>Program.cs:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Windows.Forms;\nusing System.Diagnostics;\nusing System.Runtime.InteropServices;\nusing System.Text;\n\nnamespace MyHUD\n{\n    public static class Program\n    {\n        public static Form1 mainForm;\n\n        [STAThread]\n        static void Main()\n        {\n            Application.EnableVisualStyles();\n            Application.SetCompatibleTextRenderingDefault(false);\n            mainForm = new Form1();\n            HUD psHUD = new HUD();\n            Application.Run(mainForm);\n        }\n    }\n}\n</code></pre>\n\n<p>HUD.cs:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Runtime.InteropServices;\nusing System.Diagnostics;\nusing System.Drawing;\n\nnamespace MyHUD\n{\n\n    class HUD\n    {\n        private static int HOW_MANY_HUDBOXES = 4;\n\n        [DllImport(\"user32.dll\", SetLastError = true)]\n        static extern IntPtr SetParent(IntPtr hWndChild, IntPtr hWndNewParent);\n\n        private List&lt;HUDBox&gt; hudBoxes = new List&lt;HUDBox&gt;(HOW_MANY_HUDBOXES);\n\n        public HUD()\n        {\n            initHudBoxes();\n        }\n\n        private void initHudBoxes()\n        {\n            for (int hb = 0; hb &lt; HOW_MANY_HUDBOXES; hb++)\n            {\n                HUDBox newHudBox = new HUDBox();\n                hudBoxes.Add(newHudBox);\n                //SetParent(newHudBox.Handle, Program.mainForm.Handle);\n                newHudBox.Show();\n            }\n            UserControl1 control = new UserControl1();\n            SetParent(control.Handle, Program.mainForm.Handle);\n            control.Show();\n        }\n\n    }\n}\n</code></pre>\n\n<p>Code for HUDBox.cs and Form1.cs are not relevant as they are simple auto-generated Forms. This program adds 4 copies of my hud element inside the main form. My Form1 class is just for testing, it will be replaced by the external PokerStars window.\nOpacity works fine for my hud boxes when I don't use the SetParent function, because they are not set as Form1's children.</p>\n\n<p>I've also tried to use a UserControl instead of my HUDBox form:\nUserControl1.cs:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Drawing;\nusing System.Data;\nusing System.Linq;\nusing System.Text;\nusing System.Windows.Forms;\n\nnamespace MyHUD\n{\n    public partial class UserControl1 : UserControl\n    {\n        public UserControl1()\n        {\n            InitializeComponent();\n            SetStyle(ControlStyles.SupportsTransparentBackColor, true);\n            this.BackColor = Color.FromArgb(127, 0, 0, 255);\n        }\n\n        private void UserControl1_Load(object sender, EventArgs e)\n        {\n\n        }\n    }\n}\n</code></pre>\n\n<p>I've manually added this UserControl1 to Form1 using VisualStudio, and it shows fine with correct opacity, but then I added another UserControl1 via SetParent and the transparency doesn't work:</p>\n\n<p><a href=\"http://i.stack.imgur.com/VDchg.jpg\" rel=\"nofollow\">Screenshot</a></p>\n\n<p>I've also tried to use combinations of the following functions but nothing worked, the transparency applied to the whole window instad of just the hud elements inside it:</p>\n\n<pre><code>[DllImport(\"user32.dll\")]\n        static extern int SetWindowLong(IntPtr hWnd, int nIndex, int dwNewLong);\n        [DllImport(\"user32.dll\")]\n        static extern bool SetLayeredWindowAttributes(IntPtr hwnd, uint crKey, byte bAlpha, uint dwFlags);\n        [DllImport(\"user32.dll\", SetLastError=true)]\n        static extern int GetWindowLong(IntPtr hWnd, int nIndex);\n\n        public const int GWL_EXSTYLE = -20;\n        public const int WS_EX_LAYERED = 0x80000;\n        public const int LWA_ALPHA = 0x2;\n        public const int LWA_COLORKEY = 0x1;\n\n        //set the window style to alpha appearance\n        private void setWindowOpacity(IntPtr handle, byte opacity)\n        {\n            SetLayeredWindowAttributes(handle, 0, opacity, LWA_ALPHA);\n        }\n\n        private void setWindowLayered(IntPtr handle)\n        {\n            SetWindowLong(handle, GWL_EXSTYLE, GetWindowLong(handle, GWL_EXSTYLE) ^ WS_EX_LAYERED);\n        }\n</code></pre>\n\n<p>Is there a way to make my hud elements children of the PokerStars window keeping the correct transparency?</p>\n\n<p>Is there another way for creating this HUD, maybe by using GDI?</p>\n"},{"tags":["c#",".net","winforms","c#-4.0","dataset"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13208996,"title":"evade deleted row of dataset in database table","body":"<p>I dont know what to keep the heading (still confused, sorry for that). In my project, I am trying to update the database table through <code>DataSet</code>. Well I achieved this but when I delete any row in my <code>DataSet</code> and try to update the Database table then VS is showing error --> \"Deleted row information cannot be accessed through the row\". Then I searched in Internet I got the solution in this <a href=\"http://stackoverflow.com/q/4321840\">answer</a>. Now my code is not showing any error but to my exclamation the database is being updated with new values of <code>DataSet</code> both existing and <strong>deleted too</strong>. I dont want to add the deleted rows of <code>Dataset</code> to database table. How to solve this?</p>\n\n<p>In my code I am using <code>DataRowVersion.Original</code>, should I change it? I also tried other values of <code>DataRowVersion</code> but no result.</p>\n"},{"tags":["c#","sql","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13208041,"title":"Desktop Application gridview cell values lock alternate according to cell values","body":"<p>I have a grid, It have 6 columns(item name,min quantity,max quantity,max amout,max amount,Discount).</p>\n\n<p><strong>Requirement</strong> </p>\n\n<p>When I select <strong>min Quantity</strong>, <strong>max Quantity column</strong> will Disable And its Value become Zero,when i select <strong>min amount ,max amout column</strong> will Disable and vice Versa. When i enter min value in quantity then row of grid contain max value from first row.</p>\n"},{"tags":["ajax","winforms","c#-4.0","webbrowser-control"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13207862,"title":"How to detect request URL occured by AJAX?","body":"<p>in windows application i have one WebBrowser control when an webpage do an AJAX call i want to detect this call and also want request URL occured by AJAX call?</p>\n"},{"tags":["c#","asp.net","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":53,"score":3,"question_id":13208042,"title":"How to read a web.config from .Net Window Application","body":"<p>I'm developing a .NET Framework 4.0 based Windows application.<br/>\nI have a requirement of distributing this window application, along with source code to client.</p>\n\n<p>When I test I'm using my own database credentials.<br/>\nSo I want a method to somehow hide the app.config details.</p>\n\n<p>For this, I tried with encrypting values in app.config but faced an issue with token keys.<br/>\nWhile researching about it, I found that I can use: </p>\n\n<pre><code>System.Web.Configuration.WebConfigurationManager.OpenWebConfiguration. \n</code></pre>\n\n<p>But that again required username and password for accessing remote server and don't want to show them to the client. </p>\n\n<p>So for this I planned to read web.config hosted on IIS 7.5 Server.</p>\n\n<p>Could you please help me in that context?<br/>\nOr if you have better ideas to achieve the objective, do share.</p>\n"},{"tags":["c#","winforms"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":76,"score":1,"question_id":13208457,"title":"allow only distinct values in ComboBox","body":"<p>In my project, I'm trying to populate <code>ComboBox</code> from <code>DataSet</code>. I succeeded in populating but the values inside the <code>ComboBox</code> are not distinct (Because it shows the values present in <code>DataSet</code>). I cant bind the <code>ComboBox</code> to <code>DataSet</code> because I'm adding \"Select\" text at first of populating the values.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>ComboBox --&gt; cmb\nDataSet --&gt; ds\nDataSet Column Name --&gt; value(string)\n</code></pre>\n\n<hr>\n\n<p>Here is my code:</p>\n\n<pre><code>cmb.Items.Clear();\ncmb.Items.Add(\"Select\");\nfor (int intCount = 0; intCount &lt; ds.Tables[0].Rows.Count; intCount++)\n{\n    cmb.Items.Add(ds.Tables[0].Rows[intCount][value].ToString());\n}\ncmb.SelectedIndex = 0;\n</code></pre>\n\n<p>How would I allow distinct values (or restrict duplicate values) inside the <code>ComboBox</code>?</p>\n"},{"tags":["c#","winforms","telerik","controls"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":30,"score":-5,"question_id":13208101,"title":"Telerik Controls for WinForms","body":"<p>Is there any other option available so that I can use them for free but no trial version?</p>\n\n<p>Help me if other third party controls are available for free.</p>\n"},{"tags":["c#",".net","winforms","c#-4.0","dataset"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13207303,"title":"filter dataset based on the selected values in ComboBox","body":"<p>In my application I am trying to use <code>RowFilter</code> or <code>Select</code> methods of <code>DataSet</code> to show the values selected by the User in <code>ComboBox</code>. The <code>DataSet</code> has five columns hence my project has five <code>ComboBoxes</code> populated with same values of columns of <code>DataSet</code> respectively. Now I am trying to search the user selected values in the DataSet and populate in DataGridView. I have tried the below: (<em>not working</em>)</p>\n\n<pre><code>dgvMain.DataSource = null;\ndgvMain.DataSource = dsMainDoctors.Tables[0].Select(\"Name = '\" + cmbDoctorName.Text +\"'\");\n</code></pre>\n\n<p><strong>or</strong>                </p>\n\n<pre><code>dgvMain.DataSource = null;\ndgvMain.DataSource = dsMainDoctors.Tables[0].DefaultView.RowFilter = \"Name = '\" + cmbDoctorName.Text + \"'\";\n</code></pre>\n\n<p>The first attempt is not showing anything but the second one is showing something like the below image instead of showing columns. Here I am trying to search with only one column value, but I need to search with three different columns of <code>DataSet</code> how to do that?</p>\n\n<p><img src=\"http://i.stack.imgur.com/IFIRa.png\" alt=\"enter image description here\"></p>\n\n<p>I know I am doing something wrong in my code. please suggest what should I do to correct my code. Please no linq because it is restricted by my head members. but all type of anwswers are welcome.</p>\n"},{"tags":["c#","winforms"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":64,"score":-1,"question_id":11825754,"title":"sound play for any computers","body":"<p>I use these following codes to play music while clicking the button.</p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n    {\n        SoundPlayer s = new SoundPlayer();\n        s.SoundLocation = @\"f:\\1.wav\";\n        s.Play();\n    }\n</code></pre>\n\n<p>But these codes are only for my computer what should i do so that i can play this sound on the other computers like database. what should i do so that i can play this song in other computers?</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":84,"score":0,"question_id":10633943,"title":"Form keydown in C#","body":"<p>I use these codes to inform users when they press a button and show them in a message box that you have pressed a button. In the winform I have a button, so these codes won't working until I change button1 tabstop to false. and when I click on the button after that it won't tell users that they're pressing a button.</p>\n\n<pre><code>private void Form1_KeyDown(object sender, KeyEventArgs e)\n{\n   if (e.KeyCode == Keys.A)\n   {\n      MessageBox.Show(\"You have pressed A\");\n   }\n}\n</code></pre>\n\n<p>These codes won't working until I change tabstop of the button to false. Help to how can I do that and let the users know when they pressed a button in any time.</p>\n\n<p>Any help will be appreciated </p>\n"},{"tags":["c#","winforms","tablelayoutpanel"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":37,"score":2,"question_id":13205365,"title":"TableLayoutPanel remove empty rows","body":"<p>I'm trying to remove all empty rows from a <code>TableLayoutPanel</code>. So far I have been able to do it this way</p>\n\n<pre><code>private void RemoveEmptyRows()\n{\n    for (int row = 0; row &lt; tablePanel.RowCount - 1; row++)\n    {\n        bool hasControl = false;\n        for (int col = 0; col &lt; tablePanel.ColumnCount; col++)\n        {\n            if (tablePanel.GetControlFromPosition(col, row) != null)\n            {\n                hasControl = true;\n                break;\n            }\n        }\n        if (!hasControl)\n            tablePanel.RowStyles.RemoveAt(row);\n    }\n}\n</code></pre>\n\n<p>Is there a better way of this? My approach seems too overwhelmed.</p>\n"},{"tags":["c#","winforms",".net-2.0","excel-2007"],"answer_count":9,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":5386,"score":6,"question_id":4106062,"title":"read .xlsx without Excel and OLEDB","body":"<p>Is there any chance to read .xlsx files in C# without having Excel installed on the client, and with no OLEDB connection available?</p>\n\n<p>The application is a Winforms project written in VS2005 C# .NET Framework 2.0.</p>\n"},{"tags":["c#","winforms","dataset","checkedlistbox","checklistbox"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13205105,"title":"Set checked items in checkedlistbox from list or dataset","body":"<p>I have a CheckedListBox and I would like to check all the items that are in another List.\nThis code does not work since the CheckedItems property is read-only and the types do not match, but it gives the best idea of what I want to do.</p>\n\n<pre><code>    checkedListBox1.DataSource = DataSetSelectAll().Tables[0];\n    checkedListBox1.ValueMember = \"id_table\";\n    checkedListBox1.DisplayMember = \"name\";\n\n    List&lt;tableClass&gt; list = MyCheckedList();\n    checkedListBox1.CheckedItems = list;\n</code></pre>\n\n<p>I know this is wrong but do not know how to explain it better.</p>\n"},{"tags":["c#","xml","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13206807,"title":"how to determine if a c# application is busy?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/8099149/how-to-use-progress-bar-during-loading-an-xml-file\">How to use Progress bar during loading an xml File</a>  </p>\n</blockquote>\n\n\n\n<p>I have an XML file and there are almost 200.000 records in the XML file.<br>\nI load those records to the DataTable like below.  </p>\n\n<pre><code>string file = \"C:\\\\records.xml\";\nDataTable dt = new DataTable();\ndt.ReadXml(file);\n</code></pre>\n\n<p>when this process works application waits until loading data to datatable.<br>\nSo, i want to use this time. And i want to show to user processbar while loading data to the datatable.<br>\nHow can i do it?</p>\n"},{"tags":["c#","xml","winforms","xml-serialization"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13206098,"title":"How can I output a raw byte array into my XML using XmlWriter?","body":"<p>I'm trying to output some raw byte data in some of my XML nodes.\n<br>I do not believe the <code>Base64</code> output to be suitable for my solution.</p>\n\n<p>My current work is as follows:</p>\n\n<p>To save to the file:</p>\n\n<p>(Member function in the container class Foo)</p>\n\n<pre><code>public void save(String file)\n{\n    XmlWriterSettings settings = new XmlWriterSettings();\n\n    XmlSerializer serializer = new XmlSerializer(typeof(Foo));\n    XmlWriter writer = XmlWriter.Create(file, settings);\n    serializer.Serialize(writer, this);\n}\n</code></pre>\n\n<p>To serialize the class (the class is inherited from IXmlSerializable):</p>\n\n<p>(The data in <code>Bytes</code> is the raw data)</p>\n\n<pre><code>public void WriteXml(XmlWriter writer)\n{\n    char[] temp = new char[Bytes.Length];\n    for (int i = 0; i &lt; temp.Length; i++)\n    {\n        int n = (int)Bytes[i];\n        temp[i] = (char)n;\n    }\n    writer.WriteRaw(temp, 0, temp.Length);\n}\n</code></pre>\n\n<p>I'm certain that after this operation the data in <code>Bytes</code> exactly matches the data in temp but after I have serialized the class the raw data in the output file does not seem to match, although some parts look similar. I have also tried playing around with encode settings on the <code>XmlWriter</code>, but that frequently ends in exceptions.</p>\n"},{"tags":["c#",".net","winforms","scrolling","flowlayoutpanel"],"answer_count":2,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":887,"score":1,"question_id":2245012,"title":"How to scroll a flowlayoutpanel while dragging?","body":"<p>In my Windows Forms application, I'm using a FlowLayoutPanel control to display a list of items to users.  I've been able to successfully implement reordering the items in the FlowLayoutPanel by having the user drag the control to the desired position within the FlowLayoutPanel.  </p>\n\n<p>But I don't know how to scroll the FlowLayoutPanel when the user drags an item past the boundaries of the panel.  I've seen examples for ListView controls but those techniques don't seem to apply to the FlowLayoutPanel.</p>\n\n<p>Can someone provide sample code, preferably in c#, on how to implement this functionality?</p>\n\n<p>I can provide code examples of my current reordering methodology if desired.</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#",".net","winforms","gui"],"answer_count":11,"favorite_count":6,"up_vote_count":8,"down_vote_count":0,"view_count":5491,"score":8,"question_id":907830,"title":"How do you prevent a windows form being moved?","body":"<p>How would i go about stopping a form from being moved. I have the form border style set as FixedSingle and would like to keep it this way because it looks good in vista :)</p>\n"},{"tags":["winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13202737,"title":"What Determines Which Item Is on Top in Visual Studio","body":"<p>So I have a form with a tabcontrol that takes up the entire view. I have 3 buttons that I have managed to get to be on top of this tabcontrol at all times. I have a 4th button that is always underneath the tab control. How do I get always on top like the others?</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":622,"score":2,"question_id":9588540,"title":"How can I stop a double click of the window title bar from maximizing a window of FormBorderStyle.FixedToolWindow?","body":"<p>I'm annoyed that the I'm promised a fixed window that the user can't resize, but then of course they're allowed to double click the title bar to maximize this 'unresizable' window. How can I turn this off? Can I do it with winforms code, or must I go down to Win32?</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","winforms","visual-studio-2010","icons","taskbar"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13194678,"title":"Taskbar button/icon does not appear properly if it is set to combine","body":"<p>I am facing the issue in windows 7 taskbar button. When set Taskbar Button property to \"Always combine\" then my winform application (developed using VS 2010) buttons appeared with default icon.\nBut if I set Taskbar Buttons property to \"Never combine\" then it appears with correct icon which I have set for my exe application.</p>\n\n<p>Any idea how can I resolve this issue.. it is suppose to come with icon on combine always settings.</p>\n\n<p>Regards,\nSubodh</p>\n"},{"tags":["winforms","c#-4.0","decode","qr-code","zxing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13200624,"title":"zXing: Unable to read a valid QR code","body":"<p>I'm using zXing C# library to decode QR code in my winforms application in VS 2010. It works fine for some images, but fails for a few.</p>\n\n<p><strong>exception message :</strong> </p>\n\n<blockquote>\n  <p>\"Exception of type 'com.google.zxing.ReaderException' was thrown.\"</p>\n</blockquote>\n\n<p><strong>here is my code :</strong>   </p>\n\n<p><em><strong>Code for the function that returns the decoded data</em></strong></p>\n\n<pre><code>    public string GetQRValue(Bitmap value)\n    {\n        string result = string.Empty;\n\n        try\n        {\n            QRCodeReader reader = new QRCodeReader();\n            //com.google.zxing.Reader re\n            com.google.zxing.LuminanceSource source = new RGBLuminanceSource(value, value.Width, value.Height);\n            var binarizer = new HybridBinarizer(source);\n            var binBitmap = new BinaryBitmap(binarizer);\n            result = reader.decode(binBitmap).Text;\n        }\n        catch(Exception ex)\n        {\n            result = ex.Message; //string.Empty;\n        }\n\n        return result;\n    }\n</code></pre>\n\n<p><em><strong>Code that calls the above function :</em></strong>  </p>\n\n<pre><code>Bitmap image1 = (Bitmap)Image.FromFile(txtFile.Text , true);\nlblData.Text = cls.GetQRValue(image1);\n</code></pre>\n\n<p>Here txtFile is the path to the file, and cls is a object of the class that contains the decoding function.  </p>\n\n<p><em><strong>Following is the image that fails to decode.</em></strong>  </p>\n\n<p><img src=\"http://i.stack.imgur.com/TEiIH.jpg\" alt=\"Qr code that fails to decode\"><br>\nI've tried tried decoding it at the following website. And is decoded there.<br>\n<a href=\"http://www.patrick-wied.at/static/qrgen/\" rel=\"nofollow\">http://www.patrick-wied.at/static/qrgen/</a></p>\n\n<p><em><strong>And the following image is decoded successfully.</em></strong>  </p>\n\n<p><img src=\"http://i.stack.imgur.com/P8irV.png\" alt=\"Qr code that decoded successfully\"></p>\n\n<p>Please help me to solve the issue</p>\n"},{"tags":["c#","winforms","datagridview","sendkeys"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":547,"score":0,"question_id":3630983,"title":"C# Send keystroke to DataGridViewCell","body":"<p>I have a <a href=\"http://stackoverflow.com/questions/3630097/editable-date-in-datagridview-using-datetimepicker\">DateTimePicker</a> cell in my DataGridView.  I'd like to be able to enter edit mode and drop the calendar when a button is clicked.  I'm able to do the first part without difficulty but the second isn't working.  If I have a standalone DateTimePicker the SendKeys call does work as expected.  </p>\n\n<pre><code>//Select the cell and enter edit mode -  works\nmyDGV.CurrentCell = myDGV[calColumn.Index, e.RowIndex];\nmyDGV.BeginEdit(true);\n\n//Send an ALt-Down keystroke to drop the calendar  - doesn't work\nSendKeys.SendWait(\"%{DOWN}\");\n</code></pre>\n\n<p>From debugging I believe that the problem is that the keystroke is being sent to the DGV and not the specific cell that I'm trying to edit.  The reason I think is is that I've put code to log keys received by the grids KeyPress and KeyDown events.  They log my arrowing around the grid and the keys sent by SendKeys, but not those from when I'm editing a cell by typing in it.</p>\n"},{"tags":["c#","winforms","richtextbox"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":33,"score":3,"question_id":13198635,"title":"Numbered list on Richtextbox","body":"<p>I'm trying to add numbered list functionality to a text editor. RichTextbox already provides the <code>SelectionBullet</code> property to change a selection to a bulleted list. But i was unable to find a similar property to generate numbered list. Is there any <em>standard way</em> to create a numbered list on Richtextbox. <strong><em>If not</strong>, i would have to implement it myself so code snips that could help me do that will help</em>, Thank you.</p>\n"},{"tags":[".net","winforms","multithreading"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12811924,"title":"Multithread control of .net winform app","body":"<p>I am working on a .net Windows form app using VS2010.\nIn this app, I need four background threads for underlying data transmission. When ALL the four threads finished,  another round of 4 underlying data transmissions will be started using the four threads again.   The form UI need to be responsive all the time.  My problem is: how can I control the running of the 4 threads? like: how do I know that all threads are finished?  using a volatile global counter ?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","winforms","datagridview","custom-controls"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13198573,"title":"Custom DataGridView control with popout editor","body":"<p>I've implemented custom <code>DataGridViewColumn</code>, <code>DataGridViewCell</code>, and <code>DataGridViewEditingControl</code> classes as demonstrated in an <a href=\"http://msdn.microsoft.com/en-us/library/7tas5c80%28v=vs.90%29.aspx#Y0\" rel=\"nofollow\">MSDN Sample</a>.</p>\n\n<p>The problem I have is that while the <code>DateTimePicker</code> in the MSDN example is able to pop it's calendar picker out and have it appear over top of the rows below, and cells adjacent to, it; my control is trapped within the space defined by the size of the DGV cell.  My control consists of a textbox and a list of auto-complete suggestions; so I need a way to get the list to appear without making the row several times as tall as normal.</p>\n\n<p>Since I took the example from MSDN and only changed to to the extend of swapping out <code>DateTimePicker</code> for <code>MyControl</code> and other related changes I assume the magic is happening in the base <code>DateTimePicker</code> class; but don't know what I need to change in my control to have it behave the same way.</p>\n"},{"tags":["c#","mysql","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13200691,"title":"dgv does not exist in the current context","body":"<pre><code>    public partial class Form7 : Form\n{\n    private MySqlDataAdapter da;\n    private MySqlConnection conn;\n    BindingSource bsource = new BindingSource();\n    DataSet ds = null;\n    string sql;\n\n\n    public Form7()\n    {\n        InitializeComponent();\n    }\n\n    private void LoadData()\n    {\n        string connectionString = \"Data Source=localhost;database=d1; uid=root; password=123;port=3307;\";\n        conn = new MySqlConnection(connectionString);\n        sql = \"SELECT Name, Address, id, Status FROM t1\";\n\n        da = new MySqlDataAdapter(sql, conn);\n        conn.Open();\n        ds = new DataSet();\n        MySqlCommandBuilder commandBuilder = new MySqlCommandBuilder(da);\n        da.Fill(ds, \"Orders\");\n        bsource.DataSource = ds.Tables[\"Orders\"];\n        dgv.DataSource = bsource;\n    }\n</code></pre>\n\n<p>It is giving me an error call \"dgv does not exist in the current context\" what can i do for that??? Am I use any packages or something??? please help me to sort out my problem...</p>\n"},{"tags":["c#","winforms","drawing"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":31,"score":-2,"question_id":13200055,"title":"Any idea how to group shapes into one and respectively - ungoup?","body":"<p>I`m trying to develop a paint-like app, which can draw Rectangle, Ellipse and so on. But i need to group this individual shapes into composite shapes and manipulate with them - for example set color, rotate, translete.</p>\n\n<p>I managed to get Translations, coloring, rotating ext. to single shapes, but i need to combine them into composite shapes and manipulate with them too.</p>\n\n<p>For example: I add theese two</p>\n\n<pre><code>public void AddRandomRectangle()\n    {\n        Random rnd = new Random();\n        int x = rnd.Next(100, 1000);\n        int y = rnd.Next(100, 600);\n\n        RectangleShape rect = new RectangleShape(new Rectangle(x, y, 100, 200));\n        rect.FillColor = Color.White;\n\n        ShapeList.Add(rect);\n    }\n\n    /// &lt;summary&gt;\n    /// Add new shape - ellipse.\n    /// &lt;/summary&gt;\n    public void AddRandomEllipse()\n    {\n        Random rnd = new Random();\n        int x = rnd.Next(100, 1000);\n        int y = rnd.Next(100, 600);\n\n        EllipseShape ellipse = new EllipseShape(new Rectangle(x, y, 100, 200));\n        ellipse.FillColor = Color.White;\n\n        ShapeList.Add(ellipse);\n    }\n</code></pre>\n\n<p>How can i combine them to one composite shape?</p>\n"},{"tags":["winforms","infragistics","ultragrid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13199654,"title":"Setting the background for cells with errors on selected row in Infragistics UltraGrid","body":"<p>I am working in WinForms with Infragistic's UltraGrid control. I want to make it so that my activated row shows cell's which have errors using a different background color than the rest of the row. </p>\n\n<p>Currently, if the row is not activated, I see the errored cells with a red background, and the validated cells having a white background. However, when I select the row and it is activated, I cannot see which cells have errors any longer as the whole row has it's background set to yellow.</p>\n\n<p>What I want to see is, that if the row is activated, all valid cells are yellow, and all invalid cells are red. If there are no invalid cells, then all cells are yellow.</p>\n\n<p>Currently, I am de-activating the row if it is found to have an error. This works as long as the user doesn't click on the row again, which is a pretty lame assumption. I've looked into DisplayLayout.Override, which allows me to override at grid, band, row, column, and cell level, but when I override at the cell level it seems that the settings at the row level are still taking precedence.</p>\n"},{"tags":["c#","winforms","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13199791,"title":"Multiple fields from LINQ to Text Box","body":"<p>how can I pass value from selected field (LINQ) to textbox in winforms?</p>\n\n<p>If single fields, I just do like this</p>\n\n<pre><code>   var result = from row in dtValueBranch.AsEnumerable()\n                         where row.Field&lt;int&gt;(\"branchID\") == idBranch\n                         select row.Field&lt;string&gt;(\"branchName\");\n\n        StringBuilder sb = new StringBuilder();\n\n        foreach (string s in result)\n        {\n            sb.Append(s + Environment.NewLine);\n        }\n\n        tbBranch.Text = sb.ToString();\n</code></pre>\n\n<p>So this is the code LINQ to many fields</p>\n\n<pre><code>    var result = from row in dtValueBranch.AsEnumerable()\n                 where row.Field&lt;int&gt;(\"branchID\") == idBranch\n                 select new\n                 {\n                      BranchName = row[\"branchName\"].ToString(),\n                      branchTel = row[\"branchTel1\"].ToString(),\n                      // And many more fields\n\n                 };\n</code></pre>\n\n<p>How can I to implement each fields to each textbox?</p>\n"},{"tags":["winforms","linq-to-sql","data-binding"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13199643,"title":"How to bind combination of db fields to single property (C#, WinForms, LINQ to SQL)?","body":"<p>I want to bind single control attribute (TextBox.Text) to combination of database fields using Linq to SQL (in C#/WinForms project).</p>\n\n<p>For example:</p>\n\n<p>1) I have a table Customer with columns CustomerName, CustomerCity and IsBigCustomer (boolean)</p>\n\n<p>2) On a WinForm I have a TextBox \"cInfo\" and a ListBox \"cList\"</p>\n\n<p>3) I have binded \"cList\" to CustomerName column (when I change item in cList, I need the appropriate Customer data presented in cInfo.Text)</p>\n\n<p>4) I want to bind \"cInfo\" TextBox.Text property to combination of database columns - for example i would like to show:</p>\n\n<p>a) \"!\"+CustomerName+\": \"+CustomerCity (if Customer's IsBigCustomer=true) </p>\n\n<p>b) CustomerName+\": \"+CustomerCity (if Customer's IsBigClient=false) </p>\n\n<p>And when a user changes cInfo.Text I need it to be validated and changes sent back to database (if validation is successful)</p>\n\n<pre><code>Sample data:\n{IBM, New York, true} =&gt; cInfo.Text should be \"!IBM: New York\"\n(SmallCustomer, Paris, false) =&gt; cInfo.Text should be \"SmallCustomer: Paris\"\n</code></pre>\n\n<p>How can I accomplish this task?</p>\n\n<p>(The question is not about usefulness of such an aproach, but to understand if it is possible to bind more than one db field to one property and how to do it)</p>\n"},{"tags":["c#","winforms","printing","landscape-portrait"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13197606,"title":"Setting Printer Preference - Page Orientation to Landscape","body":"<p>I would like to set the Page orientation to LandScape for printing excel worksheet from my excel Vsto project. Manually page orientation is set from the <strong>Printer Preference</strong> window which is popped up from 'Print' form. </p>\n\n<p>I need some automation which will set the orientation to LandScape every time user gives print command.</p>\n\n<p><img src=\"http://i.stack.imgur.com/01uUJ.png\" alt=\"enter image description here\"></p>\n\n<p>I have noticed that if i set the orientation to <strong>LandScape</strong> from my excel application, it stays same for if i want to give a print from a MS-word application &amp; vice versa. So there has to be some kind of flag which can be changed from any simple winform application.</p>\n\n<p>Is there any way i could manipulate the properties ?</p>\n"},{"tags":["c#","winforms","tooltip"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1052,"score":1,"question_id":2512781,"title":"winforms big paragraph tooltip","body":"<p>I'm trying to display a paragraph in a tooltip when I hover a certain picture box. The problem is, the tooltip takes that paragraph, and spans it on one line, all across my screen. How can I make it so that it takes a smaller, more readable area?\nor, maybe you have another technique to achieve the same thing, but without the tooltip function?</p>\n"},{"tags":["c#",".net","winforms","datagridview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13194732,"title":"How to bind properly array to datagridview?","body":"<p>There are a Dependency class with some properties</p>\n\n<pre><code>class Dependency:\n{\n     public string ArtifactId { get; set; }\n     public string GroupId { get; set; }\n     public string Version { get; set; }\n\n     public Dependency() {}\n}\n</code></pre>\n\n<p>and ProjectView class:</p>\n\n<pre><code> class ProjectView:\n {\n     public string Dependency[] { get; set; }\n        ...\n }\n</code></pre>\n\n<p>I want to bind array of Dependencies from ProjectView class to DataGridView.</p>\n\n<pre><code> class Editor\n {\n     private readonly ProjectView _currentProjectView;\n\n     ... //I skipped constructor and other methods  \n\n     private void PopulateTabs()\n     {\n        BindingSource source = new BindingSource {DataSource = _currentProjectView.Dependencies, AllowNew = true};\n        dataGridViewDependencies.DataSource = source;\n     } \n  }\n</code></pre>\n\n<p>But when I'm binding like that, then exception occurs (AllowNew can only be set to true on an IBindingList or on a read-write list with a default public constructor.), because _currentProjectView.Dependencies is array, and it can't be able to add new items.\nThere is solution is convert to list, but it is not convenient, because it's just copy and lost reference to origin array. Is there solution of this problem? How to bind properly array to datagridview?\nThanks.</p>\n"},{"tags":["c#","winforms","listview"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13180090,"title":"How do I tell when RetrieveVirtualItem is finished on a VirtuaListView?","body":"<p>Ok so I need to find out when the RetrieveVirtualItem event is done calling all items on the ListView. The reason that I am trying to do this is because when a user adds a new item to the ListView it needs to Refresh the list and then Select the item. </p>\n\n<p>With normal WinForms I had no problems with implementing this. However with a virtual list I can't figure out when the RetrieveVirtualItem is done. If I need to roll my own ListView thats fine I just need some direction here. </p>\n\n<p><strong>EDIT 1</strong></p>\n\n<p>When a user clicks an item in a listview it sets that item to selected, you can do the same thing in code.</p>\n\n<pre><code>item.Selected = true;\n</code></pre>\n\n<p>This triggers a SelectedIndexChanged event. In that event I load content from said item. If I am in virtual mode and I make an update to an item. I can't set the item as .Selected = true until the list is done updating to then throw said event.</p>\n\n<p><strong>EDIT 2</strong></p>\n\n<p>I guess I am trying to retain my functionality that I have in this control as opposed to restructuring the whole way it works. The functionality being, when a user adds a new item to the list, it adds the item to the top of the list, sets it to selected, and then allows the user to input the information to the right. Instead of using a dialog.</p>\n\n<p><strong>EDIT 3</strong></p>\n\n<p>Just so that my question is more clear. Setting the item to .Selected before the RetrieveVirtualItem event is thrown does not keep the item selected after the refresh.</p>\n"},{"tags":["c#","winforms","multithreading"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13189926,"title":"Close loading form when all threads are complete","body":"<p>I want to know when all my async threads have completed so I know when to close my loading form.  My code never closes the loading form.  I don't know why.  I'm unsure how to correctly pass my ManualResetEvent object to the async thread too.</p>\n\n<p>I'm also open to a simpler means to achieve my goal of knowing when to close the loading form.</p>\n\n<p><strong>UPDATE</strong><br /></p>\n\n<p>After reading the advice here I've updated my class.  Unfortunetly, it still does not work.  I feel closer though.  It's just that the callback never fires.</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Windows.Forms;\nusing System.Threading.Tasks;\nusing System.Threading;\n\nnamespace BrianTests\n{\n\n    public class TaskInfo\n    {\n        public RegisteredWaitHandle Handle;\n        public string OtherInfo = \"default\";\n        public Form loading;\n    }\n\n\n    public partial class AsyncControlCreateTest : Form\n    {\n        //List&lt;ManualResetEvent&gt; MREs = new List&lt;ManualResetEvent&gt;();\n        Form loading = new Form() { Text = \"Loading...\", Width = 100, Height = 100 };\n        CountdownWaitHandle cdwh;\n\n        public AsyncControlCreateTest()\n        {\n            InitializeComponent();       \n        }\n\n        private void AsyncControlCreateTest_Load(object sender, EventArgs e)\n        {            \n            loading.Show(this);//I want to close when all the async threads have completed\n            CreateControls();\n        }  \n\n        private void CreateControls()\n        {\n            int startPoint= 0;\n            int threadCount = 2;\n            cdwh = new CountdownWaitHandle(threadCount);\n\n            for (int i = 0; i &lt; threadCount; i++)\n            {\n                ManualResetEvent mre = new ManualResetEvent(initialState: true);                \n                UserControl control = new UserControl() { Text = i.ToString() };                \n                control.Load += new EventHandler(control_Load);\n                Controls.Add(control);\n                control.Top = startPoint;\n                startPoint += control.Height;\n                //MREs.Add(mre);\n                //mre.Set();//just set here for testing\n            }\n            Task.Factory.StartNew(new Action(() =&gt; \n                {   \n            TaskInfo info = new TaskInfo();\n            info.loading = loading;\n            try\n            {\n                info.Handle = ThreadPool.RegisterWaitForSingleObject(cdwh, WaitProc, info, 4000, executeOnlyOnce: false);\n            }\n            catch (Exception ex)\n            {\n                MessageBox.Show(ex.Message);\n            }\n                })); \n        }\n\n        public static void WaitProc(object state, bool timedOut)\n        {//this callback never occurs...\n            TaskInfo ti = (TaskInfo)state;\n\n            string cause = \"TIMED OUT\";\n            if (!timedOut)\n            {\n                cause = \"SIGNALED\";\n                // If the callback method executes because the WaitHandle is \n                // signaled, stop future execution of the callback method \n                // by unregistering the WaitHandle. \n                if (ti.Handle != null)\n                    ti.Handle.Unregister(null);\n            }\n\n            Console.WriteLine(\"WaitProc( {0} ) executes on thread {1}; cause = {2}.\",\n                ti.OtherInfo,\n                Thread.CurrentThread.GetHashCode().ToString(),\n                cause\n            );\n            ti.loading.Close();\n        }\n\n\n        void control_Load(object sender, EventArgs e)\n        {\n            RichTextBox newRichTextBox = new RichTextBox();\n            UserControl control = sender as UserControl;\n            control.Controls.Add(newRichTextBox);            \n\n            Task.Factory.StartNew(new Action(() =&gt; \n                {                    \n                   Thread.Sleep(2000);\n                   newRichTextBox.Invoke(new Action(() =&gt; newRichTextBox.Text = \"loaded\"));\n                   cdwh.Signal();\n                })); \n        }      \n    }\n\n    public class CountdownWaitHandle : WaitHandle\n    {\n        private int m_Count = 0;\n        private ManualResetEvent m_Event = new ManualResetEvent(false);\n\n        public CountdownWaitHandle(int initialCount)\n        {\n            m_Count = initialCount;\n        }\n\n        public void AddCount()\n        {\n            Interlocked.Increment(ref m_Count);\n        }\n\n        public void Signal()\n        {\n            if (Interlocked.Decrement(ref m_Count) == 0)\n            {\n                m_Event.Set();\n            }\n        }\n\n        public override bool WaitOne()\n        {\n            return m_Event.WaitOne();\n        }\n    }\n}\n</code></pre>\n"},{"tags":[".net","winforms","idisposable","generatedcode"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":446,"score":1,"question_id":450596,"title":"IDisposable Winform","body":"<p>What is the best practice for implementing IDisposable on a Winform?</p>\n\n<ul>\n<li>I have a dialog which extends System.Windows.Forms.Form</li>\n<li>The generated designer.cs already contains an implementation of the virtual Dispose(bool) method</li>\n<li>My form has a field added manually which implements IDisposable</li>\n</ul>\n\n<p>Ideally I would be able to hook into the Dispos(bool) override in the generated code to dispose the manually added IDisposable object. Any recommendations on how to do this properly?</p>\n\n<p>Thanks.</p>\n\n<p>Scott</p>\n"},{"tags":["c#",".net","winforms","visual-studio-2010"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":92,"score":-1,"question_id":13185416,"title":"2 in a row game","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13181258/c-sharp-using-2d-arrays-for-buttons\">c# using 2d arrays for buttons</a>  </p>\n</blockquote>\n\n\n\n<p>I'm working on a game using a 2x2 board that will be extended to a 7x6.</p>\n\n<p>I'm doing the winning detection at the moment, but I think I'm doing it the long way. There must be a much shorter way.</p>\n\n<p>The winn</p>\n\n<ol>\n<li>Horizontally</li>\n<li>Vertically</li>\n<li>Diagonally</li>\n</ol>\n\n<p>Here's a pic of game board:</p>\n\n<p><img src=\"http://i.stack.imgur.com/ZwZYd.jpg\" alt=\"enter image description here\"></p>\n\n<p>This is how I'm currently detecting winner</p>\n\n<pre><code>if (btns[0, col].BackColor.Equals(Color.Red) &amp;&amp; btns[1, col].BackColor.Equals(Color.Red))\n{\n    MessageBox.Show(\"Red Win\");\n}\n\nif (btns[0, col].BackColor.Equals(Color.Blue) &amp;&amp; btns[1, col].BackColor.Equals(Color.Blue))\n{\n    MessageBox.Show(\"Blue Win\");\n}\n</code></pre>\n\n<p>This way seems like I have to list all combinations, and it would not be very ideal when I extend to 7x6.</p>\n\n<p>Here is the whole code of the program</p>\n\n<pre><code>namespace WindowsFormsApplication1\n{\n    public partial class Form1 : Form\n    {\n\n        private Button[,] btns;\n\n        public Form1()\n        {\n            InitializeComponent();\n\n            btns = new Button[,] { { button2 , button1 },\n                                   { button4 , button3 }};\n        }\n\n        private void Form1_Load(object sender, EventArgs e)\n        {\n            foreach (var btn in btns)\n            {\n                btn.Enabled = false;\n            }\n        }\n        int cc = 0;\n\n\n        private void button5_Click(object sender, EventArgs e)\n        {\n          // Button[] row1 = new Button[] {button2, button1};\n\n            for (int col = 0; col &lt; btns.GetLength(1); ++col)\n            {\n                var btn = btns[0, col];\n\n                if (!btn.Enabled)\n                {\n                    btn.Enabled = true;\n\n                    if (cc == 0)\n                    {\n                        cc = 1;\n                        btn.BackColor = Color.Red;\n                    }\n                    else\n                    {\n                        cc = 0;\n                        btn.BackColor = Color.Blue;\n                    }\n\n                    if (btns[0, col].BackColor.Equals(Color.Red) &amp;&amp; btns[1, col].BackColor.Equals(Color.Red))\n                    {\n                        MessageBox.Show(\"Red Win\");\n                    }\n\n                    if (btns[0, col].BackColor.Equals(Color.Blue) &amp;&amp; btns[1, col].BackColor.Equals(Color.Blue))\n                    {\n                        MessageBox.Show(\"Blue Win\");\n                    }\n\n                    return;\n                }\n            }\n        }\n\n\n        private void button6_Click(object sender, EventArgs e)\n        {\n           // Button[] row2 = new Button[] { button4, button3 };\n            for (int col = 0; col &lt; btns.GetLength(1); ++col)\n            {\n                var btn = btns[1, col];\n\n                if (!btn.Enabled)\n                {\n                    btn.Enabled = true;\n\n                    if (cc == 0)\n                    {\n                        cc = 1;\n                        btn.BackColor = Color.Red;\n                    }\n                    else\n                    {\n                        cc = 0;\n                        btn.BackColor = Color.Blue;\n                    }\n\n                    if (btns[1, col].BackColor.Equals(Color.Red) &amp;&amp; btns[0, col].BackColor.Equals(Color.Red))\n                    {\n                        MessageBox.Show(\"Red Win\");\n                    }\n\n                    if (btns[1, col].BackColor.Equals(Color.Blue) &amp;&amp; btns[0, col].BackColor.Equals(Color.Blue))\n                    {\n                        MessageBox.Show(\"Blue Win\");\n                    }\n                    return;\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>I have tried a lot of other ways but I can't seem to get it working.</p>\n"},{"tags":["c#","winforms","textbox"],"answer_count":6,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":4469,"score":4,"question_id":8321871,"title":"How To Make A TextBox Accept Only Alphabets?","body":"<p>I am Working On a winform...In That i got A textBox Which must not Accept either numeric Values or even special Characters...In Short It mUst Accept Only Alphabets...\nHow Can I do It? Is There any special Property For Doing The same\nPlease explain With An Example..</p>\n"},{"tags":["c#","sql","winforms","dataset"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":53,"score":0,"question_id":13193827,"title":"how to add dataset values to sql","body":"<p>I am new to SQL (started today itself), how to add data of dataset to the database table when the table in database has the first column as automatic generating numbers i.e., (IDENTITY (1,1))</p>\n\n<p>I have DataSet something like this</p>\n\n<pre><code>  name    age    location\n\n   x      30       yyy\n   y      20       ppp\n</code></pre>\n\n<p>The table in Database is something like this</p>\n\n<pre><code>  Id(auto)   name    age    location\n\n  --------  no data  --------------\n</code></pre>\n\n<p>First of all I am filling the Dataset from the database table.<br>\nSince the first column is autogenerated I cant even add new values to DataSet.\nIf I say </p>\n\n<pre><code> dsMainDoctors.Tables[0].Rows.Add( /* first column is autogenerated so I am leaving it*/\n                secondColumn,\n                thirdColumn,\n                fourthColumn,\n                FifthColumn);\n</code></pre>\n\n<p>Error --> Input string was not in a correct format.Couldn't store  in Doctor_ID Column.  Expected type is Int32.</p>\n\n<p>The code I am trying is: (<em>When I given the first column value manually in the DataSet</em>)</p>\n\n<pre><code>        SqlConnection conn = new SqlConnection(strConn);\n        SqlCommand cmd = new SqlCommand(strQuery, conn);\n        SqlDataAdapter da = new SqlDataAdapter(cmd);\n        conn.Open();\n        da.Update(ds.Tables[0]);  //ERROR :- Update requires a valid InsertCommand when passed DataRow collection with new rows.\n        conn.Close();\n        conn.Dispose();\n        cmd.Dispose();\n</code></pre>\n\n<hr>\n\n<pre><code> strQuery --&gt; \"delete from [dbo].[\" + table_name + \"]\";\n</code></pre>\n\n<p>I could have searched this before asking but I dont know what keywords I should use<br>\nPlease answer in comments if it is very easy question.</p>\n"},{"tags":["c#","winforms","localization","resources","multilanguage"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13193216,"title":"Cannot resolve resource Item winform resource file","body":"<p>This is the code for multilanguage:</p>\n\n<pre><code>    using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Reflection;\nusing System.Resources;\nusing System.Text;\nusing System.Threading;\nusing System.Windows.Forms;\n\nnamespace WindowsFormsMultiLanguage\n{\n    public partial class Form1 : Form\n    {\n        ResourceManager m_resourceManger;\n        public Form1()\n        {\n            InitializeComponent();\n\n            m_resourceManger = new ResourceManager(\"WindowsFormsMultiLanguage.Localization\", Assembly.GetExecutingAssembly());\n            // Init UICulture to CurrentCulture\n            Thread.CurrentThread.CurrentUICulture = Thread.CurrentThread.CurrentCulture;\n            // Init Controls\n            UpdateUIControls();\n        }\n\n\n\n        private void UpdateUIControls()\n        {\n            try\n            {\n                if (m_resourceManger != null)\n                {\n\n                    this.label1.Text = m_resourceManger.GetString(\"test1\");\n                    this.label2.Text = m_resourceManger.GetString(\"test2\");\n                }\n            }\n            catch (System.Exception e)\n            {\n                MessageBox.Show(e.Message);\n            }\n        }\n        private void OnLanguageChange(object sender, EventArgs e)\n        {\n            RadioButton radioButton = sender as RadioButton;\n            string culture = string.Empty;\n\n            switch (radioButton.Text)\n            {\n\n                case \"French - France (fr-FR)\":\n                    culture = \"fr-FR\";\n                    break;\n\n                case \"U.S. English (en-US)\":\n                    culture = \"en-US\";\n                    break;\n\n            }\n\n            // This is used for the language of the user interface\n            Thread.CurrentThread.CurrentUICulture = new System.Globalization.CultureInfo(culture);\n\n            Thread.CurrentThread.CurrentCulture = new System.Globalization.CultureInfo(culture);\n        }\n\n    }\n\n\n}\n</code></pre>\n\n<p>I'm getting a error message, cannot resolve resource item test&amp;, test2 at this point:\n<code>this.label1.Text = m_resourceManger.GetString(\"test1\");\nthis.label2.Text = m_resourceManger.GetString(\"test2\");</code></p>\n\n<p>I have added 2 reource files 1 for english and 2nd for french, I don't know what is the mistake.. </p>\n\n<p><img src=\"http://i.stack.imgur.com/mXB55.jpg\" alt=\"enter image description here\">\n<img src=\"http://i.stack.imgur.com/tnqWz.jpg\" alt=\"enter image description here\"></p>\n\n<p>I'm sharing this project on SkyDrive: <a href=\"https://skydrive.live.com/redir?resid=8FE34CB77340CAA9!150\" rel=\"nofollow\">https://skydrive.live.com/redir?resid=8FE34CB77340CAA9!150</a>  Please help me.</p>\n"},{"tags":["c#","winforms","settings"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":13193986,"title":"Best Settings Method to use for WinForms Plugin","body":"<p>All, I have a large C# application that I am writing a plugin for. I want to provide settings for this plugin and came to the conclusion that writing my own setting manager ect. and creating XML settings which would be put in the relevant special folders is the best way to go. However, I can't remember why (after coming back to project) I came to that conclusion over using the <code>Properties.Settings.MySetting</code> route. Can someone offer any advice in terms of what method is more preferable in my case? </p>\n\n<p>Is writing my own overkill here, or is there a clear and obvious benefit?</p>\n\n<p>I aplogise if I have asked this on the wrong Stack site.</p>\n\n<p>Thanks very much for your time. </p>\n"},{"tags":["c#",".net","winforms","webbrowser-control"],"answer_count":4,"favorite_count":2,"up_vote_count":12,"down_vote_count":0,"view_count":9517,"score":12,"question_id":2476360,"title":"Disable JavaScript error in WebBrowser control","body":"<p>I am developing a windows application with a WebBrowser control that navigates to a sharepoint site.<br>\nMy problem is that i am getting JavaScript error.</p>\n\n<p>How can i disable the JavaScript error? I don't want them to pop up.</p>\n"},{"tags":["c#","winforms","listview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13192181,"title":"imagelist set imagesize doesn't resize subsequently added images","body":"<p>In a function to resize the displayed images in <code>CurrentImages</code>, the images, all of a sudden and only in this production version, not in a previous test version, don't seem to scale. </p>\n\n<p>Instead they are clipped.</p>\n\n<pre><code>private void ResizeCurrentImages(double zoom)\n{\n    foreach (Image image in this.CurrentImages.Images)\n    {\n        image.Dispose();\n    }\n\n    this.CurrentImages.Images.Clear();\n    this.CurrentImages.ImageSize = new Size((int)Math.Floor(this.MAX_WIDTH * zoom), (int)Math.Floor(this.MAX_HEIGHT * zoom));    \n\n    foreach (Image image in this.OriginalImages.Images)\n    {\n        this.CurrentImages.Images.Add(image);\n    }\n}\n</code></pre>\n\n<p>where <code>MAX_WIDTH = 161</code> and <code>MAX_HEIGHT = 256</code>.</p>\n\n<p>According to MSDN documentation, I'm following the right steps, first setting the new imagesize, and then adding the images.</p>\n\n<p>Has anyone else had this problem before?</p>\n"},{"tags":[".net","vb.net","winforms"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13186753,"title":"Vb.net get integers only from string with integers","body":"<p>i have this string  <code>123abc123</code> how can i get only integers from this string?<br>\nconvert <code>123abc123</code> to <code>123123</code>.</p>\n\n<p>what i tried:</p>\n\n<pre><code>integer.prase(abc)\n</code></pre>\n"},{"tags":["c#","winforms","notifyicon"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1927,"score":1,"question_id":842494,"title":"NotifyIcon not showing","body":"<p>I am writing a simple application that I would like to control with a notifyIcon rather than a form, I have follwed examples I found through Google, but my notifyIcon will not show up.  What am I doing wrong?</p>\n\n<pre><code>\n    static class MainEntryClass\n    {\n        /// \n        /// The main entry point for the application.\n        /// \n        [STAThread]\n        static void Main()\n        {\n            Application.EnableVisualStyles();\n            Application.SetCompatibleTextRenderingDefault(false);\n            C2F TestApp = new C2F();\n            Application.Run();\n            TestApp.Dispose();\n        }\n    }\n\n    class C2F \n    {\n        public C2F()\n        {\n            InitializeComponent();\n            loadSettings();\n        }\n\n        private void InitializeComponent()\n        {\n            this.components = new System.ComponentModel.Container();\n            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(C2F));\n            this.niC2F = new System.Windows.Forms.NotifyIcon(this.components);\n            this.contextMenuStrip1 = new System.Windows.Forms.ContextMenuStrip(this.components);\n            this.settingsToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();\n            this.separatorToolStripMenuItem = new System.Windows.Forms.ToolStripSeparator();\n            this.exitToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();\n            this.contextMenuStrip1.SuspendLayout();\n            // \n            // niC2F\n            //\n            this.niC2F.BalloonTipText = \"MyApp\";\n            this.niC2F.Icon = ((System.Drawing.Icon)(Clipboard2File.Properties.Resources.ResourceManager.GetObject(\"MyIcon.ico\")));\n            this.niC2F.Text = \"MyApp\";\n            this.niC2F.ContextMenuStrip = this.contextMenuStrip1;\n            this.niC2F.ShowBalloonTip(5);\n            this.niC2F.Visible = true;\n            this.niC2F.MouseClick += new System.Windows.Forms.MouseEventHandler(this.niC2F_MouseClick);\n            // \n            // contextMenuStrip1\n            // \n            this.contextMenuStrip1.Items.AddRange(new System.Windows.Forms.ToolStripItem[] {\n            this.settingsToolStripMenuItem,\n            this.separatorToolStripMenuItem,\n            this.exitToolStripMenuItem});\n            this.contextMenuStrip1.Name = \"contextMenuStrip1\";\n            this.contextMenuStrip1.Size = new System.Drawing.Size(153, 76);\n            // \n            // settingsToolStripMenuItem\n            // \n            this.settingsToolStripMenuItem.Name = \"settingsToolStripMenuItem\";\n            this.settingsToolStripMenuItem.Size = new System.Drawing.Size(152, 22);\n            this.settingsToolStripMenuItem.Text = \"Settings\";\n            this.settingsToolStripMenuItem.Click += new System.EventHandler(this.settingsToolStripMenuItem_Click);\n            // \n            // separatorToolStripMenuItem\n            // \n            this.separatorToolStripMenuItem.Name = \"separatorToolStripMenuItem\";\n            this.separatorToolStripMenuItem.Size = new System.Drawing.Size(149, 6);\n            this.separatorToolStripMenuItem.Click += new System.EventHandler(this.exitToolStripMenuItem_Click);\n            // \n            // exitToolStripMenuItem1\n            // \n            this.exitToolStripMenuItem.Name = \"exitToolStripMenuItem1\";\n            this.exitToolStripMenuItem.Size = new System.Drawing.Size(152, 22);\n            this.exitToolStripMenuItem.Text = \"Exit\";\n        }\n\n        private System.ComponentModel.IContainer components = null;\n        private Form1 frmSettings = new Form1();\n        private Settings C2FSettings = new Settings();\n        private System.Windows.Forms.NotifyIcon niC2F;\n        private System.Windows.Forms.ContextMenuStrip contextMenuStrip1;\n        private System.Windows.Forms.ToolStripMenuItem settingsToolStripMenuItem;\n        private System.Windows.Forms.ToolStripSeparator separatorToolStripMenuItem;\n        private System.Windows.Forms.ToolStripMenuItem exitToolStripMenuItem;\n     }\n</code></pre>\n"},{"tags":["c#","winforms","printing"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":667,"score":0,"question_id":4464261,"title":"How to print files stored at your local hard drive in C#?","body":"<p>I have a function created in C# (WinForms) which saves the file as gif image in local directory. How can I access it and send it to printing to one of my network printers? </p>\n\n<p>I have this code here right now:</p>\n\n<pre><code>internal void PrintLabels(string printerInfo, List&lt;string&gt; shippingLabels)\n{\n    //this is where I print to printer...\n    foreach (string labelPath in shippingLabels)\n    {\n\n    }\n\n}\n</code></pre>\n\n<p>Any help?</p>\n"},{"tags":[".net","winforms","visual-studio","clickonce","full-trust"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13191984,"title":"Error starting Click-Once app. Application cannot be started. Contact the vendor","body":"<p>We are having a weird problem with on of our customer's clickonce installation. This is a full trust winforms application.</p>\n\n<p>Our application installs correctly on the Windows 7 computer and the user can use it. After a day or a few hours of use, the application exe goes missing from the clickonce deployment directory along with a few DLLs as well. </p>\n\n<p>The user can no longer run the application using the Desktop shortcut and he gets the \"Error starting Click-Once app. Application cannot be started. Contact the vendor.\"</p>\n\n<p>We tried uninstalling and reinstalling the application multiple times by clearing the Apps\\2.0 clickonce cache. However, everytime we have the same issue. </p>\n\n<p>We also tried creating a new user on the same machine and installing the software under the new user. However, the new user has the same problem as well.</p>\n\n<p>We suspected virus activity. Unfortunately, the Virus guard does not mention any suspicious activity. A scan from another virus guard showed no threats. </p>\n\n<p>Any clues as to what might be causing this behavior. The running exe just disappears from the install location. </p>\n\n<p>The application runs fine elsewhere, on other computers. </p>\n\n<p>Thank you,\nManish.</p>\n"},{"tags":["c#",".net","winforms","devexpress"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13192080,"title":"Devexpress ListBoxControl Add Item with multiple Colors","body":"<p>I am looking for a solution to add an <code>Item</code> in a <code>ListBoxControl</code> with different colors in the same <code>Row</code><br>\nex: 'imported company [ XCompany ]' - i need 'imported company' with a gray color and the rest with black<br>\nalso i need in case I have errors (Red)</p>\n\n<p>I can't find (if exists) the method to add an <code>Html</code> text </p>\n\n<p>Thanks</p>\n"},{"tags":["c#","sql-server","winforms","math","expressions"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":87,"score":0,"question_id":12278418,"title":"How to store and retrieve mathematical expressions to/from SQL Server database?","body":"<p>How to store and retrieve mathematical expressions from SQL Server database? I am copying these formulas from ms word and using rich textbox in winforms in c# code to store it from where I want to push those in SQL Server database and pull it back to show in ASP.NET web application. Any thoughts???</p>\n"},{"tags":["c#",".net","winforms","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":70,"score":1,"question_id":13190590,"title":"Add link labels to DataGridView","body":"<p>In my project, I'm filling the <code>dataGridView</code> from <code>dataSet</code> (binding the <code>DataGridView</code> to <code>DataSet</code>). The first column in <code>dataGridView</code> must be <code>LinkLabels</code> which I'm trying to get in the below code.</p>\n\n<pre><code>dgvMain.DataSorce = ds.Tables[0];\n</code></pre>\n\n<p>I tried: (<em>not working</em>)  </p>\n\n<pre><code>DataGridViewLinkCell lnkCell = new DataGridViewLinkCell();\nforeach (DataGridViewRow row in dgvMain.Rows)\n{\n    row.Cells[0] = lnkCell; // (ERROR) Cell provided already belongs to a grid. This operation is not valid.\n}\n</code></pre>\n\n<p><strong>also tried</strong></p>\n\n<pre><code>for (int intCount = 0; intCount &lt; dgvMain.Rows.Count; intCount++)\n{\n    dgvMain.Rows[intCount].Cells[0] = lnkCell; // (ERROR) Cell provided already belongs to a grid. This operation is not valid.\n}\n</code></pre>\n\n<p>The above attempts are adding <code>linkLabel</code> to the first cell only not all the cells in that column<br>When I debugged my code, I concluded that after adding the <code>linkLabel</code> to the first cell exception error is coming which I mentioned in the above code, which is making the code not to run properly.</p>\n\n<p>Please give me any suggestions, what should I do?</p>\n"},{"tags":["c#","winforms","soap","wsdl"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":29,"score":0,"question_id":13192812,"title":"Winforms form generator using Wsdl","body":"<p>Does anyone know of any projects that will auto generate an input form for a SOAP web service ?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13191396,"title":"Where should I put the code to resize/reposition controls on a form in C#?","body":"<p>I'm using Windows Forms and I'd like to write some code to change the layout of each of the controls on the form whenever anything gets scrolled or resized.  I assume there must be a standard way of doing this before a form paint is done.</p>\n\n<p><strong>EDIT:</strong> There is a DataGridView on the form.  I want to change the layout whenever a column width is changed or the horizontal scroll bar is moved.  </p>\n"},{"tags":["c#","winforms","clock"],"answer_count":4,"favorite_count":5,"up_vote_count":15,"down_vote_count":0,"view_count":9340,"score":15,"question_id":1297109,"title":"How do I generate an alert at a specific time in C#?","body":"<p>How can i generate an event at a specific time? For example, say I want to generate an alert at 8:00 AM that informs me its 8:00 AM (or an event that informs me of the current time at any given time). </p>\n"},{"tags":["c#","winforms","visual-studio-2010","combobox","datatable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13190926,"title":"How to check desired ValueMember in my ComboBox?","body":"<p>I am new to C#. I have one <code>Combo Box</code> <code>cmbDoctor</code>. It is binding with <code>DataTable</code></p>\n\n<pre class=\"lang-none prettyprint-override\"><code>display member\n       --&gt; Name\n Value Member\n       --&gt;  ID       Name ,ID are table column Names\n</code></pre>\n\n<p>My problem is that I have added a new tab <code>tabPageUpdate</code>\n<br>When I click <code>Specified ID</code> in <code>tabPageUpdate</code> I want to select <code>Combobox</code> with <code>display Name</code></p>\n\n<p>if anyone knows how to do this, please provide a solution for this.</p>\n"},{"tags":["c#","winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13189846,"title":"Error while playing WindowMediaPlayer in C# winform application in Win server 2008","body":"<p>I have installed a C# application. The project runs well on windows 7, but it fails when I copy to other computer with WINDOWS SERVER 2008. I used try catch in the construction of window form, and this exception has come:</p>\n\n<blockquote>\n  <p>System.Runtime.InteropServices.COMException</p>\n</blockquote>\n\n<p>Have anyone been errored like this? Thank you.</p>\n"},{"tags":[".net","vb.net","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13187791,"title":"Extract / Get windows username","body":"<p>How can i Extract/Get the current username from windows?<br></p>\n\n<p>This is what i tried:</p>\n\n<pre><code>Dim username As String = Application.ExecutablePath.ToString.Split(\"\\\")(0)\nIf username &lt;&gt; \"\" then\nMsgBox(username)\nEnd if\n</code></pre>\n"},{"tags":["winforms","datagridview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13182438,"title":"What event is called when we click on a DataGridViewComboBoxCell","body":"<p>I have a list of item in a DataGridViewComboBoxCell; I want to do something as soon as the user click on a value. </p>\n\n<p>What is the event, or how could I do what I want?</p>\n\n<p>CellValueChanged is called when we leave the cell...</p>\n"},{"tags":["c#","regex","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13186698,"title":"Parsing string with regex","body":"<p>I have a string like this:</p>\n\n<pre><code>Addadafafa/DHello/p2324141142DsddDsdsds/Dgood/p23323\n</code></pre>\n\n<p>For those who didn't notice, the text I want to keep is always between <code>/D</code> and <code>/p</code>.\nI've tried to parse it using regex but I couldn't do it for all the string.\nIt always kept the first or last word.</p>\n\n<p>How can I keep a new string with all of the words between <code>/D</code> and <code>/p</code> from the former string?</p>\n\n<p>Expected output:</p>\n\n<pre><code>hello good\n</code></pre>\n"},{"tags":["winforms","exception","handler","messagebox"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":242,"score":-1,"question_id":9192580,"title":"MessageBox not showing when \"Unhandled Exception\" triggers in winforms","body":"<p>so I was trying to add \"<code>AppDomain.CurrentDomain.UnhandledException</code>\" handler to my application and it worked OK if I log the error to a text file. but when I try to use a MessageBox it never pops. is it another bug in .Net? any ideas?</p>\n\n<p>here is my code sample:</p>\n\n<pre><code>   AppDomain.CurrentDomain.UnhandledException += new UnhandledExceptionEventHandler(CurrentDomain_UnhandledException);\n\n   Application.EnableVisualStyles();\n   Application.SetCompatibleTextRenderingDefault(false);\n   Application.Run(new Form1());\n</code></pre>\n\n<p>and here is my handler method:</p>\n\n<pre><code>static void CurrentDomain_UnhandledException (object sender, UnhandledExceptionEventArgs e)\n{\n    try\n    {\n       Exception ex = (Exception)e.ExceptionObject;\n\n       MessageBox.Show(\"Whoops! Please contact the developers with \"\n                   + \"the following information:\\r\\n\\r\\n\" + ex.Message + ex.StackTrace,\n                   \"Fatal Error\", MessageBoxButtons.OK, MessageBoxIcon.Stop);\n\n    }\n    finally\n    {\n       Application.Exit();\n    }\n}\n</code></pre>\n\n<p><strong>EDIT:</strong> I've tried all of the possible options but I still can't see the MessageBox. Now the problem is when I run it from Visual C# (debug mode) it perfectly shows the box. but when I run the application directly from the debug/release folders it doesn't shows the MessageBox and the Application keeps running like there is no error is happening...</p>\n"},{"tags":["c#","winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13178614,"title":"SourceControl of ContextMenuStrip DropDownItem returns null","body":"<p>I am using a ContextMenuStrip in a WinForm project. I have added two item in it at design time- 1) Add Focus and 2) Remove Focus. In runtime I am adding few dropdown items in \"Add Focus\" item. Problem is, I am getting null when trying to retrieve source control name.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>ToolStripDropDownItem dropDownItem = sender as ToolStripDropDownItem;\nToolStripMenuItem mainItem = dropDownItem.OwnerItem as ToolStripMenuItem;\nContextMenuStrip contextMenuStrip = mainItem.Owner as ContextMenuStrip;\nControl control =contextMenuStrip.SourceControl; //getting null here\n</code></pre>\n\n<p>What is the problem in this code? Am I missing something here ?</p>\n"},{"tags":["c#","winforms","visual-studio-2010"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":51,"score":4,"question_id":13184935,"title":"winforms multiple form layouts","body":"<p>Out of curiousity, is it possible to have 2 application layouts without having to have 2 projects?</p>\n\n<p>Like one layout for desktop/laptops.  And then one layout for tablets?  </p>\n\n<p>I know winforms only has 1 designer file, and that probably answers my question, but I was curious if i really just needed to re-create a whole new program for a tablet layout, even though it would have all the same functionality as the desktop, with all the same controls, just look slightly different.</p>\n"},{"tags":["c#","winforms"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13185670,"title":"Passing a Date Value from one Windows From to Another Form in C#","body":"<p>I am working on a very complex project and I am very very new to the windows Project.<br>\nI have 2 Forms :  </p>\n\n<ul>\n<li><code>ViewSchedule.cs</code>   </li>\n<li><code>Scheduler.cs</code> (it is a Dialog Form)</li>\n</ul>\n\n<p><code>ViewSchedule.cs</code> has two dates to be selected from the Calendar. Two dates are selected. <br>They are saved in Resp:</p>\n\n<pre><code>_fromDate = dtFromDate.DateTime.ToUniversalTime();\n_toDate = dtToDate.DateTime.ToUniversalTime();\n</code></pre>\n\n<p>Form 2 ie <code>Scheduler.cs</code> is a dialogForm. Here the dates selected in <code>ViewScheduler</code> should appear here.</p>\n\n<p>I need help.</p>\n"},{"tags":[".net","vb.net","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13187215,"title":"Draw circle over my form with VB.Net","body":"<p>how can i draw circle all over my form?</p>\n\n<p>what i have tried:</p>\n\n<pre><code>Dim bmp As New Bitmap(Me.Width, Me.Height)\ncWidth = 3\nMe.BackgroundImage = Circle (Me.Width, Me.Height,bmp,cWidth)\n</code></pre>\n"},{"tags":[".net","vb.net","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":32,"score":0,"question_id":13186507,"title":"Vb.net draw horizontal zebra lines","body":"<p>How can i draw horizontal zebra lines all over my form?</p>\n\n<pre><code>1px Black\n1px White\n1px Black\n1px White\n1px Black\n1px White\n1px Black\n1px White\n</code></pre>\n"},{"tags":["c#","winforms","streaming"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13184987,"title":"Updating picturebox causes performance issues","body":"<p>I have an app that contains a picture box which updates images from a live camera every time a new image gets loaded into the camera buffer. My problem is that whenever I'm getting this live feed, the whole app becomes very slow and (sometimes) unresponsive. I have a separate thread which basically does all the imaging steps and then puts the new image in the picture box. I'm kind of stuck on how to fix the issue and I'm wondering if anyone has any ideas? I'm not sure what kind of code you need but here is the <code>ImageUpdated</code> event that gets the image and sticks it on the <code>PictureBox</code>. Thanks for any help!</p>\n\n<pre><code>void CurrentCamera_ImageUpdated(object sender, EventArgs e)\n{\n    try\n    {\n        lock (CurrentCamera.image)\n        {\n            if (CurrentCamera != null &amp;&amp; CurrentCamera.image != null &amp;&amp; !changeCam)\n            {\n                videoImage = CurrentCamera.videoImage;\n                if (CurrentCamera.videoImage != null &amp;&amp; this.IsHandleCreated)\n                {\n                    Bitmap tmp = new Bitmap(CurrentCamera.image.Width, CurrentCamera.image.Height);\n                    //Creates a crosshair on the image\n                    using (Graphics g = Graphics.FromImage(tmp))\n                    {\n                        g.DrawImage(CurrentCamera.image, new Point(0, 0));\n                        g.DrawLine(crosshairPen, new Point(CurrentCamera.image.Width / 2, 0), new Point(CurrentCamera.image.Width / 2, (CurrentCamera.image.Height)));\n                        g.DrawLine(crosshairPen, new Point(0, CurrentCamera.image.Height / 2), new Point((CurrentCamera.image.Width), CurrentCamera.image.Height / 2));\n                        g.DrawEllipse(crosshairPen, (CurrentCamera.image.Width / 2) - crosshairRadius, (CurrentCamera.image.Height / 2) - crosshairRadius, crosshairRadius * 2, crosshairRadius * 2);\n                    }\n                    pictureBox1.BeginInvoke((MethodInvoker)delegate\n                    {\n                        pictureBox1.Image = tmp;\n                    });\n                }\n            }\n        }\n    }\n    catch { }\n}\n</code></pre>\n"},{"tags":["winforms","graphics","region","animatewindow"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13187025,"title":"Why fading a form with non-rectangular region does not work correctly?","body":"<p>I created a top level form and changed its Region property to an eliptical region. Then, I made the form to fade in using the AnimateWindow function. When the form was fading in, the rectangular shape of the form was still displayed. When the form finished fading, the rectangular shape disappeared and was replaced by the eliptical shape. Does anyone encounter the same problem? Below is the code:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Windows.Forms;\nusing System.Runtime.InteropServices;\nusing System.Drawing.Drawing2D;\nusing System.Drawing;\n\nnamespace AnimateWindowSample\n{\n    public class MainForm : Form\n    {\n        private Button button_Show;\n        private ChildForm childForm;\n        private bool childFormShown = false;\n\n        public MainForm()\n        {\n            this.button_Show = new System.Windows.Forms.Button();\n            this.SuspendLayout();\n            // \n            // button_Show\n            // \n            this.button_Show.Location = new System.Drawing.Point(12, 12);\n            this.button_Show.Name = \"button_Show\";\n            this.button_Show.Size = new System.Drawing.Size(105, 23);\n            this.button_Show.TabIndex = 0;\n            this.button_Show.Text = \"&amp;Show/Hide\";\n            this.button_Show.UseVisualStyleBackColor = true;\n            this.button_Show.Click += new EventHandler(button_Show_Click);\n            // \n            // MainForm\n            // \n            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);\n            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;\n            this.ClientSize = new System.Drawing.Size(284, 262);\n            this.Controls.Add(this.button_Show);\n            this.Name = \"MainForm\";\n            this.Text = \"MainForm\";\n            this.ResumeLayout(false);\n        }\n\n        void button_Show_Click(object sender, EventArgs e)\n        {\n            if (this.childForm == null)\n            {\n                this.childForm = new ChildForm();\n            }\n\n            if (this.childFormShown)\n            {\n                this.childForm.FadeOut();\n            }\n            else\n            {\n                this.childForm.FadeIn();\n            }\n\n            this.childFormShown = !this.childFormShown;\n        }\n    }\n\n    public class ChildForm : Form\n    {\n        const int CS_DROPSHADOW = 0x00020000;\n        const int WS_EX_TOPMOST = 0x00000008;\n        const int AW_HIDE = 0x00010000;\n        const int AW_BLEND = 0x00080000;\n\n        [DllImport(\"User32.dll\", CharSet = CharSet.Auto)]\n        static extern bool AnimateWindow(IntPtr hWnd, uint dwTime, uint dwFlags);\n\n        protected override CreateParams CreateParams\n        {\n            get\n            {\n                CreateParams cp = base.CreateParams;\n\n                cp.ClassStyle |= CS_DROPSHADOW;\n                cp.ExStyle |= WS_EX_TOPMOST;\n\n                return cp;\n            }\n        }\n\n        protected override bool ShowWithoutActivation\n        {\n            get\n            {\n                return true;\n            }\n        }\n\n        public ChildForm()\n        {\n            this.FormBorderStyle = FormBorderStyle.None;\n\n            GraphicsPath path = new GraphicsPath();\n\n            path.AddEllipse(this.Bounds);\n\n            Region region = new Region(path);\n\n            this.Region = region;\n        }\n\n        public void FadeIn()\n        {\n            AnimateWindow(this.Handle, 300, AW_BLEND);\n        }\n\n        public void FadeOut()\n        {\n            AnimateWindow(this.Handle, 300, AW_BLEND | AW_HIDE);\n        }\n\n        protected override void OnPaint(PaintEventArgs e)\n        {\n            base.OnPaint(e);\n\n            Rectangle bounds = this.ClientRectangle;\n\n            e.Graphics.FillRectangle(Brushes.Black, bounds);\n            e.Graphics.FillEllipse(Brushes.Blue, bounds);\n        }\n    }\n\n    static class Program\n    {\n        /// &lt;summary&gt;\n        /// The main entry point for the application.\n        /// &lt;/summary&gt;\n        [STAThread]\n        static void Main()\n        {\n            Application.EnableVisualStyles();\n            Application.SetCompatibleTextRenderingDefault(false);\n            Application.Run(new MainForm());\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","winforms","events","mdi","tile"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13180813,"title":"Tile remaining mdi forms after a mdi form is closed","body":"<p>I have an mdi form and I want to tile all of its mdi children after one of the children is closed. I tried setting the child form's closed event to a method that tiles all the windows, but the problem I am having is that it tiles the window that has just been closed as well. I believe this is because the just closed window is still referenced until the end of the the triggered callback. So my question is: Is there a way to have all the remaining mdi children tiled after one of them has been closed?</p>\n"},{"tags":["winforms","delegates","async-await"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13183313,"title":"How to determine if method is async at runtime","body":"<p>I have a legacy project that has hundreds of method signatures for a Winforms event. Obviously the current ones I don't want to go and do BeginInvoke/EndInvoke on because this will cause UI cross threading issues.</p>\n\n<p>However I have need (because of deadlocks) to be able to mark these signatures as async to handle some async commands that we have to be able to do. No other way results in anything other than a deadlock.</p>\n\n<p>I can successfully call the event with BeginInvoke and it works perfectly and asyncs properly etc. However that breaks it out into another thread and breaks the old implementations that we don't want to have to go through and make async and Invoke aware.</p>\n\n<p>So I was investigating using the event.GetInvokationList() and looping through and calling each separately. If the method was async, then begin/end invoke. Otherwise call it straight up on the UI thread.</p>\n\n<p>My only problem is that I can't find any way through reflection to tell if the method signature is async or not. </p>\n\n<p>Anyone know how to figure out if a method is async or not from the MethodInfo or something else from GetInvokationList() values?</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","winforms","web-services","soap","proxy"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13185816,"title":"Bypass Proxy with web service","body":"<p>So I have a web service which I call from a WinForms application.  I also have a setting in the WinForms application which I want to allow you to bypass proxy settings when using this web service.</p>\n\n<p>Even if I set the <code>webService.Proxy = null;</code> it still uses the IE proxy settings because the service times out and fails.  If I remove the proxy setting in IE everything works fine.</p>\n\n<p>I have even tried setting the bypass list property of the proxy object to include the site I am trying to connect to; the Proxy.IsBypassed() returns true, but it still times out and fails.</p>\n\n<p>Why does it seem that this web service will not ignore the Proxy settings?</p>\n\n<p>Below is the code I am using </p>\n\n<pre><code>try\n{\n   webService = new LogService();\n\n   webService.Timeout = 10000; //10 sec\n   webService.Proxy = WebRequest.DefaultWebProxy;\n\n   if( adminSettings != null &amp;&amp; adminSettings.BypassProxyWebService )\n   {\n      //Both setting the Bypass list or just setting the proxy property\n      // to null still causes the web service to use the proxy set in IE\n      Uri proxy = WebRequest.DefaultWebProxy.GetProxy(new Uri( \"http://log.software.com\"));\n      webService.Proxy = new WebProxy( proxy, true,\n                 new string[] { \";*.software.com\" } );\n\n      //this yields the same result\n      //webService.Proxy = null;\n   }\n}\ncatch( Exception ex )\n{\n   System.Diagnostics.Debug.Fail( ex.Message );\n}\n</code></pre>\n\n<p>Any help would be greatly appreciated.</p>\n"},{"tags":["c#","asp.net","winforms",".net-3.5"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13145050,"title":"How to load and pass a model to an ascx control?","body":"<p>I have a nestedGridTemplate which contains one object of a list. </p>\n\n<pre><code>            this.Gridparent.MasterTableView.NestedViewTemplate = new Custom14NestedTemplate(this.model.Material.First());\n</code></pre>\n\n<p>This calls my class <code>public class Custom14Template</code>.</p>\n\n<p>This class calls : </p>\n\n<pre><code>    public void InstantiateIn(System.Web.UI.Control container)\n    {\n        var myPage = new Page();\n        Control c = myPage.LoadControl(\"~/Custom14/Templates/View.ascx\");\n        container.Controls.Add(c);\n\n        var x = new Label();\n        x.Text = string.Format(\"qty : {0}.&lt;br /&gt;\", this.MyMaterial.Quantity);\n        container.Controls.Add(x);\n    }\n</code></pre>\n\n<p>Right now, my ascx contains only this :</p>\n\n<pre><code>&lt;%@ Control Language=\"C#\" AutoEventWireup=\"true\" CodeBehind=\"View.ascx.cs\" Inherits=\"*snip*.Templates.View\" %&gt;\n\nhello there\n</code></pre>\n\n<p>Everything is displayed correctly</p>\n\n<pre>\n  [grid start]\n  [item 1 : expanded]\n     hello there qty : 23.\n  [/item 1]\n  [item 2 /]\n  [item 3 /]\n  [/grid]\n</pre>\n\n<p>I'd like to pass my object to my ASCX, to build my html display from there using... The <em>old</em> equivalent of <code>&lt;%= html.EditorFor() %&gt;</code> (Asp.Net MVC). Instead of creating elements like my label and adding them to the container (building html in c# feels painful). Is that doable? How?</p>\n"},{"tags":["c#",".net","winforms","multithreading","animation"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":86,"score":3,"question_id":13160571,"title":"building smooth animation in C#","body":"<p>First here's the code.</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Windows.Forms;\n\nnamespace winform_project\n{\n  public partial class Form1 : Form\n  {\n    void movement_correct(PictureBox pic, int i)\n    {\n        System.Threading.Thread.Sleep(25);\n        pic.Top += (i - 1);\n        pic.Left += (i + 3);\n    }\n\n    void movement_up(PictureBox pic, int i)\n    {\n        System.Threading.Thread.Sleep(25);\n        pic.Top -= (i - 1);\n        pic.Left -= (i + 3);\n    }\n    public Form1()\n    {\n        InitializeComponent();\n    }\n\n    private void button1_Click(object sender, EventArgs e)\n    {\n        for (int i = 0; i &lt; 5; i++)\n        {\n            movement_correct(pictureBox1, i);\n            movement_correct(pictureBox2, i);\n            movement_correct(pictureBox3, i);\n            movement_correct(pictureBox4, i);\n            movement_correct(pictureBox5, i);\n            movement_correct(pictureBox6, i);\n            movement_correct(pictureBox7, i);\n            movement_correct(pictureBox8, i);\n            movement_correct(pictureBox9, i);\n            movement_correct(pictureBox10, i);\n        }\n\n        for (int i = 0; i &lt; 5; i++)\n        {\n            movement_up(pictureBox1, i);\n            movement_up(pictureBox2, i);\n            movement_up(pictureBox3, i);\n            movement_up(pictureBox4, i);\n            movement_up(pictureBox5, i);\n            movement_up(pictureBox6, i);\n            movement_up(pictureBox7, i);\n            movement_up(pictureBox8, i);\n            movement_up(pictureBox9, i);\n            movement_up(pictureBox10, i);\n        }\n\n    }\n }\n}\n</code></pre>\n\n<p>There are 10 dummy picture boxes. Whenever i click the button they start to move a bit(sort of like the enemies in space invaders).</p>\n\n<p>I am trying to make a smooth animation in winforms. The problem is that the animation in not as smooth as i want it to be. In my code all the boxes aren't moving simultaneously, there is a little bit of noticeable gap in their movement. What i want is smooth movement.</p>\n\n<p>I was thinking of multi threading it but then realized it would mean one thead for each objects. Is there any other way(Within winforms).</p>\n\n<p>Thanks for the help.</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":51,"score":-3,"question_id":13184150,"title":"Get Specific Value","body":"<p>I have a url:</p>\n\n<blockquote>\n  <p>sys.php?x=23&amp;y=20&amp;z=9d939b</p>\n</blockquote>\n\n<p>And I don't really know how to parse the 'z' value from it.</p>\n"},{"tags":["c#","winforms","visual-studio-2010","bindingsource"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13184060,"title":"Reordering bindingSource position after including new item","body":"<p>I have a bindingSource and a bindingNavigator in my Windows Form Application project (C#) that is filled by a SELECT command with ORDER BY clause. But when I insert a new item (Save event) it should reorder the position of nav pos and show the position index based on my ORDER BY clause.</p>\n\n<p>I've tried to execute some built-in methods after Update(), but none of them helped me. They changed nothing.</p>\n\n<pre><code>bindingNavigator.Refresh();\nbindingSource.ResetBindings(true);\nbindingSource.ResetCurrentItem();\n</code></pre>\n\n<p>Also I tried to fill again the TableAdapter:</p>\n\n<p><code>oS_EMAIL_NTableAdapter.Fill(osgtst.OS_EMAIL_N);</code></p>\n\n<p>It reloads the navigator bar with the new inserted item but backs to position 1 and I still don't know where the last inserted item is.</p>\n\n<p>Is there a way to do it?</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","windows","winforms","shutdown"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":38,"score":-1,"question_id":13183213,"title":"How to know if windows is being shutdown or restart","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4617538/is-there-a-way-in-c-sharp-to-detect-a-windows-shutdown-logoff-and-cancel-that-ac\">Is there a way in c# to detect a Windows shutdown/logoff and cancel that action (after asking the user)</a>  </p>\n</blockquote>\n\n\n\n<p>I am trying to logout my application when the windows is being restarted or shutdown. </p>\n\n<p>My question is how to know if windows is being shutdown or restart in c#?</p>\n\n<p><strong>Update:</strong></p>\n\n<p>I am not trying to cancel the shutdown or restart event. I will just send a post request on my webservice to logout the user in my application before shutdown or restart event is initiated.</p>\n"},{"tags":["c#",".net","winforms","paint","picturebox"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13182851,"title":"Why does the menu strip white out when subscribing to a picture box paint event?","body":"<p>I have a form with a <code>MenuStrip</code> and a <code>PictureBox</code>. I subscribe to the <code>PictureBox</code>'s <code>Paint</code> event with the following code:</p>\n\n<pre><code>private void pictureBox1_Paint(object sender, PaintEventArgs e)\n{\n    pictureBox1.Image = new Bitmap(pictureBox1.Width, pictureBox1.Height);\n    // other code but the above line demonstrates the problem\n}\n</code></pre>\n\n<p>This for some reason causes the <code>MenuStrip</code> to white out--I can't see the text until I hover over it--even though the <code>PictureBox</code> does not overlap the <code>MenuStrip</code> at all. I can put a <code>menuStrip1.Update()</code> at the end of the function above, but that causes other problems.</p>\n"},{"tags":["c#","winforms","listview"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13183027,"title":"How do I find an item in a ListView and update another column in that same row?","body":"<p>My app reads a text file and populates a ListView. It's pretty simple, like this:</p>\n\n<pre><code>Date     | Invoice   | Status  \n20121015 | 123123    |  \n20121015 | 123124    | \n20121015 | 123456    |  \n20121015 | 124123    |  \n</code></pre>\n\n<p>I then need to read a 2nd text file, which may or may not contain an invoice found in the ListView along with a status. If there is a matching invoice, the status from that 2nd text file needs to be added to the ListView so it would look like this:</p>\n\n<pre><code>Date     | Invoice   | Status  \n20121015 | 123123    |  \n20121015 | 123124    | \n20121015 | 123456    | Paid \n20121015 | 124123    |  \n</code></pre>\n\n<p>Originally I had a ListBox with only the invoice numbers, and was doing </p>\n\n<pre><code>int index = ListBox1.FindString(&lt;whatever&gt;);\n</code></pre>\n\n<p>to get the index of the row containing an invoice, then removing the item (RemoveAt(Index)) and inserting a new item like </p>\n\n<pre><code>ListBox.Items.Insert(index, invoice + \" PAID\")\n</code></pre>\n\n<p>How do I do something similar with a ListView? I like the idea of having columns instead of just 1 line of text. Should I use something other than a ListView to accomplish this?</p>\n\n<p>On average, each text file I'm reading has &lt;1000 rows that need to be added.</p>\n"},{"tags":["c#","winforms","path"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":34,"score":-1,"question_id":13182316,"title":"c# how to get a file path of the same file on different computers","body":"<p>i am trying to make a code which takes an image from a file path which i type in manually.\nhere is my code:</p>\n\n<p><code>pieceImage = Image.FromFile(@\"O:\\Projects\\imagename.png\");\n</code></p>\n\n<p>This code is saved on my USB flash drive.\nHowever, whenever i run this code on a different computer, the path is different (obviously) and doesn't necessarily start with O:\\ but something else, for example F:.</p>\n\n<p>What can i use so that the path will change accordingly to the computer on which it runs? many thanks in advance.</p>\n"},{"tags":[".net","winforms","datagridview"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":96,"score":0,"question_id":8045236,"title":"How to keep columns sortable in a datagridview without displaying the sorting glyph","body":"<p>When setting <code>DataGridViewColumn.SortMode = DataGridViewColumnSortMode.Automatic</code>, there is space saved beside each column header for (potentially) displaying a sorting glyph. Even when using <code>DataGridViewColumnSortMode.Programatic</code>, even though the glyph is not drawn by default, there is still space reserved to draw a custom glyph. What is the simplest way to maitain the same functionality as <code>DataGridViewColumnSortMode.Automatic</code> (i.e., click on column headers to sort a column), yet not show (and not reserve space) for the sorting glyph?</p>\n"},{"tags":["vb.net","winforms","sql-server-ce","sql-server-2008r2-express"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13181313,"title":"support multiple database engines from vb.net winform","body":"<p>I have an application which was written based on an SQL Server database backend. Now that we are in production, SQL Server is proving to be to complicated for trial versions, so i am hoping to add support for SQL CE to embed into the application for a lightweight trial version. </p>\n\n<p>The data access was all created using Visual Studio and strongly typed datasets, which Visual studio so kindly makes provider specific. I have unfortunately created a large majority of my program using the visual design tools in VS2010, so my original idea of just creating a second dataset based on SQL CE is proving to me problematic as I have no way to easily swap it out in the code.</p>\n\n<p>I have been doing some searching on Google and on here trying to figure out the best and easiest way to convert my application to be able to support multiple database engines, but to be completely honest, everything is WAY over my head. I think that I need to create a data access layer, but that is about as far as I was able to understand into the \"Beginning's\" turotirals and articles.</p>\n\n<p>Does anyone know of a way to programatically switch between datasets for the entire program, or do you have any REALLY BEGINNER level instructions converting a complete program into one that uses a DAL without a complete rewrite- not an option at this point?</p>\n"},{"tags":["c#","winforms","exception","richtextbox","messagebox"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13179673,"title":"Catch all exceptions in a RichTextBox","body":"<p>I'm trying to load an xml file into the interface and there may be many exceptions based on data in Xml file, So  I want to catch all the exceptions at once.\nI got around 15 exceptions and display it once <code>RichTextBox</code> or Something else or in a <code>MessageBox</code>. </p>\n\n<pre><code>for (int i = 0; i &lt; this.SortedLaneConfigs.Count; i++)\n    {\n         if(this.SortedLaneConfigs[i].CheckConsistency())\n            {\n                throw new DataConsistencyException(String.Format(\"Lane #{0} NOT consistent : {1}\", i, e.Message)\n            }\n    }\n\n\nif (this.SortedLaneConfigs[i - 1].EndB &gt; this.SortedConfigs[i].BeginB)\n    {\n        throw new DataConsistencyException(String.Format(\"Lanes {0} &amp; {1}  overlap\", i - 1, i));\n    }\n\n    this.SortedLaneConfigs.ForEach(\n        laneConfig =&gt;\n        {\n            if (this.SortedLaneConfigs.FindAll(item =&gt; item.Id == laneConfig.Id).Count != 1)\n                {\n                    new DataConsistencyException(String.Format(\"Id \\\"{0}\\\" present more than once\", laneConfig.Id));\n                }\n        });\n</code></pre>\n\n<p>I know, I can catch exception and display it in a message box, in this normal way.</p>\n\n<pre><code> try\n    {\n         this.SortedLaneConfigs[i].CheckConsistency();\n    }\ncatch (Exception e)\n    {\n        MessageBox.Show(\"Error message below: \\n\\\"\" + String.Format(\"Configs #{0} NOT consistent : {1}\", SortedLaneConfigs[i].Id, e.Message) + \"\\\"\", \"Error!\", MessageBoxButtons.OK, MessageBoxIcon.Error);\n    }\n</code></pre>\n\n<p>I googled it and i found these 2 links, link1:<a href=\"http://blogs.elangovanr.com/post/Catch-multiple-Exceptions-together-in-C.aspx\" rel=\"nofollow\">http://blogs.elangovanr.com/post/Catch-multiple-Exceptions-together-in-C.aspx</a> link2:\n<a href=\"http://stackoverflow.com/questions/136035/catch-multiple-exceptions-at-once\">Catch multiple Exceptions at once?</a></p>\n\n<p>How can i adapt the suggested solution from those two links to display all the exceptions at once in RichTextBox or or Something else or in a messageBox. Please help me.</p>\n"},{"tags":[".net","vb.net","winforms","datagridview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13179189,"title":"DataGridView is blank after setting Datasource","body":"<p>I have looked and found one question which was similar, though did not resolve my issue - that other question was <a href=\"http://stackoverflow.com/questions/9963416/datagridview-is-blank-after-changing-datasource-at-runtime\">datagridview-is-blank-after-changing-datasource-at-runtime</a></p>\n\n<p>I am sure this is a simple question with an even more simple answer..Working on my first Windows Forms application and finding some things a lot different from ASP.Net :)</p>\n\n<p>So in this application I have the following:</p>\n\n<ul>\n<li>Main Form</li>\n<li>Toolbar on this form, opens up a second form to set application settings</li>\n<li>This second form has a tab control (2 tabs) with various textboxes/checkboxes/combolists/buttons\n<ul>\n<li>All of these work perfectly.</li>\n</ul></li>\n<li>On the second tab of this second form, along with more textboxes etc, I have added a DataGridView; called printerListGrid</li>\n</ul>\n\n<p>In the code-view of this form I am trying to bind a List(Of Printer) to it</p>\n\n<pre><code>printerListGrid.DataSource = AppContext.printers.printerList\n</code></pre>\n\n<p>When I run my app and go to the form/tab the DataGridView is blank.</p>\n\n<p>I have also tried:</p>\n\n<pre><code>    printerListGrid.Columns.Clear()\n    printerListGrid.AutoGenerateColumns = True\n    printerListGrid.DataSource = AppContext.printers.printerList\n</code></pre>\n\n<p>Again - it's blank.</p>\n\n<p>While debugging I can see that my printerList contains 2 <code>printer</code> objects. I can also see that these have been set to the printerListGrid by viewing the contents of the <code>.DataSource</code> property. Yet, the DataGridView is still blank. </p>\n\n<p>I'm guessing there must be some way to re-render the grid?</p>\n\n<p>For the sake of code-discolsure; this is what is in the <code>List(Of Printer)</code></p>\n\n<pre><code>    Public Structure Printer\n        Public id As Integer\n        Public name As String\n        Public material As Enums.Materials\n        Public outputFolder As String\n    End Structure\n</code></pre>\n\n<p>Let me know if there is any more code/description you need to provide help.</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>I forgot to mention. I am trying to set the <code>DataSource</code> in a <code>Private Sub</code> which is called on the forms Load event <code>MyBase.Load</code></p>\n\n<p><strong>UPDATE #2</strong></p>\n\n<p>I continue to play with this, trying to get it to work - I might be totally misunderstanding the control and its purpose.. anyway, I have also tried the following:</p>\n\n<pre><code>    printerListGrid.AutoGenerateColumns = False\n\n    Dim col As DataGridViewColumn = New DataGridViewTextBoxColumn()\n    col.DataPropertyName = \"name\"\n    col.HeaderText = \"Name\"\n    printerListGrid.Columns.Add(col)\n\n    col = New DataGridViewTextBoxColumn()\n    col.DataPropertyName = \"material\"\n    col.HeaderText = \"Material\"\n    printerListGrid.Columns.Add(col)\n\n    col = New DataGridViewTextBoxColumn()\n    col.DataPropertyName = \"outputFolder\"\n    col.HeaderText = \"Output Folder\"\n    printerListGrid.Columns.Add(col)\n\n    printerListGrid.DataSource = AppContext.printers.printerList\n</code></pre>\n\n<p>This results in at least the grid showing rows; appears like 2. Yet they are not populated with the data from <code>List(Of Printer)</code>...</p>\n"},{"tags":["c#",".net","winforms","visual-studio-2010","visual-c#-express-2010"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":95,"score":2,"question_id":13179969,"title":"2 in a row game in c#","body":"<p><img src=\"http://i.stack.imgur.com/o1gZs.jpg\" alt=\"the board \"></p>\n\n<p>above is the image of the board</p>\n\n<p>i am finding it hard to work out how to detect 2 color in a row to determine winner\nwith out using brute-force enumeration..</p>\n\n<p>i have an algorithm and i have been trying to implement it but i cant seem to get it working\nwould anyone know how to do this.. would be great help thanks..</p>\n\n<p>i want to detect winner diagonal vertical and horizontal..</p>\n\n<p>p.s i don't normally ask for solutions but this time i really need some help. many thanks</p>\n\n<p>here is the code that i have for the program that allows u to put the peaces</p>\n\n<pre><code>namespace WindowsFormsApplication1\n{\n    public partial class Form1 : Form\n    {\n\n        private Button[] btns;\n        private Button[] btns2;\n        private Button[] btns3;\n        public Color[] col;\n      //  public var x;\n\n        public Form1()\n        {\n            InitializeComponent();\n\n            btns = new Button[2] { button2, button3 };\n            btns2 = new Button[2] { button4, button5 };\n            btns3 = new Button[2] { button9, button8 };\n            col = new Color[2] { Color.Red, Color.Yellow };\n           Color x = col[0];\n            Color y = col[1];\n\n\n        }\n\n\n\n        private void Form1_Load(object sender, EventArgs e)\n        {\n\n            foreach (var btn in btns)\n            {\n                btn.Enabled = false;\n                btn.BackColor = Color.LightCyan;\n            }\n\n            foreach (var btn in btns2)\n            {\n                btn.Enabled = false;\n                btn.BackColor = Color.LightCyan;\n            }\n            foreach (var btn in btns3)\n            {\n                btn.Enabled = false;\n                btn.BackColor = Color.LightCyan;\n            }\n        }\n\n\n\n\n        public int state;\n        int cc = 0;\n        private void button1_Click(object sender, EventArgs e)\n        {\n            foreach (var btn in btns)\n            {\n                  {\n                    if (!btn.Enabled)\n                    {\n                        btn.Enabled = true;\n\n                        if (cc == 0)\n                        {\n                            cc = 1;\n                            btn.BackColor = col[0];\n\n                        }\n                        else\n                        {\n                            cc = 0;\n                            btn.BackColor = col[1];\n                        }\n\n\n\n                        return;\n                    }\n\n                }\n            }       \n        }\n\n\n        private void button6_Click(object sender, EventArgs e)\n        {\n            foreach (var btn in btns2)\n            {\n                if (!btn.Enabled)\n                {\n                    btn.Enabled = true;\n\n                    if (cc == 0)\n                    {\n                        cc = 1;\n                        btn.BackColor = col[0];\n                    }\n                    else\n                    {\n                        cc = 0;\n                        btn.BackColor = col[1];\n\n                    }\n\n\n\n                    return;\n                }\n            }\n        }\n\n        private void button7_Click(object sender, EventArgs e)\n        {\n\n            foreach (var btn in btns3)\n            {\n                if (!btn.Enabled)\n                {\n                    btn.Enabled = true;\n\n                    if (cc == 0)\n                    {\n                        cc = 1;\n                        btn.BackColor = col[0];\n                    }\n                    else\n                    {\n                        cc = 0;\n                        btn.BackColor = col[1];\n\n                    }\n\n\n\n                    return;\n                }\n            }\n\n        }\n    }\n}\n</code></pre>\n"},{"tags":["vb.net","winforms",".net-4.0"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13165441,"title":"Object reference not set to an instance of an object in Visual Studio 2010","body":"<p>I am trying to make a program that takes a text from a file and writes it into a label in visual studios 10. I want to be able to click buttons on the exe to make it go from the previous line to the next line and vise versa. I am storing the text into an array and then making the label equal the text on the given part of the array. I am receiving the error \"Object reference not set to an instance of an object.\" Can anyone help ? thanks. here is part of my code my code:</p>\n\n<pre><code>   Private Sub BrowseButton_Click(sender As System.Object, e As System.EventArgs) Handles BrowseButton.Click\n\n            Dim UserInput As DialogResult = Browser.ShowDialog()\n\n            If UserInput = Windows.Forms.DialogResult.Cancel Then\n                Return\n            End If\n\n            FileOpen(1, Browser.FileName, OpenMode.Input)\n            Do While Not EOF(1)\n                Input(1, InternalTextFile(Index))\n                Index += 1\n            Loop\n            FileClose(1)\n            Output1Text.Text = InternalTextFile(Index)\n            Output2Text.Text = InternalTextFile(Index + 1)\n\n    End Sub\n</code></pre>\n\n<p>The error arises On the line <code>Input(1, InternalTextFile(Index))</code></p>\n"},{"tags":["c#",".net","winforms","datagridview"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4201,"score":0,"question_id":8776091,"title":"How to remove all DataGridView rows on form load?","body":"<p>How can I remove all the datagridview rows except the column headers?</p>\n\n<p>I tried:</p>\n\n<pre><code>dataGridView1.Rows.clear();\n</code></pre>\n\n<p>but it does not work.</p>\n\n<p>I tried to loop over the rows and use the <code>RemoveAt</code> method, but it does not remove all rows:</p>\n\n<pre><code>private void Form5_Load(object sender, EventArgs e)\n{       \n    dataGridView1.AutoGenerateColumns = true;\n    SqlConnection con = new SqlConnection(@\"Data Source=.\\myserver;Initial Catalog=test;Integrated Security=True\");\n    adapter = new SqlDataAdapter(\"SELECT id as [#], description as [Description], unit as [Unit], amount as [Amount], unitPrice as [Unit Price], total as [Total] FROM tbl_poMaterials\", con);\n    adapter.SelectCommand.CommandType = CommandType.Text;\n    DataTable tb = new DataTable();\n    adapter.Fill(tb);\n    SqlCommandBuilder builder = new SqlCommandBuilder(adapter);\n    dataGridView1.DataSource = tb;\n\n    dataGridView1.Columns[0].Width = 30;\n    dataGridView1.Columns[0].ReadOnly = true;\n    dataGridView1.Columns[1].Width = 660;\n\n    for (int i = 0; i &lt; tb.Rows.Count; i++)\n    {\n        tb.Rows.RemoveAt(i);\n    }\n}\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13175407,"title":"C# Drop Down menu with labels in Winforms","body":"<p>I would like to have a drop down menu in Winforms in C# with Text Label in between the menu items. It will be very similar to seperators. So basically I am looking at an option of grouping the menu items.</p>\n\n<p>Any idea how we can achieve it ? Attached is the drop-down menu I wish to have.\n<img src=\"http://i.stack.imgur.com/2x7ui.gif\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","winforms","report","rdlc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13161653,"title":"Repeating a Table in Columns in RDLC","body":"<p>I have a Table in a VS2010 RDLC report.  It prints data out as you would print a receipt because we are trying to save some space.</p>\n\n<p>I want to have the table repeat as a second column on the same page before it starts a new page.  For example:</p>\n\n<pre><code>Table            Table\nTable            Table\nTable            Table\nTable            Table\nTable            Table\n=== page break =====\n</code></pre>\n\n<p>Instead of</p>\n\n<pre><code>Table\nTable\nTable\nTable\nTable\nTable\nTable\n====page break=====\nTable\nTable\nTable\n</code></pre>\n\n<p>How can I get a second column into the table?</p>\n"},{"tags":["c#","winforms","magento","oauth"],"answer_count":0,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":184,"score":4,"question_id":13106146,"title":"step by step oAuth rest C# winform examples","body":"<p>I have been trying for a while now and need to find a step by step from ground up on creating a consumer app for magento.</p>\n\n<p>I have looked at </p>\n\n<pre><code>springframework.net/social-twitter/\n\nDevDefined OAuth\n\nhttp://www.codeproject.com/Articles/247336/Twitter-OAuth-authentication-using-Net\n</code></pre>\n\n<p>and many others but it's not clear what to do really.  What i need to so is make a winform in C# that will need to use the rest api for magento with oAuth.  Really here I'm a little lost.  </p>\n\n<p>really the info i get to have as a consumer is</p>\n\n<pre><code>        String callbackUrl = \"liconnect://success\";\n        String temporaryCredentialsRequestUrl = \"http://domain.xxx/oauth/initiate?oauth_callback=\" + HttpUtility.UrlEncode(callbackUrl);\n        String adminAuthorizationUrl = \"http://domain.xxx/admin/oauth_authorize\";\n        String accessTokenRequestUrl = \"http://domain.xxx/oauth/token\";\n        String apiUrl = \"http://domain.xxx/api/rest\";\n        String consumerKey = \"KKKKKKKKKKKKKKK\";\n        String consumerSecret = \"SSSSSSSSSSSSSSSSSSS\";\n</code></pre>\n\n<p>The \"liconnect://success\"; is to get to some where pass but i havn't gotten tht  far either lol... </p>\n\n<p>the oauth_token and the oauth_token_secret need to be saved so I don't know if that can be stored from with in? but the deal is that you have to login too if you don't know the magento path .. I tried building a scraper with HtmlAgilityPack and got all the way to the login form but even thou i pass the form with everything that was on the page magento thinks there is an issue.  I would guess do to the headers.. so going that route has not worked.</p>\n\n<p>I also have tried to work to just do a post and use System.Security.Cryptography but that has not worked out as well.</p>\n\n<p>Any mad programmer that would have a line on a solid how to or want to take the challenge to put one here for people?  There are many out there asking the same question here.</p>\n"},{"tags":["c#","winforms","performance","image"],"answer_count":4,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":89,"score":4,"question_id":13176192,"title":"What image format can c# load fastest?","body":"<p>this may seem like an odd question, and I don't know the formats of images so I'll just go ahead and ask...</p>\n\n<p>I'm making a minesweeper game (relevant to different things too) which utilizes a grid of buttons, then I'm adding a sprite to the buttons using <code>backgroundImage</code>. If the grid is 9x9 it's fine. 15x15 it slows down and 30x30 you can visibly see each button being loaded. </p>\n\n<p>That raises me to my question: Which image format would load fastest? Obviously, file size takes a part in the loading speed, however, I am enquiring as to if, say, a jpeg - with the same filesize as a gif - will load faster. or a bmp, png, etc.</p>\n\n<p>I'm asking this as to see if I can get my grid to load faster using a different format.</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","winforms","multithreading","ui-thread"],"answer_count":4,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":4137,"score":6,"question_id":1149402,"title":"How to detect if we're on a UI thread?","body":"<p>For the sake of argument, consider a UI thread as a thread that has had a call to <code>Application.Run()</code> or one of it's overloads called on it and has an active message loop running.</p>\n\n<p>Is there a way of detecting if we're currently executing on such a thread?</p>\n\n<p>The reason I want this is because I have a class with a private function that is long-running. The class itself is already multithreaded, and the usage of this class is such that it might be used from either the UI or from background threads doing processing. This function also falls into this net. But I don't want it to block up the UI thread. So I want to detect if I am running on a UI thread and if so, fork the function call into a background thread (probably <code>ThreadPool</code>, but that's a non-issue for this discussion). This is entirely well-behaved, but the background threads are probably relying on the output of the function, so blocking for them is better, whereas the UI thread is accessing it in a more \"set-and-forget\" manner.</p>\n"},{"tags":["c#",".net","winforms","event-handling"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13175673,"title":"Generic / reusable form open/close events","body":"<p>Whilst developing a current project which contains a number of WinForms, I'm finding myself becoming cluttered with lines of code simply to handle open / close events for the forms. Currently I'm handling them like so..</p>\n\n<pre><code>//Declare forms\nmyForm mForm1;\nmyForm2 mForm2;\n\nprivate void btnSomething_Click(object sender, EventArgs e)\n{\n    if (mForm1 == null)\n    {\n        mForm1 = new myForm();\n        mForm1.FormClosed += new FormClosedEventHandler(mForm1_FormClosed);\n        mForm1.Show();\n    }\n    else\n        if (mForm1.WindowState == FormWindowState.Minimized)\n            mForm1.WindowState = FormWindowState.Normal;\n    mForm1.Focus();\n}\n\nvoid mForm1_FormClosed(object sender, FormClosedEventArgs e)\n{\n    mForm1 = null;\n}\n</code></pre>\n\n<p>And then another set of voids to handle each forms open / close. Now imagine that instead of 2 forms, I've got, say, 5 forms. Now I'm even more cluttered. Is there a way to generalize this to have all forms have the same event handlers?</p>\n\n<p>I've thought of perhaps using the object sender in an \"as\" statement, but i'm not sure how i'd find the relevant declared form instance from there.</p>\n\n<pre><code>sender as (form)\n</code></pre>\n\n<p>Any ideas?</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13176367,"title":"When the user checks radio button it needs two separate clicks (one to uncheck other buttons and another to check) in C# windows Forms Application","body":"<p>I have a C# Windows Forms Applications with a form that has 3 radio buttons in a group box.  When the user tries to check a radio button, the currently checked button first unchecks, then clicking again on the desired radio button will check it.  How can I make it work like every other radio button application where it only takes one click to change radio buttons?\nPlease notice that this happens only when i bind checked property of the radio buttons to 3 different bool application settings and that there is no events handlers added to these radio buttons</p>\n"},{"tags":["c#","winforms","drag-and-drop"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13175133,"title":"Allow only a text file in drag drop on a textbox using C#.Net","body":"<p>I am working on a Windows Forms Application.</p>\n\n<p>During one Drag and Drop action on a <code>TextBox</code> control, I want to restrict the user to provide only a text file.</p>\n\n<pre><code>// drag drop module for input text file in textbox starts here\nprivate void textBoxInputTextFile_DragEnter(object sender, DragEventArgs e)\n{\n    if (e.Data.GetDataPresent(DataFormats.FileDrop))\n        e.Effect = DragDropEffects.Copy;\n    else\n        e.Effect = DragDropEffects.None;\n}\n\nprivate void textBoxInputTextFile_DragDrop(object sender, DragEventArgs e)\n{\n    if(e.Data.GetData(DataFormats.FileDrop, true))\n    {\n    // Check if it is a text file\n    // Okay if it is a text file or else give an error message\n    }\n}\n</code></pre>\n\n<p>This code is just a sample from my previous folder drop action but now I want to restrict it to only one file and that too must be a text file. So that, when the drop action happens, it should check first if it is a text file or not and then do other stuff.</p>\n\n<p>How do I do that?</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13175504,"title":"How do i remove \"System.Windows.Forms.TextBox\" from the output text?","body":"<pre><code>text2 = string.Format(\"[B](No Change)[/B]\");\n</code></pre>\n\n<p>The output comes out as:</p>\n\n<pre><code>System.Windows.Forms.TextBox, Text: (No Change)\n</code></pre>\n\n<p>How can I remove the <code>System.Windows.Forms.TextBox, Text:</code> from my output?</p>\n"},{"tags":["c#","winforms","visual-studio-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13158822,"title":"DesignerHost fails to create control with Visible = false","body":"<p>Good day!</p>\n\n<p>I'm writing a .vsix to replace old controls to new ones. I have designerHost which is the current designer instance. Then I start converting like this:</p>\n\n<pre><code> foreach (OldCombo oldCmbx in OldCmbxs())\n {\n      ...\n      NewCombo newCmbx = designerHost.CreateComponent(NewComboType, oldcmbx.Name) as NewCmbx;\n      ...\n      newCmbx.Visible = oldCmbx.Visible;\n      ...\n      designerHost.DestroyComponent(oldCmbx);\n }\n</code></pre>\n\n<p>The thing is <code>-oldCmbx</code> is always <code>Visible=true</code>, no matter how it's written in the designer.cs file. I'm always creating <code>Visible=true</code> newCmbx's. If I force newCmbx to be <code>Visible=false</code>, then designer doesn't show newCmbx after the conversion, but the visible property is still true, so Visible property is definitely not what I'm searching for. So how can I force newCmbx's to be <code>Visible=false</code> in designer.cs?</p>\n"},{"tags":["c#","winforms","usercontrols"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13175208,"title":"Call method on various user controls","body":"<p>I have created a number of custom user controls in my application. They are controls which validate their own content using a Validates() method.  When I click a button on the form, I would like to call this method on any control which has the method.  What is the best way to achieve this?</p>\n\n<p>I'm able to identify and the controls and check if they have the method, but unsure how to call it at this point.  (All the controls begin with 'cc')</p>\n\n<pre><code>        foreach (Control c in this.Controls)\n        {\n            if (c.Name.Length &gt; 2 &amp;&amp; c.Name.Substring(0, 2).Equals(\"cc\"))\n            {\n                var type = c.GetType();\n                if (type.GetMethod(\"Validates\") != null)\n                {\n                    // Call method here\n                }\n            }\n        }\n</code></pre>\n\n<p>Can anyone point me in the right direction, or perhaps a better way I can do this.  I expect these controls will be on a lot of forms so i'd like to make a grouped validation as easy as possible from the parent form.</p>\n\n<p>Thanks,</p>\n"},{"tags":["winforms","listbox"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13175064,"title":"Prevent listbox flicker from list background","body":"<p>I have a listbox with DrawMode = OwnerDraw.</p>\n\n<p>I have noticed a flicker that is the result of the listbox background being drawn before my custom DrawItem is called. Thus even if I use a single e.Graphics.FillRectangle call it would still cause flicker.</p>\n\n<p>Is there anything that can be done to prevent this flicker, perhaps preventing the listbox backgroundcolor from being drawn?</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":564,"score":0,"question_id":9606818,"title":"Getting the number of text lines in a TextBox","body":"<p>I am trying to display the number of  text lines in a textbox through the label.But, the thing is if the last line is empty, the label has to display the line numbers with out that empty line.</p>\n\n<p>For example if they are 5 line with the last line as empty, then the label should display the number of lines as 4.</p>\n\n<p>Thanks..</p>\n\n<pre><code>private void txt_CurrentVinFilter_EditValueChanged(object sender, EventArgs e)\n{\n   labelCurrentVinList.Text = string.Format(\"Current VIN List ({0})\",  txt_CurrentVinFilter.Lines.Length.ToString());                       \n}\n</code></pre>\n\n<p>Actually, above is the code...have to change to display only the no-empty lines in C# winforms.</p>\n\n<p>Thanks</p>\n"},{"tags":["winforms","deployment","dependencies","setup-project"],"answer_count":6,"favorite_count":3,"up_vote_count":21,"down_vote_count":0,"view_count":6273,"score":21,"question_id":3233146,"title":"\"Unable to update dependencies of the project\" after commiting to Subversion","body":"<p>I have a setup project in .NET. When I save the project and the other projects to subversion, the setup project no longer compiles. I get the error \"Unable to update dependencies of the project.\"</p>\n\n<p>Any ideas why?</p>\n"},{"tags":["winforms","multithreading","backgroundworker","threadpool","begininvoke"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":88,"score":0,"question_id":12834545,"title":"C# Download Manager (Thread, ThreadPool, BeginInvoke, BackgroundWorker)","body":"<p>So here it is. I want to make some test download manager (winforms), and want to use 4 different ways (managers):<br>\n1. BackGroundWorker manager\n2. Thread manager\n3. ThreadPool manager\n4. Delegate.BeginInvoke manager<br>\n Download from ftp. Of course make it async for multidownloading, and when i want to add new download, previous download might still work. So, my problem is architecture. I imagine this smth like:<br>\n1) create interface IDownloadManager. Here - enum Status(Idle, download, downloaded, canceled, errorDownloaded), some events (DownloadStarted, DownloadComleted, DownloadCancelled, DownloadStopped), method for Percent, method for Start.<br>\n2) ManagerFactory class, that creates selected Manager.<br>\n3) IManagerFactory interface, that handle with creating Manager<br>\n4) ManagerHost class, where stores all information of current managers.  </p>\n\n<p>Can anyone tell me, where is my architecture mistakes? give me some advises, suggestions etc..Thanks for reading and helping!</p>\n"},{"tags":["c#","winforms","datagridview","datagridviewcolumn"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13173915,"title":"Search for value in DataGridView in a column","body":"<p>I want the user to be able to search for a number in a column in the DataGridView (dgv). The dgv can hold many records. Each record has a Project Number. So I want the user to be able to search for a project number in column Project Number. The columns I have are: ProjectID(not visible); Image(no headertext); Project Number; Project Name; Company; Contact.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>private void btnSearch_Click(object sender, EventArgs e)\n{\n    string searchValue = textBox1.Text;\n    int rowIndex = -1;\n\n    dgvProjects.SelectionMode = DataGridViewSelectionMode.FullRowSelect;\n    try\n    {\n        foreach (DataGridViewRow row in dgvProjects.Rows)\n        {\n            if (row.Cells[row.Index].Value.ToString().Equals(searchValue))\n            {\n                rowIndex = row.Index;\n                dgvProjects.Rows[row.Index].Selected = true;\n                break;\n            }\n        }\n    }\n    catch (Exception exc)\n    {\n        MessageBox.Show(exc.Message);\n    }\n}\n</code></pre>\n\n<p><strong>Problem #1:</strong> What it does so far: The user types the project number in TextBox1. When he/she clicks the button, the code searches for this string in the rows, and when found the project number, that row gets selected. It works fine, but only once. When I want to search for an other project number, nothing happens.</p>\n\n<p><strong>Problem #2:</strong> I think this can be done in a better way, by searching the values for column Project Name only. But how should I do this properly?</p>\n\n<p>The code I used to search comes from <a href=\"http://stackoverflow.com/q/10179223/1671161\" title=\"this answer\">this answer</a></p>\n"},{"tags":["c++","winforms","visual-c++"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13173149,"title":"Keping history in Winforms C++","body":"<p>I have an application made in winform using C++ (developed in VS 2010). The GUIs have certain text fields, radio button, check boxes etc. To operate the software one has to fill in these fields/buttons/boxes etc. </p>\n\n<p>There are roughly such 50 different GUIs, having roughly 20 fields in each one. </p>\n\n<p>I want that after the application is closed, and restarted, most recent parameters in this fields automatically fill in, so the user do not need to re-enter all those values again. </p>\n\n<p>What is the easiest and simplest way to achieve this?           </p>\n"},{"tags":[".net","winforms","textbox","contextmenu"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":35,"score":3,"question_id":13162460,"title":"How do you stop a textbox showing the default context menu?","body":"<p>I've noticed something wierd with the WinForm TextBox's Context Menu. The TextBox control has a default context menu that has Cut, Copy, Paste and a few other things. I am trying to replace this menu with one of my own. I have created a simple test application with one form and one text box on the form and added the following code:</p>\n\n<pre><code>Form1()\n{\n    InitilizeComponent();\n    ContextMenu menu = new ContextMenu();\n    menu.MenuItems.Add(\"Hello World\", HelloWorld_Clicked);\n    textBox1.ContextMenu = menu;\n}\n\nprivate void HelloWorld_Clicked(object sender, EventArgs e)\n{\n    MessageBox.Show(\"Hello World!\");\n}\n</code></pre>\n\n<p>When I run this I can get my context menu to appear by right clicking the textbox and then releasing the mouse button without moving the mouse. However if I press the right mouse button over the textbox, hold it down, then move the mouse outside the textbox and finally relase the mouse button then I get the default text box context menu.</p>\n\n<p>Is it possible to stop it doing this?</p>\n\n<p>UPDATE: In case it makes a difference the system is running on Windows XP Pro SP3 &amp; .Net 3.5.</p>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":5084,"score":2,"question_id":3308202,"title":"file browser dialog implementation","body":"<p>I have seen that there is a folderBrowserDialog but couldn't see one for files .</p>\n\n<p>I should implement one myself or there is something built in ?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","winforms","visual-studio-2010","configuration"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":53,"score":-3,"question_id":13170747,"title":"What is the namespace for ConfigurationManager?","body":"<p>I am new to C# and I can't find the <code>ConfigurationManager</code> class in the <code>System.Configuration</code> namespace. I am using VS2010.  </p>\n\n<p>Can someone please explain how I can find this class?</p>\n"},{"tags":["c#","winforms","mdichild","mdiparent"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2477,"score":0,"question_id":7966890,"title":"Opening a child form from another child form and set MDI to parent form - how to do?","body":"<p>I have a MDI form. within this MDI form I can open some child forms using:</p>\n\n<p>This is within <code>MainForm</code></p>\n\n<pre><code>Form1 f1 = new Form1;\nf1.MdiParent = this; //this refers to MainForm (parent)\nf1.Show();\n</code></pre>\n\n<p>This works as expected!</p>\n\n<p>But Now, while I am in the child form (Form1 -> f1) I want to open another form as a child for <code>MainForm</code> but when I use <code>this</code> keyword it will reffer to <code>f1</code>. How can I open the new form within <code>f1</code> and set its <code>MdiParent</code> to <code>MainForm</code> ?</p>\n"},{"tags":["c#","winforms","loops","foreach","tabcontrol"],"answer_count":6,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":4312,"score":3,"question_id":1744429,"title":"Loop through controls in TabControl","body":"<p>I am looking for a way to loop through controls on a particular tab of a tabcontrol.  For example, I have a tabcontrol with the following tabs:</p>\n\n<p>Cars,\nPets,\nAdmin</p>\n\n<p>On each of these tabs are several controls to display/edit/save data, etc.  On the \"Save\" button, I would like to loop through the controls for that particular tab to check whether all required fields have been filled in.</p>\n\n<p>So, if I am on the Cars tab and click \"Save,\" I want to loop ONLY through the controls on the Cars tab and NOT the Pets or Admin tabs.</p>\n\n<p>How can achieve this result?</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13171093,"title":"DocumentCompleted event when the page is fully loaded in WebBrowser form (Windows Forms C#)","body":"<p>I use the DocumentCompleted but this gets fired multiple times. Now I've seen this example <code>if (e.Url.AbsolutePath != this.webBrowser.Url.AbsolutePath)</code> which is used to confirm that the requested file is completed loading but this gets fired before anything else (like images) on the page is loaded. Thus I'm still not able to tell when a webpage is fully loaded.</p>\n\n<p>Is there a way to ensure that the webpage has fully loaded and there's nothing being loaded?</p>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13147956,"title":"How to make a form like properties window in visual studio?","body":"<p>I have <code>TreeView</code> object and I need when a <code>node</code> of <code>treeview</code> is selected, <code>form</code> is shown in definite location (properties of the <code>node</code>), and when another <code>node</code> is selected, the <code>form</code> changes. When no node is selected, the <code>form</code> disappear. <code>Form</code> contains only <code>ListView</code> object. I need something like properties window in visual studio. </p>\n\n<p><strong>The problem I have now:</strong> </p>\n\n<p><code>Form</code> appear randomly, in wrong location, I need it to be shown in definite location in another <code>form</code>.</p>\n\n<p>After each mouse down event, appear a new <code>form</code>, but I need there will be only one <code>form</code> (or old disappear - new appear)</p>\n\n<p>When no nodes are selected, the <code>form</code> doesn't disappear.</p>\n\n<p>How can I solve this problems, or maybe there is a better solution ?</p>\n"},{"tags":["c#","wpf","winforms","stathread"],"answer_count":1,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":3103,"score":4,"question_id":216634,"title":"WPF with Windows Forms - STAThread","body":"<p>I am a newbie to WPF and have a couple of questions about WPF and Windows Forms integration.</p>\n\n<p>I have an existing  Visual C#  Windows Forms application. I would like to integrate it with a WPF window, that can be shown on a button click. This was not possible as WPF expects the calling thread  to be a STAThread and by default WinForm assumes that the thread is an MTAThread. I tried spawning a new thread with an apartment state of STAThread for calling the WPF UI but that did not work. I tried using the Dispatcher.BeginInvoke method and Background Worker  as well, but none of them resolved the issue.</p>\n\n<p>1) Can we make a call to WPF window/control without marking the Main as an STAThread? If it is possible, Can anyone please point me to a proper direction? \n2) If the only way to accomplish this is by making the Main Thread an STAThread, will there be any impact to the general performance/responsiveness of the application.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13170295,"title":"C# Limited times a button can be pressed with pop up showing and streamwriting to a file","body":"<p>Okay so I am writing a program and it should only allow the user to click a certain Button a random amount of times (1-25 times) which is generated each time the user starts the program. My code is not working for this, the program currently keeps a totalled Value in a ListBox and when the user hits the \"limit\" amount that they can hit the button, its suppose to write that totalled value to a file which I already have saved. Also how would you incorporate the Message show when this 'Random number of times' is activated? Here is my code, THanks: </p>\n\n<pre><code>     public Form1()\n       {\n        InitializeComponent();\n        }\n        private int lose()\n        {\n\n        // int High_Score;\n\n        Random rand = new Random();\n        lost = rand.Next(23) + 2;\n        return lost;\n        MessageBox.Show(\" you lose\");\n\n\n       }\n\n       private void begingameButton_Click(object sender, EventArgs e)\n        {   \n        lose();\n        //Begin game button disable\n        begingameButton.Enabled = false;\n        //The roll button is enabled\n        rolldieButton.Enabled = true;\n        //Makes the beginning instructions visible\n        beginLabel.Visible = false;\n        //Makes the other instructions visible\n        diceBox1.Visible = true;\n        //Enables the start over button\n        startoverButton.Enabled = true;\n        //Displays a total of 0 dollars at the beginning of game\n        int beginTotal = 0;\n        totalmoneyLabel.Text = beginTotal.ToString(\"c\");\n\n         }\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":6684,"score":5,"question_id":744494,"title":"WinForms: temporarily disable an event handler","body":"<p>How can I disable an event handler temporarily in WinForms?</p>\n"},{"tags":["c#","winforms","windows-8","gdi+"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13169779,"title":"generic error in gdi+ decoding a valid jpeg","body":"<p>I have a valid jpeg frame that is taken from a camera:</p>\n\n<p><a href=\"http://www.developerinabox.com/test.jpg\" rel=\"nofollow\">http://www.developerinabox.com/test.jpg</a></p>\n\n<p>I'm loading this with the below (example) code:</p>\n\n<pre><code>using System.Net;\nusing System.Drawing;\n\nnamespace ConsoleApplication1\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n\n            WebRequest req = WebRequest.Create(\"http://www.developerinabox.com/test.jpg\");\n            req.Timeout = 5000;\n            WebResponse resp = null;\n\n\n            resp = req.GetResponse();\n            if (resp != null)\n            {\n                var s = resp.GetResponseStream();\n                if (s != null)\n                {\n                    Image img = Image.FromStream(s); //&lt;-- Error thrown here\n                }\n            }\n\n\n        }\n    }\n}\n</code></pre>\n\n<p>In windows XP/Vista/7 this works fine. </p>\n\n<p>In windows 8 it's failing with \"generic error in gdi+\" I've tried loading it via WPF with the same result. </p>\n\n<p>I can display the image on my windows 8 PC in google chrome but not in IE. It will display in both on windows XP/Vista/7.</p>\n\n<p>I can open it on my Windows 8 box in Fireworks but trying to open it in paint gives me:</p>\n\n<p>\"This is not a valid bitmap file, or its format is not currently supported.\"</p>\n\n<p>Any ideas?</p>\n"},{"tags":["c#","winforms","validation","currency","maskedtextbox"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13150851,"title":"Set population field validation in masked text box","body":"<p>Hi I am new to C# I have one problem in <code>masked text box</code> </p>\n\n<p>Population range is 1,000 to 12,00,00,00,000</p>\n\n<p>My problem is when enter 1000 in masked text box it will be taken as 1,000 like when i enter 12000 it will considered as 12,000 like default it will arranged in <code>,</code>. </p>\n\n<p>How can i do it? Please provide if any solution.</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":37,"score":0,"question_id":13151289,"title":"How to ShowDialog in background thread on top of UI thread modeless?","body":"<p>Is there a way to show a form in a background thread but you can always see it in front of UI thread as modeless?</p>\n\n<p>For example the UI thread run with parentForm, and there is a backgroundworker thread run with childForm on top. May I work with parentForm with childForm on top modeless, which means I can always see my childForm but not block my parentForm.</p>\n\n<p>It seems childForm.ShowDialog(parentForm) will block UI thread and I don't want to Invoke childForm in UI thread.</p>\n"},{"tags":["c#","winforms","listbox"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":13169900,"title":"Hide vertical scroll bar in ListBox control","body":"<p>I'm developing an application that requires a <code>ListBox</code> control. Unfortunately, when I add too many items in the <code>ListBox</code>, a vertical scroll bar is shown. Is there something I can do to hide the vertical scroll bar shown by the <code>ListBox</code>? I can see that there's a property to hide the horizontal scroll bar but there's no property for the vertical scroll bar.</p>\n"},{"tags":["c#","winforms","security","cookies","webbrowser-control"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13169955,"title":"How can I stop a webbrowser control from showing cookie security warnings?","body":"<p>I'm using <code>winform</code> <code>webbrowser</code> control and sometimes when closing the application, I get this very annoying Windows Security Warning dialog about allowing cookies on the site. Here is the exact message:</p>\n\n<blockquote>\n  <p>To allow this website to provide information personalized for you,\n  will you allow it to put a small file (called a cookie) on your\n  computer?</p>\n</blockquote>\n\n<p>Now, I know my IE 9 settings has cookies turned on (by navigating my control to www.whatismybrowser.com), so why do I still get this dialog? I would like it to never display, and I thought allowing cookies should be sufficient but maybe the control is doing something else. </p>\n"},{"tags":["vb.net","winforms","sendmessage","postmessage","windows-messages"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":13147529,"title":"VB.NET Send Tab key to another application window","body":"<p>I want to send \"{TAB}\" Key to another application <strong>window</strong>(send the key to the window not to textbox).</p>\n\n<p>I tried:</p>\n\n<pre><code>SendMessage(hWnd, WM_SETHOTKEY, VK_TAB, 0)\n</code></pre>\n\n<p>Nothing happened.\n<br>\nmy goal is:\n<br>\nsend tab key to my application <strong>Or</strong> other application when the application window is <strong>not</strong> in focus.\n<br>\n(<strong>i know that sendkey is not professional in this case there is no choice</strong>(This is the first time that I'm using it).)</p>\n\n<p>I made many attempts and I always returned to the same result:</p>\n\n<p><strong>Nothing happened.</strong></p>\n\n<p>Does anyone know the answer?</p>\n"},{"tags":["wpf","winforms","bug","form-load"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":69,"score":4,"question_id":13161947,"title":"Explain critical bug in Visual Studio 2010 and up, WinForms and WPF","body":"<p>Try putting the following code inside <code>Load</code> event handler for WinForms or <code>Loaded</code> for WPF.</p>\n\n<pre><code>Dim doc As New XmlDocument\nDim nsmgr As New XmlNamespaceManager(Nothing) 'this line throws an exception\n</code></pre>\n\n<p>Problem is that exception is not thrown, and stack corruption happens. It may have different side effects, depending on the IDE - see below.</p>\n\n<ul>\n<li>Affected IDEs are: 2008, 2010 and 2012 (those I could test). 2010 resets stack state, and returns from sub/handler, like nothing happened (but without proceeding with other statements there). 2012 may warn a user about a failed application and an attempt to run in <code>compatibility mode</code>. Next time after that it runs the same as 2010. 2008 properly throws an exception, but only on default configuration (AnyCPU). Switching platform target to x86 makes the problem reappear in 2008 as well.</li>\n<li>Affected frameworks are WinForms and WPF. Console apps and ASP.NET\nseem to work fine. .NET v2.0-4.5.</li>\n<li>Affected scope is only <code>Load</code> event so far.\nPutting this code into a button makes it work.</li>\n<li>Affected build\nconfiguration = any. Tried on default <code>Debug</code> and <code>Release</code>.</li>\n</ul>\n\n<p>Why I consider it a bug is because it can leave objects in an unstable state - they did not finish initializing, which is not an expected behavior. What's critical about it is that nobody will know it happened, as it does not throw an exception. Depending on your design, you may end up with incorrect data in your database, which in the worst case may lead to severe consequences.</p>\n\n<p>Does anyone have a good explanation to why this may be happening and if there is a workaround?</p>\n"},{"tags":["vb.net","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13166309,"title":"Increasing the space inside a windows form","body":"<p>I am trying to populate my windows form with new controls and data based on what is read from my database. The left side of the form is a static panel which will not need re sizing but I need to create multiple labels on the right side which requires more space. I added the vscroll control but am having trouble increasing the size of the right side of the form.<img src=\"http://i.stack.imgur.com/dVqLe.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["winforms","datagridview","cell-formatting"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":542,"score":2,"question_id":10651702,"title":"Is there a way to force a DataGridView to fire its CellFormatting event for all cells?","body":"<p>We use the CellFormatting event to colour code cells in various grids all over our application.</p>\n\n<p>We've got some generic code which handles export to Excel (and print) but it does it in Black &amp; White. Now we want to change this and pick up the colour from the grids.</p>\n\n<p>This <a href=\"http://stackoverflow.com/a/10616569/180430\">question &amp; answer</a> has helped (and it works) ... except there's a problem with larger grids that extend beyond a single screen. The portions of the grid which haven't yet been displayed on screen are (logically) never getting their CellFormatting code fired, and so their underlying colour never gets set. As a result, in Excel, the colour coding <em>fizzles out</em> half way down the page.</p>\n\n<p>Seems there are three solutions:</p>\n\n<p>1) Tell the user he has to scroll to all parts of the grid before doing an Export to Excel. <strong>Ha! Not a serious solution</strong></p>\n\n<p>2) Programmatically scroll to all parts of the grid before doing an Export to Excel. <strong>Only slighly less horrible than (1)</strong></p>\n\n<p>3) In our Export to Excel code, fire something at the top which tells the DataGridView to paint/format its entire area e.g.</p>\n\n<pre><code>  MyDataGridView.FormatAllCells()\n</code></pre>\n\n<p><strong>Is there something that does something like this???</strong></p>\n\n<p>Oh, and there is a fourth option but this will involve touching a massive amount of existing code:</p>\n\n<p>4) Stop using CellFormatting event, format the cells at load time. Problem with this is we'd have to retool every grid in our application since CellFormatting is the way we've done it since year dot.</p>\n"},{"tags":["c#",".net","windows","winforms","treeview"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13149674,"title":"C# TreeView OnDrawNode is working slow and creating artifact","body":"<p>I am working on a custom C# TreeView and I would like to do some custom draw to highlight the keywords appear in the name of nodes.</p>\n\n<p>I did :</p>\n\n<pre><code>DrawMode = TreeViewDrawMode.OwnerDrawText;\n</code></pre>\n\n<p>in the constructor of the custom TreeView and override the OnDrawNode:</p>\n\n<pre><code>protected override void OnDrawNode(DrawTreeNodeEventArgs e)\n    {\n        if (!e.Node.IsVisible) { return; }\n        if (e.Node.Bounds.IsEmpty) { return; }\n\n        e.DrawDefault = false;\n\n        ...draw calls...\n</code></pre>\n\n<p>But it worked strangely after I coded like this, the perceived behaviors include:</p>\n\n<ol>\n<li>OnDrawNode being call on the child nodes which is not expanded and invisible</li>\n<li>When the content of the TreeView updates, the user would see the old content and new content at the same time overlapping with each other. The old content would disappear not until about half second or longer.</li>\n<li>The rendering speed is much slower than the original draw call.</li>\n</ol>\n\n<p>Another modification I did is the code snippet I found here to suppress the flickering happens when the TreeView is updating:\n<a href=\"http://dev.nomad-net.info/articles/double-buffered-tree-and-list-views\" rel=\"nofollow\">http://dev.nomad-net.info/articles/double-buffered-tree-and-list-views</a>\nBut it seems not directly related to the problem since I can still see the text overlapping after removing it.</p>\n\n<p>I wonder if anyone have any idea about this issue?</p>\n\n<p>Any thought would be appreciated.\nThank you.</p>\n\n<p>edit:</p>\n\n<p>The content of the OnDrawNode is like:</p>\n\n<pre><code>string pattern = keyword;\nif (!string.IsNullOrWhiteSpace(pattern))\n{\n    Regex regularExpressionnew = Regex(pattern);\n    Match match = regularExpression.Match(e.Node.Text);\n    while (match.Success)\n    {\n        CaptureCollection captureCollection = match.Groups[0].Captures;\n        foreach (Capture capture in captureCollection)\n        {\n            int highlightStartIndex = capture.Index;\n            int highlightEndIndex = capture.Index + pattern.Length;\n            e.Graphics.FillRectangle(nodeHightLightColor, GetTextBoundsBetweenIndex(e.Graphics, e.Node.Text, highlightStartIndex, highlightEndIndex, e.Bounds));\n        }\n        match = match.NextMatch();\n    }\n\nBrush drawBrush = new SolidBrush(Color.Black);\ne.Graphics.DrawString(e.Node.Text, Font, drawBrush, e.Bounds);\n</code></pre>\n\n<p>GetTextBoundsBetweenIndex is essentially calculating the square area covering the characters between highlightStartIndex and highlightEndIndex.</p>\n\n<p>But the lag and overlap would happen event the regular expression is commented out and only the text rendering left.</p>\n"},{"tags":["c#","winforms",".net-3.5"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":48,"score":3,"question_id":13167637,"title":"Ability to notify users to ask for 'Save Changes' when user tries to close the Windows Form without saving","body":"<p>I am using C# Windows Forms (.NET 3.5), and trying to implement the functionality when user modifies any of the data bounded columns on the Detail form, and tries to close the form without saving, system should pop-up my message \"Save Changes?\".</p>\n\n<p>I know I can always use <code>TextChanged</code> event for <code>Textbox</code> etc., but that requires multiple event coding. I would like to use a specific event handler that detects a change in value in any of the fields that are associated with my <code>BindingSource</code>.</p>\n\n<p>I have bounded my columns like this:</p>\n\n<pre><code>textbox1.DataBindings.Add(\"Text\", this.bindingSource1, \"dbcolumn_1\", true);\n</code></pre>\n"},{"tags":["c#",".net","winforms","list","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13165547,"title":"Replicating rows from DGV into the list","body":"<p>This way I'm accessing as a list from my datagridview. The problem I'm facing here..Lets say if i have <code>6 rows</code> in the DGV, when it updates to the list it shows <code>36rows</code>. \nHow can i fix this problem?? </p>\n\n<pre><code>for (int i = 0; i &lt; testDsrcConfigs .Count; i++ )\n            {\n                Console.WriteLine(testDsrcConfigs [i]);\n            }\n</code></pre>\n\n<p>From the for loop, i can see 6 rows. \nIs it possible to use <code>for loop</code>?? How can i adapt fro loop to access the members??Please help me..!</p>\n\n<pre><code>List&lt;SdrcConfig&gt; testDsrcConfigs = new List&lt;SdrcConfig&gt;();\n\n\nforeach (GridViewRowInfo dr in RadGridView.Rows)\n    {\n        //Create a TrafficLane list \n        List&lt;TrafficLane&gt; covTrafLane = new List&lt;TrafficLane&gt;();\n\n        if (dr.Cells[\"bct0\"].Value != \"XXXX\")\n            {\n                covTrafLane.Add(new TrafficLane(dr.Cells[\"bct0\"].Value.ToString()));\n            }\n        if (dr.Cells[\"bct1\"].Value != \"XXXX\")\n            {\n                covTrafLane.Add(new TrafficLane(dr.Cells[\"bct1\"].Value.ToString()));\n            }\n        if (dr.Cells[\"bct2\"].Value != \"XXXX\")\n            {\n                covTrafLane.Add(new TrafficLane(dr.Cells[\"bct2\"].Value.ToString()));\n            }\n        if (dr.Cells[\"bct3\"].Value != \"XXXX\")\n            {\n                covTrafLane.Add(new TrafficLane(dr.Cells[\"bct3\"].Value.ToString()));\n            }\n\n            //Create RseDevicePosition\n            DevicePosition devPos;\n            int ctx;\n            Int32.TryParse(dr.Cells[\"bx\"].Value.ToString(), out ctx);\n            int cty;\n            Int32.TryParse(dr.Cells[\"by\"].Value.ToString(), out cty);\n            int ctz;\n            Int32.TryParse(dr.Cells[\"bz\"].Value.ToString(), out ctz);\n            int bazu;\n            Int32.TryParse(dr.Cells[\"bazim\"].Value.ToString(), out bazu);\n            int bele;\n            Int32.TryParse(dr.Cells[\"belev\"].Value.ToString(), out bele);\n            int bti;\n            Int32.TryParse(dr.Cells[\"btilt\"].Value.ToString(), out bti);\n\n\n            ushort devnum = UInt16.Parse(dr.Cells[\"bdevnum\"].Value.ToString());\n\n            devPos = new DevicePosition(\n                new ValueWithUnit&lt;int&gt;(ctx, \"mm\"),\n                new ValueWithUnit&lt;int&gt;(cty, \"mm\"),\n                new ValueWithUnit&lt;int&gt;(ctz, \"mm\"),\n                new ValueWithUnit&lt;int&gt;(bazu, \"tenthOfDegree\"),\n                new ValueWithUnit&lt;int&gt;(bele, \"tenthOfDegree\"),\n                new ValueWithUnit&lt;int&gt;(bti, \"tenthOfDegree\"));\n\n\n            ((MyConfig.\n            .ObuTransactionSystemConfig as DsrcTransactionSystemConfig).\n                 DsrcSystemConfig as MultiLaneDsrcSystemConfig).DsrcConfigs.ForEach(\n                     dsrcBeacon =&gt; testDsrcConfigs.Add(\n                         new SdrcConfig(\n                             dr.Cells[\"bid\"].Value.ToString(), \n                             dr.Cells[\"bdesc\"].Value.ToString(),        \n                             covTrafLane,\n                             devPos, devnum,\n                             dsrcBeacon.Settings)));\n    }\n</code></pre>\n"},{"tags":["winforms","report-viewer2010"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13166963,"title":"Reportviewer : Is it possible to display report as a pop-up?","body":"<p>I am using Reportviewer in VS 2010.\nI have a Winform application where a reportviewer control is embedded. Depending on what report the user selects in a treeView, different reports are loaded and displayed.</p>\n\n<p>New requirement is that after user selection of report, the report should be displayed in a pop-up reportviewer instead of the one that is embedded in the Winform. How can I do this? </p>\n\n<p>Thanks! </p>\n"},{"tags":["c#",".net","winforms","software-design"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13166523,"title":"I can't figure a good design to deal with multiple calls to a blocking resource","body":"<p>i'm trying to figure with the best method to deal multiple class to a method that use a blocking resource.</p>\n\n<p><strong>The goal</strong>: </p>\n\n<p>permit the multiple calls to a method that use a <code>DataReader</code>.  While this first call is in progress, Keeping the rest to calls (if present) on hold until the method ends.</p>\n\n<p>When the this method finish it's execution, i need to discard every request accumuled while the first execution was in progress, only permitting that the last request execute.</p>\n\n<p>In specific i'm dealing with repeated event firing in a <code>Windows.Forms</code> object that call a <code>DataReader</code> that doesn't finish to execute and the next call that comes behind it raises an exception.</p>\n\n<p>Any ideas to design this part ?</p>\n"},{"tags":["visual-studio","winforms",".net-2.0"],"answer_count":2,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":3773,"score":8,"question_id":730171,"title":"ToolStripSplitButton vs. ToolStripDropDownButton","body":"<p>What is the difference between <a href=\"http://msdn.microsoft.com/en-us/library/system.windows.forms.toolstripdropdown.aspx\" rel=\"nofollow\">ToolStripSplitButton</a> and <a href=\"http://msdn.microsoft.com/en-us/library/system.windows.forms.toolstripdropdownbutton.aspx\" rel=\"nofollow\">ToolStripDropDownButton</a>?\n(Visual Studio 2008) (Also asked <a href=\"http://www.experts-exchange.com/Programming/Languages/C%5FSharp/Q%5F21842423.html\" rel=\"nofollow\">here</a>, not on SO).  At first blush, they seem to be largly the same; especially in the designer.</p>\n"},{"tags":["c#","winforms","visual-studio-2010","menubar"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13155164,"title":"Visual Studio 2010 menu strip colors","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/9260303/how-to-change-menu-hover-color-winforms\">How to change Menu hover color - WINFORMS</a>  </p>\n</blockquote>\n\n\n\n<p>I'm customizing my menu strip colors. I would like to make it look like the one in Visual Studio 2010.</p>\n\n<p><img src=\"http://i.stack.imgur.com/V7FwO.png\" alt=\"VS 2010 menu strip\"></p>\n\n<p>Is a there an existing document where colors are referenced?</p>\n\n<p><strong>EDIT</strong><br>\nI know how to use a custom renderer to change the colors. My question goal is to get a list of all colors. I could use a image editor software to find the RGB values of each color with the color picker tool, but I was wondering if the list of colors is written somewhere:</p>\n\n<ul>\n<li><code>MenuStripForeColor</code></li>\n<li><code>MenuStripGradientBegin</code></li>\n<li><code>MenuStripGradientEnd</code></li>\n<li><code>MenuItemPressedGradientBegin</code></li>\n<li><code>MenuItemPressedGradientMiddle</code></li>\n<li><code>MenuItemPressedGradientEnd</code></li>\n<li><code>MenuItemSelectedGradientBegin</code></li>\n<li><code>MenuItemSelectedGradientEnd</code></li>\n<li><code>MenuItemSelected</code></li>\n<li><code>MenuBorder</code></li>\n<li><code>MenuItemBorder</code></li>\n<li><code>ImageMarginGradientBegin</code></li>\n<li><code>ImageMarginGradientMiddle</code></li>\n<li><code>ImageMarginGradientEnd</code></li>\n<li><code>ToolStripDropDownBackground</code></li>\n<li>... others (?)</li>\n</ul>\n"},{"tags":["c#","winforms","listview"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":12777395,"title":"Using Column ImageKey in a ListView to simulate windows explorer style sorting","body":"<p>I have a winforms application (C#, .NET 3.5 but eventually migrating to 4.0) which uses a ListView to present attachments (files/web links) in a similar style to windows explorer.</p>\n\n<p>This functionality has been well received by he application users.  A request has been made to edxpand this to include sorting the details view by clicking on column headers (same as in windows explorer)</p>\n\n<p><img src=\"http://i.stack.imgur.com/HoREL.png\" alt=\"Windows explorer sorting\"></p>\n\n<p>This is the style of sorting that I'm aiming for (using a triangular glyph to indicate sort direction)</p>\n\n<p>I've come close to achieving this by using the columns ImageKey property.</p>\n\n<pre><code>if (lvAttachments.ListViewItemSorter != null)\n     {\n        lvAttachments.Sort();\n\n        if (lvwColumnSorter != null)\n        {\n           if (lvwColumnSorter.Order == System.Windows.Forms.SortOrder.Ascending)\n              lvAttachments.Columns[lvwColumnSorter.SortColumn].ImageKey = \"sortAsc\";\n           if (lvwColumnSorter.Order == System.Windows.Forms.SortOrder.Descending)\n              lvAttachments.Columns[lvwColumnSorter.SortColumn].ImageKey = \"sortDesc\";\n        }\n     }\n</code></pre>\n\n<p>Unfortunately the image appears to the left of the text, rather than the right.</p>\n\n<p><img src=\"http://i.stack.imgur.com/yor8i.png\" alt=\"enter image description here\"></p>\n\n<p>ColumnHeader TextAlign property is set to Left, there are few other properties available in the designer, none appear to be of any use.</p>\n\n<p>Does anyone know if it's possible to make the image appear to the right of the text while it is left aligned, or is there another approach I will have to use?</p>\n\n<p>One option I've come across is using a unicode glyph in the header text.  However, I'd rather avoid this if possible as the unicode glyph does not particularly nice.</p>\n"},{"tags":["c#",".net","winforms","entity-framework","version"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13157297,"title":"How can i retrieve the version of Entity Framework in a WinForms application","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/7315127/how-to-get-current-ef-version\">How to get current EF version</a>  </p>\n</blockquote>\n\n\n\n<p>In my windows forms application, I want to display the Entity Framework version being used by the applications .edmx files. Is it possible to get the Entity Framework version from the app.config file or the .edmx file in C#?.</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13163061,"title":"A Form(?) appears briefly outside of Form1 when adding a control to it","body":"<p>I have a program which creates new <code>Control</code>s (actually - <code>Form</code>'s with <code>TopLevel = false</code>) and puts them on a <code>Panel</code> which is on <code>Form1</code>.</p>\n\n<p>For some reason, this is usually followed by what seems like a <code>Form</code> appearing very briefly <em>outside</em> of <code>Form1</code>. It's hard to tell exactly what's happening because it's so brief. Perhaps it's <code>Form1</code> moving there (and changing its size) and then returning. Or perhaps it's the <code>Form</code> that's being put on <code>Form1</code> that appears there (though how could that happen at all? It's out of <code>Form1</code>!).</p>\n\n<p>I couldn't find anything in the code that might cause it, and the whole code is way too long to post here. (The relevant code is simply: <code>MyPanel.Controls.Add(newForm);</code>.)</p>\n\n<p>Is there any known bug that might cause this?</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13150883,"title":"WinForms Event Parent scroll","body":"<p>I have two <code>FlowLayoutPanels</code> on a form: <code>PanelA</code> and <code>PanelB</code>. Each will be populated at run-time with multiple controls, such that the panel will scroll (i.e <code>AutoScroll</code> is true).</p>\n\n<p>Here's the issue: The controls that the panels are populated with each contain a <code>ComboBox</code>. Thus, <code>MouseWheel</code> events are consumed by the combo box instead of by the panel. I want <code>MouseWheel</code> events to be consumed by the panel.</p>\n\n<p>If there's no scrollable control on the child controls, then the <code>MouseWheel</code> event skips the child control (which doesn't handle it) and hits the panel, which does handle it. How can I set my child control's combo box to ignore the <code>MouseWheel</code> event? Can I tell it to re-raise the event?</p>\n\n<p>I tried just applying Focus to the Parent whenever one of the child controls ticks the 'MouseEnter' event; this fixed the scrolling issues, but also left the child controls completely un-editable.</p>\n\n<p>Something else I've found from digging around involves fiddling with the Windows API directly, but I find it hard to believe that something like that is required for this.</p>\n"},{"tags":["c#","winforms","datetimepicker"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2534,"score":1,"question_id":1846068,"title":"How to contol the time interval in a DateTimePicker","body":"<p>I have a <strong>DateTimePicker</strong> control on a form specified like so:</p>\n\n<pre><code>dtpEntry.Format = DateTimePickerFormat.Custom;\ndtpEntry.CustomFormat = \"dd/MM/yyyy hh:mm:ss\";\ndtpEntry.ShowUpDown = true;\n</code></pre>\n\n<p>I would like the user to only be able to increment or decrement the time by 5 minute increments.</p>\n\n<p>Any suggestions on how one would accomplish this?</p>\n"},{"tags":["c#",".net","winforms","multithreading"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13162782,"title":"Problems trying to pass events between threads","body":"<p>i need some clarifications about the multithreading programming model, becuase, rarely i have to deal with it (mostly all the time i do web-programming).</p>\n\n<h2>Antecedents</h2>\n\n<p>i have a program that i have made in C# basically it's a data monitor and execute pooling every specific ammount of time over the database, let's say 1 minute.</p>\n\n<p>How this application is relatively simple i decided use a monolithic structure,\ni made the all the GUI in range of classes, and i made an object that deals with the connection and data retrieving.</p>\n\n<p>to deal with the requeriment of the pooling time i used a <code>System.Timers.Timer</code>, which is basically a Thread wrapping with a firing timed event, here i executed the data pooling.</p>\n\n<p>When new data is found i need to fire a method in X class that belongs to the GUI (now running in the main thread) from the function triggered by the timer (in other thread by definition).</p>\n\n<p>the first time i tried to call the method directly to the method triggered by the timer, resulting in a cross-thread error: because the method resides in X class and was not contructed in the timer thread.</p>\n\n<p>Then i tried again using other approach. I created a event with his respective delegate in the class that read the data and subscribe the GUI objects to that event.  </p>\n\n<h2>Problem</h2>\n\n<p>now when i fire the event .net produces an exception saying me that the sender object instance is null, exactly don't know why, but i suspects that is because the object itself it's created with the GUI objects in the main thread and when i decide to send the object from the other thread (that it's generating the event), the instance simply doesn't exists because wasn't created there.</p>\n\n<p>This is the function called when the timer expires:</p>\n\n<pre><code>    private void PoolearMensajes(object Sender, ElapsedEventArgs e)\n    {\n        try\n        {\n            pRdr.getPendingMessages(); &lt;--- This function creates the exception\n            if (pRdr.MensajesPendientes &gt; 0)\n            {\n                this.oSysIcon.Text = pRdr.MensajesPendientes.ToString() + \" tickets pendientes\";\n                this.oSysIcon.BalloonTipIcon = ToolTipIcon.Info;\n                this.oSysIcon.BalloonTipText = pRdr.MensajesPendientes.ToString() + \" tickets pendientes\";\n                this.oSysIcon.BalloonTipTitle = \"Información\";\n                this.oSysIcon.ShowBalloonTip(3000);\n                System.Media.SystemSounds.Exclamation.Play();\n            }\n        }\n        catch (Exception ex)\n        {\n            this.oSysIcon.BalloonTipTitle = \"Error\";\n            this.oSysIcon.Text = \"Ha ocurrido un error.\";\n            this.oSysIcon.BalloonTipIcon = ToolTipIcon.Error;\n            this.oSysIcon.BalloonTipText = ex.Message;\n            this.oSysIcon.ShowBalloonTip(3000);\n            System.Media.SystemSounds.Exclamation.Play();\n        }\n    }\n</code></pre>\n\n<p>Here is the method resides in the data retriever object that was created in main thread:</p>\n\n<pre><code>    public delegate void TicketsFoundHandler(object sender, TicketEventArgs ta);\n    public event TicketsFoundHandler TicketsFound;\n\n    public void getPendingMessages()\n    {\n        string sSQL;\n        sSQL = \" an SQL Query that counts rows;\";\n        oCmd = new SqlCommand(sSQL, oConn);\n        oConn.Open();\n        this.i_pendmsg = (int)oCmd.ExecuteScalar();\n        if (this.i_pendmsg &gt; 0)\n        {\n            TicketEventArgs ta = new TicketEventArgs(\"\", this.i_pendmsg);\n            TicketsFound(this, ta); &lt;---- ERROR!\n        }\n        oConn.Close();\n    }\n</code></pre>\n\n<p>The Error message it's: <code>Object reference not set to an instance of an object</code>.</p>\n\n<p>any ideas , any improvements, or something i haven't cosidered ?</p>\n"},{"tags":["c#","winforms","forms","type-conversion","opacity"],"answer_count":13,"favorite_count":18,"up_vote_count":170,"down_vote_count":6,"view_count":10712,"score":164,"question_id":4,"title":"When setting a form's opacity should I use a decimal or double?","body":"<p>I'm new to C# and I want to use a track-bar to change a form's opacity.</p>\n\n<p>This is my code:</p>\n\n<pre><code>decimal trans = trackBar1.Value / 5000;\nthis.Opacity = trans;\n</code></pre>\n\n<p>When I try to build it, I get this error:</p>\n\n<blockquote>\n  <p>Cannot implicitly convert type 'decimal' to 'double'.</p>\n</blockquote>\n\n<p>I tried making <code>trans</code> a <code>double</code>, but then the control doesn't work. This code has worked fine for me in VB.NET in the past. </p>\n\n<p>What do I need to do differently?</p>\n"},{"tags":[".net","winforms","autoscroll"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13160098,"title":"Child control re-positioned on a auto scroll form when the control is shown","body":"<p>I have a form with <code>AutoScroll</code> set to true. Some controls on the form are invisible when the form starts, but their location is already set. Once the control turns visible, the position is calculated relative to current <code>AutoScrollPosition</code>, which is totally unwanted.</p>\n\n<p>Any idea how to prevent this?  </p>\n\n<p>I tried set the position when the control is first shown, as follows:</p>\n\n<pre><code> void OnControlVisibleChanged(object sender, EventArgs e)\n    {\n        Control ctl = (Control)sender;\n        if (ctl.Visible)\n        {\n            ctl.Location = Point.Add(ctl.Location, new Size(this.AutoScrollPosition));\n            ctl.VisibleChanged -= OnControlVisibleChanged;\n        }\n    }\n</code></pre>\n\n<p>It works for some controls, and for others not. I don't know why.<br>\nEDIT: it seems that when a control turns visible, the real AutoScrollPosition changes, but the <code>AutoScrollPosition</code> property is not updated immediately.</p>\n"},{"tags":["c#",".net","winforms","events","mouse"],"answer_count":3,"favorite_count":5,"up_vote_count":11,"down_vote_count":0,"view_count":7909,"score":11,"question_id":1161280,"title":"Parent Control Mouse Enter/Leave Events With Child Controls","body":"<p>I have a C# .NET 2.0 WinForms app.  My app has a control that is a container for two child controls: a label, and some kind of edit control.  You can think of it like this, where the outer box is the parent control:</p>\n\n<pre>\n+---------------------------------+ \n| [Label Control]  [Edit Control] |\n+---------------------------------+</pre>\n\n<p>I am trying to do something when the mouse enters or leaves the parent control, but I don't care if the mouse moves into one of its children.  I want a single flag to represent \"the mouse is somewhere inside the parent or children\" and \"the mouse has moved outside of the parent control bounds\".</p>\n\n<p>I've tried handling MouseEnter and MouseLeave on the parent and both child controls, but this means the action begins and ends multiple times as the mouse moves across the control.  In other words, I get this:</p>\n\n<pre>\nParent.OnMouseEnter      (start doing something)\nParent.OnMouseLeave      (stop)\nChild.OnMouseEnter       (start doing something)\nChild.OnMouseLeave       (stop)\nParent.OnMouseEnter      (start doing something)\nParent.OnMouseLeave      (stop)</pre>\n\n<p>The intermediate OnMouseLeave events cause some undesired effects as whatever I'm doing gets started and then stopped.  I want to avoid that.</p>\n\n<p>I don't want to capture the mouse as the parent gets the mouse over, because the child controls need their mouse events, and I want menu and other shortcut keys to work.</p>\n\n<p>Is there a way to do this inside the .NET framework?  Or do I need to use a Windows mouse hook?</p>\n"},{"tags":["c#","winforms","objectdisposedexception"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":13161115,"title":"\"Cannot access a disposed object\" when checking for IsDisposed and Disposing","body":"<p>When the application receives a call from the service, it opens a form for each call. The user must make his input in each window and the close it. In order to smooth the user's work I am trying to reactivate the window the user was working on when the next one is being shown.</p>\n\n<p>The method for doing this is below:</p>\n\n<pre><code>private void ActivatePreviousActiveForm() {\n\n    if (_activeWhenOpen != null &amp;&amp; _activeWhenOpen.InvokeRequired) {\n         if (!_activeWhenOpen.Disposing || !_activeWhenOpen.IsDisposed)\n              _activeWhenOpen.Invoke((MethodInvoker)ActivatePreviousActiveForm);\n    } else\n         if (_activeWhenOpen != null &amp;&amp; !(_activeWhenOpen is FrmRuntimeError))\n             _activeWhenOpen.Activate();\n}\n</code></pre>\n\n<p>Sometime it throws \"\"Cannot access a disposed object\" when reaching the line </p>\n\n<pre><code>if (!_activeWhenOpen.Disposing || !_activeWhenOpen.IsDisposed)\n</code></pre>\n\n<p>Does anyone know why this would happen?</p>\n"},{"tags":["c#","winforms","scrolling"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13160854,"title":"Custom scrolling in Winforms c#","body":"<p>I am developing an application that will use touch screens to navigate for use in a warehouse environment.</p>\n\n<p>There is a need to present a list to the users and because this list could be quite long, the user will at some point need to scroll down the list. </p>\n\n<p>As you all know the system scroll bars for panels and textboxes etc is quite small and I would like to know if I can either resize the controls that make up the scroll bar (the little arrows at the top and bottom, and the place holder bar in the scroll bar itself), or if I can create a couple of buttons that can scroll up and down my control for me?</p>\n\n<p>Thanks,\nKarl</p>\n"},{"tags":["c#","winforms","scrolling","toolstripitem","toolstripmenu"],"answer_count":1,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13139074,"title":"Mouse wheel scrolling Toolstrip menu items","body":"<p>I have some menus that contain many menuitems. Mouse wheel doesn't scroll them. I have to use the keyboard arrows or click the arrows at top and bottom.\nIs it possible to use the mouse wheel to scroll toolstrip menu items?\nThanks</p>\n"},{"tags":["winforms","datagridview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2616,"score":0,"question_id":5258587,"title":"Capturing Checkbox click event in Windows Forms DataGridview","body":"<p>I have a Winforms DataGridView in my application.</p>\n\n<p>I've two checkbox columns along with 5 other columns from the database. These two checkbox columns are added usng DataGridViewCheckBoxColumn.</p>\n\n<p>When the user clicks on the 2nd checkbox, I need to show a message to the user if the first checkbox is not checked for that row.</p>\n\n<p>How do I go about this?\nI tried this,but the cell value is coming as null.\nWhat am i doing wrong?</p>\n\n<pre><code>    private void dgTest_CellClick(System.Object sender, DataGridViewCellEventArgs e)\n    {\n    DataGridViewCheckBoxCell officialCbCell = row.Cells[1] as DataGridViewCheckBoxCell;\nDataGridViewCheckBoxCell includeCbCell = row.Cells[0] as DataGridViewCheckBoxCell;\n                    if (officialCbCell != null)\n                    {\n                        if (officialCbCell.Value != null &amp;&amp; (bool)officialCbCell.Value == true)\n                        {\n                            if (includeCbCell != null &amp;&amp; (bool)includeCbCell.Value == false)\n                            {\n                                MessageBox.Show(\"INVALID\");\n                            }\n                        }\n\n                    }\n    }\n</code></pre>\n\n<p>Thanks.</p>\n"},{"tags":["c#","winforms","image","panel","picturebox"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":13158625,"title":"Drawing a big number of images in C# Windows Forms","body":"<p>I'm creating a map editor for game in C# Windows Forms. What I need is a grid that will have to store even a few thousands of images. </p>\n\n<p>My first approach was to create a <code>Panel</code> control and then add multiple <code>PictureBoxes</code> to it. Unfortunately 2000 images took about 3 seconds to draw.</p>\n\n<p>Then I decided to try creating <code>Rectangles</code> and drawing <code>Images</code> on them in <code>Panel</code>'s <code>OnPaint()</code> method in hope to get better results but it's still very slow.</p>\n\n<p>Is there any better, efficient way to render so many images in Windows Forms?</p>\n\n<p>Thanks in advance for any advices.</p>\n"},{"tags":["vb.net","winforms","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13157569,"title":"Putting custom list in datagridview vb.net","body":"<p>I have following structure</p>\n\n<pre><code>matrix As Dictionary(Of String, Dictionary(Of Class1, Class2))\n</code></pre>\n\n<p>I would like to put all the elements of this structure in a datagridview like this:</p>\n\n<pre><code>Column1: String   | Column2: Class1.name     | column3: class2.name\n</code></pre>\n\n<p>Anyone have a clue on how to pull this off? I am new to datagridviews so have no clue on how to start adding rows and colums (maybe autogenerate the columns??)</p>\n"},{"tags":["windows","arrays","winforms","powershell"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13085332,"title":"Automatically Go to the next line of a multiline text box","body":"<p>I have a windows form into which im updating a text from powershell, just like a scripts progress status, im trying to auto move to a new line into the textbox but im unable to do that</p>\n\n<p>I tried [System.Environment]::NewLine but it did not work</p>\n\n<p><code>$nl = [System.Environment]::NewLine</code></p>\n\n<p><code>$i++</code></p>\n\n<p><code>$textbox1.Text = \"PS $i&gt; Running Script\"</code></p>\n\n<p><code>$textbox1.AppendText($nl)</code></p>\n\n<p><img src=\"http://i.stack.imgur.com/0jGbd.png\" alt=\"enter image description here\"></p>\n\n<p>Could Any of you guys helpe me out on how to move the cursor automatically to the next line\nMaybe Show </p>\n\n<p>PS2> Script Started</p>\n"},{"tags":["c#","winforms","visual-studio-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13150107,"title":"Visual Studio 2008 Stops Responding When Attempting to Extract Method","body":"<p>Every time I attempt to extract a method in Visual Studio 2008, the IDE stops responding and eventually crashes.  I do not get an error message upon crashing but, the error in the event log is below.  Anyone else ever have this issue?  I have refactored and extracted methods before without issues.  Nothing has been installed recently on my system.  I have also tried restarting Visual Studio and rebooting my machine without success.</p>\n\n<pre><code>The description for Event ID 0 from source devenv cannot be found. Either the component that raises this event is not installed on your local computer or the installation is corrupted. You can install or repair the component on the local computer.\n\nIf the event originated on another computer, the display information had to be saved with the event.\n\nThe following information was included with the event: \n\nThe data source '{130bada6-e128-423c-9d07-02e4734d45d4}' specifies no supporting providers or a set that are not registered.\n\nthe message resource is present but the message is not found in the string/message table\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13029819,"title":"How to change focus from the Combo Box drop down in windows form","body":"<p>I have created a Windows form in which I have taken a drop down combo box and certain fields. The value of the fields changes accordingly when any value is selected from the drop down. The problem I am facing is that I cannot click anywhere else in the windows form. The focus stays on with the ComboBox drop down. I have used other button like 'PRINT' which provides the facility of printing the information displayed in the win form. but I cannot click on it because of the focus that Is stuck onto the combo box. For the combo box, I have used the following Code:</p>\n\n<pre><code>private void btnPrint_Click(object sender, EventArgs e)\n    {\n        try\n        {\n            ExistingAccountScreen existingAcctScreen = new ExistingAccountScreen();\n            FillExistingAppForPrinting(existingAcctScreen);\n            using (PrintViewer pv=new PrintViewer(existingAcctScreen))\n            {\n                pv.ShowDialog();\n            }\n        }\n        catch (Exception ex)\n        {\n            AOTHelper.WriteLog(ex);\n        }\n    } \n</code></pre>\n\n<p>The drop down click event is as below which is creating a problem while selecting value other than the defult selected value</p>\n\n<pre><code>private void cmbAccountNumber_SelectedIndexChanged(object sender, EventArgs e)\n    {\n        ExistingAccountInfo acctInfo = cmbAccountNumber.SelectedItem as ExistingAccountInfo;\n        if (acctInfo == null)\n            return;\n        existingAccountInfoBindingSource.DataSource = ExistingAccountInfo.Get(acctInfo.AccountNumber);\n\n        accountStatusBindingSource.DataSource = ExistingAccountInfo.GetExistingStatusCodes(acctInfo.AccountNumber);\n    }\n</code></pre>\n"},{"tags":["c#",".net","winforms","multithreading","backgroundworker"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":13157886,"title":"Performing long running UI changes without blocking the main thread","body":"<p>Is there anyway to run a large number of UI updates without effecting the main thread in a C# winforms application?</p>\n\n<p>I would like to avoid a long delay when a user clicks a specific event (which in my case is many close form calls to dispose of memory) </p>\n\n<p>I know i can use <code>BackgroundWorker</code> to perform lengthy operations in the \"do work\" event, but the problem is that you cant change any UI in this event (it will cause a cross thread exception) - so i cant put my large number of close form calls here. </p>\n\n<p>And I cant put the close form calls in the \"worker completed\" event because this is run on the main thread, and will eventually lockup the main thread causing a bad user experience.</p>\n\n<p>I have thought about spawning a thread to handle closes only when the appication session is idle, but not sure if this is going to be a bit messy.</p>\n"},{"tags":["c#","winforms","listview"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":30,"score":-1,"question_id":13157126,"title":"Check and Control in Listview Selected Items in C#","body":"<p>I have a ListView and I want to choose by mouse only 3 items from the list and not to choose the same number twice.</p>\n\n<p>How can I do it?</p>\n"},{"tags":["c#","winforms","localization"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13128255,"title":"Change label text based upon CurrentUICulture","body":"<p>I've recently been tasked with localizing a small piece of software that my company created.  I've been able to create the resx file for the particular culture, and things are well and good.  Thing is, that there are roughly 50 or so labels/buttons/etc, that need to be changed. My question is, do I need to write in the code to set the text, or is there an easier way?  For instance,</p>\n\n<p><code>lblText.text = Resources.labelText</code></p>\n\n<p>for every single button/label.  Or is there a property in the button/label that I'm missing that would set it. Thanks.</p>\n"},{"tags":["database","winforms","visual-studio-2010","sql-server-2008-express"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13156966,"title":"SqlDataAdapter object in Visual Studio 2010","body":"<p>I am running <code>Visual Studio 2010</code> and <code>SQL Server 2008 Express</code> editions. I have created a database in SQL called <strong>Hangman.mdf</strong>. Then in <code>Visual Studio</code> I drag the <code>SqlDataAdapter</code> object to my form and it brings up the wizard, in the wizard under data source I select the <code>Microsoft SQL Server Database File</code> (SqlClient) and then browse to my <strong>Hangman.mdf</strong> file. When I click on test connection it throws out this error: </p>\n\n<pre><code>Unable to open physical file \"C:\\XXX\\Hangman.mdf\". Operating system error 5: \"5(Failed to retrieve text for this error. Reason: 15105)\" An attempt to attach an auto named database for file C:\\XXX\\Hangman.mdf failed. A database with the same name exists, or specified file cannot be opened, or it is located on UNC share.\n</code></pre>\n\n<p>I am running <code>Windows 8</code>, I have opened up <code>Visual Studio</code> and <code>SQL Server</code> as <code>Administrator</code>. </p>\n\n<p>I would appreciate any help.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","sql-server","winforms","tsql","smo"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":69,"score":3,"question_id":13090319,"title":"Could not load file or assembly 'Microsoft.SqlServer.Smo, Version=10.0.0","body":"<ul>\n<li>OS : Microsoft Windows NT 5.2.3790 Service Pack 2 Version: 2.0.50727.42 </li>\n</ul>\n\n<p>Doing: creating Tables... </p>\n\n<blockquote>\n  <p>Rec: system.m.FileNotFoundexception: could not load file or assembly\n  'microsoft.sqlserver.smo, version=10.0.0.0, culture=neutral File name:\n  'microsoft.sqlserver.smo, version=10.0.0.0, culture=neutral,\n  PublicKeyToken=89845dcd8080cc91' at\n  claimsure.Forml.Runsqlscript(string connstring, streamReader sr) at\n  myapp.Forml.bw_Dowork(object sender, DoworkeventArgs e) 'MN: Assembly\n  binding logging is turned OFF. To enable assembly bind failure\n  logging, set the registry value\n  (NKLm\\software\\microsoft\\Fusion!enableLog] (DwoRD) to 1. Note: There\n  is some performance penalty associated with assembly bind failure\n  logging. To turn this feature off, remove the registry value\n  (NKLm\\software\\microsoft\\Fusion!enableLog).</p>\n</blockquote>\n\n<p>I get the above error when running my application on a Windows 2003 server with SQL Server 2005.</p>\n\n<p>I know there is a solution to download SQLServer2005_XMO from <a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=24793\" rel=\"nofollow\">http://www.microsoft.com/en-us/download/details.aspx?id=24793</a></p>\n\n<p>I have done this, but after the install a server reboot is required, which is not feasible for the time being. </p>\n\n<p>I need to make use of the server object.</p>\n\n<pre><code> using Microsoft.SqlServer.Management.Smo;\n using Microsoft.SqlServer.Management.Common;  \n\n        using (SqlConnection connection = new SqlConnection(connString))\n        {\n            Server server = new Server(new ServerConnection(connection));\n            server.ConnectionContext.StatementTimeout = 2400;\n            server.ConnectionContext.ExecuteNonQuery(sqlString);\n\n        }\n</code></pre>\n\n<p>Is is possible to load the dll in the same directory as my app and reference it from within the code? </p>\n\n<p>Thanks.    </p>\n\n<p>edit: added full error</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":46,"score":-3,"question_id":13156639,"title":"4 x 4 Board Design in Windows Form","body":"<p>I just need a little bit help in windows form. I'm just want to design a 4 x 4 board in windows form as shown below.\nThanks<img src=\"http://i.stack.imgur.com/9HWTR.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","winforms","datatable"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":76,"score":1,"question_id":13139486,"title":"C# shorten datatable function","body":"<p>Using MS Visual Studio 2012 Express, Using C#.NET 4.0.</p>\n\n<p>Hi guys, This I believe is a simple one.</p>\n\n<p>I've been rushing a program at the request of my boss, But now it turns out that I have a lot more free time on it.</p>\n\n<p>So I'm going through the code trying to make it more compact, cleaner etc.</p>\n\n<p>I have this one function.....</p>\n\n<pre><code>public void RunMonth()\n{\n    //** top 10 listings*********************//            \n    SetTxtBox1(DateTime.Now.ToString() + \" ==== END OF MONTH REPORTS starting.........\\r\\n\");\n    SetTxtBox1(\" **************************************************************************************\\r\\n\");\n    try\n    {\n        VRMtableDESC = querys.TopVRM(\"DESC\");\n        SetTxtBox1(DateTime.Now.ToString() + \" ==== VRM Top has been loaded\\r\\n\");\n    }\n    catch\n    {\n        SetTxtBox1(DateTime.Now.ToString() + \" ==== VRM Top has FAILED\\r\\n\");\n    }\n}\n</code></pre>\n\n<p>\"VRMtableDESC\" is a datatable, one of around 18 datatables. for each datatable this try statement is run.</p>\n\n<p>Now as you can tell this currently is repeated 18 times for every table.\ninstead i would like to loop into the tables instead and fill them with there data.</p>\n\n<p>is there a way to do this? i would need some sort of collection for the datatables and the query.function calls too as far as I'm aware.</p>\n\n<p>So far i have hit a blank so im hoping there is something im missing.</p>\n\n<p>Thanks in Advance</p>\n\n<p>::::UPDATE::::\nOk so I have this set up so far....</p>\n\n<pre><code> foreach (DataTable tbl in MyDataSet.Tables)\n {\n     tbl.TableName.Equals(querys.TopVRM(\"\"));\n }\n</code></pre>\n\n<p>the equals method needs to be dynamic in its method selection too.... any ideas?</p>\n\n<p>::UPDATE(31/10/12)::</p>\n\n<p>Hi again, Im getting an error, the common error \" object not sent to instance of object\"</p>\n\n<p>it apears on the merge in the foreach loop.</p>\n\n<p>I have debugged my query call and looks fine.</p>\n\n<pre><code> var tables = new SortedDictionary&lt;string, Func&lt;DataTable&gt;&gt;()\n        {\n            {\"VRMtableDESC\",  () =&gt; querys.TopVRM(\"DESC\")},\n            {\"VRMtableASC\",   () =&gt; querys.BotVRM(\"ASC\")},\n            {\"SpectableDESC\", () =&gt; querys.TopSpec(\"DESC\")},\n            {\"SpectableASC\",  () =&gt; querys.botSpec(\"ASC\")},\n            {\"ParttableDESC\", () =&gt; querys.TopPart(\"DESC\")},\n            {\"ParttableASC\", () =&gt; querys.BotPart(\"ASC\")},\n            {\"MantableDESC\",  () =&gt; querys.TopManual(\"DESC\")},\n            {\"MantableASC\",   () =&gt; querys.BotMan(\"ASC\")}, //why is this first to run?????\n            {\"UsersLockedTbl\",() =&gt; querys.UserLocked()},\n            {\"NewUsersTbl\",   () =&gt; querys.NewUsers()},\n\n            {\"VRMtotaltblTOP\",   () =&gt; querys.VRMtotalTOP(\"\")},\n            {\"PARTtotaltblTOP\",  () =&gt; querys.PARTtotalTOP(\"\")},\n            {\"SPECtotaltblTOP\",  () =&gt; querys.SPECtotalTOP(\"\")},\n            {\"MANtotaltblTOP\",   () =&gt; querys.MANtotalTOP(\"\")},\n            {\"VRMtotaltblBOT\",   () =&gt; querys.VRMtotalBOT(\"\")},\n            {\"PARTtotaltblBOT\",  () =&gt; querys.PARTtotalBOT(\"\")},\n            {\"SPECtotaltblBOT\",  () =&gt; querys.SPECtotalBOT(\"\")},\n            {\"MANtotaltblBOT\",   () =&gt; querys.MANtotalBOT(\"\")},\n        };\n\n        foreach(var kvp in tables)\n        {\n            try\n            {\n                MyDataSet.Tables[kvp.Key].Merge(kvp.Value());//error occurs here\n                SetTxtBox1(String.Format(\"{0} ==== {1} has been Loaded\\r\\n\", DateTime.Now.ToString(), kvp.Key));\n            }catch(Exception e)\n            {\n                SetTxtBox1(String.Format(\"{0} ==== {1} has FAILED\\r\\n\", DateTime.Now.ToString(), kvp.Key));\n                MessageBox.Show(\"error:::\" + e);\n            }\n        }\n        AutoRunApp();  \n</code></pre>\n\n<p>any help would be great.</p>\n\n<p>UPDATE::</p>\n\n<p>heres my query call from the \"bunchofquerys\" class</p>\n\n<pre><code> public DataTable BotMan(string order)\n    {\n\n            SqlConnection conn = new SqlConnection(myConnString32);\n            SqlCommand vrm = new SqlCommand();\n            //BindingSource bindme = new BindingSource();\n            SqlDataAdapter adapt1 = new SqlDataAdapter(vrm);\n           // DataSet dataSet1 = new DataSet();\n            DataTable table1 = new DataTable();\n            try\n            {\n            vrm.Connection = conn;\n            vrm.CommandType = CommandType.StoredProcedure;\n            if (order.Equals(\"DESC\"))\n            {\n                vrm.CommandText = \"dbo.TopManual\";\n            }\n            vrm.CommandText = \"dbo.BotManual\";\n            vrm.CommandTimeout = 360;\n\n            vrm.Parameters.AddWithValue(\"@OrderBy\", order);\n            adapt1.Fill(table1);\n            return table1;\n        }\n        catch (Exception e)\n        {\n            MessageBox.Show(\"eeror::zomg:::  \" + e);\n\n        }\n        return table1;\n    }\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":477,"score":0,"question_id":1292694,"title":"Value of tag property disapears","body":"<p>I'm busy with a simple application. It reads xml and puts the information in a treeview. </p>\n\n<p>I do this by creating TreeNodes and nest them, and finaly, return the root treenode. Because I want to show some extra information when a treenode is selected, I put the information in the tag property of the TreeNode. In this way, I should be able to retrieve the information when the node is selected.</p>\n\n<p>But when I try to retrieve the information in the Tag property, it says the value = null.</p>\n\n<p>Here is the code where I fill the tag. This is in a function which is recursively used to read the XML dom. treeNode is a paramater given to this function.</p>\n\n<pre><code>if (treeNode.Tag == null)\n{\ntreeNode.Tag = new List&lt;AttributePair&gt;();\n}\n(treeNode.Tag as List&lt;AttributePair&gt;).Add(new AttributePair(currentNode.Name, currentNode.Value));\n</code></pre>\n\n<p>This is the event where a treenode is selected</p>\n\n<pre><code>private void tvXML_AfterSelect(object sender, TreeViewEventArgs e)\n{\n    if (tvXML.SelectedNode.Tag != null)\n    {\n    }\n    if (e.Node.Tag != null)\n    {\n    }\n}\n</code></pre>\n\n<p>Both values evaluate to null. How can I solve this problem?</p>\n"},{"tags":["winforms","data-binding","datagridview"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":330,"score":0,"question_id":7807978,"title":"DataBinding error -DataGridView in Winforms","body":"<p>I'm new to VB.NET, Windows Application, and DataGridView.\nThis is a very basic error which I'm suffering now. I have a stored procedure to retrieve  data from the database. I stored those data in a DataSet and tried to view it in a DataGridView. I used this code for databinding which is throwing the error:</p>\n\n<pre><code>DataGridView1.DataSource=ds\n\nDataGridView1.DataBindings()\n</code></pre>\n\n<p>The second line in the code is throwing an error: </p>\n\n<p><code>Property access must assign to the property or use its value.</code></p>\n\n<p>How can I solve this?</p>\n"},{"tags":["c#","winforms","webbrowser-control"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1996,"score":3,"question_id":878878,"title":"WebBrowser control won't print from C#","body":"<p>I've got a WebBrowser control on a WinForms app that is loading XML which is converted to HTML/CSS. Looks beautiful if I just want to view it there or in a regular browser. </p>\n\n<p>When the form loads, it's supposed to navigate to the file, then when the OnDocumentCompleted event fires, it should set the header, footer, and default printer name in the registry, then call Print() for however many copies the user has specified.</p>\n\n<p>I've run it through the debugger, and it's calling webBrowser.Print() the correct number of times in the OnDocumentCompleted event. Nothing is null that shouldn't be, Visible is true on the WebBrowser control, as is AllowNavigation. And yes, the printer is turned on and reachable over the network. The exact same code works elsewhere in the project, but not here.</p>\n\n<p>What else could be causing this hellish control to ignore my Print commands?</p>\n\n<p>Ideally, I'd like the whole thing to be hidden off-screen, as this is meant to run using Windows Scheduler, and the users should never see it. I've read that the control needs to be visible, though, so until I work out this first kink, that can wait.</p>\n\n<p><strong>EDIT</strong>: The last two lines of my OnDocumentCompleted event handler set the DialogResult to OK and closed the form. Removing the call to Close() let it print, so I'm guessing it didn't get to the print spooler before the form was closed and the WebBrowser control was disposed.</p>\n\n<p>Short of just setting an arbitrary time limit to wait before closing, is there any way to tell when it is done printing?</p>\n"},{"tags":["c#","winforms","printing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13155753,"title":"printing to exact coordinates to A4 paper in c#","body":"<p>i am programming in c#(WinForm).<br>\ni have a answer sheet like in picture<br>\n<img src=\"http://i.stack.imgur.com/U2uh9.jpg\" alt=\"enter image description here\"></p>\n\n<p>and i want to fill the circles programmaticaly.<br>\nThere are some informations of students in the database.<br>\nInformations are - Student Name, Surname, Class, Group, Student Id and etc.<br>\nfor this i use gdi funcions.<br>\ni read student info from database and then define circle coordinates on the paper,<br>\nafter that i print it. But every time circles shift left, right,or bottom. \nwhat is the problem. may be problem is in the printer.<br>\ni use laser printer - Canon i-sensys mf 4410.   </p>\n\n<p>Please help me. \nThanks.</p>\n"},{"tags":["c#","winforms","visual-studio-2010"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13154911,"title":"Line Winform Control on Visual Studio Options","body":"<p>The objective is to imitate an options page on visual studio.\nThe options page is Tools->Options->TextEditor->C++->General (say). </p>\n\n<p>But I cannot get what control is the 'Line' against section headings. Check in the screenshot for the one highlighted by an arrow.</p>\n\n<p><img src=\"http://i.stack.imgur.com/mwW8Q.png\" alt=\"Visual Studio Options Page\"></p>\n\n<p>I have tried the LineShape, Panel etc, but none look as such.</p>\n\n<p>What control is that?\nOr how do I imitate it if we do not have such a predefined control?</p>\n"},{"tags":["c#","winforms",".net-3.5","windows-xp","icons"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13154607,"title":"Why does Windows XP in best performance mode shows wrong icon for a split second?","body":"<p>In the last version of our software we changed the icon used everywhere in the application.\nThis because the corporate identity changed and the old green icon needed to change to the new red icon.</p>\n\n<p>What I did to change it:</p>\n\n<ul>\n<li>Use the new icon in the Application settings of the startup project.</li>\n<li>Use the new icon on all the forms (only changed 1 form because all others inherit from this one).</li>\n</ul>\n\n<p>Everything works perfect accept for Windows XP in Best Performance mode (right click Computer, Properties, Advanced, Presentation settings).</p>\n\n<p>When starting the application it shows the Login screen in the taskbar with the old icon which changes in the new icon within a split second. Of course; the slower the machine, the longer the old icon is visible.</p>\n\n<p>Seems to me it has something to do with caching of the old icon.</p>\n\n<p>Does anyone know why this is happening or how to fix it?</p>\n"},{"tags":["c#","winforms","multithreading","signalr"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13154171,"title":"How to show a windows from in a SignalR callback method?","body":"<p>I am working on a simple chat application that uses SignalR for its communication.\nI want to show a MessageForm whenever a private message is received from another user.\nThe problem is , the callback method is running on a different thread and it seems that there's a problem merging the new form loop with the main form,thus the application hangs \nHere's my callback method :</p>\n\n<pre><code>private void MessageReceived(object sender, Client.MessageEventArgs args)\n    {\n        var form = new MessageForm();\n        form.MessageReceived(sender,args);\n        form.Show();\n    }\n</code></pre>\n\n<p>So the question is how I can create the form so that it uses the main form loop ?</p>\n"},{"tags":["c#","winforms","multithreading","cross-threading"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13152075,"title":"Multithreading in C# - Update Labels","body":"<p>So I have 3 labels and have to update all three of them at the same time using a random number until the user clicks a button that stops it.</p>\n\n<p>This is what I have on my start button</p>\n\n<pre><code>private void start_Click(object sender, EventArgs e)\n{\n        t1 = new Thread(new ThreadStart(FirstNumber));\n        t2 = new Thread(new ThreadStart(SecondNumber));\n        t3 = new Thread(new ThreadStart(ThirdNumber));\n\n        t1.Start();\n        t2.Start();\n        t3.Start();\n}\n</code></pre>\n\n<p>This is what the methods that generate the random numbers look like</p>\n\n<pre><code>public void FirstNumber()\n{\n        int j = r.Next(0, 50);\n        int k = r.Next(50, 100);\n        for (int i = j; i &lt;= k; i++)\n        {\n            number1.Text = i.ToString();\n            Thread.Sleep(200);\n        }\n}\n</code></pre>\n\n<p>When I debug I get the following error:</p>\n\n<blockquote>\n  <p>Cross-thread operation not valid: Control 'number2' accessed from a thread other than the thread it was created on.</p>\n</blockquote>\n\n<p>I don't understand how I am meant to create controls for each thread, so any help is appreciated. </p>\n\n<p>One more thing, will the user be able to click the stop button while the labels are being updated? Or do I need to add another thread that waits for the user input?</p>\n\n<p>Thanks a lot!</p>\n"},{"tags":["winforms","localization","visual-studio-express"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13153992,"title":"Localizing winforms in visual-studio-2012 express","body":"<p>I have a application previously developed in Visual Studio Express 2010. It uses localized winforms and resx resources used in code.</p>\n\n<p>When the project is opened and compiled using Visual Studio Express 2012 on the same computer the localized strings are not applied, only the default code was found.</p>\n\n<p>The application runs fine and in the winforms designer I can change language to see and edit the localized text of the controls.\nI also tried the following code to determine if the languages used were there at runtime, which did report the ones used.</p>\n\n<pre><code>        CultureInfo[] cultures = CultureInfo.GetCultures(CultureTypes.AllCultures);\n        foreach (CultureInfo culture in cultures)\n        {\n            try\n            {\n                ResourceSet rs = resources.GetResourceSet(culture, true, false);\n                // or ResourceSet rs = rm.GetResourceSet(new CultureInfo(culture.TwoLetterISOLanguageName), true, false);\n                if (rs == null)\n                    continue;\n                string isSupported = (rs == null) ? \" is not supported\" : \" is supported\";\n                Console.WriteLine(culture + isSupported);\n            }\n            catch (Exception)\n            {\n                Console.WriteLine(culture + \" is not available on the machine or is an invalid culture identifier.\");\n            }\n        }\n</code></pre>\n\n<p>Still when the application is running all I get is the resources for the default language.</p>\n\n<p>I retrieve the resources using:</p>\n\n<pre><code>        ResourceManager resources = new ResourceManager(form.GetType());\n        form.Text = resources.GetString(\"$this.Text\", lang);\n</code></pre>\n\n<p>where I have verified that lang is correct, but also using</p>\n\n<pre><code>        System.Threading.Thread.CurrentThread.CurrentUICulture = lang;\n        System.Threading.Thread.CurrentThread.CurrentCulture = CultureInfo.CreateSpecificCulture(lang.Name);\n</code></pre>\n\n<p>followed by usage of MyLangResxFile.MyStringResource.\nThe strings returned are still only the default ones.</p>\n\n<p>Might there be changes or limitations in resx localization support between Visual Studio Express 2010 - 2012?</p>\n\n<p><strong>Update:</strong>\nI noticed that the localisation works if compiled using msbuild.exe from 3.5 but when using 4.0... the localisations are missing as described above.</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":78,"score":1,"question_id":12010543,"title":"How to get the values in all rows of a particular ListView column?","body":"<p>I have a <code>ListView</code> with three columns and I have added 4 records in the <code>ListView</code>.\nI would like to get the value of the 2<sup>nd</sup> column value of each record. How to implement it?</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13115181,"title":"User Interface become much slower and even crashed for long running time","body":"<p>I am using .Net 4.0 and VS2010.</p>\n\n<p>My program is simply a multi-threaded get request sender which update a bindingList and display the list via DataGridView. The datagridview is in virtual mode. Moreover, I make a textbox and status bar to display the status of requests, one request normally adds 4-5 lines to the textbox and changes the number in the status bar.</p>\n\n<p>The workload remains the same, one request per two seconds. The request is fast and only one request is standing out most of the time. New request thread is called by the last old request thread. The UI is updated a few times per thread using begininvoke and delegate.</p>\n\n<pre><code>MyInvoke mi = new MyInvoke(change);\nthis.BeginInvoke(mi, new Object[] { true, \"Row \" + pos + \" standing by...\", (pos + 1),0 });\n</code></pre>\n\n<p>I display the whole 3000 requests on the datagridview at the beginning with memory usage 30MB. When the 2XXX request is reached with memory usage 4XMB, I can see the status bar number and textbox updated slower and slower. For example, 2000->2001->2002->2003 becomes 2000->2003. </p>\n\n<p>If I select the application window, sometimes the whole UI would even freeze. My datagridview is fixed on a few rows with virtual mode. I believe it is the problems of the UI thread. When it freezes, I can wait until all requests are done and everything becomes smooth again.</p>\n\n<p>Any thoughts on what is happening?</p>\n"},{"tags":["c#","winforms","mdi"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":84,"score":2,"question_id":13152415,"title":"Run a child form process from parent in c#","body":"<p>I want to run a MDI child form its parent. For example I have 3 textboxes in the child form. I want to add the two values in the first two text boxes and write the results in the third. I want to have a button on the parent form (lets call it run button) to do this for me. Also, I have other child forms that do other calculations so I want the run button behaves according to the focused form. Does any one know how I should do it?</p>\n\n<p>I have written a method in each child form to do the calculations and I call this method in the run button of the parent form but this does not recognize the values of child form text boxes (ie null). It would be awesome if someone could help me.</p>\n\n<p>Thanks</p>\n\n<p>the code is very simple\nI have three text boxes in the child form and the user input values in the first two and I want to click the run button on the parent form and the value of the third text box in the child form becomes the summation of the values of the first two text boxes. I have this method in the child form which I can call it from the parent form but it does not work</p>\n\n<pre><code>public void AddValues()\n        {\n            double a = double.Parse(textBox1.Text);\n            double b = double.Parse(textBox2.Text);\n            textBox3.Text = (a + b).ToString();\n        }\n</code></pre>\n\n<p>In the parent form I have</p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n        {\n            ChildFrom child = new ChildFrom();\n            child.AddValues();\n        }\n</code></pre>\n"},{"tags":["c#","winforms","picturebox","windows-applications"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13151319,"title":"Loading image in picturebox from database","body":"<p>i've tried the following code for loading an image in picturebox from database. but everytime , i get an error like '<strong><code>paramater is  not valid</code></strong>'.</p>\n\n<pre><code>buttonSave()\n            {\n                .......\n                .......\n                img = Image.FromFile(strFileName);\n                byte[] byteImg = ImageToByteArray(img);\n                objEmp.Picture = byteImg;\n                .......\n                .......\n            } \n\npublic byte[] ImageToByteArray(Image img)\n        {\n            System.IO.MemoryStream ms = new System.IO.MemoryStream();\n            img.Save(ms, System.Drawing.Imaging.ImageFormat.Jpeg);\n            return ms.ToArray();\n        }  \n\nDisplay()\n       { \n           .......\n           .......\n           Byte[] bytePicData = (Byte[])dt.Rows[0][\"PICTURE\"];                \n           MemoryStream stmPicData = new MemoryStream(bytePicData);\n           PicBox.Image = Bitmap.FromStream(stmPicData);} \n           .......\n           .......\n      }\n</code></pre>\n"},{"tags":["c#","winforms","sql-server-2008"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":105,"score":0,"question_id":11638307,"title":"Single application multiple users through thin client","body":"<p>I have an application built in c# Winforms. In the back end I am using SQL Server 2008 Express. And I am using the application remotely through thin clients. My operating system is Windows server 2008.</p>\n\n<p>My problem is that when one user is using my software, if a 2nd user opens the software and tries to make any operation with the database, the database refuses to connect with the error </p>\n\n<blockquote>\n  <p>Cannot open the database 'database name' specified by login. Login\n  failed. Login failed for user \\windows username`.</p>\n</blockquote>\n\n<p>If the first user closes the application, then the second user can easily operate the database queries.</p>\n\n<p>Please help!!!</p>\n"},{"tags":["c#","winforms","windows-applications"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13152132,"title":"windows application data source last gray line","body":"<p>I am facing a problem in window application in datagridview, when I insert a record in gridview and then bind gridview then its take an empty gray row automatically.</p>\n\n<p>And when gridview paging is implemented, (here my page size of per page is 15) The empty row shows in next page. See example in image below - here I display 29 record in gridview then it works fine but when I display 30 record then an empty space adds automatically.  </p>\n\n<pre><code>                DataSet data = objAllDetail.GetAllInformation();\n                dataDashBoardGridView.AllowUserToAddRows = false;\n                dataDashBoardGridView.DataSource = data.Tables[0].DefaultView;\n</code></pre>\n\n<p>I am tried some thing like this:\n<a href=\"http://www.daniweb.com/software-development/csharp/threads/199956/removing-empty-row-displayed-at-the-end-of-datagridview-automatically\" rel=\"nofollow\">http://www.daniweb.com/software-development/csharp/threads/199956/removing-empty-row-displayed-at-the-end-of-datagridview-automatically</a></p>\n\n<p>The Image:</p>\n\n<p><img src=\"http://i.stack.imgur.com/VwOSm.png\" alt=\"screenshot showing the issue\"></p>\n"},{"tags":["c#","winforms","visual-studio-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13151608,"title":"How to set font color for a particular column in list view?","body":"<p>How to set font color for a particular column in list view?\nI have two columns in listview, and I want to set the font in 2nd column to red color.</p>\n"},{"tags":["c#","winforms","fonts","antialiasing"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13151781,"title":"Disabling antialias rendering for a label","body":"<p>I have a C# Winform application and on my form I have a Label control. Is there a way I can disable antialiasing rendering just for that label? I am using a barcode font and the antialiasing on the black and white font is adding color to the font.</p>\n"},{"tags":["c#","winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13151624,"title":"PaintEventHandler","body":"<p>how to use a button execute PaintEventHandler function after getting data from serial port in a period of time.</p>\n\n<pre><code>private void draw(object sender, PaintEventArgs e)\n{\n    OnTimedEvent(sender, e);\n\n    Graphics g = this.CreateGraphics();\n\n    Pen red = new Pen(Color.Red, 2);\n    Pen blue = new Pen(Color.Blue, 2);\n    g.TranslateTransform(500, 250);\n\n    for (int i = 0; i &lt;= distance.Length - 1; i++)\n    {\n        for (int j = 0; j &lt;= distance[i]; j++)\n        {\n            g.DrawEllipse(red, j, 0, 2, 2);\n        }\n        g.TranslateTransform(distance[i], 0);\n        g.RotateTransform(angle[i]);\n    }\n }\n</code></pre>\n\n<p>please help me.</p>\n"},{"tags":["c#",".net","winforms","usercontrols","mvp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13151102,"title":"User controls in winform application with mvp pattern","body":"<p>I'm developing winform application using MVP pattern. There are some user controls in my application which were created before. My question is: should I use MVP inside these controls? That is, do I have alter thier? </p>\n"},{"tags":["c#","winforms",".net-3.5","textbox"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":7406,"score":1,"question_id":5853073,"title":"Change the Textbox height?","body":"<p><strong>How do I change the height of a textbox ?</strong></p>\n\n<p>Neither of the below work:</p>\n\n<pre><code>this.TextBox1.Size = new System.Drawing.Size(173, 100);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>this.TextBox1.Size.Height = 100;\n</code></pre>\n\n<p>I wanted to be able to change the single line text box height to fit a font size on it without using multi-line if possible.</p>\n"},{"tags":["c#","winforms","treeview"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1674,"score":3,"question_id":161378,"title":"TreeView + sign","body":"<p>I have treeview with 1 main node and several sub-nodes, </p>\n\n<p>How can I hide the + sign in the main node?</p>\n\n<p>Thanks,</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13150324,"title":"disabling button after clicking it","body":"<p>i have here 3 buttons.</p>\n\n<p>when i click on the button 1, it will disable button 1 then  enable the second button,  then same proces as it reach the last button. but i think there is something wrong with my code. it doesn't disable when i click on the first button  </p>\n\n<p>button1 is enabled and button2 and 3 is disabled when it loads.</p>\n\n<pre><code>private void groupBox1_Enter(object sender, EventArgs e)\n{\n    Button btn = sender as Button;\n\n    if (btn == button1)\n    {\n        button1.Enabled = false;\n        button2.Enabled = true;\n        button3.Visible = false;\n        button3.Enabled = false;\n        MessageBox.Show(\"button 1 disabled\");\n    }\n    else if (btn == button2)\n    {\n        button1.Enabled = false;\n        button2.Enabled = false;\n        button3.Visible = true;\n        button3.Visible = true;\n        MessageBox.Show(\"button 2 disabled\");\n    }\n    else if (btn == button3)\n    {\n        button1.Enabled = false;\n        button2.Enabled = false;\n        button3.Visible = false;\n        button3.Visible = false;\n        MessageBox.Show(\"button 3 disabled\");\n    }\n}\n</code></pre>\n"},{"tags":["vb.net","winforms","visual-studio","parameters"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13147031,"title":"Passing two similar forms as the same type and still being able to access its objects","body":"<p>I am trying to implement another form into already complete routine.  Basically all the code is there, all I need to do is manipulate the data in a different manner. </p>\n\n<p>I have a routine that looks like this for instance.\nThis is a paraphrase example:</p>\n\n<pre><code>Private Sub getReportValues(ByRef fr As frmCustomReport, ByRef ReportInfo As ReportValues)\n            ReportInfo.eHeaderColor = Microsoft.Win32.Registry.CurrentUser.CreateSubKey(\"Software\\FE Jupiter\\MSSMonitor\").GetValue(\"Report Equipment Header Color\", \"DCDCDC\") 'Gainsboro\n            ReportInfo.mHeaderColor = Microsoft.Win32.Registry.CurrentUser.CreateSubKey(\"Software\\FE Jupiter\\MSSMonitor\").GetValue(\"Report Monitor Header Color\", \"FFF8DC\")   'Cornsilk\n\nfr.btnEquipColor.PickedColor = System.Drawing.ColorTranslator.FromHtml(\"#\" &amp; Microsoft.VisualBasic.Conversion.Hex(\"&amp;HFF\" &amp; ReportInfo.eHeaderColor))\n</code></pre>\n\n<p>The problem lays with the (fr as frmCustomReport) I want to make it a system.windows.forms.form but then I would lose the ability to use its objects. I should also mention that fr is a modal dialog and that I don't want a really hacky controlcollection work around for this. Does anyone have a good direction on this?</p>\n\n<p>Note Also!!! The controls I want to access on both forms are almost identical. The only diffrence is layout and some added functionality. </p>\n"},{"tags":["vb.net","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":5876,"score":1,"question_id":4673950,"title":"loop over all textboxes in a form, including those inside a groupbox","body":"<p>I have several textboxes in a winform, some of them are inside a groupbox. I tried to loop over all textboxes in my form:</p>\n\n<pre><code>For Each c As Control In Me.Controls\n    If c.GetType Is GetType(TextBox) Then\n        ' Do something\n    End If\nNext\n</code></pre>\n\n<p>But it seemed to skip those inside the groupbox and loop only over the other textboxes of the form. So I added another For Each loop for the groupbox textboxes:</p>\n\n<pre><code>For Each c As Control In GroupBox1.Controls\n    If c.GetType Is GetType(TextBox) Then\n        ' Do something\n    End If\nNext\n</code></pre>\n\n<p>I wonder: is there a way to loop over all textboxes in a form--including those inside a groupbox--with a single For Each loop? Or any better/more elegant way to do it?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":108,"score":3,"question_id":13147878,"title":"Is what I'm seeing a real memory leak?","body":"<p>I'm writing an application where after a user uses it - he can 'reset' it and use it again. The actual use creates some objects including Controls.</p>\n\n<p>I checked the memory usage using Process Explorer and discovered that when the app is used - there's a rise in memory-use, but when the app is 'reset' - the memory-use hardly goes down.</p>\n\n<p>So at the 'reset' I <code>Dispose</code> of all of the <code>Control</code>s recursively, and even added a <code>GC.Collect();</code> to boot. But <code>Process Explorer -&gt; (app's-) Properties -&gt; .Net CLR Memory</code> still shows lots of stuff on the heaps and lots of memory used.</p>\n\n<p>Is this (necessarily) a memory leak? And how come the forced GC doesn't help?</p>\n\n<p>EDIT:</p>\n\n<p>I added the <code>GC.Collect();</code> just for debugging - for determining if there is a leak. I'm not worried about a 'temporary leak' until the GC works, I'm just trying to find if there are objects that never go out of scope (though I haven't found them yet) or if it's just a matter of time, and the memory will be reclaimed.</p>\n"},{"tags":["c#","winforms","refactoring","add-in"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13147098,"title":"Windows Form wont close properly","body":"<p>I am developing an add-in for outlook 2010.<br>\nBasically, I have a button on my ribbon that takes the selected email, and saves it to a text file.  If the email contains a certain subject then the save is done automatically to a hard coded file path.  If not, a windows form is opened asking the user to enter a filepath.</p>\n\n<p>When the user has selected a path, and clicked 'OK' the save takes place and then the form closes... but then it re-opens... it seems to be creating a new instance of it or something... if I click 'Cancel' or 'X' it closes, but I can't see why it's not closing properly the first time.</p>\n\n<p>Below is my code</p>\n\n<pre><code>//This is myRibbon.cs\nprivate void btn_SaveFile_Click(object sender, RibbonControlEventArgs e) \n{\n   //other code\n   if (subject = \"xyz\") \n   {\n      //other code\n      textFile.Save();\n   }\n   else\n   {\n      MyPopup popup = new MyPopup();\n      popup.ShowDialog();\n   }\n}\n\n//This is MyPopup.cs\nprivate void btnOK_Click(object sender, EventArgs e) \n{\n   var filePath = txtFilePath.Text;\n   if (!string.IsNullOrWhiteSpace(filePath)) \n   { \n       SaveEmailToText(filePath); \n      this.Close(); \n   }\n   else \n   { //show message box with error }\n   this.Close(); \n}\n\nprivate static void SaveEmailToText(string filePath) \n{\n    //other code\n    textFile.Save();\n}\n</code></pre>\n\n<p>I have simplified this quite a bit so its easier to read.\nAny help would be greatly appreciated.</p>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13146469,"title":"Inheritance from TextBoxBase","body":"<p>I'm working on a library (.dll) file, and I want to create a little custom TextBox called FatherTextBox, so I started by deriving from TextBoxBase (an abstract class).</p>\n\n<p>After coding the custom logic, I noticed that I get this error message:</p>\n\n<pre><code>The type 'System.Windows.Forms.TextBoxBase' has no constructors defined\n</code></pre>\n\n<p>So I guess this is not a option:</p>\n\n<pre><code>    public FatherTextBox() : base()\n    {\n\n    }\n</code></pre>\n\n<p>My questions are:</p>\n\n<ol>\n<li>What is the way to inherit from an abstract class without a constructor?</li>\n<li>Why doesn't TextBoxBase have a constructor?</li>\n</ol>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13146133,"title":"Balloon pop up over control mouse enter/exit","body":"<p><img src=\"http://i.stack.imgur.com/Dznos.jpg\" alt=\"enter image description here\"></p>\n\n<p>Hello,  </p>\n\n<p>Above is the program I am writing.  On the right panel is basically two custom controls (the blue rectangle area) I created and just added them as controls to the background panel control when this winform program loads.  </p>\n\n<p>I used MS paint to draw out the pop up balloon that I want to see when my mouse enter this control's area.  I want to do the following:</p>\n\n<pre><code>   1.  If mouse enter the control area, the yellow area balloon pop up and populate with the information of that specific control\n   2.  If mouse move out of the control area, the pop up balloon disappear.\n</code></pre>\n\n<p>Can this be done with Winform application? I looked around and found out about <code>Tooltip</code> class but so far from researching I don't know if it does what I want to do.</p>\n\n<p>I could be wrong but googling around gave me the impress that Tooltip offers very little in term of style.  Ideally I want to make this pop up balloon into almost like a border-less pop up window where I can put image , font ect.....at will.  Also Tooltip works if you hover over a button or specific field whereas I want the entire control area.</p>\n\n<p>Can this be done? I appreciate if you can point me to any work around if there is one.</p>\n"},{"tags":["c#","winforms","data-binding","combobox"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3845,"score":1,"question_id":540832,"title":"SelectedItem/Index/ValueChanged events not raised when DataSource is Databound on ComboBox","body":"<p>I am trying to implement the following:\nTwo combo boxes on a Winforms form, the first has a list of parent categories, the second is children of the parent, the child list changes contents depending on the selection in the parent.</p>\n\n<p>I'm trying to do this properly using databinding but I'm finding a strange quirk with the ComboBox control.</p>\n\n<p>I set the datasource of the parent manually:</p>\n\n<p><code>cboParent.DataSource = ParentDataSource</code> where ParentDataSource is <code>IList&lt;ParentDTO&gt;</code>.\nI can then bind the seletedItem to the DTO thus:</p>\n\n<p><code>cboParent.DataBindings.Add(new Binding(\"SelectedItem\", bindingSource, \"Parent\", true, DataSourceUpdateMode.OnPropertyChanged));</code> binding to <code>Parent</code> a <code>ParentDTO</code> object on my overarching DTO.</p>\n\n<p>All pretty standard so far. This works and writes back the change to my DTO object as soon as I select anything new in the list, great!</p>\n\n<p>I then bind the child combo box datasource to a list in the overarching DTO:\n<code>cboChild.DataBindings.Add(new Binding(\"DataSource\", bindingSource, \"Children\", true, DataSourceUpdateMode.OnPropertyChanged));</code> where Children is an <code>IList&lt;ChildDTO&gt;</code> on the overarching DTO.</p>\n\n<p>This also works fine and as soon as I change the parent selection the presenter changes the list <code>Children</code> on the DTO and the values shown in cboChildren changes, fantastic I hear you cry (and I did myself)!</p>\n\n<p>Unfortunately it seems that if you're using databinding to set the datasource on a ComboBox the SelectedItemChanged, SelectedIndexChanged and SelectedValueChanged events don't fire at all, ever! This means that OnProperyChanged databinding won't work for the second combobox. OnValidation does work but it seems a little odd to me and I was wondering if anyone had encountered this before and if they'd worked out how to make it work?</p>\n\n<p>Thanks in advance</p>\n\n<p>Stu</p>\n"},{"tags":["c#","winforms","design-view"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13145620,"title":"What is run when you add a control to a form in design view?","body":"<p>I have an error displayed regarding onload event.  The error is only displayed when I add the control to a form and try to view the form in design view.  Looking at the control itself in design view it's fine.  The error is</p>\n\n<p><code>Object reference not set to an instance of an object.</code></p>\n\n<p>Stack Trace</p>\n\n<pre><code>at BHCS.ECC.PhysDoc.UI.UserControls.TemplateBaseControl.SetControlVisibility() in C:\\TFS10\\ECC\\Dev\\BHCS\\ECC\\BHCS.ECC\\BHCS.ECC\\PhysDoc\\UI\\TemplateBaseControl.cs:line 98\nat BHCS.ECC.PhysDoc.UI.UserControls.TemplateBaseControl.ucTemplateBase_Load(Object sender, EventArgs e) in C:\\TFS10\\ECC\\Dev\\BHCS\\ECC\\BHCS.ECC\\BHCS.ECC\\PhysDoc\\UI\\TemplateBaseControl.cs:line 476\nat System.EventHandler.Invoke(Object sender, EventArgs e)\nat System.Windows.Forms.UserControl.OnLoad(EventArgs e)\nat DevExpress.XtraEditors.XtraUserControl.OnLoad(EventArgs e)\nat BHCS.ECC.PhysDoc.UI.UserControls.TemplateBaseControl.OnLoad(EventArgs e) in C:\\TFS10\\ECC\\Dev\\BHCS\\ECC\\BHCS.ECC\\BHCS.ECC\\PhysDoc\\UI\\TemplateBaseControl.cs:line 1029\nat System.Windows.Forms.UserControl.OnCreateControl()\nat System.Windows.Forms.Control.CreateControl(Boolean fIgnoreVisible)\nat System.Windows.Forms.Control.CreateControl(Boolean fIgnoreVisible)\nat System.Windows.Forms.Control.CreateControl()\nat System.Windows.Forms.Control.ControlCollection.Add(Control value)\nat System.Windows.Forms.Form.ControlCollection.Add(Control value)\nat System.Windows.Forms.Design.ControlDesigner.DesignerControlCollection.Add(Control c) \n</code></pre>\n\n<p>Having objects at design time doesn't make any sense.  Why do I have code running in my Form?  What is not allowed in the control that causes the error in the form design view?  </p>\n"},{"tags":[".net","winforms","propertygrid","uitypeeditor"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":12603269,"title":"How to relabel ellipsis button for modal UITypeEditor in PropertyGrid?","body":"<p>I have a Windows forms PropertyGrid and a customer UITypeEditor per <a href=\"http://msdn.microsoft.com/en-us/library/system.drawing.design.uitypeeditoreditstyle.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/system.drawing.design.uitypeeditoreditstyle.aspx</a></p>\n\n<blockquote>\n  <p>Displays an ellipsis (...) button to start a modal dialog box, which requires user input before continuing a program, or a modeless dialog box, which stays on the screen and is available for use at any time but permits other user activities.</p>\n</blockquote>\n\n<p>That ellipsis button is pretty small. How can I relabel it with a more helpful label?</p>\n"},{"tags":["c#","winforms","asp.net-mvc-3","barcode","isbn"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13072676,"title":"How do I create a dynamic ISBN 13 barcode image in C#","body":"<p>I need to be able to pass in a 13 digit ISBN and have the barcode display as an image on a website dynamically. I have tried some web services at maschup.com and so far unable to get this to render correctly. </p>\n"},{"tags":["c#",".net","winforms","panel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13143532,"title":"Create a panel in winForms c# with multiple sections in full screen mode","body":"<p>I would like to create a form that can have multiple panels with a single picturebox in each panel and each panel can be moved around.</p>\n\n<p>The panels need to fit on the maximum size of the monitor with each panel having equal width. </p>\n\n<p>I have tried to get the form to start at the maximum size using the WindowState Property but cannot get the panels' width to be split depending on the number of panels that are there.</p>\n\n<p>Also, I have tried to use a flow-panel as the main container and tried adding panels as required inside the flow-panel. The flow-panel is docked as \"fit\" in the form.</p>\n\n<p>Can someone please explain how I can solve this problem? </p>\n\n<p>Thank you in advance,</p>\n\n<p>Varun </p>\n\n<p>Edit: The form also needs to be able to let the user move the pictures in the picturebox around.</p>\n"},{"tags":["c#","winforms","textbox","border"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":1575,"score":3,"question_id":9768938,"title":"Change the borderColor of the TextBox","body":"<p>how can I change the BorderColor of the Textbox when a user Clicks on it or focuses on it. thanks !!</p>\n"},{"tags":["c#","winforms","hotkey"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13144739,"title":"How can I tell if the contextmenu item was clicked with the mouse or fired by a hotkey?","body":"<p>I have a <code>DataGridView</code> with a context menu.  One menu item is Copy (with a Ctrl+C hotkey.)  All I want to do is either get the current mouse location to copy the cell that the user right-clicked, or get the currently selected cell if they used the hot-key.  In both cases the <code>menu_Click</code> event gets fired.  How can I tell if it was from a hotkey or the context menu?</p>\n"},{"tags":["c#",".net","winforms","combobox","autocomplete"],"answer_count":3,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":3069,"score":3,"question_id":495798,"title":"Autocomplete AND preventing new input - combobox","body":"<p>How can I allow the users of my program to type in a value and have it auto-complete, however, I also what to prevent them from entering new data because it would cause the data to be unfindable (unless you had direct access to the database).</p>\n\n<p>Does anyone know how to do this?</p>\n\n<p>The reasoning behind not using just a dropdown style combobox is because entering data by typing it is and then refusing characters that are not part of an option in the list is because it's easier on the user.</p>\n\n<p>If you have used Quickbook's Timer, that is the style of comboboxes I am going for.</p>\n"},{"tags":["c#","winforms","visual-studio-2010"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13144626,"title":"Overriding Designer attribute in derived class","body":"<p>I have a class that inherits the built in <code>System.Windows.Forms.Panel</code> class. According to the metadata of the <code>Panel</code> class, it has an attribute named <code>Designer</code>. I am assuming this is what is causing my derived class to open in the form designer by default, rather than the code view. Is there a way I can override this attribute so that the file opens in code view?</p>\n"},{"tags":["winforms","c#-4.0","adodbapi"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13144819,"title":"show the Data Link Properties window as showdialog()","body":"<p>Im wondering how I can show the Data Link Properties as showdialog() on top of the\nmain window. This is my code:</p>\n\n<pre><code>MSDASC.DataLinks oDL = new MSDASC.DataLinksClass();\nADODB.Connection conn = new ADODB.ConnectionClass();\nobject oConn = (object)conn;           \nif (oDL.PromptEdit(ref oConn))\n{\ntxtConnectionString.Text = conn.ConnectionString;\n}\n</code></pre>\n"},{"tags":["c#","winforms","gridview"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13143151,"title":"How to remove empty row from gridview","body":"<p>I have a problem in window application. When I insert a record and display the records in a gridview, the gridview automatically makes one empty row. And I also use </p>\n\n<p><code>dataGridView1.AllowUserToAddRows = false;</code></p>\n\n<p>Please help me with an alternative solution to get rid of the empty row. </p>\n"},{"tags":["c#","winforms","design-patterns","mvp"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":94,"score":2,"question_id":12396349,"title":"Validation in MVP WinForms Application","body":"<p>I am creating a Windows Forms application that reads various tables from a database into a <code>DataSet</code> in order to display said tables in multiple <code>DataGridViews</code>. Rather than putting all my code in the code-behind file, I have started doing some research on different design patterns, and have found many articles/threads with the consensus that MVP is the best option for <code>WinForms</code>.</p>\n\n<p>After doing a few tutorials, and starting to organize my code using the MVP pattern; I have placed my DataSet in what would be the Model, most of the logic in the Presenter, and everything else in the View. </p>\n\n<p>My question is: where should I place the validation of user input? I do not want the user to be able to enter invalid values into the <code>DataGridView</code>s, and if they happen to do so, I would like to let them know the row/cell that has the error. Previously, I would handle the RowValidating event and check the row and cells of the DataGridView for any errors, and then display a message accordingly, but this seems to not fit within the MVP pattern.</p>\n\n<p>Should I leave the validation in the view, or should it be moved elsewhere?  </p>\n"},{"tags":["vb.net","winforms","pinvoke","sendmessage","sendkeys"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13138653,"title":"vb.net sendKeys to my application when application is minimized","body":"<p>i want to send keys into my from when my form is minimized and <strong>Not</strong> in focus\n<br></p>\n\n<pre><code>SendKeys.Send(\"{TAB}\")\n</code></pre>\n\n<p>works but <strong>only when</strong> my form is on <strong>focus</strong>.\n<br>\nand this is very not convenient, if the user want to minimize the application then the application send the keys to <strong>everywhere</strong>, i want that the application send the keys <strong>only</strong> to my application.</p>\n\n<p>So I need a function that looks like this:</p>\n\n<pre><code>Dim wb As New WebBrowser\nwb.Navigate(urll)\nWaitToWb()\n'Send Keys To WebBrowser\nSendKeysToBrowser(Me.Handle, wb, \"{TAB}\")\n</code></pre>\n\n<p>i need that the function send the keys only to my webbrowser, if my application is minimized the keys send <strong>only</strong> to the webbrowser control.</p>\n\n<p>there is a function that can send keys only to my application when my application is minimized?</p>\n"},{"tags":["c#","winforms","debugging"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":13141065,"title":"How can a handle error be thrown after Form.Shown?","body":"<p>I have an issue where we have some horribly complex code throwing up a Win32Exception</p>\n\n<blockquote>\n  <p>Error creating window handle.</p>\n</blockquote>\n\n<p>Looking at the callstack I see the the bottom of the stack is from</p>\n\n<pre><code>MainForm_ShownEvent(object sender, EventArgs e)//I Had a type-o here...arguments were wrong\n{\n    someControl.Parent = contentPanel;//call starts here\n}\n</code></pre>\n\n<p>The top of the stack comes from a custom event.  The event handler is in MainForm</p>\n\n<pre><code>anotherControl_RefreshEvent(object sender, PhysDocEventArgs e)\n{\n   Text = titleBarText;//win32 exception\n}\n</code></pre>\n\n<p>How is this possible?  Aren't we guaranteed to have a handle created once <code>Form.Shown</code> has been called?</p>\n\n<p><strong>Update</strong><br /></p>\n\n<p>Immediate window tells me <code>this.Handle</code> is 0.  where <code>this</code> is the MainForm object.  <br /></p>\n\n<p><strong>Stack Trace</strong> (This is 19 pages long, had to delete some) <br /></p>\n\n<pre><code>    System.Windows.Forms.NativeWindow.CreateHandle(System.Windows.Forms.CreateParams cp)    \n    System.Windows.Forms.Control.CreateHandle() \n    System.Windows.Forms.Form.CreateHandle()    \n    DevExpress.XtraEditors.XtraForm.CreateHandle()  \n    System.Windows.Forms.Control.RecreateHandleCore()   \n    System.Windows.Forms.Form.RecreateHandleCore()  \n    System.Windows.Forms.Form.OnTextChanged(System.EventArgs e) \n    System.Windows.Forms.Control.Text.set(string value) \n    System.Windows.Forms.Form.Text.set(string value)    \n&gt;   BHCS.ECC.PhysDoc.UI.Forms.MainForm.TemplateBaseControl_RefreshEvent(object sender = {BHCS.ECC.PhysDoc.UI.UserControls.TemplateBaseControl}, BHCS.ECC.PhysDoc.BL.PhysDocEventArgs e = {BHCS.ECC.PhysDoc.BL.PhysDocEventArgs}) Line 46    C#\n    BHCS.ECC.PhysDoc.UI.UserControls.TemplateBaseControl.RefreshControls() Line 323 C#\n    BHCS.ECC.PhysDoc.UI.UserControls.TemplateBaseControl.RunCreateControlProcess(bool destroyControls = false, bool reload = false, bool createControls = false, BHCS.ECC.PhysDoc.UI.LoadingForm loading = null) Line 1020  C#\n    BHCS.ECC.PhysDoc.UI.UserControls.TemplateBaseControl.docNode_Resize(object sender = {BHCS.ECC.PhysDoc.UI.UserControls.PDDocumentNodeControl}, System.EventArgs e = {System.EventArgs}) Line 683 C#\n    System.Windows.Forms.Control.OnResize(System.EventArgs e)   \n    System.Windows.Forms.UserControl.OnResize(System.EventArgs e)   \n    BHCS.ECC.PhysDoc.UI.UserControls.PDDocumentNodeControl.OnResize(System.EventArgs e = {System.EventArgs}) Line 140   C#\n    System.Windows.Forms.Control.OnSizeChanged(System.EventArgs e = {System.EventArgs}) \n    System.Windows.Forms.Control.UpdateBounds(int x, int y, int width, int height, int clientWidth, int clientHeight)   \n    System.Windows.Forms.Control.UpdateBounds() \n    System.Windows.Forms.Control.WmWindowPosChanged(ref System.Windows.Forms.Message m = {System.Windows.Forms.Message})    \n    System.Windows.Forms.Control.WndProc(ref System.Windows.Forms.Message m)    \n    System.Windows.Forms.ScrollableControl.WndProc(ref System.Windows.Forms.Message m)  \n    System.Windows.Forms.UserControl.WndProc(ref System.Windows.Forms.Message m)    \n    System.Windows.Forms.Control.ControlNativeWindow.OnMessage(ref System.Windows.Forms.Message m)  \n    System.Windows.Forms.Control.ControlNativeWindow.WndProc(ref System.Windows.Forms.Message m)    \n    System.Windows.Forms.NativeWindow.Callback(System.IntPtr hWnd, int msg = 71, System.IntPtr wparam, System.IntPtr lparam)    \n    [Native to Managed Transition]  \n    [Managed to Native Transition]  \n    System.Windows.Forms.Control.SetBoundsCore(int x, int y, int width, int height, System.Windows.Forms.BoundsSpecified specified = Width) \n    System.Windows.Forms.Control.SetBounds(int x, int y, int width, int height, System.Windows.Forms.BoundsSpecified specified) \n    System.Windows.Forms.Control.Width.set(int value)   \n    BHCS.ECC.PhysDoc.UI.UserControls.TemplateBaseControl.RefreshControls() Line 332 C#\n    BHCS.ECC.PhysDoc.UI.UserControls.TemplateBaseControl.RunCreateControlProcess(bool destroyControls = false, bool reload = false, bool createControls = false, BHCS.ECC.PhysDoc.UI.LoadingForm loading = null) Line 1020  C#\n    BHCS.ECC.PhysDoc.UI.UserControls.TemplateBaseControl.docNode_Resize(object sender = {BHCS.ECC.PhysDoc.UI.UserControls.PDDocumentNodeControl}, System.EventArgs e = {System.EventArgs}) Line 683 C#\n    System.Windows.Forms.Control.OnResize(System.EventArgs e)   \n    System.Windows.Forms.UserControl.OnResize(System.EventArgs e)   \n    BHCS.ECC.PhysDoc.UI.UserControls.PDDocumentNodeControl.OnResize(System.EventArgs e = {System.EventArgs}) Line 140   C#\n    System.Windows.Forms.Control.OnSizeChanged(System.EventArgs e = {System.EventArgs}) \n    System.Windows.Forms.Control.UpdateBounds(int x, int y, int width, int height, int clientWidth, int clientHeight)   \n    System.Windows.Forms.Control.UpdateBounds() \n    System.Windows.Forms.Control.WmWindowPosChanged(ref System.Windows.Forms.Message m = {System.Windows.Forms.Message})    \n    System.Windows.Forms.Control.WndProc(ref System.Windows.Forms.Message m)    \n    System.Windows.Forms.ScrollableControl.WndProc(ref System.Windows.Forms.Message m)  \n    System.Windows.Forms.UserControl.WndProc(ref System.Windows.Forms.Message m)    \n    System.Windows.Forms.Control.ControlNativeWindow.OnMessage(ref System.Windows.Forms.Message m)  \n    System.Windows.Forms.Control.ControlNativeWindow.WndProc(ref System.Windows.Forms.Message m)    \n    System.Windows.Forms.NativeWindow.Callback(System.IntPtr hWnd, int msg = 71, System.IntPtr wparam, System.IntPtr lparam)    \n    [Native to Managed Transition]  \n    [Managed to Native Transition]  \n    System.Windows.Forms.Control.SetBoundsCore(int x, int y, int width, int height, System.Windows.Forms.BoundsSpecified specified = Width) \n    System.Windows.Forms.Control.SetBounds(int x, int y, int width, int height, System.Windows.Forms.BoundsSpecified specified) \n    System.Windows.Forms.Control.Width.set(int value)   \n    BHCS.ECC.PhysDoc.UI.UserControls.TemplateBaseControl.RefreshControls() Line 332 C#\n    BHCS.ECC.PhysDoc.UI.UserControls.TemplateBaseControl.RunCreateControlProcess(bool destroyControls = false, bool reload = false, bool createControls = false, BHCS.ECC.PhysDoc.UI.LoadingForm loading = null) Line 1020  C#\n    BHCS.ECC.PhysDoc.UI.UserControls.TemplateBaseControl.docNode_Resize(object sender = {BHCS.ECC.PhysDoc.UI.UserControls.PDDocumentNodeControl}, System.EventArgs e = {System.EventArgs}) Line 683 C#\n    System.Windows.Forms.Control.OnResize(System.EventArgs e)   \n    System.Windows.Forms.UserControl.OnResize(System.EventArgs e)   \n    BHCS.ECC.PhysDoc.UI.UserControls.PDDocumentNodeControl.OnResize(System.EventArgs e = {System.EventArgs}) Line 140   C#\n    System.Windows.Forms.Control.OnSizeChanged(System.EventArgs e = {System.EventArgs}) \n    System.Windows.Forms.Control.UpdateBounds(int x, int y, int width, int height, int clientWidth, int clientHeight)   \n    System.Windows.Forms.Control.UpdateBounds() \n    System.Windows.Forms.Control.WmWindowPosChanged(ref System.Windows.Forms.Message m = {System.Windows.Forms.Message})    \n    System.Windows.Forms.Control.WndProc(ref System.Windows.Forms.Message m)    \n    System.Windows.Forms.ScrollableControl.WndProc(ref System.Windows.Forms.Message m)  \n    System.Windows.Forms.UserControl.WndProc(ref System.Windows.Forms.Message m)    \n    System.Windows.Forms.Control.ControlNativeWindow.OnMessage(ref System.Windows.Forms.Message m)  \n    System.Windows.Forms.Control.ControlNativeWindow.WndProc(ref System.Windows.Forms.Message m)    \n    System.Windows.Forms.NativeWindow.Callback(System.IntPtr hWnd, int msg = 71, System.IntPtr wparam, System.IntPtr lparam)    \n    [Native to Managed Transition]  \n    [Managed to Native Transition]  \n    System.Windows.Forms.Control.SetBoundsCore(int x, int y, int width, int height, System.Windows.Forms.BoundsSpecified specified = Height)    \n    System.Windows.Forms.Control.SetBounds(int x, int y, int width, int height, System.Windows.Forms.BoundsSpecified specified) \n    System.Windows.Forms.Control.Height.set(int value)  \n    BHCS.ECC.PhysDoc.UI.UserControls.PDDocumentNodeControl.RefreshSize(bool setAnchorAndWidth = false) Line 109 C#\n    BHCS.ECC.PhysDoc.UI.UserControls.PDDocumentNodeControl.ctrl_Resize(object sender = {System.Windows.Forms.Panel}, System.EventArgs e = {System.EventArgs}) Line 442  C#\n    System.Windows.Forms.Control.OnResize(System.EventArgs e)   \n    System.Windows.Forms.Panel.OnResize(System.EventArgs eventargs) \n    System.Windows.Forms.Control.OnSizeChanged(System.EventArgs e = {System.EventArgs}) \n    System.Windows.Forms.Control.UpdateBounds(int x, int y, int width, int height, int clientWidth, int clientHeight)   \n    System.Windows.Forms.Control.UpdateBounds() \n    System.Windows.Forms.Control.WmWindowPosChanged(ref System.Windows.Forms.Message m = {System.Windows.Forms.Message})    \n    System.Windows.Forms.Control.WndProc(ref System.Windows.Forms.Message m)    \n</code></pre>\n\n<p>(DELETED section)</p>\n\n<pre><code>BHCS.ECC.PhysDoc.UI.UserControls.TemplateBaseControl.RefreshControls() Line 332 C#\nBHCS.ECC.PhysDoc.UI.UserControls.TemplateBaseControl.RunCreateControlProcess(bool destroyControls = false, bool reload = false, bool createControls = false, BHCS.ECC.PhysDoc.UI.LoadingForm loading = null) Line 1020  C#\nBHCS.ECC.PhysDoc.UI.UserControls.TemplateBaseControl.docNode_Resize(object sender = {BHCS.ECC.PhysDoc.UI.UserControls.PDDocumentNodeControl}, System.EventArgs e = {System.EventArgs}) Line 683 C#\nSystem.Windows.Forms.Control.OnResize(System.EventArgs e)   \nSystem.Windows.Forms.UserControl.OnResize(System.EventArgs e)   \nBHCS.ECC.PhysDoc.UI.UserControls.PDDocumentNodeControl.OnResize(System.EventArgs e = {System.EventArgs}) Line 140   C#\nSystem.Windows.Forms.Control.OnSizeChanged(System.EventArgs e = {System.EventArgs}) \nSystem.Windows.Forms.Control.UpdateBounds(int x, int y, int width, int height, int clientWidth, int clientHeight)   \nSystem.Windows.Forms.Control.UpdateBounds() \nSystem.Windows.Forms.Control.WmWindowPosChanged(ref System.Windows.Forms.Message m = {System.Windows.Forms.Message})    \nSystem.Windows.Forms.Control.WndProc(ref System.Windows.Forms.Message m)    \nSystem.Windows.Forms.ScrollableControl.WndProc(ref System.Windows.Forms.Message m)  \nSystem.Windows.Forms.UserControl.WndProc(ref System.Windows.Forms.Message m)    \nSystem.Windows.Forms.Control.ControlNativeWindow.OnMessage(ref System.Windows.Forms.Message m)  \nSystem.Windows.Forms.Control.ControlNativeWindow.WndProc(ref System.Windows.Forms.Message m)    \nSystem.Windows.Forms.NativeWindow.Callback(System.IntPtr hWnd, int msg = 71, System.IntPtr wparam, System.IntPtr lparam)    \n[Native to Managed Transition]  \n[Managed to Native Transition]  \nSystem.Windows.Forms.Control.SetBoundsCore(int x, int y, int width, int height, System.Windows.Forms.BoundsSpecified specified = Height)    \nSystem.Windows.Forms.Control.SetBounds(int x, int y, int width, int height, System.Windows.Forms.BoundsSpecified specified) \nSystem.Windows.Forms.Control.Height.set(int value)  \nBHCS.ECC.PhysDoc.UI.UserControls.PDDocumentNodeControl.RefreshSize(bool setAnchorAndWidth = false) Line 109 C#\nBHCS.ECC.PhysDoc.UI.UserControls.PDDocumentNodeControl.ctrl_Resize(object sender = {System.Windows.Forms.Panel}, System.EventArgs e = {System.EventArgs}) Line 442  C#\nSystem.Windows.Forms.Control.OnResize(System.EventArgs e)   \nSystem.Windows.Forms.Panel.OnResize(System.EventArgs eventargs) \nSystem.Windows.Forms.Control.OnSizeChanged(System.EventArgs e = {System.EventArgs}) \nSystem.Windows.Forms.Control.UpdateBounds(int x, int y, int width, int height, int clientWidth, int clientHeight)   \nSystem.Windows.Forms.Control.UpdateBounds() \nSystem.Windows.Forms.Control.WmWindowPosChanged(ref System.Windows.Forms.Message m = {System.Windows.Forms.Message})    \nSystem.Windows.Forms.Control.WndProc(ref System.Windows.Forms.Message m)    \nSystem.Windows.Forms.ScrollableControl.WndProc(ref System.Windows.Forms.Message m)  \nSystem.Windows.Forms.Control.ControlNativeWindow.OnMessage(ref System.Windows.Forms.Message m)  \nSystem.Windows.Forms.Control.ControlNativeWindow.WndProc(ref System.Windows.Forms.Message m)    \nSystem.Windows.Forms.NativeWindow.Callback(System.IntPtr hWnd, int msg = 71, System.IntPtr wparam, System.IntPtr lparam)    \n[Native to Managed Transition]  \n[Managed to Native Transition]  \nSystem.Windows.Forms.Control.SetBoundsCore(int x, int y, int width, int height, System.Windows.Forms.BoundsSpecified specified = Height)    \nSystem.Windows.Forms.Control.SetBounds(int x, int y, int width, int height, System.Windows.Forms.BoundsSpecified specified) \nSystem.Windows.Forms.Control.Height.set(int value)  \nBHCS.ECC.PhysDoc.Plugins.Prompt.BL.PanelPrompt.pnlOuter_Layout(object sender = {System.Windows.Forms.Panel}, System.Windows.Forms.LayoutEventArgs e = {System.Windows.Forms.LayoutEventArgs}) Line 164  C#\nSystem.Windows.Forms.Control.OnLayout(System.Windows.Forms.LayoutEventArgs levent = {System.Windows.Forms.LayoutEventArgs}) \nSystem.Windows.Forms.ScrollableControl.OnLayout(System.Windows.Forms.LayoutEventArgs levent)    \nSystem.Windows.Forms.Control.PerformLayout(System.Windows.Forms.LayoutEventArgs args)   \nSystem.Windows.Forms.Control.System.Windows.Forms.Layout.IArrangedElement.PerformLayout(System.Windows.Forms.Layout.IArrangedElement affectedElement, string affectedProperty)  \nSystem.Windows.Forms.Control.OnResize(System.EventArgs e = {System.EventArgs})  \nSystem.Windows.Forms.Panel.OnResize(System.EventArgs eventargs) \nSystem.Windows.Forms.Control.OnSizeChanged(System.EventArgs e = {System.EventArgs}) \nSystem.Windows.Forms.Control.UpdateBounds(int x, int y, int width, int height, int clientWidth, int clientHeight)   \nSystem.Windows.Forms.Control.UpdateBounds() \nSystem.Windows.Forms.Control.WmWindowPosChanged(ref System.Windows.Forms.Message m = {System.Windows.Forms.Message})    \nSystem.Windows.Forms.Control.WndProc(ref System.Windows.Forms.Message m)    \nSystem.Windows.Forms.ScrollableControl.WndProc(ref System.Windows.Forms.Message m)  \nSystem.Windows.Forms.Control.ControlNativeWindow.OnMessage(ref System.Windows.Forms.Message m)  \nSystem.Windows.Forms.Control.ControlNativeWindow.WndProc(ref System.Windows.Forms.Message m)    \nSystem.Windows.Forms.NativeWindow.Callback(System.IntPtr hWnd, int msg = 71, System.IntPtr wparam, System.IntPtr lparam)    \n[Native to Managed Transition]  \n[Managed to Native Transition]  \nSystem.Windows.Forms.Control.SetBoundsCore(int x, int y, int width, int height, System.Windows.Forms.BoundsSpecified specified = Width) \nSystem.Windows.Forms.Control.SetBounds(int x, int y, int width, int height, System.Windows.Forms.BoundsSpecified specified) \nSystem.Windows.Forms.Control.Width.set(int value)   \nBHCS.ECC.PhysDoc.UI.UserControls.PDDocumentNodeControl.OnResize(System.EventArgs e = {System.EventArgs}) Line 150   C#\nSystem.Windows.Forms.Control.OnSizeChanged(System.EventArgs e = {System.EventArgs}) \nSystem.Windows.Forms.Control.UpdateBounds(int x, int y, int width, int height, int clientWidth, int clientHeight)   \nSystem.Windows.Forms.Control.UpdateBounds() \nSystem.Windows.Forms.Control.WmWindowPosChanged(ref System.Windows.Forms.Message m = {System.Windows.Forms.Message})    \nSystem.Windows.Forms.Control.WndProc(ref System.Windows.Forms.Message m)    \nSystem.Windows.Forms.ScrollableControl.WndProc(ref System.Windows.Forms.Message m)  \nSystem.Windows.Forms.UserControl.WndProc(ref System.Windows.Forms.Message m)    \nSystem.Windows.Forms.Control.ControlNativeWindow.OnMessage(ref System.Windows.Forms.Message m)  \nSystem.Windows.Forms.Control.ControlNativeWindow.WndProc(ref System.Windows.Forms.Message m)    \nSystem.Windows.Forms.NativeWindow.Callback(System.IntPtr hWnd, int msg = 71, System.IntPtr wparam, System.IntPtr lparam)    \n[Native to Managed Transition]  \n[Managed to Native Transition]  \nSystem.Windows.Forms.Control.SetBoundsCore(int x, int y, int width, int height, System.Windows.Forms.BoundsSpecified specified = Width) \nSystem.Windows.Forms.Control.SetBounds(int x, int y, int width, int height, System.Windows.Forms.BoundsSpecified specified) \nSystem.Windows.Forms.Control.Width.set(int value)   \nBHCS.ECC.PhysDoc.UI.UserControls.TemplateBaseControl.RefreshControls() Line 332 C#\nBHCS.ECC.PhysDoc.UI.UserControls.TemplateBaseControl.RunCreateControlProcess(bool destroyControls = false, bool reload = false, bool createControls = false, BHCS.ECC.PhysDoc.UI.LoadingForm loading = null) Line 1020  C#\nBHCS.ECC.PhysDoc.UI.UserControls.TemplateBaseControl.docNode_Resize(object sender = {BHCS.ECC.PhysDoc.UI.UserControls.PDDocumentNodeControl}, System.EventArgs e = {System.EventArgs}) Line 683 C#\nSystem.Windows.Forms.Control.OnResize(System.EventArgs e)   \nSystem.Windows.Forms.UserControl.OnResize(System.EventArgs e)   \nBHCS.ECC.PhysDoc.UI.UserControls.PDDocumentNodeControl.OnResize(System.EventArgs e = {System.EventArgs}) Line 140   C#\nSystem.Windows.Forms.Control.OnSizeChanged(System.EventArgs e = {System.EventArgs}) \nSystem.Windows.Forms.Control.UpdateBounds(int x, int y, int width, int height, int clientWidth, int clientHeight)   \nSystem.Windows.Forms.Control.UpdateBounds() \nSystem.Windows.Forms.Control.WmWindowPosChanged(ref System.Windows.Forms.Message m = {System.Windows.Forms.Message})    \nSystem.Windows.Forms.Control.WndProc(ref System.Windows.Forms.Message m)    \nSystem.Windows.Forms.ScrollableControl.WndProc(ref System.Windows.Forms.Message m)  \nSystem.Windows.Forms.UserControl.WndProc(ref System.Windows.Forms.Message m)    \nSystem.Windows.Forms.Control.ControlNativeWindow.OnMessage(ref System.Windows.Forms.Message m)  \nSystem.Windows.Forms.Control.ControlNativeWindow.WndProc(ref System.Windows.Forms.Message m)    \nSystem.Windows.Forms.NativeWindow.Callback(System.IntPtr hWnd, int msg = 71, System.IntPtr wparam, System.IntPtr lparam)    \n[Native to Managed Transition]  \n[Managed to Native Transition]  \nSystem.Windows.Forms.Control.SetBoundsCore(int x, int y, int width, int height, System.Windows.Forms.BoundsSpecified specified = Height)    \nSystem.Windows.Forms.Control.SetBounds(int x, int y, int width, int height, System.Windows.Forms.BoundsSpecified specified) \nSystem.Windows.Forms.Control.Height.set(int value)  \nBHCS.ECC.PhysDoc.UI.UserControls.PDDocumentNodeControl.RefreshSize(bool setAnchorAndWidth = false) Line 109 C#\nBHCS.ECC.PhysDoc.UI.UserControls.PDDocumentNodeControl.ctrl_Resize(object sender = {System.Windows.Forms.Panel}, System.EventArgs e = {System.EventArgs}) Line 442  C#\nSystem.Windows.Forms.Control.OnResize(System.EventArgs e)   \nSystem.Windows.Forms.Panel.OnResize(System.EventArgs eventargs) \nSystem.Windows.Forms.Control.OnSizeChanged(System.EventArgs e = {System.EventArgs}) \nSystem.Windows.Forms.Control.UpdateBounds(int x, int y, int width, int height, int clientWidth, int clientHeight)   \nSystem.Windows.Forms.Control.UpdateBounds() \nSystem.Windows.Forms.Control.WmWindowPosChanged(ref System.Windows.Forms.Message m = {System.Windows.Forms.Message})    \nSystem.Windows.Forms.Control.WndProc(ref System.Windows.Forms.Message m)    \nSystem.Windows.Forms.ScrollableControl.WndProc(ref System.Windows.Forms.Message m)  \nSystem.Windows.Forms.Control.ControlNativeWindow.OnMessage(ref System.Windows.Forms.Message m)  \nSystem.Windows.Forms.Control.ControlNativeWindow.WndProc(ref System.Windows.Forms.Message m)    \nSystem.Windows.Forms.NativeWindow.Callback(System.IntPtr hWnd, int msg = 71, System.IntPtr wparam, System.IntPtr lparam)    \n[Native to Managed Transition]  \n[Managed to Native Transition]  \nSystem.Windows.Forms.Control.SetBoundsCore(int x, int y, int width, int height, System.Windows.Forms.BoundsSpecified specified = Height)    \nSystem.Windows.Forms.Control.SetBounds(int x, int y, int width, int height, System.Windows.Forms.BoundsSpecified specified) \nSystem.Windows.Forms.Control.Height.set(int value)  \nBHCS.ECC.PhysDoc.Plugins.Prompt.BL.PanelPrompt.pnlOuter_Layout(object sender = {System.Windows.Forms.Panel}, System.Windows.Forms.LayoutEventArgs e = {System.Windows.Forms.LayoutEventArgs}) Line 164  C#\nSystem.Windows.Forms.Control.OnLayout(System.Windows.Forms.LayoutEventArgs levent = {System.Windows.Forms.LayoutEventArgs}) \nSystem.Windows.Forms.ScrollableControl.OnLayout(System.Windows.Forms.LayoutEventArgs levent)    \nSystem.Windows.Forms.Control.PerformLayout(System.Windows.Forms.LayoutEventArgs args)   \nSystem.Windows.Forms.Control.System.Windows.Forms.Layout.IArrangedElement.PerformLayout(System.Windows.Forms.Layout.IArrangedElement affectedElement, string affectedProperty)  \nSystem.Windows.Forms.Control.OnResize(System.EventArgs e = {System.EventArgs})  \nSystem.Windows.Forms.Panel.OnResize(System.EventArgs eventargs) \nSystem.Windows.Forms.Control.OnSizeChanged(System.EventArgs e = {System.EventArgs}) \nSystem.Windows.Forms.Control.UpdateBounds(int x, int y, int width, int height, int clientWidth, int clientHeight)   \nSystem.Windows.Forms.Control.UpdateBounds() \nSystem.Windows.Forms.Control.WmWindowPosChanged(ref System.Windows.Forms.Message m = {System.Windows.Forms.Message})    \nSystem.Windows.Forms.Control.WndProc(ref System.Windows.Forms.Message m)    \nSystem.Windows.Forms.ScrollableControl.WndProc(ref System.Windows.Forms.Message m)  \nSystem.Windows.Forms.Control.ControlNativeWindow.OnMessage(ref System.Windows.Forms.Message m)  \nSystem.Windows.Forms.Control.ControlNativeWindow.WndProc(ref System.Windows.Forms.Message m)    \nSystem.Windows.Forms.NativeWindow.Callback(System.IntPtr hWnd, int msg = 71, System.IntPtr wparam, System.IntPtr lparam)    \n[Native to Managed Transition]  \n[Managed to Native Transition]  \nSystem.Windows.Forms.Control.SetBoundsCore(int x, int y, int width, int height, System.Windows.Forms.BoundsSpecified specified = Width) \nSystem.Windows.Forms.Control.SetBounds(int x, int y, int width, int height, System.Windows.Forms.BoundsSpecified specified) \nSystem.Windows.Forms.Control.Width.set(int value)   \nBHCS.ECC.PhysDoc.UI.UserControls.PDDocumentNodeControl.OnResize(System.EventArgs e = {System.EventArgs}) Line 150   C#\nSystem.Windows.Forms.Control.OnSizeChanged(System.EventArgs e = {System.EventArgs}) \nSystem.Windows.Forms.Control.UpdateBounds(int x, int y, int width, int height, int clientWidth, int clientHeight)   \nSystem.Windows.Forms.Control.UpdateBounds() \nSystem.Windows.Forms.Control.WmWindowPosChanged(ref System.Windows.Forms.Message m = {System.Windows.Forms.Message})    \nSystem.Windows.Forms.Control.WndProc(ref System.Windows.Forms.Message m)    \nSystem.Windows.Forms.ScrollableControl.WndProc(ref System.Windows.Forms.Message m)  \nSystem.Windows.Forms.UserControl.WndProc(ref System.Windows.Forms.Message m)    \nSystem.Windows.Forms.Control.ControlNativeWindow.OnMessage(ref System.Windows.Forms.Message m)  \nSystem.Windows.Forms.Control.ControlNativeWindow.WndProc(ref System.Windows.Forms.Message m)    \nSystem.Windows.Forms.NativeWindow.Callback(System.IntPtr hWnd, int msg = 71, System.IntPtr wparam, System.IntPtr lparam)    \n[Native to Managed Transition]  \n[Managed to Native Transition]  \nSystem.Windows.Forms.Control.SetBoundsCore(int x, int y, int width, int height, System.Windows.Forms.BoundsSpecified specified = Width) \nSystem.Windows.Forms.Control.SetBounds(int x, int y, int width, int height, System.Windows.Forms.BoundsSpecified specified) \nSystem.Windows.Forms.Control.Width.set(int value)   \nBHCS.ECC.PhysDoc.UI.UserControls.TemplateBaseControl.RefreshControls() Line 332 C#\nBHCS.ECC.PhysDoc.UI.UserControls.TemplateBaseControl.RunCreateControlProcess(bool destroyControls = false, bool reload = false, bool createControls = false, BHCS.ECC.PhysDoc.UI.LoadingForm loading = null) Line 1020  C#\nBHCS.ECC.PhysDoc.UI.UserControls.TemplateBaseControl.OnResize(System.EventArgs e = {System.EventArgs}) Line 1073    C#\nSystem.Windows.Forms.Control.OnSizeChanged(System.EventArgs e = {System.EventArgs}) \nSystem.Windows.Forms.Control.UpdateBounds(int x, int y, int width, int height, int clientWidth, int clientHeight)   \nSystem.Windows.Forms.Control.UpdateBounds() \nSystem.Windows.Forms.Control.WmWindowPosChanged(ref System.Windows.Forms.Message m = {System.Windows.Forms.Message})    \nSystem.Windows.Forms.Control.WndProc(ref System.Windows.Forms.Message m)    \nSystem.Windows.Forms.ScrollableControl.WndProc(ref System.Windows.Forms.Message m)  \nSystem.Windows.Forms.UserControl.WndProc(ref System.Windows.Forms.Message m)    \nSystem.Windows.Forms.Control.ControlNativeWindow.OnMessage(ref System.Windows.Forms.Message m)  \nSystem.Windows.Forms.Control.ControlNativeWindow.WndProc(ref System.Windows.Forms.Message m)    \nSystem.Windows.Forms.NativeWindow.Callback(System.IntPtr hWnd, int msg = 71, System.IntPtr wparam, System.IntPtr lparam)    \n[Native to Managed Transition]  \n[Managed to Native Transition]  \nDevExpress.Utils.Win.Hook.ControlWndHook.WindowProc(System.IntPtr hWnd, int message, System.IntPtr wParam, System.IntPtr lParam)    \n[Native to Managed Transition]  \n[Managed to Native Transition]  \nSystem.Windows.Forms.Control.SetBoundsCore(int x, int y, int width, int height, System.Windows.Forms.BoundsSpecified specified = None)  \nSystem.Windows.Forms.Control.System.Windows.Forms.Layout.IArrangedElement.SetBounds(System.Drawing.Rectangle bounds, System.Windows.Forms.BoundsSpecified specified)    \nSystem.Windows.Forms.Layout.DefaultLayout.xLayoutDockedControl(System.Windows.Forms.Layout.IArrangedElement element, System.Drawing.Rectangle newElementBounds, bool measureOnly, ref System.Drawing.Size preferredSize, ref System.Drawing.Rectangle remainingBounds)  \nSystem.Windows.Forms.Layout.DefaultLayout.LayoutDockedControls(System.Windows.Forms.Layout.IArrangedElement container, bool measureOnly = false)    \nSystem.Windows.Forms.Layout.DefaultLayout.xLayout(System.Windows.Forms.Layout.IArrangedElement container = {System.Windows.Forms.Panel}, bool measureOnly = false, out System.Drawing.Size preferredSize = {Width = -7103 Height = -7105})  \nSystem.Windows.Forms.Layout.DefaultLayout.LayoutCore(System.Windows.Forms.Layout.IArrangedElement container, System.Windows.Forms.LayoutEventArgs args) \nSystem.Windows.Forms.Layout.LayoutEngine.Layout(object container, System.Windows.Forms.LayoutEventArgs layoutEventArgs) \nSystem.Windows.Forms.Control.OnLayout(System.Windows.Forms.LayoutEventArgs levent)  \nSystem.Windows.Forms.ScrollableControl.OnLayout(System.Windows.Forms.LayoutEventArgs levent)    \nSystem.Windows.Forms.Control.PerformLayout(System.Windows.Forms.LayoutEventArgs args)   \nSystem.Windows.Forms.Control.System.Windows.Forms.Layout.IArrangedElement.PerformLayout(System.Windows.Forms.Layout.IArrangedElement affectedElement, string affectedProperty)  \nSystem.Windows.Forms.Control.ControlCollection.Add(System.Windows.Forms.Control value = {BHCS.ECC.PhysDoc.UI.UserControls.TemplateBaseControl}) \nSystem.Windows.Forms.Control.ParentInternal.set(System.Windows.Forms.Control value) \nSystem.Windows.Forms.Control.Parent.set(System.Windows.Forms.Control value) \nBHCS.ECC.PhysDoc.UI.Forms.MainForm.MainForm_Shown(object sender = {BHCS.ECC.PhysDoc.UI.Forms.MainForm}, System.EventArgs e = {System.EventArgs}) Line 88    C#\nSystem.Windows.Forms.Form.OnShown(System.EventArgs e)   \nSystem.Windows.Forms.Form.CallShownEvent()  \nSystem.Windows.Forms.Control.InvokeMarshaledCallbackDo(System.Windows.Forms.Control.ThreadMethodEntry tme)  \nSystem.Windows.Forms.Control.InvokeMarshaledCallbackHelper(object obj)  \nSystem.Threading.ExecutionContext.RunInternal(System.Threading.ExecutionContext executionContext, System.Threading.ContextCallback callback, object state, bool preserveSyncCtx)    \nSystem.Threading.ExecutionContext.Run(System.Threading.ExecutionContext executionContext, System.Threading.ContextCallback callback, object state, bool preserveSyncCtx)    \nSystem.Threading.ExecutionContext.Run(System.Threading.ExecutionContext executionContext, System.Threading.ContextCallback callback, object state)  \nSystem.Windows.Forms.Control.InvokeMarshaledCallback(System.Windows.Forms.Control.ThreadMethodEntry tme)    \nSystem.Windows.Forms.Control.InvokeMarshaledCallbacks() \nSystem.Windows.Forms.Control.WndProc(ref System.Windows.Forms.Message m)    \nSystem.Windows.Forms.ScrollableControl.WndProc(ref System.Windows.Forms.Message m)  \nSystem.Windows.Forms.ContainerControl.WndProc(ref System.Windows.Forms.Message m)   \nSystem.Windows.Forms.Form.WndProc(ref System.Windows.Forms.Message m)   \nDevExpress.XtraEditors.XtraForm.WndProc(ref System.Windows.Forms.Message msg)   \nSystem.Windows.Forms.Control.ControlNativeWindow.OnMessage(ref System.Windows.Forms.Message m)  \nSystem.Windows.Forms.Control.ControlNativeWindow.WndProc(ref System.Windows.Forms.Message m)    \nSystem.Windows.Forms.NativeWindow.Callback(System.IntPtr hWnd, int msg = 49734, System.IntPtr wparam, System.IntPtr lparam) \n[Appdomain Transition]  \n[Native to Managed Transition]  \n[Managed to Native Transition]  \nSystem.Windows.Threading.Dispatcher.PushFrameImpl(System.Windows.Threading.DispatcherFrame frame = {System.Windows.Threading.DispatcherFrame}) Line 2281    Unknown\nSystem.Windows.Threading.Dispatcher.PushFrame(System.Windows.Threading.DispatcherFrame frame) Line 368  Unknown\nSystem.Windows.Threading.Dispatcher.Run() Line 327  Unknown\nSystem.Windows.Application.RunDispatcher(object ignore) Line 2745   C#\nSystem.Windows.Application.RunInternal(System.Windows.Window window) Line 1841  C#\nSystem.Windows.Application.Run(System.Windows.Window window) Line 261   C#\nEclipsys.Infrastructure.UIShell.App.Main()  \n</code></pre>\n"},{"tags":["c#",".net","winforms","performance","splash-screen"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1249,"score":4,"question_id":5743458,"title":"Show a splash screen at once","body":"<p>We are dealing with slow start for WinForm applications (it is a large application and has many control assemblies). Control assemblies are DevComponents. Ngen was applied to prevent jit compilation, but the loading time just decreased a little. </p>\n\n<p>The app has a splash screen, but it appears only in 12 seconds after the app has started. Is there any approach to show the splash screen at once?</p>\n\n<p>Our current suggestion is to create  a lightweight app with the splash screen, run the main app in a separate process, and close the lightweight app when initialization of the main app is done.</p>\n"},{"tags":["c#","winforms","panel"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":78,"score":2,"question_id":13129089,"title":"PaintEvent not overpainting","body":"<p>I have a Windows Forms application in C# with drawing panel and a button - for drawing a line. </p>\n\n<p>When you click the button, you can draw a line for 2 random points. </p>\n\n<pre><code>Pen p = new Pen(Color.Black, 5);\n//point for start \nPoint ps = new Point();\n//point for end \nPoint pe = new Point();\n\nprivate void drawPanel_MouseDown(object sender, MouseEventArgs e)\n{\n  ps.X = e.X;\n  ps.Y = e.Y;\n  pe = ps;\n}\n\nprivate void drawPanel_MouseMove(object sender, MouseEventArgs e)\n{\n  // when button is clicked for drawing draw = true;\n  if (draw)\n  {\n    if (e.Button == MouseButtons.Left)\n    { \n      pe = new Point(e.X, e.Y);\n    }\n  }\n}\n\nprivate void drawPanel_MouseUp(object sender, MouseEventArgs e)\n{\n  onMouseUpFlag = true;\n}\n\nprivate void drawPanel_Paint(object sender, PaintEventArgs e)\n{\n  Graphics g = drawPanel.CreateGraphics();\n  if (onMouseUpFlag)\n  {\n    g.DrawLine(p, ps, pe); \n    g.Dispose(); \n  }\n} \n</code></pre>\n\n<p>The program has some flaws : </p>\n\n<ul>\n<li>When you draw a line it shows it, only if the main window is moved\nsomewhere(usually when I hide it) </li>\n<li>It can draw only 1 line.</li>\n</ul>\n\n<p>Any suggestions how to fix these bugs ? </p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I've read you answers and made some changes :</p>\n\n<pre><code>Pen p = new Pen(Color.Black, 5); \nPoint ps = new Point();\nPoint pe = new Point();\n\nList&lt;Point&gt; linesStart= new List&lt;Point&gt;();\nList&lt;Point&gt; linesEnd= new List&lt;Point&gt;();\n\nprivate void drawPanel_MouseDown(object sender, MouseEventArgs e)\n{\n  ps.X = e.X;\n  ps.Y = e.Y;\n\n  linesStart.Add(ps);\n\n  pe = ps;\n}\n\nprivate void drawPanel_MouseMove(object sender, MouseEventArgs e)\n{\n  if (e.Button == MouseButtons.Left)\n  {\n    pe = new Point(e.X, e.Y);\n\n    //adding end point .. actually adds a lot of points \n    linesEnd.Add(pe);\n  }\n}\n\nbool onMouseUpFlag = false;\n\nprivate void drawPanel_MouseUp(object sender, MouseEventArgs e)\n{\n  onMouseUpFlag = true;\n  drawPanel.Invalidate();\n}\n\nprivate void drawPanel_Paint(object sender, PaintEventArgs e)\n{ \n  if (onMouseUpFlag)\n  {\n    for (int i = 0; i &lt; linesStart.Count; i++)\n    {\n      e.Graphics.DrawLine(p, linesStart[i], linesEnd[i]);\n    } \n  }\n} \n</code></pre>\n\n<p>Now I'm trying to fix the DrawLine for multiple lines.  Paint event can do multiple line but only the starting point is fine. Somehow the end point is not very correct. Where I can set exactly the last point of the MouseMove event ? </p>\n"},{"tags":["winforms","datagridview","c#-3.0","datagridviewcomboboxcell"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":126,"score":3,"question_id":13079070,"title":"Dynamically setting DataGridViewComboBoxCell's DataSource to filtered DataView based off of other cell selection","body":"<p>I have been looking high and low for a way to do the following, but to no avail. I came up with a solution that works, but am wondering if there is a better way of handling it.</p>\n\n<p><strong>The Problem:</strong></p>\n\n<p>I am using a DataGridView that has two DataGridViewComboBoxColumn, col1 and col2.</p>\n\n<p>col1 has had its DataSource set to a DataTable. Based off of the selection from a given cell in col1, I would like to have the respective col2 cell in the same row have its DataSource set to be a filtered DataView of col2's DataSource.</p>\n\n<p>The abbreviated code from my current implementation might better help describe what I am trying to do:</p>\n\n<pre><code>DataGridView dg = new DataGridView();\ndg.DataSource = new BindingSource() { DataSource = _myDataTable }; //DataTable with Foreign Keys for ID1 and ID2\ndg.CellValueChanged += new DataGridViewCellEventHandler(dg_CellValueChanged);\nDataGridViewComboBoxColumn col1 = new DataGridViewComboBoxColumn();\ncol1.DataPropertyName = \"ID1\";\ncol1.DisplayMember = \"Display1\";\ncol1.ValueMember = \"ID1\";\ncol1.DataSource = dataTable1;\ncol1.ValueType = typeof(Int32);\n\nDataGridViewComboBoxColumn col2 = new DataGridViewComboBoxColumn();\ncol2.DataPropertyName = \"ID2\";\ncol2.DisplayMember = \"Display2\";\ncol2.ValueMember = \"ID2\";\ncol2.DataSource = dataTable2;\ncol2.ValueType = typeof(Int32);\n\ndg.Columns.Add(col1);\ndg.Columns.Add(col2);\n</code></pre>\n\n<p>Then I define the event handler as:</p>\n\n<pre><code>private void dg_CellValueChanged(object sender, DataGridViewCellEventArgs e)\n{\n    if (e.ColumnIndex == 0 &amp;&amp; e.RowIndex &gt; -1)\n    {\n        var dgv = sender as DataGridView;\n        if (dgv == null)\n            return;\n\n        int selectedID;\n        if (!int.TryParse(dgv[e.ColumnIndex, e.RowIndex].Value.ToString(), out selectedID))\n            return;\n\n        var cell = dgv[e.ColumnIndex + 1, e.RowIndex] as DataGridViewComboBoxCell;\n        if (cell == null)\n            return;\n\n        var col = dgv.Columns[e.ColumnIndex + 1] as DataGridViewComboBoxColumn;\n        if(col == null)\n            return;\n\n        var dt = col.DataSource as DataTable; // The macro-DataTable containing all possible values\n        if(dt == null)\n            return;\n\n        DataView dv = new DataView(dt, \"ID1 = \" + selectedID, \"DisplayOrder\", DataViewRowState.CurrentRows);\n        if(dv.Count == 0)\n            return;\n\n        //This is the part that I am wondering if there is a better way of handling\n        cell.DataSource = dt; //Set the data source to the macro-DataTable so that when we set the Value to something in the new DataView it will not throw an exception\n        cell.DisplayMember = \"Display2\"; // Have to redefine the Display/Value members\n        cell.ValueMember = \"ID2\";\n        cell.Value = dv[0][\"ID2\"]; // Set the value to the first option in the new DataView to avoid an exception being thrown when setting the dv as the DataSource\n        cell.DataSource = dv;\n    }\n}\n</code></pre>\n\n<p>The last part is my concern.\nWhen dynamically switching the DataSource of cell2, if cell2's current selection doesn't appear in the new DataView, then an exception will be thrown:</p>\n\n<p><strong>System.ArgumentException: DataGridViewComboBoxCell value is not valid.</strong></p>\n\n<p>To avoid that, I am setting the datasource to the macro-DataTable (containing all of the values that could be shown based off of cell1's selection), changing the selected value of cell2 to be the first result in the DataView and then setting cell2's DataSource to be said DataView. This all ensures that the cell is never going to have an invalid selection and it works as expected.</p>\n\n<p>My question is, is there a better/simpler way of doing this? For my use, this code is only activated when creating new rows, so it isn't being done more than a few times in the given form. However, if there is a better way of doing it or some suggestions on making it better, I would appreciate it!</p>\n\n<p>(first question here, so I am also open to suggestions for posting ... apologies for any missteps)</p>\n\n<p><strong>EDIT (providing table structure - also changed \"BoundID\" to be \"ID1\" to avoid confusion):</strong></p>\n\n<p>DataGrid's table structure would be:</p>\n\n<blockquote>\n  <p>MainTableID int</p>\n  \n  <p>ID1 int --This is a foreign key to col1</p>\n  \n  <p>ID2 int --This is a foreign key to col2</p>\n</blockquote>\n\n<p>Column 1's table structure:</p>\n\n<blockquote>\n  <p>ID1 int</p>\n  \n  <p>Display1 varchar(50)</p>\n</blockquote>\n\n<p>Column 2's table structure:</p>\n\n<blockquote>\n  <p>ID2 int</p>\n  \n  <p>Display2 varchar(50)</p>\n  \n  <p>ID1 int --This is a foreign key to col1</p>\n</blockquote>\n\n<p><strong>Updated:</strong>\nI have redefined the CellValueChanged event handler per Mohsen's suggestions:</p>\n\n<pre><code>private void dg_CellValueChanged(object sender, DataGridViewCellEventArgs e)\n{\n    if (e.ColumnIndex == 0 &amp;&amp; e.RowIndex &gt; -1)\n    {\n        var dgv = sender as DataGridView;\n\n        var cell = dgv[e.ColumnIndex + 1, e.RowIndex] as DataGridViewComboBoxCell;\n        if (cell == null)\n            return;\n\n        DataView dv = new DataView( ((DataTable)((DataGridViewComboBoxColumn)dgv.Columns[e.ColumnIndex + 1]).DataSource), \"ID1 = \" + dgv.CurrentCell.Value, \"DisplayOrder\", DataViewRowState.CurrentRows);\n        if(dv.Count == 0)\n            return;\n\n        cell.DisplayMember = \"Display2\"; // Have to redefine the Display/Value members\n        cell.ValueMember = \"ID2\";\n        cell.DataSource = dv;\n    }\n}\n</code></pre>\n\n<p>And I have added in an event handler for the DataError like he suggested:</p>\n\n<pre><code>void dg_DataError(object sender, DataGridViewDataErrorEventArgs e)\n{\n    if(e.ColumnIndex != 1)\n    {\n                    //Alert the user for any other DataError's outside of the column I care about\n                    MessageBox.Show(\"The following exception was encountered: \" + e.Exception);\n    }\n}\n</code></pre>\n\n<p>This seems to work perfectly.</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":61,"score":-1,"question_id":13142408,"title":"How to make the background of a picture invisible?","body":"<p>I want to add a picture on a button. But the background colour is different as the button-color.\nHow do I change the background make transparent/invisible?</p>\n\n<p>The background-colour of the picture of this button has to change...</p>\n\n<p><img src=\"http://i.stack.imgur.com/hmTpD.png\" alt=\"enter image description here\"></p>\n\n<p>... to this one</p>\n\n<p><img src=\"http://i.stack.imgur.com/0VskQ.png\" alt=\"enter image description here\"></p>\n\n<p>Thanks, Wes</p>\n"},{"tags":["winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":194,"score":2,"question_id":298059,"title":"Signing application in Visual Studio","body":"<p>I have a windows application project that has to be signed. I received the .spc and .pfx files from my client. I converted these files to .pfx and by right clicking an assembly - Properties - Signing I specified the .pfx file. Everything OK with no errors. The problem is that after compiling the assembly is not signed - the 'Digital Signature' tab when clicking 'Properties' is not present. I use VS 2008.\nDo I miss something?\nThanks</p>\n"},{"tags":["c#","winforms","control","windows-forms-designer","docking"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13142701,"title":"Docking an Encapsulated Control","body":"<p>I have an encapsulated control in a derived <code>TabPage</code>, and I am having trouble docking it to the form <code>MainForm</code> that contains the derived <code>TabPage</code>.</p>\n\n<p>I've added the <code>TabPage</code> and the control correctly, and they are showing up on <code>MainForm</code>. However, the control is not correctly docked (style: fill). You can verify this by resizing the form.</p>\n\n<p>I've set the property <code>_control.Dock = System.Windows.Forms.DockStyle.Fill</code> and <code>_control.Anchor = Left | Right | Top | Bottom</code> in the derived <code>TabPage</code>'s constructor.</p>\n\n<p>Below is the sample of the code:</p>\n\n<pre><code>public class DerivedTab : TabPage {\n    public DerivedTab(){\n        ...\n        _control= new BrightIdeasSoftware.TreeListView();\n        this.Controls.Add(this._control);\n        _control.Anchor = System.Windows.Forms.AnchorStyles.Left | System.Windows.Forms.AnchorStyles.Right | System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom;\n        _control.Dock = System.Windows.Forms.DockStyle.Fill;\n        ...\n    }\n}\n</code></pre>\n\n<p>In the <code>MainForm</code>, this is the function that creates the derived tab in run-time:</p>\n\n<pre><code>    private DerivedTab CreateTab(string name)\n    {\n        DerivedTab tab = new DerivedTab(this, name);\n        tab.SuspendLayout();\n\n        MainTab.Controls.Add(tab);\n        return tab;\n    }\n</code></pre>\n\n<p>Anyways, I generated this code using Visual Studio Designer, and the control docks correctly. I, then, created a class for the tabpage (since I will need many and varying number of these tabs) and copied everything relates to tabpage to the <code>CreateTab</code> function. I moved anything relates to the the property of the tabpage into its constructor. I encapsulated the control in the derived <code>TabPage</code> and moved everything related to the control in the derived tabpage.</p>\n\n<p>So, what I am missing? Is it possible to dock the encapsulated control without implementing an eventhandler function?</p>\n"},{"tags":["winforms","c#-4.0","timer","thread-safety"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13141386,"title":"Threading.Timer crashing my Winform app?","body":"<p>I'm using a Threading.Timer to execute a task on the hour every hour, but when the timer ticks, the app always crashes when processing the code to execute in the tick.  It crashes with no exceptions or warnings, even if I put the whole thin in a try/catch.  Very strange.  Below is my setup and any help would be appreciated!  It seems like crashes when it tries to access the TextBox <code>GrepCmdTextBox</code>, but I thought reading from another thread was okay, just not writing.</p>\n\n<p>Setting up timer:<br></p>\n\n<pre><code>var timeOfDay = DateTime.Now.TimeOfDay;\nvar nextHour = TimeSpan.FromHours(Math.Ceiling(timeOfDay.TotalHours));\nvar delta = (nextHour - timeOfDay).TotalMilliseconds;\nSystem.Threading.Timer NextHourTimer = new System.Threading.Timer(new System.Threading.TimerCallback(NextHourTimer_Tick), null, (long)delta, (long)TimeSpan.FromHours(1).TotalMilliseconds);\n</code></pre>\n\n<p>Tick event:<br></p>\n\n<pre><code>private void NextHourTimer_Tick(object sender)\n    {\n        // If thread is not null and is busy, cancel and restart\n        if (MonitoringThread != null)\n        {\n            if (MonitoringThread.TailThread.IsBusy)\n            {\n                MonitoringThread.TailThread.CancelAsync();\n                System.Threading.Thread.Sleep(50);\n\n                // Get grep command, if specified\n                string optionalGrep = String.Empty;\n                if (GrepCmdTextBox.Text.StartsWith(\"grep\") || GrepCmdTextBox.Text.StartsWith(\"egrep\"))\n                    optionalGrep = \" | \" + GrepCmdTextBox.Text;\n\n                MonitoringThread.TailThread.RunWorkerAsync(optionalGrep);\n            }\n        }\n    }\n</code></pre>\n"},{"tags":["c#","winforms","layout"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":48,"score":4,"question_id":13142318,"title":"Simple and advanced layout","body":"<p>I'm currently developing an application in C# that will have two layouts: simple and advanced.</p>\n\n<p>The simple layout would have 4 objects (2 buttons and 2 text controls) and the advanced layout would have 8 objects.</p>\n\n<p>What would be the best way to do this? Having two forms? Or set the <code>button.visible</code> to true/false (and for each object?).</p>\n"},{"tags":["c#","winforms","visual-studio-2010","visual-studio","backgroundworker"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":20,"score":2,"question_id":13142000,"title":"No threads displayed in the Threads Debug Window","body":"<p>I am trying to track my BackgroundWorker threads as described in <a href=\"http://devpinoy.org/blogs/jakelite/archive/2009/01/10/5-tips-on-debugging-multi-threaded-code-in-visual-studio-net.aspx\" rel=\"nofollow\">this article</a> the Threads Debug Windows is empty:</p>\n\n<p><img src=\"http://i.stack.imgur.com/T0RB6.png\" alt=\"enter image description here\"></p>\n\n<p>And yes, <a href=\"http://stackoverflow.com/a/799551/869501\">I'm debugging</a>.</p>\n\n<p>What am I missing?</p>\n"},{"tags":["c#","winforms","design","menustrip"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12963208,"title":"How to change the design of a menu strip?","body":"<p>When I create a new menu strip in Visual Studio it has an ugly design.\n<img src=\"http://i.stack.imgur.com/IkMW4.png\" alt=\"Ugly design\"><bR><bR>\nI tried to change the backgroundcolor and backgroundimage but it just got uglier than before.</p>\n\n<p>How to change it to the \"normal\" Design?<br>\n<img src=\"http://i.stack.imgur.com/pQrR2.png\" alt=\"&quot;normal&quot; design\"></p>\n"},{"tags":["c#","winforms","treeview"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13141473,"title":"Find width of a tree node","body":"<p>I need to find out the width of a selected node in a treeView control.</p>\n\n<p>The text to the node is being added through button click and sometimes the text is large inside the node then it messing up all the design of my form. I tried so much but I cant find any properties existing which can find the width of a node (may be there can be). If it is a silly question give the answer in comment, so that I can delete the question later.</p>\n\n<p>Please help\n<br>Thanks in Advance</p>\n"},{"tags":["c#","winforms"],"answer_count":7,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":13141663,"title":"How to parse a text removing a char","body":"<p>Let's start with that i have a txtProbe(textbox) and there i have 12-34-56-78-90. I want to parse them in different labels or textboxes ... For now just in one textbox - txtParse. I tried with that code - I'm removing the \"-\" and then tried to display them but nothing happens:</p>\n\n<pre><code>{\n        char[] delemiterChars = { '-' };\n        string text = txtProbe.Text;\n        string[] words = text.Split(delemiterChars);\n        txtParse.Text = text;\n        foreach (string s in words)\n        {\n            txtParse.Text = s;\n        }\n    }\n</code></pre>\n\n<p><strong>EDIT:</strong>\nI want to set the received information in different labels:<br>\n12-label1<br>\n34-label2<br>\n56-label3<br>\n78-label4<br>\n90-label5</p>\n"},{"tags":["c#","winforms","authentication","credentials","provider"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":276,"score":3,"question_id":11527268,"title":"Custom credential Provider able to call on c# application?","body":"<p>I'm currently working on integrating a <code>c#</code> gesture authentication program using the <code>kinect</code> into windows as a form of authentication for part of my final year project. Once the c# program authenticates, there will be an event fired if the gesture supplied is authenticated to be a valid gesture. </p>\n\n<p>So my question is:</p>\n\n<ol>\n<li><p>I'm currently using the <code>sampleHardWareEventCredentialProvider</code> from microsoft. Is it suitable for what I want to achieve?</p></li>\n<li><p>Can the custom credential provider be coded in such a way that it can call my c# program to do the authenticating and return an event to the credentialProvider whether the authentication was a success or not? If yes, could anyone kindly point me in the right direction? </p></li>\n</ol>\n"},{"tags":["c#","winforms","setup-deployment"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13140890,"title":"Getting username and password while installing the application","body":"<p>i created one sample application and one setup project that getting the user name and password from user by following the steps described in <a href=\"http://www.codeproject.com/Articles/12780/A-Setup-and-Deployment-project-that-passes-paramet\" rel=\"nofollow\">this link</a>.</p>\n\n<p>but actually my requirement is to prevent the installation if the username and password fields are empty.\ni used the following code</p>\n\n<pre><code> public override void Install(System.Collections.IDictionary stateSaver)\n    {\n\n        base.Install(stateSaver);\n\n        string targetDirectory = Context.Parameters[\"t\"];\n\n        string username = Context.Parameters[\"username\"];\n\n        string password = Context.Parameters[\"password\"];\n      //  *******code used **********\n        if ((username == \"\" &amp;&amp; password == \"\") || (username == null &amp;&amp; password == null))\n            this.Dispose();\n        //  *******code used **********\n        System.Diagnostics.Debugger.Break();\n\n        string exePath = string.Format(\"{0}userInputWhileInstalling.exe\", targetDirectory);\n\n        Configuration config = ConfigurationManager.OpenExeConfiguration(exePath);\n\n        config.AppSettings.Settings[\"username\"].Value = username;\n\n        config.AppSettings.Settings[\"password\"].Value = password;\n\n\n        config.Save();\n\n    }\n</code></pre>\n\n<p>but its not working. is there any way to implement that???? Please help</p>\n"},{"tags":["winforms","f#"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":102,"score":3,"question_id":13136605,"title":"Object-oriented \"Hello world\" using Windows Forms in F#","body":"<p>I'm currently working my way through \"Real World Functional Programming\". I am trying to get example 1.12 working, a \"hello world\" program using windows forms. This is the code:-</p>\n\n<pre><code>    open System.Drawing;;\n    open System.Windows.Forms;;\n\n    type HelloWindow() =\n         let frm = new Form(Width = 400, Height = 140)\n         let fnt = new Font(\"Times New Roman\", 28.0f)\n         let lbl = new Label(Dock = DockStyle.Fill, Font = fnt,\n                               TextAlign = ContentAlignment.MiddleCenter)\n         do frm.Controls.Add(lbl)\n\n\n         member x.SayHello(name) =\n              let msg = \"Hello\" + name + \"!\"\n              lbl.Text &lt;- msg\n\n         member x.Run() =\n              Application.Run(frm);;\n\n    let hello = new HelloWindow();;\n    hello.SayHello(\"you\");;\n    hello.Run();;\n</code></pre>\n\n<p>Unfortunately, this throws an error - \"Starting a second message loop on a single thread is not a valid operation.\" So obviously there is a window opening and not terminating and that is confusing the program. I can't see how to fix the error, can anyone help me out?</p>\n\n<p>I have also tried inputting the final code block as:-</p>\n\n<pre><code>    let hello = new HelloWindow()\n    hello.SayHello(\"you\")\n    hello.Run();;\n</code></pre>\n\n<p>But that does not help. The code runs fine but produces no result with the last line commented out.</p>\n"},{"tags":["c#",".net","winforms","algorithm"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":108,"score":4,"question_id":13127898,"title":"2 in a row c# program game","body":"<p>here is the <a href=\"http://s1119.beta.photobucket.com/user/arled/media/Untitled-4.jpg.html\" rel=\"nofollow\">game board</a> just to give you an idea of how it looks like (this board will be expanded to a 7x6)</p>\n\n<p>what i want to do is detect a winner when 2 colors are in a row similar to the game \"conmect four\" taking into account diagonal combos too. BUT i want to do this with out using brute-force enumeration..</p>\n\n<p>this the code that goes behind the program i have made I'm not asking for solution i just need a bit of help on an effective algorithm</p>\n\n<pre><code>namespace WindowsFormsApplication1\n{\n    public partial class Form1 : Form\n    {\n\n        private Button[] btns;\n        private Button[] btns2;\n\n        public Form1()\n        {\n            InitializeComponent();\n\n            btns = new Button[] { button2, button3 };\n            btns2 = new Button[] { button4, button5 };\n\n\n        }\n\n        private void Form1_Load(object sender, EventArgs e)\n        {\n\n            foreach (var btn in btns)\n            {\n                btn.Enabled = false;\n                btn.BackColor = Color.LightCyan;\n            }\n\n            foreach (var btn in btns2)\n            {\n                btn.Enabled = false;\n                btn.BackColor = Color.LightCyan;\n            }\n        }\n        public int state;\n        int cc = 0;\n        private void button1_Click(object sender, EventArgs e)\n        {\n            foreach (var btn in btns)\n            {\n                  {\n                    if (!btn.Enabled)\n                    {\n                        btn.Enabled = true;\n\n                        if (cc == 0)\n                        {\n                            cc = 1;\n                            btn.BackColor = Color.Red;\n                        }\n                        else\n                        {\n                            cc = 0;\n                            btn.BackColor = Color.Yellow;\n                        }\n                        return;\n                    }\n\n                }\n            }       \n        }\n\n        private void button6_Click(object sender, EventArgs e)\n        {\n            foreach (var btn in btns2)\n            {\n                if (!btn.Enabled)\n                {\n                    btn.Enabled = true;\n\n                    if (cc == 0)\n                    {\n                        cc = 1;\n                        btn.BackColor = Color.Red;\n                    }\n                    else\n                    {\n                        cc = 0;\n                        btn.BackColor = Color.Yellow;\n\n                    }\n\n                    return;\n                }\n            }\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","winforms",".net-4.0","backgroundworker","watchdog"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13139691,"title":"Is BackgroundWorker's IsBusy same as \"IsAlive\"?","body":"<p>I am trying to figure out a way to verify that a BackgroundWorker thread is alive (i.e. still running. The thread is essentially implemented as a simple infinite loop:</p>\n\n<pre><code>      while (AllConditionsMet())\n      {\n        DoSomeMagic();\n        Thread.Sleep(10000);\n      }\n</code></pre>\n\n<p>The closest thing to <code>IsAlive()</code> I found so far is the <a href=\"http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.isbusy%28v=vs.100%29.aspx\" rel=\"nofollow\">IsBusy</a> property, but given that my thread Sleep()s most of the time, I am not sure whether this will do the job.</p>\n\n<p>Can I count on <a href=\"http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.isbusy%28v=vs.100%29.aspx\" rel=\"nofollow\">IsBusy</a> to do:</p>\n\n<pre><code>if (!myWorker.IsBusy)\n  RestartWorker();\n</code></pre>\n\n<p>or am I calling for trouble?</p>\n"},{"tags":["c#","wpf","winforms","printdialog","windowsformsintegration"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13140069,"title":"Call PrintDialog.ShowDialog() in a WPF UserControl which is hosted in WinForms Application","body":"<p>I have a WPF UserControl which use the System.Windows.Controls.PrintDialog:</p>\n\n<p>XAML:</p>\n\n<pre><code>&lt;UserControl x:Class=\"WpfControlLibrary1.UserControl1\"\n         xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n         xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;    \n   &lt;Button Click=\"Button_Click\"/&gt;\n&lt;/UserControl&gt;\n</code></pre>\n\n<p>CodeBehind:</p>\n\n<pre><code>namespace WpfControlLibrary1\n{\n   using System.Windows;\n   using System.Windows.Controls;\n\n   public partial class UserControl1 : UserControl\n   {\n      public UserControl1()\n      {\n         InitializeComponent();\n      }\n\n      private void Button_Click(object sender, RoutedEventArgs e)\n      {\n         var printer = new PrintDialog();\n         printer.ShowDialog();\n      }\n   }\n}\n</code></pre>\n\n<p>If I use now this UserControl in a WPF Appplication the PrintDialog-Windows appears as modal dialog. (Like described in msdn)</p>\n\n<p>But if I use the UserControl in a Wondows-Forms application, the dialog appears as a NON-Modal dialog.</p>\n\n<p>Anyone an idea how I can call the PrintDialog as modal dialog when I host the usercontrol in a Windows-Forms application?</p>\n\n<p>Thanking you in anticipation\nrhe1980</p>\n"},{"tags":["c#",".net","winforms","inheritance","windows-forms-designer"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13139776,"title":"Prevent 'Items' property from persisting in inherited ComboBox","body":"<p>I've got a very simple control which inherits directly from a <code>ComboBox</code>.</p>\n\n<p>In my constructor, I populate the <code>ComboBox</code> with a list of values, this works fine, until I edit the <code>Form</code> layout in the designer. When it's edited, it calls the containing <code>Form</code>'s <code>InitializeComponent</code>, which populates the control. When I save this form, it persists the values to the containing <code>Form</code>'s <code>InitilaiseComponent</code>, which I don't want.</p>\n\n<p>I can see a few solutions to this, but not sure which is the right approach.</p>\n\n<ol>\n<li><p>When populating the list, ensure that the <code>DesignMode</code> property is set to false before populating.</p></li>\n<li><p>Somehow hide the <code>Items</code> property from the designer. I've tried to do this using override and new, with the relevant attributes (<code>DesignTimeVisible</code>) set to hidden, but it still appears in the designer, and still persists my list.</p></li>\n<li><p>I read somewhere about using <code>ISupportInitilize</code>, but this is also called from the designer, and fills my <code>Form</code>'s designer with the values.</p></li>\n<li><p>Create a new method on my control, which populates the list, and call this from my code at run time.</p></li>\n</ol>\n\n<p>Thanks in advance.</p>\n\n<p>Rich.</p>\n"},{"tags":["winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":11,"score":-1,"question_id":13138304,"title":"Events for panel control in window application?","body":"<p>In window forms, how to create user define events to panel control, any reference could be appreciate.</p>\n"},{"tags":["c#",".net","winforms","resources"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13136095,"title":"WinForms default Resource file for project","body":"<p>We're building an application using WinForms (.NET 3.5)</p>\n\n<p>I am familiar with the concept of <em>Resources</em>, however i don't follow the idea of default Resources per project.</p>\n\n<p>In our project i see the usage of resources (RESX files) in the following contexts:</p>\n\n<ol>\n<li>Per Project (Set in the project's properties under the Resources tab)</li>\n<li>Per Control (Form for example) -- our main Form has an accompanying RESX file (expanded under the .cs file in VS)</li>\n</ol>\n\n<p>What is the difference between the 2? </p>\n\n<p>On one hand, having resources per form seems logically correct, but i cannot select Images for example from the specific form resource (only from the global one)</p>\n\n<p>What is wrong here and how should the 2 be used?</p>\n"},{"tags":["c#",".net","winforms","wcf","network-programming"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":13137201,"title":"How to pass values between two independent winform applications each on different machines in C#.net","body":"<p>*<strong>I have two winform applications coded in C# each on different applications.\nAnd now I want to pass values between them</strong>..*It can be done easily in case of websites but how to do that in winform appications.</p>\n\n<p><strong>Please Remember these forms are not parent and child forms of the same applications.But they are forms of two different applications.</strong></p>\n\n<p><strong>Logic</strong>:Actually,I will be doing some validation on 1 machine based on encounterId. And if the encounter Id is validated,Then I want to run an exe(programed in C# my me only) on different machine.(i.e. I plan to send that validated encounter ID on 2nd machine and open the exe with the person details related with that validated encounter)</p>\n"},{"tags":["c#","winforms","performance"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13136157,"title":"Application performance when using user controls C#","body":"<p>I'm working on somewhat large application that is divided into groups by functionality. Since every functionality is mostly independent (they all use the same database, but there is no direct interaction between different functionalities), I'm using the user defined controls and treating them as individual \"applications\". The way the application works is this:</p>\n\n<ul>\n<li>The \"root\" application only contains the main menu and 2 panels. The main menu is used to select the group of functionalities.</li>\n<li>After the group is selected (on application startup the first group is automatically selected), the functionalities (represented by buttons) from that group are displayed in the first panel.</li>\n<li><p>The user selects the functionality (by clicking on the appropriate button) he/she wants and the user control that contains the \"form\" is displayed in the second panel.\nThe code that displays all of the user controls looks like this:</p>\n\n<pre><code>    panel2.Controls.Clear();\n    UserControl1 uc1 = new UserControl1();\n    uc1.Location = new Point(0, 0);\n    panel2.Controls.Add(uc1);\n    label6.Text = \"User control 1\";\n</code></pre></li>\n</ul>\n\n<p>So, when the user selects one of the functionalities, the application clears existing controls, and displays the selected one.\nThe application works fine (the part I implemented so far), so this is my question - how does this approach manage computer resources, mainly the memory. Specifically, if the user uses one functionality, and then switches to another one, will the .NET's services release the memory used by the previous functionality (I think garbage collector is in charge of that) and will the SQL connections, that I use to communicate with the database, be closed?\nAlso, are there some other issues that I should be aware of?\nAs I said, the functionalities work properly, but I'm still very far from full testing of the application as a whole (I only test every functionality individually when I create it, and only on the computer I create it on, so I can't consider it as a proper testing). Because of that, I am worried that the application's performances might deteriorate if the application is constantly used over a longer period of time.\nI'm using VS 2010 (C#) and SQL Server 2005 to create this application.\nIf you have any suggestions, please write them. With this question, I'm trying to prevent major reconstructions of the application once it comes to the phase of testing and implementing due to bad resource management.\nThanks.</p>\n"},{"tags":["c#",".net","winforms","contextmenu"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13135577,"title":"Add a custom menu item to the Context Menu in Windows Forms","body":"<p>I have a windows application. Now When I right click on the file, I am getting a context menu.</p>\n\n<p><img src=\"http://i.stack.imgur.com/jVR0h.png\" alt=\"enter image description here\"></p>\n\n<p>What I want is to add a custom menu item in that built in Context Menu. e.g. \"My custom Menu \" in this case.</p>\n\n<p><img src=\"http://i.stack.imgur.com/wLU4W.png\" alt=\"enter image description here\"></p>\n\n<p>How can I do this? Any link or some sort of reference point will be very helpful. I am using C#</p>\n\n<p>Many thanks in advance.</p>\n"},{"tags":["c#","winforms","google-maps"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13136403,"title":"use gmaps long/lat values in winforms","body":"<p>i am newbie at using google maps in a winforms.\ni would like help:\ni have gmaps in my program but i want the coordinates to appear in the long/lat textbox when i click anywhere on the map. and the user can save those coordinates </p>\n\n<pre><code>internal void LoadMap()\n    {\n        gMapVenues.MapProvider = GMap.NET.MapProviders.GMapProviders.GoogleMap;\n        gMapVenues.MinZoom = 3;\n        gMapVenues.MaxZoom = 17;\n        gMapVenues.Zoom = 4;\n        gMapVenues.Manager.Mode = GMap.NET.AccessMode.ServerAndCache;\n        gMapVenues.Position = new PointLatLng(-33.91530000, 18.42560000);\n\n        GMapOverlay overlayOne = new GMapOverlay(\"OverlayOne\");\n        gMapVenues.Overlays.Add(overlayOne);\n\n    }\n</code></pre>\n"},{"tags":["c#",".net","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":13135082,"title":"how to exclude control from a WinForm.Opacity in C#","body":"<p>I have a form that i set it's Opacity as 50% like this:</p>\n\n<pre><code>this.Opacity = 0.5D; &lt;--this==Form\n</code></pre>\n\n<p>My problem is that everything that on the form is with an Opacity of 50%</p>\n\n<p>I have two buttons on the form and I want them without Opacity.</p>\n\n<p><strong>I know that <code>this.Opacity</code> included all Controls and for some reason the graphics too</strong></p>\n\n<p>My question is, How to Exclude the Opacity of the controls?</p>\n\n<p>Example Image:\n<img src=\"http://i.stack.imgur.com/ev8NU.png\" alt=\"example 2\"></p>\n\n<p>Thanks!</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13135773,"title":"Draw border Rectangle for control placed inside container controls. WinForms","body":"<p>I need to draw border for a control with resize handles. I used the ControlPaint.DrawBorder and ControlPaint.DrawGrabHandle for drawing the borders. Sample code provided below.</p>\n\n<pre><code>Rectangle Border = new Rectangle(\n            new Point(control.Location.X - DRAG_HANDLE_SIZE / 2,\n                control.Location.Y - DRAG_HANDLE_SIZE / 2),\n            new Size(control.Size.Width + DRAG_HANDLE_SIZE,\n                control.Size.Height + DRAG_HANDLE_SIZE));\nRectangle NW = new Rectangle(\n            new Point(control.Location.X - DRAG_HANDLE_SIZE,\n                control.Location.Y - DRAG_HANDLE_SIZE),\n            new Size(DRAG_HANDLE_SIZE, DRAG_HANDLE_SIZE));\n        Rectangle N = new Rectangle(\n            new Point(control.Location.X + control.Width / 2 - DRAG_HANDLE_SIZE / 2,\n                control.Location.Y - DRAG_HANDLE_SIZE),\n            new Size(DRAG_HANDLE_SIZE, DRAG_HANDLE_SIZE));\n        Rectangle NE = new Rectangle(\n            new Point(control.Location.X + control.Width,\n                control.Location.Y - DRAG_HANDLE_SIZE),\n            new Size(DRAG_HANDLE_SIZE, DRAG_HANDLE_SIZE));\n        Rectangle W = new Rectangle(\n            new Point(control.Location.X - DRAG_HANDLE_SIZE,\n                control.Location.Y + control.Height / 2 - DRAG_HANDLE_SIZE / 2),\n            new Size(DRAG_HANDLE_SIZE, DRAG_HANDLE_SIZE));\n        Rectangle E = new Rectangle(\n            new Point(control.Location.X + control.Width,\n                control.Location.Y + control.Height / 2 - DRAG_HANDLE_SIZE / 2),\n            new Size(DRAG_HANDLE_SIZE, DRAG_HANDLE_SIZE));\n        Rectangle SW = new Rectangle(\n            new Point(control.Location.X - DRAG_HANDLE_SIZE,\n                control.Location.Y + control.Height),\n            new Size(DRAG_HANDLE_SIZE, DRAG_HANDLE_SIZE));\n        Rectangle S = new Rectangle(\n            new Point(control.Location.X + control.Width / 2 - DRAG_HANDLE_SIZE / 2,\n                control.Location.Y + control.Height),\n            new Size(DRAG_HANDLE_SIZE, DRAG_HANDLE_SIZE));\n        Rectangle SE = new Rectangle(\n            new Point(control.Location.X + control.Width,\n                control.Location.Y + control.Height),\n            new Size(DRAG_HANDLE_SIZE, DRAG_HANDLE_SIZE));\n   Graphics g = this.CreateGraphics();\n   ControlPaint.DrawBorder(g, Border, Color.Gray, ButtonBorderStyle.Dotted);\n        ControlPaint.DrawGrabHandle(g, NW, true, true);\n        ControlPaint.DrawGrabHandle(g, N, true, true);\n        ControlPaint.DrawGrabHandle(g, NE, true, true);\n        ControlPaint.DrawGrabHandle(g, W, true, true);\n        ControlPaint.DrawGrabHandle(g, E, true, true);\n        ControlPaint.DrawGrabHandle(g, SW, true, true);\n        ControlPaint.DrawGrabHandle(g, S, true, true);\n        ControlPaint.DrawGrabHandle(g, SE, true, true);\n        g.Dispose();\n</code></pre>\n\n<p>I am having trouble while drawing the control border for the controls placed inside container controls. For Example when i have a button placed inside a panel I am unable to set the border.</p>\n"},{"tags":["c++","winforms","visual-studio-2008","executable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13135330,"title":"Error while executing .exe result of my code but no when executing it in the debugger","body":"<p>I have a problem regarding the result of my program. I have a bi winforms application that makes a lot of things. One of them is visualizing a bunch of data I have stored in several .txt files in a given directory. It takes one, read it, close it and then visualize it before reading the next one.</p>\n\n<p>My problem is that if I just execute the program, tell it the directory of the files and ask for visualizing, after reading 2 or 3 files it crashes because a memory access violation. But if I reproduce the exact steps while executing from the debugger of visual studio there is not any error nor warning nor nothing, it just works fine. </p>\n\n<p>I know that the debugger is exactly that, a debugger, and thing execute differently in a debugger, but I dont have any idea why this happens. </p>\n\n<p>Any idea why my program crashes? Or what should I do for avoiding a crash?</p>\n\n<p>I know my question may be too ambiguous, but I don't have other method to show you my problem, unless you want me to post a 20.000 lines code :) .</p>\n\n<p>Thanks in advance. </p>\n"},{"tags":["c#","winforms","sql-server-2008"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":38,"score":-1,"question_id":13134035,"title":"Saving data into two tables","body":"<p>I have two tables in my SQL Server 2008 database, one contains all the information about employee including image &amp; ID also and in another table having storing the image &amp; ID &amp; Image path....</p>\n\n<p>Can I use </p>\n\n<pre><code>insert into table1(e_imagedata) \nvalues(@ImageData1) \nwhere table2.e_id = table1.e_id\n</code></pre>\n\n<p>In SQL Server this query for inserting image in <code>table2</code> &amp; directly it will considered to <code>table1</code>... it doesn't work for now...</p>\n"},{"tags":[".net","winforms","licensing","license-key"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":45,"score":-3,"question_id":13134511,"title":"Perfect Trial Version in .NET","body":"<p>I want to create window application with trial version, which will expire after actual 30 days.\nIt Should not depend on machine date.\nLike Quick Heal / Adobe Photoshop.\nHow to Create such trial versions that does not depend on <code>System.DateTime</code>.</p>\n"},{"tags":["c#","winforms","mono","embedded-linux"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13131709,"title":"C# Windows Form Program on ARM Linux based on QT with MONO","body":"<p>Command Link Programme is Ok.</p>\n\n<p>When I run Windows Form Program, Error message shows:</p>\n\n<pre><code>Unhandled Exception: System.TypeInitializationException: An exception was thrown by the type initializer for System.Windows.Forms.XplatUI ---&gt; System.DllNotFoundException: libX11.so\nat (wrapper managed-to-native) System.Windows.Forms.XplatUIX11:XInitThreads ()\nat System.Windows.Forms.XplatUIX11..ctor () [0x00000] in &lt;filename unknown&gt;:0\nat System.Windows.Forms.XplatUIX11.GetInstance () [0x00000] in &lt;filename unknown&gt;:0\nat System.Windows.Forms.XplatUI..cctor () [0x00000] in &lt;filename unknown&gt;:0\n--- End of inner exception stack trace ---\nat System.Windows.Forms.Application.EnableVisualStyles () [0x00000] in &lt;filename unknown&gt;:0\nat WindowsFormsApplication1.Program.Main () [0x00000] in &lt;filename unknown&gt;:0\n</code></pre>\n\n<p>And My arm Linux's GUI is based on QT.</p>\n\n<p>What shoud I do?</p>\n\n<p>Build X11 library or build GTK#?</p>\n\n<p>My thought isnot clear now. Could you give me some guides and Reference materials?</p>\n\n<p>Thanks.</p>\n"},{"tags":["winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13133131,"title":"Change the location of the window form in c#?","body":"<p>In window application, using c# i created one form and put visible false  minimize, maximize button and formborder to none, i place one panel at top of the form, in that panel i place close, minimize buttons. Now how can i drag the window form. Any reference please. my code is</p>\n\n<pre><code>        this.ControlBox = false;\n        this.MaximizeBox = false;\n        this.MinimizeBox = false;\n        this.FormBorderStyle = FormBorderStyle.None;\n</code></pre>\n\n<p>Thank you.</p>\n"},{"tags":["c#",".net","winforms","app-config"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":67,"score":3,"question_id":13046907,"title":"User vs Application Scope","body":"<p>I have added App.config file in my project.\nI have created two settings from Project > Properties > Settings panel - </p>\n\n<p><img src=\"http://i.stack.imgur.com/NsJaO.png\" alt=\"enter image description here\"></p>\n\n<p>I have noticed that when Im adding a setting, I can define scope as <code>User</code> or <code>Application</code>. -</p>\n\n<ol>\n<li>User</li>\n<li>Application</li>\n</ol>\n\n<p>If I define setting as <code>User</code> it goes to<code>userSettings</code> section for <code>Application</code> it goes to <code>applicationSettings</code> section - </p>\n\n<p><strong>App.config -</strong></p>\n\n<pre><code>&lt;configuration&gt;\n\n    &lt;userSettings&gt;\n        &lt;DemoApp.Properties.Settings&gt;\n            &lt;setting name=\"MySetting1\" serializeAs=\"String\"&gt;\n                &lt;value&gt;Value1&lt;/value&gt;\n            &lt;/setting&gt;\n        &lt;/DemoApp.Properties.Settings&gt;\n    &lt;/userSettings&gt;\n\n    &lt;applicationSettings&gt;\n        &lt;DemoApp.Properties.Settings&gt;\n            &lt;setting name=\"MySetting2\" serializeAs=\"String\"&gt;\n                &lt;value&gt;Value2&lt;/value&gt;\n            &lt;/setting&gt;\n        &lt;/DemoApp.Properties.Settings&gt;\n    &lt;/applicationSettings&gt;\n\n&lt;/configuration&gt;\n</code></pre>\n\n<p>But, these settings can be accessed in the same way from <code>.cs</code> -</p>\n\n<p><strong>Code -</strong></p>\n\n<pre><code>string mySetting1 = DemoApp.Properties.Settings.Default.MySetting1;\nstring mySetting2 = DemoApp.Properties.Settings.Default.MySetting1;\n</code></pre>\n\n<p>What is the difference between <code>User</code> and <code>Application</code> scope and under what circumstances one should choose between these two.</p>\n"},{"tags":["c#","winforms","find-and-replace"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13133866,"title":"Find and replace string based on column and value dataGridView","body":"<p>Hi I have a datagridVew with 5 columns. The user will select any cell and pass the value <code>Str1</code> and <code>Str2</code> for find and replace. But, I want to restrict find &amp; replace to only one column to which the selected cell belongs</p>\n\n<p>How can I do that ?</p>\n"},{"tags":["winforms","datagridview","custom-controls"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13132007,"title":"Why Value is null for Custom Column for datagridview?","body":"<p>i am binding a datatable to the datagridview with custom column.</p>\n\n<p>here's my code for the custom column. </p>\n\n<p>Note : There's no cell editing involved.</p>\n\n<pre><code>public class GridCustomColumnCell : DataGridViewColumn\n{\n    public GridCustomColumnCell() : base(new CustomCell())\n    {\n\n    }\n\n    public override DataGridViewCell CellTemplate\n    {\n        get\n        {\n            return base.CellTemplate;\n        }\n        set\n        {\n            // Ensure that the cell used for the template is a CalendarCell. \n            if (value != null &amp;&amp; !value.GetType().IsAssignableFrom(typeof(CustomCell)))\n            {\n                throw new InvalidCastException(\"Must be a Special Cell\");\n            }\n            base.CellTemplate = value;\n        }\n    }\n}\n\npublic class CustomCell : DataGridViewTextBoxCell\n{\n    private string strID;\n    private string statusID;\n\n    public CustomCell() : base()\n    {\n        string[] data = (string[])Value;\n        if (data != null)\n        {\n            strID = data[0];\n            statusID = data[1];\n        }\n    }\n\n    private static readonly StringFormat strFmt = new StringFormat(StringFormatFlags.NoWrap);\n    protected override void Paint(Graphics graphics, Rectangle clipBounds, \n                                  Rectangle cellBounds, int rowIndex, \n                                  DataGridViewElementStates cellState, \n                                  object value, object formattedValue, \n                                  string errorText, \n                                  DataGridViewCellStyle cellStyle, \n                                  DataGridViewAdvancedBorderStyle advancedBorderStyle, \n                                  DataGridViewPaintParts paintParts)\n    {\n        base.Paint(graphics, clipBounds, cellBounds, rowIndex, cellState, value, \n                   formattedValue, errorText, cellStyle, advancedBorderStyle, \n                   paintParts);\n\n        DataGridViewCellStyle cstyle = new DataGridViewCellStyle();\n        cstyle.Font = new Font(FontFamily.GenericSansSerif, 16, FontStyle.Bold);\n        graphics.FillRectangle(Brushes.GreenYellow, cellBounds);\n        graphics.DrawString(\" \\n\\n\", cellStyle.Font, Brushes.Black, cellBounds);\n        graphics.DrawString(\"  \" + statusID + \"\", cstyle.Font, Brushes.Black, \n                            cellBounds);\n        graphics.DrawString(\"\\n\\n\\n  \" + strID + \"\", cellStyle.Font, \n                            Brushes.Blue, cellBounds);\n    }\n\n    protected override void OnMouseClick(DataGridViewCellMouseEventArgs e)\n    {\n        base.OnMouseClick(e);\n        ContextMenuStrip cs = new ContextMenuStrip();\n        cs.Items.Add(\"Fsdfsfs \");\n        //  cs.Items.Add()\n        if (e.Button == MouseButtons.Right)\n            cs.Show(Cursor.Position);\n    }\n\n    public override Type ValueType\n    {\n        get\n        {\n            // Return the type of the value that CalendarCell contains.    \n            return typeof(String[]);\n        }\n    }\n\n    public override object DefaultNewRowValue\n    {\n        get\n        {\n            // Use the current date and time as the default value. \n            return null;\n        }\n    }\n}\n</code></pre>\n\n<p>Here's my code for databinding:</p>\n\n<pre><code>try\n{\n    FrameFactory ff = new FrameFactory();\n    ff.NewFrame(\"C:\\\\XMLsample\\\\s1.xml\");\n\n    GridCustomColumnCell cc = new GridCustomColumnCell();\n    cc.Resizable = DataGridViewTriState.False;\n    cc.DataPropertyName = \"test\";\n\n    gridMain.Columns.Add(cc);\n    gridMain.ReadOnly = true;\n    this.gridMain.RowCount = 5;\n    foreach (DataGridViewRow row in this.gridMain.Rows)\n    {\n        row.Cells[0].Value = new string[] { \"1\", \"2\" };\n    }\n    //DataTable dt = new System.Data.DataTable();\n    //dt.Columns.Add(\"test\", Type.GetType(\"System.String\").MakeArrayType());\n    //DataRow dr = dt.NewRow();\n    //dr[0] = new string[] { \"1\", \"2\" };\n    //dt.Rows.Add(dr);\n    //gridMain.DataSource = dt;\n\n    //   dt.Row\n}\ncatch (Exception ex)\n{\n    MessageBox.Show(ex.Message);\n}\n</code></pre>\n\n<p>Even with datatable direct binding, the <strong>value</strong> is null under the <strong>DataGridViewTextBoxCell</strong></p>\n\n<p>Anyone can help me with the missing piece of code ?</p>\n"},{"tags":["mysql","vb.net","winforms","visual-studio-2010","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13133068,"title":"VB.NET and MySql UPDATE query","body":"<p>I have my codes here without errors (at least not when I Debug it, I use <code>VS 2010</code>), but what I wish to happen is when I click on the add button, the number/s in the textbox(txtQty) would add to the numbers currently saved in the column \"Quantity\". (ex: txtQty \"100\" and current on the column is \"200\", I want to add \"100\" from the textbox to the column which has \"200\" and save it as a new number \"300\". Simple math I know, but the problem is I have yet to know how to use math equations on <code>VB.NET</code> <code>Datagridview</code> or <code>MySql Database</code> This Code executes but when I click Add the numbers in the column return to 0. Any Hint or Tips would be much appreciated, thanks.</p>\n\n<pre><code>        cmd.Connection = conn\n\n        Dim Result = \"Quantity\" + txtQty.Text\n\n        cmd.CommandText = \" UPDATE incomingdeliveries SET Quantity ='\" &amp; Result &amp; \"';\"\n        cmd.Parameters.Add(New MySqlParameter(\"@Quantity\", txtQty.Text))\n\n        cmd.ExecuteNonQuery()\n\n        MsgBox(\"Data Added to the Database\")\n\n            Me.IncomingdeliveriesTableAdapter.Dispose()\n        Me.IncomingdeliveriesTableAdapter.Fill(Me.IncomingDeliveriesDataSet.incomingdeliveries)\n\n            lblCode.Text = (\"Tables Refreshed!\")\n</code></pre>\n"},{"tags":["c#",".net","winforms",".net-4.5"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":79,"score":2,"question_id":13130620,"title":"Cannot write settings on app.config (or no changes are shown)","body":"<p>I'm creating an application on .net framework 4.5 </p>\n\n<p>whenever i want to load the app config values (appSettings section) and write the changes, i don't see my changes if i refresh the section. What i am doing wrong? and how can i solve it?</p>\n\n<p>code</p>\n\n<pre><code>    private void LoadConfig()\n    {\n        NameValueCollection appSettings = ConfigurationManager.AppSettings;\n        for (int i = 0; i &lt; appSettings.Count; i++)\n        {\n            switch (appSettings.GetKey(i))\n            {\n                case \"initialCatalog\":\n                    txtInitialCatalog.Text = appSettings.GetValues(i)[0];\n                    break;\n                case \"dataSource\":\n                    txtDatasource.Text = appSettings.GetValues(i)[0];\n                    break;\n                case \"userName\":\n                    txtUsername.Text = appSettings.GetValues(i)[0];\n                    break;\n                case \"password\":\n                    txtPassword.Text = appSettings.GetValues(i)[0];\n                    break;\n                case \"portalUrl\":\n                    txtUrl.Text = appSettings.GetValues(i)[0];\n                    break;\n            }\n        }\n    }\n\n    private void SaveConfig()\n    {\n        System.Configuration.Configuration config = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);\n        KeyValueConfigurationCollection appSettings = config.AppSettings.Settings;\n        appSettings[\"initialCatalog\"].Value = txtInitialCatalog.Text;\n        appSettings[\"dataSource\"].Value = txtDatasource.Text;\n        appSettings[\"userName\"].Value = txtUsername.Text;\n        appSettings[\"password\"].Value = txtPassword.Text;\n        appSettings[\"portalUrl\"].Value = txtUrl.Text;\n        config.Save(ConfigurationSaveMode.Modified);\n        ConfigurationManager.RefreshSection(\"appSettings\");\n    }\n</code></pre>\n\n<p>App.config file</p>\n\n<pre><code>&lt;configuration&gt;\n  &lt;startup&gt;\n    &lt;supportedRuntime version=\"v4.0\" sku=\".NETFramework,Version=v4.5\" /&gt;\n  &lt;/startup&gt;\n  &lt;appSettings&gt;\n    &lt;add key=\"initialCatalog\" value=\"a\" /&gt;\n    &lt;add key=\"dataSource\" value=\"b\" /&gt;\n    &lt;add key=\"password\" value=\"c\" /&gt;\n    &lt;add key=\"userName\" value=\"d\" /&gt;\n    &lt;add key=\"portalUrl\" value=\"e\" /&gt;\n    &lt;add key=\"poolingTime\" value=\"60000\" /&gt;\n    &lt;add key=\"ClientSettingsProvider.ServiceUri\" value=\"\" /&gt;\n  &lt;/appSettings&gt;\n</code></pre>\n\n<p>i call ReadConfig() when the forms is Activated and save the data when a button is pressed (Ok or Apply) i close the application i rerun it but no changes are made to the app.config file </p>\n\n<p>any ideas???</p>\n"},{"tags":["c#","winforms","windows-key"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":732,"score":0,"question_id":8784093,"title":"Custom Lock Screen in windows application using C#","body":"<p>We created a custom Lock Screen for windows application. There is a hot key which is global in the application. The application is a multithreading and many forms are there. A user may be in any form doing anything but when he wants to take a break for coffee or tea he will just press Ctrl + L \"the global hot key\" and the screen will lock and will ask the users password to unlock. To create this we used a form, make it to take entire screen, a picture will be moving on the screen at random position and a textbox to input the password to unlock it again. During the lock we are disabling the the windows special keys such as LWin,RWin,Ctrl +Esc,Alt + Tab, Alt + Esc, Alt + F4 etc etc. But the moment user enters the correct password all this keys will be enable again. We creating this Lock screen in the 1st thread. Every this works fine. The problem is that when user is in other form which is on other thread and try to lock or if user just for fun tries to lock and unlock multiple times  it its shows Exception. And the exception is shown in the function where we disabling or enabling the windows special keys.\nException Details: System.AccessViolationException: Attempted to read or write protected memory. This is often an indication that other memory is corrupt.</p>\n\n<pre><code>[StructLayout(LayoutKind.Sequential)]\n        private struct KBDLLHOOKSTRUCT\n        {\n            public Keys key;\n            public int scanCode;\n            public int flags;\n            public int time;\n            public IntPtr extra;\n        }\n        //System level functions to be used for hook and unhook keyboard input  \n        private delegate IntPtr LowLevelKeyboardProc(int nCode, IntPtr wParam, IntPtr lParam);\n        [DllImport(\"user32.dll\", CharSet = CharSet.Auto, SetLastError = true)]\n        private static extern IntPtr SetWindowsHookEx(int id, LowLevelKeyboardProc callback, IntPtr hMod, uint dwThreadId);\n        [DllImport(\"user32.dll\", CharSet = CharSet.Auto, SetLastError = true)]\n        private static extern bool UnhookWindowsHookEx(IntPtr hook);\n        [DllImport(\"user32.dll\", CharSet = CharSet.Auto, SetLastError = true)]\n        private static extern IntPtr CallNextHookEx(IntPtr hook, int nCode, IntPtr wp, IntPtr lp);\n        [DllImport(\"kernel32.dll\", CharSet = CharSet.Auto, SetLastError = true)]\n        private static extern IntPtr GetModuleHandle(string name);\n        [DllImport(\"user32.dll\", CharSet = CharSet.Auto)]\n        private static extern short GetAsyncKeyState(Keys key);\n        //Declaring Global objects     \n        private IntPtr ptrHook;\n        private LowLevelKeyboardProc objKeyboardProcess;\n</code></pre>\n\n<p>Lock Function:-</p>\n\n<pre><code>private IntPtr captureKey(int nCode, IntPtr wp, IntPtr lp)\n        {\n            if (nCode &gt;= 0)\n            {\n                KBDLLHOOKSTRUCT objKeyInfo = (KBDLLHOOKSTRUCT)Marshal.PtrToStructure(lp, typeof(KBDLLHOOKSTRUCT));\n\n                // Disabling Windows keys \n\n                if (objKeyInfo.key == Keys.RWin || objKeyInfo.key == Keys.LWin || objKeyInfo.key == Keys.Tab &amp;&amp; HasAltModifier(objKeyInfo.flags) || objKeyInfo.key == Keys.Escape &amp;&amp; (ModifierKeys &amp; Keys.Control) == Keys.Control || objKeyInfo.key == Keys.Escape &amp;&amp; (ModifierKeys &amp; Keys.Alt) == Keys.Alt || (ModifierKeys &amp; Keys.Alt) == Keys.Alt &amp;&amp; objKeyInfo.key == Keys.F4)\n                {\n                    return (IntPtr)1; // if 0 is returned then All the above keys will be enabled\n                }\n            }\n            return CallNextHookEx(ptrHook, nCode, wp, lp);///////*******************\n        }\n\nbool HasAltModifier(int flags)\n        {\n            return (flags &amp; 0x20) == 0x20;\n        }\n</code></pre>\n\n<p>Unlock Function:-</p>\n\n<pre><code>private IntPtr ReleaseKey(int nCode, IntPtr wp, IntPtr lp)\n        {\n            if (nCode &gt;= 0)\n            {\n                KBDLLHOOKSTRUCT objKeyInfo = (KBDLLHOOKSTRUCT)Marshal.PtrToStructure(lp, typeof(KBDLLHOOKSTRUCT));\n\n                // Disabling Windows keys \n\n                if (objKeyInfo.key == Keys.RWin || objKeyInfo.key == Keys.LWin || objKeyInfo.key == Keys.Tab &amp;&amp; HasAltModifier(objKeyInfo.flags) || objKeyInfo.key == Keys.Escape &amp;&amp; (ModifierKeys &amp; Keys.Control) == Keys.Control || objKeyInfo.key == Keys.Escape &amp;&amp; (ModifierKeys &amp; Keys.Alt) == Keys.Alt || (ModifierKeys &amp; Keys.Alt) == Keys.Alt &amp;&amp; objKeyInfo.key == Keys.F4)\n                {\n                    return (IntPtr)0; // if 0 is returned then All the above keys will be enabled\n                }\n            }\n            return CallNextHookEx(ptrHook, nCode, wp, lp);///////*******************\n        }\n</code></pre>\n\n<p>//<strong><em>*</em>**<em>*</em>*</strong> Place where Exception Occurs. </p>\n\n<p><strong>CallbackOnCollectedDelegate was detected Message: A callback was made on a garbage collected delegate of type 'Demo!_Demo.DialogBox.lock_frm+LowLevelKeyboardProc::Invoke'. This may cause application crashes, corruption and data loss. When passing delegates to unmanaged code, they must be kept alive by the managed application until it is guaranteed that they will never be called.</strong></p>\n"},{"tags":["c#",".net","winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":23,"score":-1,"question_id":13132666,"title":"Property Grid - Boolean DataType issue","body":"<p>In my property grid ( Dynamically assigned from XML ) When a boolean variable is 'False' I am able to change it to True. But when boolean variable is True, not able to change it to False.\nNot sure why?</p>\n"},{"tags":["winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13131919,"title":"How can I make the horizontal scroll buttons on a tab control larger?","body":"<p>I'm using a <code>System.Windows.Forms.TabControl</code>.  I'm using it for a touch screen interface, and when there are a lot of tabs in the <code>TabControl</code>, the scroll arrows on the right side of the top of the <code>TabControl</code> are too small to touch.  How can I resize them to make them larger?</p>\n\n<p>edit: I have <code>Multiline</code> set to false, to enable more screen space for my application.  If I need to change this back to <code>true</code>, please let me know!</p>\n"},{"tags":["c#","winforms"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":765,"score":3,"question_id":3237645,"title":"How to get the size of the displayed Text in a TextBox","body":"<p>I need your help again.</p>\n\n<p>I need a way to determine the size of displayed text in a multi-column <code>TextBox</code> to set the <code>Scrollbars</code> property to the correct value.</p>\n\n<p>Since it is some sort of enhanced <code>MessageBox</code> what I work on, the size of the <code>MessageBox</code> should be determined from the height and the width of the text sourced by strings with newlines in it.</p>\n\n<p>Currently I use this code to determine the size of the <code>MessageBox</code> depending on the text to be entered. But you see the <code>MessageBox</code> has a <code>MaximiumSize</code> determined. The TextBox for the text itself has <code>WordWrap</code> enabled, too. So the only thing undefined is the <code>Height</code> of the text after inserting it to TextBox.Text.</p>\n\n<pre><code>SizeF textSize = this.tbxText.CreateGraphics().MeasureString(message, this.tbxText.Font);\n\nint frmWidth = picWidth + (int)textSize.Width;\nif (frmWidth &gt; this.MaximumSize.Width)\n{\n    frmWidth = this.MaximumSize.Width;\n}\nelse if (frmWidth &lt; this.MinimumSize.Width)\n{\n    frmWidth = this.MinimumSize.Width;\n}\n\nint frmHeight = picHeight + (int)textSize.Height + pnlButtons.Height + pnlInput.Height;\nif (frmHeight &gt; this.MaximumSize.Height)\n{\n    frmHeight = this.MaximumSize.Height;\n}\nelse if (frmHeight &lt; this.MinimumSize.Height)\n{\n    frmHeight = this.MinimumSize.Height;\n}\n</code></pre>\n\n<p>Setting the <code>TextBox.Scrollbars</code> Property to Both as default lets a disabled Scrollbar on the screen that is not really nice nor wanted.\nSadly, the <code>Graphics.MeasureString</code> does not help really, since it does not consider <code>WordWrap</code> behaviour.</p>\n\n<p>So, how can i determine if the <code>TextBox.Text</code> is leaving the visible area making a vertical Scrollbar needed?</p>\n"},{"tags":["c#","winforms","app-config","tracelistener"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13131602,"title":"Using Trace Listener redirects ALL Debug Output","body":"<p>I followed this <a href=\"http://www.daveoncsharp.com/2009/09/create-a-logger-using-the-trace-listener-in-csharp/\" rel=\"nofollow\">Create a Logger using the Trace Listener in C#</a>  article with the belief that only <code>Trace.WriteLine()</code> statements will be written in the <code>application.log</code> file:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;configuration&gt;\n  &lt;system.diagnostics&gt;\n    &lt;trace autoflush=\"true\" indentsize=\"4\"&gt;\n      &lt;listeners&gt;\n        &lt;add name=\"myListener\" type=\"System.Diagnostics.TextWriterTraceListener\" initializeData=\"application.log\" /&gt;\n        &lt;remove name=\"Default\" /&gt;\n      &lt;/listeners&gt;\n    &lt;/trace&gt;\n  &lt;/system.diagnostics&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>But to my dismay, all of my <code>Debug.WriteLine()</code> that used to go to the <code>Output</code> tab disappeared from that tab and instead they all now go to the trace file <code>application.log</code>.</p>\n\n<p>Is there a way to direct <strong>only</strong> <code>Trace.WriteLine()</code> statements to that <code>application.log</code>?</p>\n\n<p>If not, what is the simplest way to <code>WriteLine()</code> to a file of my own only what I choose to log to that file, not my entire debug session?</p>\n"},{"tags":["c#","winforms","post","webbrowser-control"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":54,"score":3,"question_id":12983301,"title":"How to WebView.postUrl() in WebBrowser","body":"<p>Having dealt previously with WebView, it distinguishes between <a href=\"http://developer.android.com/reference/android/webkit/WebView.html#loadUrl%28java.lang.String%29\" rel=\"nofollow\">loadUrl()</a> and <a href=\"http://developer.android.com/reference/android/webkit/WebView.html#postUrl%28java.lang.String,%20byte%5B%5D%29\" rel=\"nofollow\">postUrl()</a>.</p>\n\n<p>But WebBrowser only has the <a href=\"http://msdn.microsoft.com/en-us/library/ms161356.aspx\" rel=\"nofollow\">Navigate()</a> method which seems to be taking a different approach by providing (an optional?) postData parameter.</p>\n\n<p>How does that work? Is there a tutorial out there (with sample code) that demonstrates how to use it?</p>\n\n<p><strong>Update1:</strong> I just found <a href=\"http://stackoverflow.com/a/3794597/1357272\">this tip</a>, which doesn't really show any code but cautions in regard to using POST in WebBrowser.</p>\n\n<p><strong>Update2:</strong> <a href=\"http://social.msdn.microsoft.com/Forums/en-US/visualjsharpgeneral/thread/eacb1c98-278b-425b-9d9a-1876603c2dc2\" rel=\"nofollow\">This thread</a> is better than nothing.</p>\n"},{"tags":["vb.net","winforms","multithreading","gui"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13130814,"title":"Trouble Udating UI from a Seperate Thread","body":"<p>I've been messing around with the answer given here\n<a href=\"http://stackoverflow.com/questions/661561/how-to-update-the-gui-from-another-thread-in-c\">How to update the GUI from another thread in C#?</a></p>\n\n<p>I'm getting the error Method 'System.Windows.Forms.Label' Text not found from the following code</p>\n\n<pre><code>Private Delegate Sub setControlPropertyThreadSafeDelegate(control As Control, propertyName As String, propertyValue As Object)\n\nPublic Sub setControlPropertyThreadSafe(control As Control, propertyName As String, propertyValue As Object)\n    If control.InvokeRequired = True Then\n        control.Invoke(New setControlPropertyThreadSafeDelegate(AddressOf setControlPropertyThreadSafe), New Object() {control, propertyName, propertyValue})\n    Else\n        control.GetType().InvokeMember(propertyName, Reflection.BindingFlags.SetProperty, Nothing, control, New Object() {control, propertyName, propertyValue}) 'This is where the error occurs\n    End If\nEnd Sub\n</code></pre>\n\n<p>From a separate thread I calling this method with the following line </p>\n\n<pre><code>UI.setControlPropertyThreadSafe(UI.lblExcel, \"Text\", \"Inserting Data into YTD Template\")\n</code></pre>\n\n<p>Any help regarding this error will be much appreciated.</p>\n"},{"tags":["vb.net","winforms","visual-studio","visual-studio-2012"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13130579,"title":"vb.net send string to a different program and get the result","body":"<p>I've been developing a .net application for the company I work for, there is just one part I can't seem to do. I need to send a string to a textbox of another program and then copy the result. The result is shown in a label. Currently we hand type the string and manually copy the label text, so I know the information can be copied I just don't know how to do it via code.</p>\n\n<p>The application I need to send the text too is also written with the .net framework if that helps.</p>\n\n<p>Any answers are appreciated :)</p>\n\n<p>Cheers.</p>\n"},{"tags":["c#","winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":36,"score":-1,"question_id":13129638,"title":"Adding Ovalshape during runtime","body":"<p>First off, I have searched the database for solutions for my problem.\nI'm trying to add several ovalshapes to my Visual C# program during runtime.\nThis was quickly found here: <a href=\"http://stackoverflow.com/questions/8279036/visual-basic-power-packs\">Visual Basic Power Packs</a></p>\n\n<p>There's just one thing I'm missing:\nHow do I append one shape later on? Like changing the backgroundcolor or something.</p>\n\n<p>This is what I'm designing:\nSeveral hardware products are involved in the system, which will send data over a serialport. The hardware product is identified by two bytes.\nA construction drawing of a building will be loaded in de PC program by the user.\nIn this picture ovalshapes will be added during runtime every time  a new combination of the identifying bytes has been received.\nSo the ID will correspond to only one ovalshape.\nLater on the ovalshape must be moved to the corresponding place on the construction drawing.\nWhen the mouse hovers over the ovalshape, a textbox (or something alike) will show the latest information about the hardware product.</p>\n\n<pre><code>shapes = new Shape[5];              //Let's say we want 5 different shapes\n        int posY = 25;\n        int posX = 100;\n\n        for (int i = 0; i &lt; 5; i++)\n        {\n            OvalShape ovalShape = new OvalShape();      //Create the shape you want with it's properties\n            ovalShape.Location = new Point(posX, posY);\n            ovalShape.Size = new Size(25, 25);\n            shapes[i] = ovalShape;                      //Add the shape to the array\n\n            posY += 30;\n        }\n\n        posX = posX + 25;\n\n        shapeContainer = new ShapeContainer();\n        shapeContainer.Shapes.AddRange(shapes);         //Add the array of shapes to the ShapeContainer\n        this.Controls.Add(shapeContainer);              //Add the ShapeContainer to your form\n</code></pre>\n\n<p>In good old Visual Basic 6, I could just create an array of shapes and access them by any given number in the index.</p>\n\n<p>So I want to be able to do this:</p>\n\n<ol>\n<li>Magically create an ovalshape</li>\n<li>On receiving data from serialport, change background of corresponding shape.\nSomething like: shape[4].BackColor = Color.Blue;</li>\n<li>Move shape around</li>\n<li>Maybe delete the shape after a while</li>\n</ol>\n"},{"tags":["c#","winforms","algorithm","gui","tree"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13128750,"title":"What are the step to the Reingold-Tilford algorithm and how might I program it?","body":"<p>From the presentation: <a href=\"http://hci.stanford.edu/courses/cs448b/f09/lectures/CS448B-20091021-GraphsAndTrees.pdf\" rel=\"nofollow\">Graphs and Trees</a> on page 3, there is a visual presentation of what takes place during the Reigngold-Tilford process; it also gives a vague summary to this algorithm before hand: <code>\"...starts with bottom-up pass of the tree;\n[finishes with] Top-down pass for assignment of final positions...\"</code> I can achieve both directional passes through recursive means, and I know that the Y-value(s) are respective to each node's generation level, but I'm still lost as to how the X-coordinates are solved.</p>\n\n<p>I did come across this project: <a href=\"http://www.codeproject.com/Articles/29518/A-Graph-Tree-Drawing-Control-for-WPF\" rel=\"nofollow\">A Graph Tree Drawing Control for WPF</a> but there is so much code I had great difficulty locating what should be a simple 2-3 methods to define the X-values. (Also have no experience with WPF as well) </p>\n\n<p>I have been searching and experimenting how to do this for several days now, so your help is much appreciated!</p>\n"},{"tags":["c#",".net","winforms","c#-4.0"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13122728,"title":"Windows 8 and triggering the display of Windows Virtual Keyboard","body":"<p>This is more of a follow-up to the following question asked last year by <a href=\"http://stackoverflow.com/users/272958/forbeslindesay\">ForbesLindesay</a> regarding showing or suppressing the Windows Virtual Keyboard via .NET code:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/6871347/how-do-i-trigger-or-supress-the-display-of-windows-virtual-keyboard\">How do I trigger or supress the display of Windows Virtual Keyboard</a></p>\n\n<p>In this case, my application is a WinForms application that <em>heavily</em> uses the <a href=\"http://msdn.microsoft.com/en-us/library/ms828520.aspx\" rel=\"nofollow\">Microsoft Ink</a> classes and runs on Windows XP, Vista, 7 and now we're in the process of making sure it works properly with 8.</p>\n\n<p>We've noticed that in windows 8, the Virtual keyboard does not pops up when user wants to use in our application, while it works for normal windows operations.</p>\n\n<p>So - <strong>Now that Windows 8 is out</strong>, is there a way to trigger the Windows Virtual Keyboard in .NET managed code (or <a href=\"http://www.pinvoke.net/\" rel=\"nofollow\">PInvoke</a> it)?</p>\n\n<p>And if you say there is still no way to do this, can you provide a reference to back up your claim?</p>\n"},{"tags":[".net","winforms","ui-automation","msaa"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":100,"score":3,"question_id":12591649,"title":"Using UI Automation, Winforms Button Invoking multiple times","body":"<p>I'm attempting to use the <a href=\"http://msdn.microsoft.com/en-us/library/ms747327.aspx\" rel=\"nofollow\">MS UI Automation Framework</a> in my application for some automated testing.  My goal for now is to listen to GUI events and record them, similar to the sample provided (TestScriptGeneratorSample) in the Windows SDK.</p>\n\n<p>Just using that demo application, I can launch a simple Windows Forms application with a single button and see that it records click events as \"invoke\" UIA events.  However, for each click of the button, the demo application records <strong>4</strong> \"invoke\" events.  Why is that?  I don't see this issue when using a WPF button.</p>\n\n<p>My guess is that since the <code>System.Windows.Forms.Button</code> class supports <a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/dd373592%28v=vs.85%29.aspx\" rel=\"nofollow\">MSAA</a> instead of the UIA, the part of UIA that is bridging the MSAA interface is misbehaving, or at least behaving in a way that I don't understand and can't find any documentation about.\nMaybe it's reporting an invoke event for mouse down, up, click, and then the actual button press?</p>\n\n<p>Can anyone explain this behavior, and/or provide a workaround so that one button press results in one invoke event?</p>\n\n<p><strong>Edit:</strong> This is under WinXP SP3.  I just installed the <a href=\"http://support.microsoft.com/kb/976779\" rel=\"nofollow\">Windows Automation API 3.0</a> <a href=\"http://support.microsoft.com/kb/971513\" rel=\"nofollow\">update</a> and still see the same behavior.</p>\n\n<p><strong>Edit 2:</strong> I found <a href=\"http://www.universalthread.com/ViewPageArticle.aspx?ID=199\" rel=\"nofollow\">this example</a> where the author off-handedly mentions this behavior as a bug in the Win32 control, but cites no evidence...</p>\n\n<p>Here's my sample application (form with a button on it), along with event listening baked into it.  Add references to <code>UIAutomationClient</code> and <code>UIAutomationTypes</code>.  Click the button and see invoke happen four times instead of one.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>using System;\nusing System.Drawing;\nusing System.Windows.Automation;\nusing System.Windows.Forms;\n\nnamespace WindowsFormsApplication6\n{\n    public partial class Form1 : Form\n    {\n        private TextBox m_Output;\n\n        public Form1()\n        {\n            InitializeComponent();\n\n            // set up the GUI with a single button...\n            Button b = new Button {Location = new Point(5, 5), Name = \"Test\", Text = \"Click Me\"};\n            // ... and a textbox to write events to.\n            m_Output = new TextBox { Location = new Point(5, 30), Name = \"Output\", Multiline = true, Size = new Size(250, 200) };\n\n            this.Controls.Add(b);\n            this.Controls.Add(m_Output);\n\n            // get the button as an UIA element\n            AutomationElement button = AutomationElement.FromHandle(b.Handle);\n            // attach a handler to the button, listening for the Invoke event\n            Automation.AddAutomationEventHandler(\n                                                 InvokePattern.InvokedEvent,\n                                                 button,\n                                                 TreeScope.Element,\n                                                 OnInvoked);\n        }\n\n        // Handler for button invoke events\n        private void OnInvoked(object Sender, AutomationEventArgs E)\n        {\n            AppendText(\"Invoked: \" + ((AutomationElement)Sender).Current.AutomationId);\n        }\n\n        // Just dumps text to the textbox\n        private void AppendText(string Text)\n        {\n            if (m_Output.InvokeRequired)\n            {\n                m_Output.BeginInvoke((Action&lt;string&gt;)AppendText, Text);\n            }\n            else\n            {\n                m_Output.AppendText(DateTime.Now.ToString(\"hh:mm:ss.fff\") + \": \" + Text + Environment.NewLine);\n            }\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","winforms","scroll","custom-controls","autoscroll"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13129517,"title":"Fixed part in custom painted usercontrol with autoscroll c# windows forms","body":"<p>I would like to create a table like control where a number of top rows stay in place when scrolling.\nI paint the control in an override of the OnPaint method.</p>\n\n<p>When scrolling some partial repaint happens automatically, but this creates artefacts and looks weird. To solve that I call Invalidate(); or Refresh(); in an eventhandler attached to the scroll event and take the scrollposition in to account when painting the part that is supposed to scroll in / out of view. However when I do this the part that is supposed to stay in place gets scrolled out and sent back again and again. (so it is sort of flickering)\nI am trying to make this work smoothly without the flickering.</p>\n\n<p>To simplify the issue I have made the following code where I draw a line that is supposed to stay in place when scrolling.\nAs you can see it starts flickering when scrolling.</p>\n\n<p>I have already thought of doublebuffering and such as you can see in the code.</p>\n\n<p>Does anyone know how to make the line stay in place?\nThanks in advance.</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Drawing;\nusing System.Data;\nusing System.Linq;\nusing System.Text;\nusing System.Windows.Forms;\nusing System.Diagnostics;\n\nnamespace ColumnReaderUITryOut\n{\n    public partial class CustomPaintScrollTest : UserControl\n    {\n        public CustomPaintScrollTest()\n        {\n            InitializeComponent();\n            AutoScrollMinSize = new Size(500, 600);\n            SetStyle(ControlStyles.OptimizedDoubleBuffer, true);\n            SetStyle(ControlStyles.AllPaintingInWmPaint, true);\n            SetStyle(ControlStyles.UserPaint, true);\n            ResizeRedraw = true;\n        }\n\n        protected override void OnPaint(PaintEventArgs e)\n        {\n            base.OnPaint(e);\n            e.Graphics.DrawLine(Pens.Black, 0, 0, Width, Height);\n        }\n\n        private void CustomPaintScrollTest_Scroll(object sender, ScrollEventArgs e)\n        {\n            Invalidate();\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#",".net","html","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":437,"score":0,"question_id":10971317,"title":"c# strip html tags, decode entities","body":"<p>Is there any equivalents to PHP functions strip_tags and html_entity_decode? I'm using .NET 3.5</p>\n\n<p>So if I have:</p>\n\n<pre><code>&lt;textarea cols=\"5\"&gt;Some &amp;lt; text&lt;/textarea&gt;\n</code></pre>\n\n<p>I'll get</p>\n\n<pre><code>Some &lt; text\n</code></pre>\n\n<p>Thanks for respondes.</p>\n"},{"tags":["c#","sql","winforms","export-to-excel"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3342,"score":0,"question_id":8816918,"title":"How to export Sql Server Data to Excel File in C#","body":"<p>How can one read sql server data and write it to excel file in C#?\nDo I need to use an external .Net library, or is it just OK using Visual Studio itself?</p>\n\n<p>Any example and link will be well appreciated..</p>\n\n<p>Note: Please send examples for <strong>Winforms</strong>, <strong>not asp.net</strong></p>\n"},{"tags":["winforms","datagridview","colors","background"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13057148,"title":"datagridview background color obfuscated / dirty when selected rows","body":"<p>I've been looking for some hours but haven't found a solution about this issue.</p>\n\n<p>I'm using the .NET 4 DataGridView in WinForms and it's presenting me some issues with selected rows background colors. </p>\n\n<p>The rows become like dirty when are selected, and any properties of the window change. For example: when another window passes through, the hidden part of the field becomes unreadable. </p>\n\n<p>I'm posting an image explaining this situation better than my poor English does. </p>\n\n<p><img src=\"http://i.stack.imgur.com/Nb3cy.jpg\" alt=\"enter image description here\"></p>\n\n<p>As the figure shows, selected rows with lightblue forecolor became dirty when another windows passes inside them. You will see that only selected ones become that way, as the other not selected green row wont happen that.</p>\n"},{"tags":["c#","winforms","memory","reference","weak-references"],"answer_count":2,"favorite_count":10,"up_vote_count":30,"down_vote_count":0,"view_count":8709,"score":30,"question_id":310685,"title":"Weak references","body":"<p>can someone explain the main benefits of different types of references in C#, weak references, soft references, phantom references, strong references.</p>\n\n<p>We have an application that is consuming a lot of memory and we are trying to determine if this is an area to focus on.</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":13114657,"title":"textbox enter and leave events repeating","body":"<p>On my C# windows form I have 3 textboxes that named textBuyPrice, textSell, and textMargin. The user can enter a Buy Price, and if they enter a Sell Price then the code will calculate the Margin for them. If the user enters a Margin then the code will enter a Sell Price. See these 2 bits of code that make up the margin calculations.</p>\n\n<p>This code catches the enter of the cursor in the textbox and sets the current value to a variable.</p>\n\n<pre><code>private void textMargin_Enter(object sender, EventArgs e)\n        {\n        OriginalMarginValue = this.textMargin.Text;\n        }\n</code></pre>\n\n<p>This code catches the leave event in the textbox and takes any changes, runs some calcs and updates any related fields.</p>\n\n<pre><code>private void textMargin_Leave(object sender, EventArgs e)\n        {\n        if (this.textMargin.Text != OriginalMarginValue)\n            {\n            Parts part = new Parts();\n            decimal dcmBuy = part.RemoveDollarSign(this.textBuyPrice.Text);\n            decimal dcmMargin = part.RemovePercentSign(this.textMargin.Text);\n            decimal dcmSell = part.GetSellPrice(dcmBuy, dcmMargin / 100);\n            string strSell = dcmSell.ToString(\"C\");\n            this.textSellPrice.Text = strSell; \n            }\n\n        }\n</code></pre>\n\n<p>What is happening seems to be a loop between the Enter and Leave events. After the Leave event fires when I try and tab out of the textbox. The Enter event fires again and it will not let me tab out.</p>\n\n<p>What is going on? Should I force the tab to set focus on another field?</p>\n\n<p>The code above is identical to the textSellPrice code and I do not have the same problem in that textbox.</p>\n\n<p>Thx</p>\n\n<p><em><strong>EDIT</em></strong>\nHere is the call stack as the code enters the Enter event for the 2nd time after trying to leave the textbox:</p>\n\n<blockquote>\n  <p>AutoShop.exe!AutoShop.formPartDetail.textMargin_Enter(object sender = {Text = \"57.14 %\"}, System.EventArgs e = {System.EventArgs}) Line 168 C#\n      System.Windows.Forms.dll!System.Windows.Forms.Control.OnEnter(System.EventArgs e) + 0x88 bytes<br>\n      System.Windows.Forms.dll!System.Windows.Forms.Control.NotifyEnter() + 0x1f bytes<br>\n      System.Windows.Forms.dll!System.Windows.Forms.ContainerControl.UpdateFocusedControl() + 0x195 bytes \n      System.Windows.Forms.dll!System.Windows.Forms.ContainerControl.AssignActiveControlInternal(System.Windows.Forms.Control value = {Text = \"57.14 %\"}) + 0x60 bytes<br>\n      System.Windows.Forms.dll!System.Windows.Forms.ContainerControl.ActivateControlInternal(System.Windows.Forms.Control control, bool originator = false) + 0x48 bytes<br>\n      System.Windows.Forms.dll!System.Windows.Forms.ContainerControl.SetActiveControlInternal(System.Windows.Forms.Control value = {Text = \"57.14 %\"}) + 0x73 bytes<br>\n      System.Windows.Forms.dll!System.Windows.Forms.ContainerControl.ValidateThroughAncestor(System.Windows.Forms.Control ancestorControl, bool preventFocusChangeOnError) + 0x212 bytes<br>\n      System.Windows.Forms.dll!System.Windows.Forms.ContainerControl.EnterValidation(System.Windows.Forms.Control enterControl) + 0x7c bytes<br>\n      System.Windows.Forms.dll!System.Windows.Forms.ContainerControl.UpdateFocusedControl() + 0x8a bytes<br>\n      System.Windows.Forms.dll!System.Windows.Forms.ContainerControl.AssignActiveControlInternal(System.Windows.Forms.Control value = {Text = \"\"}) + 0x60 bytes<br>\n      System.Windows.Forms.dll!System.Windows.Forms.ContainerControl.ActivateControlInternal(System.Windows.Forms.Control control, bool originator = false) + 0x48 bytes<br>\n      System.Windows.Forms.dll!System.Windows.Forms.ContainerControl.SetActiveControlInternal(System.Windows.Forms.Control value = {Text = \"\"}) + 0x73 bytes<br>\n      System.Windows.Forms.dll!System.Windows.Forms.ContainerControl.SetActiveControl(System.Windows.Forms.Control ctl) + 0x33 bytes<br>\n      System.Windows.Forms.dll!System.Windows.Forms.ContainerControl.ActiveControl.set(System.Windows.Forms.Control value) + 0x5 bytes<br>\n      System.Windows.Forms.dll!System.Windows.Forms.Control.Select(bool directed, bool forward) + 0x1b bytes<br>\n      System.Windows.Forms.dll!System.Windows.Forms.Control.SelectNextControl(System.Windows.Forms.Control ctl, bool forward, bool tabStopOnly, bool nested, bool wrap) + 0x7e bytes<br>\n      System.Windows.Forms.dll!System.Windows.Forms.Form.ProcessTabKey(bool forward = true) + 0x24 bytes<br>\n      System.Windows.Forms.dll!System.Windows.Forms.ContainerControl.ProcessDialogKey(System.Windows.Forms.Keys keyData = LButton | Back) + 0x71 bytes    </p>\n</blockquote>\n"},{"tags":["c#",".net","winforms","visual-studio","dll"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13126887,"title":"List all .dlls being used along with their revision date?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/383686/how-do-you-loop-through-currently-loaded-assemblies\">How do you loop through currently loaded assemblies?</a>  </p>\n</blockquote>\n\n\n\n<p>I'm designing a UI that uses a plethora of .dlls (all built within the app), and I would like for one of its tabs to display the names of all the .dlls being used along with their \"last modified\" property, while running. Is there a way to do this in c# in Visual Studio 2012? It seems like it shouldn't be that hard but I just don't really know where to look.</p>\n\n<p>Thanks very much in advance.</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13126245,"title":"C# winforms problems drawing to picturebox using collection?","body":"<p>The form contains a picturebox (picturebox1) and a timer control (timer1)...</p>\n\n<p>Basically at start up I create a List collection containing 5 instances of my pixel class. When the timer triggers I call a refresh of the picturebox which calls the paint event. In the paint event I iterate through the list collection and call each pixel's draw method.</p>\n\n<p>The problem I am having is that only one pixel shows up...that is.. unless I set a break at the point where I am adding the pixel, continue, and break again and repeat until all pthe pixels are created. Then for some reason all of the pixels show up...</p>\n\n<p>Can someone tell me why I can only see a single pixel?</p>\n\n<pre><code>public partial class Form1 : Form\n{\n    List&lt;Pixel&gt; pixels = new List&lt;Pixel&gt;();\n\n    public Form1()\n    {            \n        InitializeComponent();\n    }\n\n    private void Form1_Load(object sender, EventArgs e)\n    {\n        for (int ii = 0; ii &lt; 5; ii++)\n            pixels.Add(new Pixel(pictureBox1));  // &lt;- breakpoint here...?\n    }\n\n    private void pictureBox1_Paint(object sender, PaintEventArgs e)\n    {\n        foreach (Pixel p in pixels)\n            p.Draw(e, pictureBox1);\n    }\n\n    private void timer1_Tick(object sender, EventArgs e)\n    {\n        pictureBox1.Refresh();\n    }\n}\n\npublic class Pixel\n{\n    Random r = new Random(DateTime.Now.Millisecond);\n\n    public Point Position { get; set; }\n\n    public Pixel(PictureBox src) \n    {\n        Position = new Point(r.Next(0, src.Width), r.Next(0, src.Height));\n    }\n\n    public void Draw(PaintEventArgs e, PictureBox src)\n    {\n        e.Graphics.DrawRectangle(new Pen(Color.Black), Position.X, Position.Y, 1, 1);\n    }\n}\n</code></pre>\n\n<p>My original code does a lot more.. but I stripped it all out and got the same results.</p>\n"},{"tags":["c#",".net","winforms","radio-button"],"answer_count":6,"favorite_count":4,"up_vote_count":19,"down_vote_count":0,"view_count":27592,"score":19,"question_id":1797907,"title":"Which Radio button in the group is checked?","body":"<p>Using WinForms; Is there a better way to find the checked RadioButton for a group? It seems to me that the code below should not be necessary. When you check a different RadioButton then it knows which one to uncheck… so it should know which is checked. How do I pull that information without doing a lot of if statements (or a switch).</p>\n\n<pre><code>     RadioButton rb = null;\n\n     if (m_RadioButton1.Checked == true)\n     {\n        rb = m_RadioButton1;\n     }\n     else if (m_RadioButton2.Checked == true)\n     {\n        rb = m_RadioButton2;\n     }\n     else if (m_RadioButton3.Checked == true)\n     {\n        rb = m_RadioButton3;\n     }\n</code></pre>\n"},{"tags":["c#",".net","winforms","c#-4.0","communication"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":13124936,"title":"Send data to Windows Forms Application","body":"<p>I'm working on a program that is autostarting with windows. The program is a <code>windows-forms</code> application written in <code>C#</code>. When it gets started, it automatically hides itself and shows a tray icon. So it's only visible in tray, not in taskbar, not as a window.</p>\n\n<p>Now I want somehow to send an ID (a simple int number) to the running windows form and the form should automatically show a messagebox with the recieved number.</p>\n\n<p>Sending should be directly, not over a database or a textfile that is watched. </p>\n\n<p>Is there a way to send data to a open windows form?</p>\n\n<p>Any help apreciated :)</p>\n"},{"tags":["c#","winforms","unzip","decompress","self-extracting"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":13106324,"title":"The magic number in GZip header is not correct. Make sure you are passing in a GZip stream.(.exe file)","body":"<p>I want to extract a exe file. The exe file contain some files and folders. When I try to extract the file using winrar it gets extracted but when I am trying to extract the exe file using some examples I am getting this error:</p>\n\n<blockquote>\n  <p>The magic number in GZip header is not correct. Make sure you are passing in a GZip stream.</p>\n</blockquote>\n\n<p>I have used some samples and googled a lot for my problem but didn't get my answer, and I have used some libraries also.</p>\n\n<p>I used this code but same error:</p>\n\n<pre><code>    public static void Decompress(FileInfo fi)\n    {\n        // Get the stream of the source file.\n        using (FileStream inFile = fi.OpenRead())\n        {\n            // Get original file extension, for example\n            // \"doc\" from report.doc.gz.\n            string curFile = fi.FullName;\n            string origName = curFile.Remove(curFile.Length -\n                    fi.Extension.Length);\n\n            //Create the decompressed file.\n            using (FileStream outFile = File.Create(origName))\n            {\n                using (GZipStream Decompress = new GZipStream(inFile,\n                        CompressionMode.Decompress))\n                {\n                    // Copy the decompression stream \n                    // into the output file.\n                    Decompress.CopyTo(outFile);\n\n                    Console.WriteLine(\"Decompressed: {0}\", fi.Name);\n\n                }\n            }\n        }\n    }\n</code></pre>\n"},{"tags":["c#","winforms","gui"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13110018,"title":"WebBrowser object content changes position when form is minimized and then restored","body":"<p>I've written a C# app that uses a webbrowser for its main content window. The program loads a rather large amount of text into that browser, which works fine. I've noticed when reading that content, however, that if I minimize the application and then restore it that the position jumps way up in the text instead of remaining where it was. Doing this several times puts the text at the top of the content.</p>\n\n<p>Any ideas what could cause this and what I could do to stop this behavior? It's only when I minimize/restore, if I alt-tab into another application and go back the position is properly retained.</p>\n\n<p>Here are screenshots of the content: \nBefore minimizing: <a href=\"http://imageshack.us/a/img641/9632/beforeminimize.jpg\" rel=\"nofollow\">http://imageshack.us/a/img641/9632/beforeminimize.jpg</a>\nAfter restore: <a href=\"http://imageshack.us/a/img827/439/afterrestore.jpg\" rel=\"nofollow\">http://imageshack.us/a/img827/439/afterrestore.jpg</a></p>\n\n<p>Here is a link to the code on GitHub, though I haven't changed any properties of the WebBrowswer aside from its anchors: <a href=\"https://github.com/benroth/FanBook\" rel=\"nofollow\">https://github.com/benroth/FanBook</a></p>\n"},{"tags":["c#","winforms","checkbox"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13124813,"title":"How to define a checkbox with image, and a custom icon","body":"<p>I want to create a CheckBox that I can use a custom icon for the check and unchecked icons. but also then have an image instead of text as the main part of the CheckBox.\nI.e., like this, but with the background image offset to the left, or moveable like the text is if Image was Text.</p>\n\n<pre><code>box.Image = Image.FromFile(\"myimage.jpg\");\n\nbox.CheckStateChanged += new System.EventHandler(Checkbox_CheckStateChanged);\nprivate void Checkbox_CheckStateChanged(CheckBox box, EventArgs e)\n        {\n            switch (box.CheckState)\n            {\n                case CheckState.Checked:\n                    box.Image = CheckedImage;\n                    break;\n                case CheckState.Unchecked:\n                    box.Image = UnCheckedImage;\n                    break;\n            }\n        }\n</code></pre>\n"},{"tags":["c#","winforms","layout","control","suspend"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":44,"score":3,"question_id":13122994,"title":"Why adding suspendLayout and resumeLayout reducing performance?","body":"<p>I need to add a lot of controls to a parent control.</p>\n\n<p>But I find if I add <code>parentcontrol.suspendLayout</code> and <code>parentcontrol.resumeLayout</code> before and after I add those controls to the parent, I use stopwatch to measure the ticks:\nIf I remove the code <code>parentcontrol.suspendLayout</code> and <code>parentcontrol.resumeLayout</code>, it will be faster. Why does it happen?</p>\n\n<p>So <code>suspendLayout</code> and <code>resumeLayout</code> are not supposed to reduce the time to add sub controls, right? So what's the benefit to use <code>suspendLayout</code> and <code>resumeLayout</code> or in other words, if I don't use <code>suspendLayout</code> and <code>resumeLayout</code> but add the sub controls directly to parents, what's the bad?</p>\n"},{"tags":["c#",".net","windows","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13123271,"title":"Draw control selection rectangle with resize points in windows forms","body":"<p>I want to draw a rectangle with the resize points for the selected control as shown in the image below. </p>\n\n<p><img src=\"http://i.stack.imgur.com/NTosH.png\" alt=\"enter image description here\"></p>\n\n<p>I made use of the paint event of the control and i was able to draw a border rectangle for the selected control.</p>\n\n<pre><code> Rectangle borderRectangle = new Rectangle(0, 0, this.Width, this.Height);\n ControlPaint.DrawBorder(e.Graphics, borderRectangle, Color.Black,System.Windows.Forms.ButtonBorderStyle.Dotted);\n</code></pre>\n\n<p>Do we have any option to include the functionality as we have in the windows forms designer?</p>\n\n<p>Please do suggest me a method for the same.</p>\n\n<p>Thanks in Advance,</p>\n\n<p>K</p>\n"},{"tags":["winforms",".net-3.5",".net-4.0","httpwebrequest","ntlm"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":312,"score":1,"question_id":6762785,"title":"NTLM authentication with HttpWebRequest works in .net 4.0 but not 3.5","body":"<p>I have written some code to perform NTLM authentication using HttpWebRequest. If i set the target framework of winform app to 4.0 then it works. </p>\n\n<p>However, if I set it to 3.5 then it doesnt (it returns 401 unauthorized error). The first two connections are sent and received correctly, but on receiving the 2nd response. the client does not make the 3rd request and it simply says unauthorized.</p>\n\n<p>My code is:</p>\n\n<pre><code>request = (HttpWebRequest)WebRequest.Create(authenticatedOpenAssetRssUrl);\n            request.Credentials = new NetworkCredential(Environment.UserName, null);\n            request.UserAgent = Constant.XML_FEED_USER_AGENT;\n            request.UnsafeAuthenticatedConnectionSharing = true;\n</code></pre>\n\n<p>This is running on windows 7 x64 bit.</p>\n"},{"tags":["winforms","clipboard"],"answer_count":5,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":2728,"score":7,"question_id":5707990,"title":"Requested Clipboard operation did not succeed","body":"<pre><code>Exception Type: ExternalException\n\nMessage: Requested Clipboard operation did not succeed.\n\nMethod: ThrowIfFailed\n\nSource: System.Windows.Forms\n\n\n\nStack Trace:\n\n   at System.Windows.Forms.Clipboard.ThrowIfFailed(Int32 hr)\n   at System.Windows.Forms.Clipboard.SetDataObject(Object data, Boolean copy, Int32 retryTimes, Int32 retryDelay)\n   at System.Windows.Forms.Clipboard.SetText(String text, TextDataFormat format)\n   at System.Windows.Forms.Clipboard.SetText(String text)\n   at Deerfield.Base.Controls.DataGridView.ProcessCmdKey(Message&amp; msg, Keys keyData) in C:\\Users\\Developer\\Desktop\\deerfield\\src\\core\\Deerfield\\Deerfield.Base\\Controls\\DataGridView.cs:line 555\n   at System.Windows.Forms.Control.ProcessCmdKey(Message&amp; msg, Keys keyData)\n   at System.Windows.Forms.Control.ProcessCmdKey(Message&amp; msg, Keys keyData)\n   at System.Windows.Forms.TextBoxBase.ProcessCmdKey(Message&amp; msg, Keys keyData)\n   at System.Windows.Forms.Control.PreProcessMessage(Message&amp; msg)\n   at System.Windows.Forms.Control.PreProcessControlMessageInternal(Control target, Message&amp; msg)\n   at System.Windows.Forms.Application.ThreadContext.PreTranslateMessage(MSG&amp; msg)\n</code></pre>\n\n<p>I googled this, but I cannot get a decent answer as to why this is happening. </p>\n\n<p>The MSDN documentation says that this often happens when the user switches to another application, but it does not appear that this was the case.</p>\n"},{"tags":["c#",".net","wpf","winforms"],"answer_count":5,"favorite_count":3,"up_vote_count":7,"down_vote_count":0,"view_count":1679,"score":7,"question_id":470846,"title":"Winforms WPF Interop - WPF content fails to paint","body":"<p>I have a Winform that uses an ElementHost to display a WPF UserControl. Once every 50 times or so when the form loads the WPF content fails to paint. You can see through the Winform chrome to whatever is beneath. Resizing the window gets the WPF content to show up.</p>\n\n<p>Is this a known issue? Can anyone suggest a workaround? </p>\n\n<p>Thanks\nScott</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":5,"view_count":79,"score":-2,"question_id":13122828,"title":"How to sum TimeSpan's residing a GridView","body":"<p>i could not sum time using Array.\ni have one column in gridView which stored extra times of worker and i want sum all times and want get total hours and minutes how to do this please ?</p>\n\n<pre><code> TimeSpan p = new TimeSpan();\n  for ( int i = 0; i &lt; grid_horas.Rows.Count; i++ )\n  {\n\n       //TimeSpan t2 = TimeSpan.Parse(grid_horas.Rows[i].Cells[7].Value.ToString());\n\n  }\n</code></pre>\n"},{"tags":["c#","winforms","c#-4.0","c#-3.0"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":3149,"score":1,"question_id":9509147,"title":"Label word wrapping","body":"<p>Is there any way to do a word wrap in a .net label control?</p>\n\n<p>I know there is an alternate way of using a textbox, make border to none, readonly to true and set wordwrap and multiline to true.</p>\n\n<p>I am checking whether there is something for label?</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":36,"score":-1,"question_id":13121681,"title":"Currency input mask with cents for masked edit","body":"<p>I am trying to set an input mask for Infragistics Ultramaskededit. It has <code>.Mask</code> property (string). I have tried <code>\"999,999.00\"</code> but this cut cents and <code>\"###,###.##\"</code> but this lead to exception. </p>\n\n<p>I have found solution - <code>\"#########.##\"</code> this is mask and <code>Type</code> of the box must be set to <code>double</code> - all works.</p>\n"},{"tags":["c#","database","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13122427,"title":"Changing access database connection string","body":"<p>In my application i have a access database with a list of customers, this database is imported in my project. A combobox datasource is set to display all the customers.</p>\n\n<p>I also created a form so the user can change some settings and locations of certain files. for this i use the <code>this.properties.settings.KlantenDB()</code> the string is created and will save the path to the customer database.</p>\n\n<p>How can i change the current Access database connection string so it will use the KlantenDB path? </p>\n\n<p><img src=\"http://i.stack.imgur.com/rJ4vB.png\" alt=\"enter image description here\"></p>\n"},{"tags":["winforms","cloud"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13122216,"title":"Desktop application in a cloud","body":"<p>Is it possible to run desktop application (WinForms, MS SQL) in a cloud (e.g Azure)? Unfortunately we have legacy application which can't be rewriten in ASP or PHP but our customer doesn't have any infrastructure in his location (besides PC of course) and don't want to buy and maintain any server. Moreover the application needs web server (IIS) for some functions.</p>\n"},{"tags":["c#","winforms","datetimepicker"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":13121312,"title":"C# - DateTimePicker, detect up-down click events","body":"<p>I'm re-writing the C# <code>DateTimePicker (nullable)</code> to fit my needs, but I'm stuck at detecting the up-down events from picking time <code>(HH:mm, DateTimePicker.ShowUpDown = true)</code>.</p>\n\n<p>I am aware that the <code>OnValueChanged</code> is fired when the either the up or down button is pressed, but I already have some handling there (move to next field automatically when a number is typed in to the DateTimePicker), and therefor I need to block the ValueChanged event when those buttons are pressed, and handle it in a different function.</p>\n\n<p>I'm trying to override the WndProc function, but OnValueChanged are called before WndProc. OnKeyDown is also called after OnValueChanged.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13120063,"title":"Update datagridview from last row","body":"<p>I'm trying to update cell vales from last row.I got 4 cols and 4 rows, I want to take the 4th col 4th cell  value  to 3rd row 3rd cell,\nlike that Take the 4th col 3rd cell  value  to 2nd row 3rd cell..etc..!</p>\n\n<p>What is the logical mistake here, how can ifix this??</p>\n\n<p>The below code is working but at the last row(from botton to top) i'm getting an indexing error(Argument out of range).</p>\n\n<pre><code>if (e.ColumnIndex != 3)\n    return;\nint nextRowIndex = e.RowIndex - 1;\nint lastRowIndex = SecondaryGridView.Rows.Count + 1;\nif (nextRowIndex &lt;= lastRowIndex)\n{\n    var value = SecondaryGridView.Rows[e.RowIndex].Cells[3].Value.ToString();\n    SecondaryGridView.Rows[nextRowIndex].Cells[2].Value = value;\n}\n</code></pre>\n"},{"tags":["c#","winforms",".net-assembly","resx"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":154,"score":1,"question_id":13120962,"title":"Could not load file or Assembly with embedded Resources","body":"<p>I'm getting an odd error when accessing embedded resources in an assembly that I've created when it's called from a WinForms app.</p>\n\n<p>Basically I have an assembly that contains a single standard resource file (<code>Resources.resx</code>) in the <code>Properties</code> folder. The assembly is <code>Westwind.RazorHosting</code>, so the resources are generated into <code>Westwind.RazorHosting.Properties</code>. I access the resources using the generated designer class (<code>Resources.Designer.cs</code>) only from within the assembly code.</p>\n\n<p>When I run tests against the project a test project all is well. Errors (which are the main source of resources used in the app) display properly.</p>\n\n<p>However, when the WinForms app calls the app and causes an error, resource access fails. The error is:</p>\n\n<blockquote>\n  <p>Could not load assembly (Westwind.RazorHosting.resources) or one of its dependencies. The system cannot find the file specified</p>\n</blockquote>\n\n<p>Notice that it's not pointing at <code>Westwind.RazorHosting.Properties.resources</code>, but at <code>Westwind.RazorHosting.resources</code>. </p>\n\n<p>When I step into this code with the debugger I step straight into the generated <code>Resources.designer.cs</code> class and the <code>ResourceManager</code> there looks perfectly fine - there's a reference and it points at the right namespace internally. I'm running in the default en-US locale. I checked the assembly generated and the resources do exist under the proper/expected resource id (ie. <code>Westwind.RazorHosting.Properties.ResourceId</code>) - they are present.</p>\n\n<p>Any idea what could be causing .NET to look in the wrong place for resources?</p>\n"},{"tags":["c#","winforms","focus"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1305,"score":4,"question_id":1318236,"title":"How to disable navigation on WinForm with arrows in C#?","body":"<p>I need to disable changing focus with arrows on form. Is there an easy way how to do it?</p>\n\n<p>Thank you</p>\n"},{"tags":["vb.net","winforms"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":4075,"score":0,"question_id":5805335,"title":"How to handle a form close event in vb.net","body":"<p>I have used the below code but its not showing the msgbox. What is wrong with this code ?</p>\n\n<pre><code>Private Sub frmSimple_Disposed(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Disposed\n       Dim result = MsgBox(\"Are you sure you want to Exit ?\", vbYesNo)\n       If result = DialogResult.Yes Then\n        me.Close()\n       End If\nEnd Sub\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":1,"view_count":13053,"score":4,"question_id":4999734,"title":"How to add browse file button to Windows Form using C#","body":"<p>I want to select a file on the local hard disk when I click a \"Browse\" button.</p>\n\n<p>I don't have any idea how to use the <code>OpenFileDialog</code> control. Can anyone help me?</p>\n"},{"tags":["c#","php","winforms","encryption"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":77,"score":-5,"question_id":13016179,"title":"Salt and MD5 in c#","body":"<p>So I have a website for my game </p>\n\n<p>This is an exert of the php that I am using.</p>\n\n<pre><code>$Login = strtolower(trim($Login));\n$Pass = strtolower(trim($Pass));\n$Repass = strtolower(trim($Repass));\n\n$Salt = $Login.$Pass;\n$Salt = md5($Salt);\n$Salt = \"0x\".$Salt;\n</code></pre>\n\n<p>But now I am faced with an issue that I cant seem to work out. I need to be able to do this encryption through C# WinForms for a client side Launcher(Register, Play Game etc etc)</p>\n\n<p>For the life of me I cant figure out how to make the same binary as it makes in php.</p>\n\n<p>I have tried loads but just cant crack it.</p>\n\n<p>Many thanks if you can help</p>\n"},{"tags":["c#",".net","winforms","datagridview"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1309,"score":0,"question_id":5960897,"title":"Remove blue colored row from DataGridView WinForms","body":"<p>When I fill a DataGridView row by row (calling it's add function), the top row gets blue colored.\nIt's not selected because I tried ClearSelection() also but it didnt work.\nIt's giving the wrong illusion that the first row is selected.</p>\n\n<p>How to get rid of it?</p>\n\n<pre><code> void FillDGV()\n    {\n        dataGridViewParties.Rows.Clear();\n        for (int i = 0; i &lt; dataGridViewParties.Columns.Count; i++)\n        {\n            dataGridViewParties.Columns[i].Width = this.Width / dataGridViewParties.Columns.Count;\n        }\n\n\n        DataTable partyTbl = UtilityClass.GetDataTable(@\"SELECT [PartyID]\n                                                        ,[PartyName]\n                                                        ,[PartyAddress]\n                                                        ,[PartyState]\n                                                        ,[PartyCity]\n                                                        ,[PartyPhone]\n                                                        FROM [VegiManager].[dbo].[Parties]\n                                                        WHERE [PartyName] LIKE '\" + textBoxPartySearch.Text + \"%' \");\n        foreach (DataRow dr in partyTbl.Rows)\n        {\n            dataGridViewParties.Rows.Add(1);\n\n            dataGridViewParties.Rows[dataGridViewParties.Rows.Count - 1].Cells[0].Value = dr[\"PartyID\"].ToString();\n            dataGridViewParties.Rows[dataGridViewParties.Rows.Count - 1].Cells[1].Value = dr[\"PartyName\"].ToString();\n            dataGridViewParties.Rows[dataGridViewParties.Rows.Count - 1].Cells[2].Value = dr[\"PartyAddress\"].ToString();\n            dataGridViewParties.Rows[dataGridViewParties.Rows.Count - 1].Cells[3].Value = dr[\"PartyState\"].ToString();\n            dataGridViewParties.Rows[dataGridViewParties.Rows.Count - 1].Cells[4].Value = dr[\"PartyCity\"].ToString();\n            dataGridViewParties.Rows[dataGridViewParties.Rows.Count - 1].Cells[5].Value = dr[\"PartyPhone\"].ToString();\n        }\n\n        if (dataGridViewParties.Rows.Count &gt; 0)\n        {\n            dataGridViewParties.ClearSelection();\n            dataGridViewParties.CurrentCell = null;\n        }\n    }\n</code></pre>\n\n<p>In the debugger I found that CurrentCell is already null before DataGridViewParties.CurrentCell = null; executes.</p>\n\n<p>This question <a href=\"http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/c440c4f6-6dfc-47b6-97c0-1ce49c105b64/\" rel=\"nofollow\">http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/c440c4f6-6dfc-47b6-97c0-1ce49c105b64/</a> is also related to it but does not offer a solution.</p>\n\n<p>EDIT: Its weird but it works for Load event, I was doing it in constructor.\nI want that when the first row is selected and when the user presses the UP arrow key, the focus moves to a certain textbox. But in this case it does not work (first row appears blue)</p>\n\n<pre><code>    private void dataGridViewInwards_KeyDown(object sender, KeyEventArgs e)\n    {\n         if (e.KeyCode == Keys.Up &amp;&amp; dataGridViewParties.SelectedRows.Count &gt; 0 &amp;&amp; dataGridViewParties.SelectedRows[0].Index == 0)\n        {\n            textBoxPartySearch.Focus();\n            dataGridViewParties.ClearSelection();\n            dataGridViewParties.CurrentCell = null;\n        }\n        else if (e.KeyCode == Keys.Up &amp;&amp; dataGridViewParties.SelectedRows.Count == 0)\n        {\n            textBoxPartySearch.Focus();\n        }\n    }\n</code></pre>\n"},{"tags":["c#","winforms","windows-forms-designer"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13119100,"title":"Play .WMV File In Windows Form","body":"<p>I am trying to create a Windows Form application to play .WMV files.</p>\n\n<p>I have 5 videos that i have added to my project, within a Videos folder.</p>\n\n<p>I have created a button for each video, 5.</p>\n\n<p>When a button is clicked, Button1, i want to be able to open Video1.. Using Windows Media Player for example.</p>\n\n<p>Code so far::</p>\n\n<pre><code>    private void PlayVideo1_Click(object sender, EventArgs e)\n    {\n        // Open Windows Media Player\n        System.Diagnostics.Process.Start(\"wmplayer.exe\");\n\n        // Play Video1.\n        Process.Start(\"Video1.wmv\");\n    }\n</code></pre>\n\n<p>Please can you advise what i am doing wrong?</p>\n\n<p>========================</p>\n\n<p>Update:</p>\n\n<p>Can a similar code be used for WPF?</p>\n"},{"tags":["c#","winforms","mouse","sendinput"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13112462,"title":"controlling sendinput mouse movement speed","body":"<p>Is it possible to control the speed of the mouse pointer when using Sendinput method?</p>\n\n<p>For example this is my code:</p>\n\n<pre><code>    public static void ClickMouseDOWN(int x, int y)\n    {\n        INPUT mouseInput = new INPUT();\n        mouseInput.type = (int)InputType.INPUT_MOUSE;\n        mouseInput.mi.dx = CalculateAbsoluteCoordinateX(x);\n        mouseInput.mi.dy = CalculateAbsoluteCoordinateY(y);\n        mouseInput.mi.mouseData = 0;\n\n// mouse teleports instantly\n            mouseInput.mi.dwFlags = (int)MOUSEEVENTF.MOVE | (int)MOUSEEVENTF.ABSOLUTE;\n            SendInput(1, new INPUT[] { mouseInput }, Marshal.SizeOf(mouseInput));\n// mouse teleports instantly\n\n        mouseInput.mi.dwFlags = (int)MOUSEEVENTF.LEFTDOWN;\n        SendInput(1, new INPUT[] { mouseInput }, Marshal.SizeOf(mouseInput));\n\n    }\n</code></pre>\n\n<p>Following code executes MouseMovement + Mouse Button Press (down) command, but the problem is that the pointer teleports at the position (int x, int y) instead of moving to it at some constant speed.</p>\n\n<p>I want to be able to control that speed.</p>\n"},{"tags":["winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1019,"score":0,"question_id":234291,"title":"Why is the form_load event is not called in my Winforms application?","body":"<p>I don´t know why, but my form isn´t calling Form_Load event when it loads.</p>\n\n<p>Any ideas why this might be happening?</p>\n"},{"tags":["c#","winforms","windows-applications"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":55,"score":-4,"question_id":13116410,"title":"LogIn Form , Help Plz","body":"<pre><code>private void btnLogIn_Click(object sender, EventArgs e)\n    { \n\n        SqlCommand cmd = null;            \n        string strUserName = txtUserName.Text;\n        string strPwd = txtPwd.Text;\n        try\n        {\n            if (Login(strUserName, strPwd))\n            {\n                HRMS.PL.Home frmHome = new HRMS.PL.Home(this);                    \n                frmHome.Show();                    \n                this.Hide();                    \n            }\n            else\n                MessageBox.Show(\"Invalid login\");\n        }\n        catch (Exception ex)\n        {\n            MessageBox.Show(ex.Message);\n        }\n        finally\n        {\n            con.Close();\n        }\n    }\n    public bool Login(string username,string pwd)\n    {\n        bool found = false;            \n        DataTable dt = DataConnector.FnGetMultipleVal(\"SELECT * FROM UserDetails WHERE username='\" + username + \"' AND userpassword='\" + pwd + \"'\");\n\n        if (dt != null)\n        {\n            if (dt.Rows.Count &gt; 0)\n                found = true;\n        }\n        return found;\n    }\n</code></pre>\n\n<p>Hi,</p>\n\n<pre><code>This is the code i've written for 'logIn' form. I need to save the value of 'UserName' from this 'LogIn' form and let it be available for all other forms in application.... How can it be done...? There is nothing like 'Session' in windows application :(\n</code></pre>\n\n<p>And, one more thing..,There are 3 types of users</p>\n\n<p>1.Admin (UserType - 'A')</p>\n\n<p>2.Manager (UserType - 'M')</p>\n\n<p>3.Employee (UserType - 'E')</p>\n\n<p>Would like to set module security based on logged-in user's type...In the 'logIn' Form itself.</p>\n\n<p>like, if(user is of type E)\n          certain menu items are only visble like dat </p>\n\n<p>How can i modify above code to meet the above mentioned requiremnts..Help plz..</p>\n"},{"tags":["c#","winforms","copy","notepad"],"answer_count":5,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":79,"score":5,"question_id":13118660,"title":"how to copy all text from a certain webpage and save it to notepad C#","body":"<p>I have a C# Windows Forms app that launches a webpage based on some criteria.</p>\n\n<p>Now I would like my app to automatically copy all the text from that page (which is in CSV format) and paste and save it in notepad.</p>\n\n<p>Here is a link to an example of the data that needs to be copied:\n<a href=\"http://www.wunderground.com/history/airport/FAJS/2012/10/28/DailyHistory.html?req_city=Johannesburg&amp;req_state=&amp;req_statename=South+Africa&amp;format=1\" rel=\"nofollow\">http://www.wunderground.com/history/airport/FAJS/2012/10/28/DailyHistory.html?req_city=Johannesburg&amp;req_state=&amp;req_statename=South+Africa&amp;format=1</a></p>\n\n<p>Any Help will be appreciated.</p>\n"},{"tags":["c#","winforms","datagridview","custom-controls"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13118251,"title":"How to paint custom control on datagridviewcell?","body":"<p>I want to host a custom control for <code>datagridviewcell</code>. </p>\n\n<p>the only good reference i have was <a href=\"http://msdn.microsoft.com/en-us/library/7tas5c80.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/7tas5c80.aspx</a></p>\n\n<p>However, i want the cell to display my own usercontrol instead on </p>\n\n<pre><code> public class CustomCell : DataGridViewTextBoxCell\n {   \n     protected override void Paint(System.Drawing.Graphics graphics,\n       System.Drawing.Rectangle clipBounds, System.Drawing.Rectangle cellBounds,\n        int rowIndex, DataGridViewElementStates cellState, object value, object \n          formattedValue, string errorText, DataGridViewCellStyle cellStyle,\n            DataGridViewAdvancedBorderStyle advancedBorderStyle, DataGridViewPaintParts paintParts)\n     {\n          base.Paint(graphics, clipBounds, cellBounds, rowIndex, cellState, value, \n            formattedValue, errorText, cellStyle, advancedBorderStyle, paintParts);               \n     }\n }\n</code></pre>\n\n<p>Can anyone guide me how to do it ?</p>\n"},{"tags":["c#","winforms","control","invoke","nullreferenceexception"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":574,"score":1,"question_id":6434254,"title":"c# winform Invoke throws NullReferenceException","body":"<p>i'm working on an winform(mdi) pro. And I need to update a dataGridView control when i get new data from another thread. and when new data comes and i'm dragging the dataGridview scroll, it throw a nullreference exception in dataGridView.Invoke.  i have searched for few days and drove google crazy，but didn't help. \nthe code like this:</p>\n\n<pre><code>  \n    public void ReceiveNewData(object sender, UpateEventArgs ex)\n    {\n        if (this.dataGridView.InvokeRequired)\n        {\n            dataGridView.Invoke(new UpateEventHandler(ReceiveNewData), new object[] { this, ex });\n        }\n        else\n            this.BindNewData();\n    }\n\n    private void BindNewData()\n     {\n\n        if (dataGridView!= null && (QuoteMember.listOneClickQuoteItem != null || QuoteMember.listMarketingQuoteItem != null))\n        {\n            DataTable dataSource = PublicFunction.ToDataTable(QuoteMember.listOneClickQuoteItem);\n            if (dataSource != null)\n                    dataSource.Merge(PublicFunction.ToDataTable(QuoteMember.listMarketingQuoteItem), true);\n                else\n                    dataSource = PublicFunction.ToDataTable(QuoteMember.listMarketingQuoteItem);\n            dataGridView.DataSource = dataSource;\n        }\n    }\n\npublic PublicFunction\n{\n        public static DataTable ToDataTable(List dataSource)\n        {\n            if(dataSource != null)\n                return ToDataTable((dataSource.ToArray()), 1);\n            return null;\n        }\n\n        public static DataTable ToDataTable(List dataSource) \n        {\n            if (dataSource != null)\n                return ToDataTable((dataSource.ToArray()), 2); \n            return null; \n        }\n        private static DataTable ToDataTable(QuoteItemBase[] m, int type)\n        {\n            DataTable dsTemp = null;\n\n            if (type == 1)\n            {\n                dsTemp = new DataTable(\"OneClickQuote\");\n            }\n            else if (type == 2)\n            {\n                dsTemp = new DataTable(\"MarketingQuote\");\n            }\n            else\n                dsTemp  = new DataTable(\"temptable\");\n\n            dsTemp.Columns.Add(\"Date\");\n            dsTemp.Columns.Add(\"Time\");\n            dsTemp.Columns.Add(\"NO\");\n            dsTemp.Columns.Add(\"Name\");\n\n\n            if (m == null)\n                return dsTemp;\n\n            foreach (var item in m)\n            {\n                DataRow drTemp = dsTemp.NewRow();\n                drTemp[\"Date\"] = item.date;\n                drTemp[\"Time\"]  = item.time;\n                drTemp[\"NO\"] = item.no;\n                drTemp[\"Name\"] = item.name;\n                dsTemp.Rows.Add(drTemp);\n\n            }\n\n            return dsTemp;\n      }\n}\n\n\n\n\n\n\n</code></pre>\n\n<p>PS:\n  if new data comes and i'm not dragging scroll bar, it works fine.</p>\n\n<p>any ideas? \nthank you !</p>\n"},{"tags":[".net","winforms"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":3,"view_count":55,"score":-2,"question_id":13046382,"title":"How to create a custom frame with buttons in it...?","body":"<p>Hi can anybody tell me how to create a custom made frame similar to the pic that i have posted here. The frame should be re sizable based on the buttons placed in it.<img src=\"http://i.stack.imgur.com/ArlCY.png\" alt=\"enter image description here\"></p>\n\n<p>The uploaded pic might give a better idea, i want to create something similar to that. So how to create such frames in windows form?</p>\n\n<p>My code:</p>\n\n<p>private void button1_Click(object sender, EventArgs e)\n        {</p>\n\n<pre><code>        int start_x = Convert.ToInt32(textbox1.Text);\n        int start_y = Convert.ToInt32(textbox2.Text);\n\n        //Clear out the existing controls, we are generating a new table layout\n        tableLayoutPanel1.Controls.Clear();\n\n        //Clear out the existing row and column styles\n        tableLayoutPanel1.ColumnStyles.Clear();\n        tableLayoutPanel1.RowStyles.Clear();\n\n        //Now we will generate the table, setting up the row and column counts first\n        tableLayoutPanel1.ColumnCount = start_x;\n        tableLayoutPanel1.RowCount = start_y;\n\n        for (int x = 0; x &lt; start_x; x++)\n        {\n            //First add a column\n            tableLayoutPanel1.ColumnStyles.Add(new ColumnStyle(SizeType.AutoSize));\n\n           for (int y = 0; y &lt; start_y; y++)\n           {\n                //Next, add a row.  Only do this when once, when creating the first column\n                if (x == 0)\n                {\n                    tableLayoutPanel1.RowStyles.Add(new RowStyle(SizeType.AutoSize));\n                }\n\n                //Create the control, in this case we will add a button\n                Button cmd = new Button();\n                cmd.Width = 120;\n                cmd.Height = 60;\n                cmd.BackColor = Color.LightGreen;\n                cmd.FlatStyle = FlatStyle.Popup;\n                cmd.Text = string.Format(\"ds\");\n                cmd.Click += new EventHandler(this.btnDynamicButton_Click);\n\n                //Finally, add the control to the correct location in the table\n                tableLayoutPanel1.Controls.Add(cmd, x, y);\n            }\n</code></pre>\n\n<p>But I don't know how to create that frame and arrange it accordingly.</p>\n"},{"tags":["mysql","vb.net","winforms","visual-studio-2010"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13115501,"title":"ComboBox is Databound and I want to show the data on the textbox","body":"<p>A little tip or help would be very much appreciated, please and thank you. </p>\n\n<p>I have a <code>DataBound ComboBox</code> from my <code>MySql</code> table named <code>\"formmaintenance\"</code> which has 3 columns namely <code>FormCode</code>, <code>FormName</code>, <code>FormDescription</code>,  <code>Combobox DisplayMember</code> is <code>FormCode</code> and <code>ValueMember</code> is <code>FormCode</code> as well, I have 2 <code>TextBoxes</code>  named as <code>txtName</code> and <code>txtDesc</code>. </p>\n\n<p>What I would like to happen is when I select an item in Combobox (ex: form101) I want to display the value of <code>FormName</code> of selected item (ex name: Paper) on <code>txtName</code> and <code>FormDescription</code> on <code>txtdesc</code>. </p>\n\n<p>I have yet to know how to start with this, since I'm really new with Vb.Net. </p>\n\n<p>Here is my Code(<strong>Updated</strong>)</p>\n\n<pre><code> If conn.State = ConnectionState.Closed Then\n            conn.ConnectionString = \"Server = localhost; Username= root; Password =; Database =forms\"\n            Try\n                conn.Open()\n                MsgBox(\"Connection Established\")\n                Dim dt As New DataTable\n\n                Dim sql = \"SELECT FormName FROM formma WHERE  FormCode = '\" &amp; cmbCode.Text &amp; \"';\"\n                Dim Result As String\n\n\n                cmd.Connection = conn\n                cmd.CommandText = sql\n                Result = cmd.ExecuteScalar()\n                da.SelectCommand = cmd\n\n                dr = cmd.ExecuteReader()\n\n                If Result IsNot Nothing Then\n                    txtName.Text = Result.ToString()\n\n                End If\n\n            Catch ex As MySqlException\n                Console.WriteLine(\"Error: \" &amp; ex.ToString())\n\n            End Try\n        End If\n\n    End Sub\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":53,"score":-3,"question_id":13116230,"title":"Bind SQL database in TreeView Control Using C#","body":"<p>how to bind the sql databases using Connection string in Tree view control using C# ..</p>\n\n<p>purpose :-  i need to get all databases and their Table , functions, triggers, views and stored procedure   in a tree-view control in win-form using C#  </p>\n\n<p>for Example :- </p>\n\n<p>SERVER7\n|<em>Databases\n      |<strong>Northwind\n      |       |</em>_Tables\n      |       |     |</strong>_dbo.users \n      |       |     |<strong>_dbo.master\n      |       |     |</strong>_dbo.test\n      |       |     |<strong><em>dbo.members\n      |       |\n      |       |</em>_Views\n      |       |     |</strong>_dbo.Vcandidate\n      |       |     |<strong><em>dbo.employee\n      |       |</em>_StoredProcedure\n      |       |     |</strong>_dbo.sp1\n      |       |     |<strong>_dbo.sp2\n      |       |     |</strong>_dbo.sp3\n      |       |     |<strong><em>dbo.sp4\n      |       |</em>_Functions\n      |             |</strong><em>dbo.function1\n      |             |</em>__dbo.fuction2\n      |\n      |__sampleDb2</p>\n"},{"tags":[".net","winforms","datagridview","controls"],"answer_count":6,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":24797,"score":5,"question_id":2154154,"title":"DataGridView - how to set column width?","body":"<p>I have a WinForms application with <code>DataGridView</code> control. My control has five\ncolumns (say \"Name\", \"Address\", \"Phone\" etc)</p>\n\n<p>I am not happy with default column width. I want to have more control over column appearance. What I want\nis to be able to do one of the following:</p>\n\n<ul>\n<li>Set width of each column in percent</li>\n<li>Set width of each column in pixels</li>\n<li>Use some other best-practive method (make width to fit text etc)</li>\n</ul>\n\n<p>Please suggest - which property to use and how.</p>\n"},{"tags":["c#","winforms","events","datagridview","mouseevent"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13116684,"title":"How to make the scrollbar note scroll when the mouse wheel event happens in C# WINForm datagridview","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1882993/c-sharp-how-do-i-prevent-mousewheel-scrolling-in-my-combobox\">C# - how do I prevent mousewheel-scrolling in my combobox?</a><br>\n  <a href=\"http://stackoverflow.com/questions/2968189/disable-mouse-scroll-wheel-in-combobox-vb-net\">Disable mouse scroll wheel in combobox VB.NET</a>  </p>\n</blockquote>\n\n\n\n<p>All\n    I have a problem that I want to make the VerticalScrollBar  not scroll in Datagridview when I make the mouse wheeling.</p>\n\n<p>I have get some codes like this:</p>\n\n<blockquote>\n<pre><code>  private void dgwFlowerPics_MouseWheel(object sender, MouseEventArgs e)\n    {\n        int iRowIndex = iSelectedIndex;\n</code></pre>\n</blockquote>\n\n<pre><code>        if (e.Delta &gt; 0) \n        {\n            SendKeys.Send(\"{UP}\");  \n\n\n        }\n        else \n        {\n            SendKeys.Send(\"{DOWN}\"); \n        }\n    }\n</code></pre>\n\n<p>But the scrollBar  still scrolls when I wheel the mouse.How I can resolve it ?</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":13092672,"title":"How to center a form after programmatically switching screens","body":"<p>Given a <code>Form</code> I want to center the form after switching screens.  How can I accomplish the task?</p>\n\n<pre><code> internal static void SetFormToBiggestMonitor(Form form, bool center = true)\n    {\n        Screen biggestScreen = FindBiggestMonitor();//assume this works\n        form.Location = biggestScreen.Bounds.Location;\n\n        if (center)\n        {\n            form.StartPosition = FormStartPosition.CenterScreen;\n        }\n    }\n</code></pre>\n"},{"tags":["c#","winforms","textbox"],"answer_count":6,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":8095,"score":4,"question_id":4811229,"title":"How to clear the text of all textBoxes in the form?","body":"<pre><code>private void CleanForm()\n{\n    foreach (var c in this.Controls)\n    {\n        if (c is TextBox)\n        {\n            ((TextBox)c).Text = String.Empty;\n        }\n    }\n}\n</code></pre>\n\n<p>This method above doesn't work and the controls aren't cleared. It compiles fine, but does nothing.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["c#","winforms","visual-studio-2010","listbox"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":50,"score":-1,"question_id":13105625,"title":"why does the CLEAR button seem to disable my listbox label output when I press ENTER a second time after selecting items?","body":"<p>When I run my program with a listbox everything works after selecting the items and pressing enter, but when I press the clear button and I select the items again and press enter nothing happens. I've tried the following for the clear button and they clear my label text and the selected listbox but I can no longer produce another output when I try pressing enter button again after selecting the items.</p>\n\n<pre><code> public partial class frmLabSix : Form\n{\n    public string strCakes;\n    public int cakeCost;\n\n\n    public frmLabSix()\n    {\n        InitializeComponent();\n    }\n\n    private void lstCakes_SelectedIndexChanged(object sender, EventArgs e)\n    {   \n        for (int index = 0; index &lt; lstCakes.SelectedItems.Count; index++)\n        {\n            strCakes += Environment.NewLine + lstCakes.SelectedItems[index].ToString();\n\n            if (lstCakes.SelectedIndices[index] == 0) cakeCost += 18;\n            if (lstCakes.SelectedIndices[index] == 1) cakeCost += 25;\n            if (lstCakes.SelectedIndices[index] == 2) cakeCost += 40;\n            if (lstCakes.SelectedIndices[index] == 3) cakeCost += 30;\n        }\n\n    }\n\n    private void lblOrdered_Click(object sender, EventArgs e)\n    {\n\n    }\n\n    private void btnEnter_Click(object sender, EventArgs e)\n    {\n        double tax = 1.13;\n        lblOrdered.Text = \"You have ordered: \" + strCakes + '\\n' + \"Total Cost: \" + (tax * cakeCost).ToString(\"C\");\n        lblOrdered.Visible = true;\n    }\n\n    private void btnClear_Click(object sender, EventArgs e)\n    {\n        lstCakes.SelectedItems.Clear();\n        lblOrdered.Visible = false;\n    }\n\n    private void btnExit_Click(object sender, EventArgs e)\n    {\n        this.Close();\n    }\n}\n</code></pre>\n\n<p>Can someone tell me why this is?</p>\n"},{"tags":["c#","winforms","textbox","mask"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":3199,"score":3,"question_id":2259850,"title":"Win Forms text box masks","body":"<p>How can I put mask on win form text box so that it allows only numbers?\nAnd how it works for another masks data, phone zip etc.</p>\n\n<p>I am using Visual Studio 2008 C#</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","winforms","datagridview","dataset"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1050,"score":0,"question_id":9585086,"title":"Getting a dataset from an unbound datagridview","body":"<p>I have a datagridview that is not bound directly do a datasource. Instead, I add the data from various methods during runtime. I created a method that accepts a dataSet and outputs it into Excel, but I can't find if there is an in-built way to geta dataSet from a dataGridView.</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","winforms","numericupdown"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":774,"score":0,"question_id":3865780,"title":"Getting value of NumericUpDown moves caret position, can I stop this?","body":"<p>I've noticed that when I request the <code>Value</code> of a <code>NumericUpDown</code> control in a C# app, the caret is reset to position 0. This is annoying because my app is periodically grabbing the value of the control, so if this happens while a user is typing into it the caret unexpectedly moves, messing with their input.</p>\n\n<p>Is there a way to prevent this, or a workaround? It doesn't seem to have a <code>SelectionStart</code> property, otherwise I could have the polling process save the caret position, get the value, then set it back as a decent workaround.</p>\n"},{"tags":["c#","winforms","visual-studio-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":13114609,"title":"How to convert three Windows Forms applications to one?","body":"<p>I created 3 different (but sharing same database connection) Windows Forms applications. Each such application is very simple and consists of a single form only.</p>\n\n<p>Assuming I have 3 forms: Form1, Form2 and Form3, I now want to define Form1 is the main form (and only application), and invoke Form2 and Form3 from within Form1, as part of the Form1 application, not as independent applications. Something similar to:</p>\n\n<pre><code>private void btnForm2_Click(object sender, EventArgs e)\n{\n    Form2 form2 = new Form2();\n    form2.Show();\n}\n\nprivate void btnForm3_Click(object sender, EventArgs e)\n{\n    Form3 form3 = new Form3();\n    form3.Show();\n}\n</code></pre>\n\n<p>While that seems simple, I am confused as to how to import Form2 and Form3 to the Form1 project without compromising the integrity of what VS 2010 already did \"automagically\".</p>\n\n<p>That is, I believe that it's not only the <code>Form2.cs</code> file that I need to drag and drop into the <code>Form1</code> project, but other files as well, such as <code>Form2.Designer.cs</code>, <code>Form2.resx</code> and... more? </p>\n\n<p>Do I need to copy the files under the project's <code>Properties</code> and <code>References</code> too?</p>\n\n<p>What are the steps required to methodically convert the three projects into one?</p>\n"},{"tags":["c#","winforms","properties","attributes","embedded-resource"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13113788,"title":"Attribute in C# winforms to specify resource selector?","body":"<p>I made a custom control for WinForms in C#. One of it's properties is an audio stream that will be played at some point. Is there a way I can tell VS that this property should be chosen from the resource manifest (specifically audio resources) with a property or similar?</p>\n\n<p><img src=\"http://i.stack.imgur.com/GshrF.png\" alt=\"The property, defined.\"></p>\n\n<p>The commented property is an audio stream.</p>\n\n<p><img src=\"http://i.stack.imgur.com/4phCV.png\" alt=\"Control properties.\"></p>\n\n<p>This is how it shows in the WinForms designer.</p>\n\n<p><img src=\"http://i.stack.imgur.com/c0N3h.png\" alt=\"Binary data editor.\"></p>\n\n<p>This is what you get when you click the edit [...] button. I want this to be replaced by an [audio] resource chooser.</p>\n"},{"tags":["c#","sql-server","winforms","radio-button","global-variables"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13105887,"title":"Passing a value to a global variable for reference with WinForms (C#) and SQL Connection","body":"<p>I need two global variables to be accessed by multiple winforms at various stages.</p>\n\n<p>The first is in regards to a distinct user, after logging in to the app,\nother winforms need to get data from sql server tables based on the user who logged in.</p>\n\n<pre><code>SqlCommand cmd = new SqlCommand(\"SELECT * FROM regClient WHERE client_ID = **[GLOBAL VARIABLE]**\", con);\n</code></pre>\n\n<hr>\n\n<p>The second follows this in that the user can log in as either a <strong>Client</strong> or <strong>Student</strong>. Different statements need to be called based on this. This value is set by radiobutton on the login window.</p>\n\n<p>So if radClient is checked set global to 'client', if radStudent is checked set global to 'student'\nthen with other winforms can call select statements or enable/visible based on what the global is.</p>\n\n<hr>\n\n<p>I believe I can store variables in <strong>Programs.cs</strong> but I'm not sure.</p>\n"},{"tags":["c#","winforms","data-binding","plot","mschart"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":12603109,"title":"how to add multiple non continuous lines with x-as overlap in a mschart","body":"<p>I'n not really familiar with ms chart and have been googleing throughout the day to find an example of what I need, but was not able to find it. </p>\n\n<p>I would like to be able to plot multiple lines on a chart like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/OW4uH.png\" alt=\"enter image description here\"></p>\n\n<p>(this is done manually, just to make clear what I need).</p>\n\n<p>I can calculate each value the line has per x value per line. I store it in a list which hold the DateAndValue object:</p>\n\n<pre><code>[Serializable]\npublic struct DateAndValue\n{\n    public uint DBDate { get; set; }\n    public double Value { get; set; }\n    public int BarNumber { get; set; }\n}\n</code></pre>\n\n<p>As you can see, it's not really possible to use one list for support lines and one for resistance, because there might be multiple lines of the same sort (i.e. support) in the same period.</p>\n\n<p>What would be a good way of storing (must be update-able) the data and plot it in the chart, without having zero values when there is no data.</p>\n\n<p>I could also make an object that only contains start and end point per line. In that case I would just update the end value if necessary.</p>\n\n<p>Suggestions would be highly appreciated.\nKind regards,</p>\n\n<p>Matthijs</p>\n"},{"tags":["c#","winforms","multithreading","parallel-processing"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":13112561,"title":"C# Threading, 1st Task DoSomething, 2nd Task update a WinFormLabel (Realtime)?","body":"<p>Lets say I have Task 1:</p>\n\n<pre><code>private void Task1()\n{\n    //Here is some Code, could be any \"longer\" Task - \n    //For Example: Grab all words from a .txt File and fill in a List&lt;String&gt;\n}\n</code></pre>\n\n<p>Then I have an other Task 2:</p>\n\n<pre><code>private void Task2(string word)\n{\n   //So lets say theres a Label on my WinForm..\n   //Now While Task1 is grabbing the words, Task2 should fill a Label \n   //with the added 'word' (parameter) - (Task2 will be called from Task1\n}\n</code></pre>\n\n<p>Actually I don't know how to make this possible, or whats the best way. On the UI I should be able to see the <code>Label.Text</code> changing (every word).. So I need to make a second Thread? How could I do this? Maybe someone could help me, cheers</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>I tried it now with the Backgroundworker, but something seems to be false.. its actually not working, nothing happens on the form</p>\n\n<p>Code:</p>\n\n<pre><code>public void CreateAndSaveAMatch(DateTime date) //That method is being called several times\n{   \n    //HERE IS CODE, WHICH CREATES AND SAVES A MATCH\n\n    // Start the asynchronous operation.\n    backgroundWorker1.RunWorkerAsync(date);\n\n}\n\nprivate void backgroundWorker1_DoWork(object sender, DoWorkEventArgs e)\n{      \n    backgroundWorker1.ReportProgress(0, Convert.ToDateTime(e.Argument).ToShortDateString());          \n}\n\nprivate void backgroundWorker1_ProgressChanged(object sender, ProgressChangedEventArgs e)\n{\n    label1.Text = (string)e.UserState; //here on the Label I would like to show the Date\n}\n</code></pre>\n"},{"tags":["c#","winforms","slider","trackbar"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13112869,"title":"Is there any control or in way to use DateTime slider in windows form","body":"<p>I have a winForm, in which have a requirement to use Silder that could slide on <code>DateTime</code> and grid is refreshed according to the date selected.</p>\n\n<p>Is there any control that provides above functionality.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["vb.net","winforms","barcode-scanner"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13112704,"title":"Catch Data from a barcode scanner connected via Ethernet","body":"<p>I have a vb.net application that needs to catch the readings from a barcode scanner in a TextBox. </p>\n\n<p>As far as I know, the scanners work sending the data as keystrokes, but I dont know if that still applies when it's connected via Ethernet cable</p>\n\n<p>Well, to get to the point, will the scanner send the data automatically to the textbox? or it will be necesary to work with sockets to handle the readings? and in that case, can some please point me in the right direction.</p>\n\n<p>Thanks in advance.</p>\n\n<p>-x-</p>\n\n<p>In case you ask, the scanner is a COGNEX DATAMAN 500QL</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13112521,"title":"c# adding checkboxes to panle wierd behavior","body":"<p>i got a Class called AdvancePanle that drived from Panle, and i got a class call AdvnaceCheckBox that drived from CheckBox.</p>\n\n<p>I created a AdvancePanle in my Form, and now i want to add some AdvnaceCheckBox's to it.\nso i created this, simple method:</p>\n\n<pre><code> private void addCheckBox()\n    {\n        AdvancedCheckBox checkbox;\n        for (int i = 0; i &lt; 10; i++)\n        {\n            checkbox = new AdvancedCheckBox();\n            checkbox.Location = new Point(0, i + 5);\n            checkbox.Text = \"bla\" + i;\n            selectablePanel1.Controls.Add(checkbox);\n        }\n    }\n</code></pre>\n\n<p>and i call this method in the Form onLoad:</p>\n\n<pre><code> protected override void OnLoad(EventArgs e)\n        {\n            addCheckBox();\n            selectablePanel1.AutoScroll = true;\n\n            base.OnLoad(e);\n        }\n</code></pre>\n\n<p>but afther the Form is opened, I can see only 1 CheckBox in the Panle.\ni tried playing with the position, but i alwys see only 1 checkbox.</p>\n\n<p>am I adding the CheckBoxs in a worng way?</p>\n\n<p>(sorry for my english)</p>\n"},{"tags":["c#","winforms","winapi"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":37,"score":0,"question_id":13112586,"title":"Receiving system messages for window created by 'CreateWindowEx' function (API)","body":"<p>I create control by 'CreateWindowEx' function, and I want to get system messages (mouse, keyboard, etc.) of this window, how do I write the function that gets the messages? </p>\n"},{"tags":["c#","winforms","watermark"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2177,"score":0,"question_id":5302242,"title":"How to use watermark System.Windows.Forms.TextBox using C#?","body":"<p>I wanna use watermark in Text Boxes of my Windows Form using c#? </p>\n\n<p>I have found <a href=\"http://stackoverflow.com/questions/578193/watermark-system-windows-forms-textbox-using-c\">this link</a> in stackoverflow. But I really could not figure out how to use in my windows application.</p>\n\n<pre><code>class WatermarkTextBox : TextBox\n{\n    private const uint ECM_FIRST = 0x1500;\n    private const uint EM_SETCUEBANNER = ECM_FIRST + 1;\n\n    [DllImport(\"user32.dll\", CharSet = CharSet.Auto, SetLastError = false)]\n    static extern IntPtr SendMessage(IntPtr hWnd, uint Msg, uint wParam, [MarshalAs(UnmanagedType.LPWStr)] string lParam);\n\n    private string watermarkText;\n    public string WatermarkText\n    {\n        get { return watermarkText; }\n        set\n        {\n            watermarkText = value;\n            SetWatermark(watermarkText);\n        }\n    }\n\n    private void SetWatermark(string watermarkText)\n    {\n        SendMessage(this.Handle, EM_SETCUEBANNER, 0, watermarkText);\n    }       \n\n}\n</code></pre>\n\n<p>Please help how to use SendMessage Method Or Suggest me any other (easy) way to use watermark.</p>\n"},{"tags":["visual-studio","winforms","visual-studio-2005"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3601,"score":0,"question_id":34284,"title":"How to fix the following build error in Visual Studio 2005: '\"LC.exe\" exited with code -1'","body":"<p>I get the following error when building my Windows Forms solution: </p>\n\n<p>'\"LC.exe\" exited with code -1'</p>\n\n<p>I use 2 commercial Windows Forms Libraries: Infragistics and the Gantt-Control from plexityhide.com, that's why I have licenses.licx files in my WinForms Projects. We also use Visual Sourcesafe as our Source Control.</p>\n\n<p>When the licenses.licx files are in the Projects I cannot build without the above error. However, when I exclude them from my projects the build works fine. But I need the licenses.licx files when I want to work with the commercial controls in the designer.</p>\n\n<p>This is a brand new developer machine with Windows XP SP3 (German) and Visual Studio 2005 Team Edition for Software Developers (German) with SP1. </p>\n\n<p>It's Windows XP 32-Bit by the way.</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":164,"score":2,"question_id":9779590,"title":"form closing event in multiple windows form application using visual c#","body":"<p>I have a multiple windows form application (frmMian, frmSteg and frmCrypt) in c#. From the main form (frmMain), I can call the other (two) forms. How can Iuse the form closing event similar to that used in VB to return to the main form whenever I exit any of the two forms?</p>\n\n<pre><code> FrmSteg frmstego = new FrmSteg();\n    FrmCrypto frmcrypt = new FrmCrypto();\n\n    private void btnsteg_Click(object sender, EventArgs e)\n    {\n\n        frmstego.Show();\n        this.Hide() ; \n    }\n\n    private void btncrypto_Click(object sender, EventArgs e)\n    {\n\n        frmcrypt.Show();\n        this.Hide();\n    }\n</code></pre>\n"},{"tags":["c#","winforms","passwords","parameter-passing"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":5,"view_count":58,"score":-3,"question_id":13111150,"title":"Checking if username is in datatable in c#","body":"<p>I'm working on VS2010 c#.</p>\n\n<p>I have a datatable containing username and passwords:</p>\n\n<pre><code>____________\nandy | 1234\njoni | 5678\nlara | 4567\n</code></pre>\n\n<p>How do I form a function that will see what the user entered in a textbox and review if it is in the database or not?</p>\n"},{"tags":["winforms","c#-4.0"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13111250,"title":"Anti aliasing or smoothing fonts of labels ,textbox etc in windows forms","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13110677/how-to-anti-alias-the-fonts-in-visual-studio-in-windows-forms-application\">How to anti-alias the fonts in visual studio in windows forms application?</a>  </p>\n</blockquote>\n\n\n\n<p>how can I make my font look smooth like <a href=\"http://www.freeimagehosting.net/uploads/a8e533c7b6.png\" rel=\"nofollow\">the upper font in this image</a>??\nI not talking about cleartype(it is enabled) but the text dont look smooth and crisp as they are on websites</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":13110436,"title":"two dimensional array of buttons?","body":"<p>I want to create two dimensional array of buttons in windows form. I have to do it with for loops because I want to have an array of 100 buttons. But I cant get it to work. I tried with List> and with Buttton[,] but doesn't work. When I try like this:</p>\n\n<pre><code>private List&lt;List&lt;Button&gt;&gt; LEDarray = new List&lt;List&lt;Button&gt;&gt;();\n\n        for (int y = 0; y &lt; 5; y++)\n        {\n            this.tempList.Clear();\n\n            for (int x = 0; x &lt; 20; x++)\n            {\n                this.tempList.Add(new Button());\n            }\n\n            this.LEDarray.Add(tempList);\n        }\n        for (int y = 0; y &lt; 5; y++)\n        {\n            for (int x = 0; x &lt; 20; x++)\n            {\n                this.LEDarray[y][x].BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(0)))), ((int)(((byte)(64)))), ((int)(((byte)(0)))));\n                this.LEDarray[y][x].FlatStyle = System.Windows.Forms.FlatStyle.Flat;\n                this.LEDarray[y][x].ForeColor = System.Drawing.Color.Black;\n\n                xPos = xOffset + LEDsize * x + 20;\n                yPos = yOffset + LEDsize * y + 20;\n\n                this.LEDarray[y][x].Location = new System.Drawing.Point(xPos, yPos);\n                this.LEDarray[y][x].Name = \"button\" + y.ToString() + x.ToString(); \n                this.LEDarray[y][x].Size = new System.Drawing.Size(LEDsize, LEDsize);\n                this.LEDarray[y][x].TabIndex = 0;\n                this.LEDarray[y][x].UseVisualStyleBackColor = false;\n            }\n        }\n\n        for (int y = 0; y &lt; 5; y++)\n        {\n            for (int x = 0; x &lt; 20; x++)\n            {\n                this.Controls.Add(this.LEDarray[y][x]);\n            }\n        }\n</code></pre>\n\n<p>It only display the last row of buttons. So just fifth row and not the previous one. When I try similar with Button array it does not work at all. But array way is just SOS call. I want to do it with List so can you help me with code above to make it work? </p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13110202,"title":"Override column cells text in a datagridview","body":"<p>By this way we can override datagridview col string: and put in this format Config1, Config2 etc....!</p>\n\n<pre><code>DataSet ds = new DataSet();\n ds.ReadXml(@\"D:\\test\\a.xml\");\n for (int i = 1; i &lt;= ds.Tables[0].Rows.Count; i++)\n  {\n       ds.Tables[0].Rows[i - 1][0] = \"Config\" + i;\n  }\n  dataGridView1.DataSource = ds.Tables[0];\n</code></pre>\n\n<p>In my case, my datagridview col has already filled data from a xml file after that I want to override by above method (I'm not using any dataset to read xml file)</p>\n\n<p>This is my approach &amp; it's completely wrong... any help?? </p>\n\n<pre><code>private void writefunction()\n{\n        for (int i = 1; i &lt;= dataGridView3.Columns[\"id\"].Index; i++)\n        {\n            dataGridView3.Columns[i - 1][0] = \"Config\" + i;\n        }\n}\n</code></pre>\n"},{"tags":["c#","winforms","visual-studio-2010"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":146,"score":0,"question_id":6339528,"title":"Locking mouse click on specific region of form","body":"<p>I want to lock mouse click for specific time.\nI am loading data, at that time i don't want to give permission to click on tab control.</p>\n"},{"tags":["c#","winforms","datagridview","event-handling"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":74,"score":2,"question_id":13106891,"title":"CellValidating error on cell focus","body":"<p>I got 2 Datagridview in my form and I'm using  cell validation and cell validating event handler.. in my datagridview. If i leave the cursor in the cell itself and try to open a new file through menu click..i'm getting a error message : \"Argument out of exception was unhandled by usercode, index was out of range.\"</p>\n\n<p>I know, when the cursor is in the cell, it got focus and it's in the process of cell validating that's why i'm getting this error.  </p>\n\n<p>This line throws the error with the message : \"Argument out of exception was unhandled by usercode, index was out of range.\"\n<code>datagridview.Rows[e.RowIndex].ErrorText = \"\";</code></p>\n\n<p>How can i avoid this error?? Or How can i remove focus during menu click to open a new file?? Thank you.</p>\n\n<pre><code>private void datagridview_CellValidating(object sender, CellValidatingEventArgs e)\n            {\n                if (e.ColumnInfo.Name == \"Item1\" || e.ColumnInfo.Name == \"Item2\")\n                {\n                    datagridview.Rows[e.RowIndex].ErrorText = \"\";\n                    int newInteger;\n                    if (datagridview.Rows[e.RowIndex].IsModified)\n                        return;\n                    if (!int.TryParse(e.Value.ToString(),\n                         out newInteger) || newInteger &lt; -50000 || newInteger &gt; 50000)\n                    {\n                        e.Cancel = true;\n                        datagridview.Rows[e.RowIndex].ErrorText = \"The value must be a non-negative integer\";\n                    }\n                }\n\n            }\n\n private void datagridview_CellValidated(object sender, CellValidatedEventArgs e)\n            {\n\n                if (e.ColumnIndex != 3)\n                    return;\n                int nextRowIndex = e.RowIndex + 1;\n                int lastRowIndex = datagridview.Rows.Count - 1;\n                if (nextRowIndex &lt;= lastRowIndex)\n                {\n                    var value = datagridview.Rows[e.RowIndex].Cells[3].Value.ToString();\n                    datagridview.Rows[nextRowIndex].Cells[2].Value = value;\n                }\n            }\n</code></pre>\n\n<p>MenuItem Clik to open new files to the Datagridview:</p>\n\n<pre><code>private void m_test1_Click_1(object sender, EventArgs e)\n    {\n        myconfig = Myconfig.DeserializeFromXmlFile(@\"test2.xml\");\n        Display(rseConfig);\n        m_ConfigPages.Visible = true;\n\n    }\n\n\n\nprivate void m_test2_Click(object sender, EventArgs e)\n  {\n        myconfig = Myconfig.DeserializeFromXmlFile(@\"test2.xml\");\n        Display(myconfig );\n        m_ConfigPages.Visible = true;\n\n    }\n</code></pre>\n\n<p>I'm using DataError Event Hnadler, but it's not working:</p>\n\n<pre><code>private void datagridview_DataError(object sender, DataGridViewDataErrorEventArgs e)\n        {\n            // Don't throw an exception when we're done.\n            e.ThrowException = false;\n\n            // Display an error message.\n            string txt = \"Error with \" +\n                datagridview.Columns[e.ColumnIndex].HeaderText +\n                \"\\n\\n\" + e.Exception.Message;\n            MessageBox.Show(txt, \"Error\",\n                MessageBoxButtons.OK, MessageBoxIcon.Error);\n\n            // If this is true, then the user is trapped in this cell.\n            e.Cancel = true;\n        }\n</code></pre>\n\n<p>Even, i have with row and col index : <code>datagridview.Rows[e.RowIndex].Cells[e.ColumnIndex].Value</code> still not working.</p>\n"},{"tags":["c#","winforms","visual-studio-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13107752,"title":"How to make a textbox disable but selectable","body":"<p>How to make a textbox disable but selectable in C# winform VS 2010?</p>\n"},{"tags":["c#","winforms","csv","line"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13107596,"title":"How to write at the next line in the next opening of the csv file?","body":"<p>At first run, my program, writes to a csv file in the first line,\nBut, when I'm running my program at the second.. third.. time, it runs over the first line..\nhow can i correct it?</p>\n\n<p>I would like to have a CSV file input of all the entering to my program.</p>\n\n<p>The code is as follows:</p>\n\n<pre><code>private void WriteToCsvFile()\n{\n    var us = users.ElementAt(0);\n    string names = \"Number',\";\n    string userAnswer = (us.userName + \",\");\n    foreach (string ss in user)\n    {\n        string str = Path.GetFileName(ss);\n        names = names + str + \",\";\n    }\n    foreach (string ans in us.answer)\n    {\n        userAnswer = userAnswer + ans + \",\";\n    }\n\n    using (StreamWriter sw = new StreamWriter(\"EntranceLog.csv\"))\n    {\n        sw.WriteLine(names);\n        sw.WriteLine(userAnswer);\n\n    }\n\n    this.Close();\n}\n</code></pre>\n"},{"tags":["c#","winforms","data-binding","propertygrid"],"answer_count":2,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":2292,"score":4,"question_id":1928567,"title":"Using a Dictionary in a propertygrid","body":"<p>I'd like to edit a list of key value(string, string) items using a propertygrid. When I use a <code>Dictionary&lt;string,string&gt;</code> as type the propertygrid will show a GUI, but it does not seem \"enabled\", ie. I can't add any items.</p>\n\n<p>Is the Dictionary object supported, or is there any other object with which I could solve this problem?</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13105837,"title":"C# and backspace detection in textbox in order to reload listbox","body":"<p>As part of this assignment for my class, in which I have a listbox which is connected to a database and it displays the first and last name of the students. I have also created a search feature in which the user types in the first and/or last name they are looking for in a textbox and when they press the \"search\" button it displays the filtered results appear in the listbox.</p>\n\n<p>The last part of the question asks me to detect when the user clears the textbox, to once again display the original data in the listbox. I have the data in a method called databaseload()and so it is really down to how to I get my program to detect that the listbox is once again empty.</p>\n\n<p>I found a couple of things online, and when I tried them, it didn't work.</p>\n\n<pre><code>private void searchTextBox_KeyPress(object sender, KeyPressEventArgs e){\n  if (e.KeyChar == 8)\n  {\n    databaseload();\n  }\n}\n</code></pre>\n\n<p>and I have also tried <em>KeyDown</em></p>\n\n<p>I also don't want it to reload when first backspace is detected. I want it to reload the listbox when the searchTextBox has nothing in it.</p>\n\n<p>Your help is greatly appreciated. </p>\n"},{"tags":[".net","winforms","data-binding","textbox"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":985,"score":3,"question_id":217912,"title":"Data-bound TextBox: can't exit","body":"<p>I've got a text box bound to an object's property (in fact several text boxes) on a form. This for is an editor for an object. When i'm editing some objects and modify values in the one of the text boxes i can't exit from the text box (neither by tab nor clicking on another text box). However that's not always the case - when editing other objects (of the same type) it works fine.</p>\n\n<p>Here's a code snipet:</p>\n\n<pre><code>txtValue.DataBindings.Add(\"Text\", _SourceObject, \"PlannedValue\", True, DataSourceUpdateMode.OnPropertyChanged, Nothing, \"c\")\ntxtEstPlacements.DataBindings.Add(\"Text\", _SourceObject, \"EstimatedPlacementCount\")\ntxtReference.DataBindings.Add(\"Text\", _SourceObject, \"Reference\")\n</code></pre>\n\n<p>Any suggestions?</p>\n"},{"tags":[".net","winforms","datagridview"],"answer_count":4,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":1392,"score":4,"question_id":373856,"title":"Capturing first character on entering edit mode - custom editing control in DataGridView","body":"<p>I'm hosting a custom editing control in a <code>DataGridView</code>, which for the record is a <code>TextBox</code> and <code>Button</code> together in a <code>UserControl</code>. I have inherited from <code>DataGridViewColumn</code> for the new column and <code>DataGridViewTextBoxCell</code> for the new cell.</p>\n\n<p>With a normal <code>DataGridViewTextBoxCell</code>, if you press a key when the cell has focus, it will begin edit mode <b>and</b> the character you typed will appear in the <code>TextBoxEditingControl</code>. However, in my inherited cell, no value is being passed down on keypress. (In fact, you have to manually pass the current cell value in <code>InitializeEditingControl</code> or nothing will show up at all.) So, the first character you type (the one that begins edit mode) is lost.</p>\n\n<p>I have tried <code>OnKeyPress</code>, <code>OnKeyDown</code>, and <code>OnKeyUp</code> in the <code>DataGridViewCell</code> but they never get called. <code>KeyEntersEditMode</code>, however, does seem to get called, and only when it is checking against a pressed key, so this might be a good place to start. The problem then becomes how to translate a KeyEventArgs to a <code>char</code>. This is trivial for alphabet and numbers, but since not all keyboards are created equal, handling other keys is messy and complicated at best. If there's a converter class that will do this automagically, please enlighten me.</p>\n\n<p>Has anyone else encountered this problem or found a good workaround?</p>\n\n<p>Note: This problem applies when <code>EditMode</code> is set to any variation of <code>EditOnKeystroke</code>. Setting to <code>EditOnEnter</code> is a valid workaround for my project, but I'd like to emulate the default behavior of the <code>TextBoxEditingControl</code> as well.</p>\n"},{"tags":["winforms","visual-studio-2008","c++-cli","designer"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":307,"score":2,"question_id":2333346,"title":"C++/CLI, Winforms: New form under sub-folder in VS2008","body":"<p>When I create a new form under a sub-folder in VS2008 in a C++/CLI Winforms project, the .h and .cpp are correctly created under the sub-folder. However, when the form is opened in the designer and the title is changed, I get an error message saying that the .resx (AWOL till this particular moment) is already part of the project. One can then locate the .resx in the root folder of the solution. How do I get around this? (...without having to file a bug with MS who aren't gonna take this too seriously since this is the VS2010 season)</p>\n\n<p>One option would be to create the form in the project's root folder and then move all three files (.cpp, .h and .resx) to the desired sub-folder once all changes have been made. In this case, I find that \"View Designer\" is no longer available once a form has been moved to a sub-folder.</p>\n\n<p>Save me. Please. I have done nothing to deserve this.</p>\n"},{"tags":["c#",".net","winforms","localization"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":61,"score":3,"question_id":13105744,"title":"How can I change all the form's text when I choose a language in combobox?","body":"<p>Like facebook when changing its language, it change all.. need help to rebuild my codes here. I have 3 forms and my combobox where I used to choose the language is in the 1st form. When I choose language in combobox in my 1st form, I want my other 2 forms will change its language also. </p>\n\n<pre><code>private void comboBox1_SelectedIndexChanged(object sender, EventArgs e)\n{\n    if (comboBox1.SelectedItem.ToString() == \"English\")\n    {\n        ChangeLanguage(\"en\");\n    }\n    else if (comboBox1.SelectedItem.ToString() == \"Spanish\")\n    {\n        ChangeLanguage(\"es-ES\");\n    }\n    else if (comboBox1.SelectedItem.ToString() == \"French\")\n    {\n        ChangeLanguage(\"fr-FR\");\n    }\n}\n\nprivate void ChangeLanguage(string lang)\n{\n    foreach (Control c in this.Controls)\n    {\n        ComponentResourceManager crm = new ComponentResourceManager(typeof(Form1));\n        crm.ApplyResources(c, c.Name, new CultureInfo(lang));\n    }\n}\n</code></pre>\n"},{"tags":["c#","winforms","arrays","settings"],"answer_count":8,"favorite_count":8,"up_vote_count":24,"down_vote_count":0,"view_count":12649,"score":24,"question_id":1766610,"title":"How to store int[] array in application Settings","body":"<p>I'm creating a simple windows Forms application using C# express 2008. I'm an experienced C++ developer, but I am pretty much brand new to C# and .NET.</p>\n\n<p>I'm currently storing some of my simple application settings using the settings designer and code like this: </p>\n\n<pre><code>// Store setting  \nProperties.Settings.Default.TargetLocation = txtLocation.Text;  \n...  \n// Restore setting  \ntxtLocation.Text = Properties.Settings.Default.TargetLocation;\n</code></pre>\n\n<p>Now I'd like to store either an array of ints ( <code>int[]</code> ), or possibly a List of ints ( <code>List&lt; int &gt;</code> ), as a setting. However, I can't figure out how to do this. I've searched the documentation, stackoverflow, and google, and I cannot find a decent explanation of how to do this.</p>\n\n<p>My hunch based on the sparse examples I've found is that I have to create a class that is serializable that wraps my array or List, and then I will be able to use that Type in the settings designer. However, I'm not sure exactly how to do this.</p>\n\n<p>Thanks in advance for your help!</p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5071,"score":0,"question_id":3910384,"title":"value of datagridview on textbox","body":"<p>i have a datagridview and a text box, when i click on a cell of datagridview, the value must copy on the text box, but this not always work </p>\n\n<p>olny works sometimes  please some help</p>\n\n<p>thnk.</p>\n\n<pre><code>private void gvProductos_CellContentClick(object sender, DataGridViewCellEventArgs e)\n{\n    //DataGridViewRow row = new DataGridViewRow();\n\n    //row = gvProductos.Rows[e.RowIndex];\n    ////txtDescripcion.Text = string.Empty;\n    //txtDescripcion.Text = row.Cells[1].Value.ToString();\n\n    txtDescripcion.Text = gvProductos.Rows[e.RowIndex].Cells[e.ColumnIndex].Value.ToString();\n}\n</code></pre>\n"},{"tags":["c#","winforms","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13080734,"title":"How to generate a Pivot Datagridview in WinForms and EntityFramework","body":"<p>I want to generate a Pivot Datagridview in WinForms and EntityFramework, starting from theses Entities:</p>\n\n<pre><code>public class Return\n{\n    public Return()\n    {\n        this.ReturnQty = new List&lt;ReturnQty&gt;();\n    }\n\n    public int Id { get; set; }\n    public Nullable&lt;System.DateTime&gt; Date { get; set; }\n    public Nullable&lt;int&gt; ReturnReason { get; set; }\n    public Nullable&lt;System.DateTime&gt; Belastungsdatum { get; set; }\n    public virtual ICollection&lt;ReturnQty&gt; ReturnQty  { get; set; }\n}\n\npublic class ReturnQty\n{\n    public int ID { get; set; }\n    public int Return_ID { get; set; }\n    public string ItemNo { get; set; }\n    public Nullable&lt;decimal&gt; Qty { get; set; }\n    public virtual Return Return { get; set; }\n}\n</code></pre>\n\n<p>The Pivot Dataviewgrid should look like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/C1BtW.jpg\" alt=\"enter image description here\"></p>\n\n<p>This is what I have now:</p>\n\n<pre><code>public static class ReturnReasons\n{\n\n    public static string a { get { return \"Grund nicht erfasst\"; } }\n    public static string a1 { get { return \"Artikel mangelhaft\"; } }\n    public static string a2 { get { return \"Bestellirrtum Kunde\"; } }\n    public static string a3 { get { return \"Doppelbestellung Kunde\"; } }\n    public static string a4 { get { return \"AV Kunde\"; } }\n    public static string a5 { get { return \"Kundenadresse falsch\"; } }\n    public static string a6 { get { return \"Kunde nicht erreichbar\"; } }\n    public static string a7 { get { return \"Kundenstorno\"; } }\n    public static string a8 { get { return \"Nichtgefallen\"; } }\n    public static string a9 { get { return \"Transportschaden UPS/DHL/GLS\"; } }\n    public static string a10 { get { return \"Transportschaden Spedition\"; } }\n    public static string a11 { get { return \"Transportschaden verdeckt\"; } }\n    public static string a12 { get { return \"Kommissionierungsfehler\"; } }\n    public static string a13 { get { return \"Fehler Auftragserfasung\"; } }\n    public static string a14 { get { return \"Lieferverzögerung\"; } }\n    public static string a15 { get { return \"Warenrücksendung lt. Vereinbarung\"; } }\n    public static string a16 { get { return \"ohne Grund/sonstiges\"; } }\n}\n\n        public class RetourenPivot\n    {\n        public string Item{ get; set; }\n        public IEnumerable&lt;int?&gt; ReturnReason{ get; set; }\n        public IEnumerable&lt;decimal?&gt; Qty{ get; set; }\n    }\n\n        private void DG_databind()\n    {\n        var query = _data.RepositoryRetouren.GetAll&lt;ReturnQty&gt;();\n        // A Linq to EF which creates a List of concreate class called RetourenPivot.\n        var queryResults = (from iso in query\n                            orderby iso.ItemNo ascending\n                            group iso by iso.ItemNo into isoGroup\n                            select new RetourenPivot()\n                            {\n                                Item = isoGroup.Key,\n                                ReturnReason = isoGroup.Select(y =&gt; y.Return.ReturnReason),\n                                Qty = isoGroup.Select(v =&gt; v.Qty)\n                            }).ToList();\n\n\n        // Call a function to create a dynamically created data table with the needed columns\n\n        // Create a DataTable as a DataSource for the grid\n        DataTable dt = new DataTable();\n        // Create the DataColumns for the data table\n        DataColumn dc = new DataColumn(\"Artikel\", typeof(string));\n        dt.Columns.Add(dc);\n\n        // Get a list of Distinct Reasons\n        var ReasonLabel = (from yList in queryResults.Select(Reason =&gt; Reason.ReturnReason)\n                           from Reason in yList\n                           select Reason.ToString()).Distinct().ToList();\n\n        // Create the DataColumns for the table\n        ReasonLabel.ForEach(delegate(string Reason)\n        {\n            var reasonTexts = typeof(ReturnReasons).GetProperties().Where(p =&gt; p.Name == \"a\" + Reason).ToList()[0].GetValue(null, null).ToString();\n            dc = new DataColumn(reasonTexts, typeof(string));\n            dt.Columns.Add(dc);\n        });\n\n        // Populate the rowa of the DataTable\n        foreach (RetourenPivot rec in queryResults)\n        {\n            // The first two columns of the row always has a ISO Code and Description\n            DataRow dr = dt.NewRow();\n            dr[0] = rec.Item;\n\n            // For each record\n            var Reason = rec.ReturnReason.ToList();\n            var Qty = rec.Qty.ToList();\n\n            // Because each row may have different reasons I am indexing\n            // the with the string name\n            for (int i = 0; i &lt; Qty.Count; i++)\n            {\n                var reasonTexts = typeof(ReturnReasons).GetProperties().Where(p =&gt; p.Name == \"a\" + Reason[i].ToString()).ToList()[0].GetValue(null, null).ToString();\n                dr[reasonTexts] = Qty[i].Value;\n            }\n\n            // Add the DataRow to the DataTable\n            dt.Rows.Add(dr);\n        }\n\n        // Bind the DataTable to the DataGridView\n        dataGridViewSummary1.ColumnHeadersHeightSizeMode = DataGridViewColumnHeadersHeightSizeMode.EnableResizing;\n        dataGridViewSummary1.ColumnHeadersHeight = 200;\n\n        //Connect Grid with DataSource\n        //this.dataGridViewSummary1.AutoGenerateColumns = true;\n        this.dataGridViewSummary1.DataSource = dt;\n    }\n</code></pre>\n\n<p>The problem is, that each RetourenPivot in queryResults might have several quantities with the same ReturnReason and I don’t know how to sum them up.\nE.g. now it looks like</p>\n\n<p>Item 123\nReturnReason {0, 0, 0, 0, 1, 16}\nQty {1, 1, 2, 1, 5, 1}</p>\n\n<p>What means, that for the reason 0 there are 4 quantities. It should look like</p>\n\n<p>Item 123\nReturnReason { 0, 1, 16}\nQty {5, 5, 1}</p>\n"},{"tags":[".net","winforms","data-binding","windows-7","combobox"],"answer_count":4,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":3863,"score":6,"question_id":2001361,"title":"ComboBox.SelectedValue does not match displayed text when DropDownStyle = DropDownList in Windows 7","body":"<p>Let's say we have the following code in a Windows application:</p>\n\n<pre><code>ComboBox comboBox = new ComboBox()\n{\n    AutoCompleteMode = AutoCompleteMode.SuggestAppend,\n    AutoCompleteSource = AutoCompleteSource.ListItems,\n    DataSource = new string[] { \"\", \"Ark\", \"Boat\", \"Bucket\" },\n    DropDownStyle = ComboBoxStyle.DropDownList\n};\nthis.Controls.Add(comboBox);\n\nTextBox textBox = new TextBox()\n{\n    Left = comboBox.Right,\n    Top = comboBox.Top,\n    ReadOnly = true\n};\ntextBox.DataBindings.Add(\"Text\", comboBox, \"SelectedValue\");\nthis.Controls.Add(textBox);\n</code></pre>\n\n<p>No magic here, just a <code>ComboBox</code> bound to a list of strings.  The <code>TextBox</code> displays the <code>SelectedValue</code> of the <code>ComboBox</code>.</p>\n\n<p>I'm getting unexpected behavior when I type \"Bucket\" into the <code>ComboBox</code> and tab away.  For some reason the <code>ComboBox</code> displays \"Boat\" but the <code>TextBox</code> displays \"Bucket\".  I would expect them both to display \"Bucket\".</p>\n\n<p>It behaves as expected if I change the <code>DropDownStyle</code> to <code>DropDown</code>, but I don't want users to be able to type anything they want.  They should only be able to type items that are in the list.</p>\n\n<p>Even more interesting is that, after typing \"Bucket\" and tabbing away, if I type \"Bucket\" again it will display \"Bucket\" in both.  If I make a third attempt, it goes back to \"Boat\" for the <code>ComboBox</code> and \"Bucket\" for the `TextBox'.  So it seems like it's cycling through all the B's.</p>\n\n<p>I didn't notice this until I upgraded from XP to Windows 7 recently.  I don't see how that could have anything to do with this, but I'm throwing it out anyway.</p>\n\n<p>If this behavior is correct, can anyone tell me what I should be doing to achieve my expected behavior?</p>\n\n<p><strong>UPDATE</strong>  It would seem this <em>is</em> related to Windows 7.  Everything behaves as expected in Windows XP Mode.  Can anyone else running Windows 7 try my code and verify that I'm not crazy?</p>\n"},{"tags":["c#","winforms","listview"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":887,"score":0,"question_id":7871112,"title":"InvalidArgument=Value of '6' is not valid for index. Parameter name: index","body":"<p>I created a Listview control with 8 columns. When I need to retrieve text from subitem of Item, I use the following code:</p>\n\n<pre><code>foreach (ListViewItem item in listViewStatus.Items)\n            {\n                if (item.Tag == f)\n                {\n                    /* Use locking to synchronise across mutilple thread calls. */\n                    lock (_lockObject)\n                    {\n                        item.SubItems[6].Text = Status;\n                    }\n                    break;\n                }\n            }\n</code></pre>\n\n<p>it shows an exception. But when I replace item.SubItems[6].Text with item.SubItems[5].Text  it works. How can I fix this?</p>\n"},{"tags":["c#","winforms","application","icons","contextmenu"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":929,"score":0,"question_id":6555691,"title":"how to add icon to context menu in c# windows form application","body":"<p>I am having a tree view in which if i right click any node context menu is displayed,Now i want to add icons corresponding to items in the context menu.</p>\n"},{"tags":["c#","winforms","textbox","line"],"answer_count":3,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":5032,"score":7,"question_id":739656,"title":"How can I scroll to a specified line in a WinForms TextBox using C#?","body":"<p>How can I scroll to a specified line in a WinForms TextBox using C#?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","winforms","forms"],"answer_count":11,"favorite_count":3,"up_vote_count":8,"down_vote_count":0,"view_count":24739,"score":8,"question_id":4759334,"title":"How can I close a login form and show the main form without my application closing?","body":"<p>I have two forms in my project (Login and Main).</p>\n\n<p>What I'm trying to accoomplish is, if the login is successful, I must show the Main form and close the Login form.</p>\n\n<p>I have this method in Login form that closes the Login form when the login is successful. But the Main form doesn't show.</p>\n\n<pre><code>public void ShowMain()\n{\n    if(auth()) // a method that returns true when the user exists.\n    {             \n        var main = new Main();\n        main.Show();\n        this.Close();\n    }\n    else\n    {\n        MessageBox.Show(\"Invalid login details.\");\n    }         \n}\n</code></pre>\n\n<p>I tried hiding the Login form if the login process is successful. But it bothers me because I know while my program is running the login form is still there too, it should be closed right? </p>\n\n<p>What should be the right approach for this?\nThanks...</p>\n"},{"tags":["c#","winforms","listview"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":730,"score":2,"question_id":5415877,"title":"How to use Virtual mode in ListView?","body":"<p>i'm using <code>VirtualMode</code> to fill the columns like </p>\n\n<pre><code>List&lt;ListViewItem&gt; m_lstItem;\n\n\n    private void Form1_Load(object sender, EventArgs e)\n    {\n        m_lstItem = Enumerable.Range(0, 100000).Select(X =&gt; new ListViewItem(new String[] { X.ToString(), (X + 1).ToString() })).ToList();\n        listView1.VirtualListSize = m_lstItem.Count;\n    }\n\n    private void listView1_RetrieveVirtualItem(object sender, RetrieveVirtualItemEventArgs e)\n    {\n        e.Item = m_lstItem[e.ItemIndex];\n    }\n</code></pre>\n\n<p>but i can not access the selected item. while accessing the selected item its throwing an error like  <code>Cannot access the selected items collection when the ListView is in virtual mode.</code></p>\n\n<p>How do i get the selected items from the <code>listView</code> when it is in <code>VirtualMode</code></p>\n\n<p>Please help me to do this.</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13104797,"title":"Double c# value changes to 0.0 in windows forms","body":"<p>my application is Windows Forms (VS2010 C#); I set a double variable at the beginning of the form as:</p>\n\n<pre><code>private double Wwidth;\n</code></pre>\n\n<p>Then I change the its value when I open a file:</p>\n\n<pre><code> Wwidth = image.WindowWidth;\n</code></pre>\n\n<p>The value of Wwdith equals <code>265.0</code>.  When I select a trackbar, </p>\n\n<pre><code>private void tbrWidth_Scroll(object sender, System.EventArgs e)\n        {\n            double newWidth = tbrWidth.Value;\n            double wd = Wwidth - newWidth;\n...}\n</code></pre>\n\n<p>the value of Wwdith changes to <code>0.0</code>?</p>\n\n<p>Any suggestions. Thanks in advance.</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":733,"score":2,"question_id":5797722,"title":"Process does not close after closing the form","body":"<p>I have a first form that calls another one and then disappears (frm.visible = false).\nThis form should not come back after being called once, but it's the main form (the first one that appears when you launch the program). I am trying to make it so when you close the second form, both forms close, I have tried multiple things but all of them leave the process active.</p>\n\n<p>This is the code that I use :</p>\n\n<pre><code>private void frmCreation_FormClosing(object sender, FormClosingEventArgs e)\n        {\n            frmProperties frm = new frmProperties();\n            frm.Dispose();\n        }\n        //I have also tried frm.Close() which also does not work\n</code></pre>\n\n<p>This code close the two forms, but the process remains active. How do I counter this?</p>\n"},{"tags":[".net","winforms","mvc","mvp"],"answer_count":8,"favorite_count":80,"up_vote_count":59,"down_vote_count":0,"view_count":20953,"score":59,"question_id":654722,"title":"Implementing MVC with Windows Forms","body":"<p>Where can I find a good example on how to completely implement the MVC pattern in Windows Forms. I found many tutorials and code examples on various sites (e.g. CodeProject, .NetHeaven) but many are more representative for the observer pattern than MVC. Since the application I want to develop is for a school project, I am reluctant to using frameworks like <a href=\"http://trac.puremvc.org/PureMVC_CSharp\" rel=\"nofollow\">PureMVC</a> or <a href=\"http://www.mvcsharp.org/\" rel=\"nofollow\">MVC#</a>.</p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":7,"favorite_count":9,"up_vote_count":23,"down_vote_count":0,"view_count":18959,"score":23,"question_id":1025670,"title":"How do you automatically resize columns in a DataGridView control AND allow the user to resize the columns on that same grid","body":"<p>I am populating a DataGridView control on a Windows Form (C# 2.0 not WPF).</p>\n\n<p>My goal is to display a grid that neatly fills all available width with cells - i.e. no unused (dark grey) areas down the right and sizes each column appropriately according to the data it contains, <b>but</b> also allows the user to resize any of the columns to their liking.</p>\n\n<p>I am attempting to achieve this by setting the AutoSizeMode of each column to be <strong>DataGridViewAutoSizeColumnMode.AllCells</strong> except for one of the columns which I set to <strong>DataGridViewAutoSizeColumnMode.Fill</strong> in order to ensure the entire area of the grid is neatly filled with data. (I don't mind that when the user attempt to resize this column it springs back to a size that ensures the horizontal space is always used.)</p>\n\n<p>However, as I mentioned, once loaded I would like to allow the user to resize the columns to suit their own requirements - in setting these AutoSizeMode values for each column it appears the user is then unable to then resize those columns.</p>\n\n<p>I've tried not setting the AutoSizeMode of all the columns which does allow resizing BUT doesn't set the initial size according to the data the cells contain. The same result occurs when changing the grid's AutoSizeMode back to \"Not Set\" after loading the data.</p>\n\n<p>Is there a setting I'm missing here which allows automatic setting of default column widths AND user resizing or is there another technique I must use when populating the DataGridView control?</p>\n"},{"tags":["c#",".net","winforms","richtextbox"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":415,"score":1,"question_id":7512968,"title":"remove back color from multiple positions in richTextBox","body":"<p>I have a rich text box and I've implemented a search option for it. When the user searches a string, all the matches gets highlighted with yellow background. I want that when the user presses the search button again, all of the previous highlights will be removed before the new search begins.</p>\n\n<p>I found out two ways to do it:\n1. select all text and then choose the back color to be the default one.\n2. remove all text from the text box and then put it back again.</p>\n\n<p>Both ways work, but it doesn't look natural when I use them.\nSo, is there another way that I can remove all highlights from the text?</p>\n\n<p>I'm using .NET framework 4 and I write in C#.</p>\n"},{"tags":["c#","winforms","video","directx","audiovideoplayback"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1130,"score":0,"question_id":5549084,"title":"c# using Microsoft.DirectX.AudioVideoPlayback how to play next video after one is finished","body":"<p>i am able to put a video in my windows form.</p>\n\n<p>my question is how do i make it when it finishes playing the video,it starts to play another video? meaning like in a sequence. after it finishes, play another video.</p>\n\n<p>so far i have manage to play a video and it just loops the video.</p>\n\n<p>any ideas?</p>\n\n<p>this is my code so far:</p>\n\n<pre><code>public partial class Form1 : Form\n{\n     Video video;\n\n\n\n    public Form1()\n    {\n        InitializeComponent();          \n        Initializevid1();\n\n    }\n\n    public void Initializevid1()\n    {\n\n           // store the original size of the panel\n            int width = viewport.Width;\n            int height = viewport.Height;\n\n            // load the selected video file\n            video = new Video(\"C:\\\\Users\\\\Dave\\\\Desktop\\\\WaterDay1.wmv\");\n\n            // set the panel as the video object’s owner\n            video.Owner = viewport;\n\n            // stop the video\n            video.Play();\n            video.Ending +=new EventHandler(BackLoop);\n\n            // resize the video to the size original size of the panel\n            viewport.Size = new Size(width, height);   \n\n    }\n\n    private void BackLoop(object sender, EventArgs e)\n    {\n\n        //video.CurrentPosition = 0;\n    }\n</code></pre>\n"},{"tags":["c#","winforms","forms"],"answer_count":4,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":14829,"score":7,"question_id":1130208,"title":"Disable parent form when child form is active","body":"<p>How to disable a parent form when child form is active in c# ?</p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":4084,"score":1,"question_id":6128555,"title":"Set DataGridView cell value and add a new row","body":"<p>I have a DataGridView with two columns. When  a cell in the first column is clicked, an OpenFileDialog is shown and when I select a file, the cell in the second column value is set to the selected file name. Here is the code:</p>\n\n<pre><code>private void dataGridView1_CellContentClick(\n    object sender, DataGridViewCellEventArgs e)\n{\n    if (e.ColumnIndex == 0)\n    {\n        SelectFile(e.RowIndex);\n    }\n}\n\nprivate void SelectFile(int rowIndex)\n{\n    if (openFileDialog.ShowDialog() == DialogResult.OK)\n    {\n        dataGridView1.Rows[rowIndex].Cells[1].Value =\n            openFileDialog.FileName;\n    }\n}\n</code></pre>\n\n<p>This works, but I would like a new row to be added when the cell value is set. This happens when I edit the cell manually, the row gets in 'edit' state and a new row is added below. I would like the same to happen when I set the cell value programmatically.</p>\n\n<p>[edit]</p>\n\n<p>When my form is first shown the DataGridView is empty and the only row is shown is the one with (* sign - IsNewRow is true). When I manually edit a cell in that row it goes into edit state (pencil sign) and a new empty row is added. This doesn't happen when I use the above code. The row remains as IsNewRow (* sign) and a new row is not added.</p>\n\n<p><img src=\"http://i.stack.imgur.com/CByF4.png\" alt=\"enter image description here\">\n<img src=\"http://i.stack.imgur.com/kxlQw.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","xml","winforms","datagridview","generic-list"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":12992153,"title":"Get generic collection values from DataGridView to Xml file","body":"<p>In my xml file,it has many elements and many child/sub child elements are there so i have decided to load as generic list and display in the DGView and the columns are already created/customed in DGview.</p>\n\n<p>I have to edit the values in the datagridview and serialize back to the file. I would like to know, \nhow can i get the values from the datagrid view and serialize back to the file. </p>\n\n<p>I tried using this, <code>Dataset ds = new Dataset();ds = (Dataset) (dataGridView2.Datasource);ds.WriteXml(\"XML_File.xml\");</code> i got a error message, nullRefExceptionError.\nAs I know the DataSet ds is null, thats why I'm getting this error.</p>\n\n<p>I don't want to use the dataset for binding.I want to bind the xml file directly to the datagridview. IS it possible with my approach???</p>\n\n<p>This approach is good but it's not saving the xml file as like  the original xml file:</p>\n\n<pre><code> DataTable dt = new DataTable(\"Rules\");\n\n        for (int i = 0; i &lt; dataGridView4.ColumnCount; i++)\n        {\n            dt.Columns.Add(dataGridView4.Columns[i].Name, typeof(System.String));\n        }\n\n        DataRow myrow;\n        int icols = dataGridView4.Columns.Count;\n        foreach (DataGridViewRow drow in this.dataGridView4.Rows)\n        {\n            myrow = dt.NewRow();\n            for (int i = 0; i &lt;= icols - 1; i++)\n            {\n\n                myrow[i] = drow.Cells[i].Value;\n            }\n            dt.Rows.Add(myrow);\n        } \n\n        dt.WriteXml(@\"C:\\test\\items.xml\");\n</code></pre>\n\n<p>Any help for me to serilaize/write the values from datagridview.</p>\n"},{"tags":["c#","winforms",".net-4.0","attributes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13103158,"title":"Custom Attribute to determine if method can process","body":"<p>I'm trying to find out if it's possible to setup a Custom Attribute to determine if a method call can process.  What I'm wanting is similar to the <code>[Authorize()]</code> attribute that I use in my MVC3 application.</p>\n\n<p>Basically, I have a COM Object that I'm interfacing (3rd Party DMS Software) with and I want to make sure that the user hasn't closed the program before I process the contents of the method.  I can wrap the calls in a <code>try/catch</code> or I can wrap a method that checks the <code>application.running</code>, but I like the attribute functionality and the simple markup (if it's required).</p>\n\n<p>All the tutorials/documentation that I've found so far is how to markup a method/class with properties (they generally use a string in the tutorials) and then access those string values later in code.</p>\n\n<hr>\n\n<p>This is just not something that I'm wanting to do if at all possible.  Again, in MVC3/4 you can do...</p>\n\n<pre><code>[Authorize()]\npublic class ControllerClass : Controller {\n   public ActionResult Index(){ return View(); }\n   ....etc....\n}\n</code></pre>\n\n<p>In this example Index always has to be be called by someone that passes <code>Authorize</code>.  What I'm not sure is if this is required to instantiate the class or call the method.</p>\n\n<p>So after all of that my question is simply.  Can something similar to <code>Authorize()</code> be implemented for a C# WinForms Library?</p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13101951,"title":"Copy a datagridview cell value to another cell in the same datagridview automatically","body":"<p>In my datagridview, i got 4 columns, when the user gives some value to the first row then I want to take the <code>1st row 4th cell value and put it to the 2nd Row 3rd cell</code>like that I have to apply for all the rows(Please see the image ). In some case I'll have only 2 rows and the max i'll have 4 rows.</p>\n\n<p>The below method it works, but when i tested with 2 or 3 rows it doesn't work..obviously 3rd and 4th is doesn't exist.</p>\n\n<p>What should i do?? Is there a better way of doing this?? </p>\n\n<p>Here i coded for the max 4 rows.</p>\n\n<pre><code>private void dataGridView1_CellLeave(object sender, DataGridViewCellEventArgs e)\n        {\n             var value1 = dataGridView1.Rows[0].Cells[3].Value.ToString();\n            dataGridView1.Rows[1].Cells[2].Value = value1;\n\n            var value2 = dataGridView1.Rows[1].Cells[3].Value.ToString();\n            dataGridView1.Rows[2].Cells[2].Value = value2;\n\n            var value3 = dataGridView1.Rows[2].Cells[3].Value.ToString();\n            dataGridView1.Rows[3].Cells[2].Value = value3;\n        }\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/HhcQK.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","wpf","vb.net","winforms"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":49,"score":-1,"question_id":13102372,"title":"Creating Form Designer with HTML Possible?","body":"<p>I was wondering whether something like creating a design for a form through html codes exist in C#/VB.net/.NET Framework for applications (executables) only.</p>\n\n<p>I am aware of WPF but thats just too difficult and html is relatively easy.</p>\n\n<p>Any approach to do this so that the events can be attached (only basic one like click event of button) and setting properties of the html elements.</p>\n"},{"tags":["c#","winforms",".net-4.0"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":293,"score":0,"question_id":9717816,"title":"Optimised Retrieval of the Checked RadioButton in Relevent GroupBox","body":"<p>All, I have a <code>GroupBox</code> with multiple controls (<code>Button</code>s, <code>RadioButton</code>s etc.) and I want to know the most efficent way of establishing which <code>RadioButton</code> in the <code>GroupBox</code> is in the checked state. I currently have</p>\n\n<pre><code>int nCheckedRadioIdx = 0;\nforeach (Control ctrl in groupBoxList.Controls)\n{\n    if (ctrl.GetType() == typeof(RadioButton))\n    {\n        if (((RadioButton)ctrl).Checked)\n        {\n            switch (((RadioButton)ctrl).Name)\n            { \n                case \"radioButtonGoodCodeSumm\":\n                    nCheckedRadioIdx = 0;\n                    break;\n                case \"radioButtonBadCodeSumm\":\n                    nCheckedRadioIdx = 1;\n                    break;\n                case \"radioButtonBadByEpiNo\":\n                    nCheckedRadioIdx = 2;\n                    break;\n                case \"radioButtonValidCodes\":\n                    nCheckedRadioIdx = 3;\n                    break;\n                default:\n                    break;\n            }\n            break;\n        }\n    }\n}\n</code></pre>\n\n<p>I then use an enumerator to establish which button I need. This seems very verbose to me (in fact damn ugly!). I have seen this done in VB with some sort of LINQ query <a href=\"http://stackoverflow.com/questions/6466952/how-to-get-a-checked-radio-button-in-a-groupbox\">(SO Question)</a> but I have never worked with VB or LINQ and am struggling with the conversion. If there is an even better way that would be great as one of the <code>GroupBox</code>s contains a significant number of <code>RadioButton</code>s - I would like to use LINQ for this if possible?</p>\n"},{"tags":["c#","wpf","winforms","c#-4.0","user-interface"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":80,"score":1,"question_id":13098766,"title":"Creating a Console like UI in Windows Forms","body":"<p>Hi I'm trying to create a console like interface using a richtextbox in WinForms using C#.</p>\n\n<p>The reason why I am using a richtextbox is I want a few features such as selection,copy-paste that are not present in a normal console application.</p>\n\n<p>I was wondering if it was possible to change the blinking cursor from the blinking \"|\" to a blinking \"_\"</p>\n\n<p>Even if I could hide the original \"|\", I could then implement a functionality on the onchange event of the richtextbox to display the blinking, \"_\"</p>\n\n<p>I also had another related question, but I don't know if I should put that here as well.</p>\n\n<p>Also, if it will be easier to implement something like this using WPF, I'm willing to move.</p>\n"},{"tags":["c#",".net","winforms","crash"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13100011,"title":"Toolstrip crash","body":"<p>I have received from user that my application has crashed and that he saw this in event viewer:</p>\n\n<pre><code>Framework Version: v4.0.30319    \nDescription: The process was terminated due to an unhandled exception.\n    Exception Info: System.AccessViolationException\n    Stack:\n       at System.Drawing.SafeNativeMethods+Gdip.GdipDrawRectangleI(System.Runtime.InteropServices.HandleRef, System.Runtime.InteropServices.HandleRef, Int32, Int32, Int32, Int32)\n       at System.Drawing.Graphics.DrawRectangle(System.Drawing.Pen, Int32, Int32, Int32, Int32)\n       at System.Windows.Forms.ToolStripTextBox+ToolStripTextBoxControl.WmNCPaint(System.Windows.Forms.Message ByRef)\n       at System.Windows.Forms.ToolStripTextBox+ToolStripTextBoxControl.WndProc(System.Windows.Forms.Message ByRef)\n       at System.Windows.Forms.Control+ControlNativeWindow.OnMessage(System.Windows.Forms.Message ByRef)\n       at System.Windows.Forms.Control+ControlNativeWindow.WndProc(System.Windows.Forms.Message ByRef)\n       at System.Windows.Forms.NativeWindow.Callback(IntPtr, Int32, IntPtr, IntPtr)\n       at System.Windows.Forms.UnsafeNativeMethods.CallWindowProc(IntPtr, IntPtr, Int32, IntPtr, IntPtr)\n       at System.Windows.Forms.NativeWindow.DefWndProc(System.Windows.Forms.Message ByRef)\n       at System.Windows.Forms.Form.DefWndProc(System.Windows.Forms.Message ByRef)\n       at System.Windows.Forms.Control.WndProc(System.Windows.Forms.Message ByRef)\n       at System.Windows.Forms.ScrollableControl.WndProc(System.Windows.Forms.Message ByRef)\n       at System.Windows.Forms.Form.WndProc(System.Windows.Forms.Message ByRef)\n       at DeskandArchive.MainWindow.WndProc(System.Windows.Forms.Message ByRef)\n       at System.Windows.Forms.Control+ControlNativeWindow.OnMessage(System.Windows.Forms.Message ByRef)\n       at System.Windows.Forms.Control+ControlNativeWindow.WndProc(System.Windows.Forms.Message ByRef)\n       at System.Windows.Forms.NativeWindow.Callback(IntPtr, Int32, IntPtr, IntPtr)\n       at System.Windows.Forms.UnsafeNativeMethods.PeekMessage(MSG ByRef, System.Runtime.InteropServices.HandleRef, Int32, Int32, Int32)\n       at System.Windows.Forms.Application+ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(IntPtr, Int32, Int32)\n       at System.Windows.Forms.Application+ThreadContext.RunMessageLoopInner(Int32, System.Windows.Forms.ApplicationContext)\n       at System.Windows.Forms.Application+ThreadContext.RunMessageLoop(Int32, System.Windows.Forms.ApplicationContext)\n       at System.Windows.Forms.Application.Run(System.Windows.Forms.Form)\n       at A.cc1462b28845fccfe3634174d36bc619a.ce1b648a1c328cbefe2529fb98bf21b8c()\n</code></pre>\n\n<p>As far as I have searched through the internet, and as I can read from this, also including the fact that if my code crashes it should show dialog to report bug which user did not see, I came to conclusion that this is a bug in .NET framework in drawing of Toolstrip.</p>\n\n<p>Am I right on this? Is there some way that this can be fixed? I have read suggestions to reinstall .NET framework, but most people reported that it didn't help?</p>\n"},{"tags":[".net","winforms","drag-and-drop"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13099992,"title":"A Generic Drag and Drop Handler for .net WinForms","body":"<p>I have an application that I inherited and would like to improve. One area that I can cut a lot of code is <code>Drag and Drop</code> handling. In that, the application handles drag and drop of same type of objects but the code for it repeated over (with slight variations) and a lot of event wiring code. What I want to achieve is the following:</p>\n\n<ol>\n<li>The component (a <code>UserControl</code>) must have a way to declare (within the form) types of items  it supports dragging and/or dropping</li>\n<li>The component must have a way to broadcast that it accepted a dragged item</li>\n<li>Once the dragging starts, all the items (that can accept the item being dragged) should be notified that they dragging has started</li>\n<li>The dragging could be started from a contained control (of the <code>UserControl</code>)</li>\n</ol>\n\n<p>That way I can handle both moving and copying of objects within a common class and without decorating the host form with the same boilerplate code.</p>\n\n<p>Is that possible to achieve in <code>WinForms</code>? Any code that already exists for that?</p>\n"},{"tags":["winforms","keyeventargs"],"answer_count":3,"favorite_count":0,"up_vote_count":9,"down_vote_count":0,"view_count":1265,"score":9,"question_id":225711,"title":"Stop the Bell on CTRL-A (WinForms)","body":"<p>Any ideas how to stop the system bell from sounding when CTRL-A is used to select text in a Winforms application?</p>\n\n<p>Here's the problem. Create a Winforms project. Place a text box on the form and add the following event handler on the form to allow CTRL-A to select all the text in the textbox (no matter which control has the focus).</p>\n\n<pre><code>void Form1_KeyDown(object sender, KeyEventArgs e)\n{\n    if (e.KeyCode == Keys.A &amp;&amp; e.Modifiers == Keys.Control)\n    {\n        System.Diagnostics.Debug.WriteLine(\"Control and A were pressed.\");\n        txtContent.SelectionStart = 0;\n        txtContent.SelectionLength = txtContent.Text.Length;\n        txtContent.Focus();\n        e.Handled = true;\n    }\n}\n</code></pre>\n\n<p>It works, but despite e.Handled = true, the system bell will sound every time CTRL-A is pressed.</p>\n\n<hr>\n\n<p>Thanks for the reply. </p>\n\n<p>KeyPreview on the Form is set to true - but that doesn't stop the system bell from sounding - which is the problem I'm trying to solve - annoying.</p>\n"},{"tags":["c#","winforms","multithreading"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":118,"score":1,"question_id":4448116,"title":"Out of proc COM sluggishness","body":"<p>I'm presently working on a side-by-side application (C#, WinForms) that injects messages into an application via COM. </p>\n\n<p>This application uses multiple foreach statements, polling entity metrics from the application that accepts COM. A ListBox is used to list each entity, and when a user selects one from this list, a thread is created and executed, calling a method that retrieves the required data.</p>\n\n<p>When a user selects a different entity from the list, the running thread is aborted and a new thread is created for the newly selected entity.</p>\n\n<p>I've spent a day looking into my threading and memory usage, and have come to a conclusion that everything is fine. Never is there more than 6 threads running concurrently (all unique for executing different members), and via the Windows task manager, my application never peaks >10 CPU%, 29M MEM.</p>\n"},{"tags":["c#","winforms","visual-studio-2010","objectlistview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13098475,"title":"Extra line in objectlistview","body":"<p>Hi I am using the  <a href=\"http://objectlistview.sourceforge.net/cs/index.html\" rel=\"nofollow\">objectlistview</a>, and use the following code the add rows</p>\n\n<pre><code>lvServiceClassInfo.AutoResizeColumns(ColumnHeaderAutoResizeStyle.HeaderSize);\n            List&lt;CPerson&gt; list = new List&lt;CPerson&gt;();\n            list.Add(new CPerson() { name = \"a\", wsdl = \"abc\" });\n            list.Add(new CPerson() { name = \"b\", wsdl = \"abc\" });\n            list.Add(new CPerson() { name = \"c\", wsdl = \"abc\" });\n            lvServiceClassInfo.AddObjects(list);\n</code></pre>\n\n<p>but I have extra line between each row(the line with \"a\", with a horizontal bar across), how to get rid of it?\n<img src=\"http://i.stack.imgur.com/KZShM.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","winforms",".net-4.0","clickonce"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13097820,"title":"Using ClickOnce getting two instances of the program after update","body":"<p>I've started getting <code>ClickOnce</code> setup and using the code below after calling <code>Application.Restart();</code> I end up with two instances of the application (the newly updated one and the previous version).</p>\n\n<pre><code>    private static void CheckForUpdate() {\n            ApplicationDeployment updateCheck = ApplicationDeployment.CurrentDeployment;\n            UpdateCheckInfo info = updateCheck.CheckForDetailedUpdate();\n            if(info.UpdateAvailable) {\n                updateCheck.Update();\n                MessageBox.Show( \"The application has been upgraded, and will now restart.\" );\n                Application.Restart();\n            }\n    }//this has try/catch but didn't think it would be relevant \n     //since no exception is being thrown\n</code></pre>\n\n<p>This is my first time using click once and while I'm amazed at the simplicity of it I wasn't quite sure WHERE to put the manual check (I don't want the users to have a choice or see the ugly update window).</p>\n\n<p>I've placed it both in my <code>MainForm.cs</code> and my <code>Program.cs</code> with the same results for both.  I'm including my <code>Main()</code> just in case it's relevant.</p>\n\n<pre><code>[STAThread]\nstatic void Main() {\n    CheckForUpdate();\n    Application.EnableVisualStyles();\n    Application.SetCompatibleTextRenderingDefault( false );\n    Application.Run( new MainForm() );\n}\n</code></pre>\n"},{"tags":["c#","winforms","datagridview","filter"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":416,"score":0,"question_id":11390099,"title":"DataGridView Filter not working","body":"<p>I know there are a good few threads on this topic but i have tried everything and still no luck filtering my datagridview. I am trying to filter the rows of a datagridview based on the value a user inputs in a text field. The datagridviews datasource is set du the datasource provided below.</p>\n\n<p>So here is the code i am using. i get no errors, the datagridview simply does not change.\nManufacturerService.GettAll returns a List of Manufacturer, i convert it to a bindinglist to </p>\n\n<p><code>bsManufacturers.DataSource = new BindingList&lt;Manufacturer&gt;(ManufacturerService.GetAll(_ctx));</code></p>\n\n<p>On the textchanged event of the textbox this code runs. i have checked with breakpoints and so on. the code is executed ant the filter string is correct.</p>\n\n<pre><code>private void FilterData(string str)\n{\n    bsManufacturers.Filter = string.Format(\"Name like '%{0}%'\", str);\n    dgvManufacturers.Refresh();\n}\n</code></pre>\n\n<p>Any help? or atleast an explanation of why this does not work? I have been working on this for a good few hours and just cant seem to find an anwser anywhere </p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":3799,"score":4,"question_id":1923953,"title":"Could not find any resources appropriate for the specified culture (C# WinForm Images in Resource File)","body":"<p>I added three images to a file called Resource1.resx.  I also added one string just for test purposes. I'm getting this error on either the GetString or the GetObject(image-name). </p>\n\n<blockquote>\n  <p>{\"Could not find any resources\n  appropriate for the specified culture\n  or the neutral culture.  Make sure\n  \\\"Resource1.resources\\\" was correctly\n  embedded or linked into assembly\n  \\\"TFBIC.RCT.Monitor\\\" at compile time,\n  or that all the satellite assemblies\n  required are loadable and fully\n  signed.\"}</p>\n</blockquote>\n\n<pre><code>    // get initial images \nResourceManager rm = new ResourceManager(\n    \"Resource1\",System.Reflection.Assembly.GetExecutingAssembly());\nCultureInfo ci = Thread.CurrentThread.CurrentCulture;\n\n\nstring strTest = rm.GetString(\"String1\");  // just testing \n\nBitmap bmCircleGreen = (Bitmap)rm.GetObject(\"circleGreen\");      \nBitmap bmCircleYellow = (Bitmap)rm.GetObject(\"circleYellow\");      \nBitmap bmCircleRed = (Bitmap)rm.GetObject(\"circleRed\");  \n</code></pre>\n\n<p>My form is the first class in my project (I've already seen that error).<br>\nI assigned a strong-key to my project to no avail.<br>\nNot sure what else to try.</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13090854,"title":"WinForm Resizing a panel onFocus","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3562235/panel-not-getting-focus\">Panel not getting focus</a>  </p>\n</blockquote>\n\n\n\n<p>im test the Panel control in winform, and I got into a problem.</p>\n\n<p>i have this 2 events that i added to the panel but non of them fire:</p>\n\n<pre><code> private void panel_onFocus(object sender, EventArgs e)\n    {\n        panel1.Size = new Size(panel1.Size.Width, panel1.Size.Height * panel1.Size.Height);\n    }\n\n    private void panel_lostFocus(object sender, EventArgs e)\n    {\n        panel1.Size = new Size(panel1.Size.Width, panel1.Size.Height / panel1.Size.Height);\n    }\n</code></pre>\n\n<p>i got a another control on the Form to test the focus(a button).</p>\n\n<p>why onFocus and lostFocus dosnt fire?</p>\n\n<p>(sory for my english)</p>\n"},{"tags":["c#","winforms","visual-studio-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13097292,"title":"How to add custom GUI component to ToolBox","body":"<p>I have downloaded <a href=\"http://objectlistview.sourceforge.net/cs/index.html\" rel=\"nofollow\">objectListView</a> but do not know how to add the component to ToolBox, and so that I could drag it to my application. Anyone know how to do that?</p>\n"},{"tags":["c#",".net","winforms","drawing"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":94,"score":1,"question_id":12806531,"title":"why does editing an image with Lockbits still take 7 secs?","body":"<h2>My Application</h2>\n\n<p>I am writing an application that needs to convert RGB to grayscale images.\nThe conversion works but converting an image of 3648 * 2736 pixel takes round about 7 secs.\nI know that set and getpixel take some time.\nBut I think that it shouldn't take so long if you are using Lockbits even though the image is not small. (please correct me if that is wrong).\nMaybe I just did a fatal mistake within my code.</p>\n\n<h2>The code</h2>\n\n<pre><code>public static long ConvertToGrayScaleV2(Bitmap imageColor, bool useHDTVConversion)\n        {\n            Stopwatch stpw = new Stopwatch();\n            stpw.Start();\n            System.Drawing.Imaging.BitmapData imageColorData = imageColor.LockBits(new Rectangle(new Point(0, 0), imageColor.Size),\n                System.Drawing.Imaging.ImageLockMode.ReadWrite, imageColor.PixelFormat);\n\n            IntPtr PtrColor = imageColorData.Scan0;\n            int strideColor = imageColorData.Stride;\n            byte[] byteImageColor = new byte[Math.Abs(strideColor) * imageColor.Height];\n            System.Runtime.InteropServices.Marshal.Copy(PtrColor, byteImageColor, 0, Math.Abs(strideColor) * imageColor.Height);\n\n            int bytesPerPixel = getBytesPerPixel(imageColor);\n            byte value;\n            if (bytesPerPixel == -1)\n                throw new Exception(\"Can't get bytes per pixel because it is not defined for this image format.\");\n            for (int x = 0, position; x &lt; imageColor.Width * imageColor.Height; x++)\n            {\n                position = x * bytesPerPixel;\n                if (useHDTVConversion)\n                {\n                    value = (byte)(byteImageColor[position] * 0.0722 + byteImageColor[position + 1] * 0.7152 + byteImageColor[position + 2] * 0.2126);                    \n                }\n                else\n                {\n                    value = (byte)(byteImageColor[position] * 0.114 + byteImageColor[position + 1] * 0.587 + byteImageColor[position + 2] * 0.299);\n                }\n                byteImageColor[position] = value;\n                byteImageColor[position+1] = value;\n                byteImageColor[position+2] = value;\n\n            }\n\n            System.Runtime.InteropServices.Marshal.Copy(byteImageColor, 0, PtrColor, Math.Abs(strideColor) * imageColor.Height);\n            imageColor.UnlockBits(imageColorData);\n            stpw.Stop();\n            return stpw.ElapsedMilliseconds;\n        }\n\n        public static int getBytesPerPixel(Image img)\n        {\n            switch (img.PixelFormat)\n            {\n                case System.Drawing.Imaging.PixelFormat.Format16bppArgb1555:    return 2;\n                case System.Drawing.Imaging.PixelFormat.Format16bppGrayScale:   return 2;\n                case System.Drawing.Imaging.PixelFormat.Format16bppRgb555: return 2;\n                case System.Drawing.Imaging.PixelFormat.Format16bppRgb565: return 2;\n                case System.Drawing.Imaging.PixelFormat.Format1bppIndexed: return 1;\n                case System.Drawing.Imaging.PixelFormat.Format24bppRgb: return 3;\n                case System.Drawing.Imaging.PixelFormat.Format32bppArgb: return 4;\n                case System.Drawing.Imaging.PixelFormat.Format32bppPArgb: return 4;\n                case System.Drawing.Imaging.PixelFormat.Format32bppRgb: return 4;\n                case System.Drawing.Imaging.PixelFormat.Format48bppRgb: return 6;\n                case System.Drawing.Imaging.PixelFormat.Format4bppIndexed: return 1;\n                case System.Drawing.Imaging.PixelFormat.Format64bppArgb: return 8;\n                case System.Drawing.Imaging.PixelFormat.Format64bppPArgb: return 8;\n                case System.Drawing.Imaging.PixelFormat.Format8bppIndexed: return 1;\n                default: return -1;\n            }\n\n        }\n</code></pre>\n"},{"tags":["asp.net","winforms","webforms","learn"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13096759,"title":"transitioning... moving from winforms to asp.net","body":"<p>After a long time developing winforms and windows services I have taken a position that has me working on a medium size enterprise saas webforms project. I find myself trying to recall a bunch of html knowledge picked up from year's ago.</p>\n\n<p>Are there any suggestions for learning asp.net webforms, Javascript, browser best practices and so on?</p>\n"},{"tags":["c#","winforms","htmlelement"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":822,"score":0,"question_id":5375596,"title":"Unable to get htmlelement in winforms webbrowser control","body":"<p>I'm developing automation program using winforms webbrowser control. I am able to get the htmlelement at the first few web pages. But i'm unable to get the htmlelement from certain pages and i'm using the same method like what i have done for the first few web pages (The few first pages htmlelement are retrieved successfully).</p>\n\n<pre><code>        HtmlElement createButton = this.extendedWebBrowser2.Document.GetElementById(\"createButton\");\n        HtmlElement textArea = this.extendedWebBrowser2.Document.GetElementById(\"query\");\n        HtmlElement filename = this.extendedWebBrowser2.Document.GetElementById(\"filename\");\n        HtmlElement cancelBtn = this.extendedWebBrowser2.Document.GetElementById(\"cancelBtn\");\n</code></pre>\n\n<p>it returned null and i have no idea why it return null althought the elements exist at the pages. Why and what to do so i can detect the html element? What kind of reasons can cause it is unable to be detected?</p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13094116,"title":"Set DataGridView cell editor based on row","body":"<p>Is there a way to have different cells in the same column to display/edit data differently?</p>\n\n<p>I'm trying to use a data grid to let the user enter values for parameters specified in an XML file.  This would be fairly straightforward, except that some parameters are strings, some are integers, and some are booleans.</p>\n\n<p>While I could just use a textbox with cell validating events to force the user to enter values that meet the criteria for the parameter, I think it would be more user-friendly to use a text box cell for String parameters, a checkbox cell for Boolean parameters, and a numeric up down cell (that I made) for Integer parameters.</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2751,"score":2,"question_id":2317738,"title":"How to add help to winform c# application","body":"<p>I want to know that how can I add help support to my winform app.</p>\n\n<p>How do I create chm file for help and how do I integrate it with the application. I want help for almost every control in my application.</p>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":739,"score":0,"question_id":8212100,"title":"How To Maximize Appliction In Over The Taskbar at Windows Forms","body":"<p>Can someone help me. I need to maximize my appliction in C# that it will be over the taskbar. I have change the property WindowState = Maximized. But the lower parrt of the appliction appears under the taskbar.i want the status bar to appear above with the taskbar also shown below it.</p>\n\n<p><img src=\"http://i.stack.imgur.com/ADwH5.png\" alt=\"enter image description here\">\nIts maximized but where is my statusbar :)\n<img src=\"http://i.stack.imgur.com/tyzk7.png\" alt=\"enter image description here\">\nThis is Normal State of Window.. You can see status bar in this pic.</p>\n"},{"tags":["c#","winforms","charts","financial"],"answer_count":6,"favorite_count":3,"up_vote_count":7,"down_vote_count":0,"view_count":5189,"score":7,"question_id":600259,"title":"C# financial charting library for Windows Forms?","body":"<p>I need a open-source/free C# tool or library that can do financial charting for a student project.  It needs to be able to do a open-high-low-close chart, and be able to graph various technical indicators that I calculate, all from within a Windows form.</p>\n\n<p>Any recommendations?</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":105,"score":0,"question_id":9070359,"title":"ObjectListView items invisible?","body":"<p>For some reason I can't get any items to show up in an ObjectListView.\nI created an ObjectListView, set the view to \"Details\" and added three columns, each with text and header. I then used this code to (try to) add items:</p>\n\n<pre><code>List&lt;string[]&gt; list = new List&lt;string[]&gt;();\nlist.Add(new string[] { \"col1\", \"col2\", \"col3\" });\nlist.Add(new string[] { \"col1\", \"col2\", \"col3\" });\n\nreleases_ListView.AddObjects(list);\n</code></pre>\n\n<p>When I try <code>releases_ListView.Items.Count</code> I get '2' so the items are added to the collection, but for some reason the control itself remains empty. I also played around with enabling/disabling sorting/grouping and using <code>Refresh()</code> or <code>Update()</code> but with any result...</p>\n\n<p>Nobody knows this? BTW, the items are definitely added. I get a selection box when I select the first rows, just no visible text.</p>\n"},{"tags":["c#","winforms","usercontrols"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13094684,"title":"MouseLeave doesn't fire when moving from child control to parent's parent","body":"<p>I have a UserControl that listens to it's own MouseLeave in order to change it's background color and some of it's children visibility.\nThe children that should lose visibility, also listen their own MouseLeave in order to change their background color.</p>\n\n<p>A scenario in which everything works is this:</p>\n\n<ol>\n<li>Move mouse into UserControl.</li>\n<li>Move mouse into Child.</li>\n<li>Move mouse out of Child into UserControl.</li>\n</ol>\n\n<p>The problematic scenario is this:</p>\n\n<ol>\n<li>Move mouse into UserControl.</li>\n<li>Move mouse into Child.</li>\n<li>Move mouse out of Child, not into the UserControl, but directly outside of it.</li>\n</ol>\n\n<p>This scenario happens all the time since the Child is located at the very edge of the UserControl.\nNote that not only the UserControl's MouseLeave doesn't fire, but neither does the Child's MouseLeave.</p>\n\n<p>In order to find out whether the mouse has actually left the area in this case, I must listen to MouseEnter of other controls, and then notify the UserControl and Child, but I really want to avoid this solution, since it is ugly and not OOPish.</p>\n\n<p>Also, the Child MUST be located at the very edge of the UserControl, and cannot move.</p>\n\n<p>Can anyone think of a neat solution to the problem?</p>\n"},{"tags":["c#","winforms","sqldatasource","dataadapter","begininvoke"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":50,"score":2,"question_id":13094682,"title":"BeginInvoke() occasionally breaks (System.InvalidOperationException) with Invalid attempt to call Read when reader is closed","body":"<p>In following code snippet, <code>AddRow()</code> is called from a non-UI thread:</p>\n\n<pre><code>  public partial class Form1 : Form\n  {\n    public delegate void InvokeDelegate();\n\n    ...\n    SqlConnection mSqlConnection = new SqlConnection(\"Data Source=\" + Environment.MachineName + \"\\\\SQLEXPRESS; Initial Catalog=orderDB; Integrated Security=TRUE; MultipleActiveResultSets=True;\");\n\n    DataSet mDataSet = new DataSet();\n    SqlDataAdapter mSqlDataAdapter = new SqlDataAdapter();\n\n\n    ...\n    private void UpdateGridView()\n    {\n      if (mSqlConnection.State == ConnectionState.Closed)\n        mSqlConnection.Open();\n\n      mSqlDataAdapter.SelectCommand = new SqlCommand(\"SELECT * FROM customerTable\", mSqlConnection);\n      mDataSet.Clear();\n      mSqlDataAdapter.Fill(mDataSet);\n      dataGridView1.DataSource = mDataSet.Tables[0];\n\n      if (mSqlConnection.State == ConnectionState.Open)\n        mSqlConnection.Close();\n    }\n\n\n    public void AddRow(int field1, int field2, int field3)\n    {\n      mSqlDataAdapter.InsertCommand = new SqlCommand(\"INSERT INTO customerTable VALUES(@field1, @field2, @field3)\", mSqlConnection);\n\n      mSqlDataAdapter.InsertCommand.Parameters.Add(\"@field1\", SqlDbType.Int).Value = field1;\n      mSqlDataAdapter.InsertCommand.Parameters.Add(\"@field2\", SqlDbType.Int).Value = field2;\n      mSqlDataAdapter.InsertCommand.Parameters.Add(\"@field3\", SqlDbType.Int).Value = field3;\n\n      mSqlConnection.Open();\n      mSqlDataAdapter.InsertCommand.ExecuteNonQuery();\n      dataGridView1.BeginInvoke(new InvokeDelegate(UpdateGridView)); // UpdateGridView() won't work from a non-UI thread\n      mSqlConnection.Close();\n\n    }\n}\n</code></pre>\n\n<p>Before having to call <code>AddRow()</code> from a non-UI thread, I had <code>UpdateGridView()</code> being called directly and it worked flawlessly. But now <code>AddRow()</code> is no longer guaranteed to be called from a UI thread and so I replaced the direct call with <code>dataGridView1.BeginInvoke()</code>.</p>\n\n<p>As soon as I did that, my form-based application started throwing a <code>System.InvalidOperationException</code> every several <code>AddRow()</code> calls, breaking on the <code>mSqlDataAdapter.Fill(mDataSet);</code> statement (<strong>!</strong>)  with the following message:</p>\n\n<blockquote>\n  <p>Invalid attempt to call Read when reader is closed</p>\n</blockquote>\n\n<p>My question is why?</p>\n\n<ol>\n<li>What reader? the DataAdapter's? The SqlConnection's? The DataGridView's data source?</li>\n<li>I am taking care of surrounding <code>BeginInvoke()</code> with mSqlConnection's <em>Open()</em> and <em>Close()</em> and I even open mSqlConnection (again!) if it isn't open, so how come I'm receiving this \"closed\" error?</li>\n<li>What is the correct way to solve this problem? (i.e. updating DataGridView from a non-UI thread)</li>\n</ol>\n"},{"tags":["c#","winforms","combobox","selecteditem","unboxing"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":13094025,"title":"Unboxing freezes Winforms ComboBox","body":"<p>Pretty specific and weird problem here, Google and the rest couldn't give me an answer.</p>\n\n<p>I have a form with two ComboBoxes, we'll say A and B. Selecting an item in A pulls some info from a database, puts it in Dictionary, and uses BindingSource to put it in B. When the user selects something from B, return values are set and nothing else.</p>\n\n<p>The problem is with ComboBox B. In its SelectedIndexChanged handler, attempting to unbox  its SelectedItem causes the ComboBox to 'freeze' so it no longer displays the result of new selections from ListBox B and long lists do not refresh when scrolled up/down. The ComboBox still functions, though, if you remember where the data is</p>\n\n<p>The SelectedIndexChanged Handler of B:</p>\n\n<pre><code>private void comboBox2_SelectedIndexChanged_1(object sender, EventArgs e)\n{\n    if (dataSourceSelect)\n        return;\n    else\n    {\n        ComboBox comboBox = (ComboBox)sender;\n\n        var dummy = comboBox2.SelectedItem;\n        // System.Collections.Generic.KeyValuePair&lt;int, string&gt; dummy2 =\n        //     (System.Collections.Generic.KeyValuePair&lt;int, string&gt;)dummy;\n    }\n}\n</code></pre>\n\n<p>There are two dummy variables to show that it isn't the SelectedItem property causing the problem, only the unboxing.</p>\n\n<p>Using this exact code lets ComboBox work correctly, but it's unable to return data. Enabling the commented-out line lets it return values, but stops it from refreshing.</p>\n\n<p>There are two things this code won't show:</p>\n\n<ol>\n<li><p>Even if you put the commented line in, everything works fine until you do a second selection from ComboBox A. Put another way, if you select from ComboBox A <em>once</em>, ComboBox B will refresh based on your input. But if the selection from A is <em>changed</em>, B freezes the last value shown, and long lists no longer update when scrolled.</p></li>\n<li><p>The code that fills ComboBox A and B are nearly identical, as are their click handlers, yet A works without any problem all the time, and B freezes when you do a second selection from A.</p></li>\n</ol>\n\n<p>I can only theorize as to the cause of this, but my guess is that unboxing uses some temp memory location that hates to be touched twice. There might also be some problem with the code that populates B based on A's selection, but the fact that it works fine when unboxing is commented out reduces that suspicion.</p>\n\n<p>From what I can tell, I need to do one of the following:</p>\n\n<ol>\n<li>Access SelectedItem in another fashion</li>\n<li>Access the data in SelectedItem without unboxing</li>\n<li>Find a method that avoids unboxing altogether</li>\n</ol>\n\n<p>Apologies for the formatting, StackOverflow seems to be ignoring my attempts to make it more readable</p>\n"},{"tags":["c#","winforms","compact-framework","close"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":107,"score":5,"question_id":13049531,"title":"Trying to close a form after the next one is shown in C# cf","body":"<p>I've been studying Android lately and I tried to port one of its functions to C# compact framework.</p>\n\n<p>What I did is create an Abstract class that I call Activity\nThis class looks like this</p>\n\n<pre><code>  internal abstract class Activity\n  {\n      protected Form myForm;\n      private static Activity myCurrentActivity = null;\n      private static Activity myNextActivity = null;\n\n      internal static void LoadNext(Activity nextActivity)\n      {\n         myNextActivity = nextActivity;\n         if (myNextActivity != null)\n         {\n            myNextActivity.Show();\n            if (myCurrentActivity != null)\n            {\n               myCurrentActivity.Close();\n               myCurrentActivity = null;\n            }\n            myCurrentActivity = myNextActivity;\n            myNextActivity = null;\n         }\n      }\n\n      internal void Show()\n      {\n        //PROBLEM IS HERE\n         Application.Run(myForm);\n         //myForm.Show();\n         //myForm.ShowDialog();\n        //\n      }\n\n      internal void Close()\n      {\n         myForm.Close();\n      }\n\n\n      internal void GenerateForm()\n      {\n      ///Code that uses the Layout class to create a form, and then stores it in myForm\n      //then attaches click handlers on all the clickable controls in the form\n      //it is besides the point in this problem\n      }\n\n      protected abstract void Click(Control control);\n      //this receives all the click events from all the controls in the form\n      //it is besides the point in this problem\n\n   }\n</code></pre>\n\n<p>The problem I have is with running the part of the <code>Show()</code> command</p>\n\n<p>Basically all my classes implement the above class, load an xml file and display it.\nWhen I want to transition to a new class/form (for example going from ACMain to ACLogIn)\nI use this code</p>\n\n<pre><code>Activity.LoadNext(new ACLogIn);\n</code></pre>\n\n<p>Which is supposed to load the next form, show it , and unload the current form</p>\n\n<p>I have tried these solutions (in the <code>Show()</code> method) and here is the problem with each one</p>\n\n<ol>\n<li><p>using <code>myForm.ShowDialog()</code>\n<br>This works, but blocks execution, which means that the old form does not close, and the more I move between the forms the more the process stack increases</p></li>\n<li><p>using <code>myForm.Show()</code>\n<br>This works, closes the old form after the old one is shown, but immediately after that closes the program and terminates it</p></li>\n<li><p>using <code>Application.Run(myForm)</code>\n<br>This works only on the first form loaded, when I move to the next form, it shows it then throws an exception saying \"Value does not fall within the expected range\"</p></li>\n</ol>\n\n<p>Can someone help me fix this or find an alternate?\n<br>Thanks in advance for any help you can provide</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2851,"score":1,"question_id":4099652,"title":"c# how do you return dataset from sqldatareader?","body":"<p>I have this in a public class:</p>\n\n<pre><code>SqlConnection myConnection = new SqlConnection(\"Data Source=hermes;database=qcvalues; Integrated Security=SSPI;\");\nmyConnection.Open();\nSqlDataReader myReader = null;\nSqlCommand myCommand = new SqlCommand(InitializeQuery(), myConnection);\nmyReader = myCommand.ExecuteReader();\n</code></pre>\n\n<p>I need the datasource of a control to get the dataset from myReader.</p>\n\n<p>Unfortunately this is difficult to do because the control is on a form (a separate class). how would I return <code>myReader</code> dataset into the <code>datasource</code> property of the control on my form?</p>\n"},{"tags":["winforms","events","c#-4.0","controls","contextmenu"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":510,"score":3,"question_id":6826183,"title":"Prevent ToolStripMenuItem context menu from unloading on click","body":"<p>I'm trying to have my context menu stay on screen even after I click one of its dropdown items (when the shift key is pressed, though I don't think that matters to the issue).  You can see an example of the behavior in Windows XP when you click on Start > All Programs > Accessories > [now hit your shift key] and click on Windows Explorer... The menu stays up.</p>\n\n<p>It's a C# app, using Winforms, development machine is Windows 7, production is either XP, Vista or 7.</p>\n\n<p>The toolstripmenuitem doesn't seem to have a \"closing\" event; only a \"closed\" one.  Those familiar with a \"closing\" event will know that you can set a \"cancel\" flag to prevent the control from closing.</p>\n\n<p>Also, when I try a workaround of remaking it visible from within either its click event or its closed event, it doesn't work.  Although that would have been a tolerable workaround in the immediate, it is not for production.</p>\n\n<p>Anyu suggestions or related info greately appreciated.</p>\n\n<p>Thank you</p>\n"},{"tags":["c#","winforms","datagridview","telerik-grid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13092050,"title":"Disable event handler from a method","body":"<p>In my datagridview, I have got some columns are <code>read only</code>, so i have given in some color. \nWhen I load the the DGV in advance view with all columns including read only. \nWhen the user cliks on Normal View I want to just display the normal eitable cols and hide the read only columns and the color.</p>\n\n<p>I'm on telerik and using radgrid.</p>\n\n<p>I tried the below approach but it's not working. Is there any better way of doing this?? Thank you.</p>\n\n<pre><code>private void normalToolStripMenuItem_Click(object sender, EventArgs e)//Normal View\n{\n    DTURradGridView.Columns[2].IsVisible = false;\n    DTURradGridView.Columns[3].IsVisible = false;\n    DTURradGridView.Columns[4].IsVisible = false;\n    DTURradGridView.Columns[5].IsVisible = false;\n    DTURradGridView.Columns[7].IsVisible = false;\n    DTURradGridView.Columns[11].IsVisible = false;\n\n    DTURradGridView.Columns[2].ReadOnly = false;\n    DTURradGridView.Columns[3].ReadOnly = false;\n    DTURradGridView.Columns[4].ReadOnly = false;\n    DTURradGridView.Columns[5].ReadOnly = false;\n    DTURradGridView.Columns[7].ReadOnly = false;\n    DTURradGridView.Columns[11].ReadOnly = false;\n\n    DTURradGridView.CellFormatting -= DTURradGridView_CellFormatting;\n}\n\nprivate void advancedToolStripMenuItem_Click(object sender, EventArgs e) //Advanced View\n{\n    DTURradGridView.Columns[2].IsVisible = true;\n    DTURradGridView.Columns[3].IsVisible = true;\n    DTURradGridView.Columns[4].IsVisible = true;\n    DTURradGridView.Columns[5].IsVisible = true;\n    DTURradGridView.Columns[7].IsVisible = true;\n    DTURradGridView.Columns[11].IsVisible = true;\n\n    DTURradGridView.Columns[2].ReadOnly = true;\n    DTURradGridView.Columns[3].ReadOnly = true;\n    DTURradGridView.Columns[4].ReadOnly = true;\n    DTURradGridView.Columns[5].ReadOnly = true;\n    DTURradGridView.Columns[7].ReadOnly = true;\n    DTURradGridView.Columns[11].ReadOnly = true;\n\n    DTURradGridView.CellFormatting += DTURradGridView_CellFormatting;   \n}\n\nprivate void DTURradGridView_CellFormatting(object sender, CellFormattingEventArgs e)\n{\n    if (e.CellElement.ColumnIndex != 2 &amp;&amp; e.CellElement.ColumnIndex != 3 &amp;&amp; e.CellElement.ColumnIndex != 4\n    &amp;&amp; e.CellElement.ColumnIndex != 5 &amp;&amp; e.CellElement.ColumnIndex != 7 &amp;&amp; e.CellElement.ColumnIndex != 11) return;\n\n    e.CellElement.DrawFill = true;\n    e.CellElement.NumberOfColors = 1;\n    e.CellElement.BackColor = Color.LightSlateGray;\n    e.CellElement.GradientStyle = GradientStyles.Linear;    \n}\n</code></pre>\n\n<p>When I click on the normal view, I see the colors of the col index 2,3,4,5. So the -= is not working.</p>\n"},{"tags":["c#","winforms","progress-bar"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":697,"score":1,"question_id":4036725,"title":"progress bar click => change current track play position","body":"<p>i am making a music player in winforms. i have a progress bar and when i click on a position along the progress bar, i want to get the int for that position ( from 1 to 100 , i.e. for when i want to get to a certain point in my song ) . How can i do that ?</p>\n\n<p>Regards,\nAlexandru Badescu</p>\n"},{"tags":[".net","winforms","visual-studio-2010-sp1","sql-server-ce-4"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":88,"score":0,"question_id":6030897,"title":"Sql server CE 4.0 in a Visual studio project suddenly losing data","body":"<p>I am not sure if this is a setup issue from my side or some bug, but I am facing a really wierd problem.</p>\n\n<p>I am developing against SQL Server CE 4.0 in a VS 2010 Winforms Project. It is kept in the project like so</p>\n\n<p><img src=\"http://i.stack.imgur.com/TMo02.png\" alt=\"enter image description here\"></p>\n\n<p>Now what happens is, for some strange reason, whenever I encounter an exception in my application or do a schema update for database, I lose all my test data. Not just one table, all of it, entire database except for the schema objects. </p>\n\n<p>Remember, I am not doing anything to regenerate the database from the model or anything. It just deletes all the data, and currently it is not even fully reproducible. Completely unpredictable. The schema remains intact even after the data is deleted. </p>\n\n<p>Can any one help?</p>\n"},{"tags":["c#",".net","winforms","painting"],"answer_count":6,"favorite_count":39,"up_vote_count":62,"down_vote_count":0,"view_count":18421,"score":62,"question_id":487661,"title":"How do I suspend painting for a control and its children?","body":"<p>I have a control which I have to make large modifications to.  I'd like to completely prevent it from redrawing while I do that - SuspendLayout and ResumeLayout aren't enough.  How do I suspend painting for a control and its children?</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":577,"score":0,"question_id":3042068,"title":"How to raise a validation event from a key press","body":"<p>I want to raise the:</p>\n\n<pre><code>private void txtbox_startdate_Validating(object sender, System.ComponentModel.CancelEventArgs e)\n    {}\n</code></pre>\n\n<p>Function from a key leave event.  The leave event looks like:</p>\n\n<pre><code>private void txtbox_startdate_Leave(object sender, EventArgs e)\n    {}\n</code></pre>\n\n<p>The trouble is of course if I try and call it in this manner:</p>\n\n<pre><code>txtbox_startdate_Validating(sender, e)\n</code></pre>\n\n<p>An error is raised because in this case <code>e</code> is an <code>EventArg</code>s whereas the validation function wants a <code>System.ComponentModel.CancelEventArgs</code> and so, how do I convert <code>EventArgs</code> to a <code>System.ComponentModel.CancelEventArgs</code> or create one so that I can call my validation function?</p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6028,"score":0,"question_id":1224291,"title":"How to filter C# Winform datagridview that was created with Visual Studio","body":"<p>I'm astonished there isn't even a filter property attached to datagridview and I'm getting on my nerve, I can find examples for filtering Datagridview that was binded programmatically, I cannot find any example on how to filter a datagridview that was generated by Visual Studio.</p>\n\n<p>So please can someone tell me how to filter this stuff ?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","wpf","winforms"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":2416,"score":6,"question_id":1095763,"title":"How to set a Wpf Window as the Owner of a Winforms Form","body":"<p>How to set a System.Windows.Window as the Owner of a System.Windows.Forms.Form?</p>\n\n<p>After I searched for this for a while only to realize that I already have the answer in one of my utils classes I decided to put the answer on stackoverflow. Hopefully someone finds this useful.</p>\n"},{"tags":["c#","winforms","begininvoke"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13090097,"title":"BeginInvoke claims the control's window handle has not been created even though I think it was","body":"<p>In my form's constructor, I call:</p>\n\n<pre><code>InitializeComponent(); // boilerplate placed by VS, initializing controls\nlabel1.BeginInvoke(new InvokeDelegate(RefreshLabelDelegate));\n</code></pre>\n\n<p>Yet, I get the dreaded exception with the message:</p>\n\n<blockquote>\n  <p>\"Invoke or BeginInvoke cannot be called on a control until the window\n  handle has been created\"</p>\n</blockquote>\n\n<p>AFAIK, it is all the same thread, so why the exception?</p>\n"},{"tags":["c#","winforms","treeview","panel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13091200,"title":"attach a panel to TreeView control","body":"<p>I am beginner in c#. In my project, I populated a xml file inside a TreeView control. If the xml file is large, the <code>TreeView</code> control is showing the data with scroll bars. Beside this, whenever the user double clicks a node I am showing a panel beside the selected node something like this..</p>\n\n<p><img src=\"http://i.stack.imgur.com/ORbIo.png\" alt=\"enter image description here\"></p>\n\n<p><em>When I scroll the TreeView Control</em> :</p>\n\n<p><img src=\"http://i.stack.imgur.com/cmUEW.png\" alt=\"enter image description here\"></p>\n\n<p>My question is how to make the <code>panel</code> attached to <code>treeView</code> control so that eventhough the user scrolls the <code>TreeView</code> control the panel should also move along with the selected node.</p>\n"},{"tags":["c#","winforms","data-binding"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":80,"score":1,"question_id":13090873,"title":"TextBox change is not saved to DataTable","body":"<p>I'm having trouble with a simple table edit in a WinForms Application. I must have missed a step. </p>\n\n<p>I have a <code>DataSet</code> containing a <code>DataTable</code> connected to a database with a <code>SqlDataAdapter</code>. There is a <code>SqlCommandBuilder</code> on the <code>SqlDataAdapter</code>. On the form, there are <code>TextBoxes</code> which are bound to the <code>DataTable</code>. The binding was done in the Designer and its machine-produced statements like this:</p>\n\n<pre><code>this.tbLast.DataBindings.Add(new System.Windows.Forms.Binding(\"Text\", this.belkData, \"belk_mem.last\", true));\n</code></pre>\n\n<p>When I fill the row in the <code>DataTable</code>, the values from the database appear in the textboxes, but when I change contents of the <code>TextBox</code>, the changes are apparently not being going to the <code>DataTable</code>. When I try to save a change, both of the following return null:</p>\n\n<pre><code>DataTable dtChanges = dtMem.GetChanges();\nDataSet dsChanges = belkData.GetChanges();\n</code></pre>\n\n<p>What did I forget?</p>\n\n<hr>\n\n<p><strong>Edit - response to <a href=\"http://stackoverflow.com/users/172769/\">mrlucmorin</a>:</strong></p>\n\n<p>The save is under a button. Code is:</p>\n\n<pre><code>    BindingContext[belkData, \"belk_mem\"].EndCurrentEdit();\n\n    try\n    {\n        DataSet dsChanges = belkData.GetChanges();\n        if (dsChanges != null)\n        {\n            int nRows = sdaMem.Update(dsChanges);\n            MessageBox.Show(\"Row(s) Updated: \" + nRows.ToString());\n            belkData.AcceptChanges();\n        }\n        else { MessageBox.Show(\"Nothing to save.\", \"No changes\"); }\n    }\n    catch (Exception ex)\n    {\n        MessageBox.Show(\"Error: \" + ex.Message);\n    }\n</code></pre>\n\n<p>I've tried putting in these statements without any change in behavior:</p>\n\n<pre><code>dtMem.AcceptChanges();\nbelkData.AcceptChanges();\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":13090737,"title":"C# filename + filepath to textbox","body":"<p>I wrote a function that will open a file dialog, but it won't return me the filepath + filename.</p>\n\n<p>What am i missing?</p>\n\n<pre><code>private void browseButton_Click(object sender, EventArgs e)\n    {\n        browseDatabase(accessDatabaseTextbox.Text, \"mdb bestanden|*.mdb\");\n    }\n\n    private void browsebutton2_Click(object sender, EventArgs e)\n    {\n        browseDatabase(klantenDatabaseTextbox.Text, \"accdb bestanden|*.accdb\");\n    }\n\nprivate void browseDatabase(string textbox, string filter)\n    {\n        openFileDialogDB.Filter = filter;\n\n        if (openFileDialogDB.ShowDialog() == DialogResult.OK)\n        {\n            string DBfile = openFileDialogDB.FileName;\n            if (System.IO.File.Exists(DBfile))\n            {\n                textbox = DBfile;\n            }\n            else\n            {\n                MessageBox.Show(\"Selected file doesn't exist.\", \"Error\", MessageBoxButtons.OK, MessageBoxIcon.Error);\n            }\n        }\n        else\n        {\n            MessageBox.Show(\"No file selected.\", \"Error\", MessageBoxButtons.OK, MessageBoxIcon.Error);\n        }\n    }\n</code></pre>\n"},{"tags":["c#","winforms","generate","codedom"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":434,"score":2,"question_id":6603028,"title":"Errors while attempting to generate code using Codedom","body":"<p>My goal: To create a windows form application (executable) through the use of CodeDom. By this I mean I would like a form (with some code behind the form) and turn it into an executable file (as if I had gone into Visual Studio and clicked \"Build\" > \"Build File\"). Admittingly, I found this example online and I have since lightly modified it. I am getting errors while trying to <em>generate</em> this code - errors that I have never seen before. Furthermore, I could not find these errors on Google (odd right?)...</p>\n\n<p>Here is the error I am getting:\n<strong>Element type System.CodeDom.CodeExpression is not supported.\nParameter name: e</strong></p>\n\n<p>I am getting this error on the following line:</p>\n\n<pre><code>CodeProvider.GenerateCodeFromCompileUnit(Unit, writer, new CodeGeneratorOptions());\n</code></pre>\n\n<p>Here is my full code:</p>\n\n<pre><code>{\n\n     CodeDomProvider CodeProvider = CodeDomProvider.CreateProvider(\"CSharp\");\n\n         // Create the Unit\n     CodeCompileUnit Unit = new CodeCompileUnit();\n\n    // Define a namespace and add Imports statements\n    CodeNamespace Namespaces = new CodeNamespace(\"Test.CreateForm\");\n        Namespaces.Imports.Add(new CodeNamespaceImport(\"System\"));\n        Namespaces.Imports.Add(new CodeNamespaceImport(\"System.Drawing\"));\n        Namespaces.Imports.Add(new CodeNamespaceImport(\"System.Windows.Forms\"));\n        Namespaces.Imports.Add(new CodeNamespaceImport(\"System.Xml\"));\n        Namespaces.Imports.Add(new CodeNamespaceImport(\"System.Data\"));\n\n        Unit.Namespaces.Add(Namespaces);\n\n    // Declare the type including base type\n    CodeTypeDeclaration MyType = new CodeTypeDeclaration(\"Form1\");\n        MyType.IsClass = true;\n        MyType.TypeAttributes = System.Reflection.TypeAttributes.Public;\n        MyType.BaseTypes.Add(\"System.Windows.Forms.Form\");\n\n        Namespaces.Types.Add(MyType);\n\n    // Create the constructor and add code\n     CodeConstructor Constructor = new CodeConstructor();\n\n    Constructor.Statements.Add(\n      new CodeMethodInvokeExpression(\n      new CodeThisReferenceExpression(),\"InitializeComponent\", new CodeExpression() {}));\n\n        Constructor.Attributes = MemberAttributes.Public ;\n\n    MyType.Members.Add(Constructor);\n\n    // Declare component container\n    MyType.Members.Add(new CodeMemberField(\"System.ComponentModel.IContainer\", \"components\"));\n\n\n\n   //  Implement the Dispose method\n    CodeMemberMethod DisposeMethod = new CodeMemberMethod();\n\n    DisposeMethod.Name = \"Dispose\";\n    DisposeMethod.Attributes = MemberAttributes.Family;\n\n    DisposeMethod.Parameters.Add(\n        new CodeParameterDeclarationExpression(\n        typeof(Boolean), \"disposing\"));\n\n    CodeConditionStatement Statement = new CodeConditionStatement();\n    Statement.Condition = new CodeArgumentReferenceExpression(\"disposing\");\n\n    CodeConditionStatement TrueStatement = new CodeConditionStatement();\n    TrueStatement.Condition = \n      new CodeBinaryOperatorExpression(\n        new CodeArgumentReferenceExpression(\"components\"),\n        CodeBinaryOperatorType.IdentityInequality,\n        new CodePrimitiveExpression(null));\n\n    TrueStatement.TrueStatements.Add(\n      new CodeMethodInvokeExpression(\n        new CodeFieldReferenceExpression(null,\n            \"components\"), \"Dispose\", new CodeExpression() {}));\n\n    Statement.TrueStatements.Add(TrueStatement);\n\n    DisposeMethod.Statements.Add(Statement);\n\n    DisposeMethod.Statements.Add(new CodeMethodInvokeExpression( new CodeBaseReferenceExpression(), \"Dispose\",  new CodeArgumentReferenceExpression[] \n        {new CodeArgumentReferenceExpression(\"disposing\")}));\n\n   MyType.Members.Add(DisposeMethod);\n\n\n    // InitializeComponent\n   CodeMemberMethod InitializeMethod = new CodeMemberMethod();\n\n   InitializeMethod.Name = \"InitializeComponent\";\n   InitializeMethod.Attributes = MemberAttributes.Private;\n\n   InitializeMethod.CustomAttributes.Add(\n     new CodeAttributeDeclaration(\n       \"System.Diagnostics.DebuggerStepThrough\"));\n\n   InitializeMethod.Statements.Add(\n     new CodeAssignStatement(\n       new CodeFieldReferenceExpression(\n         new CodeThisReferenceExpression(), \"components\"),\n           new CodeObjectCreateExpression(\n             new CodeTypeReference(\n               typeof(System.ComponentModel.Container)),\n               new CodeExpression() { })));\n\n   MyType.Members.Add(InitializeMethod);\n\n    // Main entry point\n    CodeEntryPointMethod MainMethod = new CodeEntryPointMethod();\n    MainMethod.Name = \"Main\";\n    MyType.Members.Add(MainMethod);\n\n    //Add mouse move event\n    CodeMemberEvent eventstate = new CodeMemberEvent();\n    eventstate.Name = \"MouseMove\";\n    eventstate.Attributes = MemberAttributes.Final | MemberAttributes.Public;\n    eventstate.Type = new CodeTypeReference(\"System.Windows.Forms.MouseEventHandler\");\n    MyType.Members.Add(eventstate);\n\n    string OutputName = \"Some.cs\";\n\n    try\n    {\n\n        CodeGeneratorOptions options = new CodeGeneratorOptions();\n        options.BlankLinesBetweenMembers = true;\n        options.ElseOnClosing = false;\n        options.BracingStyle = \"C\";\n\n        // This is what we'll write the generated code to\n        IndentedTextWriter writer = new IndentedTextWriter(new StreamWriter(OutputName, false), \"  \");\n        try\n        {\n            CodeProvider.GenerateCodeFromCompileUnit(Unit, writer, new CodeGeneratorOptions());\n            writer.Close();\n        }\n        catch (Exception ex)\n        {\n            MessageBox.Show(ex.Message);\n            writer.Close();\n        }\n    }\n    catch (Exception ex)\n    {\n        MessageBox.Show(ex.Message);\n    }\n\n    // Create the compiler options\n    // Include referenced assemblies\n    CompilerParameters Options = new CompilerParameters();\n    Options.GenerateExecutable = true;\n    Options.OutputAssembly = \"TestForm1.exe\";\n    Options.CompilerOptions = \"/target:winexe\";\n    Options.MainClass = \"Test.CreateForm.Form1\";\n\n    string[] referenceAssemblies = { \"System.dll\", \"System.Data.dll\", \"System.Drawing.dll\", \"System.Windows.Forms.dll\", \"System.XML.dll\" };\n\n    Options.ReferencedAssemblies.AddRange(referenceAssemblies);\n\n    //Build and look for compiler errors\n    CompilerResults Result = CodeProvider.CompileAssemblyFromFile(Options, \"Some.cs\");\n\n    if (Result.Errors.Count &gt; 0) \n    {\n        foreach(CompilerError ce in Result.Errors)\n        {\n            Console.WriteLine(ce.ErrorText);\n        }\n\n    }\n    else\n    {\n        Console.WriteLine(\"compiled successfully\");\n    }\n\n    Console.WriteLine(\"press enter to continue\");\n    Console.ReadLine();\n\n\n    }\n</code></pre>\n\n<p>If anyone has anytime to find my error I would greatly appreciate it!</p>\n\n<p>Thank you for any help on the matter,\nEvan</p>\n"},{"tags":["winforms","windows-forms-designer"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13090639,"title":"How to apply same style on all buttons in windows form","body":"<p>i have multiple buttons in my windows form application , and i want to apply some style on <code>btnhover</code> like this </p>\n\n<pre><code>private void button1_MouseEnter(object sender, EventArgs e) {\n  button1.UseVisualStyleBackColor = false;\n  button1.BackColor = Color.GhostWhite;\n}\nprivate void button1_MouseLeave(object sender, EventArgs e) {\n  button1.UseVisualStyleBackColor = true;\n}\n</code></pre>\n\n<p>i want to put this style at one place and i want that it atuomatically apply on all buttons in my form . how can i do this , Please help me and thanks in advance </p>\n"},{"tags":["c#","winforms","contextmenu","trackbar"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1134,"score":1,"question_id":4339143,"title":"Adding a TrackBar control to a ContextMenu","body":"<p>Is it possible to add a TrackBar control to a ContextMenu? So when I right click, my ContextMenu will drop down and a TrackBar will appear as a menu item?</p>\n"},{"tags":["c#","winforms","webkit"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12957930,"title":"Are there any samples of using CefGlue or CefSharp in a windows forms application with minimum setup?","body":"<p>I am (still) using Visual Studio 2005 and wanting to embed a webkit browser within a c# winforms application, preferably as a winforms control.</p>\n\n<p>I am looking for a simple example of either CefGlue or CefSharp to get started with, along with the minimum necessary dlls. I cannot make any sense of the CefSharp sample on GitHub.</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":7,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":5466,"score":8,"question_id":905447,"title":"How to prevent ListBox.SelectedIndexChanged event?","body":"<p>I am using a listbox in my C#2.0 windows forms application. The method to populate the list box is  </p>\n\n<pre><code>    private void PopulateListBox(ListBox lb, ReportColumnList reportColumnList)\n    {\n        lb.DataSource = reportColumnList.ReportColumns;\n        lb.DisplayMember = \"ColumnName\";\n        lb.ValueMember = \"ColumnName\";\n    }\n</code></pre>\n\n<p>However, when it executes the method it also calls the SelectedIndexChanged event handler of the listbox, even though I am not setting the selected index in the method above. How can I prevent the SelectedIndexChanged event handler from being called for the above code?</p>\n\n<p>I want the event to be called only when the user makes the selections in the ListBox. Or is there any other event which is only for user selecting listbox items using mouse click?</p>\n\n<p>On another note, even if the user clicks on an empty area in the list box the SelectedIndexChanged event gets fired. So I am wondering how different is it from the MouseClick event?</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2952,"score":2,"question_id":2685651,"title":"How to detect the vertical scrollbar in a DataGridView control","body":"<p>Using winforms in vs2008. I have a DataGridView and I would like to detect when the vertical scroll bar is visible. What event should I register for?</p>\n\n<p>I am adding the summing the each cell value in the last column of the grid and displaying that value in a textbox at the bottom of the DataGridView. </p>\n\n<p>I would like this textbox to stay lined up with the cell values (I have made them right aligned since it is $$ values) even after the scroll bar is present.</p>\n"},{"tags":["c#","winforms","events","datagridview","checkbox"],"answer_count":10,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":45093,"score":8,"question_id":932040,"title":"Triggering a checkbox value changed event in DataGridView C#.NET","body":"<p>I have a grid view that has a check box column, and I want to trigger a drawing event as soon as the value of the cell is toggled. I tried the ValueChaged and the CellEndEdit and BeginEdit, and chose the selection mode as CellSelect. As for the the first 2 events, the event was triggered upon the finishing of the edit mode, like moving out of the current cell, or going back and forth. It's just a weird behavior. </p>\n\n<p>Is there anything that triggers the event on the grid view as soon as the cell value is changed?</p>\n\n<p>Best Regards,</p>\n"},{"tags":["c#","vb.net","winforms","device","hid"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":73,"score":0,"question_id":13089484,"title":"How to get informations from a device connected to computer using VB.NET","body":"<p>There is no direct resource, i was able to find on internet for this issue.</p>\n\n<p><strong>My questions are:</strong></p>\n\n<ol>\n<li>How can i get the information about the device connected to PC.</li>\n<li>How can i check whether it is connected to PC or not?</li>\n<li>How i can get those data which is being transmitted by the devices to the computer?</li>\n<li>Do the above questions require any other expertise than VB.NET?</li>\n</ol>\n\n<p><strong>SOFTWARE WE ARE USING:</strong></p>\n\n<ol>\n<li>Visual Studio 2010 Ultimate</li>\n</ol>\n\n<p>I have read many things about HID class and some other stuff, but i am afraid, maybe i am unable to understand the logic or maybe its not actually the right point to start for this topic.</p>\n\n<p>I need an expert advice and note on the above queries and it would be great if someone can guide me for a road-map for the same. Like how to start and what information is required to start a programming for such devices.</p>\n\n<p>I know the question is very long, but i thought it is wise to give the exact idea of what we want to do. Also, if to answer this question any prerequisite is required, i'll try my level best to get it available to you people ASAP.</p>\n\n<p>I will give you an idea about the devices:</p>\n\n<p><strong>Type of device:</strong> Medical Device</p>\n\n<p><strong>Role of Software for that device:</strong> The software acts as a receiver for the devices, as the device gets data inputted by the user with its in-built keyboard and then the device sends that data to the PC. This software fetch that data sent by the device and displays in a desktop application.</p>\n\n<p><strong>EDIT PART 1--------</strong></p>\n\n<p><strong>Connection type:</strong> There is a serial port on the device which is connected with other end serial port to the PC, also, we use converter from Serial port to USB to connect the dives with systems having USB ports.</p>\n\n<p><strong>EDIT PART 1 END--------</strong></p>\n\n<p><em><strong>BELOW ARE SOME DETAILS OF MY SITUATION FOR DEVELOPING THIS SOFTWARE, ITS NOT NECESSARY TO READ BUT YOU MAY CAN FIND THE EXACT REQUIREMENT OF MINE</em></strong></p>\n\n<p>I have been working with a company in IT department, and developing VB.NET applications for them. I have good command on VB Application development.</p>\n\n<p>However, my company is having a device which works with a PC application. This PC application has been developed by some other company and when it was developed there was no IT department in our company. Since 3 years we have an IT department and I being a programmer develop many VB.NET desktop applications for company.</p>\n\n<p>Now, company wants to get a completely new software developed for its device with some new features.</p>\n\n<p>Now company don't want to get this new software developed by any other company because of the fear that the idea will be stolen. So they have asked us to develop it.</p>\n\n<p>I appreciate their demand and as we are related to IT and had total exposure to what we do, we want to develop this software for our-self. </p>\n\n<p>But i had gone through so many things on internet and unable to find any starting instructions.</p>\n"},{"tags":[".net","winforms"],"answer_count":4,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":1651,"score":8,"question_id":3166244,"title":"How to increase the size of checkbox in WinForms?","body":"<p>How do I increase the size of a checkbox in a .Net WinForm. I tried Height and Width but it does not increases the Box size. </p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13085298,"title":"Fill datagridview value to the constructor","body":"<p>This is my constructor, </p>\n\n<pre><code>new VisConfig(\nstring.Empty,\nstring.Empty,\nnew List&lt;SensorConfig&gt;()\n    {\n\n        new SensorConfig(\n        string.Empty, //DGV COl0\n        string.Empty, //DGV COl1\n        new List&lt;CoveredTrafficLane&gt;()\n            {\n                new CoveredLane(string.Empty) //DGV COl 2,3,4,5\n            },\n                new RseDevicePosition(\n                new ValueWithUnit&lt;int&gt;(0, \"mm\"), //DGV COl6\n                new ValueWithUnit&lt;int&gt;(0, \"mm\"), //DGV COl7\n                new ValueWithUnit&lt;int&gt;(0, \"mm\"), //DGV COl8\n                new ValueWithUnit&lt;int&gt;(0, \"tenthOfDegree\"), //DGV COl9\n                new ValueWithUnit&lt;int&gt;(0, \"tenthOfDegree\"), //DGV COl10\n                new ValueWithUnit&lt;int&gt;(0, \"tenthOfDegree\")), //DGV COl11\n                0, //DGV COl12\n                0) //DGV COl13\n    },\n</code></pre>\n\n<p>I'm trying to get the data from the DGV(winform) to this constructor.</p>\n\n<p>Plase help me, how can i get the datagridvalue and fill it to the constructor. </p>\n"},{"tags":["c#","c++",".net","winforms","winapi"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":81,"score":2,"question_id":13074421,"title":"C# equivalent of MessageBoxA(HWND_DESKTOP, msg, \"Alarm\", MB_OK | MB_ICONWARNING | MB_SYSTEMMODAL | MB_SETFOREGROUND);","body":"<p>I am writing an alarm program in C# that displays a system modal dialog with a user-specified message at a specified time. However, I can't seem to find the C# equivalent of</p>\n\n<pre><code>MessageBoxA(HWND_DESKTOP, msg, \"Alarm\",\n   MB_OK | MB_ICONWARNING | MB_SYSTEMMODAL | MB_SETFOREGROUND);\n</code></pre>\n\n<p><strong>Edit:</strong> I am trying to learn C# and the .NET libraries. I thought writing programs equivalent to some small programs that I have written in C or C++ would be a good place to start.</p>\n"},{"tags":["winforms","telerik-reporting"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":203,"score":1,"question_id":6311589,"title":"Telerik reporting: multiple text boxes side by side, and shrinking","body":"<p>I would like to put multiple textboxes side by side between two labels, like this:</p>\n\n<pre><code>    ([=Fields.city] [=Fields.state] [=Fields.zip])\n</code></pre>\n\n<p>and have them display like this:</p>\n\n<pre><code>      (Punxsutawney PA 15767)\n      (Concord MA 01742)\n</code></pre>\n\n<p>not like this:</p>\n\n<pre><code>      (Punxsutawney            PA 15767)\n      (Concord                 MA 01742)\n</code></pre>\n\n<p>Is this possible? I made each textbox shrinkable but that didn't do it. I also tried docking left but that didn't work either and it also treated the string literals (the parentheses) differently than the fields bound to data.</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":51,"score":-2,"question_id":13082514,"title":"Undo/redo in a graphics application","body":"<p>I would like to provide an undo/redo facility in my application. </p>\n\n<p>As an example, consider this series of invocations:</p>\n\n<pre><code>gr.Drawrectangle(pen, p1, p2);\ngr.FillEllipse(brush, p1, dx, dy);\n</code></pre>\n\n<p>I'd like to store the invocations in a list of some kind and be able to undo them. What is a good way to do this?</p>\n"},{"tags":["c#","winforms","progress-bar","backgroundworker","file-search"],"answer_count":4,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":107,"score":5,"question_id":13076209,"title":"Update progress bar while iterating file structure","body":"<p>I use this function, to search for all exe files in selected directory:</p>\n\n<pre><code>public static IEnumerable&lt;string&gt; GetFiles(string root, string searchPattern)\n{\n    Stack&lt;string&gt; pending = new Stack&lt;string&gt;();\n    pending.Push(root);\n    while (pending.Count != 0)\n    {\n        var path = pending.Pop();\n        string[] next = null;\n        try\n        {\n            next = Directory.GetFiles(path, searchPattern);\n        }\n        catch { }\n        if (next != null &amp;&amp; next.Length != 0)\n            foreach (var file in next) yield return file;\n        try\n        {\n            next = Directory.GetDirectories(path);\n            foreach (var subdir in next) pending.Push(subdir);\n        }\n        catch { }\n    }\n}\n</code></pre>\n\n<p>How can I update the progress bar status, based on the number of files found?</p>\n"},{"tags":["c#","winforms","datagridview","treeview"],"answer_count":5,"favorite_count":3,"up_vote_count":0,"down_vote_count":0,"view_count":736,"score":0,"question_id":3674591,"title":"How to make the particular row get selected in datagridview based on treeview selection","body":"<p>I will have a treenode with some nodes. I will have a datagridview on my form. Initially i will load some data in to the gridview. Now if i select a node at my trreview i would like to make a particular row as selected one.</p>\n\n<p>Suppose my treeview is as follows</p>\n\n<p>Root\n|-> Child\n |->Child1</p>\n\n<p>If i select child i would like to make a corresponding row as selected if child1 another row should get selected.</p>\n\n<p>Any idea please</p>\n"},{"tags":["winforms","events","controls","components","onload-event"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1654,"score":0,"question_id":1878189,"title":"Add a Load event for Winforms Control just as Form class","body":"<p>is there a way I can get a Load event for System.Windows.Forms.Control just like System.Windows.Forms.Form.Load?</p>\n\n<p>I want to run some initialize code before the control first shown.</p>\n\n<p>Also, it would be nice to be able to do the same for System.Windows.Forms.ToolStripStatusLabel which is not actually a Control, but works like one.</p>\n\n<p>Ideally, I can do this:\n   control.OnLoad(() => { dosomething here; });</p>\n\n<p>in which OnLoad is a extension method that would run the argument Action when the \"control\" \"Loads\".</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","winforms","listview","ado.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":58,"score":-3,"question_id":13087648,"title":"Change color line in listview","body":"<p>How change color line in listview .\nfor example <code>if line == 4</code> then <code>line is red</code></p>\n"},{"tags":[".net","vb.net","winforms"],"answer_count":2,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":2654,"score":1,"question_id":2836558,"title":"Remove Border On Focus From Button Control","body":"<p>I am setting my Winforms Button control properties to appear as a hyperlink would on a web page. I've formatted everything fine, except the border in the FlatAppearance object. I have code to act as pseudo-CSS (FormBackColor is a string constant.):</p>\n\n<pre><code>b.FlatStyle = FlatStyle.Flat\nb.BackColor = ColorTranslator.FromHtml(FormBackColor) \nb.ForeColor = Color.Blue\nb.Font = New Font(b.Font.FontFamily, b.Font.Size, FontStyle.Underline)\nb.Cursor = Cursors.Hand\n\nDim fa As FlatButtonAppearance = b.FlatAppearance\nfa.BorderSize = 0\nfa.MouseOverBackColor = b.BackColor\nfa.MouseDownBackColor = b.BackColor\n\nAddHandler b.MouseEnter, AddressOf ButtonMouseOver\nAddHandler b.MouseLeave, AddressOf ButtonMouseOut\n</code></pre>\n\n<p>Here are the mouse out/over functions as a reference to what is going on:</p>\n\n<pre><code>Public Shared Sub ButtonMouseOver(ByVal sender As Object, ByVal e As EventArgs)\n\n    Dim b As Button = DirectCast(sender, Button)\n\n    Dim fa As FlatButtonAppearance = b.FlatAppearance\n    fa.BorderSize = 1\n\nEnd Sub\n\nPublic Shared Sub ButtonMouseOut(ByVal sender As Object, ByVal e As EventArgs)\n\n    Dim b As Button = DirectCast(sender, Button)\n\n    Dim fa As FlatButtonAppearance = b.FlatAppearance\n    fa.BorderSize = 0\n\nEnd Sub\n</code></pre>\n\n<p>The code removes the border from the flat Button control except on MouseOver, where I add a 1 pixel border. On MouseLeave, I remove the border. This is to show some visual feedback. This works fine when the button does not have the focus. However, if I click on the button, giving the button focus, mousing out and over again now shows a greater than 1 pixel border around the button. I'm imagining it's combining my button's explicit 1 pixel border with the traditional \"Winform Button has the focus, so add a border\" border around the Button.</p>\n\n<p>How can I disable/remove the \"Winform Button has the focus, so add a border\" border? Or, should I just do a check in ButtonMouseOver to check if the control has the focus, being a condition of adding the border, and just be done with it? I'd prefer to remove the automatic border from focus for whatever reason :)</p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13087462,"title":"Refreshing dataGridView's DataSource from another form","body":"<p>I made an application that displays some data in a DataGridView control. The data is stored in an SQL database. Since there are a lot of parameters for this specific display, I created another (child) form in the same project that helps the user to add or alternate the data in the database. Both adding and alternating functions work fine, but the data in the DataGridView stays unchanged. I know how to refresh the DataGridView's DataSource, but I don't know how to trigger that function form another form. </p>\n\n<p>I use this function to refresh the DataGridView's DataSource:</p>\n\n<pre><code>private void RefreshMyDGV()\n{\n    command.CommandText = \"SELECT * FROM MyDataBase\";\n    SDA.SelectCommand = command;\n    SDA.Fill(myDataTable);\n    dataGridView1.DataSource = MyDataTable;\n}\n</code></pre>\n\n<p>I tried to change this function into a public static function so I would be able to access it from the other (child) form, but then the compiler throws errors \"An object reference is required for the non-static field, method, or property\".</p>\n\n<p>I also tried to define the DataGridView as public, and then access it from the other form:</p>\n\n<pre><code>((Form1)fr1).dataGridView1.DataSource = myDataTable;\n</code></pre>\n\n<p>But that didn't work either.</p>\n\n<p>Please suggest a way to do this.\nThanks.</p>\n"},{"tags":["c#","sql","winforms","visual-studio-2010"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":81,"score":2,"question_id":13087235,"title":"How can I allow users to alter the SQL connection string, when Visual Studio only allows it to be an \"Application\" setting?","body":"<p>If I could make the connection string a <code>\"User\"</code> setting for them to edit, that would do nicely for now. At the moment the string contains a reference to my machine, where my test DB sits. I want to build an alpha for somebody else to try, but they'll need to point it to their own DB instance. </p>\n\n<p>More generally, what is the correct approach to keep <code>DataSets</code> in the Visual Studio designer whilst having a connection string capable of being pointed to the configured server by the user? - at the moment they seem dependant on the Connection String in my Settings.</p>\n"},{"tags":["c#","sql-server","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":671,"score":1,"question_id":6292697,"title":"Connections to SQL Server Files (*.mdf) require SQL Server Express 2005 to function properly","body":"<p>I am trying to add new existing item .mdf database file created in SQL Server Express 2008 R2.</p>\n\n<p>When I try that i got error \"Connections to SQL Server Files (*.mdf) require SQL Server Express 2005 to function properly.\"</p>\n\n<p>What I have to do?</p>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13085416,"title":"Get items selected from another form","body":"<p><img src=\"http://i.stack.imgur.com/7T4ay.jpg\" alt=\"enter image description here\">Hi I have a Windows Form application. I have a Textbox. I want to implement a functionality like when the user clicks on the textbox, a list should be made available to the user and then the item selected from the list should be filled in the textbox. The list should not be available if some other control is focussed other than the textbox. What would be the better way to do this? Should I implement the list in the same form as the textbox or should I use another form for the list?</p>\n\n<hr>\n\n<blockquote>\n  <p>I want to implement a functionality like in the Tally Accounting\n  Software.</p>\n</blockquote>\n\n<hr>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13085498,"title":"Add a parallel node in TreeView","body":"<p>This may be very easy question but I am thinking of solution for a long while. I need to keep some condition in the <code>if</code> statement stating that the node is the parent node of all in the TreeView control. Please suggest what expression should I keep in the <code>if</code> statement.</p>\n\n<pre><code>if(Condition??)          //it is the parent node of all\n{\n   myTreeView.SelectedNode.Nodes.Add(myTreeNode);\n}\nelse\n{\n   myTreeView.SelectedNode.Parent.Nodes.Add(myTreeNode);\n}\n</code></pre>\n\n<p>In the above code I am trying to add a parallel node to the selected node which is working but when I am trying the same code (i.e., <code>myTreeView.SelectedNode.Parent.Nodes.Add(myTreeNode);</code>)  to parent node, VS was showing error.(which I know why so I am trying the above code to achieve it)</p>\n"},{"tags":["c#","winforms","button","textbox","enable-if"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13085079,"title":"c# winsform How do i enable button while there is a string in my textbox?","body":"<p>I have a textbox and a button in form2. when an item is clicked in form1, form2 appears, ill like to keep the button in form2 disabled while the textbox is empty, but when user starts type, ill like to enable the button. I have tried using an if in my constructor after the initialisecomponent() like so, but it does not work:</p>\n\n<pre><code>if(textbox1.text != \"\")\n{\n   btnOne.Enabled = true;\n}\n</code></pre>\n\n<p>I have also tried calling a method called checkText() after the initialise component which uses a dowhile loop to check like </p>\n\n<pre><code>do{\n    btnOne.Enabled = true\n  }\n while(textbox1.text != \"\");\n</code></pre>\n\n<p>can anyone help ?</p>\n"},{"tags":["vb.net","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":993,"score":0,"question_id":8043488,"title":"How do I correct . . . 'Settings' is ambiguous between declarations in Modules ... .My.CopyOfMySettingsProperty'","body":"<p>Good Day All,</p>\n\n<p>I’m new to programming. I’m using Visual Studio 2010. I’m taking into two introduction classes, VB and C# with .Net.  I have seen the enemy and he is me.  I hope that someone can please help me with my two errors.</p>\n\n<p>I do not know how I created My.CopyOfMySettingsProperty but I do know they were created when I was trying to create a project by combining my previous four projects.     </p>\n\n<p>Listed are the two errors from my error list window that I need to correct along with my offending code:</p>\n\n<pre><code>Error   1   'Settings' is ambiguous between declarations in Modules 'Assign5Multi.My.MySettingsProperty' and 'Assign5Multi.My.CopyOfMySettingsProperty'.    F:\\ProjectsVBA\\VBAssignment4Movies\\My Project\\Settings.Designer.vb  34  13  prjAssign5Multi\n\nError   2   'Settings' is ambiguous between declarations in Modules 'Assign5Multi.My.MySettingsProperty' and 'Assign5Multi.My.CopyOfMySettingsProperty'.    F:\\ProjectsVBA\\VBAssignment4Movies\\My Project\\Settings.Designer.vb      76  17  prjAssign5Multi\n</code></pre>\n\n<p>These are my Google Searchs before this  StackOverflow post, “\"Visual Studio 2010\" and \"CopyOfMySettingsProperty\"” and “\"Visual Basic\" and \"CopyOfMySettingsProperty\"” received zero results.</p>\n\n<p>From Settings.Designer.vb . . .</p>\n\n<pre><code>'------------------------------------------------------------------------------\n' &lt;auto-generated&gt;\n'     This code was generated by a tool.\n'     Runtime Version:4.0.30319.239\n'\n'     Changes to this file may cause incorrect behavior and will be lost if\n'     the code is regenerated.\n' &lt;/auto-generated&gt;\n'------------------------------------------------------------------------------\n\nOption Strict On\nOption Explicit On\n\n\nNamespace My\n\n    &lt;Global.System.Runtime.CompilerServices.CompilerGeneratedAttribute(),  _\n     Global.System.CodeDom.Compiler.GeneratedCodeAttribute(\"Microsoft.VisualStudio.Editors.SettingsDesigner.SettingsSingleFileGenerator\", \"10.0.0.0\"),  _\n     Global.System.ComponentModel.EditorBrowsableAttribute(Global.System.ComponentModel.EditorBrowsableState.Advanced)&gt;  _\n    Partial Friend NotInheritable Class MySettings\n        Inherits Global.System.Configuration.ApplicationSettingsBase\n\n        Private Shared defaultInstance As MySettings = CType(Global.System.Configuration.ApplicationSettingsBase.Synchronized(New MySettings()),MySettings)\n\n#Region \"My.Settings Auto-Save Functionality\"\n#If _MyType = \"WindowsForms\" Then\n    Private Shared addedHandler As Boolean\n\n    Private Shared addedHandlerLockObject As New Object\n\n    &lt;Global.System.Diagnostics.DebuggerNonUserCodeAttribute(), Global.System.ComponentModel.EditorBrowsableAttribute(Global.System.ComponentModel.EditorBrowsableState.Advanced)&gt; _\n    Private Shared Sub AutoSaveSettings(ByVal sender As Global.System.Object, ByVal e As Global.System.EventArgs)\n        If My.Application.SaveMySettingsOnExit Then\n            My.Settings.Save()\n        End If\n    End Sub\n#End If\n#End Region\n\n        Public Shared ReadOnly Property [Default]() As MySettings\n            Get\n\n#If _MyType = \"WindowsForms\" Then\n               If Not addedHandler Then\n                    SyncLock addedHandlerLockObject\n                        If Not addedHandler Then\n                            AddHandler My.Application.Shutdown, AddressOf AutoSaveSettings\n                            addedHandler = True\n                        End If\n                    End SyncLock\n                End If\n#End If\n                Return defaultInstance\n            End Get\n        End Property\n    End Class\n\n\n    &lt;Global.System.Runtime.CompilerServices.CompilerGeneratedAttribute(), _\n        Global.System.CodeDom.Compiler.GeneratedCodeAttribute(\"Microsoft.VisualStudio.Editors.SettingsDesigner.SettingsSingleFileGenerator\", \"10.0.0.0\"), _\n        Global.System.ComponentModel.EditorBrowsableAttribute(Global.System.ComponentModel.EditorBrowsableState.Advanced)&gt; _\n    Partial Friend NotInheritable Class CopyOfMySettings\n        Inherits Global.System.Configuration.ApplicationSettingsBase\n\n        Private Shared defaultInstance As CopyOfMySettings = CType(Global.System.Configuration.ApplicationSettingsBase.Synchronized(New CopyOfMySettings()), CopyOfMySettings)\n\n#Region \"My.Settings Auto-Save Functionality\"\n#If _MyType = \"WindowsForms\" Then\n        Private Shared addedHandler As Boolean\n\n        Private Shared addedHandlerLockObject As New Object\n\n        &lt;Global.System.Diagnostics.DebuggerNonUserCodeAttribute(), Global.System.ComponentModel.EditorBrowsableAttribute(Global.System.ComponentModel.EditorBrowsableState.Advanced)&gt; _\n        Private Shared Sub AutoSaveSettings(ByVal sender As Global.System.Object, ByVal e As Global.System.EventArgs)\n            If My.Application.SaveMySettingsOnExit Then\n                My.Settings.Save()\n            End If\n        End Sub\n#End If\n#End Region\n\n        Public Shared ReadOnly Property [Default]() As CopyOfMySettings\n            Get\n\n#If _MyType = \"WindowsForms\" Then\n                If Not addedHandler Then\n                    SyncLock addedHandlerLockObject\n                        If Not addedHandler Then\n                            AddHandler My.Application.Shutdown, AddressOf AutoSaveSettings\n                            addedHandler = True\n                        End If\n                    End SyncLock\n                End If\n#End If\n                Return defaultInstance\n            End Get\n        End Property\n    End Class\nEnd Namespace\n\nNamespace My\n\n    &lt;Global.Microsoft.VisualBasic.HideModuleNameAttribute(),  _\n     Global.System.Diagnostics.DebuggerNonUserCodeAttribute(),  _\n     Global.System.Runtime.CompilerServices.CompilerGeneratedAttribute()&gt;  _\n    Friend Module MySettingsProperty\n\n        &lt;Global.System.ComponentModel.Design.HelpKeywordAttribute(\"My.Settings\")&gt;  _\n        Friend ReadOnly Property Settings() As Global.Assign5Multi.My.MySettings\n            Get\n                Return Global.Assign5Multi.My.MySettings.Default\n            End Get\n        End Property\n    End Module\n\n\n    &lt;Global.Microsoft.VisualBasic.HideModuleNameAttribute(), _\n        Global.System.Diagnostics.DebuggerNonUserCodeAttribute(), _\n        Global.System.Runtime.CompilerServices.CompilerGeneratedAttribute()&gt; _\n    Friend Module CopyOfMySettingsProperty\n\n        &lt;Global.System.ComponentModel.Design.HelpKeywordAttribute(\"My.Settings\")&gt; _\n        Friend ReadOnly Property Settings() As Global.Assign5Multi.My.MySettings\n            Get\n                Return Global.Assign5Multi.My.MySettings.Default\n            End Get\n        End Property\n    End Module\nEnd Namespace\n</code></pre>\n"},{"tags":["c#","winforms","gdi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13068844,"title":"Hover is not working properly in windows form Drawing","body":"<p>here's my code,</p>\n\n<pre><code>        private bool isMouseOverPin(int x, int y, Pin pin)\n    {\n        int left, top, right, bottom,size;\n\n        size=5;\n\n        left = pin.theRectangle.Left-size;\n        right = pin.theRectangle.Right + size;\n        top = pin.theRectangle.Top - size;\n        bottom = pin.theRectangle.Bottom + size;\n\n        if (x &gt;= left &amp;&amp; y &gt;= top &amp;&amp; x &lt;= right &amp;&amp; y &lt;= bottom)\n        {\n            return true;\n        }\n        else\n        {\n            return false;\n        }\n    }\n\n    private void pinHover()\n    {\n        for (int i = 0; i &lt; pins.Count; i++)\n        {\n            if (isMouseOverPin(Cursor.Position.X, Cursor.Position.Y, pins[i]) == true)\n            {\n                using (Graphics gr=canvas.CreateGraphics())\n                {\n                   gr.DrawRectangle(10,10,10,10);\n                }\n            }\n        }\n    }\n\n    private void canvas_MouseMove(object sender, MouseEventArgs e)\n    {\n        pinHover();\n    }\n</code></pre>\n\n<p>i want when some one place a mouse over a pin it draws a rectangle, pin size is 5, i am unable to understand why its not working properly. help plz</p>\n"},{"tags":["c#",".net","winforms","datagridview","key"],"answer_count":6,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":302,"score":5,"question_id":6092757,"title":"How can I send a single Downkey key when my user taps the numpad Enter key?","body":"<p>This is purely for a usability request my clients have asked me. </p>\n\n<p>They work with a datagridview typing in grades for students. So they pretty much go into zombie mode and start tapping in numbers, and they've told me that it would be easier if they could tap the numpad enter key to have the next vertical select focused.</p>\n\n<p>Here's what I've tried to use:</p>\n\n<pre><code>private void dataGridView1_KeyUp(object sender, KeyEventArgs e)\n{\n    if (e.KeyCode == Keys.Enter)\n    {\n        SendKeys.Send(\"{DOWN}\");\n    }\n}\n</code></pre>\n\n<p>Unfortunately, it doesn't work as expected. Sometimes it seems to fire that key many times, causing the focus to scroll 2 or 3 or 4 cells downwards and really shaking up the users focus.</p>\n\n<p>How can I make this work and make my clients happy?</p>\n"},{"tags":["vb.net","winforms","datagridview","double-click"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":8591,"score":4,"question_id":3920339,"title":"Double-click DataGridView row?","body":"<p>I am using vb.net and DataGridView on a winform.  </p>\n\n<p>When a user double-clicks on a row I want to do something with this row. But how can I know whether user clicked on a row or just anywhere in the grid? If I use <code>DataGridView.CurrentRow</code> then if a row is selected and user clicked anywhere on the grid the current row will show the selected and not where the user clicked (which in this case would be not on a row and I would want to ignore it).</p>\n"},{"tags":["c#","winforms","webbrowser-control","backgroundworker"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":79,"score":4,"question_id":13056868,"title":"How to WebBrowser.Navigate() from BackgroundWorker?","body":"<p>The only reason I chose to use a <code>BackgroundWorker</code> for the application I am currently developing is to move the lengthy time-consuming browsing via a <code>WebBrowser</code> away from the UI thread.</p>\n\n<p>But isn't <code>WebBrowser.Navigate()</code> accessing the UI?</p>\n\n<p>In other words, I went through all this effort, only to land in the same spot (or worse! because I have no idea what side-effects could a non-UI thread have when accessing UI controls).</p>\n\n<p>I am pretty sure I am not the first one wanting to implement something like this, so my question is: What is an acceptable way to solve this problem? i.e. To <code>WebBrowser.Navigate()</code> from <code>BackgroundWorker</code>?</p>\n"},{"tags":["c#","winforms","datagridview","delete"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2647,"score":0,"question_id":6903393,"title":"delete multiple rows in datagridview","body":"<p>I have a function to delete single rows on right click delete in a datagridview..</p>\n\n<p>code:</p>\n\n<pre><code>  private void dataGridView1_MouseDown(object sender, MouseEventArgs e)\n    {\n\n            if (e.Button == MouseButtons.Right)\n            {\n                var hti = dataGridView1.HitTest(e.X, e.Y);\n                if (hti.RowIndex != -1)\n                {\n                    dataGridView1.ClearSelection();\n                    dataGridView1.Rows[hti.RowIndex].Selected = true;\n                }\n            }          \n    }\n\n    private void DeleteRow_Click(object sender, EventArgs e)\n    {\n            Int32 rowToDelete = dataGridView1.Rows.GetFirstRow(DataGridViewElementStates.Selected);\n            if (rowToDelete != -1)\n            {\n                dataGridView1.Rows.RemoveAt(rowToDelete);\n                dataGridView1.ClearSelection();\n            }          \n    }\n</code></pre>\n\n<p>but now i want to delete multiple rows on selection.. </p>\n\n<p>first i dont know why i cannot select multiple rows.. </p>\n\n<p>second i want to delete multiple delete using the delete button and right click mouse delete..</p>\n\n<p>can some1 help me... thanks</p>\n"},{"tags":["c#","winforms","click","double-click","monthcalendar"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":13059894,"title":"MonthCalendar don't have Click Event?","body":"<p>I can't find Click event(picture1) in vs2008 . but the MSDN have Click event (picture2). why?</p>\n\n<p>picure1:</p>\n\n<p><img src=\"http://i.stack.imgur.com/1WY0h.jpg\" alt=\"enter image description here\"></p>\n\n<p>picure2:\n<img src=\"http://i.stack.imgur.com/Smzx9.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["winforms","visual-studio-2010","tab-ordering"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1102,"score":2,"question_id":7718463,"title":"Control Tab Order in Visual Studio 2010","body":"<p>Is there an easy way of changing the tab order of controls on a complicated form in the Visual Studio forms designer. </p>\n\n<p>I know that I can select the Tab Order mode and it shows me all the controls with their tab index, but it is such a pain to add a new control in the middle of a complicated form and have to reselect EVERY control on the form again to set the new tab order. I often find that I have accidentally missed a control and so have to do it all over again. </p>\n\n<p>I read on MSDN that it should at least be possible to Ctrl-Click on the control previous to where I want to start the new control reordering and then click on each contol after that to set the new the tab order, but I can't get that to work. Ctrl-Clicking the previous control just sets that one to Tab Index 0 and so that becames the new first control on the whole form.</p>\n\n<p>I come from a delphi background and in delphi when editing the control tab order you get a dialog showing a list of all the controls on the form and you can select a control from the list and move it up or down the list. Much easier for a simple change like swapping tab order or adding a new control in to the middle of a form.\nPerhaps I am missing something, and it is possible to do this easily. If not available in Visual studio is there an add in that mimics the delphi functionality.</p>\n\n<p>Regards\nBrian</p>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":394,"score":0,"question_id":7933175,"title":"C# Onpaint is not firing","body":"<p>I have this code:</p>\n\n<pre><code>    private void HandleGUI()\n    {\n        if (_currentForm == null)\n        {\n            navigationSideBar1.Visible = false;\n            pnlToolbar.Visible = false;\n\n            return;\n        }\n\n        if (_currentForm.ShowNavigationBar)\n        {\n            HandleNavigationButton(_currentForm);\n        }\n\n        btnSave.Visible = _currentForm.ShowSaveButton;\n        btnClose.Visible = _currentForm.ShowCloseButton;\n        btnSave.Paint += new PaintEventHandler(btnSave_Paint);\n        navigationSideBar1.Visible = _currentForm.ShowNavigationBar;\n        pnlToolbar.Visible = _currentForm.ShowToolBar;\n\n        btnSave.Refresh();\n        btnSave.Invalidate();\n    }\n</code></pre>\n\n<p>I am registered on the onpaint event of the save button (btnSave), but this event is not fired, even when I call Refresh or Invalidate. How is this possible?</p>\n\n<p>EDIT:\nThis is how the saave button class looks like:</p>\n\n<pre><code>public class SaveButton : ButtonX\n{\n    public SaveButton()\n    {\n        this.Image = Properties.Resources.Save;\n        this.Text = \"Opslaan\";\n        this.Size = new Size(108, 39);\n\n    }\n}\n</code></pre>\n"},{"tags":["c#",".net","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2550,"score":2,"question_id":4428100,"title":"Find out the control with last focus","body":"<p>I have a c# windows forms application with several textboxes and a button. I would like to find out the textbox which has focus and do something with it. I have written following code but of course it won't work because the button will get focus as soon as it is pressed.</p>\n\n<pre><code>private void button1_MouseDown(object sender, MouseEventArgs e)\n{\n    foreach (Control t in this.Controls)\n    {\n        if (t is TextBox)\n        {\n            if (t.Focused)\n            {\n                MessageBox.Show(t.Name);\n            }\n        }\n    }\n}\n</code></pre>\n"},{"tags":[".net","winforms","gui","behavior"],"answer_count":4,"favorite_count":0,"up_vote_count":16,"down_vote_count":0,"view_count":2515,"score":16,"question_id":802722,"title":"What's the difference between Control.Select() and Control.Focus()?","body":"<p>In WinForms, to set focus to a specific control, I always seem to wind up calling <code>Control.Select()</code> <strong>and</strong> <code>Control.Focus()</code> to get it to work.</p>\n\n<p>What is the difference, and is this the correct approach?</p>\n"},{"tags":["c#","winforms","mp3","resume"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":515,"score":0,"question_id":8970106,"title":"resume a paused mp3 file in c# winforms using WMPLib.WindowsMediaPlayer","body":"<p>with WMPLib.WindowsMediaPlayer i am able to play and pause mp3 files but i am not able to resume from the paused point.</p>\n\n<p>Can anybody tell me how to resume the song</p>\n\n<p>thanks</p>\n"},{"tags":["c#",".net","winforms","localization"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":814,"score":3,"question_id":6980888,"title":"Localization at runtime","body":"<p>I have created Windows Form Program in C#.\nI have some problems with localization.\nI have resource files in 3 languages.\nI want to click each language button and change language at runtime.\nWhen i am changing language before <code>InitializeComponent()</code> it works.\nBut when i am clicking on button, it doesn't work.\ni am using this code.</p>\n\n<pre><code>private void RussianFlag_Click(object sender, EventArgs e)\n{\n    Thread.CurrentThread.CurrentUICulture = new CultureInfo(\"ru-RU\");\n}\n</code></pre>\n"},{"tags":["c#","winforms","visual-studio"],"answer_count":4,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":2595,"score":5,"question_id":6651115,"title":"Is the size of a Form in Visual Studio designer limited to screen resolution?","body":"<p>Why is it, that in the Visual Studio WinForms designer I cannot increase the size of my Form above the resolution of the screen I am currently working on? I think it should somehow be possible to develop an application aimed at higher resolutions on a lower res system. The fact that this would clip the Form during debugging should not be an issue. Is there perhaps some setting in Visual Studio for this, which I cannot seem to find?</p>\n\n<p>EDIT:\nMy main issue is that I need to be able to design a (for example) 1440x900 sized form on a laptop with a (for example) 1360x768 screen.</p>\n"},{"tags":["c++","winforms","api","winapi","dll"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13080821,"title":"C++ API DLL Project","body":"<p>I have a C++ project which uses an API that comes with DLL and LIB files, as well as a header file.\nI want to create a win32 forms project.</p>\n\n<p>My question is how do I link the project with the dll and lib files.</p>\n\n<p>But the main question is, how do I subscribe to events?\nIn the API I can call functions, which come back as on event response, which in a MFC project I would generally subscribe in the message loop. But in the Win32 there is no message loop.</p>\n\n<p>Maybe I am complicating the situation myself and it is easier than I imagine.\nPlease clarify this situation for me.</p>\n\n<p>Thank you.</p>\n"},{"tags":["winforms","visual-studio-2010","visual-studio-2012","clickonce"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":38,"score":-1,"question_id":13080037,"title":"Publishing an application in Visual Studio 2010/2012","body":"<p>I have a project built in Visual Studio 2010, with a copy of it built using Visual Studio 2012. Each time I click to publish the application and then email a zipped copy of the result(in either 2010 or 2012) I run into a problem where the application does not install at all with an error that the admin should be contacted or it installs and then a new copy of the same app does not(later on on the same machine). How do I fix this problem please? I have tried many of the suggested clickonce fixes on many threads already but I am wondering if there is a sure way to deal with this once and for all. </p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13079516,"title":"Dynamicly ADD Columns to dataGridView","body":"<p>Lets say I have over <strong>300</strong> cols in my database table, as each col after col # 3 are the same data type, Is there an efficient way to load the cols from the <code>SqlCeConnection/SqlCeDatabase</code>?</p>\n\n<pre><code>private void loadDataGridView() {\n  String CmdString = \"...... FROM MyDatabaseTable\"; //some sql to get col info\n  SqlCeCommand cmd = new SqlCeCommand(CmdString, con);\n  SqlCeDataAdapter sda = new SqlCeDataAdapter(cmd);\n  DataTable dt = new DataTable(\"mastertable\");\n  sda.Fill(dt);\n  foreach(Col col in dt) {\n    DataGridViewColumn c = new DataGridViewColumn(..); //Create the Col\n    c.DataPropertyName = col.Name; //Bind the col and property name\n    dataGridView1.Cols.Add(new dataGridViewColumn(...) ); //Add the col\n  }\n}\n</code></pre>\n"},{"tags":["c#","winforms","combobox","stackoverflow"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13079191,"title":"Stackoverflow exception from updating combobox in winforms/C#","body":"<p>I'm geting a <code>StackOverflowException</code>. Somehow, posting here seemed appropriate.</p>\n\n<p>I'm using Windows Forms in a C# application. This application is intended to run on Linux, FreeBSD and Mac-OS, so I can't use WPF, so please don't suggest it.</p>\n\n<p>My guess is that I'm missing a nuance of WinForms, but I cant seem to figure out what.</p>\n\n<p>The <code>ComboBox</code> is generated by the GUI form builder in VS 2010.</p>\n\n<p>The specific lines of code that are throwing the error are here:</p>\n\n<pre><code>if(cur_num_is_valid)\n{\n    cbx_material_num.Text = num;\n}\nelse\n{\n    num = \"0\";\n    //I only have one of the following two at a time. Both overflow\n    cbx_material_num.SelectedIndex = 0;\n    cbx_material_num.Text = \"0\";\n}\n</code></pre>\n\n<p>Since the code is somewhat complex, here's the whole function code.  'cbx_' indicates a combo box.  'txtb_' is a text box.</p>\n\n<pre><code>private void cbx_material_numobj_SelectedIndexChanged(object sender, EventArgs e)\n{\n    string obj = cbx_material_obj.Text;\n    string num = cbx_material_num.Text;\n    int selnum = 0;\n    int n = 0;\n\n    //do we need to recreate the numbers array?\n    bool cur_num_is_valid = false;\n    cbx_material_num.Items.Clear();\n    if(obj != lastobj)\n    {\n        n = m_demo.get_object_modifiers(obj);\n        for(int i = 0; i &lt;= n; i++)\n        {\n            string s = i.ToString();\n            if(s == num &amp;&amp; i &lt; n) cur_num_is_valid = true;\n            cbx_material_num.Items.Add(s);\n        }\n    }\n    if(cur_num_is_valid)\n    {\n        cbx_material_num.Text = num;\n    }\n    else\n    {\n        num = \"0\";\n        //Overflow here:\n        cbx_material_num.SelectedIndex = 0;\n    }\n\n    try\n    {\n        selnum = int.Parse(num);\n    }\n    catch(Exception)\n    {\n        MessageBox.Show(\"Error, second select menu after 'object modifiers' must be a number, not '\"+num+\"'.\");\n        cbx_material_num.Text=\"0\";\n        return;\n    }\n\n    if(selnum &gt;= n)\n    {\n        txtb_material_param1.Text = \"0\";\n        txtb_material_param2.Text = \"0\";\n        txtb_material_param3.Text = \"0\";\n        txtb_material_param4.Text = \"0\";\n    }\n    else\n    {\n        MaterialFace face;\n        MaterialParameter parameter;\n        int typeid;\n        object paramdata;\n        m_demo.get_object_modifiers_material(obj, selnum, out face, out parameter, out typeid, out paramdata);\n        cbx_material_face.Text = face.ToString();\n        cbx_material_paramtype.Text = parameter.ToString();\n        switch(typeid)\n        {\n            case 0:\n                txtb_material_param1.Text = ((float)paramdata).ToString();\n                cbx_material_datatype.Text = \"float\";\n                goto case -1;\n            case 1:\n                float[] parsf = ((float[])paramdata);\n                txtb_material_param1.Text = parsf[0].ToString();\n                txtb_material_param2.Text = parsf[1].ToString();\n                txtb_material_param3.Text = parsf[2].ToString();\n                txtb_material_param4.Text = parsf[3].ToString();\n                cbx_material_datatype.Text = \"float[]\";\n                break;\n            case 2:\n                txtb_material_param1.Text = ((int)paramdata).ToString();\n                cbx_material_datatype.Text = \"int\";\n                goto case -1;\n            case 3:\n                int[] parsi = ((int[])paramdata);\n                txtb_material_param1.Text = parsi[0].ToString();\n                txtb_material_param2.Text = parsi[1].ToString();\n                txtb_material_param3.Text = parsi[2].ToString();\n                txtb_material_param4.Text = parsi[3].ToString();\n                cbx_material_datatype.Text = \"int[]\";\n                break;\n            case -1: //can't actuall be returned, used to 'blank' the last three as '0'\n                txtb_material_param2.Text = \"0\";\n                txtb_material_param2.Text = \"0\";\n                txtb_material_param3.Text = \"0\";\n                break;\n            case 4:\n                OpenTK.Graphics.Color4 paramc = ((OpenTK.Graphics.Color4)paramdata);\n                txtb_material_param1.Text = paramc.R.ToString();\n                txtb_material_param2.Text = paramc.G.ToString();\n                txtb_material_param3.Text = paramc.B.ToString();\n                txtb_material_param4.Text = paramc.A.ToString();\n                cbx_material_datatype.Text = \"Color4\";\n                break;\n            default: //5\n                Vector4 paramv = ((Vector4)paramdata);\n                txtb_material_param1.Text = paramv.X.ToString();\n                txtb_material_param2.Text = paramv.Y.ToString();\n                txtb_material_param3.Text = paramv.Z.ToString();\n                txtb_material_param4.Text = paramv.W.ToString();\n                cbx_material_datatype.Text = \"Vector4\";\n                break;\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","winforms","diagram","windows-forms-designer"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":4,"view_count":59,"score":-2,"question_id":13078929,"title":"How to show diagrams in C# .NET","body":"<p>I'm trying to show a diagram like this in C# .NET Windows Forms Application. I have a file with 2D data and every thing is alright. I just need an API to show a graphical diagram for  the user.</p>\n\n<p><img src=\"http://upload.tehran98.com/images/qzluxti62q0xmjyizaet.jpg\" alt=\"Picture of my sample diagram\"></p>\n"},{"tags":["c#",".net","winforms","c#-4.0","datagridview"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":75,"score":3,"question_id":13064156,"title":"Displaying a list of object, containing a list in a grid view","body":"<p>I am currently working on a bookmark manager application (Windows Forms), with advanced search capabilities.</p>\n\n<p>I have created a <code>Links</code> class, and every time a user enters a URL, I'll create a Link object and store the details there. It currently has the properties <code>Name</code>, <code>URL</code> and <code>Tags</code>, where <code>Tags</code> is a list.</p>\n\n<p>At runtime when I set the <code>DataSource</code> property of a gridview to the <code>List&lt;Links&gt;</code> objects, the <code>Name</code> and the <code>URL</code> show up but the <em>tags do not</em>.</p>\n\n<p>How do I go about displaying the list of tags inside the <code>List&lt;Links&gt;</code> object in the gridview?</p>\n\n<p><strong>EDIT:</strong> Just had an idea. What if I write a function to convert the <code>List&lt;Links&gt;</code> into a <code>DataTable</code>, and then set the <code>DataSource</code> property of the <code>DataGrid</code> to the <code>DataTable</code>?</p>\n\n<p>The problem with this is that everytime a change is made to the <code>List&lt;Links&gt;</code> I will have to generate the <code>DataTable</code> again, which does not seem ideal from a performance point of view.</p>\n\n<p><strong>EDIT 2:</strong>  I wish to display each item in the list as a DataGridViewTextBox column.</p>\n\n<p>Thanks,</p>\n\n<p>Abijeet.</p>\n"},{"tags":["c#","arrays","winforms","bitmap"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13078380,"title":"dealing with bitmap as if it was an array","body":"<p>ysWell i wonder if one writes code to show a bitmap on a form. <br>\nWould it be possible to access it directly like an array in c#. <br></p>\n\n<p>I am wondering this because the bitmap is already there in memory and on screen.<br>\nBut i'm not sure on how to point to it; like it where a pointer or array so, i want to do this in c# and i also dont know the array data structure on the form (like is it RGB BGR / RGB24 etc)</p>\n\n<p>As a note this image source isnt from a file, its from a webcam.<br>\nAlso a reason i want to do this is because getpixel / putpixel is to slow for what i want.</p>\n"},{"tags":["c#","winforms","full-text-search"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1124,"score":1,"question_id":10120693,"title":"C# search text file, return all lines containing a word","body":"<p>I need help with a program i'm building at my internship.\nThe idea is to check how frequent a user logs in on any PC.\nWhen a user logs in, that information is logged in a text file, like this format.</p>\n\n<pre><code>01-01-2011 16:47:10-002481C218B0-WS3092-Chsbe (XP-D790PRO1)\n</code></pre>\n\n<p>Now i need to search the text file and (for example) search the text file for all login dates for the user Chsbe.</p>\n\n<p>My code so far:</p>\n\n<pre><code>private void btnZoek_Click(object sender, EventArgs e)\n        {\n            int counter = 0; string line;  \n            // Read the file and display it line by line. \n            System.IO.StreamReader file = new System.IO.StreamReader(\"c:\\\\log.txt\"); \n            while((line = file.ReadLine()) != null)\n            {     if ( line.Contains(txtZoek.Text) )     \n            {\n                txtResult.Text = line.ToString();                \n            }     \n\n            }  \n            file.Close(); \n        } \n</code></pre>\n\n<p>My question is, How do i return all the strings in the log containing the searchterm to txtResult?</p>\n"},{"tags":["c#","winforms","textbox","delete"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":74,"score":0,"question_id":13077010,"title":"How do I modify a textbox control so that pressing backspace deletes whole words instead of just one character at a time?","body":"<p>I would like to modify the default behavior of a regular WinForms c# textbox control so that pressing backspace deletes <strong>whole words</strong> instead of just a single character.</p>\n\n<p>Ideally I would like to have this special behavior <strong>only</strong> when the caret position is in-front of a white-space character. For example; pressing backspace one time when the caret is at \"hello world|\" should still only remove one character resulting in \"hello worl|\" - but if the caret is at \"hello world |\" when I press backspace, then the result should be \"hello |\" </p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["c#","winforms","gui","label"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":13077219,"title":"C# WinForms label will display, but not show text","body":"<p>I'm designing a GUI and I have a label which I use effectively as a 'please wait' message after I invoke an action that tends to take a while.  The label's text is static, I have set it in the properties in VS2010 for the label control.</p>\n\n<p>When I hit that action on the form, I .Show() the control which is normally hidden until the time consuming process completes, then .Hide() it.  When it hits the .Show() the label pops up (I know this because I have the BorderStyle set to Fixed3D so I see the border of the label show up) but there is no text in it whatsoever.  I have tried setting the label to autosize and not to no avail, my text is set to black on gray, so no invisible ink, everything is visible, font is set.  Code executes as I want it to throughout, theres just no text in the label.  I'm at a loss.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["c#","winforms","events","delegates"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":36,"score":-2,"question_id":13076122,"title":"New form responding to event after closed","body":"<p>I'm creating a new form in a class and I have an event handler in the form to respond to an event in the creating class. </p>\n\n<p>It doesn't seem to respond to the events at all until I close the form by pressing the X then I get all the MessageBox's I put in my forms event handler. </p>\n\n<p>Here my new form</p>\n\n<pre><code>public partial class FormPrivate : Form\n{\n    private ChatSession mySession;\n    string partnerName;\n\n    public FormPrivate(ChatSession session, string partner)\n    {\n        InitializeComponent();\n        partnerName = partner;\n        mySession = session;\n        this.ShowDialog();\n        this.Text = \"My Name: \" + mySession.Username + \" Partner Name: \" + partnerName;\n    }\n\n\n    public void RecieveMessage(object sender, PrivateChatMessageEventArgs e)\n    {\n        if (partnerName == e.Sender)\n        {\n            PrintMessage(e.Sender, e.Msg);\n        }\n    }\n\n\n    public void PrintMessage(string name, string message)\n    {\n        Action&lt;string, string&gt; printMessage = PrintMessage;\n\n        MessageBox.Show(\"Print Message: Reciever \" + mySession.Username + \" Sender \" + name + \" \" + message);\n\n        if (chatWindow.InvokeRequired)\n        {\n            MessageBox.Show(\"Invoked\");\n            this.Invoke(printMessage, new object[] { name, message });\n        }\n        else\n        {\n            MessageBox.Show(\"Not Invoked\");\n            this.chatWindow.AppendText(DateTime.Now.ToShortTimeString());\n            this.chatWindow.AppendText(\"  \" + name + \": \");\n            this.chatWindow.AppendText(message + Environment.NewLine);\n\n        }\n    }\n\n    private void sendWindow_KeyDown(object sender, KeyEventArgs e)\n    {\n        if (e.KeyCode == Keys.Enter)\n        {\n            mySession.SendPrivate(partnerName, sendWindow.Text);\n            sendWindow.Clear();\n        }\n    }\n}\n</code></pre>\n\n<p>Here where I'm creating the form</p>\n\n<pre><code>    public delegate void PrivateMessageEventHandler(object sender, PrivateChatMessageEventArgs e);\n    public event PrivateMessageEventHandler PrivateMessageRecieved;\n\n    public void RecievePrivateMessage(string sender, string msg)\n    {\n        if (!privateChatList.ContainsKey(sender))\n        {\n            privateChatList.Add(sender, new FormPrivate(this, sender));\n            PrivateMessageRecieved += privateChatList[sender].RecieveMessage;\n            SendPrivate(Username, \"\");\n        }\n\n        PrivateMessageRecieved(this, new PrivateChatMessageEventArgs(sender, msg));\n    }\n</code></pre>\n"},{"tags":["c#","wpf","winforms","image"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":13022961,"title":"Recolor region of image in C#","body":"<p>I'm working on building a diagnostic reader for my car. I can parse the messages from my OBD port but I want to create a display that is better than just a text readout. I want a graphical display of my car that will highlight the affected areas of the diagnostics. So if the tire pressure is low I want the tires on a picture of the car to turn red. I want to develop this in C# since that is what I'm the most familiar with. Any suggestions on what might be the best way to do this? It would also be nice if the method scaled with resizing the window.</p>\n\n<pre><code>&lt;Image x:Name =\"Bubble\" Height=\"445\" HorizontalAlignment=\"Left\" Margin=\"42,12,0,0\" Stretch=\"Fill\" VerticalAlignment=\"Top\" Width=\"654\" Source=\"/WpfApplication1;component/Images/bubble.png\" Panel.ZIndex=\"0\" Opacity=\"1\"/&gt;\n&lt;Image x:Name=\"Smiley\" Height=\"445\" HorizontalAlignment=\"Left\" Margin=\"42,12,0,0\" Stretch=\"Fill\" VerticalAlignment=\"Top\" Width=\"654\" Source=\"/WpfApplication1;component/Images/bubble.png\" Panel.ZIndex=\"1\" Opacity=\"0\"/&gt;\n&lt;Button Content=\"Button\" Height=\"35\" HorizontalAlignment=\"Left\" Margin=\"10,46,0,0\" Name=\"button1\" VerticalAlignment=\"Top\" Width=\"24\" Click=\"button1_Click\" /&gt;\n&lt;Button Content=\"Button\" Height=\"50\" HorizontalAlignment=\"Left\" Margin=\"14,118,0,0\" Name=\"button2\" VerticalAlignment=\"Top\" Width=\"22\" Click=\"button2_Click\" /&gt;\n</code></pre>\n\n<p>And then to change the opacity.</p>\n\n<pre><code>Bubble.Opacity = 0.0;\nSmiley.Opacity = 1.0;\n</code></pre>\n"},{"tags":["c#","winforms","visual-studio"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":49,"score":-3,"question_id":13076417,"title":"I am learning to program Windows forms apps with C# and visual studio 2010, I am past the \"hello world\" whats a good next step?","body":"<p>I am learning to program Windows forms apps with C# and visual studio 2010, I am past the \"hello world\" whats a good next step?</p>\n"},{"tags":["c#","winforms","data-binding","datagridview","tablelayoutpanel"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":206,"score":3,"question_id":12065611,"title":"Is it possible to populate a DataGridView with alternating vertical columns?","body":"<p>I need to display data that will be hybrid \"hard-coded\" strings and data from a database. Specifically, every even-numbered column contains string values that are NOT from the database, and every odd-numbered column contains data. So column 1, for example, will contain values 1 through 12 from the database, so that the first two columns look something like this (and the same pattern repeats several times):</p>\n\n<pre><code>00:00    BoundVal1\n00:15    BoundVal2\n. . .\n02:45    BoundVal12\n</code></pre>\n\n<p>Is this possible?</p>\n\n<p>Right now I'm using a TableLayoutPanel for this, but the coding for that is a little pretzly (not a Steely Dan reference).</p>\n"},{"tags":[".net","winforms","z-order"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13070325,"title":"Reversing the Z-Order of all controls on a form","body":"<p>I'm trying to make screenshots of certain forms that are open in an application. These forms may be covered/obscured by other open forms. Using CopyFromScreen isn't practical. Using <em>DrawToBitmap</em> on the form level gets me very close to where I want to be.</p>\n\n<p>One <a href=\"http://msdn.microsoft.com/en-us/library/system.windows.forms.control.drawtobitmap.aspx\" rel=\"nofollow\">issue</a> with using <em>DrawToBitmap</em> with a control is that:</p>\n\n<blockquote>\n  <p>Controls inside containers are rendered in reverse order.</p>\n</blockquote>\n\n<p><strong>Symptoms:</strong>\nForm A has Control B and Control C on it. If Control B is in front of Control C when <em>DrawToBitmap</em> is called on Form A, it will first draw Control B and then draw Control C. Since Control C is drawn over top of Control B, the resulting bitmap looks like Control C is in front of Control B.</p>\n\n<p>My current plan is to:</p>\n\n<ol>\n<li>Call <em>SuspendLayout</em></li>\n<li>Recursively reverse the Z-Order of all controls on the form</li>\n<li>Call <em>ResumeLayout</em></li>\n<li>Call <em>DrawToBitmap</em>, which will create an image showing the correct order</li>\n<li>Execute steps 1, 2, and 3 once more to put everything back the way it was before.</li>\n</ol>\n\n<p>Does that sound about right?</p>\n\n<p>I'm pretty sure I can use <em>ctrl.Parent.Controls.GetChildIndex(ctrl)</em> to get the current Z-Order index and then do a similar call with <em>SetChildIndex</em> to set it to a new value.</p>\n\n<p>Now I'm looking for code samples that might help me accomplish the re-ordering part in as efficient of a manner as possible.</p>\n"},{"tags":["c#","winforms","sql-server-ce"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1097,"score":0,"question_id":9004656,"title":"Could not load file or assembly 'System.Data.SqlServerCe, Version 3.5.0.0","body":"<p>I have application use SDF file and I use System.Data.SqlServerCe, Version 3.5.0.0 I make it copy Local = true ; after make l'app in other PC without sql compact installation I got this error </p>\n\n<blockquote>\n  <p>Could not load file or assembly 'System.Data.SqlServerCe, Version 3.5.0.0</p>\n</blockquote>\n\n<p>I tried Embed Interop Types but it not work with ce dll.</p>\n\n<p>the file existe in application directry; and I know that it read from Programme file but I have to install sql compact in any Pc I have to use application into ?</p>\n"},{"tags":["c#","arrays","winforms","visual-studio-2010","button"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13074962,"title":"c# set buttons from array to enabled true","body":"<p>My program consists of 3 static buttons created using WinForms: button1, button2 and button3. Buttons 2 and 3 are set to <code>enabled=False</code>. What I want to do is enable these 2 buttons in turn by clicking on button 1 by placing them in an array. This is my code so far but does not work. Can anyone see what I'm doing wrong?</p>\n\n<pre><code>namespace WindowsFormsApplication1\n{\n    public partial class Form1 : Form\n    {\n        Button[] btns = new Button[2];\n        //Button[] btns = { button2}\n        public Form1()\n        {\n            InitializeComponent();\n            Button[] btns = { button2, button3};\n        }\n\n        private void Form1_Load(object sender, EventArgs e)\n        {\n            button2.Enabled = false;\n            button3.Enabled = false;\n\n        }\n\n        private void button1_Click(object sender, EventArgs e)\n        {\n            for (int i = 1; i &lt; 2; i++)\n            {\n               // btns[i] = new Button();\n               //btns[i].Enabled = true;\n\n            }\n\n        }\n    }\n}\n</code></pre>\n"},{"tags":["vb.net","winforms","gdi"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12827122,"title":"Draw graphics on a form without lags?","body":"<p>Problem with my approach is that image, text or line drawn, lags by maybe 0.2 seconds, when resizing the form. So if you need an image in bottom right corner, it takes that 0.2 seconds to come in place after resize. Also, if you do heavy resizing, it starts lagging down to 1-2FPS, while the form expands on a big screen. Sample code looks like this (VB.NET):</p>\n\n<pre><code>Public Class Form1\n  Protected Overrides Sub OnPaint(e As System.Windows.Forms.PaintEventArgs)\n    MyBase.OnPaint(e)\n    Dim icon As Icon = SystemIcons.Exclamation\n    Dim imageWidth As Integer = icon.Width\n    Dim imageHeight As Integer = icon.Height\n    e.Graphics.DrawIcon(icon, Me.ClientRectangle.Right - imageWidth,\n                              Me.ClientRectangle.Bottom - imageHeight)\n  End Sub\n  Private Sub Form1_Resize(sender As Object, e As System.EventArgs) Handles Me.Resize\n    Me.Invalidate()\n  End Sub\nEnd Class\n</code></pre>\n\n<p>Is there anything that can be done to make it smoother?</p>\n"},{"tags":["c#","winforms","rtsp","vlc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13071652,"title":"Storing RTSP to a file location","body":"<p>I am able to stream an rtsp on windows 7 64 bit machine through C# Winform application. This is the library i used - <a href=\"http://vlcdotnet.codeplex.com/\" rel=\"nofollow\">VLCDotNet</a> and here is the code sample to play the RTSP stream:</p>\n\n<pre><code>LocationMedia media = new LocationMedia(@\"rtsp://192.168.137.73:554/live.sdp\");\nvlcControl1.Media = media;\nvlcControl1.Play();\n</code></pre>\n\n<p>I would like to store the streams to a file in my PC on a button click and stop the same with another button. How do i achieve this?</p>\n"},{"tags":["c#","winforms","gdi+","gdi"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":12997089,"title":"Simple MouseMove handling","body":"<p>I try to write a simple graphical editor. I have next problem, when i'm painting some curve using <code>SolidBrush()</code>, I get the interrupted one (look image). I need to get uninterrupted curve. I try to use capture of mouse for this, but it doesn't work (result the same). How I can fix it? Look code below for MouseMove event handler:</p>\n\n<pre><code>void pictureBox1_MouseMove(object sender, MouseEventArgs e)\n        {\n            if (isMouseDown)\n            {\n                pictureBox1.Capture = true; // I try to capture mouse here\n                Graphics g = Graphics.FromHwnd(this.pictureBox1.Handle);\n                g.FillRectangle(new SolidBrush(Color.Black), e.X, e.Y, 1, 1);\n            }\n        }\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/2mpuK.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":30,"score":0,"question_id":13074580,"title":"Control (or set of controls) for shopping cart item in winforms?","body":"<p>What is the best windows forms control(or set of controls) which give to user ability to select items from list of goods and select count for each item, that structure like shopping cart but i need to implement it on windows forms, how can i accomplish that using windows forms control, what is the best practise for that occasions</p>\n"},{"tags":["c#","winforms","gdi+"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":68,"score":4,"question_id":13034847,"title":"How to drag a drawn shape in Windows Forms","body":"<p>I have a program written in C#/WindowsForms that draws circles (nodes of a graph) on a Panel.\nI want to drag one circle to another place.</p>\n\n<p>I have a dictionary that goes</p>\n\n<pre><code>Dictionary NodeMap&lt;Node,Point&gt;;\n</code></pre>\n\n<p>So from this, and MouseDown event I can find out which node I am dragging.</p>\n\n<p>The problem is that currently it doesn't drag the node, just repaint it in new position, so I have to click several times to move it.</p>\n\n<p>My code for this part is:</p>\n\n<pre><code>private void pnlCanvas_MouseDown(object sender, MouseEventArgs e)\n    {\n        Node grabbedNode = new Node(\"-1\");\n\n        Point loc = e.Location;\n        loc.X = (int) (loc.X * 1000.0 / pnlCanvas.ClientSize.Width);\n        loc.Y = (int) (loc.Y * 1000.0 / pnlCanvas.ClientSize.Height);\n\n\n        foreach (var n in NodeMap)\n        {\n            if ((Math.Abs(n.Value.X - loc.X) &lt; (sldNodeSize.Value)) &amp;&amp; (Math.Abs(n.Value.Y - loc.Y) &lt; (sldNodeSize.Value)))\n            {\n                grabbedNode = n.Key;\n                break;\n            }\n        }\n\n        if (grabbedNode.Id != \"-1\")\n        {\n            NodeMap.Remove(grabbedNode);\n            NodeMap.Add(grabbedNode, loc);\n            DrawGraph((short)sldNodeSize.Value);\n        }\n    }\n</code></pre>\n\n<h2>SOLVED</h2>\n\n<p>As mentioned in comment by John Arlen, I had to move setting new location and repainting to MouseMove, leaving MouseDown only for detecting node.\nThen, with a help of global Node object, and isDraggingNode boolean variable I was able to achievie my goal. Thanks!</p>\n"},{"tags":["c#","winforms","delegates"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":38,"score":0,"question_id":13074525,"title":"Need something similar to Windows.Forms.Control.Invoke","body":"<p>I am working with a graphical framework (most similar to Windows Forms).  The framework runs in a <code>Win32</code> and <code>WinCE</code> environment that interprets C# code.  I have experience programming in Windows Forms, and I utilize <code>Windows.Forms.Control.Invoke(...)</code> quite often to call delegates, callbacks (that have object and EventArgs as parameters), and most importantly call functions across threads via delegates or callbacks.</p>\n\n<p>I currently don't see a way to perform a similar operation to Invoke within this new framework.  Is there a way to program in C# an Invoke like function?</p>\n\n<p>Does anyone have C# code that can emulate the function call Invoke that takes an EventHandler like <code>this.Invoke(new EventHandler(foo))</code> or a delelgate like <code>Foo.Invoke(foo.myDelegate, param)</code>  in order to cross threads or do async function calls in a CF .NET environment.</p>\n\n<p>Thank you for your help!</p>\n"},{"tags":["c#",".net","winforms","textbox","mouse-position"],"answer_count":3,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":107,"score":8,"question_id":13070841,"title":"How to get specific text value from a textbox based upon the mouse position","body":"<p>I have a multi-line text box that displays some values based on data it gets given, (Generally one value per line).</p>\n\n<p>(For the purpose of having a tool tip popup with some 'alternative' data) I would like to get the word (or at the very least the line) that the mouse is hovering over so I can then find what alternative to display.</p>\n\n<p>I have a few ideas of how to do this with calculations based on the text box and font sizes but I do not what to go down this road as the sizes and fonts may change frequently.</p>\n\n<p>So yeah... Is there any way of using the mouses position to grab specific text box text?</p>\n\n<p>Apologies if the question is a bit vague (So is my spec!!!), I'll provide more info if required asap.</p>\n\n<p>Thanks in advance for any help/suggestions</p>\n"},{"tags":["c#","winforms","visual-studio","tabstop"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":73,"score":2,"question_id":13069803,"title":"Tabbing in a loop through a winform","body":"<p>I have an application where I have several forms. Its a C# windows-form based application build in .NET 4.O. I have several forms where the user enters the data. There are grids where data is displayed and whole lots of controls on the form. Believe me! its a mess of so many controls. I have to setup the <code>TabIndex</code> for each control. I have literally disabled the <code>TabStop</code> property of certain controls I don't want to be tabed into it. However, still once I go through the order I want, I TAB it, and it works but once it reaches the last box then it takes 3-4 times more tabbing to get to the first field. I tried disabling the <code>TabStop</code> property for the controls I don't want. But I think there might be certain controls that I don't see but they might be included in the Tab property. \nMy question is that is there any way that I can set the <code>TabStop</code> property of all the controls on the winform to <code>false</code> and then set it to <code>true</code> for the controls I want to include only. </p>\n\n<p>I also open to if there is any other way  I can implement this? </p>\n\n<p>If further explanation is needed, let me know!</p>\n\n<p>I have attached a picture thats the order I want and then loop back but somehow its not working. Just in addition there is also two panels in the form and I have disabled their <code>TabStop</code> property to <code>False</code>.\n<img src=\"http://i.stack.imgur.com/3ahAq.png\" alt=\"enter image description here\"></p>\n"},{"tags":["vb.net","winforms","image","load"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13070960,"title":"Load Image files from folder","body":"<p>I have a <code>checked list box</code> and a <code>thumbnail area</code> to display them where I am trying to load only images from a specific folder and need to display in thumbnails area but the problem is there is a <code>thumbs.db</code> file which is also being added to the checked list box which I don't need it.</p>\n\n<p>So how do I actually load only the image files without the thumbs.db file.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Private Sub LoadProjectToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles LoadProjectToolStripMenuItem.Click\n    Using ofdlg As New Windows.Forms.OpenFileDialog\n\n        ofdlg.DefaultExt = \"trk\"\n        ofdlg.Filter = \"Project|*.trk\"\n        ofdlg.InitialDirectory = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments)\n        If ofdlg.ShowDialog = Windows.Forms.DialogResult.OK Then\n\n            Dim SaveData As New gCanvasData\n            Using objStreamReader As New StreamReader(ofdlg.FileName)\n                Dim x As New XmlSerializer(GetType(gCanvasData))\n                SaveData = CType(x.Deserialize(objStreamReader), gCanvasData)\n                objStreamReader.Close()\n            End Using\n\n            With SaveData\n                'gTSSizer_gAZoom.Value = 100\n                GCanvas1.ImageXYReset()\n                GCanvas1.Image = .Image\n                GCanvas1.gAnnotates = .gAnnotates\n                GCanvas1.RebuildAll()\n                GCanvas1.AssembleBitmap()\n            End With\n\n            Dim fullpath As String\n            fullpath = Application.StartupPath + \"\\\" &amp; System.IO.Path.GetFileNameWithoutExtension(ofdlg.FileName) + \"\\\"\n\n            For Each fi As FileInfo In New DirectoryInfo(fullpath).GetFiles\n                CheckedListBox1.Items.Add(Application.StartupPath + \"\\\" &amp; System.IO.Path.GetFullPath(ofdlg.FileName))\n                For i As Integer = 0 To CheckedListBox1.Items.Count - 1\n                    CheckedListBox1.SetItemChecked(i, True)\n                    ThumbControl1.AddFolder(fullpath, True)\n                Next i\n            Next\n        End If\n    End Using\nEnd Sub\n</code></pre>\n"},{"tags":["c#","winforms","checkedlistbox","selectedindexchanged","checklist"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":72,"score":1,"question_id":13070762,"title":"Recognize CheckedListBox item has been selected","body":"<p>I've never dealt with checkedListBox1 until now. A program that I want to make will benefit from using it rather than having to use numerous Checkboxes.</p>\n\n<p>I have the code:</p>\n\n<pre><code>private void checkedListBox1_SelectedIndexChanged(object sender, EventArgs e)\n{\n    int selected = checkedListBox1.SelectedIndex;\n    this.Text = checkedListBox1.Items[selected].ToString();\n}\n</code></pre>\n\n<p>The problem with this is that each time I click on the box and it highlights, it then selects the highlighted object. What I am looking for is it to recognize a change in what has been selected, not highlighted.</p>\n\n<p>What I'm also wanting to know is say if the first index item in CheckListBox is checked as well as the 3rd, how would I check to see if it is true or not?</p>\n\n<p>I'm certain I will eventually figure it out but seeing the code would immensely help.</p>\n\n<p>Say I have 3 boxes:\n    Box A = messageBox.Show(\"a\");\n    Box B = messageBox.Show(\"b\");\n    Box C = messageBox.Show(\"c\");</p>\n\n<p>It will only display the mbox if the box is checked.  What I want to know is how can I have it check to see if, for example, A and C is checked so that if I pressed a button, the two messageBoxes will display either \"a\" and then \"c\"</p>\n"},{"tags":["c#","winforms"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13071320,"title":"How to access parent form functions?","body":"<p>Am trying to access the parent form functions (methods). Even by using static keyword it is not working.</p>\n\n<p>The parent form is of type (MDI) and has normal child form. This is C# Application. Am trying use this way to access the methods , but no advance !</p>\n\n<pre><code>this.MdiParent\n</code></pre>\n\n<p>Please help me !</p>\n"},{"tags":["c#","winforms"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13070059,"title":"Is there a better way to check if a form is loaded?","body":"<p>I have 2 Forms in my app, <code>Form1</code> and <code>Form2</code>. I want to know if there is a\nbetter way of checking if the form has already been loaded. If the form is\nloaded in memory and visible, I want the button to do nothing, if the <code>User</code>\nhas closed the form it should re-instantiate it.</p>\n\n<p>For more info check my code or comment.. :)</p>\n\n<pre><code>public partial class Form1: Form\n{\n    private Form2 form2;\n\n    public Form1() {\n        InitializeComponent();\n    }\n\n    private void button1_Click(object sender, EventArgs e) {\n\n        if (form2== null) {\n            form2= new Form2();\n        } else {\n            if (form2.has_exited()) { // this is a private property\n                                      // that I set when Form2.Closing executes\n                form2.Dispose();\n                form2= new Form2();\n            }\n        }\n        form2.Show();\n    }\n}\n</code></pre>\n"},{"tags":["c#","winforms","combobox"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12381774,"title":"Winforms Databinding Combobox reverting on lostfocus","body":"<p>I have an Employee object that has an EmploymentStatusID (int) field.</p>\n\n<p>I have a combobox that is filled from an Employment Status enum and bound to the field in the Form_Load:</p>\n\n<pre><code>List&lt;LookupListItem&gt; EmpStatuses = new List&lt;LookupListItem&gt;();\nforeach (EmploymentStatuses m in Enum.GetValues(typeof(EmploymentStatuses)))\n{\n    EmpStatuses.Add(new LookupListItem((int)m, m.ToString()));\n}\ncboStatus.DataSource = EmpStatuses; // Enum.GetValues(typeof(CommonLibrary.Lookups.EmploymentStatuses));\ncboStatus.ValueMember = \"ItemValue\";\ncboStatus.DisplayMember = \"ItemDesc\";\ncboStatus.DataBindings.Add(\"SelectedValue\", _presenter.SelectedOfficer, \"EmploymentStatusID\");\n</code></pre>\n\n<p>When the form comes up the correct value is displayed in the combobox, but if the user changes the value, it is set back when the combobox loses focus!</p>\n\n<p>Text boxes and simple comboboxes (ie ones with a string collection) on the same form are fine.</p>\n\n<p>You can see that I originally tried just using GetValues on the enum, but I changed it to a list to see if that would help. I've tried using a BindingList, I've tried using DataSourceUpdateMode.OnValidation on the binding. I even tried using cboStatus.DataBindings[0].WriteValue on the selectedindexchanged event. No matter what I do, the value changes back to what it was when the form opened! Any ideas?</p>\n"},{"tags":["c#","winforms","exception-handling","try-catch"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13070264,"title":"Create Windows Form with Exception information on catch?","body":"<p>I'm trying to find a way to create a nice windows form that will pop up when I encounter an unhandled exception. I currently have:</p>\n\n<pre><code>// Add the event handler for handling UI thread exceptions\nApplication.ThreadException += new ThreadExceptionEventHandler(Application_ThreadException );\n\n// Add the event handler for handling non-UI thread exceptions\nAppDomain.CurrentDomain.UnhandledException += new UnhandledExceptionEventHandler( CurrentDomain_UnhandledException );\n\nstatic void CurrentDomain_UnhandledException( object sender, UnhandledExceptionEventArgs e )\n{\n    MessageBox.Show( e.ToString( ), \"Unhandled Non-UI Thread Exception\" );\n}\n\nstatic void Application_ThreadException( object sender, ThreadExceptionEventArgs e )\n{\n    MessageBox.Show( e.ToString( ), \"Unhandled UI Thread Exception\" );\n}\n</code></pre>\n\n<p>But what I'm looking for is to, in the threadexception methods, pop up a windows form with information about the error, and a continue/quit/restart whatever. This sounds very similar to something that, through gooogling, looks like its built in for certain cases, but is it possible to create some sort of modifiable / custom one that I can call?</p>\n\n<p>Sorry, I unintentionally pasted the wrong part of code. I am currently using a message box, but want a somewhat more beefed out one with some functional buttons.</p>\n\n<p>Thanks a bunch.</p>\n"},{"tags":["c#","winforms","telerik","export","telerik-grid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13063382,"title":"Export Telerik GridView to excel with borders","body":"<p>I have a Telerik radGridView1 and i am exporting it to excel, but no borders are shown in the excel file. So how to export it with borders. I am exporting in this way...</p>\n\n<pre><code>ExportToExcelML export = new ExportToExcelML(this.radGridView1);\nexport.ExportVisualSettings = true;\nexport.RunExport(saveFileDialog1.FileName);\n</code></pre>\n\n<p>Thanks in advance</p>\n"},{"tags":["winforms","visual-studio-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13067369,"title":"Add refernce and call a winform project from another project","body":"<p>I'm having 2 projects: \nP1: Winform project and\nP2: Class Library project.\nI want call a method of P1 from P2, so I do:</p>\n\n<ol>\n<li>Right click to P2</li>\n<li>Choose Add Reference</li>\n<li>Choose project P1</li>\n</ol>\n\n<p>Then in P2, I add</p>\n\n<pre><code>using P1;\n</code></pre>\n\n<p>and declare class MyP1Class of P1 in P2</p>\n\n<pre><code>public P1.MyP1Class p1class;\n</code></pre>\n\n<p>VisualStudio responses the message: </p>\n\n<blockquote>\n  <p>Error 1   Assembly generation failed -- Referenced assembly 'P1' does not have a strong name</p>\n</blockquote>\n\n<p>Hope someone can help me, any help is appreciate, thanks.</p>\n"},{"tags":["c#","winforms","fonts"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":786,"score":2,"question_id":4606552,"title":"Creating a font dialog. How can I display each font with its design?","body":"<p>Here's my code:</p>\n\n<pre><code>private void DialogFont_Load(object sender, EventArgs e)\n{\n    LoadInstalledFonts();\n}\n\nprivate void LoadInstalledFonts()\n{\n    var fontCollection = new System.Drawing.Text.InstalledFontCollection();\n    foreach (var font in fontCollection.Families)\n    {\n        lstFonts.Items.Add(font.Name);\n    }\n}\n</code></pre>\n\n<p>How can I display each font using its own design, sort of like a preview of the fonts? I'm using the ListBox control to list the fonts.</p>\n"},{"tags":["c#","winforms","vbscript","ftp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":10,"view_count":71,"score":-10,"question_id":13069992,"title":"FTP: Watch a folder","body":"<p>I want to create a utility that will \"watch a remote FTP folder and send email alerts periodically informing which files were uploaded/deleted/moved and its name and location also.  </p>\n\n<p>I need a starting point for it.</p>\n"},{"tags":["c#",".net","winforms","xmlhttprequest","webclient"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1327,"score":2,"question_id":6079282,"title":"Emulate XmlHttpRequest with a .NET WebClient","body":"<p>AFAIK with <code>XmlHttpRequest</code> I can download and upload data just with the <code>send</code> method. But <code>WebClient</code> has plenty of methods. I don't want all the functionality of a <code>WebClient</code>. I just want to create an object that emulates a <code>XmlHttpRequest</code>, except that it doesn't have XSS restrictions. I also don't care about getting the response as an XML or even as a string right now. If I can get it as an array of bytes that's good enough.</p>\n\n<p>I thought that I could use the <code>UploadData</code> as my universal method, but it fails when trying to download data with it even though it returns a response. So how can I write a method that behaves just like <code>XmlHttpRequest</code>'s <code>send</code> method?</p>\n\n<p><strong>Edit:</strong> I found an incomplete class that is precisely an <code>XmlHttpRequest</code> emulator <a href=\"http://msdn.microsoft.com/en-us/magazine/bb985675.aspx\" rel=\"nofollow\">here</a>. Too bad the whole code is lost.</p>\n"},{"tags":["c#","winforms","treeview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13068419,"title":"Grab the location of selected node of TreeView","body":"<p>This is a theoretic question so no code (sorry for that). I want to catch the position (X an Y values) of the selected node of  TreeView control when user select that particular node. I browsed the intellisense but there are no tags like \"Location\" or \"Position\". How to achieve this? Actually I am trying to add dynamic buttons and textBox beside the selected node, so I need the position of the node.</p>\n\n<p>Please Help.</p>\n"},{"tags":["c#","winforms","winapi","hook","setwindowshookex"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13067417,"title":"Is it possible to implement a Windows hook on a specific Window only?","body":"<p>Seems like when I create the hook it automatically links to <strong>ALL</strong> the Windows in my application, I only need it to hook to Window1.</p>\n\n<p>The result must be that when you hover the mouse over the created forms it must only change the <code>ActiveForm.Text</code> when the user hovers over Window1.</p>\n\n<p><img src=\"http://i.stack.imgur.com/u17zH.jpg\" alt=\"enter image description here\"> </p>\n\n<pre><code>public delegate int HookProc(int nCode, IntPtr wParam, IntPtr lParam);\nstatic int hHook = 0;\npublic const int WH_MOUSE = 7;\nHookProc MouseHookProcedure;\n\n[DllImport(\"user32.dll\")]\npublic static extern IntPtr FindWindow(String sClassName, String sAppName);\n\n\n[DllImport(\"user32.dll\", SetLastError = true)]\nstatic extern uint GetWindowThreadProcessId(IntPtr hWnd, IntPtr ProcessId);\n\n\n[DllImport(\"user32.dll\", CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall)]\npublic static extern int SetWindowsHookEx(int idHook, HookProc lpfn, IntPtr hInstance, int threadId);\n\n\n[DllImport(\"user32.dll\", CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall)]\npublic static extern bool UnhookWindowsHookEx(int idHook);\n\n\n[DllImport(\"user32.dll\", CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall)]\npublic static extern int CallNextHookEx(int idHook, int nCode, IntPtr wParam, IntPtr lParam);\n\n\n[StructLayout(LayoutKind.Sequential)]\npublic class POINT\n{\n    public int x;\n    public int y;\n}\n\n[StructLayout(LayoutKind.Sequential)]\npublic class MouseHookStruct\n{\n    public POINT pt;\n    public int hwnd;\n    public int wHitTestCode;\n    public int dwExtraInfo;\n}\n\npublic void Start(string windowTitle)\n{\n    if (hHook == 0 &amp; windowTitle == \"Window1\")\n    {\n        this.lblWindowType.Text = \"Parent\";\n        MouseHookProcedure = new HookProc(MouseHookProc);\n        IntPtr wordWindow = FindWindow(null, windowTitle);\n        var threadId = GetWindowThreadProcessId(wordWindow, IntPtr.Zero);\n\n        hHook = SetWindowsHookEx(WH_MOUSE, MouseHookProcedure, IntPtr.Zero, unchecked((int)threadId));\n    }\n}\n\npublic static int MouseHookProc(int nCode, IntPtr wParam, IntPtr lParam)\n{\n    MouseHookStruct hook = (MouseHookStruct)Marshal.PtrToStructure(lParam, typeof(MouseHookStruct));\n    ActiveForm.Text =\n        String.Format(\"{0},{1}\", hook.pt.x.ToString(), hook.pt.y.ToString());\n\n    if (nCode &lt; 0)\n    {\n        return CallNextHookEx(hHook, nCode, wParam, lParam);\n    }\n    else\n    {\n        return CallNextHookEx(hHook, nCode, wParam, lParam);\n    }\n}\n\nprivate void Window1_Load(object sender, EventArgs e)\n{\n    Start(this.Text);\n}\n\nprivate void btnAddWindow_Click(object sender, EventArgs e)\n{\n    Window1 win = new Window1();\n    win.Text = \"Window2\";\n    win.lblWindowType.Text = \"Child\";\n    win.Show();\n}\n</code></pre>\n"},{"tags":["c#","winforms","settings"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13068500,"title":"Need Help Adding Custom Class To Application Settings","body":"<p>I am attempting to use the built in application settings to store a user context (i.e. currently logged in user) to my Winform application.  However, when I right-click on my project, click on properties, and then click browse for the type, the classes in my project are not an option.  I have two other projects in my solution and the classes in those projects are available.  Can anyone tell me why the classes in my project are not available to add to the application properties?  I guess that I could create another project to manage the user context but, our security is very simple and I'd prefer not to do that.  Also, I know that I could use dependency inject to pass the user context object around but, again this is a very simple security model that just needs to know which user is logged in so that transactions and audit trails can be properly recorded.  Thanks in advance.</p>\n\n<p>BTW, I just created a new project and made sure that my project has a dependency on it.  Then, I checked to see if the classes that I added to it were available types in the application settings and they were not.  There has to be something simple that I am missing since the classes in my other projects are available to store as application properties.</p>\n"},{"tags":[".net","vb.net","winforms","datagridviewcomboboxcell"],"answer_count":0,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":78,"score":4,"question_id":13058320,"title":"DataGridViewComboBoxColumn text values not updating (integers do)","body":"<p>my first post, as I can't find the answer to this out there.</p>\n\n<p>I have a data bound gridview with a bunch of comboboxes.  They correctly display the value from the underlying table, and the correct values appear in the drop down lists.  1 of the comboboxes has an int .valuemember, and everything works great for it.  The other combobox has string .valuemember, and when I select a different value in the combobox it does not update to the bound table.  </p>\n\n<p>They are bound and updated with the same code from the same table and the same grid.  I am specifically binding to a ESRI ArcGIS file.  It seems to be correctly bound, and I have used it for other projects successfully.  It does again display and update changes in all columns, and will accept changes to integer based rows; therefore I have, maybe stupidly, ruled this out.</p>\n\n<p>Not sure what I need to do to make string .valuemember value to update.  </p>\n\n<p>I am missing something simple I guess but I don't know what it is.  Here is some sample code. </p>\n\n<pre><code>Domain1 As BindingList(Of Domaintype)\nDomain2 As BindingList(Of Domaintype)\nGridView.DataSource = pBindingSource\n\n'add the columns desired\n    GridView.Columns.Add(CreateComboBoxColumn(\"Column1Value\", \"Type1\", Domain1 , \"NonCodedIntValue\"))\n    GridView.Columns.Add(CreateComboBoxColumn(\"Column2Value\", \"Type2\", Domain2 , \"NonCodedCharValue\"))\n\nPrivate Function CreateComboBoxColumn(ByVal ColumnName As String, ByVal AliasName As String, ByRef DomainName As BindingList(Of Domaintype), ByVal pValueMember As String) As DataGridViewComboBoxColumn\n    CreateComboBoxColumn = New DataGridViewComboBoxColumn\n    With CreateComboBoxColumn\n        .DataPropertyName = ColumnName\n        .HeaderText = AliasName\n        .ReadOnly = False\n    End With\n    With CreateComboBoxColumn\n        .DataSource = DomainName\n        .DisplayMember = \"CodedValue\"\n        .ValueMember = pValueMember\n    End With\n    Return CreateComboBoxColumn\nEnd Function\n\nPrivate Sub GridView_CurrentCellDirtyStateChanged(ByVal sender As Object, ByVal e As EventArgs) Handles GridView.CurrentCellDirtyStateChanged\n    If GridView.IsCurrentCellDirty Then\n        GridView.CommitEdit(DataGridViewDataErrorContexts.Commit)\n    End If\nEnd Sub\n\nPublic Class Domaintype\nPrivate CodedValue As String\nPrivate NonCodedInt As Nullable(Of Short)\nPrivate NonCodedChar As String\n\n'adds a new coded value based on a sent non-coded and coded value\nPublic Sub New(ByVal SentCodedValue As String, ByVal SentNonCoded As Nullable(Of Short), Optional ByVal SentNonCodedChar As String = Nothing)\n\n    CodedValue = SentCodedValue\n    NonCodedInt = SentNonCoded\n    NonCodedChar = SentNonCodedChar\nEnd Sub\n'Gets or sets the coded value of a domain\nPublic ReadOnly Property CodedValue() As String\n    Get\n        Return CodedValue\n    End Get\nEnd Property\n'gets or sets the non-coded value of a domain\nPublic ReadOnly Property NonCodedIntValue() As Nullable(Of Short)\n    Get\n        Return NonCodedInt\n    End Get\nEnd Property\n\n'gets or sets the non-coded value of a domain\nPublic ReadOnly Property NonCodedCharValue() As String\n    Get\n        Return NonCodedChar\n    End Get\nEnd Property\nEnd Class\n</code></pre>\n\n<p>Any thoughts or help are greatly appreciated.  </p>\n\n<p>Richard</p>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13051604,"title":"Stopwatch and resetting time after button click","body":"<p>I am currently learning how to work with the stopwatch attribute in C#. I have a <code>button1</code> that starts the stopwatch. I would like to reset the time to 0 and start over again after the second click and so forth on. How would I be able to reset stopwatch timer after each consecutive button click?  </p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>namespace stopwatch\n{\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();    \n        }\n\n        Stopwatch sw = new Stopwatch();\n\n        private void button1_Click(object sender, EventArgs e)\n        { \n            sw.Start();   \n            TimeSpan x = sw.Elapsed;\n            textBox1.Text = x.ToString();                   \n        }                \n    }\n}\n</code></pre>\n"},{"tags":["c#","asp.net","winforms","authentication","web-config"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13068766,"title":"Strange Forbidden Access error after publish","body":"<p>I get :</p>\n\n<p><img src=\"http://i.stack.imgur.com/rPBHl.png\" alt=\"enter image description here\"></p>\n\n<p>after I publish my website to the IIS server, straight after I press the login button with correct credentials. It works fine on my local machine and is supposed to transfer me to the <code>ControlPanel.aspx</code> page.</p>\n\n<p>Login button code :</p>\n\n<pre><code>    protected void BtnSubmitClick(object sender, EventArgs e)\n    {\n        using (var db = new DbContext())\n        {\n            if (db.Users.Any(x =&gt; x.Username == txtUserName.Text &amp;&amp; x.Password == txtPassword.Text))\n            {\n                FormsAuthentication.RedirectFromLoginPage(txtUserName.Text, true);\n            }\n            else\n            {\n                ClientScript.RegisterStartupScript(GetType(), \"myalert\", \"alert('* invalid credentials, please try again');\", true);\n            }\n        }\n    }\n</code></pre>\n\n<p>I thought it may have something to do with the web.config :</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;!--\n  For more information on how to configure your ASP.NET application, please visit\n  http://go.microsoft.com/fwlink/?LinkId=169433\n  --&gt;\n&lt;configuration&gt;\n  &lt;location path=\"Default.aspx\"&gt;\n    &lt;system.web&gt;\n      &lt;authorization&gt;\n        &lt;allow users=\"?\" /&gt;\n      &lt;/authorization&gt;\n    &lt;/system.web&gt;\n  &lt;/location&gt;\n  &lt;location path=\"Login.aspx\"&gt;\n    &lt;system.web&gt;\n      &lt;authorization&gt;\n        &lt;allow users=\"?\" /&gt;\n      &lt;/authorization&gt;\n    &lt;/system.web&gt;\n  &lt;/location&gt;\n  &lt;location path=\"Styles\"&gt;\n    &lt;system.web&gt;\n      &lt;authorization&gt;\n        &lt;allow users=\"?\" /&gt;\n      &lt;/authorization&gt;\n    &lt;/system.web&gt;\n  &lt;/location&gt;\n  &lt;location path=\"ControlPanel.aspx\"&gt;\n    &lt;system.web&gt;\n      &lt;authorization&gt;\n        &lt;allow users=\"*\" /&gt;\n      &lt;/authorization&gt;\n    &lt;/system.web&gt;\n  &lt;/location&gt;\n  &lt;location path=\"Options.aspx\"&gt;\n    &lt;system.web&gt;\n      &lt;authorization&gt;\n        &lt;allow users=\"*\" /&gt;\n      &lt;/authorization&gt;\n    &lt;/system.web&gt;\n  &lt;/location&gt;\n  &lt;system.web&gt;\n    &lt;authorization&gt;\n      &lt;deny users=\"?\" /&gt;\n    &lt;/authorization&gt;\n    &lt;authentication mode=\"Forms\"&gt;\n      &lt;forms loginUrl=\"Login.aspx\" defaultUrl=\"ControlPanel.aspx\" /&gt;\n    &lt;/authentication&gt;\n    &lt;compilation debug=\"true\" targetFramework=\"4.0\"&gt;\n      &lt;assemblies&gt;\n        &lt;add assembly=\"System.Data.Entity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" /&gt;\n      &lt;/assemblies&gt;\n    &lt;/compilation&gt;\n    &lt;customErrors mode=\"Off\"&gt;&lt;/customErrors&gt;\n  &lt;/system.web&gt;\n  &lt;connectionStrings&gt;\n    &lt;add name=\"DbContext\" connectionString=\"metadata=res://*/db.csdl|res://*/db.ssdl|res://*/db.msl;provider=System.Data.SqlClient;provider connection string=&amp;quot;data source=192.168.***\\SQLEXPRESS;initial catalog=Portal;persist security info=True;user id=sa;password=****;multipleactiveresultsets=True;App=EntityFramework&amp;quot;\" providerName=\"System.Data.EntityClient\" /&gt;\n  &lt;/connectionStrings&gt;\n&lt;/configuration&gt;\n</code></pre>\n"},{"tags":["c#","winforms","drop-down-menu","switch-statement"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":13064675,"title":"C# setting the display value of a dropdownlist","body":"<p>i wish to set the default value of a dropdown list depending on what appears in my table row. i have written the switch statement below but does not seem to do the job. can anyone help ?</p>\n\n<pre><code>bool viewNull = this._Row.Isxcs_ViewNull();\nif (!viewNull)\n{\n    switch (this._Row.xcs_View.ToUpper())\n    {\n        case \"RC\": this.drpdwnChaseSecSelection.SelectedValue = \"Renewals Chasing\"; break;\n        case \"D_RL\": this.drpdwnChaseSecSelection.SelectedValue = \"Deal - Lettings\"; break;\n        case \"NULL\": this.drpdwnChaseSecSelection.SelectedValue = \"None\"; break;\n    }\n}\nelse\n{\n    drpdwnChaseSecSelection.SelectedValue = \"None\";\n}\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13064392,"title":"Missmatched HandleDestroyed and HandleCreated","body":"<p>In my C# project I have a static class that keeps track of some text boxes. The text boxes need to be removed from the list to prevent memory leaks.\nIn my class I have a static function to add a text box to the list as</p>\n\n<pre><code>public static void Add(TextBox tb)\n{\n    tb.HandleCreated += new EventHandler(TextBoxHandleCreated);\n}\n\nstatic void TextBoxHandleCreated(object sender, EventArgs e)\n{\n     TextBox tb = sender as TextBox;\n     tb.HandleDestroyed += new EventHandler(OnHandleDestroyed);\n\n     tbList.Add(tb);\n}\n\nstatic void OnHandleDestroyed(object sender, EventArgs e)\n{\n    // Remove it\n    Remove(sender as Control);\n}\n</code></pre>\n\n<p>Now the problem is that when my dialog is shown and then destroyed I expect the created and destroyed to match, but that is not the case. I get a few more create than I get destroy. Why is that so?</p>\n\n<p>I call the add function from the constructor of a usercontrol on my form. In the remove function I call <code>c.HandleDestroyed -= OnHandleDestroyed;</code> so I don't keep the control alive for that reason.</p>\n\n<p>The Remove function is a simple loop to check and remove as</p>\n\n<pre><code>`public static void Remove(Control c)\n{\n    foreach (Control cl in cList)\n    {\n        if (c.Equals(cl))\n        {\n            c.HandleDestroyed -= OnHandleDestroyed;\n            cList.Remove(cl);\n            //break;\n        }\n    }\n}`\n</code></pre>\n"},{"tags":["winforms","datagridview","visual-studio-2005","c#-2.0"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13067398,"title":"change specific column header color only in datagridview","body":"<p>Uses: VS 2005, C#, DataGridView, WinForms;</p>\n\n<p>I need to color the font/background of a particular column's Header portion. I see that it can only be done to the entire column list's header instead of a single column. Any help greatly appreciated.</p>\n"},{"tags":["c#",".net","winforms","datagridview"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":54,"score":3,"question_id":13066246,"title":"DataGridview search: show only searchresult and hide other rows?","body":"<p>What should I add to my code to only show the results of my search?</p>\n\n<p>Right now when I search the searchresult becomes selected (highlighted) and the others remain the same.</p>\n\n<p>Been trying to hide the other rows but without any success (and only show the searchresult, alone). Any suggestions?\nIm using a datagridview.</p>\n\n<p>My code: </p>\n\n<pre><code>private void button3_Click_1(object sender, EventArgs e)\n{\n    string search = textBox1.Text;\n\n    for (int i = 0; i &lt; dgTest.Rows.Count; i++)\n    {\n        if (dgTest.Rows[i].Cells[0].Value.ToString() == search)\n        {\n            dgTest.Rows[i].Selected = true;\n            break;\n        }\n        else\n        {\n            dgTest.Rows[i].Selected = false;\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#",".net","winforms","backgroundworker"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":68,"score":4,"question_id":13066306,"title":"Only 1 of 2 progress bars gets updated in BackgroundWorker","body":"<p>I have a simple form with 2 progressbars and 1 backgroundworker on it.  I have 2 loops (one within the other) and I'd like to report back the progress of each loop once incremented.  Here's the code I have:</p>\n\n<pre><code>    private void buttonStart_Click(object sender, EventArgs e)\n    {\n        workerCustomers.RunWorkerAsync();\n    }\n\n    private void workerCustomers_ProgressChanged(object sender, ProgressChangedEventArgs e)\n    {\n        progressBar1.Value = e.ProgressPercentage;\n        progressBar2.Value = (int)e.UserState;\n    }\n\n    private void workerCustomers_DoWork(object sender, DoWorkEventArgs e)\n    {\n        for (int customer = 0; customer &lt; 50; customer++)\n        {\n            int customerPercentage = ++customer * 100 / 50;\n\n            workerCustomers.ReportProgress(customerPercentage, 0);\n\n            for (int location = 0; location &lt; 500; location++)\n            {\n                int locationPercentage = ++location * 100 / 500;\n                workerCustomers.ReportProgress(customerPercentage, locationPercentage);\n            }\n\n            workerCustomers.ReportProgress(customerPercentage, 0);\n        }\n    }\n</code></pre>\n\n<p>When the program runs, progressbar1 gets updated just fine, but progressbar2 never moves.  If I run it through the debugger, I can see the value of progressbar2 being changed, there's just no change graphically.  Any ideas?</p>\n"},{"tags":["c#","winforms","anchor","dock"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13066917,"title":"How to Anchor\\Dock Labels and resize photos without using properties?","body":"<p>I've created a Form and set the WindowState value to Maximized.</p>\n\n<p>The Form filled with photo and labels.\nAt RunTime the window Form is in full size BUT I'm having problems:</p>\n\n<ol>\n<li>resizing the photo as the size of the form. (i don't care if the photo will stretch)</li>\n<li>anchoring\\docking the labels at their place they used to be at compileTime.</li>\n</ol>\n\n<p>I've tried using the properties: anchor, autoSize, dock, imageAlign, Location, textAlign\nNothing workes..</p>\n\n<p>Any suggestions, Please?</p>\n\n<p>Thanks in advanced!</p>\n"},{"tags":["c#","winforms","visual-studio-2008","pleasewait"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1002,"score":1,"question_id":3760496,"title":"How to create a Loading Window?","body":"<p>Ok, in my app there are times when loading the DataGridView can take a minute or two.  What I want to do is show a <a href=\"http://www.pozzware.com/images/edit/wait.gif\" rel=\"nofollow\">GIF</a> in a form  with no border until it reaches the end of the loading function.  However, if I do:</p>\n\n<pre><code>Views.Loading ldw = new Views.Loading();\nldw.Show();\n...\nldw.Close();\n</code></pre>\n\n<p>...it never actually draws it to the screen and I can't see it.  If I do ShowDialog(), it shows the window but never gets past that line of code.  I have a feeling it's because it's not a background worker or because the focus gets set back to the parent because of processing...I don't know.</p>\n\n<p>My form is a blank form, added a picture box, added a gif to the picture box, and made FormBorderStyle = none.  Any and all help is appreciated.</p>\n\n<p><b>Update: Current (non-working) Code</b><br></p>\n\n<pre><code>        private void InitializeBackgroundWorker()\n        {\n            //Defines the DoWork Event Handler for _backgroundWorker.\n            _bgWorkerReports.DoWork += new DoWorkEventHandler(bgWorkerReports_DoWork);\n            //Defines the RunWorkCompleted Event Handler for _backgroundWorker.\n            _bgWorkerReports.RunWorkerCompleted += new RunWorkerCompletedEventHandler(bgWorkerReports_RunWorkerCompleted);\n        }\n\n        private void bgWorkerReports_DoWork(object sender, DoWorkEventArgs e)\n        {\n            ldw.Show();\n            try\n            {                   \n                string strFilter = \"\";\n\n                if (!_strSearchFilter.Equals(\"\"))\n                {\n                    strFilter += strFilter.Equals(\"\") ? \" \" + _strSearchFilter : \"  and \" + _strSearchFilter;\n                }\n\n                if (tvFigure.Nodes.Count &gt; 0)\n                {\n                    if (_strFigureFilter == \"ALL\")\n                    {\n                        strFilter += \" \" + Constants.GetColumnName(\"Figure\") + \" LIKE '%%' \";\n                    }\n                    else if (!_strFigureFilter.Equals(\"\") &amp;&amp; !_strFigureFilter.Equals(tvFigure.TopNode.Name))\n                    {\n                        if (_strSearchFilter.Equals(\"\") || !cbCurrentFigure.Checked)\n                        {\n                            strFilter += strFilter.Equals(\"\") ? \" \" + Constants.GetColumnName(\"Figure\") + \"='\" + _strFigureFilter + \"'\" : \" and \" + Constants.GetColumnName(\"Figure\") + \"='\" + _strFigureFilter + \"'\";\n                        }\n                    }\n                }\n\n                if (!_strIndentureFilter.Equals(\"\"))\n                {\n                    strFilter += strFilter.Equals(\"\") ? \" \" + _strIndentureFilter : \"  and \" + _strIndentureFilter;\n                }\n\n                if (!_strReportFilter.Equals(\"\"))\n                {\n                    strFilter += (!strFilter.Equals(\"\") ? \" and\" : \"\") + \" part_id in (\" + _strReportFilter + \")\";\n                }\n\n                if (strFilter.Length &gt; 0)\n                {\n                    BindingSource bSource = new BindingSource();\n                    bSource.DataSource = _dataController.PopulateDataGrid(_nViewMode, strFilter).Tables[0];\n\n                    //Set DataSource to bindingSource for DataGridView.\n                    if (_lstValidationResults.Count &gt; 0)\n                    {\n                        dgvParts.DataSource = _lstValidationResults;\n                        foreach (DataGridViewColumn dc in dgvParts.Columns)\n                        {\n                            dc.DataPropertyName = \"ErrorMessage\";\n                            dc.Visible = true;\n                            dc.SortMode = DataGridViewColumnSortMode.Programmatic;\n                            dc.AutoSizeMode = DataGridViewAutoSizeColumnMode.ColumnHeader;\n                        }\n                        dgvParts.AutoResizeColumns();\n                        return;\n                    }\n                    else if (!string.IsNullOrEmpty(_strFigureFilter))\n                    {\n                        dgvParts.DataSource = bSource;\n                        dgvParts.Columns[0].Visible = false;\n                        dgvParts.Columns[\"Description\"].Resizable = DataGridViewTriState.False;\n                        dgvParts.Columns[\"Description\"].Width = 750;\n                    }\n\n                    // Automatically resize the visible rows.\n                    foreach (DataGridViewColumn col in dgvParts.Columns)\n                    {\n                        col.SortMode = DataGridViewColumnSortMode.Automatic;\n                        if (col.Name != \"Description\")\n                        {\n                            dgvParts.AutoResizeColumn(col.Index);\n                        }\n                    }\n                    dgvParts.AutoSizeRowsMode = DataGridViewAutoSizeRowsMode.DisplayedCells;\n\n                    // Hide the ToolTips for all the cells - redisplay if there is a report.\n                    dgvParts.ShowCellToolTips = true;\n\n                    // Set the dataGridView control's border.\n                    dgvParts.BorderStyle = BorderStyle.Fixed3D;\n\n                    // Get and set the ipb_number to the label.\n                    string ipb_number = _dataController.IPBNumber;\n                }\n            }\n            catch (Exception ex)\n            {\n                MessageBox.Show(ex.Message);\n            }\n        }\n\n        private void bgWorkerReports_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)\n        {\n            ldw.Close();\n            this.Cursor = Cursors.Default; //Throws error (Cross-thread)\n\n            FormatCells();\n            BuildColumnsComboBox();\n\n            int nTotalCount = 0;\n\n            foreach (ListViewItem lvi in listView1.Items)\n            {\n                int nCount = _lstReportRecords.Where(rr =&gt; lvi.Text.Contains(rr.Description)).Count();\n                nTotalCount += nCount;\n                lvi.Text = (lvi.Text.Contains(\"(\") ? lvi.Text.Substring(0, lvi.Text.IndexOf(\"(\") + 1) : lvi.Text.Trim() + \" (\") + nCount.ToString() + \")\";\n            }\n\n            rbAllReports.Text = (rbAllReports.Text.Contains(\"(\") ? rbAllReports.Text.Substring(0, rbAllReports.Text.IndexOf(\"(\") + 1) : rbAllReports.Text + \" (\") + nTotalCount.ToString() + \")\";\n            int nTaggedCount = _lstReportRecords.Where(rr =&gt; rr.Description.Contains(\"Tagged\")).Count();\n            rbTaggedRecords.Text = (rbTaggedRecords.Text.Contains(\"(\") ? rbTaggedRecords.Text.Substring(0, rbTaggedRecords.Text.IndexOf(\"(\") + 1) : rbTaggedRecords.Text + \" (\") + nTaggedCount.ToString() + \")\";\n        }\n</code></pre>\n"},{"tags":["c#",".net","winforms"],"answer_count":7,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":3090,"score":3,"question_id":4128886,"title":"c# loop through combobox where datasource is a datatable with text","body":"<p>Is it possible to run through every item in a combobox using a <code>foreach</code> loop? How would I do it?</p>\n\n<p>The thing is I have a <code>System.Data.DataRowView</code> there because the combobox is attached to a <code>DataTable</code>. How do I convert from that to <code>string</code>?</p>\n"},{"tags":["c#","winforms","servicehost"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13063693,"title":"Increase the maxRequestLength/executionTimeout of a ServiceHost in C#","body":"<p>I have a winForms application running on a server and I access it from another application via a Service which is running over a <code>ServiceHost</code>.</p>\n\n<p>The problem is, when the data which the client wants to get from the <code>ServiceHost</code> is to big I get a exception like:</p>\n\n<blockquote>\n  <p>Error while receiving, the reason could be not using a http-protocol.</p>\n</blockquote>\n\n<p>How can I solve this? Would this be a web application I simply would increase the maxRequestLength/executionTimeout in the web.config. but there is no web.config in a winforms project.</p>\n\n<p>EDIT: here is some code:</p>\n\n<pre><code>Service s = new Service(this.foo);\nServiceHost host = new ServiceHost(s, baseAddress);\nhost.AddServiceEndpoint(typeof(IService), new BasicHttpBinding(), \"\");\nhost.Open();\n</code></pre>\n"},{"tags":["c#","winforms","sql-server-ce"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13064441,"title":"Permission denied for SQL Server CE on Win XP","body":"<p>I am getting a <code>\"Permission denied\"</code> exception when I connect to a <code>.sdf</code> file.</p>\n\n<p>I am using this connection string.</p>\n\n<pre><code>connection string=&amp;quot;Data Source=|DataDirectory|\\DB.sdf;Password='something';Mode = Read Only;Temp Path= Environment.GetFolderPath(Environment.SpecialFolder.Templates);Persist Security Info=True&amp;quot;\" providerName=\"System.Data.EntityClient\" /&gt;\n</code></pre>\n\n<p>This is work fine on Win 7 but when I run my app on Win XP it returns</p>\n\n<blockquote>\n  <p><em>Permission denied</em></p>\n</blockquote>\n\n<p>exception</p>\n\n<p>I tried different address for temp file but it still failed.</p>\n"},{"tags":["c#","winforms","wordpress","treeview","xml-rpc"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":133,"score":0,"question_id":9183109,"title":"How to add child nodes to parent using TreeView","body":"<p>How can I add child nodes to a parent node, using a TreeView?\nI can Add Parent with this code.</p>\n\n<pre><code> WordPressWrapper ww = new WordPressWrapper(textBox2.Text, textBox3.Text, textBox4.Text);\n                var cat = ww.GetCategories();\n                for (int i = 0; i &lt; cat.Count; i++)\n                {\n                    if (cat[i].parentId == \"0\")\n                    {\n                        TreeNode tn = new TreeNode(cat[i].categoryName);\n                        tn.ForeColor = Color.Blue;\n                        tvCat.Nodes.Add(tn);\n</code></pre>\n\n<p>this is working good . (i have not any problem for add parent) . for add child i writhe this code .    </p>\n\n<pre><code>for (int i = 0; i &lt; cat.Count; i++)\n                {\n                    if (cat[i].parentId != \"0\")\n                    {\n                        for (int j = 0; j &lt; cat.Count; j++)\n                        {\n                            if (cat[i].parentId == cat[j].categoryId)\n                            {\n                                tvCat.Nodes[i].Nodes.Add(cat[j].categoryName);\n                            }\n                        }\n                    }\n              }\n</code></pre>\n\n<p>but i catch error (Specified argument was out of the range of valid values.parameter name: index) .how i can solve it ?</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13052249,"title":"Sorting Methods and Write results to textFile","body":"<p>I am working with sorting methods and random.  <code>Button1</code> Creates the parameter randomize numbers, size, and the maximum number limit to work from. Then according to what linear method is chosen, <code>Button2</code> Sorts those numbers and then uses a stopwatch to time how long it took.  I am currently implementing away to show : <code>sort method</code>, <code>size</code>, <code>time_tosort</code> and <code>number of operations</code>  in a text file. So I have the first part done, when program loads I have prompted the user to create a file for where the results will be stored.  </p>\n\n<p>What ways can I go about appending the results into the textFile and averaging the results ? Also would I need to add a button to close the write function after user finishes sorting?</p>\n\n<p><strong>Example of desired format:</strong>  <code>sort method</code>, <code>size</code>, <code>time_tosort</code> and <code>number of operations</code></p>\n\n<pre><code>Linear 10000 .9 100,000,000\nLinear 10000 .8 110,000,000\nLinear 10000 .75 150,000,000\nLinear 10000 .50 70,000,000\nLinear 10000 .7375  107,500,000 ---- AVG\n</code></pre>\n\n<p><strong>CODE</strong></p>\n\n<pre><code>namespace sortMachine\n{\n    public partial class Form1 : Form\n    {\n\n        public Form1()\n        {\n            InitializeComponent();\n\n        }\n\n        private void Save()\n        {\n            var saveReport = new SaveFileDialog();\n            saveReport.Filter = \"Text Files | *.txt\";\n            var result = saveReport.ShowDialog();\n\n            if (result == DialogResult.Cancel || string.IsNullOrWhiteSpace(saveReport.FileName))\n                return;\n\n            using (var writer = new StreamWriter(saveReport.FileName))\n            {\n                writer.Write(textBox1.Text);\n                writer.Close();\n            }\n        }\n\n        private List&lt;string&gt; messages = new List&lt;string&gt;() { \"Linear\", \"Bubble\", \"Index\", \"Other\" };\n        private int clickCount = 0;\n\n        Stopwatch sw = new Stopwatch();\n\n        private void button1_Click(object sender, EventArgs e)\n        {\n            try\n            {\n\n            }\n            else if (textBox7.Text == \"Bubble\")\n            {\n            }\n            else if (textBox7.Text == \"Index\")\n            {\n            }\n            else if (textBox7.Text == \"Other\")\n            {\n            }\n            else if (textBox7.Text == \"\")\n            {\n                MessageBox.Show(\"Please input a sorting method\");\n            }\n        }\n\n    private void Form1_Load(object sender, EventArgs e)\n    {\n        Save();\n    }\n\n    private void button3_Click(object sender, EventArgs e)\n    {\n        textBox7.Text = messages[clickCount];\n        clickCount++;\n        if (clickCount == messages.Count)\n            clickCount = 0;\n    }\n}\n</code></pre>\n\n<p>}</p>\n"},{"tags":["c#",".net","winforms","backgroundworker"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":79,"score":2,"question_id":13057468,"title":"Update multiple progress bars in 2 different loops","body":"<p>I've got a windows program that is doing some updating to a database.  It has 2 loops which I'd like to show progress for.  The first loop gets a list of Customers and the second gets a list of Locations for that Customer:</p>\n\n<pre><code>DataTable dtCustomers = GetAllCustomers();\n\nforeach(DataRow customer in dtCustomers.Rows)\n{\n    //update Customer Progressbar...\n\n    //do some updating here...\n\n    DataTable dtLocations = GetAllLocations(customer);\n\n    foreach(DataRow location in dtLocations.Rows)\n    {\n        //do some updating here...\n\n        //update Location Progressbar...\n    }\n\n    //reset Location Progressbar...\n}\n</code></pre>\n\n<p>So what I'd like to do is show a visual progressbar (pb) of each loop.  The Customer pb would increment with each processed customer and so would the location pb...the only difference is the location pb would reset after each location, because it could take longer/shorter to update based on the location.</p>\n\n<p>I started with 1 background worker and was able to update the customer pb just fine.  I put the following code in a \"start\" button:</p>\n\n<pre><code>private void buttonStart_Click(object sender, EventArgs e)\n{\n    workerCustomers.RunWorkerAsync();\n}\n</code></pre>\n\n<p>and in the DoWork() event of the workerCustomer, I put the 2 loops.  I know that the location pb won't update because it would give the \"Cross thread reference\" error.  So how can I go about doing what I want?  I even tried to put 2 bg workers on the form and call one from the other, but again, another error stating the first worker is busy.</p>\n"},{"tags":["c#","windows","winforms","colors","system"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":83,"score":2,"question_id":13059676,"title":"How can I get the system's glass color?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3560890/vista-7-how-to-get-glass-color\">Vista/7: How to get glass color?</a>  </p>\n</blockquote>\n\n\n\n<p>Since Windows Vista it is possible to customize the System color:<br>\n<img src=\"http://i.stack.imgur.com/kV6Iu.png\" alt=\"Color Customization\"><br> \n<br>How can I programatically get the currently set system color as ARGB or HEX value?</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13062064,"title":"Winform Checkedlistbox Check/uncheck by code","body":"<p>I am working on a Windows form Application.\nI want to <code>check/uncheck</code> all checkboxes in checkedlistbox. </p>\n\n<p>I am using following code to generate checkboxes dynamically.</p>\n\n<pre><code>    var CheckCollection = new List&lt;CheckedBoxFiller&gt;();\n    foreach (DataRow dr in dt.Rows)\n        CheckCollection.Add(new CheckedBoxFiller {\n                                Text = dr[\"ImageName\"].ToString(),\n                                Value = dr[\"ImageId\"].ToString()\n        });\n    chklbEvidenceTags.DataSource = CheckCollection;\n    chklbEvidenceTags.DisplayMember = \"Text\";\n    chklbEvidenceTags.ValueMember = \"Value\";\n</code></pre>\n\n<p>And this is the CheckboxFiller class</p>\n\n<pre><code>private class CheckedBoxFiller {\n    public string Text { get; set; }\n    public string Value { get; set; }\n}\n</code></pre>\n\n<p>Now I want to <code>check/Uncheck</code> <code>all checkboxes</code>. How can I achieve this?</p>\n\n<p>Any help would be useful.</p>\n"},{"tags":["winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12738312,"title":"C# Change the icon on the top left of winform","body":"<p>I'm trying to change the top left corner icon of the winform from the default one to my icon:\n<img src=\"http://i.stack.imgur.com/LTnoT.png\" alt=\"enter image description here\"></p>\n\n<p>I've tried it by going to the Properties of my project, and go into Application, the set my own icon it in \"Icon and Manifest\". </p>\n\n<p>But after that, it still show the same old default icon. Is there something I done wrong?</p>\n"},{"tags":["c#","winforms","cultureinfo"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":94,"score":0,"question_id":13010972,"title":"Application hangs after changing language From “En-Us” to any global language in control panel","body":"<p>I created a WinForms application using C#. When I try to change the culture info, my application gets hanged.</p>\n\n<pre><code>                Microsoft.Win32.SystemEvents.UserPreferenceChanged += new \n               Microsoft.Win32.UserPreferenceChangedEventHandler(SystemEvents_UserPreferenceChanged);\n\n        void SystemEvents_UserPreferenceChanged(object sender, Microsoft.Win32.UserPreferenceChangedEventArgs e)\n    {\n        if (!PreviousInstance())\n        {\n            CultureInfo ObjCulture = new CultureInfo(CultureInfo.InvariantCulture.IetfLanguageTag, false);\n            Thread.CurrentThread.CurrentCulture = ObjCulture;\n            Application.CurrentCulture = ObjCulture;\n\n        }\n    }\n\n        public void INIT()\n        {\n        CultureInfo objCultureInfo = null;\n        try\n        {\n        objCultureInfo = new CultureInfo(\"en-US\", false);\n            objCultureInfo.NumberFormat.NumberDecimalSeparator = \".\";\n            objCultureInfo.NumberFormat.NegativeSign = \"-\";\n            objCultureInfo.NumberFormat.NumberNegativePattern = 1; //1 stands for -100.\n            Application.CurrentCulture = objCultureInfo;\n        }\n        }\n</code></pre>\n\n<p>After Changing Language ... My Application gets Hanged and i cant Debug anything When i Try to Evaluate things This Event Called only once.. But if try in a small application it comes every time when Language is changed...  ... Nothing shown in Eventviewer either. How can I solve this problem?    ..</p>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":44,"score":0,"question_id":12775140,"title":"Prevent form from showing multiple times","body":"<p>In windows form (c#), i am showing a form when user click on button, it is working fine form is visible to user, but if user click again on the same button the same form is opening again two forms are displaying. Is there any way to prevent this, please give me any reference for this thank you. This is my code....</p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n{\n  Form2 obj = new Form2();\n  obj.Show();\n}\n</code></pre>\n"},{"tags":["c#","winforms","mouseevent"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13060814,"title":"Run Action Upon Mouse Click and Mouse Release","body":"<p>I am working on a Windows Form C# project that requires running code when a user clicks down on a button, then waiting, and running a different set of code when the user then releases the mouse button. I have tried Button1.MouseDown and MouseUp as something that was suggested when I did a search for this information, but neither of these worked.</p>\n\n<p>Does anyone know how to do this?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","winforms","collections"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":66,"score":1,"question_id":13058678,"title":"Need help making a list accept multiple user inputs without removing the input before it","body":"<p>I need help making a Score Calculator for my class. The inputs for the scores can't be preset and it has to add up all previous inputs while increasing the count number.</p>\n\n<p>For example say I entered 23 into the text box and hit enter then typed in 45 i need my program to keep the 23 and add it to the 45 and it needs to repeat this for as long as the user inputs numbers.</p>\n\n<p>I know it needs to be a collection and i have the basis for it down i just need the code that will save the input from before and add it to the new one and save that total to add it to the next input.</p>\n\n<p>This is my attempt at solving this problem:</p>\n\n<pre><code> List&lt;decimal&gt; score = new List&lt;decimal&gt;();\n        score.Add(scoreInput);\n        decimal scoreTotal = 0;\n        decimal scoreHolder = 0;\n        foreach (decimal d in score)\n        {\n\n            scoreTotal = scoreHolder + scoreInput;\n            scoreHolder = scoreInput;\n            scoreInput = 0;\n            txtTotal.Text = scoreTotal.ToString(\"\");\n            txtCount.Text = score.Count.ToString(\"\");\n            txtScore.Clear();\n            txtScore.Focus();\n        }\n</code></pre>\n"},{"tags":["c#","vb.net","winforms","textbox"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":137,"score":1,"question_id":7792534,"title":"why when I press a Ctrl+Tab in a MultiLine TextBox,it enters a tab character, even i set the AcceptsTab property to false","body":"<p>Why does pressing <kbd>Ctrl</kbd>+<kbd>Tab</kbd> in a <em>MultiLine</em> <code>TextBox</code> enter a <code>tab</code> character even though I set the <code>AcceptsTab</code> property to <code>false</code>?</p>\n\n<p>I set the <code>MultiLine</code> property to <code>true</code> and the <code>AcceptsTab</code> property to <code>false</code>.</p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13057639,"title":"Start search when user type something over a datagridview","body":"<p>Our current software, which is made in FoxPro, got a very nice feature: when we type something over a grid, the search feature is automatically called.</p>\n\n<p>Example: I have a grid containing a list of truck. When I click on the grid and I type a truck number, the grid go directly to the grid's truck record.</p>\n\n<p>I need to implement it in C#, how could I do it?</p>\n\n<p>P.S. In some situation, a grid COULD have editable field. But if it's too complicated, I won't implement-it on the those editable grid.</p>\n"},{"tags":["c#","winforms","user-interface","control","show"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":13058043,"title":"What is the difference between control.Show and BringToFront?","body":"<p>What is the difference between Show/Hide and BringToFront/SendToBack? In which situation we should use one pair instead of the other?</p>\n"},{"tags":["c#",".net","winforms","visual-studio","usercontrols"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13047720,"title":"Connecting/binding user controls at design time in Visual Studio?","body":"<p>Consider the following User Control written in c#:</p>\n\n<pre><code>class MyControl : UserControl {\n  MyControl Left { get; set; }\n  MyControl Right { get; set; }\n}\n</code></pre>\n\n<p>I was looking for a way to be able to \"connect\" MyControls put at design-time on a Form, so my client wouldn't have to code those connections manually. Is it possible? If yes, how?</p>\n\n<p>Currently my client would have to do something like this:</p>\n\n<pre><code>myControl1.setLeft(myControl2);\nmyControl1.setRight(myControl3);\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["c#","winforms","tablelayoutpanel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":13052237,"title":"Programatically add row to top of TableLayoutPanel","body":"<p>I would like to Programatically add a new row to a <code>TableLayoutPanel</code>. When the new row is added, it should push the top row down.</p>\n\n<h1>Some background</h1>\n\n<p>I am attempting to create a control that would be used to make an Outliner application:</p>\n\n<blockquote>\n  <p>An outliner is a computer program that allows one to organize text into discrete sections that are related in a tree structure or hierarchy. Text may be collapsed into a node, or expanded and edited.</p>\n</blockquote>\n\n<p>More details <a href=\"http://en.wikipedia.org/wiki/Outliner\" rel=\"nofollow\">here</a>. </p>\n\n<p>I'd like it so if a user hits enter in a <code>TextBox</code>, it adds a new <code>TextBox</code> (ie. row) directly below <code>TextBox</code>. Any textboxes that already exist below it are all pushed down (so to speak). Each <code>TextBox</code> is contained within a <code>TableLayoutPanel</code> row.</p>\n\n<p>I've got this working nicely.</p>\n\n<p>I'd also like so when the user presses shift+enter, it adds a new <code>TextBox</code> directly above the current <code>TextBox</code>. Again, any textboxes that exist above it should be pushed up.</p>\n\n<p>I've got this working nicely... <strong>except for when I'm performing this on the top row.</strong></p>\n\n<p>When it's the top <code>TextBox</code> and the user presses shift+enter, the new <code>TextBox</code> is added directly below the current <code>TextBox</code>.</p>\n\n<p>What baffles me is that when I check the childindex values, the top textbox has a value of 1 and the next textbox (which should in theory be on top) has a value of 0. So the childindex values are corrent but <strong>it's as if the TableLayoutPanel isn't obeying the childindexes.</strong></p>\n\n<p>Does anyone know what is happening here and how I can resolve it?</p>\n\n<h1>My Current Code</h1>\n\n<pre><code>/// &lt;summary&gt;\n/// Adds new row (TextBox) to the Outline.\n/// &lt;/summary&gt;\n/// &lt;param name=\"sender\"&gt;Current Textbox&lt;/param&gt;\n/// &lt;param name=\"below\"&gt;True if user wants it added below current textbox, false if above.&lt;/param&gt;\nprivate void NewRow(object sender, bool below) {\n\n    var activeTextBox = (TextBox)sender;\n\n    var newTextBox = new TextBox();\n\n    newTextBox.AcceptsTab = true;\n    newTextBox.Location = new System.Drawing.Point(3, 3);\n    newTextBox.Multiline = true;\n    newTextBox.Name = \"textBox\";\n    newTextBox.Size = new System.Drawing.Size(424, 20);\n    newTextBox.TabIndex = 0;\n    newTextBox.KeyPress += new System.Windows.Forms.KeyPressEventHandler(this.textBox1_KeyPress);\n    newTextBox.KeyDown += new System.Windows.Forms.KeyEventHandler(this.textBox1_KeyDown);\n    newTextBox.TextChanged += new System.EventHandler(this.textBox1_TextChanged);\n    newTextBox.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left)\n    | System.Windows.Forms.AnchorStyles.Right)));\n    newTextBox.BorderStyle = System.Windows.Forms.BorderStyle.FixedSingle;\n\n    TextBoxes.Add(newTextBox);\n\n    tableLayoutPanel1.Controls.Add(newTextBox);\n\n    int offset;\n    int activeTextBoxChildIndex = tableLayoutPanel1.Controls.GetChildIndex(activeTextBox);\n\n    // If this is the top row, treat it differently\n    if (activeTextBoxChildIndex == 0 &amp;&amp; below == false)\n    {\n        tableLayoutPanel1.Controls.SetChildIndex(activeTextBox, 1);\n        tableLayoutPanel1.Controls.SetChildIndex(newTextBox, 0);\n    }\n    /* Otherwise:\n     * - If user wants it added below, set the child index to activeTextBoxChildIndex + 1.\n     * - If user wants it added above, set the child index to activeTextBoxChildIndex.\n     */\n    else\n    {\n        tableLayoutPanel1.Controls.Add(newTextBox);\n        offset = below ? 1 : 0;\n        int nextRowIndex = (activeTextBoxChildIndex + offset);\n        tableLayoutPanel1.Controls.SetChildIndex(newTextBox, nextRowIndex);\n    }\n\n    if (newTextBox.CanFocus) {\n        newTextBox.Focus();\n    }\n}\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["winforms"],"answer_count":6,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":10147,"score":8,"question_id":136129,"title":"Windows Forms: How do you change the font color for a disabled label","body":"<p>I am trying to set the disabled font characteristics for a Label Control.  I can set all of the Font characteristics (size, bold, etc), but the color is overridden by the default windows behavior which seems to be one of these two colors:</p>\n\n<ul>\n<li>If background color is transparent then ForeColor is same as TextBox disabled Color.</li>\n<li>If background color is set to anything else, ForeColor is a Dark Gray color.</li>\n</ul>\n\n<p>The image below demonstrates the behavior -- Column 1 is Labels, Column 2 is TextBoxs, and Column 3 is ComboBoxes.</p>\n\n<p><img src=\"http://highplainstech.com/images/testForm.png\" alt=\"alt text\" /></p>\n\n<p>Edit -- Explaining the image:  The first two rows are default styles for a label, textbox, and combobox.  In the second two rows, I set the Background color to Red and Foreground to White.  The disabled font style handling by Microsoft is inconsistent.</p>\n"},{"tags":["c#","winforms","treeview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13035701,"title":"Bold treeview node truncated - official fix will not work because code in constructor","body":"<p>I am experiencing the well known issue where after setting a TreeNode's font to bold, the text of the TreeNode gets truncated.  However, I believe I have found a situation in which all of the commonly accepted \"fixes\" fail to work.</p>\n\n<p><strong>Common Solution:</strong> <a href=\"http://support.microsoft.com/kb/937215\" rel=\"nofollow\">http://support.microsoft.com/kb/937215</a></p>\n\n<pre><code>node.NodeFont = new System.Drawing.Font(node.NodeFont, FontStyle.Bold);\nnode.Text += string.Empty;\n</code></pre>\n\n<p><strong>Variation 1:</strong> <a href=\"http://stackoverflow.com/questions/2272493/c-sharp-winforms-bold-treeview-node-doesnt-show-whole-text\">C# Winforms bold treeview node doesn&#39;t show whole text</a> (see BlunT's answer)</p>\n\n<pre><code>node.NodeFont = new System.Drawing.Font(node.NodeFont, FontStyle.Bold);\nnode.Text = node.Text;\n</code></pre>\n\n<p><strong>Variation 2:</strong> <a href=\"http://social.msdn.microsoft.com/Forums/en/csharpgeneral/thread/acb877a6-7c9d-4408-aee4-0fb7db127934\" rel=\"nofollow\">http://social.msdn.microsoft.com/Forums/en/csharpgeneral/thread/acb877a6-7c9d-4408-aee4-0fb7db127934</a></p>\n\n<pre><code>node.NodeFont = new System.Drawing.Font(node.NodeFont, FontStyle.Bold);\ntreeView1.BackColor = treeView1.BackColor;      \n</code></pre>\n\n<p><strong>Scenario In Which Above Fixes Do Not Work:</strong></p>\n\n<p>If the code that sets the node to bold is in the constructor (either of a form or, in this case, a user control), the fixes will not work:</p>\n\n<pre><code>public partial class IncidentPlanAssociations : UserControl\n{\n    public IncidentPlanAssociations()\n    {\n        InitializeComponent();\n\n        TreeNode node = new TreeNode(\"This is a problem.\");\n        node.NodeFont = new Font(treeView1.Font, FontStyle.Bold);\n        treeView1.Nodes.Add(node);\n\n        // This does not fix problem\n        node.Text += string.Empty;\n\n        // This does not fix problem\n        node.Text = node.Text;\n\n        // This does not fix problem\n        treeView1.BackColor = treeView1.BackColor;\n\n    }\n}\n</code></pre>\n\n<p>However, if I place any of these three \"fixes\" in code behind a button and click it after everything runs it will work just fine.  I'm sure this is something to do with when the treeview is initially drawn or something, but I'm trying to figure out a good way around it.  Any suggestions?</p>\n"},{"tags":["c#","winforms","backgroundworker"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":13053444,"title":"What is the recommended way to create multiple (more than 10) BackgroundWorkers?","body":"<p>Reading these <a href=\"http://stackoverflow.com/a/1507337\">BackgroundWorker vs. ThreadPool vs. Thread</a> tips, I decided to go with <a href=\"http://msdn.microsoft.com/en-us/library/8xs8549b%28v=vs.100%29.aspx\" rel=\"nofollow\">BackgroundWorker</a>.</p>\n\n<p>I know how to create such a thread by dragging-and-dropping its component from the Toolbox into my form, but since I need multiple such threads (a finite number between 10-20), I am not sure what the correct way to approach this is:</p>\n\n<ul>\n<li>Drag and drop 10-20 of them, creating placeholders for them in code, but only start those that need to run, depending on application needs (in different scenarios I could run as little as 1-2 our of those 10-20 threads).</li>\n</ul>\n\n<p>or</p>\n\n<ul>\n<li>Create those <a href=\"http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker%28v=vs.100%29.aspx\" rel=\"nofollow\">BackgroundWorker</a>s programmatically (somewhat more involved)</li>\n</ul>\n\n<p>I prefer the drag-and-drop approach but I am not experienced in BackgroundWorker and I am not sure what the tradeoffs could be.</p>\n\n<p>Any tips from experienced BackgroundWorker programmers?</p>\n"},{"tags":["c#",".net","xml","winforms","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":61,"score":1,"question_id":13055665,"title":"Parse Malformed XML With Linq","body":"<p>i am trying to parse some xml that i beleve to be malformed using Linq in .net 3.5 , i need to get the data out of the xml and insert the data into variables, i have been using XmlDocument to parse the xml, any examples or assistance is greatly appreciated</p>\n\n<p>XML -- </p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;centovacast version=\"2.2.4\" host=\"my.domain.com\"&gt;\n&lt;response type=\"success\"&gt;\n&lt;message&gt;Complete&lt;/message&gt;\n&lt;data&gt;&lt;row&gt;\n&lt;field name=\"mount\"&gt;/stream&lt;/field&gt;\n&lt;field name=\"listenercount\"&gt;0&lt;/field&gt;\n&lt;field name=\"genre\"&gt;Unspecified&lt;/field&gt;\n&lt;field name=\"url\"&gt;http://&lt;/field&gt;\n&lt;field name=\"title\"&gt;&lt;/field&gt;\n&lt;field name=\"currentsong\"&gt;Placebo - One Of A Kind&lt;/field&gt;\n&lt;field name=\"bitrate\"&gt;128&lt;/field&gt;\n&lt;field name=\"sourceconnected\"&gt;1&lt;/field&gt;\n&lt;field name=\"serverstate\"&gt;1&lt;/field&gt;\n&lt;field name=\"sourcestate\"&gt;1&lt;/field&gt;\n&lt;field name=\"reseller\"&gt;0&lt;/field&gt;\n&lt;field name=\"ipaddress\"&gt;&lt;/field&gt;\n&lt;field name=\"port\"&gt;13282&lt;/field&gt;\n&lt;field name=\"proxy\"&gt;0&lt;/field&gt;\n&lt;field name=\"servertype\"&gt;ShoutCast&lt;/field&gt;\n&lt;field name=\"sourcetype\"&gt;icescc&lt;/field&gt;\n&lt;/row&gt;&lt;row&gt;&lt;field&gt;&lt;/field&gt;&lt;/row&gt;&lt;/data&gt;&lt;/response&gt;&lt;/centovacast&gt;\n</code></pre>\n\n<hr>\n\n<p>another problem is that sometimes the \"currentsong\" value may contain special characters, such as ! , % , ^ &amp; etc and i know that can sometimes cause issues with xml.</p>\n\n<p>-- Code i'm trying to use to parse the XML</p>\n\n<pre><code>        XElement xml = XElement.Parse(data);\n\n        var query = from p in xml.Elements(\"name\")\n                    select p;\n\n        foreach (var record in query)\n        {\n            MessageBox.Show(String.Format(\"Info: {0} {1}\",\n                                                record.Element(\"url\"),\n                                                record.Element(\"title\")));\n        }\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13054396,"title":"c# comparing current windows user to AD group","body":"<p>I am trying to grab the current windows user and see if that user is part of a certain group in Active Directory. The username information finds \"Harper\\TSmith\" which seems fine but when I get to the </p>\n\n<pre><code>UserPrincipal uPrincipal = Psearch.FindOne() as UserPrincipal\n</code></pre>\n\n<p>Line UPrincipal is null. Can not figure out why. I also have at the bottom a validator class that as a bool method to see if they are part of that particular group.</p>\n\n<pre><code>PrincipalContext principalCtx = new PrincipalContext(ContextType.Domain);\n            UserPrincipal findUser = new UserPrincipal(principalCtx);\n            //findUser.Name = Environment.UserName;\n            findUser.Name = WindowsIdentity.GetCurrent().Name;\n            PrincipalSearcher pSearch = new PrincipalSearcher();\n            pSearch.QueryFilter = findUser;\n            UserPrincipal uPrincipal = pSearch.FindOne() as UserPrincipal;\n\n            Validator validate = new Validator();\n            //validate.IsUserInGroup(\"VisualOne\", uPrincipal);\n\n            if (validate.IsUserInGroup(\"MyGroup\", uPrincipal))\n            {\n                var MemberShipForm = new Membership();\n                MemberShipForm.Show();\n            }\n\n\n\npublic bool IsUserInGroup(string groupName, UserPrincipal user)\n    {\n        PrincipalContext context = new PrincipalContext(ContextType.Domain, \"Harper\");\n        GroupPrincipal group = GroupPrincipal.FindByIdentity(context, \"MyGroup\");\n\n        if (user.IsMemberOf(group))\n        {\n            return true;\n        }\n        return false;\n    }\n</code></pre>\n"},{"tags":[".net","winforms"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13039205,"title":"Same DataReceived event handler for a list of SerialPorts","body":"<p>I am working on a winforms application. I have a list of SerialPorts, each one listening on a different COM port.</p>\n\n<p>I am planning to add a unique event handler SerialPort.DataReceived for all the SerialPorts. Is this a good design? Thank you.</p>\n"},{"tags":["c#","winforms","scrolling","richtextbox"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13054645,"title":"Richtext box 6 middle mouse button scrolling reversed","body":"<p>When I use Richtext box 6 (RichEdit60W), the middle mouse button scrolling is reversed.\nWhen I click middle mouse button, and move the mouse up, it scrolls downwards, and vice verse.</p>\n\n<p>Is there a way to reverse that?</p>\n\n<p>Thanks</p>\n\n<p>Here is the code used:</p>\n\n<pre><code>public class RichText50W : RichTextBox\n{\n    [DllImport(\"kernel32.dll\", CharSet = CharSet.Auto)]\n    internal extern static IntPtr LoadLibrary(string libname);\n    protected override CreateParams CreateParams\n    {\n        get\n        {\n            CreateParams cp = base.CreateParams;\n            if (LoadLibrary(string.Format(@\"{0}\\Microsoft Shared\\OFFICE14\\RICHED20.DLL\", Environment.GetFolderPath(Environment.SpecialFolder.CommonProgramFiles))) != IntPtr.Zero)\n            {\n                if (Marshal.SystemDefaultCharSize == 1)\n                {\n                    cp.ClassName = \"RichEdit60A\";\n                }\n                else\n                {\n                    cp.ClassName = \"RichEdit60W\";\n                }\n            }\n\n            return cp;\n        }\n    }\n</code></pre>\n"},{"tags":["c#","winforms","combobox","telerik"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":13053323,"title":"Input string was not in a correct format in C#","body":"<p>I know this is duplicate question. I have try finding the solution in duplicate question but I failed.</p>\n\n<p>The situation is I have 2 combo box (Telerik Winforms) called ComboBranch and ComboPanel. ComboPanel will show different value when user select the some value in ComboBranch.</p>\n\n<p>So this is the code</p>\n\n<pre><code> private void tbDropBranch_SelectedIndexChanged(object sender, Telerik.WinControls.UI.Data.PositionChangedEventArgs e)\n    {\n        dataPanel();\n    }\n\n    void dataPanel()\n    {\n\n        DataTable dtPanel = dataBinding._valuePanel(Convert.ToInt32(tbDropBranch.SelectedValue.ToString())); // Error in here\n        tbDropPanel.DataSource = new BindingSource(dtPanel, null);\n        tbDropPanel.DisplayMember = \"panelName\";\n        tbDropPanel.ValueMember = \"panelID\";\n\n    }\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>If I do Event tbDropBranch_Leave it`s work. But why I got error when I use tbDropBranch_SelectedIndexChanged ?</p>\n\n<pre><code> private void tbDropBranch_Leave(object sender, EventArgs e)\n        {\n\n            dataPanel();\n\n        }\n</code></pre>\n\n<p><strong>SOLUTION</strong></p>\n\n<p>I just do like this :</p>\n\n<pre><code>void getIdBranch()\n    {\n\n        if (\"System.Data.DataRowView\" == tbDropBranch.SelectedValue.ToString())\n        {\n            return;\n        }\n        else\n        {\n\n            DataTable dtPanel = dataBinding._valuePanel(Convert.ToInt32(tbDropBranch.SelectedValue.ToString()));\n            tbDropPanel.DataSource = new BindingSource(dtPanel, null);\n            tbDropPanel.DisplayMember = \"panelName\";\n            tbDropPanel.ValueMember = \"panelID\";\n        }\n\n    }\n</code></pre>\n\n<p>Thank to those who helped.. :)</p>\n"},{"tags":["vb.net","winforms","datagridview","mouse","cell"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13032786,"title":"vb.net winforms datagridview how to tell where the user clicked in a cell","body":"<p>I am adding a custom column to a custom datagridview.  One of the options this new datagridcolumn has is the ability show a value and then a button to allow the user to click on the button and something will happen.  The button only takes up the right portion of the cell and the rest is a value.  This button and value are displayable always and the button should always be able to be clicked on.  In datagridview's display mode the value and button are painted.  What I need help on is how to tell whether the user clicked on the button portion of the cell.  Can someone please provide example code on how to do this?</p>\n\n<p>Thanks,\nGreg</p>\n"},{"tags":["c#",".net","vb.net","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":272,"score":1,"question_id":2714960,"title":"What are the requirments for ISupportInitialize code to be serialized in InitializeComponent? .NET","body":"<p>I need to add some code to the EndInit method of a PictureBox control, but unfortunately it's private and, from what I can gather, I can't shadow it and call base - at least not in <a href=\"http://en.wikipedia.org/wiki/Visual_Basic_.NET\" rel=\"nofollow\">VB.NET</a>.</p>\n\n<p>What I can do is to add a dummy property to my picture box class. The type of the dummy property is simply a class that just implements <code>ISupportInitialize</code>. However, that doesn't work, I need the dummy class to inherit from Control.</p>\n\n<p>Is that the minimum requirement?</p>\n"},{"tags":["c#",".net","vb.net","winforms"],"answer_count":3,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":832,"score":4,"question_id":2928940,"title":"Clear type font usage in C#/VB.NET","body":"<p>How do I use a <a href=\"http://en.wikipedia.org/wiki/ClearType\" rel=\"nofollow\">ClearType</a> font in C#/<a href=\"http://en.wikipedia.org/wiki/Visual_Basic_.NET\" rel=\"nofollow\">VB.NET</a>?</p>\n"},{"tags":["c#","winforms","richtextbox","selection"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13039967,"title":"Selecting text in richtext box v5 that contains hyperlinks","body":"<p>When I use the RichTextBox.Select(int start, int length) function to select text in a rich text box that contains hyperlinks, there is some shift in the selection when I try to select any text that is after the hyperlink.</p>\n\n<p>When I remove the hyperlink, the selection works properly.</p>\n\n<p><strong>Edit:</strong>\nI use RichTextBox 5 (the default in Visual Studio is version 4)</p>\n\n<pre><code>public class RichText50W : RichTextBox\n{\n    [DllImport(\"kernel32.dll\", CharSet = CharSet.Auto)]\n    static extern IntPtr LoadLibrary(string lpFileName);\n    protected override CreateParams CreateParams\n    {\n        get\n        {\n            CreateParams prams = base.CreateParams;\n            if (LoadLibrary(\"msftedit.dll\") != IntPtr.Zero)\n            {\n                prams.ClassName = \"RICHEDIT50W\";\n            }\n            return prams;\n        }\n    }\n}\n</code></pre>\n\n<p>The problem occurs only with richtextbox 5+.</p>\n\n<p>These images show the problem and the difference in behavior.</p>\n\n<p>If you try this make sure to set HideSelection property of richtextboxes to \"false\".</p>\n\n<p>Select functions are displayed on the buttons.</p>\n\n<p><img src=\"http://i.stack.imgur.com/qgrCy.jpg\" alt=\"Select (10, 1)\"></p>\n\n<p>For RTB5, 'e' in \"Text\" should be selected in the above image.</p>\n\n<p><img src=\"http://i.stack.imgur.com/jaG5k.jpg\" alt=\"Select (40, 1)\"></p>\n\n<p><img src=\"http://i.stack.imgur.com/LWKb8.jpg\" alt=\"Select (46, 1)\"></p>\n\n<p>Apparently RTB5 selects some hidden text.</p>\n\n<p>I need it to select based on the visible text only.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","winforms","focus","webbrowser"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":800,"score":1,"question_id":8495857,"title":"Webbrowser steals focus","body":"<p>I'm using webbrowser control in my winforms app (c#). And when it is doing automation things, I'm losing focus control from the window I was working with. Webbrowsers' form doesn't show up also, I just lose focus from the contol. I now writing this message I have to click into textbox again and again...</p>\n\n<p>How to disable such behaviour in webbrowser?</p>\n\n<p>I create invisible webbrowser like that:</p>\n\n<pre><code>var br = new WebBrowser();\nbr.Visible = false;\nbr.ScriptErrorsSuppressed = true;\n</code></pre>\n\n<p>Please advise.</p>\n"},{"tags":["vb.net","winforms","random","process","spawn"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13052917,"title":"VB.NET application randomly spawns another instance of itself during use","body":"<p>I have a Windows forms application which I have a bit of a sporadic issue with. The application would randomly start/spawn another instance of itself without any warning or reason. I only have one use of Process.Start in the whole application (15 forms/files and about 5000 lines of code) and that calls a net use command to map a network drive.</p>\n\n<p>I've not been able to reproduce this in my testing and therefore I made the project a Windows Assembly Framework single instance application (pros/cons of this I know). This has obviously stopped any other instances of the application from running, but now at random intervals their program will minimise and snap to another application they have running. I don't know for certain whether this is related but they certainly sound a bit close for comfort!</p>\n\n<p>Any ideas/pointers/thoughts appreciated.</p>\n\n<p>Thanks,</p>\n\n<p>Jamie</p>\n"},{"tags":["winforms","visual-studio","visual-studio-2012","windows-forms-designer"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13047772,"title":"Move row in TableLayoutPanel","body":"<p>I can't figure out how to move a row of the <code>TableLayoutPanel</code> in the Designer. How do you do that?</p>\n\n<p>I cannot drag them, there are no buttons to move them up or down and moving all the controls from one row to another is just tedious and time consuming.</p>\n"},{"tags":["c#",".net","winforms","listview"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":60,"score":1,"question_id":13042357,"title":"Different Sorting methods and random","body":"<p>I am working with <code>random</code> and <code>sorting</code> methods. So far I have the linear method working.  I am trying to implement a way that will let the user decide which type of sorting to use such as <code>linear</code>, <code>bubble</code>, <code>index</code>, etc.  So I have added <code>textBox7</code> with the label <code>Key</code> and <code>button3</code> which the user clicks until the find their desired sorting method.  When Key<code>textbox7</code> has a value chosen then the sort array <code>button2</code> will execute that particular sorting method. How can I execute a particular sorting method based on the <code>Key</code> value? Below is picture of how I have the windows form set up</p>\n\n<p><strong>CODE</strong></p>\n\n<pre><code>namespace sortmachine\n{\n    public partial class Form1 : Form\n    {\n\n        public Form1()\n        {\n            InitializeComponent();\n\n        }\n\n\n        Stopwatch sw = new Stopwatch();\n\n\n        Random r = new Random();\n\n        private int size = 0;\n        private int max = 0;\n        private int ops = 0;\n        private int[] ar1;\n        private int[] ar2;\n        private int[] ar3;\n\n        private void button1_Click(object sender, EventArgs e)\n        {\n            try\n            {\n                size = Convert.ToInt32(textBox2.Text);\n                max = Convert.ToInt32(textBox3.Text);\n                string s = \"\";\n\n                ar1 = new int[size];\n                ar2 = new int[size];\n                ar3 = new int[size];\n\n                for (int i = 0; i &lt; size; i++)\n                {\n                    int n = r.Next(0, max);\n                    ar1[i] = n;\n                    ar2[i] = ar1[i];\n                }\n\n                for (int i = 0; i &lt; size; i++)\n                {\n                    s += ar1[i].ToString() + \" \";\n                }\n                listView1.Items.Add(s);\n            }\n            catch\n            {\n                MessageBox.Show(\"Please input information\");\n            }\n\n        }\n\n        private void button2_Click(object sender, EventArgs e)\n        {\n            int min = max;\n            int n = 0;\n            string s=\"\";\n\n            sw.Start();\n\n            for (int j = 0; j &lt; size; j++)\n            {\n                for (int i = 0; i &lt; size; i++)\n                {\n                    if (min &gt; ar2[i])\n                    {\n                        min = ar2[i];\n                        n = i;\n                        ops++;\n                    }\n                    if (min &lt; ar2[i])\n                    {\n                        ops++;\n                    }\n\n                }\n                ar2[n]=max;\n                ar3[j] = min;\n                min = max;\n                s += ar3[j] + \" \";\n            }\n\n            TimeSpan x = sw.Elapsed;\n            textBox5.Text = x.ToString();\n\n                listView2.Items.Add(s);\n                listView2.Text = s;\n                textBox6.Text = Convert.ToString(ops);\n                if (checkBox1.Checked==true)\n                {\n                    textBox1.AppendText(s+Environment.NewLine);\n                }\n                for (int i = 0; i &lt; size; i++)\n                {\n                    ar2[i] = ar1[i];\n                }\n                ops = 0;\n\n        }\n\n    }\n}\n</code></pre>\n"},{"tags":["c#","winforms","backgroundworker"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":13051134,"title":"Return from a BackgroundWorker from within a method called by it","body":"<p>I have a <code>BackgroundWorker</code> that calls a method that calls a method... and somewhere along the line I check for <code>CancellationPending</code> and want to exit the <code>BackgroundWorker</code>.</p>\n\n<p>Is there a way to do that directly from that deeply nested method or does it have to return to its caller, which in turn will return to its caller...?</p>\n"},{"tags":["vb.net","winforms","visual-studio-2005","windows-forms-designer"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":12382936,"title":"MDI Designer View is showing HTML, instead of the form design","body":"<p>I am not sure what is happened and have been searching for fixes all night. When I double click on the mdi form (or right click and select \"View Designer\") what appears, instead of the form designer view, is html. When attempting to debug, Visual Studio shows an error being thrown when attempting to create and instance of the form. The inner exception/stack trace is show below. </p>\n\n<blockquote>\n  <p>System.InvalidOperationException was unhandled   Message=\"An error\n  occurred creating the form. See Exception.InnerException for details. \n  The error is: Class not registered (Exception from HRESULT: 0x80040154\n  (REGDB_E_CLASSNOTREG))\"   Source=\"Blah\"   StackTrace:\n         at Blah.My.MyProject.MyForms.Create_<em>Instance</em>_[T](T Instance) in 17d14f5c-a337-4978-8281-53493378c1071.vb:line 190\n         at Blah.My.MyProject.MyForms.get_mdiBlah()\n         at Blah.mdiBlah.Main() in C:\\Users\\Home\\Desktop\\ClientSoftware\\ClientSoftware\\mdiBlah.Designer.vb:line\n  1\n         at System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args)\n         at System.AppDomain.nExecuteAssembly(Assembly assembly, String[] args)\n         at System.Runtime.Hosting.ManifestRunner.Run(Boolean checkAptModel)\n         at System.Runtime.Hosting.ManifestRunner.ExecuteAsAssembly()\n         at System.Runtime.Hosting.ApplicationActivator.CreateInstance(ActivationContext\n  activationContext, String[] activationCustomData)\n         at System.Runtime.Hosting.ApplicationActivator.CreateInstance(ActivationContext\n  activationContext)\n         at System.Activator.CreateInstance(ActivationContext activationContext)\n         at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssemblyDebugInZone()\n         at System.Threading.ThreadHelper.ThreadStart_Context(Object state)\n         at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)\n         at System.Threading.ThreadHelper.ThreadStart()</p>\n</blockquote>\n\n<p>A few common fixes for this issue is:</p>\n\n<ol>\n<li>Check and make sure the class name in the code behind is the same as\nthe class name in the designer code. Check.</li>\n<li>Make sure that all references the project uses are included. Check.</li>\n<li>A few other things that I, unfortunately, can not remember at this time.</li>\n</ol>\n\n<p>I know this could be a fairly open-ended error. But I really need some direction on this, and hopefully it will serve also as a guide for someone else in the future. </p>\n"},{"tags":["c#","arrays","winforms","parsing"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":90,"score":2,"question_id":13050910,"title":"Parse string to int array","body":"<p>Hi there I am working on increasing my knowledge of C# and I want to do a simple task but am finding it difficult. </p>\n\n<p>I want to parse each character of a string to an int array.</p>\n\n<pre><code>    int[] d = new int[10];\n     private void button1_Click(object sender, EventArgs e)\n    {\n        s = textBox1.Text;\n\n        d[2] = Convert.ToInt32(Convert.ToString(s[1]));\n        d[3] = Convert.ToInt32(Convert.ToString(s[2]));\n        d[4] = Convert.ToInt32(Convert.ToString(s[3]));\n        d[5] = Convert.ToInt32(Convert.ToString(s[4]));\n        .....\n</code></pre>\n\n<p>I know the code is wrong but I wanted to show an example. Have looked at Google for the past hour but have found people wanting to display characters in new lines and using if statements to parse. I want something similar to above. Can this be done? Thank you for your time.</p>\n\n<p>I found this line of code in Java which is exactly what I want to do but is there an equivilant? </p>\n\n<pre><code>    d1 = Integer.parseInt(String.valueOf(s.charAt(0)));\n</code></pre>\n\n<p>I now have a new problem that when i submit a number no matter how many numbers i put in it will come back with \"Index was outside the bounds of the array.\" </p>\n\n<p>I also need to limit it to 10 integers in the array d.</p>\n"},{"tags":["winforms","localization"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12863180,"title":"winform language localization sample for","body":"<p>I've the following code to convert the controls in static mode i.e by writing the translated string(french,german etc) and saving the resource file and calling it back. How ever if I need to translate dynamically(including the user-inputs), say like how google translator works. I need to implement the same in offline mode. Is there any possibility to access google like translators, which instantly/dynamically translates to the selected language, but offline? Or please suggest me any preferred method.</p>\n\n<pre><code>foreach (Control c in this.Controls)\n    {\n        ComponentResourceManager resources = new ComponentResourceManager(typeof(MainForm));\n        resources.ApplyResources(c, c.Name, new CultureInfo(lang));\n    }\n</code></pre>\n\n<p>--\nRegards,\nManohar.</p>\n"},{"tags":["c#","windows","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13048857,"title":"How to track time between two button clicks in C# in a Windows form application?","body":"<p>I have created a windows form application in c# in which input from user is taken .I want to calculate time spent by user in between two submissions.How can I do that?</p>\n"},{"tags":[".net","vb.net","winforms","validation","data-binding"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":798,"score":5,"question_id":1661343,"title":"Cancelling databound control validating event doesn't suppress attempt to update data source","body":"<p>I'm not getting the behaviour I would expect for a TextBox bound to an integer property in a business object.</p>\n\n<p>Here's what I did:</p>\n\n<p>(1) Set the <code>DataSourceUpdateMode</code>, for the TextBox to: <code>OnValidation</code>.</p>\n\n<p>(2) In the <code>Validating</code> event for the TextBox, set <code>e.Cancel = True</code> if Integer.TryParse fails.</p>\n\n<p>(3) Add a handler to <code>Binding.Parse</code> and <code>Binding.BindingComplete</code> and place breakpoints in the handlers.</p>\n\n<p>Run the application, put \"asdasd\" in the TextBox and tab out.\nDespite setting <code>e.Cancel = True</code>, the <code>Parse</code> and <code>BindingComplete</code> events are both raised.\nAccording to the documentation, setting <code>e.Cancel = True</code> should suppress any further logic.</p>\n\n<p>I searched MSDN to find out why this happens but I can't find anything. Does any one know of where I can some details on this?</p>\n\n<p><strong>ETA</strong>: I added a handle to the Validated event as well. Here's the sequence of events:</p>\n\n<p>Bad data:</p>\n\n<p>(1) Validating. (I set <code>e.Cancel = True</code>)</p>\n\n<p>(2) Parse</p>\n\n<p>(3) BindingComplete  </p>\n\n<p>Good data:</p>\n\n<p>(1) Validating</p>\n\n<p>(2) Parse</p>\n\n<p>(3) BindingComplete</p>\n\n<p>(4) Validated</p>\n\n<p><strong>ETA2</strong>: A bit more info and a work-around.</p>\n\n<p>The problem with this behaviour is if you have some validation that is not implemented in the property setter.</p>\n\n<p>For instance, let's say my integer property has to be an odd number. I don't check for this in the property setter, so I do the check in the validating event.</p>\n\n<p>As you can see, from the above behaviour, the value, as a legitimate integer, will be written to the data source, even if I cancel validation.</p>\n\n<p>Despite the fact that the data source is updated, if you do set Cancel in the validating event, the Validated event will not be fired, so  you can still prevent the user from progressing.</p>\n\n<p><strong>Work-Around::</strong></p>\n\n<p>To stop the data source updating, you need to validate in the <code>Binding.Parse</code> event, and throw an exception - which prevents Binding from completing successfully.</p>\n"},{"tags":["c#","winforms","panel","flowlayoutpanel"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":175,"score":1,"question_id":10516997,"title":"Add Control Value before another Control value in C#","body":"<p>I have a \"FlowLayoutPanel\" and add some \"UserControl\" to it:    </p>\n\n<blockquote>\n  <p>mainPanel.Controls.Add(fx);</p>\n</blockquote>\n\n<p>Every new usercontrol add after old one, I want to add new usercontrol before the previous usercontrol that was added how could I do this? I didn't find ant functionality like <code>mainPanel.Controls.AddAt(...)</code> or <code>mainPanel.Controls.Add(index i, Control c)</code> or <code>mainPanel.Controls.sort(...)</code> or ... .</p>\n"},{"tags":["c#","winforms","visual-studio-2010"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":466,"score":0,"question_id":9663033,"title":"Extracting selected value from a ListBox","body":"<p>how do i extract out the selected text and values from a list box.\nHere's how I populate the list box </p>\n\n<pre><code>           // Populate ListBox\n\n            ListItem lstListItem = new ListItem();\n\n            int intRecordCount = objDataSet.Tables[0].Rows.Count;\n\n            for (int i = 0; i &lt;= intRecordCount - 1; i++)\n            {\n                lstListItem.Text = objDataSet.Tables[0].Rows[i][\"SN_Notes\"];\n                lstListItem.Value = objDataSet.Tables[0].Rows[i][\"ID\"];\n                this.lstNote.Items.Add(lstListItem);\n            }\n</code></pre>\n\n<p>then when i try to fetch the selected values, It return null value. I'm using Winform / VS2010</p>\n\n<pre><code>           intRecordCount = lstNote.Items.Count;\n\n           for (int i = 0; i &lt;= intRecordCount - 1; i++)\n           {\n                  lstNote.SelectedIndex = i;\n                  strID = lstNote.SelectedValue.ToString(); // Always return Null Value\n           }\n</code></pre>\n\n<p>Thank you in advance!!</p>\n"},{"tags":["c#",".net","vb.net","winforms","windows-applications"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":81,"score":3,"question_id":13046019,"title":"Winforms: Application.Exit vs Enviroment.Exit vs Form.Close","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12977924/how-to-properly-exit-a-c-sharp-application\">How to properly exit a c# application?</a>  </p>\n</blockquote>\n\n\n\n<p>I have investigated what are the ways we can exit an application:</p>\n\n<ol>\n<li><code>Enviroment.Exit(0)</code></li>\n<li><code>Application.Exit()</code></li>\n<li><code>Form.Close()</code></li>\n</ol>\n\n<p>Which is the best way of closing an application and why?</p>\n"},{"tags":["c#","winforms","usercontrols","size","parent"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13048004,"title":"Event that fires when a control gets added onto another control","body":"<p>Is there an event that gets fired when a user control gets added onto a <code>Form</code>?\nI need this to get the size of the <code>Parent</code> control of the user control.</p>\n\n<p>But when the user control gets initialized etc, the <code>Parent = null</code>.\nBecause the user control hasn't been added yet onto the Form. So i can't get the Parent control (which is the Form) at this point.</p>\n\n<p>So i'll have to do the re-sizing of the user control afterwards.</p>\n"},{"tags":["c#","winforms","sockets"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":13047699,"title":"Socket communication between Web Application and Windows Form","body":"<p>I have 2 applications, one of which is a web application and the other is a windows form. I made a socket to do a communication between the two applications and pass information from the web application to windows form. The windows form will be installed on the user's machine and the web application will be on my web server. The windows form for receiving information from the web application and print this information on a specific printer that will be installed on the user machine. </p>\n\n<p><strong>PROBLEM</strong></p>\n\n<p>The problem is that when I try to run both applications in localhost to test, do the socket to connect to a specific port on the IP 127.0.0.1, but when I try to start the printer port (COM6), it is not found, but when I close the web application and just run the windows form, the printer is found on COM6 normally. </p>\n\n<p>Can anyone help me?</p>\n\n<p><strong>Web Application Code</strong></p>\n\n<pre><code>public void btnImprimeBematech_Locacao()\n{\n    TcpListener serverSocket = new TcpListener(8880);\n    int requestCount = 0;\n    TcpClient clientSocket = default(TcpClient);\n    serverSocket.Start();\n    clientSocket = serverSocket.AcceptTcpClient();\n\n    requestCount = 0;\n\n    while ((true))\n    {\n        try\n        {\n            requestCount = requestCount + 1;\n            NetworkStream networkStream = clientSocket.GetStream();                    \n            string serverResponse = Request.QueryString[\"id\"];\n            Byte[] sendBytes = Encoding.ASCII.GetBytes(serverResponse);\n            networkStream.Write(sendBytes, 0, sendBytes.Length);\n            networkStream.Flush();                    \n        }\n        catch (Exception ex)\n        {                    \n        }\n    }\n\n    clientSocket.Close();\n    serverSocket.Stop();\n}\n</code></pre>\n\n<p><strong>Windows Form Code</strong></p>\n\n<pre><code>    private void Form1_Load(object sender, EventArgs e)\n    {\n        // Initiallize Printer in my COM6 port\n        int return1 = IniciaPorta(\"COM6\");\n\n        msg(\"Client Started\");\n        clientSocket.Connect(\"127.0.0.1\", 8880);\n        label1.Text = \"Client Socket Program - Server Connected ...\";            \n    }\n\n    public void msg(string mesg)\n    {\n        textBox1.Text = textBox1.Text + Environment.NewLine + \" &gt;&gt; \" + mesg;\n    }\n\n    private void button3_click(object sender, EventArgs e)\n    {\n        NetworkStream serverStream = clientSocket.GetStream();\n\n        byte[] inStream = new byte[10025];\n        serverStream.Read(inStream, 0, (int)clientSocket.ReceiveBufferSize);\n        string returndata = System.Text.Encoding.ASCII.GetString(inStream);\n        msg(\"Data from Server : \" + returndata);\n\n        //int retorno = IniciaPorta(\"COM6\");\n\n        // Set the printer model - 7\n        ConfiguraModeloImpressora(7);\n\n        // Print\n        BematechTX(returndata + \"\\n\\r\\n\\r\\n\\r\\n\\r\\n\\r Lucas Germano \\n\\r\\n\\r\\n\\r\\n\\r\\n\\r Lucas\");\n\n        // Cut the paper\n        AcionaGuilhotina(1);\n\n        // Close printer port\n        FechaPorta();\n    } \n}\n</code></pre>\n\n<p><strong>Importing Printer DLL in Windows Form</strong></p>\n\n<pre><code>    /// &lt;summary&gt;\n    /// This function will open the communication port, where the printer are connected\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"porta\"&gt;STRING name of the communication port&lt;/param&gt;\n    /// &lt;returns&gt;INTEGER - If the function send the command to the printer.&lt;/returns&gt;\n    [DllImport(\"MP2032.dll\")]\n    public static extern int IniciaPorta(String porta);\n</code></pre>\n\n<p>I have all the <code>DllImport</code> but I think is not necessary to post this right now. The DLL are in <code>System32</code> folder</p>\n"},{"tags":["c#",".net","winforms","file"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":987,"score":1,"question_id":7737461,"title":"how to get only file names from the directory ,not the entire path","body":"<p>i am using below method to get the file names ..</p>\n\n<p>but it returns the entire path ....now i dont want to get the entire path..</p>\n\n<p>I want only file names not the entire path...</p>\n\n<p>how can i get that only file names not the entire path</p>\n\n<p>path= c:\\docs\\doc\\backup-23444444.zip</p>\n\n<pre><code>    string[] filenames = Directory.GetFiles(targetdirectory,\"backup-*.zip\");\n    foreach (string filename in filenames)\n    { }\n</code></pre>\n\n<p>would any one pls help on this.....</p>\n\n<p>Many thanks...</p>\n"},{"tags":["c#","winforms","visual-studio-2008","toolstripbutton"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12973418,"title":"ToolStripButton have different behavior on showing Modal Less Dialog","body":"<p>I have a main window and a toolstrip on it with different command buttons. In these commands, I've a 'Print' button too (See Below). When I click on 'Print' button , I need to show sub-form as Modal Less Dialog. Because, I've few option on sub-form. If user select them then he/she can interact with Main Form too.</p>\n\n<p><img src=\"http://i.stack.imgur.com/xuzXn.png\" alt=\"enter image description here\"></p>\n\n<p>Meanwhile, on show() method I disable all controls on Main Form (see below) as it will be done if I use ShowDialog() method to show sub-form. When I click the Print Button, it's color changed which shows it is focused/selected.</p>\n\n<p><img src=\"http://i.stack.imgur.com/IkcYS.png\" alt=\"enter image description here\"></p>\n\n<p>On click sub-form is show like below pic.</p>\n\n<p><img src=\"http://i.stack.imgur.com/p89en.png\" alt=\"enter image description here\"></p>\n\n<p>Logically, it should return to previous mode when I close sub-form. But, even sub-form is showing... that 'Print' button on Main-Form is still focused/selected. When I close the sub-form, that 'Print' Button still focused/selected like below.</p>\n\n<p><img src=\"http://i.stack.imgur.com/MqzPQ.png\" alt=\"enter image description here\"></p>\n\n<p>What Event/ Property needs to be changed to make this 'Print' Button to show like as it is in initial state.</p>\n\n<p>I've tried Invalidate(), change BackColor but didn't meet the requirement yet. Any Guidelines ?</p>\n"},{"tags":["c#","winforms","picturebox","pictures","manipulate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13045840,"title":"Display picturebox with transparent background","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/10455484/winforms-semi-transparent-png-over-semi-transparent-png\">Winforms semi-transparent PNG over semi-transparent PNG</a>  </p>\n</blockquote>\n\n\n\n<p>I am about to make a project of the game Risk in school and my teacher said that's possible, but we are only to use Windows Form and not XNA or other tools.</p>\n\n<p>In Risk, as you probably know if you know the game, the map is built up on many countries and every country should be it's own picture, since it has it's own effects, so to say.</p>\n\n<p>So is it possible, with PictureBox, so change it to have a \"transparental\" effect and cover the picture only and not be like a box around the picture?</p>\n\n<p>Sorry if this was a bad written description!</p>\n"},{"tags":["c#","winforms","timer","photo-gallery"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13046364,"title":"how to switch between photos in windows forms using time interval?","body":"<p>I'm having a problem while trying to switch between a group of photos in a Form(1).\nI'm using picturebox.Image in order to view the chosen picture, and after certain time interval (let's say 4Sec) , switch to a random photo in the same group of photos.</p>\n\n<p>While switching between each photo, i would like to show another Form(2) for 1Sec, and then go back to Form(1).</p>\n\n<p>my Code in Form(1):</p>\n\n<pre><code>public partial class Form1: Form\n    {\n        public static Timer time;\n        public static Form mod;\n    public Form1()\n    {\n        InitializeComponent();\n        time = new Timer();\n        mod = new Form2();\n\n        mod.Owner = this;\n        mod.Show();\n        this.Hide();\n\n        RunForm1();\n    }\n\n    public void RunForm1()\n    {\n        for (int i = 0; i &lt; groupSize; i++)\n        {\n                mod.Owner = this;\n                mod.Show();\n                this.Hide();\n        }\n    }\n}\n</code></pre>\n\n<p>my Code in Form(2):</p>\n\n<pre><code>public partial class Form2: Form\n{\n        public static Timer time;\n        public int index = -1;\n        public List&lt;Image&gt; images;\n        public DirectoryInfo dI;\n        public FileInfo[] fileInfos;\n\n\n    public Form2()\n    {\n        InitializeComponent();\n\n        images = new List&lt;Image&gt;();\n        time = new Timer();\n\n        dI = new DirectoryInfo(@\"C:\\Users\\Documents\\Pictures\");\n        fileInfos = dI.GetFiles(\"*.jpg\", SearchOption.TopDirectoryOnly);\n        foreach (FileInfo fi in fileInfos)\n            images.Add(Image.FromFile(fi.FullName));\n\n        index = images.Count;\n        time.Start();\n\n        RunForm2();\n    }\n\n    public void RunForm2()\n    {\n        Random rand = new Random();\n\n        int randomCluster = rand.Next(0, 1);\n\n        while (index != 0)\n        {\n            pictureBox1.Image = images[Math.Abs(index * randomCluster)];\n            setTimer();\n            index--;\n        }\n    }\n\n    public void setTimer()\n    {\n        if (time.Interval == 4000)\n        {\n            this.Owner.Show();\n            this.Close();\n        }\n    }\n</code></pre>\n\n<p>}</p>\n\n<p>My main problems in this code is:\n1. The time is not updating, i mean, time.Interval is always set to 100\n2. i dont know why, but, the photos, never shows in the picturebox.Image although, in debug mode it shows that the photos are being selected as properly.</p>\n\n<p>Thank you for you help!\nRoy.</p>\n"},{"tags":["c#",".net","winforms","usercontrols"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13045929,"title":"Defining constraints on how my own controls are put on a form","body":"<p>My idea would be to develop 2 custom controls on windows forms, one being a <code>StreetControl</code> and other a <code>CrossControl</code>. </p>\n\n<p>It would be really user-friendly if when putting a <code>CrossControl</code> on the form, one could then  have an option to bind streets to any of its 4 docks (North, South, East, West), maybe by right clicking and selecting an option or something, at design-time. I'm not particularly familiar with winforms but from the basic stuff, so I'm not even sure by which terms to look up on google.</p>\n\n<p>Is anything like this possible? If yes, where can I find resources for this kind of info?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","winforms","listview"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":124,"score":3,"question_id":12990028,"title":"Select only one Item from listBox","body":"<p>I am beginner in c#.  I need to show only one Item of the <code>ListView</code> (with its sub items), when user selects an item name which are populated also in <code>ComboBox</code>.</p>\n\n<p>I know the event to use i.e., <code>SelectedIndexChanged</code> event. But I dont know what to do in that.</p>\n\n<p>Currently I am using alternative big process which includes XML file and dataset which makes my project more complex.</p>\n\n<p>The <code>ListView</code> has many items in it. Same item names are also in <code>ComboBox</code>.</p>\n\n<p>If you have time please take a look at my very small project. <strong><a href=\"http://dl.dropbox.com/u/87374848/FlagsApp%201001.zip\" rel=\"nofollow\">download</a></strong></p>\n\n<p><strong>EDIT</strong>:     Here \"<em>Show only one item</em>\" means strictly show only one item, not select the particular item and show all the items.</p>\n"},{"tags":["c#","arrays","winforms","combobox"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":149,"score":0,"question_id":11247093,"title":"How to populate ComboBoxes by lines of a string Array?","body":"<p>Please, what is wrong here  </p>\n\n<pre><code>abc = labGuns.Text;  // multiline label\nstring[] arr = Regex.Split(abc, \"\\r\\n\");\nx = 0; \nforeach (string line in arr)\n{\n    MessageBox.Show(line); //works fine - shows each line of label\n    x = x + 1;\n    string abc = \"cbGuns\" + x.ToString();\n    MessageBox.Show(abc); //works fine - shows \"cbGuns1\", \"cbGuns2\"...\n    foreach (Control c in panPrev.Controls)\n    {\n        if (c.Name == abc) // five combos named cbGuns1, cbGuns2...\n        {\n            c.Text = line; //doesn't work. No combo changes its text\n        }\n    }\n}\n</code></pre>\n\n<p>If I change last line to - <code>c.Text = \"323\"</code> - also nothing happened.<br>\nSo, mistake is obviously somewhere near the end of code.</p>\n\n<p>This code also works (as test):  </p>\n\n<pre><code>foreach (Control c in panPrev.Controls)\n{\nif (c.Name == \"cbGuns1\")\n{\nc.Text = \"323\";\n}\n}\n</code></pre>\n"},{"tags":["c#","winforms","timer"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":49,"score":4,"question_id":13045297,"title":"Executing a Function at a Specific time","body":"<p>I have a timer running in my app which I want to stop and start according to local time.\nSo I need something like this:</p>\n\n<pre><code>if ( time = 08:00) {StartTimer();}\nIf ( time = 18:00) {StopTimer();} //This can be done from the timer event itself\n</code></pre>\n\n<p>Is there a way to do this <strong>without</strong> using another timer?\nI can stop the timer from within the timer event itself, but how will i start it again?</p>\n"},{"tags":["c#","sql-server","winforms","ado.net"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":89,"score":1,"question_id":13044808,"title":"Error converting data type nvarchar to numeric","body":"<p>I used the following statement for a parameter.</p>\n\n<pre><code>comm.Parameters.Add(\"@name\", SqlDbType.NVarChar, 50).Value = txtname.Text;\n</code></pre>\n\n<p><code>Name</code> is a SQL Server <code>nvarchar</code> column but I get this error:</p>\n\n<blockquote>\n  <p><em>Error converting data type nvarchar to numeric.</em></p>\n</blockquote>\n\n<p>My sql: </p>\n\n<pre><code>SqlCommand comm = conn.CreateCommand();\ncomm.CommandText = \"execute addName @name\";\ncomm.Parameters.Add(\"@name\", SqlDbType.NVarChar, 50).Value = txtname.Text;\n\nconn.Open();\ncomm.ExecuteNonQuery();\nconn.Close();\n</code></pre>\n\n<p>Can help my to fix this problem?\nMy store procedure:</p>\n\n<pre><code>USE [info]\nGO\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nALTER procedure [dbo].[addName]\n            @id numeric(18,0) = 0,\n            @name nchar(50)\nas\nif (select name from TName where name = @name) is null\nbegin\nselect @id =  MAX(id)+1 from TName\ninsert into TName\nvalues (@id, @name)\nprint @id\nend\nelse\nbegin\nprint 'Eroare'\nend\n</code></pre>\n"},{"tags":["c#","winforms","events"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":103,"score":0,"question_id":13042166,"title":"C# form Activated and Deactivate events","body":"<p>I have two forms, mainForm and subForm. When mainForm loses focus I want subForm to disappear and then reappear as mainForm regains focus. I'm using the Activated and Deactivate events on the mainForm to keep track of whether mainForm has focus or not. When the Activated is fired I do subForm.Show() and the opposite for Deactivate. The problem I have is that when subForm gains focus mainForm disappear because I don't know how to say programmatically \"make subForm disappear when the mainForm's Deactivate event fires except if it's because the subForm gained focus. The whole point of what I'm doing is to make both windows disappear when the mainForm loses focus because the user clicked on another application or use ALT+TAB to switch. I don't want to leave the subForm behind. Is there any way of checking as the Deactive fires whether it was because another form belonging to the application gained focus as opposed to some other application?</p>\n\n<pre><code>class MainForm : Form\n{\n    SubForm subForm = new SubForm();\n\n    private void mainForm_Activated(object sender, EventArgs e)\n    {\n        this.subForm.Show();\n    }\n\n    private void mainForm_Deactivate(object sender, EventArgs e)\n    {\n        this.subForm.Hide()\n\n        // I need some logic to make sure that it is only hidden\n        // when the mainForm loses focus because the user clicked\n        // some other application in the taskbar and not when the\n        // subForm itself gains the focus.\n    }\n}\n</code></pre>\n"},{"tags":["c#",".net","winforms","multithreading","savefiledialog"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":1,"view_count":1091,"score":3,"question_id":6069983,"title":"SaveFileDialog: InvalidOperationException due to \"owner\" parameter in a multi-threaded application","body":"<p>Sorry for the long post, but I tried to explain the problem very detailed so that no confusion should arise. The last sentence contains the actual question.</p>\n\n<p>I'm programming a multi-thread application with C#/.NET.</p>\n\n<p>The application consists of a main window, which visualizes data, coming from a pressure sensor. The sensor data is acquired in an own thread.</p>\n\n<p>The data is also logged in an instance of class <code>ListView</code>:</p>\n\n<p><img src=\"http://i.stack.imgur.com/iO05j.png\" alt=\"enter image description here\"></p>\n\n<p>There is the possibility to save the logged data to file on disk via a \"Save\" button (should open an instance of .NET class <code>SaveFileDialog</code>).</p>\n\n<p>This <code>SaveFileDialog</code> is also running in an own thread.\nNow there's a problem when calling the method <code>SaveFileDialog.ShowDialog()</code>:</p>\n\n<blockquote>\n  <p>System.InvalidOperationException was unhandled\n        Message=\"Cross-thread operation not valid: Control 'tlpMain' accessed from a thread other than the thread it was created on.\"\n        Source=\"System.Windows.Forms\"</p>\n</blockquote>\n\n<p>The problem arises because the owner (the main window) of the <strong>SaveFileDialog</strong> is running in another thread.</p>\n\n<p>Here's the code, which creates the thread for the SaveFileDialog():</p>\n\n<pre><code>private void bSave_Click(object sender, EventArgs e)\n{\n    Thread saveFileDialog = new Thread(OpenSaveFileDialog);\n    saveFileDialog.SetApartmentState(ApartmentState.STA);\n    saveFileDialog.Start();\n}\n</code></pre>\n\n<p>Code for method OpenSaveFileDialog():</p>\n\n<pre><code>private void OpenSaveFileDialog()\n{\n    SaveFileDialog saveFileDialog = new SaveFileDialog();\n    saveFileDialog.Filter = \"Text Files (*.txt)|*.txt|CSV (*.csv)|*.csv|All Files (*.*)|*.*\";\n    saveFileDialog.FilterIndex = 0;\n\n    /* Call \"ShowDialog\" with an owner (\"this.Parent\") to achieve, so that\n     * the parent window is blocked and \"unclickable\".\n     * \n     * Danger of an \"InvalidOperationException\" because \"this.Parent\" control\n     * is running (was created) in another thread.\n     * But \"this.Parent\" should not be modified by this method call.\n     */\n    DialogResult pressedButton = saveFileDialog.ShowDialog(this.Parent);\n    ...\n</code></pre>\n\n<p>The <strong>InvalidOperationException</strong> is only thrown/displayed when running the application with Visual Studio's debugger. It is no problem - so far - when running the application \"normally\".</p>\n\n<p>But I would like to avoid this problem.</p>\n\n<p>I tried to build a wrapper method (SaveFileDialog):</p>\n\n<pre><code>private void OpenSaveFileDialog()\n{\n    SaveFileDialog saveFileDialog = new SaveFileDialog();\n    ...\n    SaveFileDialog(saveFileDialog, this.Parent);\n}\n</code></pre>\n\n<p>Wrapper method :</p>\n\n<pre><code>private void SaveFileDialog(SaveFileDialog saveFileDialog, Control owner)\n{\n    if (owner.InvokeRequired)\n        BeginInvoke(new dSaveFileDialog(SaveFileDialog), new object[] { saveFileDialog, owner });\n    else\n    {\n        DialogResult pressedButton = saveFileDialog.ShowDialog(owner);\n        ...\n</code></pre>\n\n<p>This leads to a <code>TargetInvocationException</code> although the <code>Main()</code> method is labeled with <code>[STAThreadAttribute]</code>:</p>\n\n<blockquote>\n  <p>InnerException: System.Threading.ThreadStateException\n         Message=\"Current thread must be set to single thread apartment (STA) mode before OLE calls can be made. Ensure that your Main function has STAThreadAttribute marked on it. This exception is only raised if a debugger is attached to the process.\"\n         Source=\"System.Windows.Forms\"</p>\n</blockquote>\n\n<p>Does anybody have a clue how to open the <code>SaveFileDialog</code> in a way, so that the main window will be blocked (\"unclickable\") without having the (thread) trouble?</p>\n\n<p>Thank you.</p>\n"},{"tags":["c#","winforms","mdiparent"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13044618,"title":"Set Wpf parent to a MDIform","body":"<p>I have a win form application with a <code>MDI Form</code>.</p>\n\n<p>for some reason i used a <code>WPF Window</code> in my application.\nso i want to ask how can i set WPF window parent to my MDI Form?</p>\n"},{"tags":["c#","winforms","datagridview","footer"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2678,"score":2,"question_id":2627348,"title":"adding footer value to datagridview in C#","body":"<p>I am having 2 datatables. One is having the actual value of that table selected by the user and the next is having the aggregate value for that table i.e any grand total or avg. I want to display this as the footer in C# datagridview. How can I do that??? In asp.net we have RowDataBound event like that similar something is there in C# also but what it is i'm not able to find.</p>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13043076,"title":"textBox value and button click count- executing code depedant on textbox value","body":"<p>I am currently working with clicking count and textBox values. <code>Button1</code> purpose is to execute an specific function depending on the value that <code>texbox7</code> has. I am not getting any results when I try firing the button click event. Can someone suggest/help ?</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>    private List&lt;string&gt; messages = new List&lt;string&gt;() { \"Option1\", \"Option2\", \"Option3\", \"Option4\" };\n  private void button1_Click(object sender, EventArgs e)\n  {\n\n    if (textBox7.ToString() == \"Option1\")\n                {\n                    int min = max;\n                    int n = 0;\n                    string s = \"\";\n\n                    sw.Start();\n\n\n                }\n                else if (textBox7.ToString() == \"Option2\")\n                {\n                }\n                else if (textBox7.ToString() == \"Option3\")\n                {\n                }\n                else if (textBox7.ToString() == \"Option4\")\n                {\n                }\n                else if (textBox7.ToString() == \"\")\n                {\n                    MessageBox.Show(\"Please input information\");\n                }\n       }\n</code></pre>\n"},{"tags":["c#","winforms","datagridview","tableadapter"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17524,"score":1,"question_id":2084346,"title":"Delete selected row from datagridview and update DB","body":"<p>I have a datagridview and the user will select a row, then click on a Delete button. The row should then delete AND the DB needs to update using tableadapters.</p>\n\n<p>How can I do this? The code is in C#...</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>private void btnDelete_Click(object sender, EventArgs e)\n{\n    if (this.dataGridView1.SelectedRows.Count &gt; 0)\n    {\n        dataGridView1.Rows.RemoveAt(this.dataGridView1.SelectedRows[0].Index);\n    }                \n}\n</code></pre>\n\n<p>Furthermore, this only deletes one row. I would like it where the user can select multiple rows.</p>\n\n<p>Thanks much.</p>\n"},{"tags":["c#","winforms","multithreading","gui"],"answer_count":20,"favorite_count":104,"up_vote_count":118,"down_vote_count":1,"view_count":108306,"score":117,"question_id":661561,"title":"How to update the GUI from another thread in C#?","body":"<p>What is the simplest way to update a label from another thread?</p>\n\n<p>My problem: I have a winform(thread1), from that I'm starting another thread(thread2).\nWhile thread2 is processing some files, I would like to update a label on the winform with status from thread2.</p>\n\n<p>How can I do that?</p>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":13043971,"title":"how to determine which textbox is focused and add text to it...........?","body":"<p>im doing  a complex calculator in  C#.  the first textbox accepts the real part and the second accepts the immaginary part. i wanna be able to use the mouse to enter values also. so if i click button1 it will concat \"1\" to the value in the textbox on which the focus is on . i cant determine  which textbox is focused. i tried the  stuff some  people posted, like using GotFocus for exemple, and non had worked..</p>\n\n<pre><code>    private Control focusedControl;\n\n    private void TextBox_GotFocus(object sender, EventArgs e)\n    {\n        focusedControl = (Control)sender;\n    }\n\n\n    private void button1_Click(object sender, EventArgs e)\n    {\n        if (focusedControl != null)\n        {\n            focusedControl.Focus();\n            SendKeys.Send(\"1\"); \n\n        }\n\n    }\n</code></pre>\n"},{"tags":["c#",".net","winforms","datagridview","split"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":184,"score":1,"question_id":11090642,"title":"Split multiline string by lines and comma and place the parts into DataGridView","body":"<p>I want to split and transpose a multiline string from one DataGridView(dgvObs) to separate rows and columns in another DataGridView(dgvSm).<br>\nThis code works, but - maybe there is a better solution:  </p>\n\n<pre><code>object val = dgvObs.Rows[0].Cells[2].Value;\nif (val == null) return;\n\nstring text = val.ToString();\nusing (StringReader sr = new StringReader(text))\n{\n   string line;\n   while ((line = sr.ReadLine()) != null)\n   {\n      string[] divLine = line.Split(',');\n      dgvSm.Rows.Add(divLine);\n   }\n}\n</code></pre>\n"},{"tags":["c#",".net","winforms","datagridview","datagridviewcomboboxcell"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":901,"score":1,"question_id":11141872,"title":"Event that fires during DataGridViewComboBoxColumn SelectedIndexChanged","body":"<p>I have DataGridView with two columns. The first column is TextBoxCol(DataGridViewTextBoxColumn) and the Second one is ComboBoxCol(DataGridViewComboBoxColumn).</p>\n\n<p>How can I change the value of TextBoxCol when ComboBoxCol changes its selected index value?\n(This should happen when selected index changed in ComboBoxCol. Not after leaving the column, like dataGridView_CellValueChanged)</p>\n\n<p>I have read one topic with almost the same problem that I am having but I dont understand the answer(which should be correct base on the check mark). Here's the link. <a href=\"http://stackoverflow.com/questions/4154713/how-to-create-event-handler-for-datagridviewcomboboxcolumn-in-a-data-grid-view-i\">-Almost same topic</a></p>\n"},{"tags":["c#",".net","winforms","datagridview","datagridcomboboxcolumn"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":530,"score":1,"question_id":11277632,"title":"Change DatagridviewTextBox Text When DatagridviewComboBox Selected Index Changes","body":"<p>In My <code>DatagridView</code>,I Have Two Columns, <code>ComboxboxColumn</code> and <code>TextboxColumn</code>. I want to change the value of textbox \nwhen combobox selected index changes (in general combobox it has selected index change event but <code>datagridviewComboBox</code> does not have it)</p>\n"},{"tags":["c#",".net","winforms","datagridview","scrolling"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":395,"score":2,"question_id":11471041,"title":"Winforms autoscroll getting lost when controls resize","body":"<p>I have a user control that display a passenger car seating layout.</p>\n\n<p>It simple draws several \"SeatControl\" in a matrix like fashion, depending on the passenger car size.</p>\n\n<p>For better viewing, the main control resizes the \"SeatControl\" for fitting all space available, that means that the SeatControls will get bigger or smaller depending on the space available.</p>\n\n<p>This works perfect.</p>\n\n<p>But, when the client area gets too small, we avoid shrinking the controls too much, or they became deformed and impossible to read. </p>\n\n<p>In this case we turn on auto scroll so the user can scroll around to see the entire layout.</p>\n\n<p>But, if we start with a small screen (with scroll bar), maximize it (the scroll bar will hide and the seat controls increase size) and restore the window size back (scroll will come back and seat controls will shrink to minimum size), the scroll gets lost.</p>\n\n<p>To make it clear, the same operation in images:\n<img src=\"http://i.stack.imgur.com/j607E.jpg\" alt=\"small layout with vertical scroll bar\"></p>\n\n<p>Maximize the window (only partial screen show to avoid a big image):</p>\n\n<p><img src=\"http://i.stack.imgur.com/dubjJ.jpg\" alt=\"partial full screen, notice that scroll has gone as expected\"></p>\n\n<p>And restore it back (notice the scroll bar and the layout position on client area):\n<img src=\"http://i.stack.imgur.com/PEvqe.jpg\" alt=\"but on scroll bar\"></p>\n\n<p>This resize is controlled by the code below:</p>\n\n<pre><code>private void FixSizes()\n    {            \n        if (mModel == null)\n            return;\n\n        this.SuspendLayout();            \n\n        Size clientSize = this.ClientSize;\n        Size minimumSize = new Size(SeatUserControl.MinimumDescentSize.Width, SeatUserControl.MinimumDescentSize.Height);\n\n        //Here we try to find the best size for the seat user control to fit all the client area                      \n        Size controlSize = new Size(\n            Math.Max(clientSize.Width / mModel.Length, minimumSize.Width),\n            Math.Max(clientSize.Height / mModel.Width, minimumSize.Height)\n        );\n\n        AutoScrollMinSize = new Size(controlSize.Width * mModel.Length, controlSize.Height * mModel.Width);\n        this.SetDisplayRectLocation(0, 0);\n\n        for (int row = 0; row &lt; mModel.Width; ++row)\n        {\n            for (int col = 0; col &lt; mModel.Length; ++col)\n            {\n                Control control = this.Controls[(row * mModel.Length) + col];\n\n                control.Location = new Point(col * controlSize.Width, row * controlSize.Height);\n                control.Size = controlSize;\n            }\n        }            \n\n        this.ResumeLayout();\n    }\n</code></pre>\n\n<p>And this method is simple called by the OnClientSizeChanged method:</p>\n\n<pre><code>protected override void OnClientSizeChanged(EventArgs e)\n    {\n        base.OnClientSizeChanged(e);\n\n        this.FixSizes();\n    }\n</code></pre>\n\n<p>I was able to determine that if I keep the SeatControl on a fixed size, the problem goes away, but the output is not so good, as we prefer the SeatControl to use the maximum space available.</p>\n\n<p>So it looks like I am missing or forgetting to do something with autoscroll settings so it does not get lost. Any ideas?</p>\n"},{"tags":["c#",".net","winforms","panels","dockpanel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":12877668,"title":"Docked panels layout","body":"<p>In winforms I am trying to setup 4 panels docked: top, left, right and middle.  But when I dock the top and try to dock another panel on the left, that left panel overlays the top panel..Am I doing something wrong there? is there another way of docking several panels?</p>\n"},{"tags":["c#",".net","winforms","visual-studio-2010","windows-forms-designer"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13033409,"title":"To make grid in List View appeared in IDE","body":"<p>I am using VS2010 Windows Form</p>\n\n<p>Here's the list view after I dropped it to the windows form, and after adding the column, using columns attribute in the IDE.</p>\n\n<p><img src=\"http://i.stack.imgur.com/NEq1m.jpg\" alt=\"enter image description here\"></p>\n\n<p>I wish that I can have something like below display in the IDE, what attributes should I change?  </p>\n\n<p><img src=\"http://i.stack.imgur.com/Zbzbm.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13042837,"title":"Populating textBox with value depending on button click count","body":"<p>I am new to coding in C#. Currently I am encountering the problem of populating a <code>textBox</code> depending on the amount of times <code>button1</code> is clicked. I have been able to populate option one but I am not sure how to get the second option after the second click and so fourth. How would I be able to do that? Also, Would I need to add a loop to start over after the fourth click?</p>\n\n<p><strong>Code</strong> </p>\n\n<pre><code>protected void Button1_Click(object sender, EventArgs e)\n{\n     MyTextBox.Text = \"Fruits\"; //1st click\n     MyTextBox.Text = \"Vegtables\"; //2nd click\n     MyTextBox.Text = \"Grains\"; //3rd click\n     MyTextBox.Text = \"Poultry\"; //4th click\n\n}\n</code></pre>\n"},{"tags":["c#","winforms","gui","recursion","bitmap"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":13041739,"title":"Which is faster, drawing recursively to a bitmap once or recursively to the screen?","body":"<p>This is an addition to this similar question: <a href=\"http://stackoverflow.com/questions/12944701/which-is-faster-when-animating-the-ui-a-control-or-a-picture\">Which is faster when animating the UI: a Control or a Picture?</a>.</p>\n\n<p>I am recursively iterating through a tree of shapes and drawing each visible shape to the screen. At about 2-3 generations, things handle smoothly when the user zooms in or pans in real time, but when it gets to about 4-6 generations, things slow down. </p>\n\n<p>To help increase performance, would it be better to draw to a bitmap on every tree-update and then draw that bitmap every invalidation, or to go through the recursion it's self every invalidation?</p>\n\n<p>I'm working on the solution right now, but your answers are still appreciated before I finish!</p>\n"},{"tags":["c#","winforms",".net-4.0","timer","countdown"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":111,"score":2,"question_id":13040659,"title":"Remaining time based on progress?","body":"<p>I would like to output the time remaining for a process on the following format:</p>\n\n<pre><code>d hh:mm:ss\n</code></pre>\n\n<p>When the process start, it sets a <code>DateTime startTime</code>variable with the current time.</p>\n\n<p>From there I have timer on my GUI that updates a label every second and here is what I have to calculated the remaining time:</p>\n\n<pre><code>TimeSpan timeRemaining = TimeSpan.FromTicks(DateTime.Now.Subtract(startTime).Ticks * (iProgress.Maximum - iProgress.Value) / iProgress.Value);\n</code></pre>\n\n<p>And using on the label as:</p>\n\n<pre><code>labelTimeRemaining.Text = timeRemaining.ToString(@\"d\\ hh\\:mm\\:ss\");\n</code></pre>\n\n<p>However the time variation is displayed is going on very oddly jumping several minutes with getting into a steady mode.</p>\n\n<p>I know it should jump on the begin but it should stabilize at some point right ?</p>\n\n<p>I process about 1~3 records per second however the time remaining is jumping 10~20 minutes every update.</p>\n\n<p>What am I doing wrong or how could I fix this issue ?</p>\n\n<p>Let me know if u need more info or code.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Below is portion of the code I am using:</p>\n\n<pre><code>private Stopwatch _timer = new Stopwatch();\nprivate int _total = 0;\nprivate int _current = 0;\n</code></pre>\n\n<p>Start a thread or task with:</p>\n\n<pre><code>private void MyTask()\n{\n    _timer.Reset();\n    _timer.Start();\n    for (int i = 0; i &lt; _total; i++)\n    {\n        _current++;\n        Thread.Sleep(500);\n    }\n    _timer.Stop();\n}\n</code></pre>\n\n<p>Create a winforms Timer with the below function to run every second:</p>\n\n<pre><code>if (_timer.IsRunning &amp;&amp; _current &gt; 0)\n{\n    float elapsedMin = ((float)_timer.ElapsedMilliseconds / 1000) / 60;\n    float minLeft = (elapsedMin / _current) * (_total - _current);\n    TimeSpan eta = TimeSpan.FromMinutes(minLeft);\n    iStatus.Text = eta.ToString(@\"d\\ hh\\:mm\\:ss\");\n}\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":13039624,"title":"Making text popup in a C# forms application on mouseover","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/11644277/create-custom-tooltip-c-sharp\">create custom tooltip C#</a>  </p>\n</blockquote>\n\n\n\n<p>Does anyone know of a way to make a box 'popup' when the user cursors over a certain item?</p>\n\n<p>For example, I want to have a PictureBox on a C# forms application and when the user cursors over it, a box of text will pop up.</p>\n\n<p>I'm aware of <code>ToolTip</code> however I was thinking of something more customisable; in my mind I'm thinking of the kind of popup boxes you see in World of WarCraft when you cursor over an item in your inventory (obviously it doesn't have to be THAT flashy, but at least one where the text colour, background colour, text etc. are all modifiable).</p>\n"},{"tags":["c#","winforms","windows-shell","windows-explorer","notifyicon"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":1,"view_count":112,"score":4,"question_id":13037168,"title":"How do I remove the \"wrench\" button on the balloon tooltip?","body":"<p>I want to hide the wrench button on the balloon tooltip\n<br>Does anyone know how? Is it possible to disable/remove the <strong>wrench button</strong> next to the close button on the balloon tooltip in the system tray that is being called from <code>System.Windows.Forms.NotifyIcon</code>?</p>\n\n<p><img src=\"http://i.stack.imgur.com/qtNS8.png\" alt=\"Balloon Tooltip\"></p>\n\n<p>Please help <br>Thanks in advance.</p>\n"},{"tags":["c#","winforms","drawing"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13039699,"title":"System Drawing Invert Region build out of Path","body":"<p>Ive got a <code>panel</code> and im drawing a heart on that <code>panel</code>..\nBut i dont want to draw the heart i want to draw everything except the heart so the heart is transparent.\nCan i invert the <code>Region</code> selected out of the <code>Path</code>?</p>\n\n<pre><code>System.Drawing.Drawing2D.GraphicsPath path = new System.Drawing.Drawing2D.GraphicsPath();\n            path.AddArc(0, 0, (this.Width / 2), (this.Height / 2), 135, 195);\n            path.AddArc((this.Width / 2), 0, (this.Width / 2), (this.Height / 2), 210, 195);\n            path.AddLine((this.Width / 2), this.Height, (this.Width / 2), this.Height);\n            this.Region = new Region(path);\n            this.BackColor = Color.Black;\n</code></pre>\n\n<p>What it looks like(white = transparent):<img src=\"http://i.stack.imgur.com/5cvjQ.png\" alt=\"1\"></p>\n\n<p>What i want it to look like(white = transparent):\n<img src=\"http://i.stack.imgur.com/j22nu.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13039729,"title":"How can I find out what is the name of the main form object","body":"<p>Pretty short question: How can I find out what is the name of the main form object?</p>\n\n<p>I want to know this, because I want to call some of the functions or get some of the variables from the main form object. Of course, I need to know the name of the object to do so (is this a good idea?).</p>\n"},{"tags":["c#","winforms","console-application"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":87,"score":-1,"question_id":13038973,"title":"Enabling a console application through a Windows Forms application","body":"<p>I'm not going to go into details why am trying to do this, instead of making the main application do the work. I think it's currently easier for me. But I'm not going to use this technique in the future.</p>\n\n<p>In my case, the main form has a button that opens another form. In the second one for you can adjust the amount, pause, resume and stop the work of the console application (sound totally useless (and maybe stupid), but, like I said, I'm not going to go into details why). This means that the application must have access to all the variables and resources of the whole program and vise versa.</p>\n\n<p>I know how to launch a new form trough a main form, but I don't know how to launch a console application.</p>\n\n<p>EDIT:</p>\n\n<p>I forgot to mention, that the console application is a part of the solution.</p>\n"},{"tags":["c#","winforms","visual-studio-2010","windows-services","parameter-passing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13038495,"title":"Passing parameters/args to Windows Service via Windows Form","body":"<p>Simple line of code, refusing to work.</p>\n\n<p>I have a running service in the background, that quite simply checks if a process is running then terminates it. I know it works as I have set a value. However what I want to be able to do is use a Windows Form as an Interface, pass in a name for example 'calc' (for calculator) and then it will push that to the Windows Service and then start checking. \nOn a google and look around here, I found out about this:</p>\n\n<pre><code> string[] myArgs = new string[1] { textBox1.Text };\n        serviceController1.Start(myArgs);\n</code></pre>\n\n<p>That is a crude example of the code being invoked on a button press.</p>\n\n<p>It might be worth noting that on the serviceController properties I have typed in the corresponding service name, however it's not in the list that populates.</p>\n\n<p>Also the service is on the LOCAL SYSTEM, and here is the code from the service:</p>\n\n<pre><code>    protected override void OnStart(string[] args)\n    {\n        eventLog1.WriteEntry(\"In OnStart\");\n        eventLog1.WriteEntry(\"Passing first process... \");\n\n        //Stuff here\n\n    }\n</code></pre>\n\n<p>When running here's the error:</p>\n\n<blockquote>\n  <p>Cannot start service [servicename] on computer '.'</p>\n</blockquote>\n\n<p>I have also tried setting the machine name to no avail; Thanks in advance guys. </p>\n\n<p>Is it because it's not in the OnContinue() method? \n<strong>EDIT:</strong> A*ttempted to change OnContinue to accept arguments and then on the graphical interface use* </p>\n\n<pre><code>serviceController1.Pause();\nserviceController1.Continue(MyArgs);\n</code></pre>\n\n<p><em>(also MyArgs[0])but that didn't work either.. 'Cannot Pause Service...'</em></p>\n"},{"tags":["c#","winforms","image"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":13020645,"title":"Replace part of an image with another in C# with WinForms","body":"<p>I have a big .PNG that has many little images on it. I want to replace part of the big image with a smaller one. So at X and Y coordinates, that part of the image will be replaced starting from the top left hand corner, while still leaving the rest of the original image intact.</p>\n\n<p>I have been reading about the Graphics methods on MSDN and also had a look for some examples of a similar thing but didn't find much.</p>\n\n<p>Had anyone done anything similar? </p>\n\n<p>Thanks!</p>\n"},{"tags":[".net","winforms","c++-cli","visual-studio-2012","windows-forms-designer"],"answer_count":2,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":199,"score":6,"question_id":12952670,"title":"Visual Studio 2012 winform designer is VERY slow","body":"<p>We've recently migrated one of our Winforms projects to Visual Studio 2012 from Visual Studio 2008. The transition has went remarkably smoothly and everything builds just fine, however we're now struggling with the winforms designer, which is running incredibly slow.</p>\n\n<p>To give an example, if we open a small form (the form contains two text boxes, a numeric updown and two buttons - all standard built-in controls, nothing 3rd party), it will take approximately 40-45 seconds in 2012, however on 2008 it would open in 1 or 2 seconds. For our larger forms, this difference is much more pronounced. In 2008, it would take about 7 seconds to open the form but in 2012 its taking <strong>over 6 minutes</strong>. The worst part is that this is a blocking action, VS2012 is almost completely unresponsive while opening the forms. This also happens just by clicking on the .h of a form, so it's not like we can easily avoid it just by sticking to the code itself.</p>\n\n<p>Has anyone else experienced this? Does anyone know why it's happening and if there's anything that can be done about it?</p>\n\n<p>Additional information: Our application is a C++/CLI winforms app. The behaviour is seen on all of our development machines, which run Windows 7 x64. \nMy machine is a Core i7 860 CPU with 12Gb of RAM (over 60% free right now while I was benchmarking the above) - more than enough, I would think. In any case, my system is by no means running slow, it's just the VS2012 designer.</p>\n\n<p>EDIT: Just for extra clarification, we haven't installed ANY addons or anything like that. This is a virgin VS2012 install.</p>\n\n<p>EDIT2: It doesn't seem to be a network thing, either.</p>\n"},{"tags":["c#","winforms","clipboard","sendinput"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13035775,"title":"SendInput Ctrl + C and then retrieve copied content through Clipboard.GetText doesn't work","body":"<p>I have a simple windows forms application with a <code>TextBox</code> and a <code>Button</code>. Clicking on the <code>Button</code> will put focus on the <code>TextBox</code> and simulate keystrokes <code>Ctrl + C</code> to copy the content into the clipboard. I am doing this key simulation with <code>SendInput</code>, also tried <code>SendKeys.Send(\"^c\")</code>. This works properly for the copy operation, as I can verify by pasting the content to a notepad or something else.</p>\n\n<p>I then want to programmatically retrieve this copied value through <code>Clipboard.GetText</code>. However, the problem is that this method always seems to return the <strong>previous</strong> value in Clipboard instead of the current one. For example, if the sequence of values for my <code>TextBox</code> is: \"hello\", \"world\", then the sequence of output is: junk, \"hello\". Below is my code using the <code>SendKeys</code> method for simplicity:</p>\n\n<pre><code>... highlight TextBox value...\n\nSendKeys.Send(\"^c\");\nThread.Sleep(100);\n\nConsole.WriteLine(Clipboard.GetText());\n</code></pre>\n"},{"tags":["c#",".net","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":269,"score":1,"question_id":8197923,"title":"Winforms - How to prevent Listbox item selection","body":"<p>In WinForms I occationally have a loop running over a Listbox selecting Items.</p>\n\n<p>During that time I don't want the user to select items in that listbox with the mouse or keys.</p>\n\n<p>I looked at MyListbox.enabled=false but it grays out all items. Dont't want that.</p>\n\n<p>How to prevent selecting items in a Listbox?</p>\n"},{"tags":["c#","winforms","openfiledialog"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13036254,"title":"Prompt user with an output file dialog at program startup (initialize)","body":"<p>I am currently working with output files. I am in the process of building a program that request for the user to save an output file before the program does anything else. The purpose is that the program will write results to this output file. I have been able to get the output file dialog to appear with a button click. Is there away to prompt the user with output file dialog as soon as the program initializes?</p>\n\n<p>Code-output file through button:</p>\n\n<pre><code>namespace open_document\n{\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\nprivate void button1_Click(object sender, EventArgs e)\n        {\n            OpenFileDialog openFile = new OpenFileDialog();\n            openFile.Filter = \"Text Files | *.txt\";\n            openFile.ShowDialog();          \n            StreamReader infile = File.OpenText(openFile.FileName);\n\n        }\n\n    }\n}\n</code></pre>\n"},{"tags":["c#","winforms","loops"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":12782933,"title":"|SOLVED| - Form is not available and doesn't update while a loop is in progress","body":"<p>I have a method that has a for loop in it.  In the for loop I want to update some label's text on the mainform, but the changes are only done after the loop ends.</p>\n\n<p>I tried to do it on another thread like this:</p>\n\n<pre><code>Thread firstthread = new Thread(new ThreadStart(myMethod));\nfirstthread.Start();\n</code></pre>\n\n<p>When I did that I got an <code>InvalidOperationException</code> because of trying to access controls on another thread or something like that.</p>\n\n<p>How should I update the labels(or other controls) on the mainform from a loop while the loop is in progress?</p>\n\n<p>[SOLUTION]:\nI used <code>BackgroundWorker</code> as Servy said it freed up the form while the loop was running, but I found the solution for the updating the controls <a href=\"http://stackoverflow.com/questions/661561/how-to-update-the-gui-from-another-thread-in-c\" title=\"http://stackoverflow.com/questions/661561/how-to-update-the-gui-from-another-thread-in-c\">here</a> and <a href=\"http://msdn.microsoft.com/en-us/library/ms171728%28v=vs.110%29.aspx\" rel=\"nofollow\" title=\"http://msdn.microsoft.com/en-us/library/ms171728%28v=vs.110%29.aspx\">this</a> helped me understanding the code:</p>\n\n<pre><code>private delegate void SetControlPropertyThreadSafeDelegate(Control control, string propertyName, object propertyValue);\n\npublic static void SetControlPropertyThreadSafe(Control control, string propertyName, object propertyValue)\n{\n  if (control.InvokeRequired)\n  {\n    control.Invoke(new SetControlPropertyThreadSafeDelegate(SetControlPropertyThreadSafe), new object[] { control, propertyName, propertyValue });\n  }\n  else\n  {\n    control.GetType().InvokeMember(propertyName, BindingFlags.SetProperty, null, control, new object[] { propertyValue });\n  }\n}\n</code></pre>\n\n<p>usage: <code>SetControlPropertyThreadSafe(label1, \"Text\", \"text of label1\");</code></p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":5,"up_vote_count":12,"down_vote_count":0,"view_count":105,"score":12,"question_id":13036107,"title":"Experiencing different behavior between object initialization in declaration vs. initialization in contructor","body":"<p>This is a WinForms C# application.\nThe following two snippits show two different ways of initializing an object. They are giving different results.</p>\n\n<p>This works as expected:</p>\n\n<pre><code>public partial class Form1 : Form\n{\n  private CameraWrapper cam;\n  public Form1()\n  {\n       cam = new CameraWrapper();\n       InitializeComponent();           \n  }\n</code></pre>\n\n<p>This does not work (details below):</p>\n\n<pre><code>public partial class Form1 : Form\n{\n  private CameraWrapper cam = new CameraWrapper();\n  public Form1()\n  {\n       InitializeComponent();\n  }\n</code></pre>\n\n<p>Inside <code>CameraWrapper</code> I am using a third-party SDK to communicate with a camera. I register with an event on the SDK which is called when results are available. </p>\n\n<p>In case 1 (initialization inside constructor), everything works as expected and the event handler inside <code>CameraWrapper</code> gets called. In case 2, the event handler never gets called.</p>\n\n<p>I thought that these two styles of object initialization were identical, but it seems not to be the case. Why? </p>\n\n<p>Here is the entire <code>CameraWrapper</code> class. The event handler should get called after a call to <code>Trigger</code>.</p>\n\n<pre><code>class CameraWrapper\n{\n    private Cognex.DataMan.SDK.DataManSystem ds;\n    public CameraWrapper()\n    {\n        ds = new DataManSystem();\n        DataManConnectionParams connectionParams = new DataManConnectionParams(\"10.10.191.187\");\n        ds.Connect(connectionParams);\n\n        ds.DmccResponseArrived += new DataManSystem.DmccResponseArrivedEventHandler(ds_DmccResponseArrived);\n    }\n\n    public void Trigger()\n    {\n        SendCommand(\"TRIGGER ON\");\n    }\n\n    void ds_DmccResponseArrived(object sender, DmccResponseArrivedEventArgs e)\n    {\n        System.Console.Write(\"Num barcodes: \");\n        System.Console.WriteLine(e.Data.Length.ToString());\n    }\n\n    void SendCommand(string command)\n    {\n        const string cmdHeader = \"||&gt;\";\n        ds.SendDmcc(cmdHeader + command);\n    }\n}\n</code></pre>\n"},{"tags":["c#","wpf","winforms","aero","aero-glass"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":494,"score":5,"question_id":11386452,"title":"WPF: Blurring the background of a semi-transparent form (like Aero glass)","body":"<p>I have a borderless, non-resizable WPF form (WindowStyle=None, AllowsTransparency=True, ResizeMode=NoResize) with a semi-transparent background. Here's a picture of how the form, a semi-transparent red rectangle, looks right now, running on top of Notepad:</p>\n\n<p><img src=\"http://i.stack.imgur.com/Aeen1.png\" alt=\"the form as it currently appears on top of Notepad\"></p>\n\n<p>However, I'd like the background to be blurred, like how Aero glass does it, except without all the fancy window borders and colored background with stripes - I'd like to handle that myself. Here's a mockup of how I want it to look like:</p>\n\n<p><img src=\"http://i.stack.imgur.com/KLE5s.png\" alt=\"the form as I want it to be - blur anything that's below it\"></p>\n\n<p>How can I achieve this in the most efficient way possible?</p>\n\n<p>WinForms or WPF is fine by me. Hopefully it should use the same thing Aero glass uses (I'm fine with it working only with Aero enabled), instead of something crazy like capturing the screen region below as a bitmap and blurring that.</p>\n\n<p>Here is a picture of what I DON'T want:</p>\n\n<p><img src=\"http://i.stack.imgur.com/WZcr8.png\" alt=\"I don't want the entire Aero glass window chrome\"></p>\n\n<p>I know this is possible and I know how to do it, but I DON'T want the entire Aero glass window chrome, or the borders and title bar, or the window to have the user-set Aero glass color, JUST the effect of blurring whatever is below the window/form.</p>\n\n<p>Thank you!</p>\n"},{"tags":["c#",".net","winforms","arrays"],"answer_count":6,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":5416,"score":3,"question_id":1836959,"title":"How to add to end of array C#?","body":"<p>How do I add a new <code>item</code> from a TextBox and Button on a Windows Form at the end of an <code>ArrayList</code> which references a class?</p>\n\n<pre><code>private product[] value = new product[4];\n\nvalue[1] = new product(\"One\",5)\nvalue[2] = new product(\"Two\",3)\nvalue[3] = new product(\"Three\",8)\n</code></pre>\n\n<h3>Workflow</h3>\n\n<ul>\n<li>Enter new products details into <code>textbox1</code>, <code>textbox2</code>, <code>textbox3</code> </li>\n<li><p>When I click <code>Add</code> the new product gets added to the array:</p>\n\n<p><code>value[1] = new product(\"One\",5)</code><br>\n<code>value[2] = new product(\"Two\",3)</code><br>\n<code>value[3] = new product(\"Three\",8)</code><br>\n<code>value[4] = new product(\"Four\",2)</code>  </p></li>\n</ul>\n\n<p>What is the code for doing this?</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":3,"view_count":58,"score":-3,"question_id":13009365,"title":"usb software lock","body":"<p>I need a solution for blocking and unblocking executable files using usb stick. i.e.,\nUser will select an exe from program files in his/her system, then it has to be blocked by the connected usb stick.\nand The exe shlouldn't open (run) without  that usb.</p>\n\n<p>c#</p>\n"},{"tags":["sql-server","winforms","named-pipes","tcp-ip","sqlbrowser"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13035500,"title":"How to enable named pipes and sqlbrowser on a remotely hosted database sever","body":"<p>I have a WinForms application that is giving some of my customers fits with regard to connection issues. (The infamous \"network-related or instance-specific error occurred while establishing a connection to SQL Server\" problem). The database that I am using is hosted by winhost.com and I do not have access to turn on named pipes, sqlbrowser, and TCP/IP. I know for sure that this will solve my problem, however, how do I go about doing this with only SQL Server Management Studio installed and the database server actually residing on a remote server? Is there a way to enable these configurations with Management Studio instead of using Configuration Manager?</p>\n\n<p>Thank you in advance.</p>\n"},{"tags":["c#",".net","winforms","datagridview","checkbox"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":13035419,"title":"Check if DataGridViewCheckBoxCell not bounded is checked","body":"<p>I have a DatagridView, and using a Dataset as DataSource. No problem with that.\nI've also added, in the datagridView, a checkboxColumn. I can't add this column to the Ds.</p>\n\n<p>I have a button, when I press it, I must \"check\" all checkbox's.</p>\n\n<p>Then, with another button, in a foreach, everyrow of the datagridview checked must do something.</p>\n\n<p>But, when I iterate, it doesn't recognize my checked check boxes.</p>\n\n<p>This is how I check them all.</p>\n\n<pre><code>    foreach (DataGridViewRow vr in this.DataGridView.Rows)\n        ((DataGridViewCheckBoxCell)vr.Cells[\"ColumnName\"]).Value = true;\n</code></pre>\n\n<p>After this, I see all Checkboxes checked.</p>\n\n<p>Then, when I must check which one are checked..</p>\n\n<pre><code>foreach (DataGridViewRow row in this.DataGridView.Rows)\n            {\n                if (Convert.ToBoolean(row.Cells[\"ColumnName\"].Value))\n                  {\n                   //do stuff\n                  }\n\n            }\n</code></pre>\n\n<p>I get null in all of them.</p>\n\n<p>I tried to add  <code>BeginEdit()</code> <code>and EndEdit()</code>, just like this:</p>\n\n<pre><code>this.DataGridView.BeginEdit(true);\n            foreach (DataGridViewRow vr in this.DataGridView.Rows)\n                ((DataGridViewCheckBoxCell)vr.Cells[\"ColumnName\"]).Value = true;\n            this.DataGridView.EndEdit();\n</code></pre>\n\n<p>and doesn't work too.</p>\n\n<p>Also tried to use the index column, instead of nameColumn, but no results.</p>\n\n<p>I tried to use <a href=\"http://stackoverflow.com/questions/6468263/datagridviewcheckboxcolumn-how-to-update-bound-datasource-on-property-changed-i\">this</a> answer, but doesn't work too. How can I save my check on each Checkbox in the column? Is the problem because isn't persisted in the dataset?</p>\n\n<p>The datagridview is configured on <code>ReadOnly = false</code> and <code>Enabled = true</code>, and <code>SelectionMode = FullRowSelect</code> (cannot change this, if its a problem). All the rest of the cells are <code>readOnly = true</code>, but this checkbox column, that is added in the designer-view of datagrid, is <code>ReadOnly = false;</code></p>\n\n<p>Thanks in advance</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":42,"score":0,"question_id":13033954,"title":"Make a wizard like application in WinForms","body":"<p>I've been developing an asp simple application with some form fields etc. I want to make it a wizard like application like when you type in some fields you can click next and a new section appears on the same form and finally using all the data collected from the forms I can perform my operations at the end. </p>\n\n<p>Kindly can you link me to such tutorials for winforms</p>\n"},{"tags":["c#","winforms","graphics","usercontrols"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12995673,"title":"How do you increase the translation speed after zooming in?","body":"<p>I have a control that zooms in and out, and pans. By clicking a choice of two buttons, the user may zoom in or out respectively. My issue is with the translations after zooming in or out: If I zoom out to about .2F, I have to click-pan multiple times to move the same distance I could have at base 0. I seemed to solved this by dividing the zoom by its self squared: z/(z*z) but that seems to transform the entire matrix - and I'm NOT translating the matrix with this on any line!</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Matrix mtrx = new Matrix();\nmtrx.Translate(pan.X, pan.Y);\nmtrx.Scale(zoom, zoom);\ne.Graphics.Transform = mtrx;\n\n// To-Do drawing code here\n</code></pre>\n\n<p>Basic notes:</p>\n\n<ul>\n<li>Zoom increases and decreases by .12F on button click event</li>\n<li>The control being painted on is an inherited UserControl class</li>\n<li>The developing environment is C# 2010</li>\n<li>The drawing code deals with two rectangles who's location is {0, 0}</li>\n<li>I just want to be able to pan at the same speed as I can at base 0 (not zoomed in or out) when I am zoomed in or out a ways. ~ no motion-lag feelings</li>\n</ul>\n\n<p>EDIT: I've updated the code above to an improved version of what I was dealing with before. This handles the panning speed for after zooming, but the new issue is with where the zoom is taking place: it's as if the point of zoom is being translated as well...</p>\n\n<p>Edit: How I would do this in 3D (XNA):<br></p>\n\n<pre><code>public class Camera\n{\n    private float timeLapse = 0.0f;\n    private Vector3 position, view, up;\n\n    public Camera(Vector2 windowSize)\n    {\n        viewMatrix = Matrix.CreateLookAt(this.position, this.view, this.up);\n        projectionMatrix = Matrix.CreatePerspectiveFieldOfView(MathHelper.Pi / 4.0f,\n                           (float)windowSize.X / (float)windowSize.Y, 0.005f, 1000.0f);\n    }\n    //Sets time lapse between frames\n    public void SetFrameInterval(GameTime gameTime)\n    {\n        timeLapse = (float)gameTime.ElapsedGameTime.Milliseconds;\n    }\n\n    //Move camera and view position according to gamer's move and strafe events.\n    private void zoomHelper(Vector3 direction, float speed)\n    {\n        speed *= (float)timeLapse; // scale rate of change\n        direction *= speed;\n        position.Y += direction.Y;\n        position.X += direction.X;      // adjust position \n        position.Z += direction.Z;\n        view.Y += direction.Y;\n        view.X += direction.X;      // adjust view change\n        view.Z += direction.Z;\n    }\n    //Allows the camera to move forward or backward in the direction it is looking.\n    public void Zoom(float amount)\n    {\n        Vector3 look = new Vector3(0.0f, 0.0f, 0.0f);\n        Vector3 unitLook;\n        // scale rate of change in movement\n        const float SCALE = 0.005f;\n        amount *= SCALE;\n        // update forward direction\n        look = view - position;\n        // get new camera direction vector \n        unitLook = Vector3.Normalize(look);\n        // update camera position and view position\n        zoomHelper(unitLook, amount);\n        viewMatrix = Matrix.CreateLookAt(position, view, up);\n    }\n\n    //Allows the camera to pan on a 2D plane in 3D space.\n    public void Pan(Vector2 mouseCoords)\n    {\n        // The 2D pan translation vector in screen space\n        Vector2 scaledMouse = (mouseCoords * 0.005f) * (float)timeLapse;\n        // The camera's look vector\n        Vector3 look = view - position;\n        // The pan coordinate system basis vectors\n        Vector3 Right = Vector3.Normalize(Vector3.Cross(look, up));\n        Vector3 Up = Vector3.Normalize(Vector3.Cross(Right, look));\n        // The 3D pan translation vector in world space\n        Vector3 Pan = scaledMouse.X * Right + -scaledMouse.Y * Up;\n        // Translate the camera and the target by the pan vector\n        position += Pan;\n        view += Pan;\n        viewMatrix = Matrix.CreateLookAt(position, view, up);\n    }\n}\n</code></pre>\n\n<p>Used like this:</p>\n\n<pre><code>Camera cam; // object\neffect.Transform = cam.viewMatrix * cam.projectionMatrix;\n// ToDo: Drawing Code Here\n</code></pre>\n"},{"tags":["vb.net","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13034800,"title":"How to set cursor position at end of text while open notepad (log file)?","body":"<p>In my application, i add/append exception log in notepad and now logs are too big so to make it user friendly i decide to set cursor position at end of text of log file so when user click on \"View Log\" button from application s/he can show most recent log. So to avoid scrolling i want to set cursor at last. </p>\n\n<p>Currently i am simply using : <code>Process.Start(\"notepad.exe\",Path)</code> to open log file.</p>\n"},{"tags":["c#","winforms","webbrowser-control","form-submit"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13000963,"title":"Is WebBrowser.Document.Forms[0].InvokeMember() paramater always \"submit\"?","body":"<p>Every code example for <a href=\"http://stackoverflow.com/a/2299388/1357272\">submitting a form inside a WebBrowser control</a> I have seen so far, hardcodes the <code>WebBrowser.Document.Forms[0].InvokeMember()</code> parameter as <code>\"submit\"</code>.</p>\n\n<p>Must this parameter always be <strong>\"submit\"</strong>?</p>\n\n<p>If so, then why is it a parameter?</p>\n\n<p>If not, what are the rules for specifying which string to put there? Is it dependent on the HTML of the page being accessed?</p>\n\n<p><strong>Update 1:</strong> The <a href=\"http://msdn.microsoft.com/en-us/library/0t9yb2z4.aspx\" rel=\"nofollow\">documentation for InvokeMember()</a> clearly shows an example of using a value other than \"submit\". So, at least I got the answer: <strong>No</strong>.</p>\n\n<p>But I still don't understand when should I use \"submit\" and when should I use \"moveRow\": In the web page I am handling via \"submit\" there is no mention of that string, yet it works perfectly. Where is that implied \"submit\" hiding in the web page?</p>\n\n<p><strong>Update 2:</strong> Ah! I think I am beginning to get it: It's a <a href=\"http://www.w3schools.com/jsref/met_form_submit.asp\" rel=\"nofollow\">Javascript built-in method</a>. And thus implied for any DOM <a href=\"http://www.w3schools.com/jsref/dom_obj_form.asp\" rel=\"nofollow\">Form</a> element.</p>\n\n<p>An authoritative answer is most appreciated.</p>\n"},{"tags":["c#","winforms","crystal-reports"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":2928,"score":3,"question_id":4408554,"title":"Unable to find the report in the manifest resources - Crystal Report / C#","body":"<p>I have a windows application written in C# and am trying to display crystal report using crystal report viewer. The name of my report is \"receiptReport\" and I am using following line to show report in viewer:</p>\n\n<pre><code>receiptReport rpt = new receiptReport();\ncrystalReportViewer.ReportSource = rpt;\n</code></pre>\n\n<p>I am receiving following error: <code>Unable to find the report in the manifest resources. Please build the project, and try again.</code></p>\n\n<p>I have tried by setting Build Action of report file 'receiptReport.rpt' to Embedded Resource but still now luck.. Im using VS2010..</p>\n"},{"tags":[".net","winforms","nil","delphi-prism","dialogresult"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13032870,"title":"Why is Dialogresult nil?","body":"<p>This never happened to me before. </p>\n\n<p>I do have System.Windows.Forms namespace under uses clause and I am able to use DialogResult's properties. Look at the code below. It's where the problem is in my program.</p>\n\n<pre><code>if (thewinform.ShowDialog=DialogResult.OK) then\n</code></pre>\n\n<p>I did debug it and dialog winform opens. Once I click the OK button and returns to check on the DialogResult, it skips the if block of code. At which point, I noticed that DialogResult is actually <strong>NIL</strong></p>\n\n<p>I never encountered anything like this before. </p>\n\n<p>Any ideas? Thanks,</p>\n"},{"tags":["c#","winforms","colors","gdi+"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13033606,"title":"Converting string with color name to color\"id\"","body":"<p>I have </p>\n\n<pre><code>public String colorid = \"Blue\";\n</code></pre>\n\n<p>And</p>\n\n<pre><code>  Sbrush = new SolidBrush(Color.Convert.ToInt32(colorid));\n</code></pre>\n\n<p>I want to be able to define the colorid somewhere else, that's why I wrote the SolidBrush code like that. Now this doesn't work and I would appreciate it if someone could help me</p>\n"},{"tags":["c#","winforms","textbox"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13032618,"title":"TextBox control with max length to avoid string trimming?","body":"<p>Using a TextBox control, I want to enforce a maximum length.  However, the maximum length is based on string size in pixels, not number of characters.</p>\n\n<p>I want to restrict typing more characters if doing so will result in the characters being trimmed by the text renderer, typically being truncated with an ellipsis (...).</p>\n\n<p>The problem is I'm not necessarily using a fixed with font.  And I'm using a multiline textbox.</p>\n"},{"tags":["c#","winforms","printing","charts"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12997520,"title":"Resize MSChart to Fit Pagesize Before Printing","body":"<p>I am struggling to figure out how to get an MSChart to fill the entire page when printing.  Can someone tell me why the code below does not work and/or suggest another approach.  I apologize for my ignorance but, all of the printing I have done so far has been done through Crystal and other reporting frameworks so I generally never have to work directly with the PrintDialog and PrintPreviewDialog.  Thanks in advance.</p>\n\n<pre><code>// Printing Code\nSize pageSize = new Size(this.Chart.Printing.PrintDocument.DefaultPageSettings.PaperSize.Width, this.Chart.Printing.PrintDocument.DefaultPageSettings.PaperSize.Height);\nthis.Chart.Size = pageSize;\n\n// This properly previews my chart but, it does not fill up the page                    \nthis.Chart.Printing.PrintPreview();\n</code></pre>\n"},{"tags":["c#","winforms","ninject"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":1598,"score":6,"question_id":3552774,"title":"Ninject property injection returns null","body":"<p>I've got a WinForms app with the following code:</p>\n\n<pre><code>static void Main()\n{\n    IKernel kernel = new StandardKernel(new MyModule());\n    TestInterface test = kernel.Get&lt;TestInterface&gt;();\n}\n</code></pre>\n\n<p>For the Module.Load() event:</p>\n\n<pre><code>Bind&lt;TestClass&gt;().ToSelf().InSingletonScope();\nBind&lt;TestInterface&gt;().To&lt;TestClass&gt;();\n</code></pre>\n\n<p>At this point <code>test</code> in the <code>Main()</code> method is the proper object I'm expecting.</p>\n\n<p>In a form later on, I'm using property injection:</p>\n\n<pre><code>[Inject]\nTestInterface test {get;set;}\n</code></pre>\n\n<p>And once the form is loaded, trying to work with <code>test</code>, but it's a null object.</p>\n\n<p>Thoughts?</p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":3,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":12432,"score":3,"question_id":5524075,"title":"Programatically add new column to DataGridView","body":"<p>I have a DataGridView bound to a DataTable. The DataTable is populated from a database query. The table contains a column named BestBefore. BestBefore is a date formatted as a string (SQLite doesn't have date types). </p>\n\n<p>I would like to programatically add a new column to the DataGridView called Status. If BestBefore is less than the current date, Status value should be set to OK, otherwise Status value should be set to NOT OK.</p>\n\n<p>I'm very new to Winforms, so some example code would be greatly appreciated.</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>I think DataColumn.Expression is okay for doing simple calculations such multiplying a column's integer value by another value, but what about doing what I need to do? That is, calculate the difference between now and the date (string formatted) in the BestBefore column to determine what value to give the new status column. Example code would be appreciated. </p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","winforms","pinvoke"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13019176,"title":"How to set window owner to an unmanaged window","body":"<p>I want to set the owner form to that of an unamanged window.  I have the unmanaged window's handle.  How can I set this unmanaged window to be the owner window for my managed form?</p>\n\n<pre><code>IntPtr hWnd = GetUnmanagedWindow();//assume the handle is returned correctly\nForm form = new Form();\nform.Show(ConvertToManaged(hWnd));//Need an implementation for ConvertOrSomething()\n</code></pre>\n"},{"tags":["c#","winforms","textbox"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13030692,"title":"Why is the text position different when multiline is set to true. Can this be avoided?","body":"<p>I have a form with multiple TextBox controls. Some have multiline set to true others to no. When using large fonts it becomes obvious that the text positioning is different. When multiline is true some kind of additional margin appears around the text.\nThe following code fragment</p>\n\n<pre><code>TextBox textBox = new TextBox();\ntextBox.Text = \"Test\";\ntextBox.Font = new Font(\"Segoe UI\", 16);\nConsole.WriteLine(\"Single Line:\" + textBox.GetPositionFromCharIndex(0));\ntextBox.Multiline = true;\nConsole.WriteLine(\"Multi Line:\" + textBox.GetPositionFromCharIndex(0));\n</code></pre>\n\n<p>outputs\nSingle Line:{X=1,Y=0}\nMulti Line:{X=7,Y=1}</p>\n\n<p>My questions are:\nWhy is this margin added in multiline mode?\nCan this be avoided/controlled?</p>\n\n<p>I already found out that the text in multiline mode is drawn with</p>\n\n<pre><code>TextFormatFlags.TextBoxControl | TextFormatFlags.WordBreak | TextFormatFlags.NoClipping\n</code></pre>\n\n<p>while in single line mode </p>\n\n<pre><code>TextFormatFlags.TextBoxControl | TextFormatFlags.NoPadding | TextFormatFlags.SingleLine\n</code></pre>\n\n<p>is used.\nIs there a way to control the TextFormatFlags used by the TextBox?</p>\n\n<p>Thank you for any effort you put on answering my questions!</p>\n"},{"tags":["c#","winforms","file","text","text-files"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":152,"score":6,"question_id":13019715,"title":"File not found on xp","body":"<p>I have a weird problem with a text file that I ship with my app.</p>\n\n<p>The file holds a bunch of sites, when the program starts it loads the sites into an array.</p>\n\n<p>On windows 7, when I start the app I don't get any errors. However, on XP I get <code>c:\\Document and setting\\I\\Application Data\\fourmlinks.txt file not found.</code>\nThe weird part is that I made a text file with content with it, and I put it inside the application folder.</p>\n\n<p>This is how I call out in my code:</p>\n\n<pre><code>string path = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + \"\\\\fourmlinks.txt\";\n</code></pre>\n\n<p>My problem is that I can't create a new file because it is holding basic data that the app needs and is using.</p>\n\n<p>After the first launch the user can edit the file as much he wants.</p>\n\n<p>I'm not sure why this is happening, but this is only happening on Windows XP.</p>\n\n<p>How can I solve this problem?</p>\n\n<h1>EDIT</h1>\n\n<hr>\n\n<p>keyboardP suggest to check on what windows im runing and then change the path by it.\nso i came up with this code:</p>\n\n<pre><code> System.OperatingSystem osInfo = System.Environment.OSVersion;\n            if (osInfo.Platform == PlatformID.Win32NT)\n                path = Environment.SpecialFolder.LocalApplicationData + \"\\\\fourmlinks.txt\";\n            else\n                path = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + \"\\\\fourmlinks.txt\";\n</code></pre>\n\n<p>the problem that even on windows 7 i get true, when i need to get false.\nis there a way to make sure i run on XP or Windows 7 i diffrent way?</p>\n\n<hr>\n\n<h1>EDIT 2</h1>\n\n<hr>\n\n<p>using the check of the Operating System, I can now be sure I'm Windows 7 or Windows XP.\nSo, the code run find again on Windows 7 but on Windows XP I get a different error message:</p>\n\n<p><img src=\"http://i.stack.imgur.com/rZqqM.png\" alt=\"enter image description here\"></p>\n\n<p>I really have no idea how the path that I add in my program becomes the path that the error is saying I'm requesting.</p>\n"},{"tags":["c#","winforms","user-interface","microsoft-metro","custom-controls"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":115,"score":0,"question_id":13024537,"title":"how to create a Metro ui toggle switch control in winforms c#?","body":"<p>im trying to implement a toggle switch control in winforms c# i want to recreate the windows 8 pc setting toggle switch control as a metro ui (microsoft design style...whatever!)</p>\n\n<p><a href=\"http://cloud.addictivetips.com/wp-content/uploads/2012/03/Windows-8-PC-Settings-Sync.png\" rel=\"nofollow\">http://cloud.addictivetips.com/wp-content/uploads/2012/03/Windows-8-PC-Settings-Sync.png</a></p>\n\n<p>i need help or direction how to start to create the control?</p>\n"},{"tags":["c#","winforms","treeview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13029124,"title":"Is there a way to detect when scroll begins and ends in a TreeView?","body":"<p>I'm looking for the equivalent of ListView's LVN_BEGINSCROLL and LVN_ENDSCROLL, but in a TreeView. I'm currently using C# / winforms but would be happy with a C++ or WPF solution. Thanks.</p>\n"},{"tags":["winforms","menustrip","ownerdrawn"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":968,"score":2,"question_id":4187197,"title":"Change size of ToolStripMenuItem","body":"<p>I'm custom drawing a menu item in a <code>MenuStrip</code>. The problem I'm having is that the menu item insists on sizing itself based on the text, which is not what I want (there is no text). I can set <code>AutoSize</code> to false and explicitly specify a size, but the containing menu (<code>ToolStripDropDown</code>) still sizes itself based on the text, which causes it to be too small to contain the entire menu item. </p>\n\n<p>Is there a straightforward way to set the size of a menu item?</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":55,"score":-2,"question_id":13027210,"title":"vs10 c# function run after click","body":"<p>I want to make function work :</p>\n\n<blockquote>\n  <p>int a = Convert.ToInt32(tb[0].Text);</p>\n</blockquote>\n\n<p>After i click :</p>\n\n<blockquote>\n  <p>button1</p>\n</blockquote>\n\n<p>How to do it ?</p>\n\n<p>my work : </p>\n\n<pre><code>public partial class Form1 : Form\n{\n    public Form1()\n    {\n        InitializeComponent();\n        TextBox[] tb = new TextBox[2];\n\n        for (int i = 0; i &lt;= 1; i++)\n        {\n            tb[i] = new TextBox();\n            tb[i].Name = \"textBox\" + i;\n            tb[i].Location = new Point(50 * i, 10);\n            this.Controls.Add(tb[i]);\n            tb[i].Size = new System.Drawing.Size(20, 15);\n        }\n        RichTextBox Richtext = new RichTextBox();\n        Richtext = new RichTextBox();\n        Richtext.Name = \"RichTextBox\";\n        Richtext.Location = new Point(40, 50);\n        this.Controls.Add(Richtext);\n        Richtext.Size = new System.Drawing.Size(895, 400);\n        Richtext.Text = (\"Neivedet kiek bus ailuciu ir stulpeliu.\");\n\n\n         int a, b;           \n         a = Convert.ToInt32(tb[0].Text);\n         b = Convert.ToInt32(tb[1].Text);\n\n        Richtext.Text = (\"Hello , new text works !\");\n\n    }\n\n    private void Form1_Load(object sender, EventArgs e)\n    {}\n\n    private void label1_Click(object sender, EventArgs e)\n    {}\n\n    private void textBox1_TextChanged(object sender, EventArgs e)\n    {}\n\n    private void button1_Click(object sender, EventArgs e)\n    {}\n</code></pre>\n"},{"tags":[".net","winforms","combobox"],"answer_count":8,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":10144,"score":3,"question_id":782313,"title":"How can I handle ComboBox selected index changing?","body":"<p>I have a ComboBox that have a list of manufacturers. When a user selects a manufacturer, a grid below is populated with data for the chosen manufacturer. That data can be modified. The user has to press the Save button after all changes are done.</p>\n\n<p>But the user can forget to press Save and select another manufacturer from the ComboBox and the grid will be populated with another data, so previous changes will be lost.</p>\n\n<p>So I need to ask user if he wants to save changes before selecting another manufacturer.</p>\n\n<p>How can I do this? Or maybe you offer another way of solving my task (looking from another angle)?</p>\n"},{"tags":["c#","asp.net","winforms","wcf"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":719,"score":2,"question_id":8151415,"title":"How does the WCF service interact with my winform app?","body":"<p>I am currently developing a C# Windows Form Application that I intend to let it interact with a server. The server will receive posting from a mobile application that I have developed and whenever a posting is received, my Windows Form Application should be notified and give me a notification. In order to do this, I intend to use WCF duplex service for it.</p>\n\n<p>E.g. My mobile application sends an posting over to my server. Once my server reads and receives the new posting, the service should send a message over to my winform app to alert me that a posting is received. And the UI of the winform app should update accordingly to what I want to updated. (e.g. adding new panels)</p>\n\n<p>This is basically how I wish for it to work\nThey way this would work is</p>\n\n<ol>\n<li>WCF Service in running on my server</li>\n<li>Windows Form connects to my server's WCF service using Duplex Contract</li>\n<li>Mobile app posts to a webpage</li>\n<li>Once the webpage receives the posting, the asp.net will invoke the WCF service</li>\n<li>WCF duplex service receives the posting and sends the information to the winform app</li>\n<li>My winform Application aka WCF Client updates UI with this new message received</li>\n</ol>\n\n<p>My question is, how does step 4 proceed to step 5? To be specific, how does the service sends the information over to the winform app upon receiving the posting.</p>\n\n<p>To be even more specific, once the posting is received from the webpage, the service contract is invoked and the information is sent and received by the service, how does the service make use of the call back channel to send the information over to the winform app and update the UI accordingly?</p>\n"},{"tags":["c#","windows","winforms","webcam"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":449,"score":0,"question_id":10591036,"title":".net 3.5 windows form application, using webcam","body":"<p>Having searched high and low for native c# hook to webcam, I found 5 basic ways to interact with the camera.<br>\n 1. Video for Windows (VFW)\n 2. DirectX\n 3. avicap32.dll\n 4. WIA\n 5. 3rd party tools</p>\n\n<p>My basic need is to take a photo.  The application will be used on some legacy windows XP and Vista machines, but going forward Windows 7 and greater will be required.  So what might the best approach be with the broad install base?  Just reading WIA looked like the way to go but looks like some changes were made so it works a little different now (I don't know for sure).  I understand that some people have done combos.</p>\n\n<p>Might need to crop photo, but that is really about it.</p>\n\n<p>For school visitor monitoring.   </p>\n"},{"tags":["c#","visual-studio","winforms"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2642,"score":2,"question_id":863582,"title":"Copying winforms between projects in Visual Studio","body":"<p>What is the best way to copy or cut/past a form from one Project to another Project within a Solution in Visual Studio?</p>\n\n<p>Whenever I try it, using the solution explorer (drag and drop or right clicking cut and past), it only copies the underlying C# code and not the necessary 'bits and pieces' that help you visualise the form via the form designer.</p>\n"},{"tags":["c#","winforms"],"answer_count":6,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":158,"score":7,"question_id":13026269,"title":"Exit all instances of my app","body":"<p>I have the following function:</p>\n\n<pre><code>private void TakeOverAllScreens()\n    {\n        int i = 0;\n        foreach (Screen s in Screen.AllScreens)\n        {\n\n            if (s != Screen.PrimaryScreen)\n            {\n                i++;\n               Process.Start(Application.ExecutablePath, \"Screen|\" + s.Bounds.X + \"|\" + s.Bounds.Y + \"|\" + i);\n            }\n        }\n    }\n</code></pre>\n\n<p>As you can see it creates a separate instance of my application for each screen on the pc.</p>\n\n<p>How can I create an exit function that closes all of them?\nThe function needs to work on any instance of the app, not just my \"Main\" instance.</p>\n"},{"tags":["c#","winforms"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13025094,"title":"Passing values from and to Popup forms","body":"<p>I am making windows application.</p>\n\n<p>I have requirement that ,  I need to open a pop up form from a Button click event , I can open that form through below code</p>\n\n<pre><code>Form2 frm = new  Form2();\nfrm.ShowDialog();\n</code></pre>\n\n<p>This Popup form <code>Form2</code> is data entry form , this will called from  <code>Form1</code>. <code>Form2</code> is data entry form. When I fill fields in <code>Form2</code> and click on Save button then all the values will be filled in <code>Form1's</code> grid. </p>\n\n<p>And this grid also having Edit and Delete button.</p>\n\n<p>How can I do that ? I have to save data in xml file and retrive from that but I dont want to do that.</p>\n\n<p>Can anyone suggest any another way with sample code?</p>\n"},{"tags":["c#","winforms","listview","reference"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":13024657,"title":"how can I add items to my ListView","body":"<p>I keep getting this error and I know why but I need help figuring out how I can solve it. The only way I have been able to add my items it to make a new form but that seems silly.</p>\n\n<p>It wont work if I make all my methods static =(</p>\n\n<p>I keep getting,</p>\n\n<blockquote>\n  <p>\"An object reference is required for the non-static field, method, or\n  property 'Handicap_Calculator.FormMain.listViewLog'\n  \\Form1.cs 74  13  Handicap Calculator\"</p>\n</blockquote>\n\n<p>Here´s my code:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Windows.Forms;\n\nnamespace Handicap_Calculator\n{\n\npublic partial class FormMain : Form\n{\n    //FormAddScore FormAddNewScore = new FormAddScore();\n    public static bool addScoreIsShown = false;\n    public static FormAddScore _FormAddScore;\n    public static ListViewItem Item;\n    //public static List&lt;string&gt; ScoreInfo = new List&lt;string&gt;();\n\n    public FormMain()\n    {\n        InitializeComponent();\n\n    }\n\n    public void button1_Click(object sender, EventArgs e)\n    {\n        try\n        {\n            if (_FormAddScore == null || _FormAddScore.IsDisposed)\n            {\n                _FormAddScore = new FormAddScore();\n            }\n            _FormAddScore.Show();\n            if (_FormAddScore.WindowState == FormWindowState.Minimized)\n            {\n                _FormAddScore.WindowState = FormWindowState.Normal;\n            }\n            _FormAddScore.BringToFront();\n        }\n        catch (Exception ex)\n        {\n            MessageBox.Show(ex.ToString());\n        }\n    }\n\n    public static void AddScore()\n    {\n        int Round = 1;\n        DateTime date = _FormAddScore.date;\n        string course = _FormAddScore.course;\n        int holes = _FormAddScore.holes;\n        int score = _FormAddScore.score;\n        float courseRating = _FormAddScore.courseRating;\n        float slopeRating = _FormAddScore.slopeRating;\n\n        string[] ScoreInfo = new string[7];\n        ScoreInfo[0] = Round.ToString();\n        ScoreInfo[1] = date.ToString();\n        ScoreInfo[2] = course;\n        ScoreInfo[3] = holes.ToString();\n        ScoreInfo[4] = score.ToString();\n        ScoreInfo[5] = courseRating.ToString();\n        ScoreInfo[6] = slopeRating.ToString();\n        AddToList(ScoreInfo);\n\n    }\n\n    public static void AddToList(string[] ScoreInfo)\n    {\n        Item = new ListViewItem(ScoreInfo);            \n        //listViewLog.Items.Add(Item);      \n\n    }\n\n}\n}\n</code></pre>\n\n<p>Edit...</p>\n\n<p>Here is the class im calling it from:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Windows.Forms;\n\nnamespace Handicap_Calculator\n{\n\npublic partial class FormAddScore : Form\n{\n    public DateTime date;\n    public string course;\n    public int holes;\n    public int score;\n    public float courseRating;\n    public float slopeRating;\n\n    public FormAddScore()\n    {\n        InitializeComponent();\n\n    }\n\n    private void FormAddScore_FormClosing(object sender, FormClosingEventArgs e)\n    {\n        FormMain.addScoreIsShown = false;\n    }\n\n    public void  getscore()\n    {\n        try\n        {\n            date = dateTimePicker1.Value;\n            course = textBoxCourse.Text;\n            holes = Convert.ToInt16(textBoxHoles.Text);\n            score = Convert.ToInt16(textBoxScore.Text);\n            courseRating = Convert.ToSingle(textBoxCourseRating.Text);\n            slopeRating = Convert.ToSingle(textBoxSlopeRating.Text);\n        }\n        catch(Exception ex)\n        {\n            MessageBox.Show(ex.ToString());\n        }\n    }\n\n    private void button1_Click(object sender, EventArgs e)\n    {\n        getscore();            \n        FormMain.AddScore();\n    }\n}\n}\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":50,"score":0,"question_id":13012864,"title":"copy an image and save it to other directory","body":"<p>I am beginner in c#. In my project, if I do try the below code to save a copy of image, it is giving error \"A generic error occurred in GDI+.\" . I have gone through this <a href=\"http://stackoverflow.com/q/1053052/1577396\">link</a>, but I have no knowledge of what is he saying.</p>\n\n<p>I tried the below code:</p>\n\n<pre><code> Bitmap bmpLarge = new Bitmap(ofdFlagsLarge.FileName);\n bmpLarge.Save(@\"\\..\\..\\\" + strLargePath);               /* ERROR */\n</code></pre>\n\n<p>Can someone please assist me to save a image from the local PC directory itself to other directory on the same machine..</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13023605,"title":"Enabled button in a form through access control","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/8820606/get-access-to-parent-control-from-user-control-c-sharp\">Get access to parent control from user control - C#</a>  </p>\n</blockquote>\n\n\n\n<p>I have <code>btnMessage</code> on my form <code>Main</code>, and I also have user control (<code>uc</code>).</p>\n\n<p>When I click <code>btnMessage</code>, it opens the <code>uc</code> and also makes <code>btnMessage.enabled = false</code>. In <code>uc</code>, there's a button that's called <code>btnExecute</code>.</p>\n\n<p>What I want is that when I click on <code>btnExecute</code> in <code>uc</code>, <code>btnMessage</code> in <code>Main</code> form will be disabled. How I can do this?</p>\n\n<p>Here's the update code :</p>\n\n<p>I'm using function in <code>main.cs</code></p>\n\n<pre><code>    public Main()\n    {\n        InitializeComponent();\n        formFunctionPointer += new functioncall(buttonHideorEnabled);\n        ucMessageTarget.userFunctionPointer = formFunctionPointer;\n    }\n\n    public delegate void functioncall(bool _status);\n\n    private event functioncall formFunctionPointer;\n\n    public void buttonHideorEnabled(bool _status)\n    {\n        btnMessageTarget.Enabled = _status;\n    }\n</code></pre>\n\n<p>and in <code>uc.cs</code> :</p>\n\n<pre><code>    public static string agentName = UtilitiesToolkit.agentMessageTarget;\n    public static string strn;\n\n    public UcMessageTarget(string str)\n    {\n        InitializeComponent();\n        strn = str;\n    }\n\n    public Delegate userControlPointer;\n    public Delegate userFunctionPointer;\n    private void btnExecute_Click(object sender, EventArgs e)\n    {\n       btnExecute.enabled = false;\n       userFunctionPointer.DynamicInvoke(false);\n       //I want btnMessage in Main form also disabled, please tell me how\n    }\n</code></pre>\n\n<p>but, still, didn't work. when I compile, I have error in main, in this line :</p>\n\n<pre><code>    public Main()\n    {\n        InitializeComponent();\n        formFunctionPointer += new functioncall(buttonHideorEnabled);\n        ucMessageTarget.userFunctionPointer = formFunctionPointer;\n    }\n</code></pre>\n\n<p>said, that </p>\n\n<blockquote>\n  <p><em>object reference is not set to an instance of object (in\n  ucMessageTarget.userFunctionPointer = formFunctionPointer;).</em></p>\n</blockquote>\n\n<p>please help.</p>\n"},{"tags":["c#","winforms","data-binding","datagridview"],"answer_count":4,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":4780,"score":3,"question_id":3340192,"title":"DataGridView bound to BindingList does not refresh when value changed","body":"<p>I have a DataGridView bound to a BindingList (C# Windows Forms). If I change one of the values in an item in the list it does not immediately show up in the grid. If I click on the changed cell, or minimize then maximize the window it updates properly, but I need it to happen automatically.</p>\n\n<p>I had the same problem earlier, but in that situation I had to change the cell's background colour at the same time that the value changed. This caused the cell to refresh correctly.</p>\n\n<p>The only way I can get it to work is...</p>\n\n<pre><code>dataGridView.DataSource = null;  \ndataGridView.DataSource = myBindingList\n</code></pre>\n\n<p>...but I'd really like to avoid this as it makes the scrollbar pop back to the top, and means that I'd have to set my cell background colours again. Surely there's a better way. I've tried Refresh (as well as refreshing the parent), Update, and Invalidate, but they're not doing what I need.</p>\n\n<p>I've seen this problem mentioned on a few message boards, but haven't seen a working answer to it yet.</p>\n"},{"tags":["c#","wpf","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":13022921,"title":"How to cancel the WPF form minimize event","body":"<p>I want to cancel the natural minimizing behavior and change a WPF form size instead.</p>\n\n<p>I have a solution with the Window_StateChanged but it doesn't look so nice - the window first minimized then jumps back and does the size alteration. Is there a way to accomplish this? I Googled for Window_StateChanging but couldn't figure it out, some sort of external lib that I prefer not to use.</p>\n\n<p>That's what I have:</p>\n\n<pre><code>private void Window_StateChanged(object sender, EventArgs e)\n{\n    switch (this.WindowState)\n    {\n        case WindowState.Minimized:\n            {\n                WindowState = System.Windows.WindowState.Normal;\n                this.Width = 500;\n                this.Height = 800;\n                break;\n            }\n    }\n}\n</code></pre>\n\n<p>Thanks,</p>\n\n<p>EP</p>\n"},{"tags":["c#","winforms","events"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13023343,"title":"How to get Windows for to raise mouseclick event for programatically created PictureBox?","body":"<p>I'm building a virtual board game, and I need to be able to click on the pieces to move them. The board is created as a picture in the background, and the pieces are pictureboxes over top of that. More specifically, they are a custom class GamePiece that inherits from PictureBox. I know PictureBox has a Name_Click method that is called when it's clicked, but I'm creating my pieces programatically, as follows:</p>\n\n<pre><code>    public Player(int identity, GameBoard Board)\n    {\n        ID = identity;\n        for (int i = 0; i &lt; 4; i++)\n        {\n            Pieces[i] = new GamePiece(ID, Board.GetPlaceSize(), Board.GetPieceColor(ID), Board);\n        }\n    }\n</code></pre>\n\n<p>Therefore, I don't want to hardcode in methods to be called for each Gamepiece, because that would defeat my purpose here.</p>\n\n<p>Any suggestions? I can include any other code that would be helpful, and I'm pretty flexible as far as redesigning code, if that would make my life easier later. Thanks in advance.</p>\n"},{"tags":["c#","winforms","datagridview","timer"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13023020,"title":"Threading.Timer updated value not reflected in datagridview","body":"<p>I am using VS express 2010 and .Net 4.0.</p>\n\n<p>I bind a DataGridView to a BindingList which implement INotifyPropertyChanged.</p>\n\n<p>The value changed is reflected on the grid normally but failed when using Threading.Timers to do the update job. </p>\n\n<p>As shown below , the value is updated but not shown unless the cells lost focus like \"minimizing and maximizing\" or \"the grid is covered by other window\" or \"selecting the cells\".</p>\n\n<p><img src=\"http://i.minus.com/jViIpKKeNNRrB.PNG\" alt=\"\"></p>\n\n<p>I am a newbie. I had searched and I believe the threading.timer is bad in updating UI. But in my case, I am just updating the value.</p>\n\n<p>I am tired of playing with the weak threading.timer. Any other recommendations for light-weighted timer would be appreciated! Thank you.</p>\n"},{"tags":["c#","visual-studio","winforms","visual-studio-2008","visual-studio-2005"],"answer_count":3,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":993,"score":4,"question_id":555526,"title":"Why does the Visual Studio IDE sometimes initialize the \"this.components object: and other times not?","body":"<p>I've recently noticed some behaviour with the Visual Studio Designer (C#) that I don't understand and was wondering if someone could clarify...</p>\n\n<p>One some of my Windows Forms, the first line of the designer generated code reads;</p>\n\n<pre><code>this.components = new System.ComponentModel.Container();\n</code></pre>\n\n<p>When this is the case, the dispose method, in that same designer file, the dispose method places two \"Dispose\" calls within the case \"if\" condition as follows;</p>\n\n<pre><code>    protected override void Dispose(bool disposing)\n    {\n        if (disposing &amp;&amp; (components != null))\n        {\n            components.Dispose();\n            base.Dispose(disposing);\n        }\n    }\n</code></pre>\n\n<p>i.e. Nothing is called unless disposing is true, AND components is not null.</p>\n\n<p>On some other forms, that first line in the designer generated code is missing. In these cases the base.Dispose call is outside the \"if\" condition as such...</p>\n\n<pre><code>    protected override void Dispose(bool disposing)\n    {\n        if (disposing &amp;&amp; (components != null))\n        {\n            components.Dispose();\n        }\n        base.Dispose(disposing);\n    }\n</code></pre>\n\n<p>I have noticed this while tracking down a bug with a form not closing, where this.components was null, yet the base.Dispose call was inside that condition (I suspect the designer code had been tampered with but that's another story.</p>\n\n<p>What controls this behaviour?</p>\n\n<p>(Some earlier forms in the project were created in VS 2005 and we now use VS 2008 - clue?)</p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13022359,"title":"DataGridView updated but not shown","body":"<p>I am using VS express 2010 and .Net 4.0.</p>\n\n<p>I bind a DataGridView to a BindingList which implement INotifyPropertyChanged.</p>\n\n<p>I believe the cells are updated (the preview value as shown below) but the cells value change only when I selected the cell or the cells lost focus such as \"minimizing and maximizing\" or \"the grid is covered by other window\". I tried it on another computer and same thing happens as well.</p>\n\n<p><img src=\"http://i.minus.com/jViIpKKeNNRrB.PNG\" alt=\"\"></p>\n\n<p>I guess code is not the problem (Correct me if i am wrong) but I will still post below for your reference. </p>\n\n<p>I am a rookie. Please shed some light even if you don't know the exact solution.</p>\n\n<p>Class code</p>\n\n<pre><code>public class myclass : INotifyPropertyChanged\n{\n    public string property1;\n    public event PropertyChangedEventHandler PropertyChanged;\n    public string Property1\n    {\n        get { return property1; }\n        set\n        {\n            property1 = value;\n            this.NotifyPropertyChanged(\"Property1\");\n        }\n    }\n    private void NotifyPropertyChanged(string name)\n    {\n        if (PropertyChanged != null)\n            PropertyChanged(this, new PropertyChangedEventArgs(name));\n    }\n}\n</code></pre>\n\n<p>Declaration</p>\n\n<pre><code>public static BindingList&lt;myclass&gt; infolist = new BindingList&lt;myclass&gt;();\n</code></pre>\n\n<p>DataGridView Initiation</p>\n\n<pre><code>dataGridView1.AutoGenerateColumns = false;\nDataGridViewTextBoxColumn Column1 = new DataGridViewTextBoxColumn();\nColumn1.DataPropertyName = \"Property1\";\nColumn1.HeaderText = \"Property1\";\ndataGridView1.Columns.Add(Column1);\ndataGridView1.DataSource = Program.infolist;\n</code></pre>\n"},{"tags":["winforms","mono","gtk","icons","ubuntu-12.04"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13021540,"title":"Icon doesn't show on window title bar","body":"<p>I'm fairly new to using Gtk# and Mono.\nI an using it on XUbuntu 12.04 and have \"mono-complete\" installed, along with all packages and libraries I thought that could be of any help.\nThat's why I started to review this <a href=\"http://zetcode.com/tutorials/gtksharptutorial/firststeps/\" rel=\"nofollow\">Tutotrial</a> and practicing its code snippets.\nHowever, to my despair, they don't work.</p>\n\n<p>I finally made them work by means of installing everything and \"mkbundling\" the compiled file. However, when trying to have the ICON example compiled, mkbundled and executed, it has no icon in the title bar (I was supposed to put the icon there by using SetIconFromFile()). Any suggestions? Thank you so much in advance.</p>\n\n<p>Antonio Rodulfo</p>\n"},{"tags":["c#","winforms","sharepoint","webparts"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":41,"score":-2,"question_id":13020661,"title":"Display a sharepoint web part in C# windows form","body":"<p>I have a third party web application that I want to integrate into C#.  The web application has a web part that can integrate with Sharepoint.  Is there a way to embed a webpart into a C# application?  </p>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":112,"score":2,"question_id":13019189,"title":"Creating a shortcut to a folder in c#","body":"<p>To make a long story short, I need to to create a shortcut to a folder using C#. I've been reading on using <code>IWshRuntimeLibrary</code>. When I go to try anything using <code>IWshRuntimeLibrary</code> I get all sorts of ambiguity errors with <code>System.IO.File</code>. I'm assuming this is because there is a <code>IWshRuntimeLibrary.File</code> interface along with <code>System.IO.File</code>. All I've really been able to find are articles on making shortcuts to apps, not folders.</p>\n\n<p>Ambiguity Errors aside:</p>\n\n<ul>\n<li>Is this the right tool to use for folder shortcuts?</li>\n<li>How do I create a shortcut using this</li>\n<li>How do I specify where the shortcut is placed</li>\n</ul>\n\n<p>Also when I try to create a shortcut to a folder, say <code>C:\\TEMP</code> using this: </p>\n\n<pre><code>IWshShortcut shortcut;\nwshShell = new WshShellClass();\nshortcut = (IWshShortcut)wshShell.CreateShortcut(@\"C:\\TEMP\");\n\nshortcut.TargetPath = @\"C:\\Documents and Settings\";\n</code></pre>\n\n<p>I get a <code>COMException</code>. According to what I've read this should create a shortcut to the C drive temp folder and put the shortcut in the Documents and Settings.</p>\n"},{"tags":["c#","winforms","listbox",".net-2.0"],"answer_count":6,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":7531,"score":5,"question_id":934241,"title":"ListBox select all items","body":"<p>I need to select all items in a ListBox when a CheckBox is clicked. Is it possible to select all items in the ListBox using a single line of code?  Or will I have to loop through all items and set selected to true for each one of them?</p>\n\n<p>Thanks :)</p>\n"},{"tags":["winforms","windows-desktop-gadgets"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13020095,"title":"Display information as gadget or winform NotifyIcon?","body":"<p>I am going to develop an application which will periodically query against an database and display the most updated scheduler/queue information for their product process.</p>\n\n<p>My initial thought is that a gadget could do that, as the main function is to display information, and that information should be readily available most of the time without user intervention. But it seems that Microsoft discontinued gadget from a little bit reading. Should I worry about that and using winform NotifyIcon instead? It just occur to me that something like gadget is more simple and probably more user friendly due to its simplicity? </p>\n\n<p>Or are there any other options I am not aware of? It will be a simple application to simplify business process, and I think it is safe to assume that  the machine will be Windows 7.</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":208,"score":0,"question_id":8202431,"title":"How to populate custom column cells in DataGridView","body":"<p>I managed to add another column to the DGV, but now I'm having trouble populating the cells with values.</p>\n\n<p>Here's what I have so far: </p>\n\n<pre><code>// add new column\nint lineItemsColumnIndex = dataGridView1.Columns.Add(\"LineItems\", \"Line Items\");\n\n// set up nested DataGridView for orders and lineitems.\nforeach (DataGridViewRow row in dataGridView1.Rows)\n{\n    List&lt;LineItem&gt; lineItems = ((Order)(row.DataBoundItem)).lineItems;\n    string cellValue = \"\";\n    for(int i=0; i&lt;lineItems.Count; i++){\n        FoodMenuItem menuItem = new FoodMenuItem(lineItems[i].menuItemID);\n        cellValue += lineItems[i].quantity.ToString() + \"x \" + menuItem.title + (i==lineItems.Count-1 ? \".\" : \", \");\n    }\n    row.Cells[lineItemsColumnIndex].Value = cellValue;\n}\n</code></pre>\n\n<p>How do I put data into the custom column?</p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":5,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":21729,"score":2,"question_id":1516252,"title":"How to programmatically set cell value in DataGridView?","body":"<p>I have a DataGridView. Some of the cells receive their data from a serial port: I want to shove the data into the cell, and have it update the underlying bound object.</p>\n\n<p>I'm trying something like this:</p>\n\n<pre><code>SetValueFromSerial (decimal newValue)\n{\n    dataGridView.CurrentCell.Value = newValue;\n}\n</code></pre>\n\n<p>using a string doesn't help:</p>\n\n<pre><code>    dataGridView.CurrentCell.Value = newValue.ToString ();\n</code></pre>\n\n<p>In both cases, I don't see anything in the grid, and the underlying value is unchanged.</p>\n\n<p>I did Google and search here, but I didn't find anything. (I may have missed something, perhaps something obvious, but I'm not <em>utterly</em> lazy.)</p>\n"},{"tags":["c#","winforms","datagridview","scroll"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":12897729,"title":"Column DisplayIndex Incorrect When Scrolling","body":"<p>I'm working with a DataGridView, and ran into a problem where the columns are sometimes not displayed in the correct order according to the DisplayIndex.  I found a mention of the same problem on a different site, <a href=\"http://social.msdn.microsoft.com/Forums/en-US/winformsdatacontrols/thread/35c1ed09-f4a4-4b3d-bd46-35a11cb8a9bc\" rel=\"nofollow\">http://social.msdn.microsoft.com/Forums/en-US/winformsdatacontrols/thread/35c1ed09-f4a4-4b3d-bd46-35a11cb8a9bc</a> .  </p>\n\n<p>The problem seems to be when a column doesn't show up on the initial display of the grid, due to being off to the right and requiring scrolling to see it.  When the columns are few enough that all of them will be seen without scrolling, then the order is correct.  If a column is added so that one of the columns will require scrolling to see it, then the column that is to the right will not be the last column according to the DisplayIndex, it will be a column that was supposed to be shown earlier.  </p>\n\n<p>While I could try and change the logic in my window to work similarly to the suggestion in the link above, I don't like that the base problem is just glossed over and a work-around is required.  Does anyone else have any suggestions as to how to address this problem in a way that addresses the problem itself instead of a work-around?</p>\n\n<p>Here's a code snippet of how I'm currently doing the ordering:</p>\n\n<pre><code>// Fill the data grid view with data from the database.\ndataGridView1.DataSource = null;\nDataTable dt = // Logic to get data from DB here\ndataGridView1.DataSource = dt;\n\n// Get the column display data.  This can change per user.\nDataTable columnDisplay = // Logic to get data from DB here\n\nbool foundMatch;\n\nforeach (DataGridViewColumn column in dataGridView1.Columns)\n{\n    foundMatch = false;\n    foreach (DataRow row in columnDisplay.Rows)\n    {\n        if (row[\"column_name\"].ToString().Equals(column.Name, StringComparison.CurrentCultureIgnoreCase))\n        {\n            foundMatch = true;\n            if (row[\"show_in_window\"].ToString().Equals(\"y\"))\n            {\n                // Set the column placement and display name.\n                dataGridView1.Columns[column.Name].DisplayIndex = Convert.ToInt32(row[\"column_sequence\"].ToString());\n                dataGridView1.Columns[column.Name].HeaderText = row[\"display_name\"].ToString();\n                dataGridView1.Columns[column.Name].Width = 105;\n            }\n            else\n            {\n                // Hide the column.\n                dataGridView1.Columns[column.Name].Visible = false;\n            }\n            break;\n        }\n    }\n\n    // If the column is not in the display table, then it should not be displayed at all.\n    if (!foundMatch)\n        column.Visible = false;\n}\n</code></pre>\n"},{"tags":["c#","arrays","winforms","performance"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":116,"score":1,"question_id":10820108,"title":"Difference in speed while accessing an array","body":"<p><strong>Is any difference (in speed of my program - execution time) between?? <br/></strong></p>\n\n<p><strong>1 st option:</strong></p>\n\n<pre><code> private void particleReInit(int loop)\n        {\n            this.particle[loop].active = true;\n            this.particle[loop].life = 1.0f;\n            this.particle[loop].fade = 0.3f * (float)(this.random.Next(100)) / 1000.0f + 0.003f; \n            this.particle[loop].r = colors[this.col][0];    // Select Red Rainbow Color\n            this.particle[loop].g = colors[this.col][1];    // Select Red Rainbow Color\n            this.particle[loop].b = colors[this.col][2];    // Select Red Rainbow Color\n            this.particle[loop].x = 0.0f;\n            this.particle[loop].y = 0.0f;\n            this.particle[loop].xi = 10.0f * (this.random.Next(120) - 60.0f);\n            this.particle[loop].yi = (-50.0f) * (this.random.Next(60)) - (30.0f);\n            this.particle[loop].xg = 0.0f; \n            this.particle[loop].yg = 0.8f; \n            this.particle[loop].size = 0.2f;\n            this.particle[loop].center = new PointF(particleTextures[0].Width / 2, particleTextures[0].Height / 2);\n\n    }\n</code></pre>\n\n<p><strong>2 nd option: <br/></strong></p>\n\n<pre><code>Particle p = particle[loop];\np.active = true;\np.life = 1.0f;\n...\n</code></pre>\n\n<p><br/>\nWhere <code>Particle particle[] = new Particle[NumberOfParticles];</code> is just an array of Particles which have some properties like life, position.</p>\n\n<p><br/>\nI'm doing it in Visual Studio 2010 Like WFA (Windows Form Aplication) and need to enhance performance (we're not able to use OpenGL, so for more particles my program tends to be slow).</p>\n"},{"tags":["c#","winforms","binding","data","datarowview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":129,"score":0,"question_id":12866658,"title":"Binding a TextBox to a particular DataRowView in a BindingSource IList property","body":"<p>In my application I have a table containing data for various regions within an organization with related tables containing statistical data about each region. For simplicity I'll represent them as:</p>\n\n<pre><code>____________          ________________          ________________\n|Region    |          |RegionHasDemo |          |DemoCategories|\n|          |1        *|              |*        1|              |\n|-RegionID |----------|-RegionID     |----------|-CatID        |\n|-City     |          |-CatID        |          |-SortOrder    |\n|-Zip      |          |-Population   |          |-Archive      |\n|-State    |          |______________|          |______________|\n|__________|          \n</code></pre>\n\n<p>The DemoCategories table contains the types of demographic. For instance, lets say RegionHasDemo represented age populations for my regions. The CatIDs in DemoCategories would be values like Age20to30, Age20to40 ... etc. so that RegionHasDemo represents age group populations for all the regions.</p>\n\n<p>In my application I want to create a form to add region data along with all of the related data. To do this I've created the two binding sources, one for RegionData and one for RegionHasDemo that contains RegionData as it's DataSource. For various reasons on my form I would like to enter the data for RegionHasDemo by binding individual text boxes to the DataRowViews contained in the List property of the RegionHasDemoBindingSource. Note, I do not want to use a grid view.</p>\n\n<p>Here is the code that I use to bind to the text boxes every time the Current property of the RegionData changes:</p>\n\n<p>Note: the table names are different from my sample, RegionData = UNITS; RegionHasDemo = UnitExp; DemoCategories = CatExp.</p>\n\n<p><pre class=\"lang-cs prettyprint-override\"></p>\n\n<code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Data.OleDb;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Windows.Forms;\nusing System.Diagnostics;\n\nnamespace DBsample\n{\n        public partial class Form1 : Form\n    {\n        private DataTable DataSource;\n        private string relatedTableName;\n\n        /// &lt;summary&gt;\n        /// Holsd the values needed to define my text box rows and \n        /// relate them to the table containing their human readable\n        /// names, sort order, and active record status.\n        /// &lt;/summary&gt;\n        private struct textBoxRow\n        {\n            public string Key { get; set; }\n            public TextBox TBox { get; set; }\n            public Label NameLabel { get; set; }\n            public string Name { get; set; }\n            public int Value { get; set; }\n        }\n        textBoxRow[] rows;\n\n        public Form1()\n        {\n            InitializeComponent();\n\n\n            DataSource = injuryDB.UnitExp;\n            relatedTableName = \"CatExpUnitExp\";\n\n        }\n\n        private void Form1_Load(object sender, EventArgs e)\n        {\n            this.uNITSTableAdapter.Fill(this.injuryDB.UNITS);\n            this.catExpTableAdapter1.Fill(this.injuryDB.CatExp);\n            this.unitExpTableAdapter1.Fill(this.injuryDB.UnitExp);\n            // Fill data table\n            // Associate them in the struct in sorted order \n\n            // Get a list of categories\n            DataTable catTable = DataSource.ParentRelations[relatedTableName].ParentTable;\n\n            // Sort them while leaving out the ones we don't want\n            List&lt;DataRow&gt; tbr = (from r in catTable.AsEnumerable()\n                                    where r.Field&lt;bool&gt;(\"ActiveRecord\")\n                                    orderby r.Field&lt;int&gt;(\"SortOrder\")\n                                    select r).ToList();\n\n            // The rows we are going to show\n            rows = new textBoxRow[tbr.Count];\n            tableLayoutPanel1.RowStyles.Clear();\n            int rowIndex = 0;\n\n            // Create rows and add them to the form\n            foreach (DataRow r in tbr)\n            {\n                textBoxRow tRow = new textBoxRow();\n\n                Label lbl = new Label();\n                lbl.Text = r.Field&lt;string&gt;(\"CatName\");\n\n                TextBox tb = new TextBox();\n\n\n                tRow.Key = r.Field&lt;string&gt;(\"Category\");\n                tRow.Name = r.Field&lt;string&gt;(\"CatName\");\n                tRow.TBox = tb;\n                tRow.NameLabel = lbl;\n\n                tableLayoutPanel1.RowStyles.Add(new RowStyle(SizeType.AutoSize));\n                tableLayoutPanel1.Controls.Add(tRow.NameLabel, 0, rowIndex);\n                tableLayoutPanel1.Controls.Add(tRow.TBox, 1, rowIndex);\n\n                rows[rowIndex] = tRow;\n                rowIndex++;\n            }\n\n            // Refresh the bindings in the text boxes when the current item changes\n            unitCatExpBindingSource.CurrentItemChanged += currentItemChanged;\n            currentItemChanged(null, null);\n        }\n\n        private void uNITSBindingNavigatorSaveItem_Click(object sender, EventArgs e)\n        {\n            bool validated = this.Validate();\n            if(validated == true)\n                Debug.WriteLine(\"Validated data to be saved\");\n            else\n                Debug.WriteLine(\"Did not validate data to be saved\");\n            this.uNITSBindingSource.EndEdit();\n            int recordsUpdated = this.tableAdapterManager.UpdateAll(this.injuryDB);\n            Debug.WriteLine(string.Format(\"{0} records were changed\", recordsUpdated));\n\n\n        }\n        private void currentItemChanged(object sender, EventArgs e)\n        {\n            if (rows == null) return;\n\n            // For some reason I have to pass this into the bindingSource's find method instead of a \n            // straight string of the column name. It has something to do with the fact that we are \n            // binding to a data relation instead of a DataTable i think. Wadded through so many forums for this...\n            PropertyDescriptor pdc = unitCatExpBindingSource.CurrencyManager.GetItemProperties()[\"Cat\"];\n\n            // Rebind each text box row\n            foreach (textBoxRow tBoxRow in rows)\n            {\n\n                tBoxRow.TBox.DataBindings.Clear();\n\n                // If the record doesn't exist then that means the population for that group is zero\n                tBoxRow.TBox.Text = \"0\";\n\n                //tbr.TBox.Leave -= existingRecordTBoxChanged;\n                //tbr.TBox.Leave -= nonExistingRecordTBoxChanged;\n                // Get the index of the source I want to bind to using the text\n                int bindingIndex = unitCatExpBindingSource.Find(pdc, tBoxRow.Key);\n                //object bs = unitCatExpBindingSource[bindingIndex];\n                if (bindingIndex &gt;= 0)\n                {\n                    Binding b = tBoxRow.TBox.DataBindings.Add(\"Text\", unitCatExpBindingSource[bindingIndex], \"Jumps\", true);\n\n                }\n                else\n                {\n                    // TODO: Create an event that adds a new to the demo table if number not 0\n                }\n\n            }\n        }\n\n        // TODO: for this to work the delete options of the relationships\n        // for Units -&gt; category tables need to be set to cascade\n        private void existingRecordTBoxChanged(object sender, EventArgs e)\n        {\n            TextBox tBox = (TextBox)sender;\n            if (tBox.Text == \"\" || tBox.Text == \"0\")\n            {\n                //DataRow d = (DataRow)tBox.DataBindings[0].DataSource;\n            }\n        }\n        private void nonExistingRecordTBoxChanged(object sender, EventArgs e)\n        {\n            TextBox tBox = (TextBox)sender;\n            if (!(tBox.Text == \"\" || tBox.Text == \"0\"))\n            {\n                // TODO: Add record to the database\n            }\n        }\n}\n&lt;code&gt;\n</code></pre>\n\n<p>My problem is that although when my binding seems to be working okay for viewing, i.e. the textboxes change when i navigate through the units. The changes don't save to the database. The changes I make in the text boxes will persist in the DataSet (when i move away from the record and come back they stay the same) but when I save the dataSet close the form and open it back up again the changes are gone. It's as if the dataSet wasn't notified that those values were changed. Furthermore, if I put the related data in a data grid along side my custom text box list I am able to modify the data from the DataGridView and I am able to save the data. Also, when I change the data in my TextBoxes the new values will show up in the DataGridView but still won't be saved...</p>\n\n<p>I'm wondering is the method that I use to bind the text boxes to the data correct. Meaning, can I bind data in the form of a DataRowView contained inside a Binding source and expect it to behave the same as if I used the binding source directly?</p>\n\n<p>Your help is much appreciated. I hope I've given enough information for you to go on. Keep in mind that this code sample is from a prototype. I understand that that it is not best practice. That said I would appreciate any constructive criticism. </p>\n\n<p>Also, would somebody please vote me up so that I can vote other people up. This site won't let me do hardly anything until somebody votes me up.</p>\n"},{"tags":[".net","winforms","localization"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13016282,"title":"extract all localizable strings from a form","body":"<p>We have an existing WinForms application which need to be translated.\nWe want to use a single resource file per solution, so we won't set localizable property of the form.</p>\n\n<p>I would like to develop a tool that, given a form, extract all the localizable hard coded strings in the designer. Something like Visual Studio does when localization property is set to True.<br>\nI need to extract only text, captions.</p>\n\n<p>How can I do it?</p>\n\n<p>Second step would be to automatically add extracted strings in the resource file and maybe replace hard coded string with new identifiers.</p>\n"},{"tags":["c#",".net","winforms","design-patterns","mvp"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13015999,"title":"Mvp View knows Model","body":"<p>I'm trying to use MVP and I notice that my View must know Model that should not happen in MVP I presume.</p>\n\n<p>here is example:</p>\n\n<pre><code>public partial class TestForm : Form, ITestView\n{\n    public void LoadList(IEnumerable&lt;AppSignature&gt; data)\n    {\n        testPresenterBindingSource.DataSource = data;\n    }\n}\n\npublic interface ITestView\n{\n    event EventHandler&lt;EventArgs&gt; Load;\n    void LoadList(IEnumerable&lt;AppSignature&gt; data);\n}\n\npublic class TestPresenter\n{\n   private ITestView view;\n\n   public TestPresenter(ITestView view)\n   {  \n       this.view = view;\n       view.Load += View_Load;\n   } \n\n   private void View_Load(object sender, EventArgs e)\n   {\n       var data = // get from model\n       view.LoadList(data);\n   }\n}\n</code></pre>\n\n<p>and the problem is that in TestForm I need reference to AppSignature.\nIn all tutorials I saw, there are some simple examples like \n<code>public void LoadList(IEnumerable&lt;String&gt; data)</code> where there is no need reference to model. But how i.e DataGridView can publish current row data? </p>\n"},{"tags":["c#",".net","winforms","listbox","doublebuffered"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2264,"score":2,"question_id":1131912,"title":"Double buffered ListBox","body":"<p>I have a CheckedListBox (WinForms) control (which inherits from ListBox; googling shows that the problem is with ListBox) that is anchored to all four sides of its form.  When the form is resized, the ListBox has an ugly flicker.  I tried inheriting CheckedListBox and setting <code>DoubleBuffered</code> to <code>true</code> in the ctor (this technique works with other controls, including ListView and DataGridView), but it had no effect.</p>\n\n<p>I tried adding the <a href=\"http://msdn.microsoft.com/en-us/library/ms632680.aspx\" rel=\"nofollow\"><code>WS_EX_COMPOSITED</code></a> style to <code>CreateParams</code>, and this helped, but makes the form resize mush more slowly.</p>\n\n<p>Is there any other way to prevent this flickering?</p>\n"},{"tags":["c#","winforms","dynamic","menustrip"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":103,"score":2,"question_id":12984600,"title":"C# Dynamic MenuStrip (without touching form)","body":"<p>Is it possible to dynamically create a MenuStrip without adding the instance via the form?</p>\n\n<p>I have done..</p>\n\n<pre><code>//Create menu\nMenuStrip menu = new MenuStrip();\nmenu.name = \"MainMenu\";\n\n// Create a Menu Item\nToolStripMenuItem file = new ToolStripMenuItem(\"File\");\n\n//Add item to Menu\nmenu.Items.Add(file);\n\n//Click event\nfile.Click += new System.EventHandler(this.FileItemClick);\n\nprivate void FileItemClick(object sender, EventArgs e)\n{\n    MessageBox.Show(\"File clicked\");\n}\n</code></pre>\n\n<p>I know I have to add it to the form with something like this..</p>\n\n<pre><code>this.MainMenuStrip = menu;\nControls.Add(menu);\n</code></pre>\n\n<p>but without an instance dragged onto the form already, the above isn't possible.\nIs there a way to 100% dynamically create a MenuStrip? Also, SubMenus?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","winforms","data-binding","inotifypropertychanged"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13013112,"title":"Databinding Listbox Winforms","body":"<p>This will have been answered in the other numerous threads on databinding and implementing INotifyPropertyChanged. However, I am still have difficulty getting this to work.</p>\n\n<p>Essentially I have two listboxes, when the user selects the server name from the first listbox the second is supposed to provide a list of databases on that server. Pretty simple. The second listbox however is not displaying the updated list of databases.</p>\n\n<p>Here is the code:\nCode to exec query and add data to the DatabaseList property.</p>\n\n<pre><code>        private void selection_Server_SelectionChangeCommitted(object sender, EventArgs e)\n    {\n        server = (string)selection_Server.SelectedItem;\n        try\n        {\n            ExecDBList(server, ref vm);\n        }\n</code></pre>\n\n<p>Class that manages properties used on the window.</p>\n\n<pre><code>    public class VM : INotifyPropertyChanged\n{\n    private static List&lt;string&gt; _dblist;\n    public  List&lt;string&gt; DatabaseList\n    {\n        get\n        {\n            return _dblist;\n        }\n        set\n        {\n            if (_dblist != value)\n            {\n                _dblist = value;\n            };\n        }\n    }\n    public VM() { }\n\n    void OnPropertyChanged(string PropertyName)\n    {\n            PropertyChanged(this, new PropertyChangedEventArgs(PropertyName));\n    }\n\n    public event PropertyChangedEventHandler PropertyChanged;\n</code></pre>\n\n<p>Code line on MainWindow initialization that assigns the listbox DataSource</p>\n\n<pre><code>            selection_RDM.DataSource = vm.DatabaseList;\n</code></pre>\n\n<p>Any help in getting this to work would be much appreciated as I'm struggling to understand the previous answers to databinding and using PropertyChangedEventHandler.</p>\n\n<p>Thank you\nRichard</p>\n"},{"tags":["winforms","wpf-controls"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":19,"score":-1,"question_id":13015596,"title":"importing wpf component to a windows form","body":"<p>i created a wpf file, attached bellow(as is, this is working). \ni only attached part of it, since it's very long and the problem remains if you try to attach a file like the one here.\nwhen i try to add it (in toolbox->add item->wpf component->adding the dll of the project containing the xaml) to a windows form, i get a message, also attached.\ni tried adding galasoft - mvvm light to my project, but it doesn't help.\ni'm pretty stuck, so if you have any idea for me it'll be much appreciated. thanks !\n<img src=\"http://i.stack.imgur.com/2v1e1.jpg\" alt=\"enter image description here\"></p>\n\n<pre><code>&lt;UserControl x:Class=\"ExportCheck.MainWindow\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        xmlns:cl=\"clr-namespace:ExportCheck.Classes\"\n        xmlns:i=\"clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity\"\n        xmlns:cmd=\"clr-namespace:GalaSoft.MvvmLight.Command;assembly=GalaSoft.MvvmLight.Extras.WPF4\"\n        xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\" \n        xmlns:ctrl=\"clr-namespace:Xceed.Wpf.Toolkit;assembly=WPFToolkit.Extended\"\n        xmlns:local=\"clr-namespace:ExportCheck\"\n        xmlns:local1=\"clr-namespace:ExportCheck.ViewModel\"\n             Height=\"700\" Width=\"740\"\n        Name=\"ExportTool\" \n             mc:Ignorable=\"d\" \n             xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" \n             d:DesignHeight=\"700\" \n             d:DesignWidth=\"740\" &gt;\n    &lt;UserControl.DataContext&gt;\n        &lt;local1:MainViewModel x:Name=\"DocExportVM\"/&gt;\n    &lt;/UserControl.DataContext&gt;                \n    ...\n&lt;/UserControl&gt;\n</code></pre>\n"},{"tags":["c#","winforms","dynamic"],"answer_count":0,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":143,"score":4,"question_id":13013564,"title":"Dynamic object not showing its methods","body":"<p>I am trying to convert the ffg:,</p>\n\n<p><strong>This Works</strong></p>\n\n<pre><code>IResultSEt rs =    db.SELECT.COLUMNS(db.GetTable(data.ToString()).ColumnNames).FROM(data.ToString()).Execute();\n</code></pre>\n\n<p>into this, which does not work,</p>\n\n<pre><code>dynamic rs = db.SELECT.COLUMNS(db.GetTable(data.ToString()).ColumnNames);\n           rs = rs.FROM(data.ToString());\n           rs = rs.Execute();\n</code></pre>\n\n<p>It gives me an error that it cannot find \"COLUMNS\".</p>\n\n<p>While debugging, it seems that <strong><em>rs</em></strong> is picking up all the <strong>return methods</strong> and <strong>private variables</strong> in the SELECT class it just is not picking up the method like COLUMNS in the SELECT class at runtime. This is very odd, I expected it to also pick up the methods, I am doing something wrong???</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>The definition for <strong>db</strong> in   <strong>db</strong>.SELECT.COLUMNS(db.GetTable(data.ToString()).ColumnNames); is</p>\n\n<pre><code> public class Database\n{\n    private Dictionary&lt;string, ITable&gt; _tables = new Dictionary&lt;string, ITable&gt;();\n\n    public ITable AddTable(string tableName, string[]columnNames, Type[] columnTypes)\n    {\n        ITable tbl = new Table(tableName);\n        tbl.SetColumns(columnNames, columnTypes);\n        _tables.Add(tableName.ToUpper(), tbl);\n\n        return tbl;\n    }\n\n    public ITable GetTable(string tableName)\n    {\n        return _tables[tableName.ToUpper()];\n    }\n\n    public ISELECT SELECT\n    {\n        get\n        {\n            ISELECT select = new SELECT(this);\n            return select;\n        }\n    }\n\n    public Dictionary&lt;string,ITable&gt; getTables()\n    {\n        return _tables;\n    }\n}\n</code></pre>\n\n<p>The definition for <strong>SELECT</strong> in   db.<strong>SELECT</strong>.COLUMNS(db.GetTable(data.ToString()).ColumnNames); which is an interface to my <strong>SELECT</strong> class;</p>\n\n<pre><code>public interface ISELECT\n{\n    ISELECT TOP(Int32 N);\n    ISELECT DISTINCT { get; }\n    ISELECTCOLUMN COLUMN(string columnName);\n    ISELECTTABLECOLUMN COLUMN(string tableName, string columnName);\n    ISELECTCOLUMNS COLUMNS(params string[] columnNames);\n    ISELECTSUMCOLUMN SUM(string columnName);\n    ISELECTSUMCOLUMN SUM(string tableName, string columnName);\n}\n</code></pre>\n\n<p>This is where the problem lies, the dynamic object is not picking up the methods in the interface, it picks up all private variables and the only method it picks up is <strong>\"DISTINCT\"</strong>.</p>\n\n<p>Below is part of the definition of the SELECT class, there is alot of code in it so I will just put a little;</p>\n\n<pre><code>internal class SELECT : ISELECT, ISELECTInternals\n{\n    private Database _dw;\n    private bool _DISTINCT;\n    private Int32 _TOPN = -1;\n    private List&lt;Int32&gt; _JOINNumbers = new List&lt;Int32&gt;();\n    private string[] _selectJOINLHScolumnTableNames;\n    private string[] _selectJOINLHScolumnNames;\n    private string[] _selectJOINRHScolumnTableNames;\n    private string[] _selectJOINRHScolumnNames;\n    private string[] _selectcolumnTableNames;\n    private string[] _selectcolumnNames;\n    private string[] _selectcolumnAliases;\n    private object[] _selectcolumnLiterals;\n    private string[] _selectcolumnStringTemplates;\n    private AggregateTypes[] _selectcolumnAggregates;\n    private string[] _queryTableNames;\n    private string _SUMcolumnName;\n    private string _FROMTableName;\n    private List&lt;string&gt; _INNERJOINTableNames = new List&lt;string&gt;();\n    private List&lt;string&gt; _JOINTableNames = new List&lt;string&gt;();\n    private List&lt;JoinTypes&gt; _TableJoinTypes = new List&lt;JoinTypes&gt;();\n    private bool _takeANDFlag = true;\n    private List&lt;string&gt; _filterColumnTableNames = new List&lt;string&gt;();\n    private List&lt;string&gt; _filterColumnNames = new List&lt;string&gt;();\n    private List&lt;object[]&gt; _filterColumnValues = new List&lt;object[]&gt;();\n    private List&lt;string&gt; _GROUPBYcolumnTableNames = new List&lt;string&gt;();\n    private List&lt;string&gt; _GROUPBYcolumnNames = new List&lt;string&gt;();\n</code></pre>\n\n<p>etc.</p>\n"},{"tags":["winforms","datagridview","messagebox"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13014419,"title":"GridView Data disappears with a No MessageBox Click","body":"<p>I have a gridview with a delete button. I've added a messagebox with an 'are you sure' yes/no.  The row of data is deleted fine when you click yes, but the gridview data disappears if you click no.</p>\n\n<p>Here's the code for the delete button click:</p>\n\n<pre><code>private void gvOrderLines_CellContentClick(object sender, DataGridViewCellEventArgs e)\n{\n    int intOrderID = 0;\n\n    if (e.RowIndex &lt; 0 || e.ColumnIndex != gvOrderLines.Columns[\"deleteBtn\"].Index) return;\n\n    Int32 orderLineID = (Int32)gvOrderLines[1, e.RowIndex].Value;\n\n    DialogResult result = MessageBox.Show(\"Do you want to delete this item? \",\"Delete Item\",MessageBoxButtons.YesNo);\n\n    if (result == DialogResult.Yes)\n    {\n        using (SqlConnection conn = new SqlConnection(connection))\n        {\n\n            SqlCommand comm;\n\n            comm = new SqlCommand(\"del_OrderLine\", conn);\n            comm.CommandType = CommandType.StoredProcedure;\n\n            comm.Parameters.Add(new SqlParameter(\"@orderLineID\", SqlDbType.Int));\n            comm.Parameters[\"@orderLineID\"].Value = orderLineID;\n\n            comm.Parameters.Add(\"@ReturnValue\", SqlDbType.Int).Direction = ParameterDirection.ReturnValue;\n\n            try\n            {\n                conn.Open();\n                comm.ExecuteNonQuery();\n\n                intOrderID = (int)comm.Parameters[\"@ReturnValue\"].Value;\n            }\n            catch \n            { \n                //tba\n            }\n            finally\n            {\n                comm.Dispose();\n                conn.Close();\n            }\n        }\n    }\n    populateOrderLines(intOrderID); // This repopulates the gv so why is it blank?\n    populateOrderTotals(intOrderID);\n}\n</code></pre>\n\n<p>Any suggestions?</p>\n\n<p>All the best,\nNumb</p>\n"},{"tags":["winforms","listview","resize"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13003529,"title":"Resizing ListView based on content","body":"<p>I have a ListView which I would like to resize based on the number of items. The view mode could be List, LargeIcon, SmallIcon, Tile -- anything BUT Details; I am not talking about resizing columns of each item in Details view to fit the width, but rather I want to know the height of the control required, given a certain width, to fit all items without scrollbars. I was hoping that there would be method on ListView to get the maximum item height &amp; maximum item width, but I cannot seem to find such methods. ListView.PreferredSize() seems useless. How can I create a better alternative to ListView.PreferredSize()?</p>\n"},{"tags":["c#",".net","winforms","datagridview","combobox"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":137,"score":0,"question_id":13005112,"title":"How to activate combobox on first click (Datagridview)","body":"<p>In winforms, you need to click the combobox twice to properly activate it - the first time to focus it, the second time to actually get the dropdown list.</p>\n\n<p>How do I change this behavior so that it activates on the very first click?</p>\n\n<p>Edit: Oh god.. I forgot that this is for DATAGRIDVIEW combobox. My mistake. Sorry.</p>\n"},{"tags":["c#",".net","wpf","winforms","multithreading"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":303,"score":2,"question_id":5509374,"title":"Background work with UI","body":"<p>Is it any easier to do background work with the UI in WPF?</p>\n\n<p>It's such a pain with WinForms, and would like an easier way. I want to do database work, and as it's doing database work, I want to populate a control with results returned from the database as it happens, and after it's done.</p>\n"},{"tags":["c#","wpf","asp.net-mvc","winforms","model-binding"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13008398,"title":"WPF or WinForms, MVC querystring-like value provider/binding","body":"<p>I'm working on a WPF project using a third party web browser control. To pass data from the  web page I'm doing a redirect in JavaScript and then cancelling the \"Navigating\" event of the browser [see Using WebKit.NET to call a C# function from JavaScript).</p>\n\n<p>In the navigating event I'm doing some URL crunching to create a dictionary of arguments from the URL parameters, and then call a particular method (also based on the URL).</p>\n\n<p>With a URL that looks something like this = 'app-Method?arg1=5.3&amp;arg2=3' I end up with a Dictionary containing the following information:</p>\n\n<pre><code>//var methodName = \"Method\";\n//var dictionary = { { \"arg1\", \"5.3\" }, { \"arg2\", \"3\" } };\n</code></pre>\n\n<p>It I can't do the conversion at this stage as different methods would have different arguments with different types.</p>\n\n<p>I'd then call another method (method name from the URL) like this:</p>\n\n<pre><code>switch(methodName)\n{\n     case \"Method\":\n         Method(Convert.ToDecimal(dictionary[\"arg1\"]), Convert.ToInt(dictionary[\"arg2\"]));\n         break;\n}\n</code></pre>\n\n<p>Obviously in MVC a HTTPGet action method does all this conversion, crunching, and method calling for me. I was wondering if (using the MVC libraries or some other method) it is possible to replicate this sort of behaviour in a non-MVC application, just for the purposes of cleaner looking code and more simplicity if there are lots of different methods.</p>\n\n<p>I hope that makes sense, I'm finding it a little difficult to explain.</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>Here's full example code:</p>\n\n<pre><code>this.browser.Navigating += (s, ev) =&gt;\n        {\n            if (ev.Url.AbsoluteUri.Contains(\"app\"))\n            {\n                var method = ev.Url.Host.Split('-')[1];\n                var arguments = ev.Url.Query.TrimStart('?').Split('&amp;');\n\n                var dictionary = new Dictionary&lt;string, string&gt;();\n\n                foreach (var arg in arguments)\n                {\n                    var split = arg.Split('=');\n\n                    dictionary.Add(split[0], split[1]);\n                }\n\n                switch (method)\n                {\n                    case \"add\":\n                        Add(Convert.ToInt32(dictionary[\"first\"]), Convert.ToInt32(dictionary[\"second\"]));\n                        break;\n                    default:                            \n                        break;\n                }\n\n                ev.Cancel = true;\n            }\n        };\n</code></pre>\n"},{"tags":["c#","winforms","aero","aero-glass"],"answer_count":2,"favorite_count":0,"up_vote_count":7,"down_vote_count":1,"view_count":222,"score":6,"question_id":12803841,"title":"Glass is not rendered right","body":"<p>I made a form and extended the glass in it like in the image below. But when I move the window so not all of it is visible on screen, the glass rendering is wrong after I move it back:\n<img src=\"http://i.stack.imgur.com/6fma8.png\" alt=\"enter image description here\"></p>\n\n<p>How can I handle this so the window is rendered correctly?</p>\n\n<p>This is my code:</p>\n\n<pre><code>[DllImport( \"dwmapi.dll\" )]\nprivate static extern void DwmExtendFrameIntoClientArea( IntPtr hWnd, ref Margins mg );\n\n[DllImport( \"dwmapi.dll\" )]\nprivate static extern void DwmIsCompositionEnabled( out bool enabled );\n\npublic struct Margins{\n    public int Left;\n    public int Right;\n    public int Top;\n    public int Bottom;\n}\n\nprivate void Form1_Shown( object sender, EventArgs e ) {\n    this.CreateGraphics().FillRectangle( new SolidBrush( Color.Black ), new Rectangle( 0, this.ClientSize.Height - 32, this.ClientSize.Width, 32 ) );\n    bool isGlassEnabled = false;\n    Margins margin;\n    margin.Top = 0;\n    margin.Left = 0;\n    margin.Bottom = 32;\n    margin.Right = 0;\n        DwmIsCompositionEnabled( out isGlassEnabled );\n\n    if (isGlassEnabled) {\n\n            DwmExtendFrameIntoClientArea( this.Handle, ref margin );\n        }\n}\n</code></pre>\n"},{"tags":["c#","winforms","forms","webbrowser"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":85,"score":1,"question_id":12978130,"title":"Deactivate Middle Mouse Button Move in Windows Browser Form","body":"<p>I got a WebBrowser Control in a Windows Form and i want to use the middle mouse button click to add a new tab to my Browser. The only problem is that everytime i use the middle mouse button, the arrows to move the page appear.</p>\n\n<p>So how can i disable this move command only for the clicks on my links?</p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13011407,"title":"How to handle the click event of DataGridViewLinkColumn","body":"<p>I have a WinForm in C#. One of the column of the <code>DataGridView</code> is of type <code>DataGridViewLinkColumn</code>. How do I handle the click event on each column ?</p>\n\n<p>This code does not seem to work :</p>\n\n<pre><code>private void UserDataTable_CellContentClick(object sender, DataGridViewCellEventArgs e)\n        {\n            //Code here\n        }\n</code></pre>\n\n<p>For instance, if I have 10 rows, whenever I click the content of each row corresponding to the column \"<code>DataGridViewLinkColumn</code>\", I should be able to handle it.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13010471,"title":"C# Importing csv files in datagridview","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1375410/very-simple-c-sharp-csv-reader\">Very simple C# CSV reader</a>  </p>\n</blockquote>\n\n\n\n<p>In my application the user can export and csv files from and to a datagridview, this works okay but there is some minor problem.</p>\n\n<p>As you know csv files use the comma sign to sepperate items.</p>\n\n<p>Sometimes one of the cells has a comma sign for example (2,5 hours).</p>\n\n<p>When importing the csv it thinks that the comma sign between 2,5 is a seperator, because of this it will put 2 in a cell and 5 in the next one.</p>\n\n<p>How can i fix this problem.</p>\n\n<p>This is my csv for importing csv's </p>\n\n<pre><code>dataGridView1.Rows.Clear();\n        try\n            {\n                if (openFileCsv.ShowDialog() == DialogResult.OK)\n                {\n                    string csvPath = openFileCsv.FileName;\n\n                    if (System.IO.File.Exists(csvPath))\n                    {\n                        System.IO.StreamReader fileReader = new System.IO.StreamReader(csvPath, false);\n\n\n                        //Reading Data\n                        while (fileReader.Peek() != -1)\n                        {\n                            fileRow = fileReader.ReadLine();\n                            fileDataField = fileRow.Split(',');\n                            dataGridView1.Rows.Add(fileDataField);\n                        }\n                        fileReader.Dispose();\n                        fileReader.Close();\n                    }\n                    else\n                    {\n                        MessageBox.Show(\"CSV Bestand niet gevonden.\");\n                    }\n                }\n\n                DataLoaded = true;\n\n            }\n</code></pre>\n\n<p>This is my code for exporting the csv.</p>\n\n<pre><code>if (saveFileCsv.ShowDialog() == DialogResult.OK)\n            {\n                string CsvFpath = saveFileCsv.FileName;\n\n                try\n                {\n                System.IO.StreamWriter csvFileWriter = new System.IO.StreamWriter(CsvFpath, false);\n\n            int countColumn = dataGridView1.ColumnCount - 1;\n\n            int iColCount = dataGridView1.Columns.Count;\n\n            foreach (DataGridViewRow dataRowObject in dataGridView1.Rows)\n            {\n                //Checking for New Row in DataGridView\n                if (!dataRowObject.IsNewRow)\n                {\n                    string dataFromGrid = \"\";\n\n                    dataFromGrid = dataRowObject.Cells[0].Value.ToString();\n\n                    for (int i = 1; i &lt;= countColumn; i++)\n                    {\n                        dataFromGrid = dataFromGrid + ',' + dataRowObject.Cells[i].Value.ToString();\n                    }\n\n                    //Writing Data Rows in File\n                    csvFileWriter.WriteLine(dataFromGrid);\n                }\n            }\n\n\n            csvFileWriter.Flush();\n            csvFileWriter.Close();\n        }\n        catch (Exception exceptionObject)\n        {\n            MessageBox.Show(exceptionObject.ToString());\n        }\n</code></pre>\n"},{"tags":["c#","winforms","icons"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13009399,"title":"Change Winform application Icon in Add/Remove programs","body":"<p>I have one winform application and i deployed that using click once. I changed the project icon. after publishing and installing,that icon is appearing in the desktop. That much is OK. But when i search that application in Add/Remove programs in the control panel,it shows one default icon,and not mine. How can i change that icon. or its not possible? If there is any way to change that icon,please help me..</p>\n"},{"tags":["vb.net","winforms","console"],"answer_count":7,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":3361,"score":2,"question_id":2638030,"title":"Console.Write Not Working In Win Forms App","body":"<p>I created a VB.NET Windows Forms Application in Visual Studio 2008.  When I run my program from the command-line, I get no output (only the next prompt).</p>\n\n<p>What am I doing wrong?</p>\n\n<pre><code>Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load\n    Debug.Write(\"Foo\")\n    Debug.Flush()\n    Console.WriteLine(\"foo\")\n    Console.Beep(800, 100) 'confirm this function is called'\n    Me.Close()\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT:</strong> Can a program have a form and a console?</p>\n\n<p><strong>EDIT2:</strong> Ho's answer works.  However, the output appears on the next command-line prompt.  Can a Winforms application tell the command-line to wait until it's finished instead of immediately returning?</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13010166,"title":"Prevent maximized applications flowing over my app","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/683330/how-to-make-a-window-always-stay-on-top-in-net\">How to make a window always stay on top in .Net?</a><br>\n  <a href=\"http://stackoverflow.com/questions/8510065/creating-a-net-app-that-docks-to-the-side-of-the-screen-and-limits-other-wind\">Creating a .NET app that “docks” to the side of the screen and limits other windows&#39; sizes when maximized</a>  </p>\n</blockquote>\n\n\n\n<p>I have a C# Winforms application that runs similarly to the menu bar on a Mac. It's only 24 pixels high, is the full width of the screen, located at the top and should be the top most application.</p>\n\n<p>However, when I run other applications and maximize them, they go under my application and I cannot see the control bar (icon, name, minimize, maximize and close buttons) for them. What I would like is for other maximized applications to maximize to just under my application, so I can still see the other applications control bar.</p>\n\n<p>Is there a way to prevent other applications from doing this, and getting them to maximize under my application?</p>\n\n<p>Thanks,\nKarl</p>\n"},{"tags":["c#",".net","winforms","listview","checkbox"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":859,"score":1,"question_id":786133,"title":"Can checkboxes be removed from a .NET WinForms ListView at runtime?","body":"<p>Is it possible to remove the checkboxes from a .NET WinForms ListView control at runtime?</p>\n\n<p>The following code appears to have no effect when '.Checkboxes' has initially been set to 'true' and the control has rendered onto a form with checkboxes available for each list view item:</p>\n\n<pre><code>// C#:\ntestListView.BeginUpdate();  \ntestListView.Checkboxes = false;  \ntestListView.EndUpdate();\n</code></pre>\n\n<p>Is there a method that must be called to enact this change?  What is the use of providing the .Checkboxes property when it defaults to 'false' and only has an effect if set to 'true'?</p>\n"},{"tags":[".net","winforms","silverlight","spline"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":1107,"score":0,"question_id":1027350,"title":"Visualize B-Spline in .NET","body":"<p>I might need to visualize a B-Spline ( <a href=\"http://en.wikipedia.org/wiki/B-spline\" rel=\"nofollow\">http://en.wikipedia.org/wiki/B-spline</a> ) in .NET. I do not where to start. Is there any easy way or library to do it? I would prefer to do it in Silverlight but WPF and Win Forms is also fine. I imagine the software as a coordinate system with some control points that you can add, delete or move around causing the spline to be repainted. Note that I lack the mathematical background. I found some methods in GDI+ that seem to be intended for drawing splines but I am not sure if these are B-Splines.</p>\n\n<p>Any advice would be appreciated. Libraries, code, links to guides or general suggestions are welcome.</p>\n"},{"tags":["c#","winforms","tooltip"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13008830,"title":"C# How can I change the BackColor of a ToolTip with isBalloon = true?","body":"<p>I saw this question: <a href=\"http://stackoverflow.com/questions/12990757/change-winform-tooltip-backcolor\">Change winform ToolTip backcolor</a> but the top answer solution did not work...<br>\nI set <code>isBalloon = true</code>, is that the problem? How can I still change the <code>BackColor</code>?</p>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":141,"score":4,"question_id":12354753,"title":"TextBox.TextChanged and \"CTRL-a\"","body":"<p>I write simply code:</p>\n\n<pre><code>using System.Windows.Forms;\n\nnamespace Test01\n{\n    partial class Form1\n    {\n        /// &lt;summary&gt;\n        /// Required designer variable.\n        /// &lt;/summary&gt;\n        private System.ComponentModel.IContainer components = null;\n\n        /// &lt;summary&gt;\n        /// Clean up any resources being used.\n        /// &lt;/summary&gt;\n        /// &lt;param name=\"disposing\"&gt;true if managed resources should be disposed; otherwise, false.&lt;/param&gt;\n        protected override void Dispose(bool disposing)\n        {\n            if (disposing &amp;&amp; (components != null))\n            {\n                components.Dispose();\n            }\n            base.Dispose(disposing);\n        }\n\n        #region Windows Form Designer generated code\n\n        /// &lt;summary&gt;\n        /// Required method for Designer support - do not modify\n        /// the contents of this method with the code editor.\n        /// &lt;/summary&gt;\n        private void InitializeComponent()\n        {\n            this.textBox1 = new System.Windows.Forms.TextBox();\n            this.checkBox1 = new System.Windows.Forms.CheckBox();\n            this.SuspendLayout();\n            // \n            // textBox1\n            // \n            this.textBox1.Location = new System.Drawing.Point(33, 32);\n            this.textBox1.Name = \"textBox1\";\n            this.textBox1.Size = new System.Drawing.Size(186, 20);\n            this.textBox1.TabIndex = 0;\n            this.textBox1.Text = \"Text\";\n            this.textBox1.TextChanged += new System.EventHandler(this.textBox1_TextChanged);\n            // \n            // checkBox1\n            // \n            this.checkBox1.AutoSize = true;\n            this.checkBox1.Location = new System.Drawing.Point(38, 65);\n            this.checkBox1.Name = \"checkBox1\";\n            this.checkBox1.Size = new System.Drawing.Size(80, 17);\n            this.checkBox1.TabIndex = 1;\n            this.checkBox1.Text = \"checkBox1\";\n            this.checkBox1.UseVisualStyleBackColor = true;\n            // \n            // Form1\n            // \n            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);\n            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;\n            this.ClientSize = new System.Drawing.Size(234, 86);\n            this.Controls.Add(this.checkBox1);\n            this.Controls.Add(this.textBox1);\n            this.Name = \"Form1\";\n            this.Text = \"Form1\";\n            this.ResumeLayout(false);\n            this.PerformLayout();\n\n        }\n\n        void textBox1_TextChanged(object sender, System.EventArgs e)\n        {\n            if (this.checkBox1.Checked)\n                this.checkBox1.CheckState = CheckState.Unchecked;\n            else\n                this.checkBox1.CheckState = CheckState.Checked;\n        }\n\n        #endregion\n\n        private System.Windows.Forms.TextBox textBox1;\n        private System.Windows.Forms.CheckBox checkBox1;\n    }\n}\n</code></pre>\n\n<p>And:</p>\n\n<pre><code>namespace Test01\n{\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n        }\n    }\n}\n</code></pre>\n\n<p>I get a windows with textbox(\"Text\") and checkbox. When i focus on textbox and press \"ctrl-a\" checkbox toggle state, because TextBox.TextChanged raised and textBox1_TextChanged executed.\nBut, i can`t understand why TextChanged event raised on ctrl-a?</p>\n"},{"tags":["c#","winforms","forms","dispose"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":3162,"score":4,"question_id":3610151,"title":"Dispose form after closing","body":"<p>I have got the new problem with opening and closing form in C#.</p>\n\n<p>My problem is how to dispose the form after closing .</p>\n\n<p>here is my code : </p>\n\n<p>Program.cs:</p>\n\n<pre><code>static class Program\n{\n    public static Timer timer;\n\n    [STAThread]\n    static void Main()\n    {\n        Application.EnableVisualStyles();\n        Application.SetCompatibleTextRenderingDefault(false);\n\n        timer = new Timer { Interval = 1000};\n        timer.Start();\n\n        Application.Run(new Form1());\n    }\n}\n</code></pre>\n\n<p>Form1.cs:</p>\n\n<pre><code>public partial class Form1 : Form\n{\n    public Form1()\n    {\n        InitializeComponent();\n    }\n\n    private void button1_Click(object sender, EventArgs e)\n    {\n        Form2 form = new Form2();\n        form.ShowDialog();\n       /// I've tried Dispose() method . but didn't work\n    }\n}\n</code></pre>\n\n<p>Form2.cs:</p>\n\n<pre><code>public partial class Form2 : Form\n{\n    public Form2()\n    {\n        InitializeComponent();\n    }\n\n    private void Form2_Load(object sender, EventArgs e)\n    {\n        Program.timer.Tick += timer_Tick;    \n        Close();\n        // I've tried Dispose() method instead of Close() but didn't work\n    }\n\n    private int count = 0; \n    void timer_Tick(object sender, EventArgs e)\n    {\n        count++;\n        if (count == 5) MessageBox.Show(\"\");\n    }\n}\n</code></pre>\n\n<p><strong>Edited :</strong>\nMy question is : why the message box shows after 5 seconds when the form2 has closed! </p>\n\n<p>A.mz</p>\n"},{"tags":["c#","windows","winforms"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":13007948,"title":"Get name of control when mouse hovers over it C#","body":"<p>I am adding ComboBoxes dynamically at runtime as shown below.\nThe problem that I am having is that i do not know which of the comboboxes the user is using.</p>\n\n<p>For eg. The user decides to add 5 comboBoxes to the form, and then goes to the first comboBox,and selects a value, I need to retrieve the value of that comboBox.</p>\n\n<p><strong>What the below code is doing - My approach</strong></p>\n\n<p>I am adding a comboBox to a FlowlayoutPanel and the retrieve its name based on the mouse co-ordinates.... this by the way is not working... and I have no idea what to do.</p>\n\n<p>Any help is greatly appreciated.</p>\n\n<pre><code>public partial class Form1 : Form\n{\n    int count = 0;\n\n    public Form1()\n    {\n        InitializeComponent();\n    }\n\n    private void button1_Click(object sender, EventArgs e)\n    {\n        count += 1;\n\n        ComboBox cb = new ComboBox();\n        cb.Name = count.ToString();\n        cb.MouseHover += new EventHandler(doStuff);\n\n        Label lb = new Label();\n        lb.Text = count.ToString();\n\n        flowLayoutPanel1.Controls.Add(cb);\n        flowLayoutPanel1.Controls.Add(lb);\n    }\n\n    public void doStuff(object sender, EventArgs e)\n    {\n        label1.Text = flowLayoutPanel1.GetChildAtPoint(Cursor.Position).Name;\n    }\n  }\n}\n</code></pre>\n"},{"tags":["mysql","vb.net","winforms","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":146,"score":0,"question_id":13007599,"title":"getting columns from multiple tables into 1 datagridview in vb.net","body":"<p>I'm asking once more, since I'm really new in vb, I am using visual studio 2010 and mysql for my database, I need help getting different columns from different tables but same database and load it into one datagridview. Any kind of help or tips would be much appreciated . Please and Thank you.</p>\n"},{"tags":["c++","winforms","mouseevent"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13007226,"title":"How to access Point Coordinates","body":"<p>Just starting out with GUI Windows programming. I'm working in Visual Studio C++ Wondows Forms.</p>\n\n<p>I've figured out how to grab the mouse coordinates and dump them into a double Point coordinate variable but when I try and access the the X &amp; Y values to manipulate them I get...</p>\n\n<pre><code>error C2248: 'System::Drawing::Point::x' : cannot access private member declared in class 'System::Drawing::Point'\n</code></pre>\n\n<p>The Point variable is called firstPoint and I'm trying to access the values using firstPoint.X  and firstPoint.Y.  I guess that's not the correct way to go about it.</p>\n\n<p>How do I go about converting the values into an int so I can mess with it?  Convert::ToInt32(firstPoint.x) is what threw the errors.</p>\n\n<p>Google searches keep sending me to pointer topics not Point Coordinate topics.</p>\n\n<p>Additional code as requested:</p>\n\n<pre><code>private:\n    /// &lt;summary&gt;\n    /// Required designer variable.\n    unsigned char ucRed, ucGrn, ucBlu;\n    bool drawing;\n    Point firstPoint, finalPoint;\n    //int iShape, iX1,iY1,iX2,iY2;\n\nprivate: System::Void panel1_Paint_1(System::Object^  sender, System::Windows::Forms::PaintEventArgs^  e) \n     {\n        Graphics^ g = e-&gt;Graphics;\n\n //create an ellipse with\n //  Black color\n //  start position = firstPoint mouse coordinate\n //  width = difference between firstPoint and finalPoint, height = difference between firstPoint and finalPoint\n\n\n        g-&gt;DrawEllipse(Pens::Black,firstPoint.x,firstPoint.Y,(finalPoint.X-firstPoint.X),(finalPoint.Y-firstPoint.Y));\n</code></pre>\n"},{"tags":["c#",".net","winforms","multithreading"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":137,"score":0,"question_id":7798566,"title":"setting new value to an label in thread execution","body":"<p>it's possible? I need for example,set new value to an label in thread execution.<br>\nI tried this: </p>\n\n<pre><code>private void button1_Click_1(object sender, EventArgs e)\n{\n  Thread th = new Thread(new ThreadStart(DoWork));\n  th.Start();\n}\n\npublic void DoWork()\n{\n    while (true)\n    {\n        StartSearch(path, ref httpRequest);\n    }\n}\n\n   public void StartSearch(string path, ref HttpWebRequest httpRequest) {\n                  foo.GetTopic(path, delegate(string post, string name, string uid)\n                  {\n                      {\n                          if (post.Contains(\"&lt;font color=\\\"#0000FF\\\"&gt;\"))\n                          {\n                              string msg = string.Format(\"Post:{0}\\r\\nby {1}({2})\", post, name, uid);\n                              //MessageBox.Show(msg);\n                              labelX.text = msg;\n                          }\n                      }\n                  }\n              );\n      }\n</code></pre>\n\n<p>I'm getting the following error:</p>\n\n<blockquote>\n  <p>Cross-thread operation not valid: Control 'labelX' accessed from a thread other than the thread it was created on.</p>\n</blockquote>\n\n<p>How I do this? Thanks in advance!</p>\n"},{"tags":["wpf","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13006688,"title":"Intergerate WPF application module into Window Forms based application","body":"<p>I have create a wpf application which has one mainwindow.xaml and two user controls usercontrol.xaml and usercontrol2.xaml.</p>\n\n<p>Now i want this WPF application to be run under window form platform. Is this possible by any means ?</p>\n"},{"tags":["c#","winforms","internet-explorer","webbrowser-control"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13005844,"title":"Intercept IE Context Menu Click in WebBrowser Control","body":"<p>I am using WinForms, i have added a WebBrowser control and would like to able to intercept a context menu firing event for the IE browser since the browser control is an instance of IE.</p>\n\n<p>I mean, i want to intercept the right click menu item click for the browser it self, i said to my self since it's an IE instance and it's inside my application, there got to be a way to do it.</p>\n\n<p>I tried to look at the events of the browser control, but nothing there is nothing that would help me.</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","winforms","visual-studio"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13006035,"title":"error in user control C# wizard creation","body":"<blockquote>\n  <p>Form1.cs</p>\n</blockquote>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Windows.Forms;\n\nnamespace Wizard\n{\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        protected override void OnLoad(EventArgs e)\n        {\n            this.CurrentPage = page11;\n            this.btnCancel.Enabled = false;\n            this.btnFinish.Enabled = false;\n\n            base.OnLoad(e);\n        }\n\n        private IPagePanel _currentPage;\n\n        public IPagePanel CurrentPage\n        {\n            get\n            {\n                return _currentPage;\n            }\n            set\n            {\n                _currentPage = value;\n            }\n        }\n\n        private void page11_Load(object sender, EventArgs e)\n        {\n\n        }\n\n        private void btnNext_Click(object sender, EventArgs e)\n        {\n            if (this.CurrentPage == page11)\n            {\n                this.CurrentPage = (IPagePanel)page21;\n                page21.Visible = false;\n                page21.Visible = true;\n                btnCancel.Enabled = true;\n            }\n            //else\n            //{\n            //    this.CurrentPage = _thirdPageWizardPanel;\n            //    _secondPageWizardPanel.Visible = false;\n            //    _thirdPageWizardPanel.Visible = true;\n            //    _cmdNext.Enabled = false;\n            //    _cmdFinish.Enabled = true;\n            //}\n        }\n    }\n}\n</code></pre>\n\n<p>The code shown above is of wizard which I wanted to create. Page1 and Page2 are user control pages which I use.</p>\n\n<blockquote>\n  <p>IPagePanel.cs</p>\n</blockquote>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\n\nnamespace Wizard\n{\n    public interface IPagePanel\n    {\n    }\n}\n</code></pre>\n\n<p>The user control Page1 and Page2 are in 2 separate namespaces.</p>\n\n<pre><code>namespace Page1\n{\n    partial class Page1\n    {\n        /// &lt;summary&gt; \n        /// Required designer variable.\n        /// &lt;/summary&gt;\n        private System.ComponentModel.IContainer components = null;\n\n        /// &lt;summary&gt; \n        /// Clean up any resources being used.\n        /// &lt;/summary&gt;\n        /// &lt;param name=\"disposing\"&gt;true if managed resources should be disposed; otherwise, false.&lt;/param&gt;\n        protected override void Dispose(bool disposing)\n        {\n            if (disposing &amp;&amp; (components != null))\n            {\n                components.Dispose();\n            }\n            base.Dispose(disposing);\n        }\n\n        #region Component Designer generated code\n\n        /// &lt;summary&gt; \n        /// Required method for Designer support - do not modify \n        /// the contents of this method with the code editor.\n        /// &lt;/summary&gt;\n        private void InitializeComponent()\n        {\n            this.lblDescription = new System.Windows.Forms.Label();\n            this.SuspendLayout();\n            // \n            // lblDescription\n            // \n            this.lblDescription.AutoSize = true;\n            this.lblDescription.Font = new System.Drawing.Font(\"Microsoft Sans Serif\", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));\n            this.lblDescription.Location = new System.Drawing.Point(228, 114);\n            this.lblDescription.Name = \"lblDescription\";\n            this.lblDescription.Size = new System.Drawing.Size(65, 20);\n            this.lblDescription.TabIndex = 0;\n            this.lblDescription.Text = \"Page 1\";\n            // \n            // Page1\n            // \n            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);\n            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;\n            this.Controls.Add(this.lblDescription);\n            this.Name = \"Page1\";\n            this.Size = new System.Drawing.Size(547, 278);\n            this.ResumeLayout(false);\n            this.PerformLayout();\n\n        }\n\n        #endregion\n\n        private System.Windows.Forms.Label lblDescription;\n    }\n}\n</code></pre>\n\n<p>Error Message:</p>\n\n<blockquote>\n  <p>Error 1   Cannot implicitly convert type 'Page1.Page1' to\n  'Wizard.IPagePanel'. An explicit conversion exists (are you missing a\n  cast?)     21  32  Wizard</p>\n</blockquote>\n"},{"tags":["c#","winforms","vsto","outlook-addin"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":88,"score":2,"question_id":13005994,"title":"Pop-up notification for Outlook Add-in (calling Form.Show() from background thread issue)","body":"<p>My Outlook 2010 add-in (using VSTO) does some web-service calls in a different thread when a mail is sent. I'd like to display a small non-modal pop-up notification (like those of Skype/yahoo/Windows live messenger) displaying the result of the web-service call.</p>\n\n<p>I was trying to customize the <a href=\"http://www.codeproject.com/Articles/277584/Notification-Window\" rel=\"nofollow\">Notification Window project</a> as per my requirements. It seems to work fine when called from a click event handler of a form of my add-in using the following code:</p>\n\n<pre><code>private void btnOk_Click(object sender, EventArgs e)\n{\n    PopupNotifier notifier = new PopupNotifier();\n    notifier.DisplayNotification(\"Test\");\n}\n</code></pre>\n\n<p>However, when the same method <i>notifier.DisplayNotification(\"Test\")</i> is called from the background thread doing the web-service call, the notifier hangs; Its form is displayed on screen, but no text, color or animation seems to work. It just sits there until Outlook is closed.</p>\n\n<p>I've done some searching and found that this might happen since the notifier is using the Show() method instead of ShowDialog() for displaying its form. And since I don't want a modal dialog for the pop-up notification, I can't change the method to ShowDialog() either.</p>\n\n<p>According to other articles, I've also tried calling the method using backgroundWorkers, delegates, MethodInvoker, etc. but could not get the desired result.</p>\n\n<p>However, while trying the above, I noticed that the same happens for not only the pop-up notifier, but any simple form. If I create it in the background thread and call the Show() method, it just gets stuck, whereas in the same situation ShowDialog() seems to work fine.</p>\n\n<p>Any idea on how I could fix this would be greatly appreciated.</p>\n"},{"tags":[".net","vb.net","winforms","textbox"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":3295,"score":3,"question_id":9489671,"title":"Check for empty TextBox controls in VB.NET","body":"<p>Ive got a Form application in VB.NET.</p>\n\n<p>I have many text boxes on one form (about 20). Is there anyway to check them all at once to see if they are empty instead of writing out a massive line of code to check each one individually such as </p>\n\n<pre><code>If txt1.text = \"\" Or txt2.text=\"\" Then\n    msgbox(\"Please fill in all boxes\")\n</code></pre>\n\n<p>That just seems like a long way around it?</p>\n"},{"tags":["sql-server","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":62,"score":3,"question_id":12987847,"title":"How to decrease the search time in Sql Server","body":"<p>I have created a windows form that uses SQL Server Database. The windows form contains a search grid which brings all the bank account information of a person. The search grid contains a special field \"Number of Account\" which displays the number of Accounts a person have associated with a bank. </p>\n\n<p>There are more than 100,000 records in the table from where the data is fetched. I just wanted to know how should I decrease the response time or the search time while getting the data from the table in the search grid. </p>\n\n<p>When I run the page it takes hell lot of time to get the records displayed in the search grid. Moreover, it does not get the data unless and until I provide a search criteria(To and from Date for searching)</p>\n\n<p>Is their any possible way to decrease the search time so that the data should get displayed in the grid.  </p>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":114,"score":1,"question_id":12215198,"title":"How to show and hide form using sliding effect of AnimateWindow function using c#?","body":"<p>I am using windows form for my application. I am loading another form on click of panel. Now I want to show sliding effect for opening and closing of form.I am able to add negative sliding effect while opening as form opens from right to left by overloading OnLoad event of form. But I am not able to hide the form with positive slide effect using <a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/ms632669.aspx\" rel=\"nofollow\">AnimateWindow</a> function. Is there any way to do this?</p>\n\n<p>This is what I have used to show the form:</p>\n\n<pre><code>protected override void OnLoad(System.EventArgs e)\n{\n  NativeMethods.AnimateWindow(this.Handle, 500, \n                  AW_ACTIVATE | AW_SLIDE | AW_HOR_NEGATIVE);\n\n  base.OnLoad(e);    \n}\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13004203,"title":"changing height of numeric updown","body":"<p>I am using a numeric updown in my application and i want to change the height of the numeric updown i cannot do it from the properties window , i tried to change it using code but still the height is unchanged,is there any way to change the height of the numeric updown either by properties window or by code dynamically. With the default height it is very difficult to change the number using a touch pen(monitor being used is a touch panel)\nI am using winforms(.net 4.0)</p>\n\n<pre><code>    dynamicUpDown.Width = 200;\n    dynamicUpDown.Height = 25;\n</code></pre>\n"},{"tags":["c#","winforms","list","panel"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":564,"score":1,"question_id":7163634,"title":"C# List of Panels","body":"<p>I would like to create panels with detailed information regarding an item (including a thumbnail image on the left hand side) and then add these to a scrollable list. Much like how iTunes on the iPhone displays the lists of applications available.</p>\n\n<p>I have done some searching but have thus far been unable to find any assistance.</p>\n\n<p>Does anyone have any ideas or links to samples they would like to share with me.</p>\n\n<p>Thanks in advance,\nRob</p>\n"},{"tags":["winforms","usercontrols"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13002684,"title":"User Control doesn't update it style","body":"<p>I'm bulding an app in Winform using User Controls.</p>\n\n<p>The problem is that when I update my user control (refering to the style) the forms where it is used don't realized that. If I add some code behind that works, but not the style.</p>\n\n<p>This is the last version of one of my UC.\n<img src=\"http://i.stack.imgur.com/6Yufd.png\" alt=\"enter image description here\"></p>\n\n<p>This is how it is shown in the form\n<img src=\"http://i.stack.imgur.com/kCUv4.png\" alt=\"enter image description here\"></p>\n\n<p>The real problem is the space between the label and the textbox! I need to remove it.\nI tried cleaning the bulding, updated the control panel, but nothing works.</p>\n"},{"tags":["c#","wpf","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":80,"score":2,"question_id":12993543,"title":"Efficiently drawing a two-dimensional grid in WPF","body":"<p>Here's a Windows Forms program which draws a two-dimensional grid of squares that are randomly colored black or red:</p>\n\n<pre><code>using System;\nusing System.Drawing;\nusing System.Windows.Forms;\n\nnamespace Forms_Panel_Random_Squares\n{\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n\n            Width = 350;\n            Height = 350;\n\n            var panel = new Panel() { Dock = DockStyle.Fill };\n\n            Controls.Add(panel);\n\n            var random = new Random();\n\n            panel.Paint += (sender, e) =&gt;\n                {\n                    e.Graphics.Clear(Color.Black);\n\n                    for (int i = 0; i &lt; 30; i++)\n                        for (int j = 0; j &lt; 30; j++)\n                        {\n                            if (random.Next(2) == 1)\n                                e.Graphics.FillRectangle(\n                                    new SolidBrush(Color.Red),\n                                    i * 10,\n                                    j * 10,\n                                    10,\n                                    10);\n                        }\n                };\n        }\n    }\n}\n</code></pre>\n\n<p>The resulting program looks something like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/wLt5H.png\" alt=\"enter image description here\"></p>\n\n<p>Here's a (naive) translation to WPF using <code>Rectangle</code> objects for each square:</p>\n\n<pre><code>using System;\nusing System.Windows;\nusing System.Windows.Controls;\nusing System.Windows.Media;\nusing System.Windows.Shapes;\n\nnamespace WPF_Canvas_Random_Squares\n{\n    public partial class MainWindow : Window\n    {\n        public MainWindow()\n        {\n            InitializeComponent();\n\n            Width = 350;\n            Height = 350;\n\n            var canvas = new Canvas();\n\n            Content = canvas;\n\n            Random random = new Random();\n\n            Rectangle[,] rectangles = new Rectangle[30, 30];\n\n            for (int i = 0; i &lt; rectangles.GetLength(0); i++)\n                for (int j = 0; j &lt; rectangles.GetLength(1); j++)\n                {\n                    rectangles[i, j] =\n                        new Rectangle()\n                        {\n                            Width = 10,\n                            Height = 10,\n                            Fill = random.Next(2) == 0 ? Brushes.Black : Brushes.Red,\n                            RenderTransform = new TranslateTransform(i * 10, j * 10)\n                        };\n\n                    canvas.Children.Add(rectangles[i, j]);\n                }\n        }\n    }\n}\n</code></pre>\n\n<p>The WPF version seems to be way more memory inefficient due to the fact that each cell in the world has the overhead of a <code>Rectangle</code> object.</p>\n\n<p>Is there a way to write this program in a style that's as efficient as the Forms version? Or is there no way around creating all those <code>Rectangle</code> objects?</p>\n"},{"tags":["vb.net","winforms","events","datagridview","usercontrols"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13002264,"title":"vb.net winforms how raise a custom event to a different control","body":"<p>I have a made a custom datagridview with custom column objects.  One of the columns in an edit button column which has a text box and a button to the right of it.  This is a user control.  What I am having problems with is when the user presses the button on the control I want an event to be raised on the datagridview which contains this column.  I am doing this in winforms and vb.net.  If anyone knows how to raise an event from the user control column which has the button to the datagridview which contains the column then it would be greatly appreciated.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","winforms","event-handling","menustrip"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":81,"score":1,"question_id":13002251,"title":"Passing a value to an event handler","body":"<p>I have dynamically added a few items to my Menu Strip and triggered and event for each item added to the strip (items are added from an XML file).\nWhat I'm trying to do next is to pass the text from each item to the event handler so I can use them in a thread. Is it possible to this? Can anyone help me with a solution please?</p>\n\n<p>This is my code:</p>\n\n<pre><code>private void historyMenuItem_Click(object sender, EventArgs e){\n    XmlDocument doc = new XmlDocument();  // create new xml document\n    doc.Load(\"..\\\\history.xml\");  // load the xml\n    // create a new node list\n    // and select nodes from BookItems/Book\n    XmlNodeList nodeList = doc.SelectNodes(\"URLs/http\"); \n\n    historyMenuItem.DropDownItems.Clear();\n    foreach (XmlNode node in nodeList) {\n        string page = node.Attributes[\"page\"].Value;\n        //http://msdn.microsoft.com/en-us/library/ms160990.aspx\n        ToolStripMenuItem windowNewMenu = new ToolStripMenuItem(page, null, new EventHandler(MenuItemClickHandler));\n        historyMenuItem.DropDownItems.Add(windowNewMenu);\n    }\n}\n\nprivate void MenuItemClickHandler(object sender, EventArgs e){\n    ToolStripMenuItem clickedItem = (ToolStripMenuItem)sender;\n    ## HERE IS WHERE I NEED HELP:\n    UrlTextBox = (I need value of page here!);\n    this.thread = new Thread(new ThreadStart(this.httpRequestMultiThread));\n    this.thread.Start();\n}\n</code></pre>\n"},{"tags":["c#",".net","winforms","usercontrols"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13002019,"title":"Navigate between multiples User Controls in one form","body":"<p>I have a form and multiple controls.</p>\n\n<p>Say I have a single form and it should contain some controls.</p>\n\n<p>I'm trying to work with a single form and add and remove controls depending on some use cases.</p>\n\n<p>For example, this is a sample code in my form class:</p>\n\n<pre><code>private void AddToControlPanel(UserControl control)\n        {\n            this.panelControl.Controls.Add(control);\n            this.panelControl.Tag = control;\n            this.panelControl.Size = control.Size;\n            this.panelControl.Dock = DockStyle.Fill;\n            control.Show();\n        }\n</code></pre>\n\n<p>Above sample adds a control to some panel and shows it.</p>\n\n<p>Problem is I can't manage to add some other control and drop current one. For example, if some login control authenticates successfully, drop login control itself and show other like a search box control. </p>\n\n<p>How can achieve that?</p>\n\n<p>This is what I've tried so far:</p>\n\n<pre><code>if (LoginOK)\n{\n   //Add the next Control I want to load\n   this.ParentForm.Controls.Add(new CtlPedirDevolucion());\n   //Remove this actual control\n   this.ParentForm.Controls.Remove(this);\n}\n</code></pre>\n\n<p>... so later show latest added control using an event handler:</p>\n\n<pre><code>private void FirstForm_ControlRemoved(object sender, ControlEventArgs e)\n{\n    this.Controls[this.Controls.Count - 1].Show();\n}\n</code></pre>\n\n<p>But this isn't working for me. In addition I don't like my approach.</p>\n\n<p>Will you suggest me a better way of achieving this please?</p>\n"},{"tags":["c#","winforms","linq","xtragrid","ultrawingrid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13001041,"title":"How to Implement Parent-Child DataRelation on XtraGrid or UltraWinGrid with LINQ","body":"<p>I'm using LINQtoSQL to bring data for a <em>DevExpress XtraGrid</em> or a <em>Infragistics UltraWinGrid</em> and show a parent row with a [<strong>+</strong>] sign so that I could click and see the details (similar to a 2 level tree). I've been sucessful before using a DataRelation for my DataSource, an then binding it just did it automatically. How can I achieve this using LINQ querys?</p>\n\n<p>example i've used in VB.NET for DataTables in a ADO.NET DataSource:</p>\n\n<pre><code>Dim rel As DataRelation = New DataRelation(\"Allocation\", dsAllocation.Tables(\"tblParent\").Columns(\"AllocKey\"), dsAllocation.Tables(\"tblChild\").Columns(\"AllocKey\"), True)\n</code></pre>\n\n<p>This link is the best info I have reasearched, but looking for a more dynamic way of doing it.\n<a href=\"http://documentation.devexpress.com/#WindowsForms/CustomDocument5495\" rel=\"nofollow\">http://documentation.devexpress.com/#WindowsForms/CustomDocument5495</a></p>\n\n<p>Thank you.</p>\n"},{"tags":["c#","winforms","multilingual"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":61,"score":4,"question_id":12996664,"title":"Multilangual WinForms application do not work with .NET 2.0","body":"<p>I'm trying develop a sample application with multi language files.<br>\nI use: Windows 7 64bit and Visual Studio 2012 Express.<br>\nI read a few tutorials on the web, and I created a sample app. </p>\n\n<p>In my Debug directory I created folders for language files: 'en' and 'pl'<br>\nI created text resource files in these directories and in the main directory, so my file structure is:</p>\n\n<pre><code>lang.txt\nlang.resouces\nmultilang.resources.dll\nmultilang.exe\n-en\n--lang.en.txt\n--lang.en.resources\n--multilang.resources.dll\n-pl\n--lang.pl.txt\n--lang.pl.resources\n--multilang.resources.dll\n</code></pre>\n\n<p>I wrote a .bat file to embed satellite assemblies do my app\n    resgen lang.txt\n    al.exe /t:lib /embed:lang.resources /culture:pl-PL /out:multilang.resources.dll</p>\n\n<pre><code>resgen en/lang.en.txt\nal.exe /t:lib /embed:en/lang.en.resources,multilang.en.resources /culture:en /out:en/multilang.resources.dll\n\nresgen pl/lang.pl.txt\nal.exe /t:lib /embed:pl/lang.pl.resources,multilang.pl.resources /culture:pl /out:pl/multilang.resources.dll\n</code></pre>\n\n<p>In my application I use ResourceManager</p>\n\n<pre><code>_rm = new ResourceManager(\"multilang\", Assembly.GetExecutingAssembly());\n</code></pre>\n\n<p>and the GetString method to obtain text</p>\n\n<pre><code>this._rm.GetString(stringFromRm);\n</code></pre>\n\n<p>It works fine when I compile my App in the .NET 4.5 Framework, but when I change the Target framework in Project properties to .NET 2.0 I always get this exception:   </p>\n\n<blockquote>\n  <p>System.Resources.MissingManifestResourceException</p>\n</blockquote>\n\n<p>My app must work on Windows XP, so it must work with earlier .NET Framework versions.</p>\n\n<p>Could somebody tell me what I must change to run my app on .NET Framework 2.0 ?</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":881,"score":3,"question_id":1249312,"title":"Disable expanding after doubleclick","body":"<p>Is there any way I can disable expanding TreeNode after doubleclick??</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","winforms","mdi"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13000632,"title":"MDI child capture mouse input to move parent MDI container","body":"<p>I have an MDI parent container (form style: none) that fits to 1280x800. Child forms fit just within, say probably 1 or 2 pixels padding between the child edge and the parent. Mean to look seamless.</p>\n\n<p>I know how to make separate forms draggable (regardless of where you click and hold down on the form) but is it possible to have a child dictate to the MDI parent where to move on screen? Reason being is that there is nothing on the parent that the user could click on. We cannot add an object to the parent (like a menu) because it would conflict with the design we are going for.</p>\n\n<p>Suggestions on this one? The goal would be that users could click and drag anywhere on the child and it would move the entire application.</p>\n"},{"tags":["c#","winforms"],"answer_count":4,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":70,"score":5,"question_id":12996052,"title":"How do I manipulate variable names based on the calling (Button) sender (button #) calling the method?","body":"<p>I have a bunch of text boxes in a panel on my C# Winform.  Each row of text boxes are named like this:</p>\n\n<blockquote>\n  <p>tb1    tbNickName1   comboBox1<br> tb2    tbNickName2   comboBox2<br>\n  tb3    tbNickName3   comboBox3<br></p>\n</blockquote>\n\n<p>and so on.</p>\n\n<p>I have a button next to each of the rows of text boxes.  But instead of having the button point to a different event for each button, I want to point the button to just the button1_Click event and have it do all of the processing there.  I know how to do this and all my buttons point to the button1_Click event.</p>\n\n<p>But I need to be able to determine which button it was called from (which I am able to do), but I need to manipulate the name of the text boxes in the event so I can do the processing based on what row I am in/button that I am calling from.</p>\n\n<p>For example, if I am in row number 2 where the tb2    tbNickName2   comboBox2 textboxes are, then I need to be able to have the button1_Click event know this and automatically assign the tb2    tbNickName2   comboBox2 values to the tmp variables that I use in the example below.</p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n{\n       Button bt = (Button) sender; //will return 'button1'\n\n       string tmpEmail = null;\n       string tmpNickName = null;\n       string tmpGroup = null;\n\n       //I don't want to hard code the tb1.Text value here, I want to have\n       // the namechange based on which (Button) sender it was called from.\n\n       // For example button1 should assign all the\n       // tb1    tbNickName1   comboBox1 values\n\n       //If called from button2, then it should assign the\n       //tb2    tbNickName2   comboBox2 values instead\n\n       //How can I do this so tb1.Text is based off of the button # that I am \n       //calling for example tb(bt).Text would be cool but that does not work.\n\n       tmpEmail = tb1.Text; //What do I change tb1.Text to based on button #?\n\n       tmpNickName = tbNickName1.Text; //What do I change tbNickName1.Text to?\n\n       tmpGroup = comboBox1.Text;//What do I change comboBox1.Text to?\n}\n</code></pre>\n\n<p><br>I know that I have not explained this very well, but it is the best I can do.</p>\n"},{"tags":["c#","winforms","listview"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":58,"score":0,"question_id":12999994,"title":"Intercept key press delete","body":"<p>I have a listview in my users component. On listview property LabelEdit is true. On listview i have contextmenustrip with item Delete with shortcut key Del. How can i catch key press Del that if a cell is edited - delete the text in the cell, if is not editable - delete Item on Listview???</p>\n"},{"tags":["c#","winforms","gridview","dataset","datasource"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":12998457,"title":"get data from dataset","body":"<p>I've created dataset using <code>Add new data source</code>. Then I created <code>BindingSource bs</code> and I fill it with data using method GetData(ShoppingMallDataSet is a newly added dataset)</p>\n\n<pre><code>void GetData(){\n    using(ShoppingMallDataSet smds = new ShoppingMallDataSet())\n    {\n         using (var conn = new SqlConnection(connection_string))\n         {\n              using (var adapter = new   ShoppingMallDataSetTableAdapters.TClientTableAdapter() { Connection = conn })\n              {\n                  adapter.Fill(smds.TClient);\n                  bs.DataSource = smds.TClient;\n              }\n         }\n    } \n}\n</code></pre>\n\n<p>I set value of datagrid datasource <code>rgv.DataSource = bs</code> and then call this method GetData(). In debugger bs.DataSource not null and it has data. But gridview has no columns,no data(but datasource at the same time is not null)</p>\n\n<pre><code>BindingSource bs = new BindingSource();\n.....\nrgv.DataSource = bs;\nGetData();\n....... // rgv doesn't have any data but datasource is not null and has the same value as bs  \n</code></pre>\n\n<p>Is something is wrong or it's incorrect way to get data?</p>\n"},{"tags":["winforms","visual-studio-2012","tabpage"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13000105,"title":"Using TabPages in Project Properties window in VisualStudio2012","body":"<p>How can I use the Tab control in project properties window in Visual Studio 2012 in my own windows form project?(below picture)</p>\n\n<p><img src=\"http://i.stack.imgur.com/IlYgb.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","winforms","webbrowser-control"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":136,"score":0,"question_id":12999735,"title":"How to programmatically answer \"Yes\" to WebBrowser control security alert","body":"<p>I am using WebBrowser control to programmatically access a single website, but whenever I login, I receive this certificate security alert:</p>\n\n<p><img src=\"http://i.stack.imgur.com/GTAnD.png\" alt=\"enter image description here\"></p>\n\n<p>Since I trust that website and since I need to programmatically automate the login as well, this dialog box gets in the way.</p>\n\n<p>I searched SO for a solution and found <a href=\"http://stackoverflow.com/q/178578/1357272\">a question similar to mine</a>, but <strong>the <a href=\"http://stackoverflow.com/a/178595/1357272\">accepted answer</a> does not work!</strong></p>\n\n<p>I defined a static member in the form that contains the WebControl:</p>\n\n<pre><code>public static bool ValidateServerCertificate(object sender, X509Certificate certificate, X509Chain chain, SslPolicyErrors sslPolicyErrors)\n{\n  return true;\n}\n</code></pre>\n\n<p>In my form's constructor I added:</p>\n\n<pre><code>ServicePointManager.ServerCertificateValidationCallback = new RemoteCertificateValidationCallback(ValidateServerCertificate);\n</code></pre>\n\n<p>But that didn't get rid of the certificate security alert.</p>\n\n<p>I also, clicked the <code>View Certificate</code> button, then clicked the <code>Install Certificate</code> button in the dialog that followed, but that didn't seem to help either.</p>\n\n<p>Is there any way to get rid of this warning?</p>\n\n<p>Is there an IE equivalent to Firefox's <a href=\"http://www.asknetinfo.com/plesk-control-panel-certificate-error.html\" rel=\"nofollow\">Add Security Exception‌​</a>?</p>\n\n<p><strong>Note:</strong> The owner's certificate works perfectly fine (without exhibiting this security alert) with standalone browsers (IE, FF, Chrome, Safari). It only exhibits the problem with the WebBroswer control.</p>\n"},{"tags":["c#","winforms"],"answer_count":7,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":2714,"score":4,"question_id":2896342,"title":"How can I get a round button?","body":"<p>I need you to refer me to a <strong>good</strong> dll file that I can add to my VS in order to have a round button control, any suggestions?</p>\n"},{"tags":["winforms","textbox","copy","paste"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":12990314,"title":"WinForm text box: MenuStrip keyboard shortcuts overriding OS-level copy/paste","body":"<p><strong>Update:</strong>  I've figured out the source of the issue, now trying to figure out the best fix</p>\n\n<p>I've got a Form with a customized MenuStrip, with all sorts of bells and whistles.  Of note here, is that many of my MenuStrip items have keyboard shortcuts - namely ones for Cut/Copy/Paste.</p>\n\n<p>It appears that the presence of this MenuStrip is overriding (and therefore cancelling) the default Cut/Copy/Paste keyboard shortcut behaviors for my text boxes (and other controls). </p>\n\n<p>All of them.</p>\n\n<p>.</p>\n\n<p>I can't really say I have a <em>reason</em> for the MenuStrip Cut/Copy/Paste options, besides the fact that I would expect to see them there.  That's how Office type programs operate, and it's something the user (myself included) would expect.</p>\n\n<p>I could remove the Cut/Copy/Paste options from the MenuStrip, but that would be admitting defeat! So how do I keep my overly engineered MenuStrip from forcing me to implement custom code for EVERY control that's Cut/Copy/Paste friendly?</p>\n\n<p>.</p>\n\n<hr>\n\n<p>** Original Post: **I've got a TextBox control in a toolbar which is to be used throughout my program.  Imagine my surprise when native OS-level Copy/Paste events were not supported by default.</p>\n\n<p>Sure, I could code something manually, but when I right-click on the control, Cut/Copy/Paste are already built in.  How can I leverage this existing functionality?</p>\n\n<p>I figure adding a KeyDown event with Ctrl+C, P, and X would be about the maximum I should have to code.  For those events I just call a built-in method or something.  That, or find a setting that enables native cut/copy/paste.</p>\n\n<p>What am I overlooking/missing?</p>\n"},{"tags":["winforms","entity-framework","data-binding"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":175,"score":0,"question_id":8984329,"title":"Adding a New Entity via Data Binding on a Details Form.","body":"<p>How can I use data binding on a details form to add a new entity to my data source? I have created an Object data source, and dragged it onto my form as 'details', which automatically adds a bindingSource and bindingNavigator control to my form, in addition to data bound detail fields. I have the following code which all executes with no exceptions, but no new Branch record gets added when I click 'Add New' and then 'Save'.</p>\n\n<pre><code>private void BranchEditForm_Load(object sender, EventArgs e)\n{\n    branchBindingSource.DataSource = _loansEntities.Branches;\n}\n\nprivate void branchBindingNavigatorSaveItem_Click(object sender, EventArgs e)\n{\n    _loansEntities.SaveChanges(SaveOptions.AcceptAllChangesAfterSave);\n}\n</code></pre>\n\n<p>I can't seem to find any Entity Framework data binding examples that don't just default to grids.</p>\n"},{"tags":["c#","winforms","validation","focus","control"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":3008,"score":2,"question_id":4464256,"title":"How to set focus to a control after validation in .NET","body":"<p>I have a WinForm application with several input controls on a form. In the validation event handler (either <code>Validating</code> or <code>Validated</code>), I need to determine what control to activate next, based on the validated value.</p>\n\n<p>In Microsoft's documentation of the <a href=\"http://msdn.microsoft.com/en-us/library/system.windows.forms.control.validating.aspx\" rel=\"nofollow\">Validating</a> event, it states:</p>\n\n<blockquote>\n  <p>Caution</p>\n  \n  <p>Do not attempt to set focus from within the Enter, GotFocus, Leave, LostFocus, Validating, or Validated event handlers. Doing so can cause your application or the operating system to stop responding. For more information, see the WM_KILLFOCUS topic in the \"Keyboard Input Reference\" section, and the \"Message Deadlocks\" section of the \"About Messages and Message Queues\" topic in the MSDN library at http: // msdn.microsoft.com/library.</p>\n</blockquote>\n\n<p>There is an <code>ActiveControl</code> property for a Form class that allows setting the control that is to become active, and no restrictions are mentioned. I have not found any other solution after several hours of web searches.</p>\n\n<p>Is setting the <code>ActiveControl</code> property (instead of <code>Focus</code>) from my Validated event handler a safe way to positively activate the control I want? If not, are there any solutions?</p>\n\n<p>Because the .NET Compact Framework doesn't have the <code>ActiveControl</code> property, can anyone suggest a solution?</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":210,"score":4,"question_id":9222213,"title":"OpenFileDialog hide preview","body":"<p>I have a strange situation where I have an rtf file, that while it opens in word, if I select it in an openfiledialog, then it freezes my .NET app and i have to kill the WINWORD.exe process to regain functionality. This is an issue with the preview pane as when it is hidden, there is no problem. </p>\n\n<p>My call to openfiledialog is bog standard.</p>\n\n<pre><code>using (OpenFileDialog openDialog = new OpenFileDialog() { Title = \"Select document...\", CheckFileExists = true, Filter = \"All files (*.*)|*.*\" })\n{\n    if (openDialog.ShowDialog() == System.Windows.Forms.DialogResult.OK) _FileName = openDialog.FileName;\n    else return;\n}\n</code></pre>\n\n<p>Other files preview OK, though I anticipate there may be other files may cause a problem, I just haven't found them yet.</p>\n\n<p>As i doubt I can troubleshoot the actual dialog, my workaround is to disable the preview pane - is there any way to do this? of prevent it showing by default?</p>\n\n<p>This is a problem whether the app is run in debug, or standalone.</p>\n"},{"tags":["c#","winforms"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":141,"score":1,"question_id":9857990,"title":"Can I make a window not resize itself until the user lets go of the mouse button?","body":"<p>I have some screens with a lot of stuff on them, and the redrawing performance is pretty poor. It is possible to set a form into a resizing mode where a rectangle is shown on the screen that denotes the new window dimensions as the user resizes it, but the actual form doesn't resize until they let go of the mouse button?</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","winforms","textbox"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":73,"score":2,"question_id":12997032,"title":"Dynamic textbox creation in form","body":"<p>I want to create a <code>TextBox</code> dynamically in form and retrieve its data and paste it into another TextBox in the same form when I click a button. </p>\n\n<p>I used the following code for creating texboxes dynamically :</p>\n\n<pre><code>public int c=0;\nprivate void button1_Click(object sender, EventArgs e)\n{\n\n    string n = c.ToString();\n    txtRun.Name = \"textname\" + n;\n\n    txtRun.Location = new System.Drawing.Point(10, 20 + (10 * c));\n    txtRun.Size = new System.Drawing.Size(200, 25);\n    this.Controls.Add(txtRun);\n} \n</code></pre>\n\n<p>I need the code for retrieving data from this TextBox</p>\n"},{"tags":["c#","winforms","image-processing","screenshot","aforge"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":97,"score":0,"question_id":12854731,"title":"changing the background color of the screenshot and using a bit map in aforge","body":"<p>1.i need to use a filter from aforge.net to a bit map and it doesnt let me...\n2.i need the screenshot to be saved with a bright color in its background(instead of the existing black).</p>\n\n<p>**</p>\n\n<ul>\n<li>i am using Aforge</li>\n</ul>\n\n<p>**</p>\n\n<pre><code>    using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Drawing.Imaging;\nusing System.Text;\nusing System.Windows.Forms;\nusing System.Threading;\nusing AForge.Imaging.Filters;\nusing AForge.Fuzzy;\nusing AForge.Imaging.ComplexFilters;\nusing AForge.Imaging.ColorReduction;\n\n\nnamespace ScreenShooter\n{\n\npublic partial class Form1 : Form\n{\n\n    public Form1()\n    {\n        InitializeComponent();\n    }\n    int x1, y1, x2, y2;\n\n\n    public Bitmap ScreenShot()\n    {\n        Size b = this.Size;\n        Rectangle totalSize = Rectangle.Empty;\n\n        foreach (Screen s in Screen.AllScreens)\n            totalSize = Rectangle.Union(totalSize, s.Bounds);\n\n        Bitmap screenShotBMP = new Bitmap(\n            totalSize.Width, totalSize.Height,\n            PixelFormat.Format32bppArgb);\n\n\n        Graphics screenShotGraphics = Graphics.FromImage(\n            screenShotBMP);\n\n        screenShotGraphics.CopyFromScreen(\n          x1,//[totalSize.Location.X,(from where the screenshot will be taken from(x=row)].\n          y1,//[totalSize.Location.Y,(from where the screenshot will be taken from(y=line))].\n         0, 0, b//[0,0 are the points(first =row,second=line)where the screenshot will stop to be taken from(the start of the dead zone,the zone that wont be in the image that will be saved)].\n           );\n\n        return screenShotBMP;\n    }\n\n    private void pictureBox1_Click(object sender, EventArgs e)\n    {\n\n    }\n\n\n    private void Form1_Load(object sender, EventArgs e)\n    {\n\n\n    }\n\n\n\n    private void Form1_MouseClick(object sender, MouseEventArgs e)\n    {\n\n        x1 = this.Location.X;//gets the form position(x) and puts it in x1\n        y1 = this.Location.Y;//gets the form position(y) and puts it in y1\n        this.Close();\n        Thread.Sleep(300);\n        pictureBox1.Image = ScreenShot();\n        pictureBox1.SizeMode = PictureBoxSizeMode.Zoom;\n\n        pictureBox1.Image.Save(\n                      \"ScreenShotShot.jpg\", ImageFormat.Jpeg);//save it as a temporery image\n        pictureBox1.Image.Save(\n          \"C:\\\\Users\\\\Yarden\\\\Desktop\\\\c.jpg\", ImageFormat.Jpeg);//save into a selected folder(in this e) in a selcted name (in this case c)\n        ColorFiltering filter = new ColorFiltering();\n        // set color ranges to keep\n        filter.Blue = new AForge.IntRange(0, 75);\n        filter.Red = new AForge.IntRange(100, 255);\n        filter.Green = new AForge.IntRange(0, 75);\n        Bitmap image = (Bitmap)filter.Apply(pictureBox1.Image);\n\n\n    }\n\n    private void Form1_DoubleClick(object sender, EventArgs e)\n    {\n\n\n        x2 = Cursor.Position.X;//gets the cursor position(x) and puts it in x2\n        y2 = Cursor.Position.Y;//gets the cursor position(y) and puts it in y2\n\n\n\n    }\n\n\n\n}\n</code></pre>\n\n<p>}</p>\n"},{"tags":["c#","winforms","tooltips"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":422,"score":2,"question_id":4124164,"title":"c# tooltip help","body":"<p>I am using a tooltip to display information when the user mouse_hovers on treeview nodes.  That side of it works perfectly as expected.  However I am having difficulty with the tooltip being visible when the mouse cursor leaves the treeview control.  I have tried messing around and setting the properties such as AutoPopDelay, etc but I cannot seem to get this right.  No matter what I do, when I move the cursor to the next control, the tooltip is obstructing the users view.</p>\n\n<p>Any advice please?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","winforms","forms","variables","radio-button"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":90,"score":0,"question_id":12984639,"title":"Passing values between forms; Refining","body":"<p>Basically; Form1 has 2 buttons, Form2 has 1 button.\nWhen you click Form2's button it checks which button on Form1 you clicked, opening Form3 or Form4 depending on which button you clicked (on Form1).</p>\n\n<hr>\n\n<p>So I've utilized Mark Halls first method of passing variables between forms. Now for the second half of my closed refinement.</p>\n\n<p>Form1</p>\n\n<pre><code>private void btnLogin_Click(object sender, EventArgs e)\n        {\n            // Call function while storing variable info.\n            Account(\"login\");\n        }\n\n        private void btnRegister_Click(object sender, EventArgs e)\n        {\n            // Call function while storing variable info.\n            Account(\"register\");\n        }\n\n        // Function used to pass Variable info to Account form while opening it as instance.\n        private void Account(string formtype)\n        {\n            // Generate/Name new instant of form.\n            frontend_account frmAcc = new frontend_account();\n            // Pass variable to instance.\n            frmAcc.CheckButtonClick = formtype;\n            // Show form instance.\n            frmAcc.Show(this);\n            // Hide this instance.\n            this.Hide();\n        }\n</code></pre>\n\n<p>Form2</p>\n\n<pre><code>// String Variable to store value from Login.\n        public string CheckButtonClick { get; set; }\n\n        private void btnContinue_Click(object sender, EventArgs e)\n        {\n            // If statement to open either Main form or Registration form, based on Login variable.\n            if (CheckButtonClick == \"login\")\n            {\n                // Generate/Name new instant of form.\n                frontend_main frmMain = new frontend_main();\n                // Show form instant.\n                frmMain.Show();\n                // Close this instant.\n                this.Close();\n            }\n            else if (CheckButtonClick == \"register\")\n            {\n                // Generate/Name new instant of form.\n                frontend_register frmReg = new frontend_register();\n                //  Show form instant.\n                frmReg.Show();\n                // Close this instant.\n                this.Close();\n            }\n        }\n</code></pre>\n\n<p>On Form2 there are <strong>TWO</strong> radio buttons, can I adept that code to set the focus of a tab control when a form is opened? ie. if radClient is checked set focus on tabcontrol after opening winform, else if radStudent is checked set focus on tabcontrol (other page) after opening winform... and i guess don't open a winform if no radio is checked.</p>\n\n<p>I believe this will set the focus;</p>\n\n<pre><code>// Sets focus to first tab.\ntabRegister.SelectedTab = tabRegister.TabPages[0];\n// Sets focus to second tab.\ntabRegister.SelectedTab = tabRegister.TabPages[1];\n</code></pre>\n"},{"tags":["c#","winforms","mdi","dual-monitor"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":12995873,"title":"Dual Monitor support for MDI applications","body":"<p>I need to implement dual monitor support for my MDI application. Can anybody suggest a good way to do that.</p>\n\n<p>I tried making my selected child forms 'MDIparent' field to 'null' when running in dual monitor mode to bring the child forms out of the MDI window. But if i reassigned the MDIparent, as i need to do it in dual mode also, the child forms events are not firing correctly.</p>\n\n<p>Any suggestion are welcomed.</p>\n\n<p>Thanks\nSunil</p>\n"},{"tags":["c#",".net","sql-server","winforms","mdf"],"answer_count":5,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":16285,"score":5,"question_id":2054905,"title":"Connecting to sql server database mdf file without installing sql server on client machine?","body":"<p>I am creating a  window application that need to use sql server database.\nI want to install this application to client machine without installing sql server so that my application can still connect to a database i.e mdf file that i will be providing at client system. </p>\n\n<p>How can i connect to a database(mdf) on client machine through my window application without installing sql server. ?\nI dont know is it possible or not.</p>\n\n<p>If possible what will be the connection string in that case. Database need not be used in network. </p>\n\n<p><strong>Client mahine dont need any installation. Every thing needs to be run through pen drive</strong></p>\n"},{"tags":["c#","winforms","datagridview","textbox"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":133,"score":4,"question_id":12991448,"title":"How to transfer data contained in a textbox to a datagridview?","body":"<p>I have 4 textboxes in a windows form application and a gridview and button called 'Add'. All I want is, the data entered in 4 textboxes should be gone to the datagridview's four different columns in the same row as i click Add button. If i clear the text boxes, fill them again and click the Add button again then the data should go to the 2nd row of the gridview.</p>\n"},{"tags":["c#","winforms","richtextbox","rtf"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":12994147,"title":"Why does my open menuIItem dialog box open the save file dialog box?","body":"<p>I made a small text editor that saves text from a <code>RichTextBox</code> into an <code>.rtf</code> file, but whenever I click the open menu option it opens the savefile dialog box. I cannot figure out why can anyone help me out?</p>\n\n<p>Here are the names for the menu dialog items. </p>\n\n<p>MenuStrip:     <code>menuStrip1</code>\nSave:     <code>saveMenu</code>\nOpen:     <code>openMenu</code>\nRichTextBox:  <code>richTextBox1</code></p>\n\n<p>here is the code that I am working on below... </p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Windows.Forms;\n\nnamespace WindowsFormsApplication1\n{\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        //save the file\n\n        private void menuStrip1_ItemClicked(object sender, ToolStripItemClickedEventArgs e)\n        {\n\n            // Text from the rich textbox rtfMain\n            string str = richTextBox1.Text;\n            // Create a new SaveFileDialog object\n            using (SaveFileDialog dlgSave = new SaveFileDialog())\n                try\n                {\n                    // Available file extensions\n                    dlgSave.Filter = \"Rich Text Format (.rtf)|*.rtf\";\n                    // SaveFileDialog title\n                    dlgSave.Title = \"Save\";\n                    // Show SaveFileDialog\n                    if (dlgSave.ShowDialog() == DialogResult.OK &amp;&amp; dlgSave.FileName.Length &gt; 0)\n                    {\n                        richTextBox1.SaveFile(dlgSave.FileName);\n\n                    }\n                }\n                catch (Exception errorMsg)\n                {\n                    MessageBox.Show(errorMsg.Message);\n                } \n\n\n        }\n\n        private void openMenu_ItemClicked(object sender, ToolStripItemClickedEventArgs e)\n\n        {\n            using (var of = new OpenFileDialog())\n            {\n                of.DefaultExt = \"*.rtf\";\n                of.Filter = \"RTF Files|*.rtf\";\n\n                if (of.ShowDialog() == DialogResult.OK)\n                    richTextBox1.Rtf = System.IO.File.ReadAllText(of.FileName);\n            }\n\n\n\n        }\n\n    }\n}\n</code></pre>\n"},{"tags":["c#","winforms","methods","input"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":12984522,"title":"How to get IsKeyDown method to work in C#","body":"<p>I can’t figure out how get this method to work: </p>\n\n<pre><code>System.Windows.Input.Keyboard.IsKeyDown(System.Windows.Input.Key)\n</code></pre>\n\n<p>The object browser says the following:</p>\n\n<blockquote>\n  <p><code>public static bool IsKeyDown(System.Windows.Input.Key key)</code><br>\n  Member of System.Windows.Input.Keyboard<br>\n  <strong>Summary:</strong><br>\n  Determines whether the specified key is pressed.<br>\n  <strong>Parameters:</strong><br>\n  key: The specified key.<br>\n  <strong>Return Values:</strong><br>\n  true if key is in the down state; otherwise, false.</p>\n</blockquote>\n\n<p>Okay, so it’s a member of Keyboard, right? I used the following code:\nKeyboard test = new Keyboard();</p>\n\n<p>But when I type test and then the dot, IsKeyDown is not an option. The only options are from the Windows.Forms members. What am I missing here? Thanks.</p>\n"},{"tags":["c#","winforms","treeview"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12993430,"title":"TreeView that holds Objects","body":"<p>Is there a way to have a <code>TreeView</code> hold <code>Objects</code> instead of a simple <code>string</code>?  Similar to how a <code>ListBox</code> functions?</p>\n\n<p>Or is there a control that is visibly similar to a <code>TreeView</code> that is capable of holding an <code>Object</code>?</p>\n"},{"tags":["c#",".net","winforms","hyperlink","richtextbox"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":2167,"score":5,"question_id":1526857,"title":"RichTextBox control, making non-URLs hyperlinks?","body":"<p>In a richtextbox I see there's DetectURLs and an event to go along with that...</p>\n\n<p>Is there a way to set up a word or series of words to act as a hyperlink even though they are not a hyperlink? My specific use is that I'm writing a ticker program that will scroll information across the bottom of the screen, I would like for some information to be clickable without putting the long, messy URL of the target. Anyway I can do this?</p>\n"},{"tags":["c#","winforms","timer"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":2636,"score":1,"question_id":2059400,"title":"Cannot access a disposed object","body":"<p>Cannot access a disposed object</p>\n\n<p>Anyone know why I would get this error \"Cannot access a disposed object\" on this line of code</p>\n\n<pre><code>Invoke(new UpdateTimerDelegate(UpdateTimer), new object[] { null });\n</code></pre>\n\n<p>Hit start over then either accept / reject / or close the form -- seems to happen when closing the form</p>\n\n<p>the error happens when you bring the form up again</p>\n\n<pre><code>using System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Windows.Forms;\n\nnamespace TimerTester\n{\n    public class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        private void StartOverBtn_Click(object sender, EventArgs e)\n        {\n            ShowForm2();\n        }\n\n        private void Form1_Load(object sender, EventArgs e)\n        {\n            ShowForm2();\n        }\n\n        private void ShowForm2()\n        {\n            Form2 f2;\n\n            f2 = new Form2(10000);\n            f2.Owner = this;\n            switch (f2.ShowDialog())\n            {\n                case DialogResult.Yes:\n                    break;\n                case DialogResult.No:\n                    break;\n                default:\n                    break;\n            }\n        }\n\n        /// &lt;summary&gt;\n        /// Required designer variable.\n        /// &lt;/summary&gt;\n        private System.ComponentModel.IContainer components = null;\n\n        /// &lt;summary&gt;\n        /// Clean up any resources being used.\n        /// &lt;/summary&gt;\n        /// &lt;param name=\"disposing\"&gt;true if managed resources should be disposed; otherwise, false.&lt;/param&gt;\n        protected override void Dispose(bool disposing)\n        {\n            if (disposing &amp;&amp; (components != null))\n            {\n                components.Dispose();\n            }\n            base.Dispose(disposing);\n        }\n\n        #region Windows Form Designer generated code\n\n        /// &lt;summary&gt;\n        /// Required method for Designer support - do not modify\n        /// the contents of this method with the code editor.\n        /// &lt;/summary&gt;\n        private void InitializeComponent()\n        {\n            this.StartOverBtn = new System.Windows.Forms.Button();\n            this.SuspendLayout();\n            // \n            // StartOverBtn\n            // \n            this.StartOverBtn.Location = new System.Drawing.Point(33, 33);\n            this.StartOverBtn.Name = \"StartOverBtn\";\n            this.StartOverBtn.Size = new System.Drawing.Size(75, 23);\n            this.StartOverBtn.TabIndex = 0;\n            this.StartOverBtn.Text = \"Start Over\";\n            this.StartOverBtn.UseVisualStyleBackColor = true;\n            this.StartOverBtn.Click += new System.EventHandler(this.StartOverBtn_Click);\n            // \n            // Form1\n            // \n            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);\n            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;\n            this.ClientSize = new System.Drawing.Size(292, 266);\n            this.Controls.Add(this.StartOverBtn);\n            this.Name = \"Form1\";\n            this.Text = \"Form1\";\n            this.Load += new System.EventHandler(this.Form1_Load);\n            this.ResumeLayout(false);\n\n        }\n\n        #endregion\n\n        private System.Windows.Forms.Button StartOverBtn;\n    }\n}\n</code></pre>\n\n<h2>form2</h2>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Windows.Forms;\nusing System.Diagnostics;\n\nnamespace TimerTester\n{\n    public class Form2 : Form\n    {\n        public Form2(int timeoutSecondsForAcceptCall)\n        {\n            this.timeoutSecondsForAcceptCall = timeoutSecondsForAcceptCall;\n            InitializeComponent();\n            tUpdateTimer = new System.Threading.Timer(new System.Threading.TimerCallback(UpdateTimer), null, TimeSpan.FromSeconds(1), TimeSpan.FromSeconds(1));\n        }\n\n        DateTime dtCreate = DateTime.Now;\n        int timeoutSecondsForAcceptCall = 99999;\n        System.Threading.Timer tUpdateTimer;\n\n        private delegate void UpdateTimerDelegate(object obj);\n        void UpdateTimer(object obj)\n        {\n            if (InvokeRequired == true)\n            {\n                Invoke(new UpdateTimerDelegate(UpdateTimer), new object[] { null });\n            }\n            else\n            {\n                TimeSpan ts = DateTime.Now - dtCreate;\n                if (ts.TotalSeconds &gt; timeoutSecondsForAcceptCall)\n                {\n                    DialogResult = DialogResult.Cancel;\n                    return;\n                }\n                TimeSpan timeleft = TimeSpan.FromSeconds(timeoutSecondsForAcceptCall) - ts;\n                label1.Text = FormatTimeSpan(timeleft);\n            }\n        }\n\n        private string FormatTimeSpan(TimeSpan ts)\n        {\n            return ((int)ts.TotalMinutes).ToString().PadLeft(2, '0') + \":\" + ((int)ts.Seconds).ToString().PadLeft(2, '0');\n        }\n\n\n        private void btnAccept_Click(object sender, EventArgs e)\n        {\n            DialogResult = DialogResult.Yes;\n        }\n\n        private void btnReject_Click(object sender, EventArgs e)\n        {\n            DialogResult = DialogResult.No;\n        }\n\n        /// &lt;summary&gt;\n        /// Required designer variable.\n        /// &lt;/summary&gt;\n        private System.ComponentModel.IContainer components = null;\n\n        /// &lt;summary&gt;\n        /// Clean up any resources being used.\n        /// &lt;/summary&gt;\n        /// &lt;param name=\"disposing\"&gt;true if managed resources should be disposed; otherwise, false.&lt;/param&gt;\n        protected override void Dispose(bool disposing)\n        {\n            if (disposing &amp;&amp; (components != null))\n            {\n                components.Dispose();\n            }\n            base.Dispose(disposing);\n        }\n\n        #region Windows Form Designer generated code\n\n        /// &lt;summary&gt;\n        /// Required method for Designer support - do not modify\n        /// the contents of this method with the code editor.\n        /// &lt;/summary&gt;\n        private void InitializeComponent()\n        {\n            this.btnAccept = new System.Windows.Forms.Button();\n            this.btnReject = new System.Windows.Forms.Button();\n            this.label1 = new System.Windows.Forms.Label();\n            this.SuspendLayout();\n            // \n            // btnAccept\n            // \n            this.btnAccept.Location = new System.Drawing.Point(31, 30);\n            this.btnAccept.Name = \"btnAccept\";\n            this.btnAccept.Size = new System.Drawing.Size(75, 23);\n            this.btnAccept.TabIndex = 0;\n            this.btnAccept.Text = \"Accept\";\n            this.btnAccept.UseVisualStyleBackColor = true;\n            this.btnAccept.Click += new System.EventHandler(this.btnAccept_Click);\n            // \n            // btnReject\n            // \n            this.btnReject.Location = new System.Drawing.Point(140, 29);\n            this.btnReject.Name = \"btnReject\";\n            this.btnReject.Size = new System.Drawing.Size(75, 23);\n            this.btnReject.TabIndex = 1;\n            this.btnReject.Text = \"Reject\";\n            this.btnReject.UseVisualStyleBackColor = true;\n            this.btnReject.Click += new System.EventHandler(this.btnReject_Click);\n            // \n            // label1\n            // \n            this.label1.AutoSize = true;\n            this.label1.Location = new System.Drawing.Point(31, 80);\n            this.label1.Name = \"label1\";\n            this.label1.Size = new System.Drawing.Size(35, 13);\n            this.label1.TabIndex = 2;\n            this.label1.Text = \"label1\";\n            // \n            // Form2\n            // \n            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);\n            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;\n            this.ClientSize = new System.Drawing.Size(240, 117);\n            this.Controls.Add(this.label1);\n            this.Controls.Add(this.btnReject);\n            this.Controls.Add(this.btnAccept);\n            this.Name = \"Form2\";\n            this.Text = \"Form2\";\n            this.ResumeLayout(false);\n            this.PerformLayout();\n\n        }\n\n        #endregion\n\n        private System.Windows.Forms.Button btnAccept;\n        private System.Windows.Forms.Button btnReject;\n        private System.Windows.Forms.Label label1;\n    }\n}\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":81,"score":2,"question_id":12992006,"title":"Mini game forms","body":"<p>I'm trying to make a mini game in C# (windows forms), like space invaders. The spacecraft flies well, but I'm not getting multiple shots, I have a method <code>timer_Tick</code> to make the animation, when I press space to shoot, the first shot works fine, but the second shot. The first shot in this half position disappears. The shots are <code>pictureBox</code> and I tried List of <code>pictureBox</code>, but without success.</p>\n\n<p>I have something like this:</p>\n\n<pre><code>    public void Form1_Load(object sender, EventArgs e)\n    {\n        shootP = new PictureBox();\n        shootP.Image = Properties.Resources.shoot_1;\n        shootP.SizeMode = PictureBoxSizeMode.Zoom;\n        shootP.Size = new Size(10, 72);  \n        ListShoot = new List&lt;PictureBox&gt;();      \n        int i = -1;\n    }\n     private void Form1_KeyDown(object sender, KeyEventArgs e)\n     {\n\n        if (e.KeyCode == Keys.Space)\n        {\n        control = false;\n        i++;\n        ListShoot.Add(shootP);\n        timeShoot.Start();\n     }\n\n      private void timeShoot_Tick(object sender, EventArgs e)\n      {\n        if (control == false)\n        {   \n            ListShoot[i].Location = new Point(spacecraft._imageBox.Location.X + 50, spacecraft._imageBox.Location.Y - 55);  // align the shoot with spacecraft\n            control = true;     \n        }\n\n            ListShoot[i].Top -= 40;\n      }\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"},{"tags":["c#",".net","winforms","paint","invalidate"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":442,"score":0,"question_id":11389850,"title":"C# Invalidate is not calling paint method","body":"<p>I have OnPaint method overrided to draw an Ellipse on the screen.</p>\n\n<pre><code>    protected override void OnPaint(PaintEventArgs e)\n    {\n        MessageBox.Show(\"Paint\");\n        if (debugStarted)\n        {\n            int y = rtbLogicCode.PlaceToPoint(new Place(0, debugLine)).Y;\n            if (rtbLogicCode.GetVisibleState(debugLine).ToString() == \"Visible\")\n            {\n                e.Graphics.FillEllipse(new LinearGradientBrush(new Rectangle(0, y, 15, 15), Color.LightPink, Color.Red, 45), 0, y, 15, 15);\n            }\n            base.OnPaint(e);\n        }\n    }\n\n    private void rtbLogicCode_Scroll(object sender, ScrollEventArgs e)\n    {\n        this.Invalidate();\n    }\n</code></pre>\n\n<p>The scroll event (On the Richtextbox) is handled properly but even though I am invalidating the form, it isn't calling the OnPaint function (The messagebox isn't showing).</p>\n\n<p>What could be the possible cause of this?</p>\n\n<p>Edit: I have forgot to mention that on my initialization function of the child form (added as a control of the main form using MDI property), I set the following styles:</p>\n\n<pre><code> private void LogicCodeInit()\n    {\n\n\n            this.SetStyle(ControlStyles.DoubleBuffer, true);\n            this.SetStyle(ControlStyles.ResizeRedraw, true);\n            this.SetStyle(ControlStyles.AllPaintingInWmPaint, true);\n            this.SetStyle(ControlStyles.UserPaint, true);\n\n\n    }\n</code></pre>\n\n<p>Edit2: I've also forgot to mention that the child form is added as a control of TabControl. The TabControl then is added as a control of the main form.</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":74,"score":2,"question_id":12991653,"title":"Refreshing a windows form application","body":"<p>I have two windows form applications.In the first application i have button called \"Request\".If i press the \"Request\" button, the data in the datagriview in the same application should go to the database and show a notification in the other application.I have succeed in that.All I need is to keep the second windows form application refreshing every 5 minutes.How to do that?</p>\n"},{"tags":["c#",".net","vb.net","winforms"],"answer_count":5,"favorite_count":0,"up_vote_count":12,"down_vote_count":0,"view_count":217,"score":12,"question_id":12981402,"title":"Is Application.Restart bad?","body":"<p>I've got a .Net windows form application where a lot of variables are initialized in the Main_Load event and I have a situation where I want my DB re-queried and all vars set to null and re-initialized (basically the form 100% reloaded from the start), but I wrote my Main-Load in such a way (my fault) that it's not that easy to do...</p>\n\n<p>I know I could get <em>exactly</em> what I want by simply calling <code>Application.Restart</code> and it does the trick <em>beautifully</em>, but I'm not sure if this is good programming practice or considered really bad.</p>\n\n<p>Are there any problems that I'm likely to run into by using <code>Application.Restart</code> in this context?</p>\n"},{"tags":["c#",".net","wpf","winforms"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":2,"view_count":58,"score":-1,"question_id":12991762,"title":"Application is working or not","body":"<p>How should I know if an application is working or processing something? Lets say that I'm trying to write a huge data into a file, on that time the application is not responding. I want to know the application current status.</p>\n"},{"tags":["winforms","text","datasource","infragistics","ultracombo"],"answer_count":3,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":3545,"score":1,"question_id":503339,"title":"Preset Value on Infragistics UltraCombo","body":"<p>I have an infragistics <code>ultraCombo</code> that I set to a specific <code>datasource</code>.  I want to pre-select one of those values so the user doesn't have to choose it (most of the time it will be the pre-selected value).  However, when I set the <code>ultraCombo</code> to that value it modifies the drop-down list to contain only that single value!</p>\n\n<p>I've tried using the <code>ultraCombo.value</code> method, the <code>ultraCombo.textbox.text</code> method, etc, and they all behave the same way. When I look in the debugger the full list appears to be present, just not displayed. How do I pre-select a value in the list without destroying my drop-down list?</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":12990959,"title":"Undo feature for Textbox","body":"<p>I'm working on a very simple Undo feature for a TextBox and I've got a weird problem.   When I try to take strings from the <code>Stack</code>that holds all the changes and put them inside the Textbox I don't see any changes.</p>\n\n<p>I made a little Debug Label  to check if this is really working or not.\nI found out that it is working in the label, but in the Textbox it uses its own Undo functions.</p>\n\n<p>Is there a way to cancel or override the Textbox Undo and use my own function?</p>\n\n<p>Here is sample code from the change I made:</p>\n\n<pre><code> private void Form1_KeyDown(object sender, KeyEventArgs e)\n        if (e.KeyCode == Keys.Z &amp;&amp; (ModifierKeys &amp; Keys.Control) == Keys.Control)\n            {\n                nameTextBox.Text = undoName.GetLastChange(); //--&gt; not working\n\n                undoDebuglabel.Text = undoName.GetLastChange(); --&gt; working\n            }\n}\n</code></pre>\n\n<p>The GetLastChange() is getting the info from a <code>Stack</code> inside the class.</p>\n\n<p>It's like the Textbox is not letting me to see the changes.\nCould it be because I'm using the same shortcut, <code>CTRL + Z</code> to do it?</p>\n"},{"tags":["c#","winforms","tooltip"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":77,"score":2,"question_id":12990757,"title":"Change winform ToolTip backcolor","body":"<p>I am using a ToolTip control in my project. I want to set its backcolor red. I have changed ownerdraw property to true and backcolor to red. But no result. Any suggestion?</p>\n\n<p>Regards,\nskpaul.</p>\n"},{"tags":["c#",".net","winforms","multithreading","invoke"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":92,"score":0,"question_id":12956288,"title":"Avoiding `ObjectDisposedException` while calling `Invoke`","body":"<p>I have 2 forms, one is <code>MainForm</code> and second is <code>DebugForm</code>. The MainForm has a button that sets up and shows the DebugForm like this, And passes a reference to an already opened SerialPort:</p>\n\n<pre><code>private DebugForm DebugForm; //Field\nprivate void menuToolsDebugger_Click(object sender, EventArgs e)\n{\n    if (DebugForm != null)\n    {\n        DebugForm.BringToFront();\n        return;\n    }\n\n    DebugForm = new DebugForm(Connection);\n\n    DebugForm.Closed += delegate\n    {\n        WindowState = FormWindowState.Normal;\n        DebugForm = null;\n    };\n\n    DebugForm.Show();\n}\n</code></pre>\n\n<p>In the DebugForm, I append a method to handle the <code>DataReceived</code> event of the serialport connection (in DebugForm's constructor):</p>\n\n<pre><code>public DebugForm(SerialPort connection)\n{\n    InitializeComponent();\n    Connection = connection;\n    Connection.DataReceived += Connection_DataReceived;\n}\n</code></pre>\n\n<p>Then  in the <code>Connection_DataReceived</code> method, I update a TextBox in the DebugForm, that is using Invoke to do the update:</p>\n\n<pre><code>private void Connection_DataReceived(object sender, SerialDataReceivedEventArgs e)\n{           \n    _buffer = Connection.ReadExisting();\n    Invoke(new EventHandler(AddReceivedPacketToTextBox));\n}\n</code></pre>\n\n<p>But I have a problem. As soon as I close the DebugForm, it throws an <code>ObjectDisposedException</code> on the <code>Invoke(new EventHandler(AddReceivedPacketToTextBox));</code> Line.</p>\n\n<p>How can I fix this? Any tips/helps are welcome!</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I found out if I remove the event in a button event click , and close the form in that button click, everything is fine and my debugform gets closed without any exception...how odd!</p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n{\n    Connection.DataReceived -= Connection_DebugDataReceived;\n    this.Close();\n}\n</code></pre>\n"},{"tags":["c#",".net","winforms","serial-port"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":2,"view_count":101,"score":1,"question_id":12913936,"title":"What causes my UI to freeze when closing a serial port?","body":"<p>I am working on a serial port related application. While using <code>DataReceived</code> event of <code>SerialPort</code> I need to update a textbox with the received bytes:</p>\n\n<pre><code>private void Connection_DataReceived(object sender, SerialDataReceivedEventArgs e)\n{\n    var data = Connection.ReadExisting();\n    _readBuffer.Add(indata);\n\n    Invoke(new EventHandler(AddReceivedPacketToTextBox));       \n}\n</code></pre>\n\n<p>So I use <code>Invoke</code> to update the textbox. But there is a big problem. When I try to close connection, my UI gets freezed, I think this is becase <code>Invoke</code> is doing somehing perhaps.</p>\n\n<p>A friend said I should use <code>RequiredInvoke</code>, but I have no idea what he ment really. How can I close the connection without messing up the invoke and UI thread?</p>\n\n<p>Here is my close method:</p>\n\n<pre><code>private void DisconnectFromSerialPort()\n{\n    if (Connection != null &amp;&amp; Connection.IsOpen)\n    {\n        Connection.Close();            \n    }\n}\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>As Hans said I changed <code>Invoke</code> to <code>BeginInvoke</code> but now its a bit worse, my application stops working due to <code>InvalidOperationException</code> because the collection <code>_readBuffer</code> was modified (Thats what the detail says in VS)</p>\n\n<p>Here is my code for adding text to textbox:</p>\n\n<pre><code>private void AddReceivedPacketToTextBox(object sender, EventArgs e)\n{\n\n    foreach (var i in _readBuffer)\n        tbIn.Text += string.Format(\"{0:X2} \", i);\n\n    tbIn.Text += Environment.NewLine;\n\n    ScrollToBottom(tbIn);\n\n    label4.Text = _receivedPackets.ToString();\n    _receivedPackets++;\n\n    _readBuffer.Clear(); //Possibly because clearing collection gets out of sync with BeginInvoke??         \n}\n</code></pre>\n\n<p><strong>2nd Update</strong></p>\n\n<p>I still have the problem, changing the <code>Invoke()</code> to <code>BeginInvoke</code> didn;t help. I also tried to add disconnect to form closing event nu success...anytime I close my form it gets stock (I mean its parent form, because this form that has access to serialport is being called from another form`.</p>\n\n<p>I mean I figured out that the UI gets locked only in 2 cases: If I clock a button which calls <code>Connection.Close()</code>  also if I try to close the form, the parent form will throw exception that some objects are disposed.</p>\n\n<p>I call the serial form like this from the parent form:</p>\n\n<pre><code>public DebugForm DebugForm;\n\nprivate void button1_Click(object sender, EventArgs e)\n{\n    if (DebugForm != null)\n    {\n        DebugForm.BringToFront();\n        return;\n    }\n\n    DebugForm = new DebugForm();\n    DebugForm.StartPosition = FormStartPosition.CenterScreen;\n    DebugForm.Closed += delegate\n                             {\n                                 WindowState = FormWindowState.Normal;\n                                 DebugForm = null;\n                             };\n\n    DebugForm.Show();\n    WindowState = FormWindowState.Minimized; \n}\n</code></pre>\n\n<p>Could this be the problem?!</p>\n"},{"tags":[".net","winforms","autocomplete","combobox"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":129,"score":0,"question_id":9382769,"title":"Autocomplete combobox mantaining character case","body":"<p>I have a control that inherits from a combobox and uses its capabilities to Autocomplete, Suggest and Append to show the user the top 10 most used names in our country that starts with the text that the user introduced.</p>\n\n<p>In order to explain what I vant to change I will use an example:</p>\n\n<p>1.- The user enters the text \"dav\" in the comobo (not a single Uppercase letter).</p>\n\n<p>2.- The combo searches for the top 10 most used names and comes with a list (like the following image)</p>\n\n<p><img src=\"http://i.stack.imgur.com/lFGkI.png\" alt=\"enter image description here\"></p>\n\n<p>3.- When You access the Mybase.Text the combo will return you \"Dav\" with the first letter capitalized. Like you can see on the image above this lines.</p>\n\n<p><strong>What I vant is the combobox to mantain the text entered for the user without any modificacion, no capitalizations</strong>. Like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/OWlsm.png\" alt=\"enter image description here\"></p>\n\n<p>For what I tested the change occurs when the original Combobox control matches the text entered with the options on the dropdown list. If the text on the list matches the text entered by the user but there are some case diferences, then the text on the combo is changed to match the one on the autocomplete list.</p>\n\n<p>Any ideas on how to accomplish this?.</p>\n"},{"tags":["c#","winforms","cross-threading"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":481,"score":2,"question_id":5421531,"title":"Can MessageBox.Show cause cross-thread exceptions?","body":"<p>Can I call <code>MessageBox.Show</code> on a child thread without worrying about a cross-thread exception?  I know the ostensible answer would be \"try it and find out\", which I did, successfully, but I've noticed that Windows 7 seems to be less strict about raising cross-thread exceptions than Windows XP.  </p>\n\n<p>So, is it documented anywhere that this would be safe to do from a child thread? </p>\n"},{"tags":["c#","winforms","gui","controls","tabcontrol"],"answer_count":8,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":24078,"score":8,"question_id":803540,"title":"Customizing a TabControl for the Closing of Individual Tabs","body":"<h2>My scenario is the following:</h2>\n\n<p>I am working on a winforms application in C# that has a button inside the main page of a tabcontrol that will generate another tabpage each time that it is clicked. Each new tabpage will contain a layout defined by a user control. </p>\n\n<h2>My Questions are:</h2>\n\n<ol>\n<li><p>How can I allow the user to then close one of the tabs that were created dynamically at runtime?</p></li>\n<li><p>How might I go about modifying the tabcontrol itself so that it has a small 'X' in each tab that the user may click on in order to close that particular tab? (Like Firefox has)</p></li>\n<li><p>How can I expose the SelectedIndex property of the tabcontrol to the user control if I want to close the tab with a button inside the user control instead?</p></li>\n</ol>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":5,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":3156,"score":2,"question_id":2018281,"title":"Winform DatagridView Numeric Column Sorting","body":"<p>I am using just a simple DataGridView to hold a bunch of data (Funny that). </p>\n\n<p>I have decimals in a particular column. But when it comes to ordering by that decimal column, it orders it incorrectly. For example : </p>\n\n<p>Starting order might be : </p>\n\n<ul>\n<li>0.56</li>\n<li>3.45</li>\n<li>500.89</li>\n<li>20078.90</li>\n<li>1.56</li>\n<li>100.29</li>\n<li>2.39</li>\n</ul>\n\n<p>The ending order would be : </p>\n\n<ul>\n<li>0.56</li>\n<li>100.29</li>\n<li>1.56</li>\n<li>20078.90</li>\n<li>2.39</li>\n<li>3.45</li>\n<li>500.89</li>\n</ul>\n\n<p>As you can see, it orders it starting from the first number. And then orders it in this way. </p>\n\n<p>I thought possibly I could set the column to a different \"ColumnType\" and that may automatically do it. But there is no \"Numeric\" or \"Decimal\" column types. </p>\n\n<p>I was on MSDN looking up the issue, and I could find the \"sort\" method that I can use on the DataGridView. But the explanation was a bit over my head, and the examples didn't use numbers, only text so I couldnt see how I was supposed to switch things up. </p>\n\n<p>Any help would be much appreciated. </p>\n"},{"tags":["c#","winforms","textbox","multiline","splitcontainer"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":2128,"score":3,"question_id":2120334,"title":"Multiline Textbox Resizing in C#","body":"<p>I have two multiline textboxes separated within a splitContainer.  When I drag the splitter left or right I would like the textboxes to resize accordingly.  How do I do this?  I am using Microsoft Visual C# 2008 Express Edition.  Thanks.</p>\n"},{"tags":["winforms","c#-4.0"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":12988583,"title":"create a datagridviewtextboxcolumn to autocomple","body":"<blockquote>\n  <p>I have a datagridview. In this datagridview, I have a\n  DataGridViewTextBoxColumn. here I want to make a autocomplete textbox\n  to datagridviewtextboxcolumn. Is it possible</p>\n</blockquote>\n"},{"tags":["c#",".net","asp.net-mvc","winforms","wcf"],"answer_count":4,"favorite_count":1,"up_vote_count":4,"down_vote_count":1,"view_count":369,"score":3,"question_id":10267414,"title":"Offline+Online Database Application","body":"<p>I am developing an accounting system for a customer. This application has some special requirements. I leave the accounting system detail which are specific to accounts. I mention those points which are confusing me.</p>\n\n<p>The application should work in Online and Offline environment. If user is working and suddenly Application goes offline User should be able to work offline. All offline work is stored in local database and sync next time to central database when Application connects to the internet.This application has many users and all will work at same time on same information. </p>\n\n<p>For Example If a user enters an inventory item it is possible that another user also enter the same item at that time. Application should be able to validate correct information and prohibits user to duplication.</p>\n\n<p>User local database must be updated all times either other users are working or not. If other users are working all updated information should be available in local database to ensure when user goes offline all information is updated.</p>\n\n<p>The question is How to develop this kind of application? Is there any standard way to achieve this target? Is there any standard or non standard pattern to build this kind of software?</p>\n\n<p>Please note I am using C# Dot Net and Intend to use .NET Remoting or WCF or ASP.NET MVC for this application.</p>\n\n<p>Any kind of help will be appreciated.\nThanks.</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":7,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":9601,"score":4,"question_id":63974,"title":"Flickering during updates to Controls in WinForms (e.g. DataGridView)","body":"<p>In my application I have a DataGridView control that displays data for the selected object. When I select a different object (in a combobox above), I need to update the grid. Unfortunately different objects have completely different data, even different columns, so I need to clear all the existing data and columns, create new columns and add all the rows. When this is done, the whole control flickers horribly and it takes ages. Is there a generic way to get the control in an update state so it doesn't repaint itself, and then repaint it after I finish all the updates? </p>\n\n<p>It is certainly possible with TreeViews:</p>\n\n<pre><code>myTreeView.BeginUpdate();\ntry\n{\n    //do the updates\n}\nfinally\n{\n    myTreeView.EndUpdate();\n}\n</code></pre>\n\n<p>Is there a generic way to do this with other controls, DataGridView in particular?</p>\n\n<p>UPDATE: Sorry, I am not sure I was clear enough. I see the \"flickering\", because after single edit the control gets repainted on the screen, so you can see the scroll bar shrinking, etc.</p>\n"},{"tags":["c#","winforms","tabbing"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1424,"score":1,"question_id":2133402,"title":"Windows Form - Tab key does not work in a child panel","body":"<p>I have a child panel in a form which contains some text boxes and buttons. I tried setting tabstop and tabindex properties for these controls so that the user can tab from one control to the next. But for some reason the tabbing does not work, the curor stays on the same field which has the focus when I press the tab key. I am using C# with .Net 3.5 framework. Below is how my code looks like -</p>\n\n<pre><code>  rightPanel.Controls.Clear();\n        marketMessageLabel = new Label();\n        marketMessageLabel.Location = new Point(0, 20);            \n        marketMessageLabel.AutoSize = false;\n        marketMessageLabel.Size = new Size(rightPanel.Width, 42);\n        marketMessageLabel.BackColor = Color.White;            \n        marketMessageLabel.Font = new System.Drawing.Font(\"Verdana\", 8.00F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));\n        rightPanel.Controls.Add(marketMessageLabel);                        \n\n        signinUserNameLabel = new Label();\n        signinUserNameLabel.Location = new Point(0, 150);\n        signinUserNameLabel.Size = new Size(60, 14);\n        signinUserNameLabel.BackColor = Color.White;\n        signinUserNameLabel.Text = \"User Name\";            \n        signinUserNameLabel.Font = new System.Drawing.Font(\"Verdana\", 9.00F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(0)));\n        rightPanel.Controls.Add(signinUserNameLabel);\n\n        signinUserNameTextBox = new TextBox();\n        signinUserNameTextBox.Location = new Point(0, 170);\n        signinUserNameTextBox.Width = this.Width - 80;\n        signinUserNameTextBox.Font = new System.Drawing.Font(\"Verdana\", 9.00F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(0)));         \n        signinUserNameTextBox.TabIndex = 0;\n        signinUserNameTextBox.TabStop = true;\n\n        rightPanel.Controls.Add(signinUserNameTextBox);\n\n        signinPasswordLabel = new Label();\n        signinPasswordLabel.Location = new Point(0, 192);\n        signinPasswordLabel.Size = new Size(100, 14);\n        signinPasswordLabel.Font = new System.Drawing.Font(\"Verdana\", 9.00F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(0)));\n        signinPasswordLabel.BackColor = Color.White;\n        signinPasswordLabel.Text = \"Password\";            \n        rightPanel.Controls.Add(signinPasswordLabel);                      \n\n        signinPasswordTextBox = new TextBox();\n        signinPasswordTextBox.Location = new Point(0, 210);\n        signinPasswordTextBox.Width = this.Width - 80;            \n        signinPasswordTextBox.PasswordChar = '*';\n        signinPasswordTextBox.TabIndex = 1;\n        signinPasswordTextBox.TabStop = true;\n        rightPanel.Controls.Add(signinPasswordTextBox);\n\n        signInButton = new Button();\n        signInButton.Text = \"Sign In\";\n        signInButton.Font = new System.Drawing.Font(\"Verdana\", 9.00F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));\n        signInButton.Width = 70;            \n        signInButton.BackColor = Color.White;\n        signInButton.Location = new Point(0,240);\n        signInButton.Click += new EventHandler(signInButton_Click);\n        signInButton.TabIndex = 2;\n        signInButton.TabStop = true;\n        rightPanel.Controls.Add(signInButton);\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":5,"favorite_count":5,"up_vote_count":18,"down_vote_count":0,"view_count":6595,"score":18,"question_id":2290959,"title":"Escape button to close WinForm in C#","body":"<p>I have tried the following:</p>\n\n<pre><code>private void Form1_KeyDown(object sender, System.Windows.Forms.KeyEventArgs e)\n{\nif((Keys) e.KeyValue == Keys.Escape) \n    this.Close();\n}\n</code></pre>\n\n<p>...doesn't work.</p>\n\n<p>Then i tried this:</p>\n\n<pre><code>protected override void OnKeyDown(KeyEventArgs e)\n{\nbase.OnKeyDown(e);\nif (e.KeyCode == Keys.Escape)\n    this.Close();\n}\n</code></pre>\n\n<p>..still nothing's working.</p>\n\n<p>The KeyPreview on my windows form properties is set to true...what am i doing wrong?</p>\n"},{"tags":["c#","winforms","graphic"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":99,"score":3,"question_id":12987584,"title":"Creating a map larger than form in C#","body":"<p>I'm trying to create some sort of simulation program and I've searched the net for answers but couldn't find a fitting one.</p>\n\n<p>My program will have like 10000 x 10000 map with X and Y coordinates and I'd like to find a way to have this large \"map\" but only displaying a selected part of this map on a form / panel. (You can move on the map with eihter buttons placed or keys doesn't really matter I know how to do that part)</p>\n\n<p>I'm looking to find a way to create and display this large map without using XNA, DirectX or any other advaced graphical engine, just like the simple system.graphic and / or system.graphic2d</p>\n\n<p>Thank you for your help!</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12975752,"title":"RichTextBox doesn't appear when content is exported as Image","body":"<p>I have a Panel where the contents are added dynamically and exported as an image file. I export the content as image using the following code below.</p>\n\n<pre><code> Bitmap tempBmp = new Bitmap(pnlCanvas.Width, pnlCanvas.Height);\n pnlCanvas.DrawToBitmap(tempBmp, new Rectangle(0, 0, pnlCanvas.Width, pnlCanvas.Height));\n tempBmp.Save(fileName);\n</code></pre>\n\n<p>In a particular case i have a RichTextBox control added to the panel. I found that the control is not seen when exported.</p>\n\n<p>I am not sure what goes wrong. Please guide me what should be done.</p>\n\n<p>Thanks in Advance,\nK</p>\n"},{"tags":["c#","winforms",".net-3.5","datagridview"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":898,"score":1,"question_id":7381374,"title":"DataSet to DataGridView with pre-defined Columns","body":"<p>I have a DataGridView that I've setup in a WinForms project. The Columns are all defined in the designer file. When I go to run my SQL the columns in the DataGridView get replaced with the columns names in the query. </p>\n\n<p>How do I keep the columns as defined by the DataGridView, and just add the rows from the dataset from the dataset to the GridView.</p>\n\n<pre><code>//Columns as they appear in the DataGridView\n Name | Address | City | State | Zip | Account Num |\n\n//Populate the gridView\nDataSet ds = Account.search(strSearch);\naccountGrid.DataSource = ds.Tables[0];\n\n//query\nstring sql = \"SELECT distinct acctNum, name, address, city, state, zip from accounts\";\nreturn DataService.GetDataSet(sql);\n\n//The End Result of the columns\nacctNum | name | address |city | state | zip\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":86,"score":3,"question_id":6059499,"title":"C# Winforms: How to make Return press Send?","body":"<p>How to keep the focus in the <code>textBox</code> but the Keyboard Return key presses the Send button?\n<img src=\"http://i.stack.imgur.com/rQS5T.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["vb.net","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12987173,"title":"How to close the child form","body":"<p>Using MDI and Child Forms</p>\n\n<p>Code.</p>\n\n<pre><code>childform_load\n\nMe.MdiParent = MDIMain\n</code></pre>\n\n<p>'</p>\n\n<pre><code> Private Sub form1_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles Me.KeyDown\n     If e.KeyCode = Keys.Escape Then\n         Me.Close()\n     End If\n End Sub\n</code></pre>\n\n<p>The above code is working for MDI Form (form name is mdiform1), but not working for child form1, when I press the escape key, it is closing the MDI Form instead of Child form.</p>\n\n<p>I check the Child Form Name also, name is form1 only.</p>\n\n<p>What was the problem, i need to change any property of child form.</p>\n\n<p>Need code help</p>\n"},{"tags":["c#","winforms","mschart"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":101,"score":1,"question_id":12985264,"title":"Sample C# Code To Print WinForm MSChart","body":"<p>I have been searching the internet high and low for a simple way to print an MSChart that I have on a WinForm to no avail.  Can someone please give me some information or point me to a resource that includes sample C# code to print a MSChart?  After over an hour of web research, I still do not even know where to start.  I also want to disclaim that I am very new to printing anything other than text and crystal reports.</p>\n"},{"tags":["c#","winforms","listview","virtualmode"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12986926,"title":"Listview with Virtualmode Search Item index","body":"<p>I want to find the index of specific item (item with text) in listview (listview in Virtual mode).</p>\n\n<p>Let me Describe my problem.</p>\n\n<p>I am working on two listview (ImageListview and DetailListview). ImageListview is in Virtual mode and DetailListview is normal one. I am binding both listview with same datatable.</p>\n\n<p>Now I want like, whenever I select an Item in DetailListview (Which is in Normal mode), I want same item to be selected in ImageListview(which is Virtualmode).</p>\n\n<p>I can SelectItem In ImageListview with <code>ImageListview.selectedindices.add(index)</code>. Here I want to find index of which I can pass to above code.</p>\n\n<p>I also tried with <code>ImageListview_SearchForVirtualItem</code> but not getting output right.</p>\n\n<p>Hope I am clear with my question. please let me know if any other detail is required.</p>\n\n<p>Thanks in Anticipation</p>\n"},{"tags":["vb.net","winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":44,"score":-2,"question_id":12986918,"title":"How to stop/minimize windows form flickering?","body":"<p>Any solution to stop flickering windows form while performing scrolling, form resizing etc. </p>\n"},{"tags":["c#",".net","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12986666,"title":"C# How to start from line 0 in richtextbox with loop","body":"<p>Okay my question is probably very simple for some of you but I can not figure it out. So let's say I have</p>\n\n<pre><code>String.Split( );\n</code></pre>\n\n<p>I add it to array, then if I want to print the content of the array I use</p>\n\n<pre><code>foreach (string s in splitarray)\n{\n  Richtextbox1.Text = Richtextbox1.Text + s;\n}\n</code></pre>\n\n<p>This way I keep the oldcontent and I print the new one ontop. But my problem is that it starts from Line[1] because as it appears the textbox already had an empty line inserted.</p>\n"},{"tags":["wpf","vb.net","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":12452807,"title":"WPF Running a command on a windows form","body":"<p>I have a WPF Project to which i've added a Windows Form.</p>\n\n<p>The windows form has a method <code>runme()</code>. But I'd like to call it from the WPF form.</p>\n\n<p>Currently I've used</p>\n\n<pre><code>Dim wpfForm as new wpfForm\nwpfForm.Show()\n</code></pre>\n\n<p>to display the the WPF form from a Windows form.</p>\n\n<p>I'm not sure how to send a command back though.</p>\n\n<p>I've tried:</p>\n\n<pre><code>Me.parent.runme()\n</code></pre>\n\n<p>But this gives me errors</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":6,"view_count":42,"score":-6,"question_id":12986379,"title":"ObjectDisposedException","body":"<p>Cannot access a disposed object.\nObject name: 'frmBill'.</p>\n\n<pre><code> private void distributorBillToolStripMenuItem_Click(object sender,System.EventArgs e)\n    {\n\n        frmBill objfrmBill = frmBill.GetChildInstance();\n        objfrmBill.MdiParent = this;\n        objfrmBill.Show();\n        objfrmBill.BringToFront();\n\n    }\n</code></pre>\n"},{"tags":["c#",".net","winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":32,"score":-2,"question_id":12986593,"title":"Previous all Row get blank when adding New Row in GridView Win Form","body":"<p>Previous all Row get blank when adding New Row in GridView Win Form. Only Last Row is Visible</p>\n"},{"tags":["c#","winforms","telerik","telerik-grid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12955595,"title":"Telerik unknown Error , unknown Version","body":"<p>I have a vs application i don't know what the version used is, but i used Q2 2010. \nPlease help me to find a version or get solution of this error .</p>\n\n<p>1- Index is read only.</p>\n\n<pre><code>radGridViewContainerStock.Columns[\"Product_Name\"].Index = 1;\n</code></pre>\n\n<p>2- row info doesn't have CellElement Property and VisualElement.</p>\n\n<pre><code>private void radGridViewContainerStock_ViewCellFormatting(object sender, CellFormattingEventArgs e)\n {\n     e.CellElement.RowInfo.Cells[\"Discrepancy\"].CellElement.ForeColor = radGridViewTripStock.Rows[e.CellElement.RowIndex].VisualElement.ForeColor;\n}\n</code></pre>\n"},{"tags":["c#","winforms","flexbuilder","axshockwaveflash"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12986084,"title":"How to use SWF generated using Flex builder in C# Winform","body":"<p>I have written a MXML application using Flex Builder and is working fine if i run it in the Flex Builder. It is rendering the chart as expected. \nNow, i have taken the SWF generated from bin-release folder of Flex Builder and put in my Visual Studio C# win form appliation. I tried to run that SWF in ShockwaveFlash object. It is rendering nothing, only a white sceen. \nCould anyone help me on whether I am in right direction.</p>\n"},{"tags":["c#","winforms","debugging"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":12984905,"title":"What’s the difference between the Debug class and Trace class?","body":"<p>I am attempting to write better error-handling and debug logic in one of our applications.  Can someone explain the difference between the Debug and Trace class?  The documentation looks pretty similar.  I want to use these classes in conjunction with NLog to improve our debugging efforts.</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":12984556,"title":"SwitchToThisWindow","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/5282588/how-can-i-bring-my-application-window-to-the-front\">How can I bring my application window to the front?</a>  </p>\n</blockquote>\n\n\n\n<p>I am having an issue with SwitchToThisWindow</p>\n\n<pre><code>using System;\nusing System.Text;\nusing System.Windows.Forms;\nusing System.Runtime.InteropServices;\nusing System.Diagnostics;\n\nnamespace BringToFront\n{\n    public partial class Form1 : Form\n    {\n        [DllImport(\"USER32.DLL\", CharSet = CharSet.Unicode)]\n        public static extern IntPtr FindWindow(String className, String windowName);\n\n        [DllImport(\"user32.dll\", SetLastError = true)]\n        static extern void SwitchToThisWindow(IntPtr hWnd, bool turnOn);\n\n        [DllImport(\"user32.dll\")]\n        public static extern IntPtr GetForegroundWindow();\n\n        IntPtr activeWindowHandle = GetForegroundWindow();\n\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        private void button1_Click(object sender, EventArgs e)\n        {\n            try\n            {\n                if (!checkBox1.Checked)\n                    bringToFront(comboBox1.SelectedItem.ToString());\n                else\n                    timer1.Enabled = true;\n            }\n            catch\n            {\n                MessageBox.Show(\"Please choose a Process Name\");\n            }\n        }\n\n        public static void bringToFront(string title)\n        {\n            IntPtr handle = FindWindow(null, title);\n            if (handle == IntPtr.Zero)\n            {\n                return;\n            }\n            SwitchToThisWindow(handle, true);\n        }\n\n        private void comboBox1_Click(object sender, EventArgs e)\n        {\n            comboBox1.Items.Clear();\n            Process[] process = Process.GetProcesses();\n            foreach (Process processes in process)\n            {\n                if (!String.IsNullOrEmpty(processes.MainWindowTitle))\n                    comboBox1.Items.Add(processes.MainWindowTitle.ToString());\n            }\n        }\n\n        private void timer1_Tick(object sender, EventArgs e)\n        {\n            Process process = Process.GetCurrentProcess();\n            string title = process.ProcessName.ToString();\n            IntPtr handle = FindWindow(null, title);\n\n            if (activeWindowHandle != handle)\n                bringToFront(comboBox1.SelectedItem.ToString());\n            if (!checkBox1.Checked)\n                timer1.Enabled = false;\n        }\n    }\n}\n</code></pre>\n\n<p>As you can see I'm trying to bring the process that is selected to the front and keep it in the front by doing a timer every 5 seconds and rebringing it to the front. It works perfectly when running the application through Microsoft Visual Studios, but when I run the program as a standalone, it works how every other function like this does and only makes it flash in taskbar instead of bringing it to the front.</p>\n\n<p>Why are the permissions different and is there anyway to fix this?</p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":12985837,"title":"C# Datagridview","body":"<p>I have 3 tables:</p>\n\n<ul>\n<li>ItemMaster(ItemID, ItemName)</li>\n<li>UnitMaster(UnitID, UnitName)</li>\n<li>Rates(ItemId, UnitId, ItemRate). </li>\n</ul>\n\n<p>Have set the relationships properly too. I have a datagridview on my c# winform. I have these columns in it(ItemId,UnitId,ItemRate) with ItemId &amp; UnitId being datagridviewcomboxes respectively. </p>\n\n<p>When I run the app, the DVgrid is blank, the behaviour of the datagridview is like this, when the user clicks \"add\" button on the form he is allowed to enter data into the DVgrid. when he enters the datagridviewcombobox itemidcolmn, he sees all the item ids in the dropdown and can select anyone, after hiting tab he moves on to Unitidcolmn datagridviewcombobox, from here he can select any unitid, on hitting tab again i want to be able to show user the rate related to that itemid &amp; unitid selected, into the rates column from the rates table automatically. Just to simplify more, itemid = 1 unitid = 1 rate = 200. itemid = 1 unitid = 2 rate = 300. ![enter image description here][1] (In the ItemId &amp; unit Id you can see text because i have mapped value member to display member). I tried to post an image so other ppl can understand what i mean, but because i m a new user it didnt alow me to post the image. Please help, have been stuck here since ages. 2 of my earlier posts were closed because i couldnt explain well. hope this helps. Couldnt post code as all this has been so far accomplished with DGv's grag &amp; drop &amp; databindings. I am very new to this. Please help. Thanks in advance. </p>\n"},{"tags":["c#","winforms","backgroundworker"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":77,"score":2,"question_id":12984223,"title":"Progress bar isn't working","body":"<p>I'm trying to use 4 progress bars in a 4 step process. Essentially the progress bars are being used because the project takes a LONG time to run, using a single progress bar with the (divide by ten) that normally is used would mean that the progress bar would gain 1 sliver every 20 minutes. (too long.)</p>\n\n<p>Here is the code:</p>\n\n<pre><code>backgroundWorker1.ReportProgress(a++);\n\nif (a == 100)\n{\n    backgroundWorker2.ReportProgress(b++);\n    a = 0;\n}\n\nif (b == 100)\n{\n    backgroundWorker3.ReportProgress(c++);\n    b = 0;\n}\n\nif (c == 100)\n{\n    c = 0;\n    d = 25;\n}\n\nbackgroundWorker4.ReportProgress(d);\n</code></pre>\n\n<p>The problem is, the first progress bar goes to about 99% and stops, the 2nd bar doesn't move at all but the process is still running.</p>\n"},{"tags":["c#","winforms","textbox"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":97,"score":1,"question_id":12984856,"title":"C# When using a KeyPress event on a text box, why cant i enter a minus sign?","body":"<p>Im using VS2010, and I have a text box... I assign a KeyPress on the box, abd set the method like so:</p>\n\n<pre><code>private void MyButton_KeyPress(object sender, KeyPressEventArgs e)\n    {\n        e.Handled = true;\n    }\n</code></pre>\n\n<p>I noticed that i am no longer able to enter any special keys such as the minus (-) and plus (+) sign into the textbox. Can someone please explain to me why i am no longer able to do this, and what i can do to fix this?</p>\n\n<p>Ultimately I'm trying to only allow numeric keys to be entered, and i also want to allow the (-) minus sign, but if i cant get the minus sign in there, then i guess i wont be able to limit the text of the box</p>\n"},{"tags":["vb.net","winforms","sqlite","null"],"answer_count":5,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":739,"score":2,"question_id":5786221,"title":"What are NULL values and how can I handle them in SQLite","body":"<p>What are NULL values ?</p>\n\n<p><img src=\"http://i.stack.imgur.com/piMVA.png\" alt=\"enter image description here\"></p>\n\n<p>Sometimes when I try to assign a query to variable, I get error saying  Type-Cast-Error.</p>\n\n<pre><code>txtMiddleName.Text = Reader.GetString(2)\n</code></pre>\n\n<p>How can I put it that if the value of the Middle is nothing then </p>\n\n<p><code>txtMiddleName.Text = \"\"</code></p>\n\n<p>(I already read the other post \"Handling NULL Values in SQLite but couldn't figure out much\")</p>\n\n<p>Working on VS 2010 (VB.net)</p>\n\n<p><em>EDIT 1</em>:</p>\n\n<p>This is the error Message I get</p>\n\n<p><img src=\"http://i.stack.imgur.com/Kz9KL.png\" alt=\"enter image description here\">\n(Line 364 is the above mentioned code)</p>\n"},{"tags":["c#",".net","winforms","textbox","richtextbox"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":70,"score":1,"question_id":12985448,"title":"TextBox display returns from RichTextBox?","body":"<p>I am creating an invoice program for a small local company but have run into sort of a problem.  I have it setup so the invoice is printable by taking a screen shot of the application then remove all image detail so it is just the text from the Windows Form.</p>\n\n<p>Problem is RichTextBoxes do not support drawing the text from them using DrawToBitmap. To fix this issue I am attempting to use a normal textbox. When inputting the address into a new textbox it does not show the returns in the text so it is all bunched up. Is there a way to fix this?</p>\n"},{"tags":["c#","winforms","charts","mschart"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":118,"score":1,"question_id":12984852,"title":"Why Doesn't MSChart Fill Entire Chart Area?","body":"<p>I am working on creating a couple of charts and I cannot figure out why there is so much empty space on the left and right side of the chart.  I have a Winforms Chart, ChartArea, and Series and there is always a good inch to the left and right side of the chart that seems like wasted space.  What setting do I need to change to reduce the size of this empty space?  I have included a screenshot of the chart with empty space with this post as well as the code that I use to create it.  Thanks in advance.</p>\n\n<p><img src=\"http://i.stack.imgur.com/1GGGm.png\" alt=\"enter image description here\"></p>\n\n<pre><code>        if (listBoxCharts.SelectedItems.Count == 1)\n        {\n            switch (listBoxCharts.SelectedItem.ToString().Trim())\n            {\n                case \"Incomplete Work Orders By Status\":\n                    ChartArea chartArea = new ChartArea();\n                    Series series = new Series();\n                    Title title = new Title();\n\n                    chartArea.Area3DStyle.Enable3D = true;\n                    chartArea.Area3DStyle.LightStyle = LightStyle.Realistic;\n                    chartArea.Area3DStyle.Rotation = 10;\n                    chartArea.Area3DStyle.WallWidth = 3;\n                    chartArea.BorderColor = Color.Transparent;\n                    chartArea.Name = \"IncompleteWorkOrdersByStatus_ChartArea\";\n\n                    // Fix this hack\n                    ChartContainer.ChartAreas.Clear();\n                    this.ChartContainer.ChartAreas.Add(chartArea);\n                    this.ChartContainer.Dock = DockStyle.Fill;\n                    this.ChartContainer.Location = new Point(2, 21);\n                    this.ChartContainer.Name = \"Charts\";\n                    this.ChartContainer.PaletteCustomColors = new Color[] { Color.LemonChiffon };\n\n                    series.ChartArea = \"IncompleteWorkOrdersByStatus_ChartArea\";\n                    series.ChartType = SeriesChartType.StackedColumn;\n                    series.CustomProperties = \"DrawingStyle=Cylinder\";\n                    series.EmptyPointStyle.BorderDashStyle = ChartDashStyle.NotSet;\n                    series.IsXValueIndexed = true;\n                    series.Name = \"IncompleteWorkOrdersByStatus_Series\";\n\n                    List&lt;WorkOrder&gt; incompleteWorkOrders = woDao.getIncompleteWorkOrders();\n\n                    var uniqueStatuses = (\n                        from statuses in incompleteWorkOrders\n                        select statuses.fkOrderStatus).Distinct().ToList();\n\n                    int xVal = 1;\n                    foreach (var status in uniqueStatuses)\n                    {\n                        var count = (\n                            from wo in incompleteWorkOrders\n                            where wo.fkOrderStatus == status\n                            select wo).Count();\n\n                        DataPoint dPoint = new DataPoint(xVal, count);\n                        if (status == null)\n                        {\n                            dPoint.AxisLabel = \"No Status\";\n                        }\n                        else\n                        {\n                            dPoint.AxisLabel = status.codedesc;\n                        }\n\n                        dPoint.ToolTip = count + \" \" + dPoint.AxisLabel;\n\n                        series.Points.Add(dPoint);\n\n                        xVal++;\n                    }\n\n                    this.ChartContainer.Series.Clear();\n                    this.ChartContainer.Series.Add(series);\n\n                    title.DockedToChartArea = \"IncompleteWorkOrdersByStatus_ChartArea\";\n                    title.IsDockedInsideChartArea = false;\n                    title.Name = \"IncompleteWorkOrdersByStatus_Title\";\n                    title.Text = \"Incomplete Work Orders By Status\";\n\n                    this.ChartContainer.Titles.Clear();\n                    this.ChartContainer.Titles.Add(title);\n                    break;\n\n                default:\n                    break;\n            }\n        }\n</code></pre>\n"},{"tags":["c#",".net","winforms","backgroundworker"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":12984711,"title":"C# Background Worker DoWork getting stuck","body":"<p>Hey I have this test back ground worker which seems to get stuck on the DoWork method or maybe  the RunWorkerCompleted is not being fired can you guys see anything wrong here?</p>\n\n<p>Maybe I am not implementing this properly :/</p>\n\n<pre><code> using System;\n    using System.Collections.Generic;\n    using System.ComponentModel;\n    using System.Data;\n    using System.Drawing;\n    using System.Linq;\n    using System.Text;\n\n        using System.Threading.Tasks;\n        using System.Windows.Forms;\n        using MailChimp;\n        using System.Threading;\n        using System.Runtime.InteropServices;\n\n        namespace Chimporter\n        {\n            public partial class Form1 : Form\n            {\n                //Worker thread flag set to false\n                static bool done = false;\n                //Console dll\n                [DllImport(\"Kernel32.dll\")]\n                static extern Boolean AllocConsole();\n\n                public Form1()\n                {\n                    InitializeComponent();\n                }\n\n                private void button1_Click(object sender, EventArgs e)\n                {\n\n                }\n\n                private void label1_Click(object sender, EventArgs e)\n                {\n\n                }\n\n\n\n                private void accountInformationToolStripMenuItem_Click(object sender, EventArgs e)\n                {\n                    //loadWindow pleaseWait = new loadWindow();\n                    //pleaseWait.Show();\n                    BackgroundWorker bg = new BackgroundWorker();\n                    bg.DoWork += new DoWorkEventHandler(bg_DoWork);\n                    bg.RunWorkerCompleted += new RunWorkerCompletedEventHandler(bg_RunWorkerCompleted);\n                    bg.RunWorkerAsync();\n                    while (!done)\n                    {\n                        //Console.WriteLine(\"Waiting in Main, tid \" + Thread.CurrentThread.ManagedThreadId);\n                        //Thread.Sleep(100);\n\n                    }\n                    //AccountInfo accInfo = new AccountInfo();\n                    //accInfo.Show();\n\n                }\n\n                public void bg_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)\n                {\n                    if (!AllocConsole())\n                    {\n                        Console.WriteLine(\"Fnished! \" + Thread.CurrentThread.ManagedThreadId);\n                    }\n                    done = true;\n                }\n\n                public void bg_DoWork(object sender, DoWorkEventArgs e)\n                {\n                    for (int i = 0; i &lt;= 3; i++)\n                    {\n                        if (!AllocConsole())\n                        {\n                            Console.WriteLine(\"Work Line: \" + i + \", tid \" + Thread.CurrentThread.ManagedThreadId);\n                            Thread.Sleep(500);\n                        }                \n                    }            \n                    //string key = \"e42713458882f6c2c27b3d6d951174a2-us6\";\n                    //var mc = new MCApi(key, true);\n                    //string user = mc.GetAccountDetails().Username.ToString();\n                    return;\n                }\n\n                private void menuStrip1_ItemClicked(object sender, ToolStripItemClickedEventArgs e)\n                {\n\n                }\n\n                private void exitToolStripMenuItem_Click(object sender, EventArgs e)\n                {\n                    //Exit application Form.Close()\n                    Application.Exit();\n                }\n            }\n        }\n</code></pre>\n"},{"tags":["c#","winforms","events"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":2384,"score":2,"question_id":2921483,"title":"WinForm Event \"On Select Tab\"?","body":"<p>I'm building a WinForm application in C# and would like to know how to trigger code when a certain tab on a tab menu is selected.  Thanks!</p>\n"},{"tags":["c#","winforms","resize"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1435,"score":3,"question_id":3571041,"title":"What's preventing me from resizing (downsizing) my windows form object?","body":"<p>I've got a windows form object that contains 3 objects, a treeview, a richtextbox, and a tabcontrol. They are not docked into the windows form, but they are anchored (top+left). </p>\n\n<p>I've written the code to resize them when a form-resize event handler gets called, but it only seems to be working for an increase of form size, that is to say, I can't resize the form to a smaller size.  This includes times when I first increase the main windows form and then attempt to return it to its original size.</p>\n\n<p>The sizes of the three objects are manually set after each Form resize with the code below:</p>\n\n<pre><code>        treeView1.Height += (this.Height - oldHeight);\n        richTextBox1.Width += (this.Width - oldWidth);\n        tabControl1.Width += (this.Width - oldWidth);\n        tabControl1.Height += (this.Height - oldHeight);\n        oldHeight = this.Height;\n        oldWidth = this.Width;\n</code></pre>\n\n<p>None of the objects have a set minimum size (they are all at 0,0 throughout the resizing process)</p>\n\n<p>What is preventing the form from being resized to a smaller size?</p>\n"},{"tags":["c#","winforms","richtextbox"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":296,"score":0,"question_id":5532765,"title":"Why the Weird Spacing in RichTextBox","body":"<p>I am receiving input via a serial port and displaying the data in a RichTextBox. That works okay, except for the fact that, when I display the data, there is a lot of extra (non-consistently occurring) spacing. See the image below:</p>\n\n<p><img src=\"http://i.stack.imgur.com/MAUIH.png\" alt=\"enter image description here\"></p>\n\n<p>In this case, it is showing every two ticks, but sometimes it is three or sometimes none. I can't figure out why this is. Does anybody have any idea?</p>\n\n<p><strong>Edit</strong>: Here is how I am displaying the data (code-wise).</p>\n\n<pre><code>void port_DataReceived(object sender, SerialDataReceivedEventArgs e)\n{\n  string msg = port.ReadExisting();\n  DisplayWindow.AppendText(msg);\n  DisplayWindow.ScrollToCaret();\n}\n</code></pre>\n"},{"tags":["c#","winforms","sharpdx"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":454,"score":1,"question_id":9863665,"title":"SharpDX, DirectWrite and Windows Forms","body":"<p>Can one render text using DirectWrite to a PictureBox in a WinForm app?</p>\n\n<p>I'm using SharpDX and have gone through the DirectWrite samples trying to build the simplest working case I can.  </p>\n\n<p>I created a Form and added only a pictureBox to it.  Then the following code.  The form displays, but nothing visible with the PictureBox.</p>\n\n<p>Any guidance would be much appreciated.</p>\n\n<p>Thanks!</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\n//using System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Windows.Forms;\nusing SharpDX.Direct2D1;\nusing SharpDX.DXGI;\nusing SharpDX;\nusing SharpDX.DirectWrite;\n\nusing AlphaMode = SharpDX.Direct2D1.AlphaMode;\nusing Factory = SharpDX.Direct2D1.Factory;\n\nnamespace d2dwTextEdit\n{\npublic partial class Form1 : Form\n{\n    public Factory Factory2D { get; private set; }\n    public SharpDX.DirectWrite.Factory FactoryDWrite { get; private set; }\n    public WindowRenderTarget RenderTarget2D { get; private set; }\n    public SolidColorBrush SceneColorBrush { get; private set; }\n    public TextFormat TextFormat { get; private set; }\n    public SharpDX.RectangleF ClientRectangle { get; private set; }\n\n\n    public Form1()\n    {\n        InitializeComponent();\n        Initialize();\n        Render();\n    }\n\n    protected void Initialize()\n    {\n        Factory2D = new SharpDX.Direct2D1.Factory();\n        FactoryDWrite = new SharpDX.DirectWrite.Factory();\n\n        HwndRenderTargetProperties properties = new HwndRenderTargetProperties();\n        properties.Hwnd = pictureBox1.Handle;\n        properties.PixelSize = new System.Drawing.Size(pictureBox1.Width, pictureBox1.Height);\n        properties.PresentOptions = PresentOptions.None;\n\n        TextFormat = new TextFormat(FactoryDWrite, \"Calibri\", 30) { TextAlignment = TextAlignment.Center, ParagraphAlignment = ParagraphAlignment.Center };\n\n        RenderTarget2D = new WindowRenderTarget(Factory2D, new RenderTargetProperties(new PixelFormat(Format.Unknown, AlphaMode.Premultiplied)), properties);\n        RenderTarget2D.AntialiasMode = AntialiasMode.PerPrimitive;\n        RenderTarget2D.TextAntialiasMode = TextAntialiasMode.Cleartype;\n\n        ClientRectangle = new RectangleF(0, 0, pictureBox1.Width, pictureBox1.Height);\n\n        SceneColorBrush = new SolidColorBrush(RenderTarget2D, Colors.White);\n        SceneColorBrush.Color = Colors.Black;               \n\n\n    }\n\n    private void Render()\n    {\n        RenderTarget2D.Clear(Colors.White);\n        RenderTarget2D.DrawText(\"Hello Marshall\", TextFormat, ClientRectangle, SceneColorBrush);\n    }\n\n}\n}\n</code></pre>\n"},{"tags":["c#","winforms","treeview"],"answer_count":6,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":5462,"score":5,"question_id":1838807,"title":"WinForms TreeView - how to manually \"highlight\" node (like it was clicked)","body":"<p>I would need to know how to let the programatically selected node make graphically in the state \"selected\" like the user clicked on it. SelectedNode only makes this one internally selected. Thank you very much!</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":111,"score":3,"question_id":12982105,"title":"What is the meaning of Form.Show(null)?","body":"<p>I have a Form that needs to sit on top of two other forms.  It should also minimize with one of the two forms it sits above.  I found that this works as described when I do</p>\n\n<p><code>form.Show(null);</code></p>\n\n<p>However, <code>form.Show()</code> does not work as described.  Why?  I realize I am passing an owner as the parameter, but the owner is null.  So why does the form behave correctly?</p>\n"},{"tags":["c#","winforms","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2547,"score":0,"question_id":3781389,"title":"Import Excel to datatable","body":"<p>I am using syncfusion to import excel to datattable.when the datat is imported to datatable the columns are all strings .how to convert these columns to specific datatype?how do i validate the column data type?</p>\n\n<pre><code>using Syncfusion.XlsIO;\n\nprivate void btnImport_Click(object sender, EventArgs e)\n        {\n            ImportExcelFile();\n        }\n private void ImportExcelFile()\n        {\n            try\n            {\n                string strFileName = \"\";\n                OpenFileDialog openFileDialog = new OpenFileDialog();\n\n                openFileDialog.Filter = \"Files (*.xls)|*.xls|(*.xlsm)|*.xlsm\";\n                openFileDialog.DefaultExt = \".xls\";\n                if (openFileDialog.ShowDialog() == DialogResult.OK)\n                {\n                    strFileName = openFileDialog.FileName;\n                    #region Get Correct Worksheet in excel file\n                    DateTime dtStart = DateTime.Now;\n                    ExcelEngine excelEngine = new ExcelEngine();\n                    IApplication application = excelEngine.Excel;\n                    IWorkbook workbook = application.Workbooks.Open(strFileName);\n                    IWorksheet sheet = workbook.Worksheets[0];\n                    #endregion                \n\n\n                    DataTable dt = sheet.ExportDataTable(sheet.UsedRange, ExcelExportDataTableOptions.ColumnNames);\n\n                  dgIDCImport.GridDataSource(dt,ucGrid.GridTypes.IDCImport);\n\n                    //Close the workbook.\n                    workbook.Close();\n\n                    //No exception will be thrown if there are unsaved workbooks.\n                    excelEngine.ThrowNotSavedOnDestroy = false;\n                    excelEngine.Dispose();\n\n\n\n                }\n            }\n\n            catch (Exception err)\n            {\n                base.DisplayError(err);\n            }\n        }\n</code></pre>\n"},{"tags":[".net","winforms","dpi","highdpi"],"answer_count":1,"favorite_count":3,"up_vote_count":19,"down_vote_count":0,"view_count":4410,"score":19,"question_id":196606,"title":"Supporting DPI and Default Font Changes","body":"<p>So I'm trying to figure out how the Form's AutoScaleMode property can possibly help to support a system with a font or <a href=\"http://en.wikipedia.org/wiki/Dots_per_inch\">DPI</a> that is different from my work development machine.</p>\n\n<p>From the SDK:</p>\n\n<blockquote>\n  <p>AutoScaleMode Enumeration</p>\n  \n  <p>public enum AutoScaleMode</p>\n\n<pre>None  \n   Automatic scaling is disabled.    \nFont   \n   Controls scale relative to the dimensions of the \n   font the classes are using, which is typically the \n   system font.\nDpi    \n   Controls scale relative to the display resolution. \n   Common resolutions are 96 and 120 DPI.\n</pre>\n</blockquote>\n\n<p>By default .NET 2.0 Forms use AutoScaleMode.Font.</p>\n\n<p>So I designed a sample form on my Windows XP, Tahoma 8 pt, 96 DPI development machine. Then I tried it out on a </p>\n\n<ul>\n<li>14 pt Segoe UI 96 DPI machine</li>\n<li>14 pt Segoe UI 150 DPI machine</li>\n</ul>\n\n<p>The results were not encouraging, as you can see in this screenshot:</p>\n\n<p><img src=\"http://uiguidelines.files.wordpress.com/2008/10/comparison-of-form-autoscalemodes-matrix.png\" width=\"620\" height=\"670\"></p>\n\n<p>The AutoScaleMode property was not designed to enable a .NET Form for support of different font or DPI settings. So what <strong>is</strong> the proper way to support different font and DPI settings?</p>\n"},{"tags":[".net","winforms","dpi","highdpi"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":3101,"score":3,"question_id":203577,"title":"Graphics.MeasureString returns different values than Win32 GetTextExtent","body":"<p>i've been trying to find a method in C# to measure the size of a string. The <a href=\"http://support.microsoft.com/kb/145994\" rel=\"nofollow\">standard method</a> to measure a string in Win32 is to use GetTextExtent. The real goal is to find the <em>average</em> width and height of a font character. The standard method to find the average width of a character starts from getting the width of all alphabetic characters and divide by 52:</p>\n\n<pre><code>size = dc.GetTextExtent(\n       \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\", 52);\naverageWidth = size / 52;\n</code></pre>\n\n<p>Microsoft has a page that lists the <a href=\"http://msdn.microsoft.com/en-us/library/bb847924.aspx\" rel=\"nofollow\">average character widths</a> for some font sizes at certain DPI settings, and i've confirmed them by my own calls to GetTextExtent.</p>\n\n<ul>\n<li><strong>Tahoma 8pt, 96dpi:</strong> 13x6 px</li>\n<li><strong>Tahoma 9pt, 96dpi:</strong> 14x7 px</li>\n<li><strong>Segoe UI 9pt, 96dpi</strong>: 15x7 px</li>\n</ul>\n\n<p>Now i want to perform the same calculations under .NET WinForms. Using Graphics.MeasureString() i come up with code:</p>\n\n<pre><code>public static SizeF GetAvgCharSizeF(Graphics g, Font font)\n{\n   String s = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\";\n\n   SizeF textSize = g.MeasureString(s, font);\n\n   float baseUnitX = (textSize.Width / s.Length);\n   float baseUnitY = textSize.Height;\n\n   return new SizeF(baseUnitX, baseUnitY);\n}\n</code></pre>\n\n<p>Unfortunatly the values do not match the known, accepted, true values:</p>\n\n<ul>\n<li><strong>Tahoma 8pt, 96dpi:</strong> 14x6 px <em>(14.21x6.09 px)</em></li>\n<li><strong>Tahoma 9pt, 96dpi:</strong> 16x7 px <em>(15.98x6.85 px)</em></li>\n<li><strong>Segoe UI 9pt, 96dpi:</strong> 17x7 px <em>(17.46x6.91 px)</em></li>\n</ul>\n\n<p>The average character widths turn out OK, but the character heights are too large by about 13%. i assume that the extra height is due to a difference in the classification of height having been changed to include ascenders and descenders. If the measuring string was measuring too tall, i tried changing it from:</p>\n\n<pre><code>String s = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\";\n</code></pre>\n\n<p>to</p>\n\n<pre><code>String s = \"acemnorsuvwxyz\";\n</code></pre>\n\n<p>thinking that now the string is not as tall, and so the measured Height should be shorter. Nope, it returns the <em>exact</em> same heights as the version of the string that included ascenders and descenders (although the average widths are slightly larger).</p>\n\n<p>What can be the cause of this, and can get the average character height what can be done to the average text height so that it matches the accepted values returned by GetTextExtent?</p>\n\n<p>Note: Even though the standard practice to get the average character height is to use GetTextMetrics, the height returned by GetTextExtents returns the same value.</p>\n"},{"tags":["c#","winforms"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":70,"score":-2,"question_id":12983049,"title":"Item does not contain a constructor that takes 0 arguments","body":"<p>The new Form1() part of this code (this code is in my Main.cs) keeps giving me this error - HomeInventory2.Form1 does not contain a constructor that takes 0 arguments.</p>\n\n<pre><code>private void cDsToolStripMenuItem_Click(object sender, EventArgs e)\n{\n    var form = new Form1();\n    // show the form\n    form.Show();\n}\n</code></pre>\n\n<p>The Form1 code is as follows</p>\n\n<pre><code>namespace HomeInventory2\n{\n    public partial class Form1 : Form\n    {\n\n        public Form1(IEnumerable&lt;string&gt; prepopulated)\n        {\n            InitializeComponent();\n            IEnumerable&lt;String&gt; lines = prepopulated;\n            textBoxAmount.Text = lines.ElementAtOrDefault(0);\n            textBoxCategories.Text = lines.ElementAtOrDefault(1);\n            textBoxProperties.Text = lines.ElementAtOrDefault(2);\n            textBoxValue.Text = lines.ElementAtOrDefault(3);\n        }\n\n        private void label1_Click(object sender, EventArgs e)\n        {\n\n        }\n\n        private void submitButton_Click(object sender, EventArgs e)\n        {\n            CreateInventory create = new CreateInventory();\n            create.ItemAmount = textBoxAmount.Text;\n            create.ItemCategory = textBoxCategories.Text;\n            create.ItemProperties = textBoxValue.Text;\n            create.ItemValue = textBoxValue.Text;\n\n            InventoryMngr invtryMngr = new InventoryMngr();\n            invtryMngr.Create(create);\n\n        }\n    }\n}\n</code></pre>\n\n<p>I tried just putting a blank constructor in there - but then of course when that button or menu item is called it just brings up a blank screen.  </p>\n"},{"tags":["c#",".net","winforms","flash","externalinterface"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":933,"score":3,"question_id":2143292,"title":"C# Flash - ExternalInterface","body":"<p>We are hosting the ActiveX control in a WinForms application to embed flash.</p>\n\n<p>Is there a good way to get the list of visible ExternalInterface functions that are available for any given swf file?</p>\n\n<p>We are working with a 3rd party swf file, and do not have access to source.</p>\n\n<p>If it's not possible from C# (or code), is there a tool out there that can do it?</p>\n\n<p>ANSWER:  The only way I've found is to use a flash decompiler and then look for the line:</p>\n\n<pre><code>ExternalInterface.addCallback(\"methodName\", methodName);\n</code></pre>\n\n<p>I'm marking the top answer as the answer for the help.</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":953,"score":1,"question_id":7448975,"title":"Flow Layout Panel issues","body":"<p>I'm trying to make a list of controls. For this, I used a flow layout panel and a custom item. After reading a XML file I populate the flow layout panel with my items. For a small number of items everything seams to be OK but for a number like 371 of items in the flow layout panel something get's wrong. At the bottom of the flow layout panel 95 items are missing, and seams to be overlapped. The space located for this items, i think, is still created. I attach a screen with the effect produced. The controls are created in an array and then I iterate that array to add the controls to the flow layout panel.</p>\n\n<p><a href=\"http://img510.imageshack.us/img510/3201/screen2011916213527199.jpg\" rel=\"nofollow\">http://img510.imageshack.us/img510/3201/screen2011916213527199.jpg</a></p>\n\n<p>Thank you.</p>\n\n<p>LE:</p>\n\n<pre><code>public delegate void AddHistoryItemDelegate(Control itm);\n        public void AddHistoryItem(Control itm)\n        {\n            if (InvokeRequired)\n            {\n                Invoke(new AddHistoryItemDelegate(AddHistoryItem), new object[] { itm });\n            }\n            else\n            {\n                flowLayoutPanel1.Controls.Add(itm);\n            }\n        }\nforeach (Control c in histroryItems)\n            {\n                controls++;\n                backgroundWorkerLoadHistory.ReportProgress(controls);\n                //flowLayoutPanel1.Controls.Add(c);\n                AddHistoryItem(c);\n            }\n</code></pre>\n\n<p>The delegate is there because all this is taking place in a separate thread. histroryItems is a List of controls.</p>\n\n<p>LE: If it's counts, i observed that, if I remove an item from the list, after the list loads, it get's arranged. Trying a little hack to see if adding and removing a control at the end of the thread, does not have any effect.</p>\n"},{"tags":["c#",".net","winforms","cursor"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2785,"score":2,"question_id":2797084,"title":"Using Custom Cursor WinForms","body":"<p>Is there a way to use a custom cursor in winforms?</p>\n\n<p>There seems to be no option. But when I try to manually add a cursor as a resource, then call it from code, it says that it cannot convert from type byte[] to Cursor.</p>\n"},{"tags":[".net","wpf","vb.net","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":12981497,"title":"Finding and Closing All Child Windows of a WPF Window","body":"<p>Ok so I have a WPF application that has a WinForms project in it.  My main project is the WPF one.  My question is how do I find all of the widows that are children of my Main Window that is WPF?? These Windows can be either WinForm or WPF so i need a way to determine of which type the child is to successfully close said form and all of its potential children.  </p>\n\n<p>Thank you in advance for the assistance </p>\n"},{"tags":["c#",".net","datetimepicker","winforms"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2179,"score":2,"question_id":1615294,"title":"DateTimePicker displays today's date instead of displaying its actual Value","body":"<p>We have a couple of DateTimePickers on a custom UserControl, on a Form. They are visible, but not enabled (for display purposes only). When the UserControl is loading, the DateTimePickers are assigned values from a DataRow that came from a DataSet which stores a single record returned from a SQL Server stored procedure.</p>\n\n<p>There is an inconsistent behavior in which the users sometimes see today's date instead of the date that was assigned to the DateTimePicker. It doesn't seem to matter whether I assign the date I want to the .Value property or the .Text property:</p>\n\n<pre><code>txtstart.Value = (DateTime) dr[\"Group_Start_Date\"];\ntxtend.Text = dr[\"Term_Date\"].ToString();\n</code></pre>\n\n<p>I expect that of the two statements above, the one using the Value property is more appropriate. But, in both cases, today's date is displayed to the user regardless of the values that were in the database. In the case of txtstart.Value, Visual Studio shows me that the value was assigned as expected. So why isn't it displaying that date to the user instead of today's date?</p>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":411,"score":0,"question_id":3552169,"title":"Sharing a variable between two winforms","body":"<p>I have a winforms application.</p>\n\n<p>I have a textbox on one form (call F1) and when a button is clicked on this form (call F2), it launches another form.</p>\n\n<p>On F2, I want to set a string via a textbox (and save it to a variable in the class), and then when I close this form, the string will appear in a label in F1.</p>\n\n<p>So I am basically sharing variables between both forms. However, I can't get this to work correctly. How would this code look?</p>\n"},{"tags":["vb.net","winforms","pdf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":81,"score":-1,"question_id":1324639,"title":"How do I get microsoftreportviewer on my Windows Forms form?","body":"<p>I am trying to put a PSD file on my form using Microsoft report viewer, but I cannot find it. Where is it?</p>\n"},{"tags":["c#","winforms"],"answer_count":6,"favorite_count":0,"up_vote_count":9,"down_vote_count":2,"view_count":1686,"score":7,"question_id":3971101,"title":"C# - What's the best way to end a program?","body":"<p>In VB.NET, it is <a href=\"http://msdn.microsoft.com/en-us/library/0wt87xba.aspx\" rel=\"nofollow\">End</a>.</p>\n\n<p>What is the best way to end a program in C#?</p>\n"},{"tags":["c#","winforms","toolstripdropdown","mousecapture"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12950476,"title":"Capture mouse messages when a ToolStripDropDown is shown","body":"<p>I am trying to create a \"tooltip\" which contains a custom control. I implemented it using <code>ToolStripDropDown</code> which does what I need - closes when the user clicks somewhere else, or activates another window etc.</p>\n\n<p>However, I'd like to be able to get the <code>MouseMove</code> event in the parent control even when the <code>ToolStripDropDown</code> is shown. I tried to set the <code>Capture</code> property of the parent control at various stages (before showing the dropdown, in its <code>Opened</code> event handler etc.) but it is always immediately set back to false. Is there a way (not necessarily employing the <code>Capture</code> property) to get the <code>MouseMove</code> event in the parent control? And no, I don't want to consider ugly hacks like using a timer and periodically checking the mouse position.</p>\n"},{"tags":["c#","winforms","datagridview","event-handling"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":95,"score":0,"question_id":12980658,"title":"C# DataGridView Cells automatically clearing when selected","body":"<p>I have a windows forms application with a DataGridView (DGV) on part of it.  I used the Visual Studio UI to add columns to the DGV and then programmatically added rows with some default values.  My problem is once the rows are added, any cell selected automatically empties whatever value was in it - even read-only cells!</p>\n\n<p>I am only handling the \"CellValueChanged\" event for the DGV, and all that does is validate the rows to make sure at least one valid combination of values exists and then enables a button.</p>\n\n<p>To add to the confusion, the selected-cell-clearing issue does not always happen. After rows are added, until you make a change or perform an action that reloads the DGV with rows, all the cells will clear.  After that either some or none of the cells will clear on their own.</p>\n\n<p>Has anyone experienced this or know of a way to solve the problem?  All I got from google was \"how to make cells clear\" and things like that.</p>\n\n<p>Thanks,</p>\n\n<ul>\n<li>Matt</li>\n</ul>\n\n<p><strong>* UPDATE *</strong></p>\n\n<p>Code for adding new rows to the DGV:</p>\n\n<pre><code>        metaMapGrd.Rows.Clear();\n        ((DataGridViewComboBoxColumn)metaMapGrd.Columns[1]).DataSource = _excel.ListHeaders(worksheetListCmb.SelectedItem.ToString());\n        foreach (Field f in _sharePoint.CurrentFieldList)\n        {\n            // skip the key field matching portion.  These should be for comparison only.\n            if (f.Title == spListKeyCmb.SelectedItem.ToString())\n            {\n                continue;\n            }\n\n            DataGridViewRow row = new DataGridViewRow();\n\n            metaMapGrd.Rows.Add(row);\n\n            DataGridViewTextBoxCell spcell = new DataGridViewTextBoxCell();\n            spcell.Value = f.Title;\n            spcell.ToolTipText = f.TypeAsString;\n            row.Cells[\"spListColumn\"] = spcell;\n\n            DataGridViewCheckBoxCell fcell = new DataGridViewCheckBoxCell();\n            fcell.Value = true;\n            row.Cells[\"useThisColumn\"] = fcell;\n        }\n        metaMapGrd.CurrentCell = null;\n</code></pre>\n"},{"tags":["c#",".net","winforms","closing"],"answer_count":5,"favorite_count":2,"up_vote_count":15,"down_vote_count":0,"view_count":15504,"score":15,"question_id":2683679,"title":"How to know user has clicked \"X\" or the \"Close\" button?","body":"<p>In MSDN I found <code>CloseReason.UserClosing</code> to know that the user had decided to close the form\nbut I guess it is the same for both clicking the X button or clicking the close button.\nSo how can I differentiate between these two in my code?</p>\n\n<p>Thanks all.</p>\n"},{"tags":["c#","winforms","visual-studio-2010","usercontrols","windows-forms-designer"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":12979922,"title":".NET winforms Sub Classed UserControl width keeps increasing","body":"<p>I have created a custom UserControl and then another control that is a subclass of this Usercontrol, but still has its own designer file behind it (the base control is just used for some base functionality... I don't need to 'design' anything on it and actually its height is set to 0).</p>\n\n<p>Everything works as intended at run time, but at design time, it seems like whenever I open the child control in Design mode to work on it, Visual Studio keeps increasing the width on me, by perhaps a couple hundred pixels at a time (or possibly some factor).  Before I know it, the thing is 10,000 plus pixels wide and then I have to reset the width in the designer just so it is manageable.  This isn't an issue at run time, because the controls width gets set by a parent container it is put in, and the control is anchored to the parent.  Its just a pain while designing the controls.  Here's just little snippets to better explain what I've done:</p>\n\n<pre><code>public partial class BaseRow : UserControl\n{\n    public BaseRow()\n    {\n        InitializeComponent();\n\n        ...\n    }\n}\n</code></pre>\n\n<p>Then I want to actually create controls that inherit from this BaseRow, but that I can edit in the designer.  So, I go to Add -> UserControl.  Then in the class code I change the default created code to inherit from my BaseRow (which inherits from UserControl) so it looks like this:</p>\n\n<pre><code>// changed the inheritance below from UserControl to BaseRow (which inherits from UserControl)\npublic partial class UnitRow : BaseRow\n{\n    public UnitRow()\n    {\n        InitializeComponent();\n    }\n}\n</code></pre>\n\n<p>I originally set the width of the objects to 400 in both the base class and the child class in the designer.  The base Row sets its Anchor property in its constructor:</p>\n\n<p><code>this.Anchor = AnchorStyles.Top | AnchorStyles.Left | AnchorStyles.Right;</code></p>\n\n<p>because these controls will all go in a subclassed panel control that will control the width of rows that are added to it.</p>\n\n<p>Everything works fine at run time.  The actual width of these 'Row' controls I have created is set correctly and changes appropriately based on its parent subclassed panel control.  But when I open the row controls in design mode at design time, the width is constantly getting longer and longer.  Everytime the width equal 10,000 or more I manually change it back in the Properties window to a width of 400.</p>\n\n<p>Its not causing any major issue.  But it is a real pain.  Anyone have any suggestions?</p>\n"},{"tags":["c#",".net","winforms","combobox","selectedindexchanged"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12979657,"title":"ComboBox got new SelectedValue on SelectionChangeCommitted but doesn't got new SelectedText","body":"<p>I have this code</p>\n\n<pre><code>private void FrmNovedadMedidas_SelectionChangeCommitted(object sender, EventArgs e)\n        {\n            ComboBox c = (ComboBox)sender;\n            CargarMedidasPorIdTipoMedida(Convert.ToInt16(c.SelectedValue));\n            this.txtBoxNombreTipoMedida.Text = c.SelectedText;\n        }\n</code></pre>\n\n<p>in <code>c.SelectedValue</code> got the new value of the selection (the one that the user has selected in the Combo).\nBut in <code>c.SelectedText</code> I got the old value of the ComboBox (I mean, the one that was before the user change the selection).</p>\n\n<p>Is there any property that can give me the new Selected Text?\nI want to avoid to search in the DataSet binded to the ComboBox everytime.</p>\n\n<p>I've read <a href=\"http://stackoverflow.com/questions/8090847/get-the-new-value-or-index-with-selectionchangecommitted-event-of-datagridview-c\">this</a> but doesn't work, I don't have <code>CommitEdit()</code> in ComboBox</p>\n\n<p>edit:</p>\n\n<p><code>c.Text</code> also gives me the old one</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12979872,"title":"How to Display Datatable Contents into a datagridview?","body":"<p>I have a simple DataTable, How can i display everything inside it into gridview?</p>\n\n<pre><code>public void BindData(DataTable tbl)\n{\n    this.dataGridView1.DataSource = (...)?\n}\n</code></pre>\n\n<p>Help appreciated </p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12963779,"title":"Menu Strip usercontrol that adds items to form at design time","body":"<p>My goal is to emulate the Smart tag already on the menustrip in visual studio that inserts the common menu items.</p>\n\n<p>I'd like to have the user be able to select the item they want from a drop down (I have that already using a UITypeEditor) and then have the items created just like they normally would be at design time (part of the form's components with their creation code in the .Designer.cs file).</p>\n\n<p>The best I have been able to do is to have the menustrip control create the items and add them to it's Items collection. The problem is that the items can't be manipulated further at design time. The menu containing them is actually 'locked'. For the user to add more buttons they would have to do it dynamically at run time.</p>\n\n<p>Is my goal possible and if so could some one point me in the right direction?</p>\n"},{"tags":["winforms","c#-4.0","ado.net","telerik-grid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12979942,"title":"updating row Values of RAdGridView","body":"<p>let say i have table Employee and i have a typed dataset that contains datatable dt,and i have fill this datatable using data adapter with all employees in table emplyee and i have RadGridView and it's source is datatable filled with employee ,i have a coloumn named salary where user can edit it through RadGridView ,i want to know how can change the rowColor where salary Changed to green if the NewValue is Greater that the Original one or to red if the NewValue is less than the Original on and i want to know what event of RadGridView where i can get the value of tha NewValue and the Original one so i can save both Values in Database After User Submits Changes.</p>\n\n<p>your prompt response is highly appreciated</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12978894,"title":"Change Windows 7 app taskbar icon color","body":"<p>I have a Windows Forms application and I want to add a cool little visual to its thumbnail on the Windows Taskbar.</p>\n\n<p>I know that you can have the thumbnail display a Progress Marquee-style thing, but how do we just change the color of it?</p>\n\n<p><img src=\"http://i.stack.imgur.com/PEvEA.png\" alt=\"\"></p>\n\n<p>I'm not talking about changing the color of the icon, but the color that's behind the icon. Is this even possible?</p>\n\n<p>Any code, documentation or anything to get me on the right track will be much appreciated.</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12979099,"title":"WNDPROC documentation","body":"<p>I was reading some tutorials and I met the following structure:</p>\n\n<pre><code>protected override void WndProc( ref Message m )\n{\n    ...\n\n    base.WndProc( ref m );\n}\n</code></pre>\n\n<p>and for example:</p>\n\n<pre><code>private const int WM_DWMCOMPOSITIONCHANGED = 0x31e;\n</code></pre>\n\n<p>what s the meaning of <code>0x31e</code>. some documentation for it?</p>\n"},{"tags":["c#","winforms","data-binding","combobox","datarepeater"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":518,"score":1,"question_id":10585944,"title":"ComboBox On DataRepeater Control Shares Selected Index","body":"<p>I have a data repeater with each row using a combobox.  When you click the Add button it adds a new row to the DataRepeater.</p>\n\n<pre><code>   public enum ColorTypes {Red, Green, Yellow}\n   class LineItem\n   {\n       public ColorTypes Color {get;set;} \n   }\n</code></pre>\n\n<p>When you click a button on the form it then creates a new LineItem, and rebinds.</p>\n\n<pre><code>  private void btnAdd_Click(object sender, EventArgs e)\n  {\n       LineItem CopyItem = new LineItem();\n       CurrentList= ((List&lt;LineItem&gt;)dataRepeater.DataSource); \n\n       CurrentList.Add(CopyItem);\n       dataRepeater.DataSource = CurrentList;\n  }\n</code></pre>\n\n<p>This correctly adds a new row to the DataRepeater, but now changing combobox's index modifies both rows.  Is there some special binding you need to perform?</p>\n\n<p>Heres my binding code:</p>\n\n<pre><code> this.cbPackage.DataSource = System.Enum.GetValues(typeof(ColorTypes));\n this.cbPackage.DisplayMember = \"Color\";\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12977679,"title":"Winform Tooltip issue","body":"<p>in my application i want to add Tool-tips.\nafter configure the tool tip i want the option to distinguished between the label who activate the Tool tip in order to show the appropriate text so in the Tool tip function i am try to do it but got an error: <strong>\"The type 'Accessibility.IAccessible' is defined in an assembly that is not referenced. You must add a reference to assembly 'Accessibility, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\"</strong></p>\n\n<pre><code>private void toolTip1_Popup(object sender, PopupEventArgs e)\n{\n    string st = e.AssociatedControl.AccessibilityObject.Parent.Name;\n}\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12752328,"title":"TableLayoutPanel Height Property not working","body":"<pre><code>        TableLayoutPanel t = new TableLayoutPanel();  \n        t.RowStyles.Add(new RowStyle(SizeType.AutoSize));\n        t.ColumnStyles.Add(new ColumnStyle(SizeType.Percent, 100));\n        t.CellBorderStyle = TableLayoutPanelCellBorderStyle.Single;\n        Label lbl = new Label();\n        lbl.Margin = new System.Windows.Forms.Padding(20, 150, 20, 20);\n        lbl.Text = \"Hello\";\n        t.Controls.Add(lbl, 0, 0);\n        this.Text = t.Size.Height.ToString();\n        this.Controls.Add(t);\n</code></pre>\n\n<p>Why the t.Size.Height property gives me 100 always ?</p>\n"},{"tags":["c#","winforms","multithreading"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":64,"score":2,"question_id":12977844,"title":"Is there a C# / Windows Forms equivalent to Android's runOnUiThread?","body":"<p>Is there a C# / Windows Forms equivalent to Android's <a href=\"http://developer.android.com/reference/android/app/Activity.html#runOnUiThread%28java.lang.Runnable%29\" rel=\"nofollow\">runOnUiThread</a>?</p>\n\n<p>For example, say I am running a (long-running) task on a worker thread and at the end I want to post the result to a GUI control (which of course I can't do from the worker thread). Is there a function as simple as <a href=\"http://developer.android.com/reference/android/app/Activity.html#runOnUiThread%28java.lang.Runnable%29\" rel=\"nofollow\">runOnUiThread</a> that would allow me to post that refresh-display for processing by the UI thread?</p>\n"},{"tags":["c#","winforms","multithreading"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12965213,"title":"What is the correct way to close a second Application loop?","body":"<pre><code>    public static void Main()\n    {\n        Form formOnThisMessageLoop = new Form();\n        formOnThisMessageLoop.Show();\n\n        Form formOnOtherMessageLoop = new Form();\n\n        Task.Factory.StartNew(\n            () =&gt;\n            {                                        \n                Application.Run(formOnOtherMessageLoop);                    \n            }\n         );\n        //Thread.Sleep(50);\n        formOnOtherMessageLoop.HandleCreated += (obj, args) =&gt;\n        formOnOtherMessageLoop.Invoke(new Action(() =&gt; { formOnOtherMessageLoop.Close(); })); //Value Close() cannot be called while doing CreateHandle().\n        Application.Run();                         \n\n        Console.Read();\n    }\n</code></pre>\n\n<p>I'm experimenting with various ways to close a form on a second message loop.  How can I synchronize my threads correctly in such a case?  Also, do I need to call <code>Application.Exit()</code> twice or is Form.Close() the best I can do?  I see Application.Run() keeping my dead thread alive.  That's my concern with it.  Assume the Main thread could live a long time.</p>\n"},{"tags":["c#","winforms","timer"],"answer_count":6,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":171,"score":3,"question_id":12977111,"title":"Why use Windows.Forms.Timer at all?","body":"<p>I read this excellent article <a href=\"http://msdn.microsoft.com/en-us/magazine/cc164015.aspx\" rel=\"nofollow\">Comparing the Timer Classes in the .NET Framework Class Library</a> and came to the conclusion that anything I could do with <code>Windows.Forms.Timer</code> I can do better with <code>Timers.Timer</code> - and then <a href=\"http://stackoverflow.com/a/4532859/1357272\">some</a>.</p>\n\n<p>So the obvious question that comes to mind is: Why is the <code>Windows.Forms</code> Timer offered at all?</p>\n\n<p>Legacy (backward compatibility) support?</p>\n\n<p>Other?</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":12976205,"title":"Best way to handle passing of Control.Checked state between forms","body":"<p>It's been a while since I've worked with Windows Forms applications. I have a Checkbox on the Main form and, based upon a certain condition, if the Second form needs to be opened to request additional data from the user, how should I pass (or get) back a message to the Main form from the Second form so I can tell whether or not it's okay to Check or Uncheck the Checkbox?</p>\n\n<p>From what I can remember, I could use something like Pass by <code>ref</code>. Or is there a better way to accomplish this?</p>\n"},{"tags":["c#","xml","winforms","templates"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":156,"score":0,"question_id":7800087,"title":"How to XML templates?","body":"<p>I'm developing an app where I need to export documents based on different templates, I'm using PDFsharp and migradoc to create PDF documents. My documents have static text and there are just some parts that are generated dynamically. I think XML would be a good idea to this, however I'm new in this topic. \nI want to achieve something like this (static text and variables):</p>\n\n<pre><code>&lt;xml&gt;\n&lt;name&gt; bla bla bla bla bla &lt;date&gt; bla bla bla blabla\n&lt;subject&gt; bla bla bla bla\n&lt;fullname&gt;\n&lt;/xml&gt;\n</code></pre>\n\n<p>What are your suggestions? Where should I start? Should I use XML? </p>\n"},{"tags":["c#","winforms","layout"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":12976392,"title":"How to load a new layout in C# when a button is pressed?","body":"<p>I want to load a new layout (just like we do in Android programming as layout1.loadLayout()) in C# when a button is pressed?</p>\n\n<p>How can this action take place when a method is called?</p>\n\n<p>If I am not clear in my question, I am looking to load a new set of controls and hiding the current controls temporarily on a window form when a button is clicked (while they should retain their current properties, so that if I go back they should be in the same way where I left them).</p>\n\n<p>How can I jump between different layouts while not completely deleting and creating them again and again?</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":61,"score":0,"question_id":12976062,"title":"Is there a risk with using Char(22) in code","body":"<p>C# WinForms: If this a software people will be using in non-English languages too then will be a wrting a piece of code like this or is it fine? is there a better .NET way of wrting it?</p>\n\n<pre><code>if (eventArgs.KeyChar == (char)22)\n</code></pre>\n\n<p><strong>EDIT BY RB</strong>: <code>char(22)</code> is <a href=\"http://en.wikipedia.org/wiki/Control-V\" rel=\"nofollow\">Synchronous Idle</a>, but is better known as \"Ctrl+V\" or \"Paste\". He's asking how to detect \"Paste\" in WinForms.</p>\n"},{"tags":["winforms","visual-studio-2010","visual-studio","code-signing"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":60,"score":4,"question_id":12957281,"title":"Getting rid of \"The publisher could not be verified\" for a SINGLE instance install - Possible?","body":"<p>I have a Windows Forms (C#, SQL Server) application that I developed up and running and all is well, except for when I try to run its <code>Release</code> .exe <strong>on my own development workstation</strong>, it issues the <em>\"The publisher could not be verified\"</em> warning.</p>\n\n<p>(When I run this application from Visual Studio in <code>Debug</code> mode, I don't get this warning)</p>\n\n<p>I know about <a href=\"http://stackoverflow.com/a/1427930/1731850\">code signing</a> but this application is going to be installed on a <strong>single machine</strong> only (directly by me, on the client's machine), so I am thinking perhaps there is a way to get rid of this warning without having to sign the EXE, similar to the exception Microsoft does when running from Visual Studio?</p>\n\n<p>Note: on a single install single machine only.</p>\n\n<p>Is this possible?</p>\n"},{"tags":["winforms","drag-and-drop","outlook","vsto","mailitem"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":12975007,"title":"Drag mailitem from \"Advanced Find\" window in Outlook and drop on Winforms?","body":"<p>Most code samples for dragging a <code>MailItem</code> from Outlook and dropping on a widows form involve a reference to Outlook's <code>ActiveExplorer</code> window ... </p>\n\n<p>Here's <a href=\"http://www.emoreau.com/Entries/Articles/2008/05/Dropping-a-Outlook-message-on-your-application.aspx\" rel=\"nofollow\">an example</a></p>\n\n<pre><code>Dim objMI As Microsoft.Office.Interop.Outlook.MailItem\n\nFor Each objMI In objOL.ActiveExplorer.Selection()\n    Dim strFile As String = _\n                IO.Path.Combine(\"c:\\temp\", _\n                                (objMI.Subject + \".msg\").Replace(\":\", \"\"))\n    lblFile.Text += strFile + Environment.NewLine\n    objMI.SaveAs(strFile)\nNext\n</code></pre>\n\n<p>... however this produces unexpected results if dragging from the <strong>Advanced Find</strong> popup window. </p>\n\n<p>What happens is your C# or VB code grabs <em>the selected email from the main Outlook window</em> not the one you've actually selected from the Advanced Find list of emails. Unless the user is alert he won't even notice he's got the wrong email.</p>\n\n<p>Is there any solution to this?</p>\n"},{"tags":["c#",".net","winforms","multithreading","task-parallel-library"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":82,"score":1,"question_id":12975036,"title":"Executing Tasks at regular intervals using while(true)","body":"<p>I need to constantly poll a data store for possible updates.  I am achieving this using the following code.  This is a windows forms application by the way.</p>\n\n<pre><code>var uiContext = TaskScheduler.FromCurrentSynchronizationContext();\n\nvar updateTask = Task.Factory.StartNew(() =&gt;\n{\n    while (true)\n    {\n        Thread.Sleep(5000);\n\n        Task.Factory.StartNew(() =&gt;\n        {\n            someData = dataStore.GetData();\n        }).ContinueWith(t =&gt;\n        {\n            someGrid.DataSource = someData;\n        }, uiContext);\n    }\n});\n</code></pre>\n\n<p><code>someData</code> is a private class field and <code>someGrid</code> is a datagrid control.</p>\n\n<p>This seems to work perfectly, but I was wondering if there is a better way of achieving it.  Also, should my outer Task be LongRunning?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Ok, at the suggestion of Jon and Henk, I am using a Timer instead:</p>\n\n<pre><code>uiContext = TaskScheduler.FromCurrentSynchronizationContext();\n\nupdateTimer = new System.Timers.Timer(5000);\nupdateTimer.Elapsed += updateTimer_Elapsed;\nupdateTimer.Enabled = true;\n</code></pre>\n\n<p>The elapsed event:</p>\n\n<pre><code>void updateTimer_Elapsed(object sender, ElapsedEventArgs e)\n{\n    someData = dataStore.GetData();\n\n    Task.Factory.StartNew(() =&gt;\n    {\n        someGrid.DataSource = someData;\n    }, uiContext);\n}\n</code></pre>\n"},{"tags":["winforms","c#-4.0","devexpress"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12957484,"title":"DevExpress MemoEdit layout issue","body":"<p>I want to show some text inside the MemoEdit in two columns. The parse of the text works correctly because when I see the parsed text inside Notepad or when I debug it inside Visual Studio it shows it in two columns, so the text is formatted exactly in the way I need it. The problem is that when it is shown inside the MemoEdit, it doesn't keep the format (I think this is because it uses a different font for the text, not a fixed size width font, because white spaces are smaller then normal characters). I changed the font to some fixed size width font and is showing it correctly, but the problem is that I need to have the same font like the application uses. Is there any property on MemoEdit that can help me achive the behavior I want without changing the font?</p>\n\n<p>Thanks a lot!</p>\n"},{"tags":["c#","xml","winforms","list","datagridview"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":116,"score":0,"question_id":12971054,"title":"Get items from list inside foreach","body":"<p>I got a class and i'm try to fill the datgaridview as generic list. I got a problem in <code>dapuConfigs.CoveredLanes</code>which is a list and i tried to access the list and fill it in the datagridview i coulmdn't succeed. May be both of approach is wrong here...!\nPlease help me??</p>\n\n<p>When i run, i'm getting a text appears in the grid cell: system colelction generic list.</p>\n\n<p>Added code : </p>\n\n<pre><code>  .ForEach(\n              Configs =&gt;\n                  {  \n                      { \n                          datagridview1.Rows.Add(\n                              new object[]\n                                  {\n                                      Configs.Id,\n                                      Configs.Description,\n                                      Configs.Covered.ElementAtOrDefault(0).Id == null ? \"\" : Configs.Covered.ElementAtOrDefault(0).Id.ToString(),\n                                      Configs.Covered.ElementAtOrDefault(1).Id == null ? \"\" : Configs.Covered.ElementAtOrDefault(1).Id.ToString(),\n                                      Configs.Covered.ElementAtOrDefault(2).Id == null ? \"\" : Configs.Covered.ElementAtOrDefault(2).Id.ToString(),\n                                      Configs.Covered.ElementAtOrDefault(3).Id == null ? \"\" : Configs.Covered.ElementAtOrDefault(3).Id.ToString(),\n</code></pre>\n\n<p>});\n                          }\n                      });</p>\n"},{"tags":["c#","winforms","image","jpeg","tcpclient"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12969659,"title":"How to read a jpeg image streamed from a server","body":"<p>I have a server that is constantly transmitting jpeg images like a time lapse video feed. I need to display these images in a C# WinForm TCP Client and am having issues with the streaming. </p>\n\n<p>I have read a number of posts here and on other sites with similar issues, none of which have been able to provide a solution to my problem. </p>\n\n<p>I have the following code that aims to retrieve the image from the server and display it using a PictureBox control: (there is header info in the image stream)</p>\n\n<pre><code>while (true)\n{\n    NetworkStream stream = m_client.GetStream(); //Get the data stream from the server\n\n    //Load Image\n    while (stream.DataAvailable)\n    {\n        byte[] buffer = new byte[m_client.ReceiveBufferSize];\n        stream.Read(buffer, 0, buffer.Length);\n        string tempString = System.Text.Encoding.ASCII.GetString(buffer);\n        //split header info and data into separate strings\n        string[] splitString = tempString.Split(new string[] { \"]\" }, 2, StringSplitOptions.None);\n        splitString[0] = splitString[0].Replace(@\"\\\", \"\");\n        //split header info into separate strings for use later\n        string[] imageInfo = splitString[0].Split('|');\n\n        int size = Convert.ToInt32(tempString.Length);\n        //int offset = splitString[0].Length;\n        buffer = new byte[size];\n        stream.Read(buffer, 0, buffer.Length);\n\n        //Convert Image Data To Image\n        MemoryStream imageStream = new MemoryStream(buffer, 0, buffer.Length);\n        imageStream.Position = 0;\n        Bitmap img = new Bitmap(imageStream);\n\n        //set the image display box properties\n        VideoBox.Width = img.Width;\n        VideoBox.Height = img.Height;\n        VideoBox.Image = img; //Show the image in the picturebox\n    }\n    stream.Flush();\n}\n</code></pre>\n\n<p>Currently this code runs as far as to <code>Bitmap img = new Bitmap(imageStream);</code> where it gives a parameter is not valid error.</p>\n\n<p>This is the first time I have ever done this so am a bit lost on what to try next, I have spent the last day trying different solutions, but this one seems to be the best so far (I think :s). </p>\n\n<p>I would appreciate if anyone can point out what I am doing wrong or missing.</p>\n"},{"tags":["c#","winforms","function","public"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12973650,"title":"Public function not working properly","body":"<p>I have the following two pieces of code, please take a look at it, I pointed where it is going wrong.\nI removed the functions where I call the second window, they do not make sense here.</p>\n\n<p>First, main form, this form calls the second form:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Windows.Forms;\nusing System.Runtime.InteropServices;\n\nnamespace STP_Design\n{\n    public partial class STP2Main : Form\n    {\n        public STP2Main()\n        {\n            InitializeComponent();\n            tabControl1.SelectedTab = tabPageDeviceManager;\n        }\n        private void pictureBox1_Click(object sender, EventArgs e)\n        {\n            MenuForm MDIMF = new MenuForm();\n            MDIMF.MdiParent = this;\n            MDIMF.StartPosition = FormStartPosition.Manual;\n            MDIMF.Location = new Point(3, 50);\n            MDIMF.Show();\n            tabControl1.Visible = false;\n        }\n\n        public void set()\n        {\n            tabControl1.Visible = true; // This statement executes, but does not result in anything I'd expect. The debugger tells me the visibility is false.\n            tabControl1.BringToFront();\n        }\n   }\n}\n</code></pre>\n\n<p>and second form, which I close and should update the first form:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Windows.Forms;\n\nnamespace STP_Design\n{\n    public partial class MenuForm : Form\n    {\n        public MenuForm()\n        {\n            InitializeComponent();\n\n            this.BringToFront();\n        }\n\n\n        private void button1_Click(object sender, EventArgs e)\n        {\n            STP2Main stp = new STP2Main();\n            stp.set();\n            this.Close();\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","winforms","resize","window"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":12972874,"title":"how to keep objects in place when window is resized in C#","body":"<p>How can I keep the objects of my window (buttons, labels, etc) in center when the window is resized?</p>\n\n<p>Currently, I have 3 buttons in a Windows Form. When I maximize the window, the buttons stay at the top left section of the window. I want them to be in the center as they were when the window was not maximized.</p>\n\n<p>Any help?</p>\n"},{"tags":["c#","winforms","linq","ilist"],"answer_count":4,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":988,"score":6,"question_id":3844463,"title":"How Do I Sort IList<Class>?","body":"<p>There's no <code>Sort()</code> function for <code>IList</code>. Can someoene help me with this?\nI want to sort my own IList.</p>\n\n<p>Suppose this is my IList:</p>\n\n<pre><code>public class MyObject() \n{\n public int number { get; set; }\n public string marker { get; set; }\n}\n</code></pre>\n\n<p>How do I sort myobj using the marker string?</p>\n\n<pre><code>public void SortObject()\n{\n IList&lt;MyObject&gt; myobj = new List&lt;MyObject&gt;();\n}\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":75,"score":-1,"question_id":12971888,"title":"NumericUpDown how to setvalue","body":"<p>Hi I have a numericupdown box and I am trying to load the value of it each time the form loads.</p>\n\n<p>I have tried the following with no joy </p>\n\n<pre><code>   string striko1value = clsData.GetStriko1GasReading();\n        decimal striko1 = decimal.Parse(striko1value);\n        Striko1Numeric.Value = Convert.ToDecimal(striko1);\n</code></pre>\n\n<p>I have also tried this</p>\n\n<pre><code>Striko1Numeric.Value = (striko1);\n</code></pre>\n\n<p>Anyone have any ideas about how I would do this or where I could read up on this.</p>\n"},{"tags":["c#","asp.net","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12970031,"title":"RichTextBox fails to format the Rtf content","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12957631/loading-richtextbox-content-from-xml\">Loading richtextbox content from xml</a>  </p>\n</blockquote>\n\n\n\n<p>I am trying to save and load the RichTextBox content from a XML file. I save the Rtf format content in my XML to include all the formatting with the data. When i try to reload the content from XML file, the RichTextBox doesn't format the content instead it displays all the Rtf formatting code in UI.</p>\n\n<p>Sample content which i try to save : Sample <strong>Text</strong></p>\n\n<p>Content displayed in RichTextBox control below:</p>\n\n<pre><code>{\\\\rtf1\\\\ansi\\\\ansicpg1252\\\\deff0\\\\deflang1033{\\\\fonttbl{\\\\f0\\\\fnil\\\\fcharset0 Microsoft Sans Serif;}}\\r\\n\\\\viewkind4\\\\uc1\\\\pard\\\\f0\\\\fs17 Sample \\\\b Text\\\\b0\\\\par\\r\\n}\\r\\n\n</code></pre>\n\n<p>Is there any solution for this? Or suggest me some alternatives to include RichContent. </p>\n\n<p>You can find more information regarding this problem from this <a href=\"http://stackoverflow.com/questions/12957631/loading-richtextbox-content-from-xml\">link</a></p>\n\n<p>Thanks In Advance,\nK</p>\n"},{"tags":["sql-server","winforms","database-connection","desktop-application","database-security"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":91,"score":3,"question_id":12108368,"title":"Why to close database connection in a desktop application","body":"<p>When user logs in. I Open connection 'conn' which is a public static member my dbclass which has all functions related to database. Then <strong>conn remains open until application is closed</strong></p>\n\n<p>It does not degrade the application performance measurably but <strong>enhances the database queries performance</strong> remarkably.</p>\n\n<p><strong>Is there any security issue</strong>? If the database is centralized and two or 3 PC's using it with independent applications, Then what security issue can be there due to opening connection on log in?</p>\n\n<p>Or any other problem to be faced in future? </p>\n\n<p><strong>Edit</strong> in reply to first comment</p>\n\n<p>I checked by timespan.totalmilliseconds. It takes bit lesser than twice time when involves open and executing query than just executing query when connection is already open</p>\n\n<p><strong>Edit ---  The Actual answer required</strong>.</p>\n\n<p>If some one with good reason tells me that no there is no security issue or with a good reason tells yes this one is the major security issue. That will be accepted answer after waiting others responses.</p>\n\n<p><strong>By Google search i did not find any article/answer which would be to the point to my question.</strong></p>\n"},{"tags":["c#","winforms","smtp","contact-form"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":5,"view_count":63,"score":-4,"question_id":12968383,"title":"Contact Form in C#","body":"<p>I am planning to develop a Contact Form in C# similar to the one in PHP. Here the user enters the relevant fields like Name, EMail-ID etc, and clicks on Send Button.</p>\n\n<p>When he does that, I should be getting an email from the Application. However, I donot want to enter my user credentials like password. Is it possible to send email without having to enter the user credentials. Is so, can you please point as to how to do it ?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","winforms"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":47,"score":0,"question_id":12969453,"title":"How to access a button using its name as a string in a for loop","body":"<p>I need to access a button in a for loop but it's Name has to be changed.</p>\n\n<p>Ex:</p>\n\n<ul>\n<li>There are a number of buttons whose Names are bt1,bt2,bt3,...bt25.</li>\n<li>I'm using a for loop in my code for certain purpose to disable or enable those buttons.</li>\n<li>Can I use a for loop to do this??</li>\n</ul>\n\n<p>Like:</p>\n\n<pre><code>for(int i =1;i&lt;25;i++)\n{\n    \"bt\"+\"i\".Enable = True;\n}\n</code></pre>\n\n<p>How cam I make the string as a control?</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":93,"score":0,"question_id":12876637,"title":"Writing to a textbox in a parent form","body":"<p>I have a form form1 and I added to it a new one r1. </p>\n\n<p>If i check a radio button in r1, i want to write a word in a textbox in form1. How can i do it?</p>\n\n<pre><code>namespace Restaurant_Menu\n{\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        r1 r1; r2 r2; r3 r3;\n\n        private void radioButton1_CheckedChanged(object sender, EventArgs e)\n        {\n            if (radioButton1.Checked) { r1 = new r1(); }\n        }\n\n        private void radioButton2_CheckedChanged_1(object sender, EventArgs e)\n        {\n            if (radioButton2.Checked) { r2 = new r2(); }\n        }\n\n        private void radioButton3_CheckedChanged(object sender, EventArgs e)\n        {\n            if (radioButton3.Checked) { r3 = new r3(); }\n        }\n\n\n        private void button1_MouseClick(object sender, MouseEventArgs e)\n        {\n            if (radioButton1.Checked) { r1.Show(); }\n            if (radioButton2.Checked) { r2.Show(); }\n            if (radioButton3.Checked) { r3.Show(); }\n        }\n\n        private void checkBox1_CheckedChanged(object sender, EventArgs e)\n        {\n            if (checkBox1.Checked) { textBox1.Text +=\"Ketchup,  \"; }\n        }\n\n        private void checkBox2_CheckedChanged(object sender, EventArgs e)\n        {\n            if (checkBox2.Checked) { textBox1.Text +=\"Salt,  \"; }\n        }\n\n\n        private void checkBox4_CheckedChanged(object sender, EventArgs e)\n        {\n            if (checkBox4.Checked) { textBox1.Text += \"Soft Drink,  \"; }\n        }\n\n        private void checkBox5_CheckedChanged(object sender, EventArgs e)\n        {\n            if (checkBox5.Checked) { textBox1.Text += \"Juice,  \"; }\n        }\n</code></pre>\n"},{"tags":["winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12968138,"title":"How to upload a file in window forms?","body":"<p>In window forms, how to upload a file, I did not found any file upload control. Can you give me any reference? I want to store the document with in my systems drive. Thank you.</p>\n"},{"tags":["c#","winforms"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":12968102,"title":"Single Instance of WinForm","body":"<p>I am developing a C# Winform application. I would like to have a single instance of all the forms.</p>\n\n<p>So, when the user clicks on the Contact button for instance twice, instead of having 2 contact forms, I would to bring the single instance contact form  to the front.</p>\n\n<p>Any idea how I can achieve this?</p>\n\n<p>Thanks</p>\n"},{"tags":["winforms","datagridview","tutorials"],"answer_count":3,"favorite_count":9,"up_vote_count":12,"down_vote_count":0,"view_count":15752,"score":12,"question_id":367559,"title":"Good DataGridView tutorial","body":"<p>I'm writing a windows C# application which I wish to use data grid views, but unable to find a good tutorial on to take complete control of the datagrid eg: add columns, add data etc.</p>\n"},{"tags":["c#","winforms","memory-management"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":12967598,"title":"Test Application behaviour when limited Memory","body":"<p>I am working on a winform application. I want to test my application behavior when there is lack of memory on system.</p>\n\n<p>My application processes large number of images and show in listview. I have implemented Virtual mode and other techniques to minimize memory. I can run my application fine in my system and dont fine any issue related to memory when observing through \"Task Manager\". However my client reported me \"out of memory\" issue, when running application (he tested on 1gb system).</p>\n\n<p>So I want to know whether there is tool or technique which I can use to test my application in limited memory (say, I want to my application behave same as it behave in system with 1gb memory)</p>\n\n<p>any help will be helpful.\nThanks in anticipation</p>\n"},{"tags":["c#","winforms","process","win32gui"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12966734,"title":"How To Show System.Diagnostics In Front Of WinForm Using Win32 API","body":"<p>On my main form I have a ListView that contains a list in LargeIcon View of the Processes that belong to our software suite.  Each LV (ListView) item contains both text and an image which is identical to the icon for our software product for the respective application (i.e. MarinaOffice, LaunchOffice, PureRental, etc...).  There is a timer that updates the list based on whether or not the process is found in Process.GetProcesses() method call.  When the user clicks on the ListView item for the running process, it should maximize and show the window for that process (i.e WinForms Application) in front of the current process.  The code below almost does what I want to accomplish but, in the case where the application that I want to show is already maximized but, behind the windows application that I have on monitor, it does not put the process that I am showing in front of my application.  In other words, as long as the application that I am showing using the WIN32 method below is minimized, it works.  But, it it is already maximized, it does not.</p>\n\n<pre><code>// Used to Show Other Process Windows\nprivate const int SW_SHOWMAXIMIZED = 3;\n[DllImport(\"user32.dll\")]\nstatic extern bool ShowWindow(IntPtr hWnd, int nCmdShow);    \n\n// Method that checks for running apps in our suite every 3000ms\nprivate void timerRunningApps_Tick(object sender, EventArgs e)\n{\n    CheckRunningapps();\n}\n\n// Stripped down version of method that looks for running process in our suite and \n// adds the process name and icon to a ListView on our main form\nprivate void CheckRunningapps()\n{\n    List&lt;Process&gt; AllProcesses = System.Diagnostics.Process.GetProcesses().ToList();\n\n    listViewRunningApps.BeginUpdate();\n    listViewRunningApps.Items.Clear();\n\n    foreach (Process process in AllProcesses)\n    {\n        ListViewItem lvi = new ListViewItem();\n        if (process.ProcessName.ToLower().Contains(\"marinaoffice\"))\n        {\n            lvi = new ListViewItem(\"MarinaOffice\");\n            lvi.SubItems.Add(\"MarinaOffice\");\n            lvi.ImageIndex = 1;\n            lvi.Tag = process;\n            listViewRunningApps.Items.Add(lvi);\n        }\n    }\n\n    listViewRunningApps.EndUpdate();\n}\n\n// Method that actually shows the process.  This works as long as process is minimized\n// However, if the process is maximized but, merely behind the current window it does\n// not bring it in front.  I have noticed that there is a ShowWindowAsync method.\n// Should I use that instead?\nprivate void listViewRunningApps_MouseDoubleClick(object sender, MouseEventArgs e)\n{\n    ListViewItem lvi = listViewRunningApps.GetItemAt(e.X, e.Y);\n    if (lvi != null)\n    {\n        Process process = (Process)lvi.Tag;\n        ShowWindow(process.MainWindowHandle, SW_SHOWMAXIMIZED);\n    }\n}\n</code></pre>\n"},{"tags":["vb.net","winforms","printing","printqueue"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12961810,"title":"How to print reports in submitted order using .NET","body":"<p>Our VB WinForms application prints a series reports using the standard PrintDocument object, some with multiple pages. My client has pointed out the the hard copy reports are not printed in the correct order. When I debug the code, I can verify the reports are generated in the correct order, but when I inspect the print queue the reports are not displayed in the order they were submitted. When I sort the queue by Submitted (date-time), the correct order of reports is shown.</p>\n\n<p>Is there a way to set the print queue from VB.NET so that multiple reports are queued and printed in date-time order? Or am I fishing in the wrong hole?</p>\n\n<p>TIA</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":4,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":3735,"score":4,"question_id":3221137,"title":"How to convert int or bool to checkState","body":"<p>I need to convert int and or bool to checkState</p>\n\n<pre><code>int ValueCheck;      \nprivate void gsCheck1_CheckedChanged(object sender, EventArgs e)\n{\n    CheckBox box = sender as CheckBox;\n    box.CheckState = ValueCheck; // doesn't work\n    this.gsCheck2.CheckState = ValueCheck; // should be 1 or 0 ?\n}\n</code></pre>\n\n<p>As you can see I want to change (this.gsCheck2) CheckState by changeing (this.gsCheck1) CheckState and end up with a integer value which is need.</p>\n\n<p>Update....\nproblem solved</p>\n\n<pre><code>private int ValueCheck(CheckState Check)\n{\n    if (Check == CheckState.Checked)\n        return 1; \n    else\n        return 0; \n}\n\n\nprivate void gs_CheckedChanged(object sender, EventArgs e)\n{\n    CheckBox box = sender as CheckBox;\n    MessageBox.Show(box.Name + \"=\"+ ValueCheck(box.CheckState).ToString());\n}\n</code></pre>\n"},{"tags":["c#","winforms","login","autocomplete","webbrowser-control"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":76,"score":0,"question_id":12786547,"title":"How to make the browser login and do something then re-login with another account","body":"<p>I have a simple program that i can open a webpage and i paste the user name and password from textbox1</p>\n\n<p>then do something inside, after that a want to re-login with another account </p>\n\n<p>i can do it for tow or three accounts put i want to deal with an open number of  usernames</p>\n\n<p>i want to take usernames from a <strong>Multiline textbox</strong> </p>\n\n<p>the code to paste only the first line and the pass word and click ok  is:</p>\n\n<pre><code>TextReader read = new StringReader(textBox2.Text);\nint rows = 500;\n\nstring[] text1 = new string[rows];\nfor (int r = 1; r &lt; rows; r++)\n{    \n    text1[r] = read.ReadLine();\n    // textBox3.Text = text1[r];\n\n    HtmlElement ele = webBrowser1.Document.GetElementById(\"name\"); if (ele != null)\n    ele.InnerText = text1[r];\n\n    ele = webBrowser1.Document.GetElementById(\"password\"); if (ele != null)\n    ele.InnerText = text1[r] + \"5\";\n\n    ele = webBrowser1.Document.GetElementById(\"s1\"); if (ele != null)\n    ele.InvokeMember(\"click\");\n</code></pre>\n\n<p><code>text1[r]</code> means that it will take the just the first line </p>\n\n<p>now the program is inside then  logout with this code </p>\n\n<pre><code>webbrowser1.navigate(\"http://example.com/logout.php\");\n</code></pre>\n\n<p>then i want to re login and do the same put with the second line (another account) then the third etc. How can i do it?</p>\n"},{"tags":["c#","winforms","sqlite","sqlite3","commercial"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":474,"score":4,"question_id":5377788,"title":"Is SQLite reliable for a commercial application?","body":"<p>I am currently testing SQLite and considering to use it for a commercial C# WinForms application. I am aware of the concurrency issues, where the database is locked whenever a write occurs. </p>\n\n<p>Beyond these, is SQLite reliable for a commercial application? I am interested in hearing of any experience in deploying SQLite commercially with an application.</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":614,"score":3,"question_id":2328823,"title":"Issue with number guessing game c#","body":"<p>I keep getting a stackOverflow error (no pun intended):\" An unhandled exception of type 'System.StackOverflowException' occurred in NumberGuessingGame.exe \"</p>\n\n<p>I'm guessing it would help if you saw my code and alswo where its ocurring:</p>\n\n<p><strong>Source - testClass:</strong></p>\n\n<pre><code>namespace NumberGuessingGame_08029490\n{\npublic class testClass : Form1\n{\n    public bool _gameWon;\n    public bool _gameRunning;\n    public int _number;\n    public int _guessesRemaining;\n\n    public int guessesRemaining\n    {\n        get { return _guessesRemaining; }\n    }\n\n    public bool gameEnded\n    {\n        get { return !_gameRunning; }\n    }\n\n    public bool gameWon\n    {\n        get { return _gameWon; }\n    }\n    public testClass()\n    {\n        _gameRunning = false;\n        _gameWon = false;\n    }\n\n    public void saveNewTestGame(int numberGuesses)\n    {\n\n        if (numberGuessesComboBox.SelectedIndex == 0)\n        {\n            numberGuesses = 1;\n        }\n        if (numberGuessesComboBox.SelectedIndex == 1)\n        {\n            numberGuesses = 3;\n        }\n        if (numberGuessesComboBox.SelectedIndex == 2)\n        {\n            numberGuesses = 5;\n        }\n\n        _guessesRemaining = numberGuesses;\n        _gameRunning = true;\n    }\n\n    public bool makeGuess(int guessNumber)\n    {\n        if (_gameRunning)\n        {\n            _guessesRemaining--;\n            if (_guessesRemaining &lt;= 0)\n            {\n                _gameWon = false;\n                _gameRunning = false;\n                return false;\n\n\n            }\n            if (guessNumber == _number)\n            {\n                _gameWon = true;\n                return true;\n            }\n            if (guessNumber &gt; _number)\n            {\n                guessResultTextBox.Text = \"Your Guess is too high, try again\";\n                _gameWon = false;\n                return false;\n            }\n            if (guessNumber &lt; _number)\n            {\n                guessResultTextBox.Text = \"Your Guess is too low, try again\";\n                _gameWon = false;\n                return false;\n            }\n            else\n            {\n                return false;\n            }\n        }\n\n        else\n        {\n            throw new Exception(\"The game is not running. Call newGame() before making a guess.\");\n\n        }\n\n    }\n}\n}\n</code></pre>\n\n<p><strong>Source - gameClass:</strong></p>\n\n<pre><code>namespace NumberGuessingGame_08029490\n{\npublic class gameClass : Form1\n{\n\n    public bool _gameWon;\n    public bool _gameRunning;\n    public static Random randomNum = new Random();\n    public int _number;\n    public int _guessesRemaining;\n\n    public int guessesRemaining\n    {\n        get { return _guessesRemaining; }\n    }\n\n    public bool gameEnded\n    {\n        get { return !_gameRunning; }\n    }\n\n    public bool gameWon\n    {\n        get { return _gameWon; }\n    }\n\n    public gameClass()\n    {\n        _gameRunning = false;\n        _gameWon = false;\n    }\n    public void saveNewGame(int numberGuesses)\n    {\n\n        if (numberGuessesComboBox.SelectedIndex == 0)\n        {\n            numberGuesses = 1;\n        }\n        if (numberGuessesComboBox.SelectedIndex == 1)\n        {\n            numberGuesses = 3;\n        }\n        if (numberGuessesComboBox.SelectedIndex == 2)\n        {\n            numberGuesses = 5;\n        }\n        if (rangeNumbersComboBox.SelectedIndex == 0)\n        {\n            int randomNumFive = randomNum.Next(1, 5);\n            randomNumFive = _number;\n        }\n        if (rangeNumbersComboBox.SelectedIndex == 1)\n        {\n            int randomNumTen = randomNum.Next(1, 10);\n            randomNumTen = _number;\n        }\n        if (rangeNumbersComboBox.SelectedIndex == 2)\n        {\n            int randomNumTwenty = randomNum.Next(1, 20);\n            randomNumTwenty = _number;\n        }\n        _guessesRemaining = numberGuesses;\n        _gameRunning = true;\n    }\n\n    public bool makeGuess(int guessNumber)\n    {\n        if (_gameRunning)\n        {\n            _guessesRemaining--;\n            if (_guessesRemaining &lt;= 0)\n            {\n                _gameWon = false;\n                _gameRunning = false;\n                return false;\n\n            }\n            if (guessNumber == _number)\n            {\n                _gameWon = true;\n                return true;\n            }\n            if (guessNumber &gt; _number)\n            {\n                guessResultTextBox.Text = \"Your Guess is too high, try again\";\n                _gameWon = false;\n                return false;\n            }\n            if (guessNumber &lt; _number)\n            {\n                guessResultTextBox.Text = \"Your Guess is too low, try again\";\n                _gameWon = false;\n                return false;\n            }\n            else\n            {\n                return false;\n            }\n\n        }\n\n        else\n        {\n            throw new Exception(\"The game is not running. Call newGame() before making a guess.\");\n\n        }\n\n    }\n}\n}\n</code></pre>\n\n<p><strong>Source - form1:</strong></p>\n\n<pre><code>namespace NumberGuessingGame_08029490\n{\npublic partial class Form1 : Form\n{\n    public Form1()\n    {\n        InitializeComponent();\n\n    }\n\n    testClass newTest = new testClass();\n    gameClass newGame = new gameClass();\n\n\n    private void saveButton_Click(object sender, EventArgs e)\n    {\n\n        if (testCheckBox.Checked == true)\n        {\n            int numberGuesses = Convert.ToInt32(numberGuessesComboBox.SelectedIndex);\n            int _number = Convert.ToInt32(testNumberTextBox.Text);\n\n            newTest.saveNewTestGame(numberGuesses);\n\n        }\n        if (testCheckBox.Checked == false)\n        {\n            int numberGuesses = Convert.ToInt32(numberGuessesComboBox.SelectedIndex);\n            int _number = Convert.ToInt32(rangeNumbersComboBox.SelectedIndex);\n\n            newGame.saveNewGame(numberGuesses);\n        }\n\n    }\n\n    private void guessButton_Click(object sender, EventArgs e)\n    {\n\n        if (testCheckBox.Checked == true)\n        {\n            int guessNumber = Convert.ToInt32(guessNumberTextBox.Text);\n            bool correctAnswer = newTest.makeGuess(guessNumber);\n\n            if (correctAnswer)\n            {\n                MessageBox.Show(\"Weldone, you Won!!\");\n            }\n\n            // if (game.GameEnded)\n            //  {\n            // disable guess button, show loss label\n            //  }\n        }\n        if (testCheckBox.Checked == false)\n        {\n            int guessNumber = Convert.ToInt32(guessNumberTextBox.Text);\n            bool correctAnswer = newGame.makeGuess(guessNumber);\n\n            if (correctAnswer)\n            {\n                MessageBox.Show(\"Weldone, you Won!!\");\n            }\n\n            // if (game.GameEnded)\n            //  {\n            // disable guess button, show loss label\n            //  }\n        }\n    }\n\n}\n}\n</code></pre>\n\n<p><strong>EDIT: No more StackOverflowException, code errors:</strong></p>\n\n<p>Thank you everyone for your help &lt;3</p>\n\n<p>Having removed the \"Form 1\" from the top It seems to have solved the issue for now, but now that the combobox, textbox variables are no longer inheriting I cant use them in the code, so I can't test to see if the solution has worked, any ideas as to how they could be used?</p>\n\n<pre><code>Error   1   The name 'numberGuessesComboBox' does not exist in the current context  E:\\Projects\\NumberGuessingGame\\NumberGuessingGame\\testClass.cs  46  17  NumberGuessingGame\n\nError   7   The name 'rangeNumbersComboBox' does not exist in the current context   E:\\Projects\\NumberGuessingGame_08029490\\NumberGuessingGame_08029490\\gameClass.cs    58  17  NumberGuessingGame_08029490\n\nError   10  The name 'guessResultTextBox' does not exist in the current context E:\\Projects\\NumberGuessingGame_08029490\\NumberGuessingGame_08029490\\testClass.cs    84  21  NumberGuessingGame_08029490\n</code></pre>\n"},{"tags":["c#",".net","winforms","datagridview"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":12947070,"title":"DataGridView Behavior","body":"<p>So, I am trying to rig a DataGridView so that when the enter key is pressed on the last cell of the last row, a new row will be added. I can't seem to get this to work, as the DataGridView controls don't seem to respond to any key events when enter key is pressed on the last row. Is there anyway to override this behavior?</p>\n"},{"tags":["c#","winforms","openfiledialog"],"answer_count":5,"favorite_count":5,"up_vote_count":8,"down_vote_count":0,"view_count":20764,"score":8,"question_id":2069048,"title":"Setting the filter to an OpenFileDialog to allow the typical image formats?","body":"<p>I have this code, how can I allow it to accept all typical image formats? PNG, JPEG, JPG, GIF?</p>\n\n<p>Here's what I have so far:</p>\n\n<pre><code>    public void EncryptFile()\n    {            \n        OpenFileDialog dialog = new OpenFileDialog();\n        dialog.Filter = \"txt files (*.txt)|*.txt|All files (*.*)|*.*\";\n        dialog.InitialDirectory = @\"C:\\\";\n        dialog.Title = \"Please select an image file to encrypt.\";\n        if (dialog.ShowDialog() == DialogResult.OK)\n        {\n            //Encrypt the selected file. I'll do this later. :)\n        }             \n    }\n</code></pre>\n\n<p>Notice that the filter is set to .txt files. I <strong>could</strong> change to PNG, but what of the other types?</p>\n\n<p>Thanks SO!</p>\n\n<p>Edit:</p>\n\n<p>I figure it out, this is how you do it:</p>\n\n<pre><code>dialog.Filter = \"JPEG Files (*.jpeg)|*.jpeg|PNG Files (*.png)|*.png|JPG Files (*.jpg)|*.jpg|GIF Files (*.gif)|*.gif\";\n</code></pre>\n"},{"tags":["c#","winforms","drawing","panel","gradient"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":282,"score":0,"question_id":9377337,"title":"Gradient Panel shows red cross when minimized and then restored","body":"<p>I have no idea why this is happening, but I created the below code which is a gradient panel, the panel is then docked to the left of the screen.</p>\n\n<p>When the form is re-sized it displays correctly, however if you minimize the form and then restore it you get a big red X instead of the gradient.</p>\n\n<p>Can anyone spot the error?</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Drawing.Drawing2D;\nusing System.Text;\nusing System.Windows.Forms;\n\npublic class GradientPanel : Panel\n{\n    private Color ColorA = Color.LightBlue;\n    private Color ColorB = Color.Red;\n    private LinearGradientMode GradientFillStyle = LinearGradientMode.ForwardDiagonal;\n    private Brush gradientBrush;\n\n    public Color colourStart\n    {\n        get { return ColorA; }\n        set { ColorA = value; Invalidate(); }\n    }\n    public Color colourEnd\n    {\n        get { return ColorB; }\n        set { ColorB = value; Invalidate(); }\n    }\n    public LinearGradientMode colourGradientStyle\n    {\n        get { return GradientFillStyle; }\n        set { GradientFillStyle = value; Invalidate(); }\n    }\n\n    public GradientPanel()\n    {\n        handlerGradientChanged = new EventHandler(GradientChanged);\n        ResizeRedraw = true;        \n    }\n\n    private EventHandler handlerGradientChanged;\n\n    protected override void OnPaintBackground(System.Windows.Forms.PaintEventArgs e)\n    {\n        gradientBrush = new LinearGradientBrush(ClientRectangle, ColorA, ColorB, GradientFillStyle);\n\n        e.Graphics.FillRectangle(gradientBrush, ClientRectangle);\n    }\n\n    protected override void Dispose(bool disposing)\n    {\n        if (disposing)\n        {\n            if (gradientBrush != null) gradientBrush.Dispose();\n        }\n        base.Dispose(disposing);\n    }\n\n    protected override void OnResize(EventArgs eventargs)\n    {\n        Invalidate();\n        //base.OnResize(eventargs);\n    }\n    protected override void OnSizeChanged(EventArgs e)\n    {\n        Invalidate();\n        //base.OnSizeChanged(e);\n    }\n    private void GradientChanged(object sender, EventArgs e)\n    {\n        if (gradientBrush != null) gradientBrush.Dispose();\n        gradientBrush = null;\n        Invalidate();\n    }\n\n}\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12960502,"title":"get my file length ongoing","body":"<p>in my application i am open Tshark process and start capturing and from my main form i am update my UI.\none of my class properties is my file how created (pcap file) and on my UI i am update this file length ongoing.\nmy problem is that if this file is new the length is remain zero but if my file is file that already exist my UI show my the length ongoing (of course the file is overwritten but i can see it growing).</p>\n\n<pre><code>    public class Tshark\n    {\n        #region members\n        private Process _tsharkProcess = new Process();\n        private int _numberOfPackets;\n        private string _tshark;\n        private List&lt;string&gt; _list;\n        private ProcessStartInfo _process;\n        private int _interfaceNumber;\n        private string _pcapPath;\n        private string _status;\n        private double _bitsPerSecond;\n        private double _packetsPerSecond;\n        private decimal _packetLimitSize;\n        private DateTime _lastTimestamp;\n        private PacketDevice _device;\n        private FileInfo _file;\n        private bool _processRunning;\n\n        public void startCapturing()\n        {            \n            ThreadStart tStarter = delegate { openAdapterForStatistics(_device); };\n            Thread thread = new Thread(tStarter);\n            thread.IsBackground = true;\n            thread.Start();\n            ProcessStartInfo tsharkStartInfo = new ProcessStartInfo();\n            tsharkStartInfo.FileName = _tshark; \n            tsharkStartInfo.RedirectStandardOutput = true; \n            tsharkStartInfo.RedirectStandardError = true; \n            tsharkStartInfo.RedirectStandardInput = true; \n            tsharkStartInfo.UseShellExecute = false; \n            tsharkStartInfo.CreateNoWindow = true; \n            tsharkStartInfo.Arguments = string.Format(\" -i \" + _interfaceNumber + \" -s \" + _packetLimitSize + \" -w \" + _pcapPath);\n            _tsharkProcess.StartInfo = tsharkStartInfo;\n            _tsharkProcess.ErrorDataReceived += _cmdProcess_ErrorDataReceived;\n            _tsharkProcess.OutputDataReceived += tshark_OutputDataReceived; \n            _tsharkProcess.EnableRaisingEvents = true; \n            _tsharkProcess.Start();\n            _processRunning = true;\n            _tsharkProcess.BeginOutputReadLine(); \n            _tsharkProcess.BeginErrorReadLine();\n_tsharkProcess.WaitForExit(); \n        }\n\n    public long getFileLength()\n    {\n        _file = new FileInfo(_pcapPath);\n        string directoryName = _file.DirectoryName;\n        DirectoryInfo directoryInfo = new DirectoryInfo(directoryName);\n        FileInfo[] dirs = directoryInfo.GetFiles();\n        _file = dirs.FirstOrDefault(f =&gt; f.Name.Equals(_file.Name));\n\n        if (_file != null)\n        {\n\n            return _file.Length;\n        }\n\n        return 0;\n    }\n\n        public void refreshFile()\n        {            \n            if (_file != null)\n            {\n                _file.Refresh();\n            }\n        }\n}\n</code></pre>\n\n<p>from the main form i am update my UI via timer:</p>\n\n<pre><code>private void tmrUpdateLbl_Tick(object sender, EventArgs e)\n{\n    lblFileSizeTabSniffer2.Text = formatBytes(tshark.getFileLength());\n    tshark.refreshFile();\n}\n</code></pre>\n\n<p>in the dibugger i can see that if the file is new one _file is null all the time so in getFileLength() method return zero.</p>\n"},{"tags":["c#","visual-studio","winforms","gui","wizard"],"answer_count":5,"favorite_count":7,"up_vote_count":21,"down_vote_count":0,"view_count":8486,"score":21,"question_id":38719,"title":"What is the best way to create a wizard in C# 2.0?","body":"<p>I have a winforms application where users will be creating stock items, and a time of creation there are a number of different things that need to happen.</p>\n\n<p>I think the UI for this should probably be a wizard of some kind, but I'm unsure as to the best way to achieve this. I have seen a couple of 3rd party Wizard controls, and I have also seen manual implementations of making panel visible/invisible.</p>\n\n<p>What are the best ways that people have used in the past, that are easy to implement, and also make it easy to add \"pages\" to the wizard later on if needed?</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":218,"score":1,"question_id":5748630,"title":"How to associate SDF files (sqlCE) with my C# program?","body":"<p>I a made C# program that opens and show sdf files (sqlCE).</p>\n\n<p>How to make it so (on my program installation) that all *.sdf files</p>\n\n<p>in my computer will be opened with my program ?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","winforms","animation","bitmap","control"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":55,"score":0,"question_id":12944701,"title":"Which is faster when animating the UI: a Control or a Picture?","body":"<p>/I'm working with and testing on a computer that is built with the following:\n{1 GB RAM (now 1.5 GB), 1.7 GHz Intel Pentium Processor, ATI Mobility Radeon X600 GFX}</p>\n\n<p>I need scale / transform controls and make it flow smoothly. Currently I'm manipulating the size and location of a control every 24-33ms (30fps), ±3px. When I add a 'fade' effect to an image, it fades in and out smoothly, but it is only 25x25 px in size. The control is 450x75 px to 450x250 px in size. In 2D games such as Bejeweled 3, the sprites animate with no choppy animation.</p>\n\n<p>So as the title would suggest: which is easier/faster on the processor: animating a bitmap (rendering it to the parent control during animation) or animating the control it's self?</p>\n\n<p><strong>EDIT:</strong>\nHey, I thought this was a helpful community, not one that down-rates questions that don't seem challenging! (And I've seen more ridiculous questions here with better ratings too!) Please drop me a line first before negatively rating my questions!</p>\n"},{"tags":["c#","winforms","windows-services"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":128,"score":1,"question_id":12953148,"title":"show a windows form from a window service","body":"<p>i am creating a window service. my requirement is to display window form from window NT service on particular interval. For testing purpose , i just want to display the form on service start:</p>\n\n<pre><code> protected override void OnStart(string[] args)\n        {\n            eventLog1.WriteEntry(\"In OnStart -before form show\");\n\n            Messager_Form obj = new Messager_Form();\n            obj.Show();\n           // System.Diagnostics.Process.Start(\"calc.exe\");\n            eventLog1.WriteEntry(\"In OnStart -after form show\");\n           // timer1.Start();\n        }\n</code></pre>\n\n<p>it not working. Neither form is showing nor calc process is running.  i have found some links \n<a href=\"http://stackoverflow.com/questions/8788325/showing-a-popup-form-a-windows-service\">showing pop up </a> , but most of them suggesting WCF. isn't it possible without wcf. can anybody show me the way to achieve this.</p>\n"},{"tags":["vb.net","winforms"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2964,"score":2,"question_id":1603444,"title":"How can I set the tab order in VB.NET?","body":"<p>I have a bunch of buttons on a form and when the person presses <kbd>TAB</kbd> I want the focus of the controls move in a specific order. Does anyone know how to do this?</p>\n"},{"tags":["c#","winforms","bitmap","fractals","pallet"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":58,"score":0,"question_id":12950561,"title":"Palette Bitmap - Fractal Color Cycling","body":"<p>I am trying to use an existing Bitmap image on a C# windows form which is a rendered MandleBrot Fractal. I want to implement colour cycling. It must be done with with the use of a pallete image. Here is my code I am stuck for days now and can't get it to work. The code must be inside the timer method.</p>\n\n<pre><code> private void timer1_Tick(object sender, EventArgs e)\n    {\n                   Bitmap bitmap2 = new Bitmap(640, 480,PixelFormat.Format8bppIndexed);\n\n        ColorPalette palette = bitmap2.Palette;\n\n        for (int i = 0; i &lt; 256; i += 3)\n        {\n            Color b = new Color(); \n            b = Color.FromArgb(i);\n            bitmap2.Palette.Entries.SetValue(b, i);\n           //b = Color.FromArgb(palette[i], palette[i + 1], palette[i + 2]);\n           // bitmap.Palette.Entries.SetValue(b, i);\n            //bitmap.Palette = palette;\n        } \n\n        mandelbrot();\n    }\n</code></pre>\n\n<p>The original image is called bitmap and the palette needs to be bitmap2.\nThanks</p>\n"},{"tags":["c#",".net","vb.net","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":526,"score":2,"question_id":2842993,"title":"How to highlight a taskbar item","body":"<p>In almost all messengers when your IM window is minimized to the taskbar, IM taskbar item changes color or gets brighter when you have a new message. I've been looking for any help on how to do this using .NET Winforms or WPF</p>\n\n<p>Any code samples?</p>\n\n<p>=====================================================================</p>\n\n<p>EDIT: I used FlashWindow for my WPF window.</p>\n\n<p>Ref: <a href=\"http://www.aeoth.net/blog/2007/04/27/flashing-the-window-in-wpf-c-2/\" rel=\"nofollow\">http://www.aeoth.net/blog/2007/04/27/flashing-the-window-in-wpf-c-2/</a></p>\n"},{"tags":["winforms","garbage-collection","dispose","mdi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12958926,"title":"Disposing MDI Child forms","body":"<p>According to the <a href=\"http://msdn.microsoft.com/en-us/library/system.windows.forms.form.close.aspx\" rel=\"nofollow\">msdn</a></p>\n\n<blockquote>\n  <p>The two conditions when a form is not disposed on Close is when (1) it\n  is part of a multiple-document interface (MDI) application, and the\n  form is not visible; and (2) you have displayed the form using\n  ShowDialog. In these cases, you will need to call Dispose manually to\n  mark all of the form's controls for garbage collection.</p>\n</blockquote>\n\n<p>How do I go about this for the first case? If I manually dispose, this.dispose() ,of the form and set a breakpoint within dispose (found in the form's designer file), the breakpoint is never reached. </p>\n"},{"tags":["c#","winforms","visual-studio-2010","datagridview"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":12958992,"title":"Deleting dataGridView1_CellContentClick() from C# code results in build failure - Why?","body":"<p>If I never double-click on a freshly created DataGridView control, the <code>dataGridView1_CellContentClick()</code> handler is not created, yet the application builds and runs without any problem.</p>\n\n<p>But once I create this <code>dataGridView1_CellContentClick()</code> handler by double-clicking the DataGridView control, <strong>then delete it</strong>, I receiving this <strong>build</strong> failure: </p>\n\n<blockquote>\n  <p>error CS1061: 'App1.Form1' does not contain a definition for\n  'dataGridView1_CellContentClick' and no extension method\n  'dataGridView1_CellContentClick' accepting a first argument of type\n  'App1.Form1' could be found (are you missing a using directive or an\n  assembly reference?)</p>\n</blockquote>\n\n<p>Why?</p>\n\n<p>How does the framework know that I created it? </p>\n\n<p>Is there a correct way of removing this handler?</p>\n"},{"tags":["c#","winforms","menu","mdi","mdichild"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12951820,"title":"Extra separator after MdiWindowListItem when no child windows are open","body":"<p>I have an MDI application. I have a <code>ToolStripMenuItem</code> labeled \"Window\" that is set as the <code>MdiWindowListItem</code> of my main <code>MenuStrip</code>. The Window menu has a couple of items, such as \"Cascade\" and \"Arrange Icons\".</p>\n\n<p>When I run my application, the Window menu ends neatly with my \"Arrange Icons\" item. As expected, when I open one or more MDI child forms, these are automatically appended after a <code>ToolStripSeparator</code>. When I close all of the child forms, they disappear as expected from the \"Window\" menu, however the <code>ToolStripSeparator</code> remains. I would have expected the menu to return to its original state, i.e. without the separator.</p>\n\n<p>As it stands, the separator is automatically added but not automatically removed. I could try to programmatically eliminate the extra separator, of course, but I don't see anyone else complaining about this, which leads me to suspect that it might be happening because I did something wrong. Please advise.</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":23,"score":0,"question_id":12958256,"title":"Issue in Loading content to RichTextBox from XML document","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12957631/loading-richtextbox-content-from-xml\">Loading richtextbox content from xml</a>  </p>\n</blockquote>\n\n\n\n<p>I have a RichTextBox where the user can format the text and save as an xml document. I save the RichtextBox.Rtf content in my xml document. When i try to load the saved data from xml. The RichTextBox doesn't format the text based on the Rtf content from XML.</p>\n\n<p>You can find the full details form this <a href=\"http://stackoverflow.com/questions/12957631/loading-richtextbox-content-from-xml\">post.</a> </p>\n"},{"tags":["c#",".net","winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":86,"score":1,"question_id":12957631,"title":"Loading richtextbox content from xml","body":"<p>I have a RichTextBox where the user can format the text and save as an xml document. I save the RichtextBox.Rtf content in my xml document.\nWhen i try to load the saved data from xml. The RichTextBox doesn't format the text based on the Rtf content from XML.</p>\n\n<p>Sample Code used for creating XML</p>\n\n<pre><code>XmlTextWriter objXmlWriter = new XmlTextWriter(path, null);\nobjXmlTextWriter.Formatting = Formatting.Indented;\nobjXmlTextWriter.WriteStartDocument();    \nobjXmlTextWriter.WriteStartElement(\"MyData\");\n\nRichTextBox tBox = (RichTextBox)sender;\nobjXmlWriter.WriteStartElement(\"RcText\");\nobjXmlWriter.WriteString(tBox.Rtf);\nobjXmlWriter.WriteEndElement();\n\nobjXmlWriter.WriteEndDocument();\nobjXmlWriter.Flush();\nobjXmlWriter.Close();    \n</code></pre>\n\n<p>Sample Code used for reloading the RichTextBox from XML</p>\n\n<pre><code>XmlDocument xDoc = new XmlDocument();\nxDoc.Load(selPath);\nXmlNodeList oDescendant = doc.SelectNodes(\"/MyData\");\nforeach (XmlNode xn in oDescendant)\n{\n    ID++;\n\n    RichTextBox rcTxt = new RichTextBox();\n    rcTxt.Name = \"rtd\" + ID;\n\n    rcTxt.Rtf = xn[\"RcText\"].InnerText;\n}\n</code></pre>\n\n<p>Sample content as seen after loading the content to richtext from XML.</p>\n\n<pre><code>{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Microsoft Sans Serif;}}\n\\viewkind4\\uc1\\pard\\f0\\fs17 Sample \\b Text\\b0\\par\n}\n</code></pre>\n\n<p>I am not sure where I am wrong. Please give your suggestions.</p>\n\n<p>I tried searching for some similar cases but was not helpful.\nSome of the links which i referred : <a href=\"http://www.codeproject.com/Articles/12932/Saving-and-Restoring-RichTextBox-Formatted-Text-Al\" rel=\"nofollow\">Code Project Link</a> </p>\n"},{"tags":[".net","vb.net","winforms","alignment"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":12956922,"title":"Flow container vertical align with VB.NET","body":"<p>I have a <code>Label</code> whose length changes as the program runs (the text is modified). And I am trying to set side-by-side this <code>Label</code> and an <code>PictureBox</code>. To do so, I did put them into a <code>FlowLayoutPanel</code>. </p>\n\n<p>The problem is then that the two elements are not vertically aligned: they have different height.</p>\n\n<p>I did not find a <em>VerticalAlign</em> property in the <code>FlowLayoutPanel</code> nor did I manage to modify the height of my <code>Label</code> (changing the font size is not an option).</p>\n\n<p>Any suggestion?</p>\n"},{"tags":["c#","winforms","dockpanel-suite"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12956147,"title":"DockPanel Suite - DockContent visibility","body":"<p>A form contains a DockPanel with an instance of DockContent which has DockState=DockState.DockBottomAutoHide and it acts as a logger view - like Visual Studio's Error list panel. So, when a logging event is added to log list, DockPanel - if is not visible - is shown in next way:</p>\n\n<pre><code>{\n  loggerList.AddLogEvent(event);\n  loggerContentPanel.Show();\n};\n</code></pre>\n\n<p>but if loggerContentPanel is already visible for user, Show method make the panel to \"blink\".\nIs any way to get the state of a DockContent with DockState = DockState.DockBottomAutoHide if is visible for user? IsHidden or Visible properties doesn't help too much.</p>\n"},{"tags":["c#","winforms","sorting","treeview"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":2026,"score":4,"question_id":808696,"title":"C# Windows Form TreeView Sort after LabelEdit","body":"<p>After a node's label is edited in the tree I try to resort the nodes to place the updated item in the right position.  I do this by calling .Sort in AfterLabelEdit event handler which causes an infinite loop.</p>\n\n<p>How can I resort the nodes in a treeview after a label has been changed?</p>\n"},{"tags":["c#","winforms","listboxitem"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":853,"score":0,"question_id":5298627,"title":"Triggering event when ListBox.Item's size changes","body":"<p>I want to update/call some function, when my ListBox.Items.Count changes. On Addition to Listbox or on removal of the items, how to trigger a function. </p>\n"},{"tags":["c#","winforms","listbox"],"answer_count":4,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":6014,"score":1,"question_id":2675067,"title":"Binding Listbox to List<object>","body":"<p>What's the simplest way to bind a Listbox to a List of objects?</p>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":85,"score":1,"question_id":12955533,"title":"Invoke a method from a form","body":"<p>Is it possible to invoke a method with parameters from a form?  I know I can use an action.  I suppose closure captures variables in actions to allow this to work. Still, I feel like Methods would be cleaner.  I have a lot of these actions in our codebase and I don't like them sitting about hidden inside of methods where they are hard to refactor.</p>\n\n<pre><code>    public static void Main()\n    {\n        Form form = new Form();\n        Action action = () =&gt; form.SendToBack();//(Now Imagine this Action is 50 lines of code and there's 15 of them...Then it should make sense as to why I want to seperate this logic out into classes and methods.\n        //Action action2 = AMethod(form);//doesnt work\n\n        Task.Factory.StartNew(\n            () =&gt;\n            {                    \n                //form.Invoke(AMethod);//doesnt work see error below...also no params\n                form.Show();                    \n                form.Invoke(action);\n                Application.Run();\n            }\n         );\n        Console.Read();\n    }\n\n    public static void AMethod(Form form)\n    {\n        form.SendToBack();\n    }\n</code></pre>\n\n<p><strong>UPDATE</strong><br />\nI tried the overload per the comments <code>form.Invoke(AMethod,form);</code> and I get error:</p>\n\n<blockquote>\n  <p>Argument 1: cannot convert from 'method group' to 'System.Delegate'</p>\n</blockquote>\n"},{"tags":["c#","winforms","ms-access","ado.net","oledbconnection"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12946716,"title":"InvalidOperationException was unhandled Not allowed to change the 'ConnectionString' property. On C#","body":"<p>I have this kind of error although the syntax is correct and I encounter an InvalidOperationExeption.\n<img src=\"http://i.stack.imgur.com/skYHX.png\" alt=\"Screenshot Sample\"></p>\n\n<p><img src=\"http://i.stack.imgur.com/IkvA1.png\" alt=\"On my dbs.cs class\"></p>\n\n<p>On my konek function on class dbs</p>\n\n<pre><code>public String konek()\n{\n            connectionString = \"Provider=\" + OleDBProvider + \";Data Source=\" + OleDBDataSource + \";JET OLEDB:Database Password=\" + OleDBPassword + \";Persist Security Info=\" + PersistSecurityInfo + \"\";\n            return connectionString;\n}\n</code></pre>\n"},{"tags":["c#",".net","winforms","closing","formclosing"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":1,"view_count":2064,"score":1,"question_id":4655810,"title":"How can I prevent a user from closing my C# application?","body":"<p>How to make unclosed application in C#? I want to disable the 'X' button of the form and prevent the Windows Task Manager from closing it as well.</p>\n\n<p>I know that one way to prevent a form from closing is to handle the <code>FormClosing</code> event, but how do I prevent the task manager from closing it?</p>\n"},{"tags":["winforms","qt"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12954015,"title":"Hosting Windows forms in Qt widget","body":"<p>I am using <code>QtControlHost</code> to integrate a windows form (created using c# object). \nBut, some events are not passed on to the hosted control properly, like the <kbd>Tab</kbd> key press. Other keys like <kbd>Enter</kbd> and normal key strokes are working just fine.</p>\n\n<p>What might cause this problem and how do I solve it?</p>\n"},{"tags":["c#","winforms","datetime","datetime-format"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":134,"score":1,"question_id":12952089,"title":"Set your System DateTime Format c#","body":"<p>I need to change/update/set my system (windows7) default dateTime format <strong>programatically</strong> and permanently until I change it myself through code or through windows GUI</p>\n\n<p>I have tried a lot of solutions like this one from <a href=\"http://www.codeproject.com/Questions/168386/How-to-change-system-date-format-c\" rel=\"nofollow\">Code Project</a></p>\n\n<pre><code>       Console.Write(DateTime.Now + \"\");\n       RegistryKey rkey = Registry.CurrentUser.OpenSubKey(@\"\n       Control Panel\\International\", true);\n        rkey.SetValue(\"sShortDate\", \"dd/MM/yyyy\");\n        rkey.SetValue(\"sLongDate\", \"dd/MM/yyyy\");\n       Console.Write(DateTime.Now + \"\");\n</code></pre>\n\n<p>The closest and well reputed answer is following from from <a href=\"http://stackoverflow.com/questions/1389187/set-default-datetime-format-c-sharp\">Set Default DateTime Format c#</a>, I tried this solution but it did not help me. As It does not change my system datetime format (shown in taskbar). And after I restart the app having this code, I again get the old format before this code is executed.</p>\n\n<pre><code>using System;\nusing System.Globalization;\nusing System.Threading;\n\nnamespace test \n{\n    public static class Program\n    {\n        public static void Main() {\n          Console.Write(DateTime.Now + \"\");// MessageBox.Show(DateTime.Now + \"\");\n          CultureInfo culture = (CultureInfo)CultureInfo.CurrentCulture.Clone();\n          culture.DateTimeFormat.ShortDatePattern = \"dd-MMM-yyyy\";\n          culture.DateTimeFormat.LongTimePattern = \"\";\n          Thread.CurrentThread.CurrentCulture = culture;\n          Console.Write(DateTime.Now + \"\");// MessageBox.Show(DateTime.Now + \"\");\n        }\n    }\n}\n</code></pre>\n"},{"tags":["winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":12946650,"title":"VB .net class libray","body":"<p>I get a doubt about Class Library application type, so I need help on this.</p>\n\n<p>I get a software I can add plugin to. I want to make this plugin in VB.NET using Visual Studio 2010.\nThe software only accept class libray application type only and I need to display a Form with a Combobox in order for the user to pickup a value in a list.</p>\n\n<p>In the main class that is first launched when the software calls the plugin. I launch a Windows Form in the code below the object's name is objListValidation. My problem is that when I do the Me.Show() it displays the window, but it's going to the end of the CompareToList function and doesn't stop there. </p>\n\n<p>Code that launch the Win Form : </p>\n\n<pre><code>Public objListValidation As ListValidation\n\nobjListValidation = New ListValidation\nobjListValidation.CompareToList(\"SELECT &lt;NOM_CHAMP&gt; FROM &lt;NOM_TABLE&gt;\")\n</code></pre>\n\n<p>Code that display the Win Form : </p>\n\n<pre><code>Public Sub CompareToList(ByVal qryStr As String, Optional ByVal isBloquant As Boolean = False)\n    Dim alCompteGeneraux As New ArrayList\n    Dim isExistsInList As Boolean = False\n\n    Dim objConnectDB2 As New ConnectDB2\n    Dim i As Integer = 0\n\n    If Not isBloquant Then btnCancel.Visible = True : manageButtonsPosition() Else mstrIsBloquant = True\n    al.Add(\"AAA\")\n    al.Add(\"VVVV\")\n    al.Add(\"BBBB\")\n\n    For i = 0 To al.Count - 1\n        If al.Item(i).ToString = mstrObjInvoiceField.DisplayString Then isExistsInList = True\n    Next\n\n    If Not isExistsInList Then\n        Me.Text = \"Liste de choix pour le champ : \" + mstrObjInvoiceField.Name\n        lblTitle.Text = \"Veuillez choisir dans la liste une valeur pour le champ : \" + mstrObjInvoiceField.Name\n        cbList.DataSource = al\n        Me.Show()\n    Else\n        validation()\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Thank you for your help</p>\n"},{"tags":[".net","winforms","textbox"],"answer_count":4,"favorite_count":0,"up_vote_count":10,"down_vote_count":0,"view_count":3628,"score":10,"question_id":1298406,"title":"How to set the TAB width in a Windows Forms TextBox control?","body":"<p>Given a WinForms TextBox control with <code>MultiLine = true</code> and <code>AcceptsTab == true</code>, how can I set the width of the tab character displayed?</p>\n\n<p>I want to use this as a quick and dirty script input box for a plugin. It really doesn't need to be fancy at all, but it would be nice if tabs were not displayed as 8 characters wide...</p>\n\n<p>From the accepted answer:</p>\n\n<pre><code>// set tab stops to a width of 4\nprivate const int EM_SETTABSTOPS = 0x00CB;\n\n[DllImport(\"User32.dll\", CharSet = CharSet.Auto)]\npublic static extern IntPtr SendMessage(IntPtr h, int msg, int wParam, int[] lParam);\n\npublic static void SetTabWidth(TextBox textbox, int tabWidth)\n{\n    Graphics graphics = textbox.CreateGraphics();\n    var characterWidth = (int)graphics.MeasureString(\"M\", textbox.Font).Width;\n    SendMessage(textbox.Handle, EM_SETTABSTOPS, 1, \n                new int[] { tabWidth * characterWidth });\n}\n</code></pre>\n\n<p>This can be called in the constructor of your <code>Form</code>, but beware: Make sure <code>InitializeComponents</code> is run first.</p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12910369,"title":"Delete empty rows from all datagridviews","body":"<p>This way I can delete empty rows from one datagridview.</p>\n\n<pre><code>bool Empty = true;\n\n            for (int i = 0; i &lt; PrimaryRadGridView.Rows.Count; i++)\n            {\n                Empty = true;\n                for (int j = 0; j &lt; PrimaryRadGridView.Columns.Count; j++)\n                {\n                    if (PrimaryRadGridView.Rows[i].Cells[j].Value != null &amp;&amp; PrimaryRadGridView.Rows[i].Cells[j].Value.ToString() != \"\")\n                    {\n                        Empty = false;\n                        break;\n                    }\n                }\n                if (Empty)\n                {\n                    PrimaryRadGridView.Rows.RemoveAt(i);\n                }\n            }\n</code></pre>\n\n<p>I got around 6 datagridviews and I want to delete empty rows of all.</p>\n\n<p>Is there a way to delete empty rows from all the datagridviews in the interface??</p>\n"},{"tags":["c#","wpf","winforms","camera"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":66,"score":0,"question_id":12951996,"title":"Connect digital camera programatically same as webcam to capture pictures?","body":"<p>My camera is a Cannon 3100 IS </p>\n\n<p>Whenever I connect it to a system and press <code>ON</code> button it reads the camera's memory card \nbut when its not connected to system &amp; we press <code>ON</code> button, the lens is opened and \nwe can click for a picture </p>\n\n<p>But how to use a camera to start it's click on button? Is there any common code available to start a camera?</p>\n\n<p>Any links and help will be appreciated a lot...</p>\n"},{"tags":[".net","winforms"],"answer_count":8,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":16025,"score":5,"question_id":705409,"title":"How do I open a FolderBrowserDialog at the selected folder?","body":"<p>I have a FolderBrowserDialog, displayed with code shown below.  However, it keeps opening with 'Computer', i.e. the root of the folder tree, selected.  How do I get it to open on the selected folder?</p>\n\n<pre><code>       var folderBrowser = new FolderBrowserDialog();\n        folderBrowser.Description = \"Select Chase 6 Installation Folder\";\n        folderBrowser.RootFolder = Environment.SpecialFolder.MyComputer;\n        folderBrowser.ShowNewFolderButton = false;\n        if (Directory.Exists(Properties.Settings.Default.defaultChasePath))\n        {\n            string x = Properties.Settings.Default.defaultChasePath;\n            folderBrowser.SelectedPath = x;\n        }\n        if (folderBrowser.ShowDialog(this) == DialogResult.OK)\n        {\n            chasePathtext.Text = folderBrowser.SelectedPath;\n        }\n</code></pre>\n"},{"tags":["c#","winforms","oledb"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":90,"score":0,"question_id":12838309,"title":"Syntax error in UPDATE statement OleDb Exception in C#","body":"<p>I already double check my SQL Statement and it seems that my SQL Statement is Error. I don't why it doesn't work. My SQL Statement is correct and It resulted to this OleDBException.</p>\n\n<p>Here is the code</p>\n\n<pre><code>public void updateAccount(Int32 accountid, String username, String password, String isdisable)\n{\n     con.ConnectionString = db.konek();\n     String sql = \"UPDATE accounts SET username = @username, password = @password, isdisable = @isdisable WHERE accountid = @accountid\";\n     try\n     {\n         con.Open();\n         OleDbCommand cmd = new OleDbCommand(sql, con);\n         cmd.Parameters.AddWithValue(\"@username\", username);\n         cmd.Parameters.AddWithValue(\"@password\", password);\n         cmd.Parameters.AddWithValue(\"@isdisable\", isdisable);\n         cmd.Parameters.AddWithValue(\"@accountid\", accountid);\n         cmd.ExecuteNonQuery();\n     }\n     finally\n     {\n         con.Close();\n     }\n}\n</code></pre>\n\n<p>Screenshots of my MS Access Table\n<img src=\"http://i.stack.imgur.com/yiPHQ.png\" alt=\"enter image description here\"></p>\n\n<p>Exception Screenshot\n<img src=\"http://i.stack.imgur.com/Z27N9.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","winforms","popup","devexpress"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12951315,"title":"Popup Control closes on fireing event","body":"<p>i have two controls. First is a comment control, which allow the user to create, update and delete comments. It got own Menübar with add, safe, delete button. \nIf someone want to add this control in his form it could be to big. So i have a second control, which is just a PopupContainerEdit with PopupControl. In the popupcontrol i add the commentcontrol. So i have an popupcommentcontrol and if someone want to add it in his form he just need a place for a small button of the popupcontaineredit.</p>\n\n<p>My problem is, if i change the list of commentars (save, delete) in the commentarcontrol i fire a event, so that the popup can check the change of the list. So the Popupcontrol know if there are comments or not and i can swap the icon of the button. The enduser directly see on the icon of the button if there are comments or not. But if i fire the event to tell my popup \"hey the list changes\" the popup window get closed.</p>\n\n<p>Is there a possibility to stop this close if i fire the event?</p>\n\n<p>regards</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12949664,"title":"Maximize application with two opened form","body":"<p>I have two form in my application\nfirst form is used the background and sec form showed on the first form with this code:</p>\n\n<pre><code>frsform _frsform=new frsform();     \n_frsform.TopLevel = true;\n_frsform.ShowInTaskbar = false;\n_frsform.ShowDialog();\n</code></pre>\n\n<p>I use this code to minimized both opened form</p>\n\n<pre><code> foreach (Form frm in Application.OpenForms)\n {\n   frm.WindowState = FormWindowState.Minimized;\n }\n</code></pre>\n\n<p>but when i click on task bar for maximize my application the second form is hidden and i just see first form.</p>\n\n<p>what do i must do for see both forms when i maximize application?(see first form behind sec form)</p>\n"},{"tags":["winforms","log4net","app-config","filenotfoundexception","boundary"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1692,"score":0,"question_id":6935017,"title":"log4net.Config.XmlConfigurator.Configure() gives - \"FileNotFoundException crossed a native/managed boundary\"","body":"<p>This is only the 2nd time I've tried to use log4net. This is a Windows form app and I thought things are set up OK but I was not getting any logfile created. I found some advice about needing to explicitly make it read the app.config file so I added <strong>log4net.Config.XmlConfigurator.Configure()</strong> here:</p>\n\n<pre><code>public partial class GridForm : Form\n{\n    public static readonly ILog log = LogManager.GetLogger(typeof(GridForm));\n\n    public GridForm()\n    {\n        InitializeComponent();\n                                          // Initialize log4net (make him read the app.config file)\n        log4net.Config.XmlConfigurator.Configure();     // this gives the exception \n    }\n</code></pre>\n\n<p>I have a little uncertainty about how I'm referencing the log4net.dll. </p>\n\n<ul>\n<li>I have 2 projects in the solution - CBMI.Common which is a class library project and CBMI.WinFormsUI which is my forms project (startup form).</li>\n<li>I copied log4net.dll to the bin directory of CBMI.Common (NOT the bin\\debug folder)</li>\n<li>then added a reference in my forms project that points to that location: CBMI.Common\\bin</li>\n</ul>\n\n<p>This compiles without error. I think that it should be OK, but...</p>\n\n<p>I cannot determine what to do from the exception raised and messages shown:</p>\n\n<pre><code>System.IO.FileNotFoundException crossed a native/managed boundary\n  Message=Could not load file or assembly 'Log4net' or one of its dependencies. The system cannot find the file specified.\n  Source=mscorlib\n  FileName=Log4net\n  FusionLog==== Pre-bind state information ===\nLOG: User = HPpavilion\\john\nLOG: DisplayName = Log4net\n (Partial)\nWRN: Partial binding information was supplied for an assembly:\nWRN: Assembly Name: Log4net | Domain ID: 1\nWRN: A partial bind occurs when only part of the assembly display name is provided.\nWRN: This might result in the binder loading an incorrect assembly.\nWRN: It is recommended to provide a fully specified textual identity for the assembly,\nWRN: that consists of the simple name, version, culture, and public key token.\nWRN: See whitepaper http://go.microsoft.com/fwlink/?LinkId=109270 for more information and common solutions to this issue.\nLOG: Appbase = file:///C:/Users/john/documents/visual studio 2010/Projects/CBMI.LatitudePostConverter/CBMI.WinFormsUI/bin/Debug/\nLOG: Initial PrivatePath = NULL\nCalling assembly : System.Configuration, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a.\n===\nLOG: This bind starts in default load context.\nLOG: Using application configuration file: C:\\Users\\john\\documents\\visual studio 2010\\Projects\\CBMI.LatitudePostConverter\\CBMI.WinFormsUI\\bin\\Debug\\CBMI.WinFormsUI.vshost.exe.Config\nLOG: Using host configuration file: \nLOG: Using machine configuration file from C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\config\\machine.config.\nLOG: Policy not being applied to reference at this time (private, custom, partial, or location-based assembly bind).\nLOG: Attempting download of new URL file:///C:/Users/john/documents/visual studio 2010/Projects/CBMI.LatitudePostConverter/CBMI.WinFormsUI/bin/Debug/Log4net.DLL.\nLOG: Attempting download of new URL file:///C:/Users/john/documents/visual studio 2010/Projects/CBMI.LatitudePostConverter/CBMI.WinFormsUI/bin/Debug/Log4net/Log4net.DLL.\nLOG: Attempting download of new URL file:///C:/Users/john/documents/visual studio 2010/Projects/CBMI.LatitudePostConverter/CBMI.WinFormsUI/bin/Debug/Log4net.EXE.\nLOG: Attempting download of new URL file:///C:/Users/john/documents/visual studio 2010/Projects/CBMI.LatitudePostConverter/CBMI.WinFormsUI/bin/Debug/Log4net/Log4net.EXE.\n\n  StackTrace:\n       at System.RuntimeTypeHandle.GetTypeByName(String name, Boolean throwOnError, Boolean ignoreCase, Boolean reflectionOnly, StackCrawlMarkHandle stackMark, Boolean loadTypeFromPartialName, ObjectHandleOnStack type)\n       at System.RuntimeTypeHandle.GetTypeByName(String name, Boolean throwOnError, Boolean ignoreCase, Boolean reflectionOnly, StackCrawlMark&amp; stackMark, Boolean loadTypeFromPartialName)\n       at System.RuntimeType.GetType(String typeName, Boolean throwOnError, Boolean ignoreCase, Boolean reflectionOnly, StackCrawlMark&amp; stackMark)\n       at System.Type.GetType(String typeName, Boolean throwOnError)\n       at System.Configuration.Internal.InternalConfigHost.System.Configuration.Internal.IInternalConfigHost.GetConfigType(String typeName, Boolean throwOnError)\n       at System.Configuration.Internal.DelegatingConfigHost.GetConfigType(String typeName, Boolean throwOnError)\n       at System.Configuration.TypeUtil.GetTypeWithReflectionPermission(IInternalConfigHost host, String typeString, Boolean throwOnError)\n  InnerException: \n</code></pre>\n\n<p>For completeness, I will add the <strong>app.config</strong> file:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;configuration&gt;\n&lt;configSections&gt;\n    &lt;sectionGroup name=\"userSettings\" type=\"System.Configuration.UserSettingsGroup, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" &gt;\n        &lt;section name=\"CBMI.WinFormsUI.Properties.Settings\" type=\"System.Configuration.ClientSettingsSection, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" allowExeDefinition=\"MachineToLocalUser\" requirePermission=\"false\" /&gt;\n    &lt;/sectionGroup&gt;\n\n    &lt;section name=\"log4net\" type=\"log4net.Config.Log4NetConfigurationSectionHandler,Log4net\"/&gt;\n\n&lt;/configSections&gt;\n\n&lt;userSettings&gt;\n  &lt;CBMI.WinFormsUI.Properties.Settings&gt;\n        &lt;setting name=\"DefaultRootFolder\" serializeAs=\"String\"&gt;\n            &lt;value /&gt;\n        &lt;/setting&gt;\n    &lt;/CBMI.WinFormsUI.Properties.Settings&gt;\n&lt;/userSettings&gt;\n\n&lt;log4net&gt;\n    &lt;appender name=\"LogFileAppender\" type=\"log4net.Appender.RollingFileAppender\"&gt;\n        &lt;param name=\"File\" value=\"log-file.txt\"/&gt;\n        &lt;param name=\"AppendToFile\" value=\"true\"/&gt;\n        &lt;rollingStyle value=\"Size\"/&gt;\n        &lt;maxSizeRollBackups value=\"10\"/&gt;\n        &lt;maximumFileSize value=\"10MB\"/&gt;\n        &lt;staticLogFileName value=\"true\"/&gt;\n        &lt;layout type=\"log4net.Layout.PatternLayout\"&gt;\n          &lt;param name=\"ConversionPattern\" value=\"%-5p%d{yyyy-MM-dd hh:mm:ss} – %m%n\"/&gt;\n        &lt;/layout&gt;\n    &lt;/appender&gt;\n    &lt;root&gt;\n        &lt;level value=\"DEBUG\"/&gt;\n        &lt;appender-ref ref=\"LogFileAppender\"/&gt;\n    &lt;/root&gt;\n&lt;/log4net&gt;\n\n&lt;startup&gt;\n    &lt;supportedRuntime version=\"v4.0\" sku=\".NETFramework,Version=v4.0\"/&gt;\n&lt;/startup&gt;\n\n&lt;/configuration&gt;\n</code></pre>\n"},{"tags":["c#",".net","winforms","64bit"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12949753,"title":"WindowFromPoint doesn't work correctly on 64bit .NET Framework","body":"<p>I wrote the easy test program by C# and .NET 4.0. </p>\n\n<pre><code>[DllImport(\"user32.dll\")]\nstatic extern IntPtr WindowFromPoint(int xPoint, int yPoint);\n\nPoint pt = MousePosition;\nIntPtr w = WindowFromPoint(pt.X, pt.Y);\n</code></pre>\n\n<p>If this builts as 32bit, it works. But if it builds as 64bit, an unrelated window handle will return. Are there a solution or alternatives?</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12918165,"title":"Can I get C# to automatically fill the user Settings into a DataView?","body":"<p>I have a bunch of user settings in <code>Properties.Settings.Default</code> and felt/thought that I could simply populate a <code>DataView</code> (or something) thus circumventing the need for a \"control per setting\" and allow me to just add a Setting variable in the future. Is that possible?</p>\n"},{"tags":["c#",".net","wpf","winforms","folderbrowserdialog"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":12946488,"title":"Is it possible to use non-special folder as a FolderBrowserDialog's root folder?","body":"<p><a href=\"http://msdn.microsoft.com/en-us/library/system.windows.forms.folderbrowserdialog.rootfolder.aspx\" rel=\"nofollow\">FolderBrowserDialog.RootFolder Property</a> is restricted to only special folder defined in the <a href=\"http://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx\" rel=\"nofollow\">Environment.SpecialFolder</a> enumerator. However in my applciation, we need to show this dialog, but the root path needs to be configurable, and is normally a custom folder, not related to any of the special folder in the enumerator.</p>\n\n<p>How can I show a folder browser with the root assigned to a custom folder? Maybe it's not possible with RootFolder property, but is it possible to have the same effect by other means (i.e. user can't view or select outside the root folder). In <a href=\"http://stackoverflow.com/a/1451174/385387\">this answer</a>, somebody hinted that it might be possible using reflection manipulation, but there was no update. Any idea if this is possible in .NET?</p>\n"},{"tags":["c#","winforms","combobox"],"answer_count":5,"favorite_count":4,"up_vote_count":8,"down_vote_count":0,"view_count":37573,"score":8,"question_id":3063320,"title":"ComboBox: Adding Text and Value to an Item (no Binding Source)","body":"<p>In C# WinApp, how can I add both Text and Value to the items of my ComboBox?\nI did a search and usually the answers are using \"Binding to a source\".. but in my case I do not have a binding source ready in my program...\nHow can I do something like this:</p>\n\n<pre><code>combo1.Item[1] = \"DisplayText\";\ncombo1.Item[1].Value = \"useful Value\"\n</code></pre>\n"},{"tags":["c#","winforms","setup-project"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12949348,"title":"Setup project with two exe","body":"<p>I have one setup project which have custom install action which will install one winform application and one third party exe file. when i install the setup project both will execute and install in to my system. but my problem is when I'm again installing the setup project i need to check is that third party software is already in my system or not? if there then i need to install that winform only. is there any way to do this.? Please help..</p>\n\n<p>Now my solution contain one winform application project having one form which display a welcome label. i added one setup project and add the winform application as project output. then added the custom actions,there i selected the primary output from winform and the third party exe. this much i have done. but i don't know where to write my conditions to satisfy the above described scenario.</p>\n"},{"tags":["c#","winforms","devexpress"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3294,"score":0,"question_id":10147139,"title":"Adding rows to DevExpress GridView","body":"<p>Can someone please help me with this? Why is this so hard when it is so simple for the regular GridView.</p>\n\n<p>I am trying to add rows programmatically. In the normal GridView I would just call the gridView.Rows and add from there, but I can't find that option here.</p>\n\n<p>I tried creating a DataTable and then bind it to it, like so:</p>\n\n<pre><code>        DataTable dt = new DataTable();\n        dt.Columns.Add(\"IP\", Type.GetType(\"System.String\"));\n        dt.Columns.Add(\"Port\", Type.GetType(\"System.String\"));\n        dt.Columns.Add(\"Username\", Type.GetType(\"System.String\"));\n        dt.Columns.Add(\"Password\", Type.GetType(\"System.String\"));\n        dt.Columns.Add(\"Working?\", Type.GetType(\"System.Boolean\"));\n\n        for (int i = 0; i &lt; 20; i++)\n        {\n                        DataRow dr = dt.NewRow();\n                        dr[0] = \"Test\";\n                        dr[1] = \"Test\";\n                        dr[2] = \"Test\";\n                        dr[3] = \"Test\";\n                        dr[4] = true;\n                        dt.Rows.Add(dr);\n        }\n\n\n        gcProxies.DataSource = dt;\n</code></pre>\n\n<p>All this did was add empty rows the the GridControl.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["c#",".net","winforms","mschart"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1097,"score":0,"question_id":10997701,"title":"Why does auto Zoom/Scroll not work for my Chart?","body":"<p>to make it short I checked on the <strong>\"WinFormsChartSamples\"</strong> provided by Microsoft. What I wanted to know is how to enable zooming and scrolling for Chartcontrols. The example which is shown there is pretty short.</p>\n\n<pre><code>using System.Windows.Forms.DataVisualization.Charting;\n...\n\n// Set automatic zooming\nchart1.ChartAreas[\"Default\"].AxisX.ScaleView.Zoomable = true;\nchart1.ChartAreas[\"Default\"].AxisY.ScaleView.Zoomable = true;\n\n// Set automatic scrolling \nchart1.ChartAreas[\"Default\"].CursorX.AutoScroll = true;\nchart1.ChartAreas[\"Default\"].CursorY.AutoScroll = true;\n\n...\n</code></pre>\n\n<p>I tried this and nothing happened, no zooming and no scrolling. I tried two things:</p>\n\n<ol>\n<li><p>In Form1.Designer.cs I added that information to the chart.</p>\n\n<pre><code>    chartArea1.Name = \"ChartArea1\";\n    chartArea1.CursorX.AutoScroll = true;\n    chartArea1.CursorY.AutoScroll = true;\n\n    chartArea1.AxisX.ScaleView.Zoomable = true;\n    chartArea1.AxisY.ScaleView.Zoomable = true;\n\n    this.chart1.ChartAreas.Add(chartArea1);\n    this.chart1.Cursor = System.Windows.Forms.Cursors.Cross;\n    legend1.Name = \"Legend1\";\n    this.chart1.Legends.Add(legend1);\n    this.chart1.Location = new System.Drawing.Point(297, 62);\n    this.chart1.Name = \"chart1\";\n    series1.ChartArea = \"ChartArea1\";\n    series1.Legend = \"Legend1\";\n    series1.Name = \"Series1\";\n    this.chart1.Series.Add(series1);\n    this.chart1.Size = new System.Drawing.Size(963, 668);\n    this.chart1.TabIndex = 6;\n    this.chart1.Text = \"chart1\";\n</code></pre></li>\n<li><p>I tried to add it directly into the constructor in Form1.cs.</p></li>\n</ol>\n\n<p>Perhaps it is important to mention that I am using OpenFileDialog in order to add data to the series:</p>\n\n<pre><code>private void openToolStripMenuItem_Click(object sender, EventArgs e)\n        {\n\n            Stream fileStream = null;\n            OpenFileDialog fDialog = new OpenFileDialog();\n            fDialog.Title = \"Open File..\";\n            //First the description of the file separated by \"|\"\n            fDialog.Filter = \"((ASC files)| *.asc\";\n            fDialog.InitialDirectory = @\"C:\\\";\n\n            //Show Messagebox if the file was loaded (Source: MSDN - FileDialog.FilterProperty)\n            if (fDialog.ShowDialog() == DialogResult.OK)\n            {\n                MessageBox.Show(\"The File was loaded successfully.\");\n\n                try\n                {\n                    if ((fileStream = fDialog.OpenFile()) != null)\n                    {\n                        using (fileStream)\n                        {\n                            //Insert code for reading the stream here.\n                            Spectrum newSpectrum = new Spectrum(chart1.Series.Count, fDialog.FileName,\n                               fDialog.SafeFileName, DataHandler.readSpectrumFromFile(fileStream));\n\n                            addSpectrumToView(newSpectrum);\n\n                        }\n                    }\n                }\n                catch (Exception ex)\n                {\n                    MessageBox.Show(ex.Message);\n                }\n\n            }\n        }\n</code></pre>\n\n<p>Any advice is welcome, thanks in advance,</p>\n\n<p>BC++</p>\n"},{"tags":["c#","winforms","udp","listener"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12946792,"title":"How should I approach to catch UDP packets server creation","body":"<p>I am working on my application and one of the components that I need is the server that would listen on port 9494 for UDP packets.\nThen I would have to parse these packets.</p>\n\n<p>I have never done this before; could you please point me to the right direction so I could write the \"listener\"?</p>\n\n<p>For TCP I can do <code>this.listener = new TcpListener(IPAddress.Any, port);</code> ; what aout the UDP ?</p>\n"},{"tags":[".net","winforms","datagridview","datagridviewtextboxcell"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1114,"score":0,"question_id":8750295,"title":"how to get the editing control of datagridview/datagridviewcell?","body":"<p>I have a datagridviewcell with textbox as the control hosted by it. Now how do I get the type of control programmatically in other parts of my code? </p>\n\n<p>I add the column like this: </p>\n\n<pre><code>DataGridViewTextBoxColumn col = new DataGridViewTextBoxColumn();\ncol.ReadOnly = false;\ncol.Name = \"Status\";\ncol.HeaderText = \"Status\";\ndgv.Columns.Add(col);\n</code></pre>\n\n<p>All the cells in that column now will have a textbox. I can get the control as a textbox like this: </p>\n\n<pre><code>private void dgv_EditingControlShowing(object sender, DataGridViewEditingControlShowingEventArgs e)\n{\n    if (dgv.CurrentCell.ColumnIndex == 5 &amp;&amp; e.Control is TextBox)\n    {\n         //something\n    }\n}\n</code></pre>\n\n<p>How do I get the type of control hosted in the cell elsewhere? How to get <code>e.Control</code> from other parts of code so that I can do things like:</p>\n\n<pre><code>((TextBox)dgv[i, j].EditinControl).AutoCompleteSource = AutoCompleteSource.CustomSource;\n((TextBox)dgv[i, j].EditinControl).AutoCompleteCustomSource = someSource;\n((TextBox)dgv[i, j].EditinControl).AutoCompleteMode = AutoCompleteMode.SuggestAppend;\n</code></pre>\n\n<p>etc. What can substitute for <code>EditinControl</code> in the above line.. ??</p>\n"},{"tags":["c#","winforms","forms","login","event-handling"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":87,"score":1,"question_id":12946826,"title":"Using a value to open one form while in another","body":"<p>I'm stuck on what code to write for an application I need to start. I'm using C# 2010 express, with multiple Windows forms.</p>\n\n<p>The idea is the application opens with <strong>Form1</strong> which asks if I want to '<em>login</em>' or '<em>register</em>' (via buttons).</p>\n\n<p>Both these buttons open the same window (<strong>Form2</strong>) asking for login details (I know it's stupid but that's what I was told). At the moment I'm not concerned with checking the User/Pass against anything. There are two radio buttons as well, '<em>client</em>' and '<em>student</em>'.</p>\n\n<p>Finally there is a button 'continue' which will open either <strong>Form3</strong> if I clicked '<em>login</em>', or <strong>Form4</strong> if I clicked '<em>register</em>' (and giving focus to a TabControl based on with radio was checked).</p>\n\n<p>Any help would be appreciated.</p>\n"},{"tags":["winforms","usercontrols"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":26,"score":4,"question_id":12946418,"title":"How to expose whole sub control of usercontrol at winforms designer","body":"<p>For example \nI want to create a usercontrol(windows form) that contains a lable and a textbox .\nAnd I want to expose the two sub control as property , so that I can \nset  the sub control's property in client  form designer.</p>\n\n<p>so the code maybe like this :</p>\n\n<pre>\n public partial class LabelTextbox : UserControl\n    {\n        public LabelTextbox()\n        {\n            InitializeComponent();\n        }\n\n        [\n           Category(\"Appearance\"),\n           Browsable(true),\n           Description(\"innerLabel\")\n        ]\n        public DevComponents.DotNetBar.LabelX LabelPart\n        {\n            get\n            {\n                return this.labelx;\n            }\n\n            set\n            {\n                this.labelx = value;\n            }\n        }\n\n\n        [\n           Category(\"Appearance\"),\n           Browsable(true),\n           Description(\"InnerTextbox\")\n        ]\n        public TextBox TextBoxPart\n        {\n            get\n            {\n                return this.textboxx;\n            }\n\n            set\n            {\n                this.textboxx = value;\n            }\n        }\n    }\n</pre>\n\n<p>and then I can see it in designer , it looks like :</p>\n\n<p><img src=\"http://i.stack.imgur.com/foNMb.png\" alt=\"enter image description here\"></p>\n\n<p>but when I set the usercontrol's inner label property in designer ,\nit can't make relation code in the designer.cs .\nthat's to say the client settings not be saved .</p>\n\n<p>so how can I resolve this problem.</p>\n\n<p>By the way I come from CN my English is poor . Anyone can answer me.</p>\n"},{"tags":["c#","winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":28,"score":-1,"question_id":12946474,"title":"Window Form : Messages Board (Discussion Board) on C#","body":"<p>i just want to create a Message Board for everyone save their note, idea...\nThis is window application</p>\n\n<p>Which control do you think is best to create Message Board ?</p>\n\n<p>I already use RichTextBox but it have some problem when i'm attach LinkLabel to them (The location of linklabel is not dynamic chance)</p>\n\n<p>Thank in advance</p>\n"},{"tags":["winforms","exception","active-directory","code-access-security","user-roles"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12940615,"title":".NET Security Exception only in external code","body":"<p>I am using VS2012 with VB.NET for a winfowms app, using Active Directory roles. \nRunning the program as a user without permissions, I am getting an (expected) security exception when trying to launch this form. </p>\n\n<p>I have a form that looks like this:</p>\n\n<pre><code>&lt;PrincipalPermission(SecurityAction.Demand, Role:=Security.Roles.ADMINISTRATORS)&gt; _\n&lt;PrincipalPermission(SecurityAction.Demand, Role:=Security.Roles.CORRECTIVE_ACTION_EDITORS)&gt; _\n&lt;PrincipalPermission(SecurityAction.Demand, Role:=Security.Roles.GRIEVANCE_EDITORS)&gt; _\n&lt;PrincipalPermission(SecurityAction.Demand, Role:=Security.Roles.ABOLISHMENT_EDITORS)&gt; _\nPublic Class EmployeeInformationForm\n...\nEnd Class\n</code></pre>\n\n<p>The call to the code looks like this:</p>\n\n<pre><code>    Private Sub SendEmployeeIDToEmployeeInformationForm(ByVal ID_in As String, ByVal employeeRecord_in As String)\n    ...\n        If Not formFound Then\n            ' Create a new instance of the child form.\n            Dim ChildForm As New EmployeeInformationForm(ID_in, employeeRecord_in) ' ** throws expected security exception here**\n            Try\n                ' Make it a child of this MDI form before showing it.\n                ChildForm.MdiParent = Me.MdiParent\n        ...\n                ChildForm.Show()\n            Catch ex As Exception\n                ChildForm.Close()\n                Throw\n            End Try\n        End If\n</code></pre>\n\n<p><del>After 15 or 16 attempts (or maybe the variable is \"after about 1 minute\"?) the program crashes. </del> \nUPDATE: after more input of any kind the program crashes. I have <a href=\"http://stackoverflow.com/questions/1287099/runas-a-different-user-when-debugging-in-visual-studio/12923052#12923052\">debugged the code as the user</a> without permissions, and was able to capture the exception being thrown - apparently from nowhere. It is very weird saying \"The call stack contains only external code\", and displays the following:</p>\n\n<pre><code>This thread is stopped with only external code frames on the call stack. External code frames are typically from framework code but can also include other optimized modules which are loaded in the target process.\n\nCall stack with external code\n\nmscorlib.dll!System.Security.Permissions.PrincipalPermission.ThrowSecurityException()\nmscorlib.dll!System.Security.Permissions.PrincipalPermission.Demand()\nmscorlib.dll!System.Security.PermissionSet.DemandNonCAS()\n[Native to Managed Transition]\n[Managed to Native Transition]\nOHRC Database.exe!OHRC_Database.EmployeeInformationForm.Dispose(Boolean disposing)\nSystem.dll!System.ComponentModel.Component.Finalize()\n</code></pre>\n\n<p>It seems to imply it is having a hard time closing the form? Can anyone tell me why it is throwing this exception?</p>\n"},{"tags":["c#","winforms","multithreading","enterprise-library"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":56,"score":3,"question_id":12938709,"title":"Performance tuning delimited file read and writes to the database","body":"<p>I am in need of help speeding up my app please. The application reads about 53,000 lines of delimited records, parses each row, and then proceeds to send each row to the database to be written. So far, I have identified the Database end as the major bottleneck,and I would appreciate help tuning this up please. Currently, it takes about 20 minutes to process all the records(53,000) with 190 fields each, I would like to significantly reduce that number starting with the code that sends the data to the database.</p>\n\n<p>I use Enterprise Library 5, taking advantage of connection pooling there) to connect to the db like so </p>\n\n<pre><code>   internal void SaveItem(String connString)\n    {\n        try\n        {\n            ImportDataAccessor dbacess = new ImportDataAccessor(connString);\n\n            foreach (ItemDetail item in itemEZdetails)\n            {\n                if (dbacess.SaveProduct(RecordID, item))\n                {\n                    updatecounter++;\n                }\n            }\n            successfulsaves = dbacess.RowsProcessed;\n            updatecounter = dbacess.TotalRows;\n        }\n        catch (Exception ex)\n        {\n            throw ex;\n        }\n    }\n\n\npublic bool SaveProduct(String RecordUID, ItemDetail item)\n{\n //. . . . start function here\n DbCommand insertCommand = db.GetStoredProcCommand(\"IDW_spEZViewRecordImport\");\n db.AddInParameter(insertCommand, \"SessionUID\", DbType.String, recordUID);\n  // the other 189 Parameters go here \n        int rowsAffected = db.ExecuteNonQuery(insertCommand);\n                   // Object sreturnval = (String)db.GetParameterValue(insertCommand, \"ReturnVal\");\n                    String returnval = String.Empty;\n                    if ( ! (db.GetParameterValue(insertCommand, \"ReturnVal\") == DBNull.Value))\n                        returnval = (String)db.GetParameterValue(insertCommand, \"ReturnVal\");\n                    if (returnval == \"60\")\n                        RowsProcessed++;\n                    result = rowsAffected &gt; 0;\n}\n//end of line add\n</code></pre>\n\n<p>How do I achieve this with the code I have now. Thanks in advance. </p>\n"},{"tags":["winforms","excel","datagridview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2505,"score":0,"question_id":907986,"title":"DataGridView Copy Paste (with style, background color, ...)","body":"<p>I have a C# Windows Form Application with a DataGridView.</p>\n\n<p>Copy &amp; Paste (ctrl-c after selecting the data in the datagrid and ctrl-v in Excel) is working almost fine. </p>\n\n<p>The problem is that the style (such as background color) is not being pasted in Excel, only the cell values. Do I need to change a property somewhere on my datagridview or implement custom code?</p>\n\n<p>Thanks,</p>\n"},{"tags":["c#","winforms","windows-mobile","compact-framework"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":98,"score":0,"question_id":12927108,"title":"Multiple forms or one form and add controls","body":"<p>I am creating a windows mobile application that has several different screens. At the bottom of each screen is a menu bar which the user can click on to navigate each screen.</p>\n\n<p>My question is should I use a new form for each screen and clone the menu or use one form and have all the other screens as a control and add them to the main form?</p>\n\n<p>Cheers</p>\n"},{"tags":["c#","winforms","listbox"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":108,"score":1,"question_id":12936647,"title":"How do i add same string to a ListBox in some lines?","body":"<p>In the top of the Form i have:</p>\n\n<pre><code>string[] data;\nColor []color;\n</code></pre>\n\n<p>In the constructor:</p>\n\n<pre><code>color = new Color[1] { Color.Red};\n</code></pre>\n\n<p>Then i have a function i load in the constructor:</p>\n\n<pre><code>private void ListBoxLoadKeys(Dictionary&lt;string,List&lt;string&gt;&gt; dictionary, \n    string FileName)\n{\n    string line = System.String.Empty;\n    using (StreamReader sr = new StreamReader(keywords))\n    {\n        while ((line = sr.ReadLine()) != null)\n        {\n            int i = line.Count();\n            tokens = line.Split(',');\n            dictionary.Add(tokens[0], tokens.Skip(1).ToList());\n            // listBox1.Items.Add(\"Url: \" + tokens[0] + \" --- \" \n                + \"Localy KeyWord: \" + tokens[1]);     \n            data = new string[1] { \"Url: \" + tokens[0] + \" --- \" \n                + \"Localy KeyWord: \" + tokens[1]};\n            listBox1.DataSource = data;\n        }           \n    }        \n}\n</code></pre>\n\n<p>But its adding to the ListBox only once one lines.\nI want it to be like listbox1.Items.Add then its adding all the lines from the text file to the listBox.</p>\n\n<p>Then im coloring the lines in Red:</p>\n\n<pre><code>private void listBox1_DrawItem(object sender, DrawItemEventArgs e)\n{\n    e.DrawFocusRectangle();\n    e.Graphics.DrawString(data[e.Index], new Font(FontFamily.GenericSansSerif, 8,\n        FontStyle.Regular),new SolidBrush(color[e.Index]), e.Bounds);\n}\n\nprivate void listBox1_MeasureItem(object sender, MeasureItemEventArgs e)\n{\n    e.ItemHeight = 16;\n}\n</code></pre>\n\n<ol>\n<li><p>how can i add all the lines from the StreamReader instead using Items.Add but using DataSource ?</p></li>\n<li><p>How can i color in Red only the word \"Url: \" i have this line:</p>\n\n<blockquote>\n  <p>data = new string[1] { \"Url: \" + tokens[0] + \" --- \" + \"Localy KeyWord: \" + tokens[1]};</p>\n</blockquote></li>\n</ol>\n\n<p>And i want it to add all the lines from the text file and each line to color only the word \"Url: \"</p>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":108,"score":0,"question_id":12715276,"title":"Pluggable UI Components for Windows Form Application?","body":"<p>Our application contains many modules which could be dynamically pushed to the our application after it is installed and running. All those modules might require some display at the UI.  So I am thinking that we could build a UI exe which could load UI component from a DLL (or any other type of assembly). Let's say module1 and module2 are active at the machine, we would display a \"module1\" and \"module2\" at the left frame of the UI. If user clicks on \"module1\", the right frame would open the screen for module1 which is loaded from the another assembly (such as DLLs) which is pushed down together with module1.</p>\n\n<p>Just wonder if this pluggable UI architecture is even possible at the Windows Form or not. I did some search on internet and I didn't find any useful information around this.</p>\n"},{"tags":["winforms","c#-4.0","visual-studio-2012","sqlconnection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12942519,"title":"Optimal way to set a global in a Winfrom for a SqlConnection","body":"<p>I want to create a winfrom that connect to a database to do things.  It's going to have to connect when it opens and then based on what the user clicks, makes queries.  I'm not 100% sure what the best course is to open the connection when it loads and make that connection able to be accessed from all the different classes.  I have made a test run to get the connection working that opens the DB connection when the user click the button then makes it's query but I'd like to move the opening of the DB connection to the InitializeComponent() part and then from the components just call to the connection already made.  </p>\n\n<p>I have set this up so that it's run on a case by case but is there a better way to do this?  I'm I doing it that only way you can/should?</p>\n\n<p>Here is the test</p>\n\n<p>Form1.Designer.cs</p>\n\n<pre><code>namespace end_of_day\n{\n    using System.Data.SqlClient;\n    partial class Form1\n    {\n        /// &lt;summary&gt;\n        /// Required designer variable.\n        /// &lt;/summary&gt;\n        private System.ComponentModel.IContainer components = null;\n\n\n        /// &lt;summary&gt;\n        /// Clean up any resources being used.\n        /// &lt;/summary&gt;\n        /// &lt;param name=\"disposing\"&gt;true if managed resources should be disposed; otherwise, false.&lt;/param&gt;\n        protected override void Dispose(bool disposing)\n        {\n            if (disposing &amp;&amp; (components != null))\n            {\n                components.Dispose();\n            }\n            base.Dispose(disposing);\n        }\n\n        #region Windows Form Designer generated code\n\n        /// &lt;summary&gt;\n        /// Required method for Designer support - do not modify\n        /// the contents of this method with the code editor.\n        /// &lt;/summary&gt;\n        private void InitializeComponent()\n        {\n            this.button1 = new System.Windows.Forms.Button();\n            this.label1 = new System.Windows.Forms.Label();\n            this.button2 = new System.Windows.Forms.Button();\n            this.button3 = new System.Windows.Forms.Button();\n            this.button4 = new System.Windows.Forms.Button();\n            this.SuspendLayout();\n            // \n            // button1\n            // \n            this.button1.Location = new System.Drawing.Point(78, 411);\n            this.button1.Name = \"button1\";\n            this.button1.Size = new System.Drawing.Size(147, 64);\n            this.button1.TabIndex = 0;\n            this.button1.Text = \"Test\";\n            this.button1.UseVisualStyleBackColor = true;\n            this.button1.Click += new System.EventHandler(this.button1_Click);\n            // \n            // label1\n            // \n            this.label1.AutoSize = true;\n            this.label1.Location = new System.Drawing.Point(13, 13);\n            this.label1.Name = \"label1\";\n            this.label1.Size = new System.Drawing.Size(199, 13);\n            this.label1.TabIndex = 1;\n            this.label1.Text = \"ERROR: didn\\'t connect to the database.\";\n            // \n            // button4\n            // \n            this.button4.Location = new System.Drawing.Point(78, 201);\n            this.button4.Name = \"button4\";\n            this.button4.Size = new System.Drawing.Size(147, 64);\n            this.button4.TabIndex = 4;\n            this.button4.Text = \"Print Out of Stock\";\n            this.button4.UseVisualStyleBackColor = true;\n            this.button4.Click += new System.EventHandler(this.button4_Click);\n            // \n            // Form1\n            // \n            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);\n            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;\n            this.ClientSize = new System.Drawing.Size(306, 523);\n            this.Controls.Add(this.button4);\n            this.Controls.Add(this.button3);\n            this.Controls.Add(this.button2);\n            this.Controls.Add(this.label1);\n            this.Controls.Add(this.button1);\n            this.Name = \"Form1\";\n            this.Text = \"End of day\";\n            this.ResumeLayout(false);\n            this.PerformLayout();\n\n        }\n\n        #endregion\n\n        private System.Windows.Forms.Button button1;\n        private System.Windows.Forms.Label label1;\n        private System.Windows.Forms.Button button4;\n        // NOTE I NEED TO BE ABLE TO CHANGE THE LABEL FROM OTHER CLASSES FIX THIS SOMEHOW\n    }\n}\n</code></pre>\n\n<p>Form1.cs</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Windows.Forms;\nusing System.Data.SqlClient;\nusing System.Net.Mail;\n\nnamespace end_of_day\n{\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        private void button1_Click(object sender, EventArgs e)\n        {\n            SqlConnection myConnection = quries.create_concection();\n            try\n            {\n                SqlDataReader myReader = null;\n                SqlCommand myCommand = new SqlCommand(\"SELECT TOP 100000 ItemName,Price,In_Stock,Vendor_Part_Num FROM Inventory\",\n                                                         myConnection);\n                myReader = myCommand.ExecuteReader();\n\n                String mess = \"\";\n                int i = 0;\n                while (myReader.Read())\n                {\n                    if (i &lt; 10)\n                    {\n\n                        mess += myReader[\"ItemName\"].ToString();\n                        mess += myReader[\"Price\"].ToString();\n                        mess += \"\\r\\n\";\n                    }\n                    i++;\n                }\n            }\n            catch (Exception er)\n            {\n\n                DialogResult dlgRes = MessageBox.Show(er.ToString(), \"Error\",  MessageBoxButtons.YesNoCancel, MessageBoxIcon.Question); \n\n            }\n\n        }\n\n        private void button4_Click(object sender, EventArgs e)\n        {\n            SqlConnection myConnection = quries.create_concection();\n\n            DialogResult dlgRes = MessageBox.Show(\"Exculde Videos?\",\n                 \"Options\",\n                MessageBoxButtons.YesNoCancel,\n                 MessageBoxIcon.Question);\n\n            String SQL_op = \"\";\n            if (dlgRes == DialogResult.Yes)\n            {\n                SQL_op = \"AND NOT Dept_ID = 'video'\";\n            }\n\n\n            try\n            {\n\n                SqlDataReader myReader = null;\n                SqlCommand myCommand = new SqlCommand(\"SELECT TOP 100000 ItemName,Price,In_Stock,Vendor_Part_Num FROM Inventory WHERE In_Stock&lt;1 AND NOT Dept_ID = '006' \"+ SQL_op+\" ORDER BY Dept_ID\",\n                                                         myConnection);\n                myReader = myCommand.ExecuteReader();\n\n                String mess = \"\";\n                int i = 0;\n                while (myReader.Read())\n                {\n                    if (i &lt; 10)\n                    {\n\n                        mess += myReader[\"ItemName\"].ToString();\n                        mess += myReader[\"Price\"].ToString();\n                        mess += \"\\r\\n\";\n                    }\n                    i++;\n                }\n\n\n                dlgRes = MessageBox.Show(\"Had \" + i + \"items including: \\r\\n\" + mess,\n                 \"Confirm Document Close\",\n                MessageBoxButtons.YesNoCancel,\n                 MessageBoxIcon.Question);\n\n            }\n            catch (Exception er)\n            {\n\n                dlgRes = MessageBox.Show(er.ToString(), \"Error\", MessageBoxButtons.YesNoCancel, MessageBoxIcon.Question);\n\n\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>quries.cs</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Xml;\nusing System.Linq;\nusing System.Threading.Tasks;\nusing System.Windows.Forms;\nusing System.Data.SqlClient;\nusing System.Web;\n\n\nnamespace end_of_day\n{\n    public class quries\n    {\n        public static SqlConnection create_concection()\n        {\n            Boolean hasConection =true;\n            SqlConnection myConnection = new SqlConnection(\n                \"Data Source=localhost\\\\SQLEXPRESS;\" +\n                \"Trusted_Connection=true;\" +\n\n                \"Initial Catalog=TESTDB; \" +\n                \"connection timeout=30\"\n            );\n            try\n            {\n                myConnection.Open();\n            }\n\n                catch (Exception er)\n                {\n                    hasConection = false;\n                    DialogResult dlgRes = MessageBox.Show(er.ToString(), \"Error\", MessageBoxButtons.YesNoCancel, MessageBoxIcon.Question);\n                }\n\n\n            if (hasConection) {\n                // THIS SHOULD CHANGE THE LABEL OF THE MAIN FORM\n                //Form1 form = new Form1();\n                //form.MyMessage = \"made it\"; \n            }\n            return myConnection;\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","winforms","tablelayoutpanel"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":12939322,"title":"TableLayoutPanel fill top-to-bottom instead of left-to-right?","body":"<p>Is it possible to have a <code>System.Windows.Forms.TableLayoutPanel</code> fill a column before moving to the next one? Regardless of how I set the <code>RowCount</code>, <code>ColumnCount</code>, and <code>GrowStyle</code>, the table is always populated like this:</p>\n\n<pre><code>1 2 3\n4 5 6\n</code></pre>\n\n<p>and I want this:</p>\n\n<pre><code>1 3 5\n2 4 6\n</code></pre>\n\n<p>Can a TableLayoutPanel not automatically do this?</p>\n\n<p>Edit - To clarify, I am adding the controls programmatically.</p>\n"},{"tags":["vb.net","winforms","foreach"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12940279,"title":"Iterate through Windows forms and close them?","body":"<p>I'm trying to use the following code to iterate over all of the currently open forms in my application and close them except for the main form as part of a clean up. </p>\n\n<pre><code>    Dim openForms As Windows.Forms.FormCollection = Application.OpenForms\n\n    For Each frm As Windows.Forms.Form In openForms\n        If frm.Name.ToString() &lt;&gt; \"FrmMainNew\" Then\n            frm.Close()\n        End If\n    Next\n</code></pre>\n\n<p>However, I'm getting an <code>InvalidOperationException</code> because when <code>frm.Close()</code> is executed, the entry that was in <code>openForms</code> is deleted, changing the size of the collection. I'm obviously doing something wrong, so if anyone can point me at the problem here, that would be awesome. Otherwise, is there another way to do something like this? </p>\n"},{"tags":["c#","winforms","visual-studio"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":69,"score":-3,"question_id":12206060,"title":"KeyEventArgs event not working","body":"<p>Why doesn't that work in VS 2010? I press \"a\" in the form after clicking on it, and nothing happens.</p>\n\n<pre><code>private void Form1_KeyDown(object sender, KeyEventArgs e)\n    {\n        if (e.KeyData == Keys.A)\n        {\n            MessageBox.Show(\"A\");\n        }\n    }\n</code></pre>\n"},{"tags":["c#","winforms","data-binding",".net-3.5"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":495,"score":4,"question_id":505215,"title":"Binding Textboxes","body":"<p>I have been binding textboxes in a winform with C# to a dataset. Whenever the data doesn't validate with what the database except it silently forces the focus to remain on the textbox. How can I catch the validation error and tell the user about it (and free the focus)? The BindingSource event OnDataError isn't fired.</p>\n"},{"tags":["c#","winforms","panel","statusstrip"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12937167,"title":"Panel in StatusStrip?","body":"<p>Is it possible to have a panel in a <code>StatusStrip</code>? <a href=\"http://msdn.microsoft.com/en-us/library/system.windows.forms.statusstrip.aspx\" rel=\"nofollow\">MSDN</a> is kind of saying so:</p>\n\n<blockquote>\n  <p>The default StatusStrip has no panels. To add panels to a StatusStrip, use the <a href=\"http://msdn.microsoft.com/en-us/library/system.windows.forms.toolstripitemcollection.addrange.aspx\" rel=\"nofollow\">ToolStripItemCollection.AddRange</a> method [...]</p>\n</blockquote>\n\n<p>... but I can't find how. </p>\n\n<p>I tried to add a <code>Panel</code> or a <code>ToolStripPanel</code> to a <code>StatusStrip</code>, but it is only accepting <code>ToolStripItem</code>s. On the other hand, I tried adding a <code>ToolStripItem</code> to a <code>Panel</code> or a <code>ToolStripPanel</code>, but both only accepts <code>Control</code>s:</p>\n\n<pre><code>ToolStripPanel toolStripPanel = new ToolStripPanel();\ntoolStripPanel.Controls.Add(toolStripStatusLabel);   // Wrong\nstatusStrip.Items.AddRange(toolStripPanel);          // Wrong again\n</code></pre>\n"},{"tags":["c#","winforms","httpwebrequest","httpwebresponse"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2301,"score":1,"question_id":2917126,"title":"Programmatically automating a web login","body":"<p>I am trying to create a C# Winforms application that will automatically log me into a site and download data. Specifically, I want to have my application automatically log into my online banking site, log me in, and download my transaction history. I can do this manually by logging in through a web browser and downloading it. I am trying to automate this. I know I probably need to use HttpWebRequest and HttpWebResponse. Does anyone have an example of this or a framework of the steps I need to take to accomplish this? Keep in mind it will be secure site (https) and I will somehow have to collect session information and retain the session information for the duration of the session. Any thoughts?</p>\n"},{"tags":["c#","xml","winforms",".net-assembly"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":68,"score":0,"question_id":12936707,"title":"Read xml files from assembly","body":"<p>I'm trying to read xml files from assembly, this is my code:</p>\n\n<pre><code>private Assembly testAssembly;\n    private void button1_Click(object sender, EventArgs e)\n    {\n        string testfile = \"stack.xml\";\n        String testfileName = string.Format(\"{0}.{1}\", testAssembly.GetName().Name, testfile);\n\n        using (Stream stream = testAssembly.GetManifestResourceStream(testfileName))\n        {\n            using (StreamReader sr = new StreamReader(stream))\n            {\n                var value = sr.ReadToEnd();\n                Console.WriteLine(\"The read file is {0}\", value);\n            }\n        }\n    }\n</code></pre>\n\n<p>I've got a problem on this line:</p>\n\n<pre><code>String testfileName = string.Format(\"{0}.{1}\", testAssembly.GetName().Name, \n                                     testfile); \n</code></pre>\n\n<p>Null ref exception unhandled, it says null. Any help???\n    <img src=\"http://i.stack.imgur.com/bZqse.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","winforms","crystal-reports-xi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12897380,"title":"Preview Crystal Report on a separate form","body":"<p>I have a form that allows a user to select what report they want to generate. They can also select criteria, select Print, Preview, export, etc.   After the user makes their selections and clicks the \"Generate\" button, I have a class that creates the report object, loads the report, dataset, and then prints or exports the report.  I created a separate form to preview the report.  When I pass the report object to the preview form, I receive \"Invalid Report Source.\"  The report prints and exports just fine, I just cannot preview the report.  I do not want to duplicate the code in the preview form, I was hoping that I could just pass the report object.  Snippets of my code are below.  Any suggestions?</p>\n\n<pre><code>public static class CrystalReportUtilities\n{\n    private static ReportDocument goReport {get; set;}\n    private static string gsReportName { get; set; }\n    private static string gsSqlString { get; set; }\n    private static object[,] goParameters { get; set; }\n\n    public static void generateReport(parameters...)\n    {\n      goReport = loadReport();\n...\n      goReport.SetDataSource(DataTable);\n...\n      previewReport();\n\n\n    private static void previewReport()\n    {\n        CrystalReportPrintPreviewForm loReportPreview = new CrystalReportPrintPreviewForm(goReport);\n        loReportPreview.ShowDialog();\n    }\n\n\npublic partial class CrystalReportPrintPreviewForm : Form\n{\n    private ReportDocument goReport;\n\n    public CrystalReportPrintPreviewForm(ReportDocument poReport)\n    {\n        InitializeComponent();\n\n        goReport = poReport;\n    }\n\n    private void crystalReportViewer1_Load(object sender, EventArgs e)\n    {\n        try\n        {\n            if (goReport != null)\n            {\n                crystalReportViewer1.ReportSource = goReport;  // Receive \"Invalid Report Source\"\n            }\n        }\n</code></pre>\n"},{"tags":["c#","winforms","updatepanel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12937028,"title":"Updating tablelayoutpanel","body":"<p>I have tablelayoutpanel on a splitcontainer panel, which is dynamically filled components at runtime. Components have a minimum size and DockStyle is Fill. On resize event i remap the column and row styles, but it does not give the desired result (table cells become smaller than the size of the components and when the number of components of the cell size does not accept the minimum amount of components). The problem is that it is not known in advance how many rows will be. How to properly update tablelayoutpanel????</p>\n"},{"tags":["vb.net","winforms","linq","vb.net-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12936574,"title":"What is wrong with this LINQ code?","body":"<p>First, I have function to flatten all controls on a <code>Control</code>:</p>\n\n<pre><code>Protected Function GetAllControls(Optional ownerControl As Control = Nothing) As IEnumerable(Of Control)\n\n    Dim ret = New List(Of Control)()\n    For Each child As Control In If(ownerControl, Me).Controls\n        ret.AddRange(GetAllControls(child))\n    Next\n    ret.Add(ownerControl)\n    Return ret\n\nEnd Function\n</code></pre>\n\n<p>Then, I want to hide certain buttons on a control using this code:</p>\n\n<pre><code>Dim buttons = GetAllControls().Where(Function(c) c.Name.StartsWith(\"subButton\"))\nFor Each ctrl As Control In buttons\n    ctrl.Visible = False\n    Debug.WriteLine(\"Hid button \" &amp; ctrl.Name)\nNext\n</code></pre>\n\n<p>Yet, after four buttons - the correct count - have been hidden, I get a <code>NullReferenceException</code>, with VS2012 highlighting the lambda expression. </p>\n\n<p>What could possibly cause this?</p>\n"},{"tags":["c#","winforms","bitmap","zoom","mouseevent"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12936173,"title":"Zoom Out by reversing Zoom In Mouse","body":"<p>I have a block of code which is executed on a C# Windows Form upon Mouse_Up. It basically zooms in on a rendered image and keeps zooming in each time the rubber band is drawn. I want to reverse this by adding a checkbox (which I have already done) and if the check box is ticked, do zooming out instead from the current view as per drawing of the rubber band. I thought it would be as simple as using the opposite operands i.e \"+\" instead of a \"-\" but it won't work. I have posted the event code below. There is a conditional IF on there for changing of the checkbox state. The first lot work fine with zooming in. The section after the ELSE IF doesn't let me zoom out - hence I have just left repeated code there for someone to look at. Thanks</p>\n\n<pre><code>private void Form1_MouseUp(object sender, MouseEventArgs e)\n    {\n        if (checkBox1.Checked == false)\n        {\n            int z, w;\n            this.Cursor = Cursors.Arrow;\n            // Set internal flag to know we no longer \"have the mouse\".\n            weHaveMouse = false;\n            // If we have drawn previously, draw again in that spot\n            // to remove the lines.\n            if (ptLast.X != -1)\n            {\n                toolStripStatusLabel1.Text = \"Please click and drag to zoom into the Fractal\";\n                Point ptCurrent = new Point(e.X, e.Y);\n                MyDrawReversibleRectangle(ptOriginal, ptLast);\n            }\n            // Set flags to know that there is no \"previous\" line to reverse.\n            ptLast.X = -1;\n            ptLast.Y = -1;\n            ptOriginal.X = -1;\n            ptOriginal.Y = -1;\n            //e.consume();\n            if (action)\n            {\n                xe = e.X;\n                ye = e.Y;\n                if (xs &gt; xe)\n                {\n                    z = xs;\n                    xs = xe;\n                    xe = z;\n                }\n                if (ys &gt; ye)\n                {\n                    z = ys;\n                    ys = ye;\n                    ye = z;\n                }\n                w = (xe - xs);\n                z = (ye - ys);\n                if ((w &lt; 2) &amp;&amp; (z &lt; 2)) initvalues();\n                else\n                {\n                    if (((float)w &gt; (float)z * xy)) ye = (int)((float)ys + (float)w / xy);\n                    else xe = (int)((float)xs + (float)z * xy);\n                    xende = xstart + xzoom * (double)xe;\n                    yende = ystart + yzoom * (double)ye;\n                    xstart += xzoom * (double)xs;\n                    ystart += yzoom * (double)ys;\n                }\n                xzoom = (xende - xstart) /(double)x1;\n                yzoom = (yende - ystart) / (double)y1;\n                mandelbrot();\n                rectangle = false;\n                //Refresh();\n            }\n        }\n        else if (checkBox1.Checked == true)\n        {\n            int z, w;\n            this.Cursor = Cursors.Arrow;\n            // Set internal flag to know we no longer \"have the mouse\".\n            weHaveMouse = false;\n            // If we have drawn previously, draw again in that spot\n            // to remove the lines.\n            if (ptLast.X != -1)\n            {\n                toolStripStatusLabel1.Text = \"Please click and drag to zoom into the Fractal\";\n                Point ptCurrent = new Point(e.X, e.Y);\n                MyDrawReversibleRectangle(ptOriginal, ptLast);\n            }\n            // Set flags to know that there is no \"previous\" line to reverse.\n            ptLast.X = -1;\n            ptLast.Y = -1;\n            ptOriginal.X = -1;\n            ptOriginal.Y = -1;\n            //e.consume();\n            if (action)\n            {\n                xe = e.X;\n                ye = e.Y;\n                if (xs &gt; xe)\n                {\n                    z = xs;\n                    xs = xe;\n                    xe = z;\n                }\n                if (ys &gt; ye)\n                {\n                    z = ys;\n                    ys = ye;\n                    ye = z;\n                }\n                w = (xe - xs);\n                z = (ye - ys);\n                if ((w &lt; 2) &amp;&amp; (z &lt; 2)) initvalues();\n                else\n                {\n                    if (((float)w &gt; (float)z * xy)) ye = (int)((float)ys + (float)w / xy);\n                    else xe = (int)((float)xs + (float)z * xy);\n                    xende = xstart + xzoom * (double)xe;\n                    yende = ystart + yzoom * (double)ye;\n                    xstart += xzoom * (double)xs;\n                    ystart += yzoom * (double)ys;\n                }\n                xzoom = (xende - xstart) / (double)x1;\n                yzoom = (yende - ystart) / (double)y1;\n                mandelbrot();\n                rectangle = false;\n                //Refresh();\n            }\n        }\n\n    }\n</code></pre>\n"},{"tags":[".net","winforms","crystal-reports"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":50,"score":-4,"question_id":12932285,"title":"Any alternative for subreports in Crystal Reports","body":"<p>I have a 1-to-many relationship in my report. I used sub-reports to handle this situation but the reports became so slow that they were unusable. I want to know if there is any alternative to sub-reports in Crystal Reports that can be used to handle a 1-to-many relationship.</p>\n"},{"tags":["c#","winforms","custom-controls","propertygrid","design-time"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":80,"score":1,"question_id":12934183,"title":"How can edit field of an Expandable Property in the property grid?","body":"<p>I created a custom control with several properties. I add some expandable property to my custom control. Now, I want that user can edit expandable property field in the property grid and new entered values set for their related properties. My expandable property in the property grid is \"Required Sign\" and has two sub properties as follows:</p>\n\n<ol>\n<li><p>ForeColor</p></li>\n<li><p>Visible</p></li>\n</ol>\n\n<p>I set two sub properties' values of the \"Required Sign\" expandable property to the field of the \"Required Sign\" property as you can see in the following figure:</p>\n\n<p><img src=\"http://i.stack.imgur.com/p09zy.jpg\" alt=\"&quot;Required Sign&quot; expandable property\"></p>\n\n<ol>\n<li><p>Green Box: \"Required Sign\" Expandable Property</p></li>\n<li><p>Blue Box: Two sub properties of the \"Required Sign\" Expandable Property</p></li>\n<li><p>Red Box: Field of the \"Required Sign\" Expandable Property</p></li>\n</ol>\n\n<p>However, I can't change or edit field values of the \"Required Sign\" expandable property directly. How can I change or edit field values of expandable property (Red Box in the figure)?</p>\n\n<p>My codes as follows:</p>\n\n<pre><code>[DisplayName(\"Label Information\")]\n[Description(\"Label Informationnnnnnnnnnnnnnnn\")]\n[DefaultProperty(\"Text\")]\n[DesignerCategory(\"Component\")]\n[TypeConverter(typeof(AllFloorsContentsLabelInformationTypeConverter))]\npublic class AllFloorsContentsLabelInformation : LabelX\n{\n    private AllFloorsContentsLabelRequiredSignInformation allFloorsContentsLabelRequiredSignInformation = new AllFloorsContentsLabelRequiredSignInformation();\n\n    public AllFloorsContentsLabelInformation()\n    {\n\n    }\n\n    [Category(\"Data\")]\n    [DisplayName(\"Required Sign\")]\n    [Description(\"Required Signnnnnnnnnnnnnnn\")]\n    [DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]\n    public AllFloorsContentsLabelRequiredSignInformation AllFloorsContentsLabelRequiredSignInfo\n    {\n        get\n        {\n            return allFloorsContentsLabelRequiredSignInformation;\n        }\n    }\n}\n\n[DisplayName(\"Required Sign Information\")]\n[Description(\"Required Sign Informationnnnnnnnnnnnnnnn\")]\n[DefaultProperty(\"Text\")]\n[DesignerCategory(\"Component\")]\n[TypeConverter(typeof(AllFloorsContentsLabelRequiredSignInformationTypeConverter))]\npublic class AllFloorsContentsLabelRequiredSignInformation\n{\n    private Color foreColor = Color.Red;\n    private ConfirmationAnswers visible = ConfirmationAnswers.Yes;\n\n    public AllFloorsContentsLabelRequiredSignInformation()\n    {\n\n    }\n\n    [Category(\"Appearance\")]\n    [DisplayName(\"ForeColor\")]\n    [Description(\"ForeColor\")]\n    [DefaultValue(typeof(Color), \"Red\")]\n    [DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]\n    public new Color ForeColor\n    {\n        get\n        {\n            return foreColor;\n        }\n        set\n        {\n            foreColor = value;\n        }\n    }\n\n    [Category(\"Behavior\")]\n    [DisplayName(\"Visible\")]\n    [Description(\"Visibleeeeeeeeeeeeeeeeee\")]\n    [DefaultValue(ConfirmationAnswers.Yes)]\n    [DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]\n    public ConfirmationAnswers Visible\n    {\n        get\n        {\n            return visible;\n        }\n        set\n        {\n            visible = value;\n        }\n    }\n}\n\npublic class AllFloorsContentsLabelRequiredSignInformationTypeConverter : ExpandableObjectConverter//TypeConverter\n{\n    public override bool CanConvertTo(ITypeDescriptorContext context, Type destinationType)\n    {\n        if (destinationType == typeof(AllFloorsContentsLabelRequiredSignInformation))\n        {\n            return true;\n        }\n        return base.CanConvertTo(context, destinationType);\n    }\n\n    public override object ConvertTo(ITypeDescriptorContext context, CultureInfo culture, object value, Type destinationType)\n    {\n        if (destinationType == typeof(String) &amp;&amp; value is AllFloorsContentsLabelRequiredSignInformation)\n        {\n            AllFloorsContentsLabelRequiredSignInformation allFloorsContentsLabelRequiredSignInformation = (AllFloorsContentsLabelRequiredSignInformation)value;\n            return allFloorsContentsLabelRequiredSignInformation.ForeColor.ToString() + \"; \" + allFloorsContentsLabelRequiredSignInformation.Visible.ToString();\n        }\n        return base.ConvertTo(context, culture, value, destinationType);\n    }\n\n    public override bool CanConvertFrom(ITypeDescriptorContext context, Type sourceType)\n    {\n        if (sourceType == typeof(string))\n        {\n            return true;\n        }\n        return base.CanConvertFrom(context, sourceType);\n    }\n\n    public override object ConvertFrom(ITypeDescriptorContext context, CultureInfo culture, object value)\n    {\n        if (value is string)\n        {\n            AllFloorsContentsLabelRequiredSignInformation allFloorsContentsLabelRequiredSignInformation = new AllFloorsContentsLabelRequiredSignInformation();\n            string strExtractData = (string)value;\n            Color clrForeColor = Color.FromName(strExtractData.Substring(0, strExtractData.IndexOf(\";\") - 1).Trim());\n            string strVisible = strExtractData.Substring(strExtractData.IndexOf(\";\") + 1, strExtractData.Length).Trim();\n\n            allFloorsContentsLabelRequiredSignInformation.ForeColor = clrForeColor;\n            if (strVisible == \"Yes\")\n            {\n                allFloorsContentsLabelRequiredSignInformation.Visible = ConfirmationAnswers.Yes;\n            }\n            else\n            {\n                allFloorsContentsLabelRequiredSignInformation.Visible = ConfirmationAnswers.No;\n            }\n            return allFloorsContentsLabelRequiredSignInformation;\n        }\n        return base.ConvertFrom(context, culture, value);\n    }\n}\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12935392,"title":"Binding Windows Form Combobox to Anonymous Type","body":"<p>I have a <code>Dictionary&lt;string, List&lt;string&gt;&gt;</code> where string is a path to a file. I want to display the name of the File in a combo box and then use the file name as the value to capture it on <code>SelectedValueChanged</code>.</p>\n\n<pre><code>  var cmbDatasource = (from moduleReference in moduleReferences\n                       select new { FilePath = moduleReference.Key, Filename = new FileInfo(moduleReference.Key).Name }).ToList();\n  cmbModules.DataSource = cmbDatasource;\n  cmbModules.DisplayMember = \"Filename\";\n  cmbModules.ValueMember = \"FilePath\";\n</code></pre>\n\n<p>I am then doing this in my <code>SelectedValueChanged</code> event</p>\n\n<pre><code>private void cmbModules_SelectedValueChanged(object sender, EventArgs e)\n{\n  var cmb = (ComboBox)sender;\n  if (cmb != null)\n  {\n    var test = cmb.SelectedValue.ToString();\n  }\n}\n</code></pre>\n\n<p><code>test</code> now becomes the anonymous type as apose to the value member (Path).</p>\n\n<blockquote>\n  <p><a href=\"http://stackoverflow.com/questions/530482/using-selecteditem-property-of-combobox-w-linq-anonymous-type\">Using SelectedItem property of ComboBox w/Linq Anonymous Type</a></p>\n</blockquote>\n\n<p>I've looked here but can't see what I am doing differently. </p>\n\n<blockquote>\n  <h2>Example</h2>\n</blockquote>\n\n<pre><code>Dictionary&lt;string, List&lt;string&gt;&gt; moduleReferences = new Dictionary&lt;string, List&lt;string&gt;&gt;();\nmoduleReferences.Add(\"C:\\Test.txt\", new List&lt;string&gt;());\n</code></pre>\n\n<p>The combobox should display <code>Test.txt</code> however when I capture the event I expect to get the <code>C:\\Test.txt</code> to do a look up in the dictionairy. Am I doing anything wrong here?</p>\n"},{"tags":["winforms","data-binding","binding","richtextbox"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12716798,"title":"can I bind a richtextbox text property to list or array in winforms","body":"<p>I am looking to bind a richtextbox's text property to an array or list of custom objects. Is this possible? I see lots of WPF related binding for richtextbox but I am doing this in winforms. My searches for an example article have not turned up anything of value yet. Figured I would ask here.</p>\n\n<p>One of my database calls returns to me a list of specific instructions and I would like to stuff this entire list of instructions into the richtextbox all at once. The text property does not support an IEnumerable type so I am not sure if I can do what I am trying to do or not. I was looking for a method to fill my richtextbox without all the for looping and inserting one item at a time. I figured data binding was the best fit for that.</p>\n"},{"tags":["c#","winforms","opentypefont"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":539,"score":2,"question_id":5648059,"title":"Is it possible to use otf fonts on winforms?","body":"<p>I've tried using Open Type Fonts both for labels, textboxes and when drawing in a paint-event. But it doesn't work. Is there any way to make Open Type Font work?</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":12933613,"title":"ShowDialog is not getting in the MDI form","body":"<p>I am Using MDI from for doing the academic project. </p>\n\n<p>The problem with me is that I cant call the object of the form with <code>ShowDialog()</code> an exeption is thrown as shown below can anybody help to resolve this problem.</p>\n\n<p><img src=\"http://i.stack.imgur.com/oDxBr.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":12913109,"title":"Change view when using WinForm and MVC","body":"<p>As part of a school project, a group and I will develop a Windows application using C#.\nWe are not very experienced in C# but has some basic understanding for it. We do however have experience from other languages and platforms.</p>\n\n<p>We would like to build an application in which the layout is split into two primary parts: the menu, which will reside to the left and the content which will be to the right.\nThe menu will be more or less static and when an entry in the menu is chosen, the content will be changed.</p>\n\n<p>We have not been able to figure out the best way for achieving this nor have we been able to find good material on this. The idea is to have one window and add a view (as far as I can understand, this should be a UserControl?) to this window. This control will be the menu.</p>\n\n<p>Now, our question is if anyone can point us in the right direction to achieve the navigation in the program. Say, when a menu entry is clicked, how will we change the content of the window and how will we manage which view is active? I suppose that every view (in the \"content area\") will have a controller.\nWe are interested in the \"best practices\" for this when using WinForms and the MVC pattern.</p>\n\n<p>We hope that someone can help us further in this project.</p>\n"},{"tags":["vb.net","winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12934725,"title":"Got error : \"Unable to update project dependencies\" while build solution","body":"<p>In my project solution, i have two project with setup project, now when i build solution i got project dependencies error. If i close visual studio and reopen then its solved but how to solve project dependencies error without closing visual studio?</p>\n"},{"tags":["c#","winforms","visual-studio-2008","xpath"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12931422,"title":"Selecting XML Nodes with Multiple Xpaths in OneTime","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12800833/find-values-under-one-node-in-xml\">Find values under one node in XML</a>  </p>\n</blockquote>\n\n\n\n<p><strong>Sample XML File:</strong></p>\n\n<pre><code>&lt;Book&gt;\n&lt;Page id=\"1\"&gt;\n&lt;Head&gt;Preface&lt;/Head&gt;\n&lt;Body&gt;\n&lt;Paragraph&gt;\n    &lt;Line&gt;\n        &lt;Word&gt;\n            &lt;Char&gt;T&lt;/Char&gt;\n            &lt;Char&gt;h&lt;/Char&gt;\n            &lt;Char&gt;i&lt;/Char&gt;\n            &lt;Char&gt;s&lt;/Char&gt;\n        &lt;/Word&gt;\n        &lt;Word&gt;is sample xml file.&lt;/Word&gt;\n    &lt;/Line&gt;\n&lt;/Paragraph&gt;\n&lt;/Body&gt;\n&lt;/Page&gt;\n</code></pre>\n\n<p><strong>Note:</strong> Here, sample text to search is 'I'.\nFor Selection Word without having  nodes , xPath expression is:</p>\n\n<pre><code>string Word_Char_XPath=\"//CHAR[contains(translate(text(),'abcdefghijklmnopqrstuvwxyz','ABCDEFGHIJKLMNOPQRSTUVWXYZ'),'I')]/..\";\n</code></pre>\n\n<p>For selection of words having only  nodes, xPath expression is:</p>\n\n<pre><code>string Word_XPath=\"//WORD[contains(translate(text(), abcdefghijklmnopqrstuvwxyz, ABCDEFGHIJKLMNOPQRSTUVWXYZ), 'I')]\";\n</code></pre>\n\n<p>Code for selection of words containing \"i\"</p>\n\n<pre><code>XmlDocument objXmlDoc = new XmlDocument();\nXmlNodeList objXmlNodeList;\nobjXmlDoc.Load(sFilePath);\nobjXmlNodeList = objXmlDoc.SelectNodes(Word_Char_XPath+\" or \"+ Word_XPath);\n</code></pre>\n\n<p><strong>Problem:</strong> \nBy 'or' two xpath expression it returns either true or false, but if all word nodes to be selected on matching criteria (both xpaths)then how it can be achieved ?</p>\n"},{"tags":[".net","wpf","winforms","backgroundworker"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":592,"score":1,"question_id":2088227,"title":"How can I wait on a BackgroundWorker's completion?","body":"<p>I would like to use the <code>BackgroundWorker</code> to perform a database transaction from a GUI. </p>\n\n<p>How can I command the <code>BackgroundWorker</code> to perform the work and then WAIT for the worker to complete while keeping the GUI responsive? </p>\n\n<p>Do I have to use <code>DoEvents</code> for this purpose, or is there another way?</p>\n"},{"tags":["winforms","control","right-to-left"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":23,"score":-1,"question_id":12932734,"title":"Get effective RightToLeft status for a WindowsForms control","body":"<p>When drawing a custom control, is there an easy way to determine whether it should be drawn as right-to-left? Yes, we can access its RightToLeft property, but it may contains 'Inherit'...</p>\n"},{"tags":["c#","wpf","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":12896494,"title":"Complex layout GUI","body":"<p>I'm working on some AutoCAD plugin for my company and I was considering some layouts for it. However, I cannot spend a ridiculus amount of time on the look of the application. I need something resonably fast to deliver that will improve the global user experience. That said, I don't think I can get too far away from Winforms or WPF (Winform being my comfort zone, but I know the advantages of WPF and might have to expend my zone of comfort).</p>\n\n<p>The main thing I'm trying to acheive is a \"floating\" multi-panel interface where you can \"slide out\" additionnal options and such. Imagine a form that has a list of projects in a list view or grid view and when you select one, a panel slides on the left of the form with a list of all the items involved in that projet. That's pretty much what I'm trying to do but there will be more then one panel like that.</p>\n\n<p>I have tried different approches in Winforms such as:</p>\n\n<ul>\n<li>Split Pannels - I found the layout limitations too high to be usable</li>\n<li>Using seperated forms instead of panel - The maintenance would become a nightmare...</li>\n</ul>\n\n<p>Is there another Winform alternative or should I move on to WPF? If I move on to WPF, what exactly is the feature I should be looking for to acheive my goals?</p>\n"},{"tags":["c#",".net","vb.net","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":736,"score":4,"question_id":7557442,"title":"KeyEventArgs.Handled vs KeyEventArgs.SupressKeyPress","body":"<p>What's the difference between using </p>\n\n<pre><code>e.Handled = true\n</code></pre>\n\n<p>and </p>\n\n<pre><code>e.SuppressKeyPress = true\n</code></pre>\n\n<p>I've read that SuppressKeyPress calls e.Handled but else does it do?</p>\n"},{"tags":["winforms","c#-3.0","menustrip"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12908014,"title":"Change expand menu direction","body":"<p>I want to know there is a way to change the direction in which a menu expands. </p>\n\n<p>I have a menu at the bottom of the form and I want it to expand upwards when I click my mouse over an item.</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1046,"score":1,"question_id":6043351,"title":"Dynamically enable or disable context menu items","body":"<p>I have a winform with multiple <code>PictureBox</code> controls on it. I have a context menu which is attached to all of these <code>PictureBox</code> controls. I have 3 submitems (menus) in the context menu which should be displayed in right click on any of the <code>PictureBox</code> instances and that works fine.</p>\n\n<p>Now, before the context menu pop ups, I need to check the properties of <code>PictureBox</code> where it is clicked to enable or disable certain sub menus.</p>\n\n<pre><code> private void contextMenuStrip1_Opening(object sender, CancelEventArgs e)\n    {\n\n    }\n</code></pre>\n\n<p>I see this event, but the <code>sender</code> object is a reference of <code>ContextMenu</code>. I need the <code>PictureBox</code> parameter to do this.</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":108,"score":0,"question_id":12892634,"title":"Saving changes from a combobox in a database","body":"<p>I have a combobox and want to save the changes in the database.</p>\n\n<p>What I want to do is if the combobox is selected and it is true it must run the code below. If it is false it must then skip the code and go further.</p>\n\n<p>The code below is checking if the combobox is enabled. But when I'm compiling it's saying  true when not selected</p>\n\n<pre><code>private void Log()\n{\n    if (kaartburgerlijkestand.Enabled)\n    {\n        veranderingBurgelijkestaat();\n    }\n}\n</code></pre>\n\n<p>The code below is saving the data in the database</p>\n\n<pre><code>private string veranderingBurgerlijkestaat()\n{\n    string gebruiker = curMedewerker.Behandelnaam;\n    string bekeken = prodermaform.pKaart();\n    string tabblad = tabControl1.SelectedTab.Text;\n    string pat = CPatient.GeefPatientNaam(patient.Id);\n    string wijz = \"Burgerlijkestaat: \" + kaartBurgerlijkestand.Text;\n\n    CDb dcon = new CDb();\n\n    try\n    {\n        if (dcon.Open())\n        {\n            SqlCommand cmd = new SqlCommand(\"INSERT INTO dbo.loggen(Gebruiker, Bekeken, Tabblad, Patientnaam, Wijziging, Datum) VALUES(@gebruiker, @bekeken, @tabblad, @pat, @wijz, @datum)\", dcon.Conn);\n            cmd.Parameters.AddWithValue(\"@gebruiker\", gebruiker);\n            cmd.Parameters.AddWithValue(\"@bekeken\", bekeken);\n            cmd.Parameters.AddWithValue(\"@tabblad\", tabblad);\n            cmd.Parameters.AddWithValue(\"@pat\", pat);\n            cmd.Parameters.AddWithValue(\"@wijz\", wijz);\n            cmd.Parameters.AddWithValue(\"@datum\", DateTime.Now);\n            cmd.ExecuteNonQuery();\n            cmd.Dispose();\n        }\n    }\n    catch (Exception ex)\n    {\n        MessageBox.Show(ex.Message);\n    }\n    finally\n    {\n        dcon.Close();\n    }\n\n    return wijz;\n}\n</code></pre>\n\n<p>Could someone show me a example how to do it</p>\n\n<p><strong>I Found the solution</strong></p>\n\n<p>I have made a check</p>\n\n<pre><code>private void doCheck(object sender, EventArgs e)\n{\n    cmbox = false;\n\n    if (kaartBurgerlijkestaat.Focused)\n    {\n        veranderingBurgerlijkestand();                \n    }\n\n    cmbox = true;\n\n}\n</code></pre>\n\n<p>Then I used the SelectedValueChanged Event</p>\n\n<pre><code>private void kaartBurgerlijkestand_SelectedValueChanged(object sender, EventArgs e)\n{\n    if (cmbox)\n        doCheck(sender, e);  \n}\n</code></pre>\n\n<p>And it works fine.</p>\n\n<p>I want to thank you all for helping me!</p>\n"}]}
