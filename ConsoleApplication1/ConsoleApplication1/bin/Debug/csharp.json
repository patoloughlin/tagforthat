{"count":374968,"tag":"c#","questions":[{"tags":["c#"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":23,"score":2,"question_id":13281125,"title":"What is the best way to expose a List<T> as readonly?","body":"<p>I've been around this design problem many times, and never found a killer solution.</p>\n\n<p>I want to expose a collection that is editable in the owner <code>class</code> scope, but only readable for other public scopes.</p>\n\n<p><strong>Trial 1:</strong></p>\n\n<pre><code>public class MyClass\n{\n    private List&lt;object&gt; _myList = new List&lt;object&gt;();\n\n    public IEnumerable&lt;object&gt; MyList { get { return _myList; } }\n}\n</code></pre>\n\n<p>The problem with this is a external code can just cast it back to <code>List</code> and edit, like this:</p>\n\n<pre><code>var x = ((List&lt;object&gt;)MyList);\n</code></pre>\n\n<p><strong>Trial 2:</strong></p>\n\n<pre><code>public class MyClass\n{\n    private List&lt;object&gt; _myList = new List&lt;object&gt;();\n\n    public IEnumerable&lt;object&gt; MyList { get { return _myList.ToList(); } }\n}\n</code></pre>\n\n<p>This way we prevent external modification, but create a unnecessary overhead of copying the <code>List</code> many times.</p>\n\n<p><strong>Trial 3:</strong></p>\n\n<pre><code>public class MyClass\n{\n    private List&lt;object&gt; _myList = new List&lt;object&gt;();\n    private ReadOnlyCollection&lt;object&gt; _roList = \n        new ReadOnlyCollection&lt;object&gt;(_myList)\n\n    public IEnumerable&lt;object&gt; MyList { get { return _roList; } }\n}\n</code></pre>\n\n<p>This is the standard solution, wich I use currently, but <code>ReadOnlyCollection</code> is about 30% slower:</p>\n\n<pre><code>Debug Trace:\nUse normal foreach on the ReadOnlyCollection\nSpeed(ms): 2520,3203125\nResult: 4999999950000000\n\nuse&lt;list&gt;.ForEach\nSpeed(ms): 1446,1796875\nResult: 4999999950000000\n\nUse normal foreach on the List\nSpeed(ms): 1891,2421875\nResult: 4999999950000000\n</code></pre>\n\n<p>Is there a 'perfect' way of doing this? Thanks.</p>\n"},{"tags":["c#","windows-services","multithreading","backgroundworker"],"answer_count":12,"favorite_count":6,"up_vote_count":9,"down_vote_count":0,"view_count":7938,"score":9,"question_id":1498498,"title":"Windows Service that runs Periodically","body":"<p>I'm writing a windows service that once started will run every X hours.  The process it completes is fairly intensive, so I want to use a background worker.  I'm using a Settings file to store both the hours between runs and the last time the service ran.</p>\n\n<p>I'm not exactly sure the best way to do this - that is, I want the service to idle using as few resources as possible, and when it runs, it needs to run in the background worker, report what it did, and then go back into idle mode.</p>\n\n<p>I've thought about using 2 background workers.  The first worker would be a private local variable for the service that runs something like this:</p>\n\n<pre><code>while (true)\n{\n      //create new background worker and run\n\n      Thread.Sleep(Settings.Default.SleepTimeHours * 3600000);\n}\n</code></pre>\n\n<p>with a sub worker that is created each iteration of the loop, and destroyed when completed.  To support cancellation, I think I would have to have a local instance of the second worker available in the service, but it will be null if the process currently is not running.  When the secondary worker completes, it would send out my reporting, set the last run time in the settings file, and then dispose of the worker and set the reference to null.</p>\n\n<p>I'm wondering if there is a better way to do this or a best practice.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","javascript","asp.net"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2,"score":0,"question_id":13281248,"title":"Reload a .js file on selectedindex change event of dropdown in asp.net","body":"<p>I have a dropdown inside update panel. On the selected index change event, i need to execute a .js file using c# or javascript\nHow can i do this ?</p>\n\n<pre><code>&lt;script type=\"text/javascript\" src=\"fb.js\"&gt;&lt;/script&gt;\n\n &lt;asp:UpdatePanel ID=\"UP_Social_Ddl\" runat=\"server\"&gt;\n                        &lt;ContentTemplate&gt;\n                            &lt;div class=\"styled-select\"&gt;\n                                &lt;asp:Label runat=\"server\" ID=\"Label2\" Font-Size=\"Small\" ToolTip=\"Social : 'ON' will post your activity on this page to your FaceBook Wall.\" Text=\"Social :\" Style=\"vertical-align: bottom;\" /&gt;\n                                &lt;asp:DropDownList ID=\"ddlSocialSwitch\" runat=\"server\" AutoPostBack=\"true\" Style=\"vertical-align: middle;\" ToolTip=\"Social : ON will post your activity on this page to your FaceBook Wall.\" OnSelectedIndexChanged=\"ddlSocialSwitch_SelectedIndexChanged\"&gt;\n                                &lt;/asp:DropDownList&gt;\n                                &amp;nbsp;&lt;a valign=\"bottom\" onclick=\"logout_fb\" href=\"#\" id=\"auth-logoutlink\"&gt;&lt;img valign=\"bottom\" src=\"facebookLogOutButton.png\"/&gt;&lt;/a&gt;\n                                &lt;asp:Label ID=\"lbl\" Visible=\"false\" runat=\"server\"&gt;&lt;/asp:Label&gt;\n                            &lt;/div&gt;\n                        &lt;/ContentTemplate&gt;\n                    &lt;/asp:UpdatePanel&gt;\n</code></pre>\n"},{"tags":["c#"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13280919,"title":"Assign variable values inside method","body":"<p>I'm trying to get make method in which I can assign values to multiple variables. I don't know how many variables I will have, but I know their type. The variables can all be of different types though.</p>\n\n<p>I have googled quite a bit about this, and am fairly sure that this can't be done with managed code. (Correct me if I'm wrong though)</p>\n\n<p>I don't know much (read: anything) about unsafe code. Can it be done that way? Maybe pass in an array of pointers to the variables I want to initialise and do it that way?</p>\n\n<p>I am basically looking for a way to pass an arbitrary number of mixed type variables to a method and assign their values inside the method... Is it pie in the sky?</p>\n\n<p>EDIT:</p>\n\n<p>Here is some code which I hope illustrates what I would like to achieve:</p>\n\n<pre><code>private void SomeMethod()\n{\n    string a = string.empty;\n    int b = 0;\n    double c = 0;\n\n    object[] testObject = new object[] { b, c };\n\n    SetVariables(ref testObject);\n}\n\npublic static void SetVariables(ref object[] Variables)\n{\n    for (int i = 0; i &lt; Variables.Length; i++)\n        Variables[i] = // The value the variable needs to have\n}\n</code></pre>\n\n<p>After <code>SetVariables</code> has executed, a, b and c would be say:</p>\n\n<pre><code>a = \"Some text\"\nb = 123\nc = 1564.653\n</code></pre>\n\n<p>I am looking for a way to access the variables passed in as the parameter to SetVariables and modify their value. I guess that would mean accessing their storage location in memory, hence my thinking that I might need pointers?</p>\n"},{"tags":["c#",".net","entity-framework","oop","generics"],"answer_count":0,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13279018,"title":"How to avoid the need to reference Entity Framework on my service layer?","body":"<p>While trying to create a data access layer for a new project, I ran into what I can only imagine as an OOP/Design/Generics problem (using EF 4.3 to access the database).</p>\n\n<p>Mainly I wanted to achieve two things with this data layer:</p>\n\n<ul>\n<li>Different Context objects I have on my project should share the same connection string.</li>\n<li>Abstract repository class with common implementation.</li>\n</ul>\n\n<p>For some reason, I cannot compile my solution without referencing EntityFramework on the service layer. What I'm looking for is a way to fix this. Here's what I have:</p>\n\n<pre><code>//Project/Namespace BusinessLogicLayer.DomainClasses\n//POCO classes mapped on Entity Framework.\n\n//Project/Namespace DataAccessLayer.Base\n//Base classes and interfaces for all data access layer, such as:\n\npublic abstract class BaseContext&lt;TContext&gt; : DbContext where TContext : DbContext\n{\n  //To allow multiple contexts sharing the same connection string\n  protected BaseContext(): base(\"name=MyConnectionString\") {}\n}\n\n//Generic interface for a read-only repository\npublic interface IReadOnlyRepository&lt;T&gt; : IDisposable where T : class\n\n//Generic interface for a read/write repository\npublic interface IRepository&lt;T&gt; : IReadOnlyRepository&lt;T&gt; where T : class\n\n//Basic implementation for a read-only repository\npublic abstract class BaseReadOnlyRepository&lt;C, T&gt; : IReadOnlyRepository&lt;T&gt;\n    where T : class\n    where C : BaseContext&lt;C&gt;, new()\n{\n}\n\n//Basic implementation for a read/write repository\npublic abstract class BaseRepository&lt;C, T&gt; : IRepository&lt;T&gt;\n    where T : class\n    where C : BaseContext&lt;C&gt;, new()\n{\n}\n\n//Project DataAccessLayer.AccountContext/ Namespace DataAccessLayer\n//Context class:\n\npublic class AccountContext : BaseContext&lt;AccountContext&gt; {}\n\n//With this, I can have simple repositories:\n\npublic class UserRepository : BaseRepository&lt;AccountContext, User&gt;\n{ //All implementation comes from the base abstract class, unless I need to change it (override methods)\n}\n</code></pre>\n\n<p>I have a service layer between data access and the application (Windows Forms). Because I have a generic repository, it seemed a good and logic idea to have generic services. In the end, very similar to the repository structure:</p>\n\n<pre><code>//Project/Namespace BusinessLogicLayer.Services\n//Service layer supposed to reference only the repository project and not Entity Framework.\n\n//Generic interface for a read-only service working with a read-only repository\npublic interface IReadOnlyService&lt;T&gt; where T : class {}\n\n//Generic interface for a read/write service working with a read/write repository\npublic interface IService&lt;T&gt; : IReadOnlyService&lt;T&gt; where T : class\n\n//Base implementation for a read-only service\npublic abstract class BaseReadOnlyService&lt;T, R&gt; : IReadOnlyService&lt;T&gt;\n    where T : class\n    where R : IReadOnlyRepository&lt;T&gt;, new()\n{\n}\n\n//Base implementation for a read/write service\npublic abstract class BaseService&lt;T, R&gt; : IService&lt;T&gt;\n    where T : class\n    where R : IRepository&lt;T&gt;, new()\n{\n}\n\n//Concrete sample service\npublic class UserService : BaseService&lt;User, UserRepository&gt;\n{ //As with the repository I can change the default behavior of implementation overriding methods\n}\n</code></pre>\n\n<p>With this setup, the only way to compile is to reference Entity Framework on the service layer project.\nHow can I avoid the need to reference Entity Framework there?</p>\n\n<p>At this point, I'm willing to even throw it all out and rebuild everything but this is the only way I found to make it work given my needs (DbContext sharing connection strings, generic repository to avoid replication of code).</p>\n\n<p>Appreciate any help. Thanks.</p>\n\n<p><em>--Edit--Including here some extra steps I did 3 hours after I posted the question--</em></p>\n\n<p>In order to figure this out, I started to create a sample project with the same code above plus some implementation to mimic the results on the original project as much as possible.</p>\n\n<p>I created the domain classes project, the whole base data layer project and then the context project. I noticed I need to reference Entity Framework on the context project even though the context class does not derive directly from DbContext. Instead, it derives from an abstract class that derives from DbContext. This is ok though since my context will have DbSets and any other implementation related to DbContext.</p>\n\n<p>Next is the repository project. Needs to reference all other three (domain, base data layer and context). My repository has no code. All funcionality lies on the ancestor. I try to compile the repository project and VS requires me to referente Entity Framework. I wonder if it's really just a matter of embedding libraries. If this is confirmed, it's going to be a surprise. Entity Framework library is present on the output of the other projects. Why would I need to reference it here too? What's making VS require this?</p>\n\n<p>Anyway, for testing purposes, I added the reference. After all, I'm inside the data layer. I can live with that. Moving on to the service layer. For the sake of simplicity, I put all of the service classes into the same project.</p>\n\n<p>One possible flaw is that one of the constraints for the service abstract classes is the repository interface. That requires me to add a reference to the base data layer on my service layer. Perhaps already here there is something I can do that allows me to use only the repository reference. I have no option but to reference base data layer.</p>\n\n<p>Lastly, my concrete service is created and VS gives me the following error message: The type 'System.Data.Entity.DbContext' is defined in an assembly that is not referenced. You must add a reference to assembly 'EntityFramework, Version=4.3.1.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.</p>\n\n<p>So, in the end, the only way to keep going is to reference Entity Framework on the service layer. And at some point, when building the Windows Forms App, I will also have to reference Entity Framework.</p>\n\n<p>What should I do to avoid having these references? What improvements can I have on this structure?</p>\n\n<p>What I know is that my app certainly doesn't have to know that Entity Framework is involved anywhere on the other layers. Neither does the service layer. Services will only consume repositories. Repositories can even be providing fake data for tests.</p>\n\n<p>In case anyone is interested, I uploaded the project I created while writing this. It's a 1,17Mb zip file with no binaries whatsoever (except the Entity Framework 4.3.1 dll that I got through Nuget). Link: <a href=\"http://www.mediafire.com/?b45zkedy2j7eocc\" rel=\"nofollow\">http://www.mediafire.com/?b45zkedy2j7eocc</a>.</p>\n\n<p>Again, thanks for helping.</p>\n"},{"tags":["c#","netsuite"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12959181,"title":"Trying to download file from FileCabinet in NetSuite using C# program","body":"<p>I need to download JPG file from <code>FileCabinet</code> in <code>NetSuite</code>. For that I know the file name, so I searched file and assigned to <code>FileObject</code>. I got the object right, but got <code>NULL</code> content. I am providing here some code. Can anybody point out the error or any missing step here? Thank you.</p>\n\n<pre><code>var result = _service.search(flSearch);\nif (result.totalRecords &gt; 0)\n{\n    recordList = result.recordList;\n    Record[] records = new Record[recordList.Length];\n    for (int j = 0; j &lt; recordList.Length; j++)\n    {\n        if (recordList[j] is File)\n        {\n            File itemImage = (File)(recordList[j]);            \n            byte[] data;\n            data = new Byte[(int)itemImage.fileSize];\n            data = itemImage.content;  //Here getting NULL value\n            FileStream inFile;\n            using (inFile = new FileStream(\"newImage.jpg\", FileMode.Create, FileAccess.Write))\n            {\n                inFile.Write(data, 0, data.Length);\n            }\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13281143,"title":"How can I change the Icon of WPF application","body":"<p>I have a <code>wpf</code> application, I want to set the icon for all the windows.</p>\n\n<p>I have and <code>ico</code> file in my project folder /img/app.ico, but it is <code>build action = Resource</code>.</p>\n\n<p>I change the application <code>Icon and manifest</code> to <code>/img/app.ico</code>, but it won't work. </p>\n\n<p>An error is prompt when compiling:</p>\n\n<pre><code>The img/app.ico is not found.\n</code></pre>\n"},{"tags":["c#","security","arguments","command-line-arguments","truecrypt"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13279436,"title":"See command line arguments being passed to a program","body":"<p>You may skip this part</p>\n\n<blockquote>\n  <p>I am using a batch file that I have in my thumb drive in order to\n  mount a true crypt volume. I created that batch file with the help of\n  <a href=\"http://www.truecrypt.org/docs/?s=command-line-usage\" rel=\"nofollow\">this link</a>. on that batch file I have the username and password\n  that I pass as arguments to trueCrypt.exe in order for it to be\n  mounted.</p>\n</blockquote>\n\n<hr>\n\n<p>Anyways so my question is: will it be possible to see the arguments being passed to a program from a third party process? In other words, will it be possible to see the arguments being passed to this program:</p>\n\n<pre><code>using System;\nusing System.Reflection;\nusing System.Diagnostics;\n\nclass Program\n{\n    static string password = \"\";\n\n    static void Main(string[] args)\n    {\n        if (args.Length &gt; 0)\n            password = args[0];\n\n        // get location where this program resides \n        var locationOfThisExe = Assembly.GetExecutingAssembly().Location;\n\n\n        Console.Write(\"Press enter to start a new instance of this program.\");\n        Console.Read();\n\n        var randomArgument = new Random().NextDouble().ToString();\n        Process.Start(locationOfThisExe, randomArgument); \n        // I am passing a random argument to a new process!\n        // is it possible to see these arguments from another process?\n    }\n}\n</code></pre>\n\n<hr>\n\n<h2>Edit</h2>\n\n<p><strong>I am creating an edit cause I think I explained my self incorrectly but this edit should be a solution instead of a question</strong></p>\n\n<p>I think this question has not received enough attention. Executing the command showed by <a href=\"http://stackoverflow.com/users/235660/alois-kraus\">http://stackoverflow.com/users/235660/alois-kraus</a>  shows:</p>\n\n<p>(I pasted the output on notepad++)</p>\n\n<p><img src=\"http://i.stack.imgur.com/TAdH2.png\" alt=\"enter image description here\"></p>\n\n<p>on the image it does not show very clearly but I was able to see the argument being pass to that process. <strong>That matters a lot to me because I mount my true crypt volumes with the command:</strong></p>\n\n<p>\"C:\\Program Files\\TrueCrypt\\TrueCrypt.exe\" /v \"a:\\volume.tc\" /lz /a /p a</p>\n\n<p>that tells to truecrypt that I want to mount the volume located at <code>a:\\volume.tc</code> on drive letter z  and the password is <code>a</code></p>\n\n<p>If I execute that command true crypt will mount that volume on drive z:</p>\n\n<p><img src=\"http://i.stack.imgur.com/pDY9h.png\" alt=\"enter image description here\"></p>\n\n<p>the problem is that If I then execute the command <code>wmic process</code> note what shoes up:</p>\n\n<p><img src=\"http://i.stack.imgur.com/vkGM1.png\" alt=\"enter image description here\"></p>\n\n<p><strong>Note the password is in there!</strong></p>\n\n<p>So in summary it is not safe to pass secure information as an argument. It may be secure if you close the process that received the arguments but I think it is important to be aware of this...</p>\n"},{"tags":["c#","entity-framework","grid","devexpress","master-detail"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13281199,"title":"Create master/detail grids using XtraGrid Entity framework","body":"<p>I'm a beginner regarding C#, Entity and working with grids, so although I assume what I'm asking is somewhat general, I am a little lost.\nI have two tables in my SQL database: <code>PeriodicReports</code> and <code>PeriodicReportGroups</code>. Each reports group can have 1 or more periodic reports, so what I envisioned was a grid with rows that would have a + sign at the left and could be expanded, showing the related periodic reports for each group. I know this can be done because I've seen very similar examples in DevExpress support site, but although I've put time trying to understand them and apply them to my case, I still haven't figured how to do it. \nThis is what my code looks like. After using the Entity Framework with my tables, this class got created automatically:</p>\n\n<pre><code>public partial class ReportEntities : DbContext\n{\n    public ReportEntities()\n        : base(\"name=ReportEntities\")\n    {\n    }\n\n    protected override void OnModelCreating(DbModelBuilder modelBuilder)\n    {\n        throw new UnintentionalCodeFirstException();\n    }\n\n    public DbSet&lt;PeriodicReportGroup&gt; PeriodicReportGroups { get; set; }\n    public DbSet&lt;PeriodicReport&gt; PeriodicReports { get; set; }\n}\n</code></pre>\n\n<p>I created this interface and class myself in order to only show certain columns in my grid:</p>\n\n<pre><code>    public interface IPeriodicReportGroup\n{\n    string Name { get; }\n    string Description { get; }\n    bool Active { get; set; }\n}\n\npublic partial class PeriodicReportGroup : IPeriodicReportGroup\n{\n}\n</code></pre>\n\n<p>And in the other hand, I have my XtraForm with an XtraGrid:</p>\n\n<pre><code>public partial class Form1 : XtraForm\n{\n    public Form1()\n    {\n        InitializeComponent();\n        InitSkinGallery();\n        InitGrid();\n    }\n\n    BindingList&lt;IPeriodicReportGroup&gt; gridDataList = new BindingList&lt;IPeriodicReportGroup&gt;();\n\n    void InitGrid()\n    {\n        var database = new ReportEntities();\n\n        var reportGroups = database.PeriodicReportGroups.ToList( );\n\n        foreach (var group in reportGroups )\n            gridDataList.Add( group );\n\n        gridControl.DataSource = gridDataList;\n    }\n...\n</code></pre>\n\n<p>So far, I'm successfully putting the periodic report groups that I have in my DB in the grid, which is good. But I still have no clue on how exactly set up the details grid that will expand for each group, although I feel it should be something pretty standard. Can anybody offer some guidance? I'm not asking for somebody else to do my work, just something that can point me out in the right direction, because right now I'm pretty lost. \nI'd also love to be able to add new groups and new details on the run by inputting data into an empty row, is this possible? </p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["c#","facebook","facebook-graph-api"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4,"score":0,"question_id":13281032,"title":"Retrieving more post from public fb page using FB graph api","body":"<p>As i have tried getting the post from a public facebook page, by passing access token, however i can only retrieve the latest 25 post. Can i increase number number of post returned? or can i retrieve post based on dates i want. If possible, can someone guide me how to do so?</p>\n\n<p>what i have now:</p>\n\n<pre><code>  static JsonObject GetPost(string accessToken)\n    {\n        FacebookClient facebookClient = new FacebookClient(accessToken);\n\n        JsonObject pagePost = facebookClient.Get(\"/pageName/posts\") as JsonObject;\n\n        return pagePost;\n\n    }\n</code></pre>\n"},{"tags":["c#","asp.net"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":1562,"score":0,"question_id":3733429,"title":"how to show password in asterik format when we generate random password","body":"<p>i am generate random password and show it in a textbox.\nwhen i am set textbox property textmode to password then it doesn't show in textbox but when i set it singleline then password shows in textbox.\nI am using following code -- </p>\n\n<pre><code>textbox1.attributes.add(\"value\",passwordvalue);\n</code></pre>\n\n<p>for show i am using --</p>\n\n<pre><code>textbox1.text = textbox1.attributes[\"value\"].tostring();\n</code></pre>\n\n<p>Same happing with when i edit record. password doesn't show in textbox. </p>\n"},{"tags":["c#","winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":11,"score":1,"question_id":13281048,"title":"C# Updating form (richTextBox and toolStripStatusLabel) from Program thread","body":"<p>I'm trying to take a console application and build a gui for it. I've got the main functions of my GUI working and added the console application files to my new project. I changed the namespace of the files to match that of the winform application and moved the main function of the console application into the Program class defining it as a function taking a CSV path argument which it gets from the form.</p>\n\n<p>So it appears that program it functioning but Im having trouble getting the form to update. There are some Console.WriteLine() functions that I want to write to the toolStripStatusLabel and others to the richTextBox.</p>\n\n<p>I'm new to C# and the main program wasnt written by me but Im trying to build on it.</p>\n\n<p>Program.cs</p>\n\n<pre><code>Form1 Frm1 = new Form1();\nFrm1.UpdateStatusBar(\"Sorted jobs by EDD....\");\nFrm1.Refresh();\n</code></pre>\n\n<p>Form1.cs</p>\n\n<pre><code>public void UpdateStatusBar(string status)\n{\n    Form1 Frm1 = new Form1();\n    Frm1.toolStripStatusLabel1.Text = status;  \n}\n</code></pre>\n\n<p><a href=\"http://pastebin.com/HjnJ1YcF\" rel=\"nofollow\">Pastebin Program.cs</a>\nSee line 92.</p>\n\n<p><a href=\"http://pastebin.com/PyPEsmRD\" rel=\"nofollow\">Pastebin Form1.cs</a>\nSee line 88.</p>\n"},{"tags":["c#","eclipse"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3,"score":0,"question_id":13281077,"title":"Cannot install emonic c# plugin to Eclipse 3.7.2","body":"<p>I wanted to use the c# inside the Eclipse, but I get that error while trying to install. How to solve that problem.</p>\n\n<p>Below: version of my Eclipse, source(put in the plugin manager) information after calculating dependencies.</p>\n\n<pre><code>Version: 3.7.2\nBuild id: M20120208-0800\n</code></pre>\n\n<hr>\n\n<pre><code> http://emonic.sourceforge.net/updatesite/internap/site.xml\n</code></pre>\n\n<hr>\n\n<pre><code>Cannot complete the install because some dependencies are not satisfiable\norg.emonic.debugger_feature.feature.group [0.0.2] cannot be installed in this environment because its filter is not applicable.\n</code></pre>\n"},{"tags":["c#","fizzbuzz"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13280940,"title":"Feedback on Fizz Buzz programming test","body":"<p>I've just been at a job interview where I was posed the task of coding a solution to the FizzBuzz test in C# at the interview and by hand and I'd like some constructive feedback on my solution, i.e. the quality and/or readability of the code.</p>\n\n<p>The FizzBuzz test is to write a program that goes through the numbers 1 to 100. For every multiple of 3, the program should output \"Fizz\" and for every multiple of 5 it should output \"Buzz\".\nIf both above conditions are met it should output \"FizzBuzz\". If none of the above conditions are met, it should just output the number.</p>\n\n<p>Here is my solution in C#:</p>\n\n<pre><code>        for (int i = 1; i &lt; 101; i++)\n        {\n            string Output = \"\";\n\n            if (i%3 == 0)\n                Output = \"Fizz\";\n            if (i%5 == 0)\n                Output += \"Buzz\";\n            if (Output != \"\")\n                Console.WriteLine(Output);\n            else\n                Console.WriteLine(i.ToString()); \n         }\n</code></pre>\n\n<p>I've specifically not included comments in the code. Constructive feedback is appreciated, especially when it comes to readability.</p>\n"},{"tags":["c#","windows-phone-7","xaml","wpf-usercontrols"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13276352,"title":"Why do I get null values from ElementName bound properties when using this custom user control in Windows Phone 7?","body":"<p>Here is the XAML for my user control:</p>\n\n<pre><code>&lt;UserControl x:Name=\"titledTextBox\" x:Class=\"VitalStats.View.Controls.TitledTextBox\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n    xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n    mc:Ignorable=\"d\"\n    FontFamily=\"{StaticResource PhoneFontFamilyNormal}\"\n    FontSize=\"{StaticResource PhoneFontSizeNormal}\"\n    Foreground=\"{StaticResource PhoneForegroundBrush}\"\n    d:DesignHeight=\"480\" d:DesignWidth=\"480\"\n    &gt;\n\n    &lt;Grid x:Name=\"LayoutRoot\"&gt;\n        &lt;StackPanel Orientation=\"Vertical\"&gt;\n            &lt;TextBlock x:Name=\"textBlock\" \n                       TextWrapping=\"Wrap\" \n                       Margin=\"12,5,0,-5\" \n                       Text=\"{Binding Title, ElementName=titledTextBox, FallbackValue=Title Here}\" \n                       FontSize=\"20\" \n                       Foreground=\"{StaticResource PhoneSubtleBrush}\"/&gt;\n            &lt;TextBox Text=\"{Binding Text, ElementName=titledTextBox, Mode=TwoWay}\"/&gt;   \n        &lt;/StackPanel&gt;\n    &lt;/Grid&gt;\n\n&lt;/UserControl&gt;\n</code></pre>\n\n<p>and this is what my code-behind looks like,</p>\n\n<pre><code>// Usings here\n\nnamespace VitalStats.View.Controls\n{\n    public partial class TitledTextBox : UserControl\n    {\n\n        [Description(\"A TextBox with built in title\")]\n        public TitledTextBox()\n        {\n            InitializeComponent();\n\n            if (DesignerProperties.GetIsInDesignMode(this)  )\n            {\n                this.Title = \"Title Here\";  \n            }\n        }\n\n        public string Title\n        {\n            get { return this.GetValue(TitleProperty) as string; }\n            set { this.SetValue(TitleProperty, value); }\n        }\n        public static readonly DependencyProperty TitleProperty =\n            DependencyProperty.Register(\"Title\", typeof(string), typeof(TitledTextBox), null);\n\n        public string Text\n        {\n            get { return this.GetValue(TextProperty) as string; }\n            set { this.SetValue(TextProperty, value); }\n        }\n        public static readonly DependencyProperty TextProperty = \n            DependencyProperty.Register(\"Text\", typeof(string), typeof(TitledTextBox), null);\n\n    }\n}\n</code></pre>\n\n<p>When I try and read values from the Title and the Text property, they are null (although values bound to Title are reflected in the UI), even though there are values in the textbox in the UI.</p>\n\n<p>This is on Windows Phone 7 (7.1 project).</p>\n"},{"tags":["c#","jquery"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":229,"score":1,"question_id":3819299,"title":"Jquery timepickr C#","body":"<p>I try to use timepickr plugin, from <a href=\"http://haineault.com/media/jquery/ui-timepickr/page/\" rel=\"nofollow\">http://haineault.com/media/jquery/ui-timepickr/page/</a></p>\n\n<p>my headers:</p>\n\n<pre><code>&lt;script src=\"&lt;%=ResolveUrl(\"~/Scripts/jquery-1.4.2.min.js\")%&gt;\" type=\"text/javascript\"&gt;&lt;/script&gt;   \n&lt;script src=\"&lt;%=ResolveUrl(\"~/Scripts/jquery-ui-1.8.2.custom.min.js\")%&gt;\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"&lt;%=ResolveUrl(\"~/Scripts/jquery.utils.js\")%&gt;\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"&lt;%=ResolveUrl(\"~/Scripts/jquery.strings.js\")%&gt;\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"&lt;%=ResolveUrl(\"~/Scripts/ui.timepickr.js\")%&gt;\" type=\"text/javascript\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>my view:</p>\n\n<pre><code>&lt;input type=\"text\" id=\"hourstime\" style=\" font-family:Arial;width: 47px; vertical-align:inherit;margin:1;\"/&gt;\n</code></pre>\n\n<p>and jquery:</p>\n\n<pre><code>$(document).ready(function () {\n    $('#hourstime').timepickr();\n});\n</code></pre>\n\n<p>So, it fails with error:</p>\n\n<pre><code>Uncaught TypeError: Cannot call method 'call' of undefined\n</code></pre>\n\n<p>Any ideas?</p>\n"},{"tags":["c#","linq","collections","lambda"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":13275694,"title":"How to build this LINQ expression?","body":"<p>I have a class that looks like this: </p>\n\n<pre><code>class UserProfile { public int Id; public int? ParentId; public string Name; public string Role; }\n</code></pre>\n\n<p>Each UserProfile is a user or an admin. Each user may be a child of a single admin, whose Id is stored in the user's ParentId. Below is an example:</p>\n\n<pre><code>IEnumerable&lt;UserProfile&gt; users = new List&lt;UserProfile&gt;{\n        new UserProfile(){Id = 1, ParentId = null,  Name = \"Admin1\", Role = \"Admin\" },\n        new UserProfile(){Id = 2, ParentId = 1,  Name = \"User2\", Role = \"Admin\" },\n        new UserProfile(){Id = 3, ParentId = 1,  Name = \"User3\", Role = \"Admin\" },\n        new UserProfile(){Id = 3, ParentId = null,  Name = \"Admin2\", Role = \"Admin\" },\n        new UserProfile(){Id = 4, ParentId = 3,  Name = \"User4\", Role = \"Admin\" },\n        new UserProfile(){Id = 5, ParentId = null,  Name = \"User5\", Role = \"Admin\" },\n        new UserProfile(){Id = 6, ParentId = 3,  Name = \"User6\", Role = \"Admin\" },\n    };  \n</code></pre>\n\n<p>I need to rearrange this list or create another list, so that it will be in specific order:\nAll admins and their users:</p>\n\n<ul>\n<li><strong>Admin1</strong> (full details)   </li>\n<li>User2 (full details)</li>\n<li>User3 (full details)  </li>\n<li>User5 (full details) </li>\n<li><strong>Admin2</strong> (full details)   </li>\n<li>User4 (full details)</li>\n<li>User6 (full details)</li>\n</ul>\n\n<p>I tried to separate them first, but I don't know how to merge them in the desired order.</p>\n\n<pre><code>var adminsOnly = users.Where(p =&gt; p.Role.Equals(\"Admin\")).OrderBy(p =&gt; p.Id);\nvar usersOnly = users.Where(p =&gt; p.Role.Equals(\"User\")).OrderBy(p =&gt; p.Id);\n</code></pre>\n\n<p>Thanks a lot.</p>\n\n<p><strong>Note: There can be Users without Admins, and Admins without Users.</strong></p>\n"},{"tags":["c#","wpf","listbox","scrollbar"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13280837,"title":"WPF – Wrong scrolling in a reverse ordered (bottom to top) ListBox","body":"<p>I have the following code to reverse a <code>ListBox</code> (items are placed form bottom to top):</p>\n\n<pre><code>&lt;ListBox HorizontalContentAlignment=\"Stretch\"&gt;          \n    &lt;ListBox.ItemsPanel&gt;\n        &lt;ItemsPanelTemplate&gt;\n            &lt;VirtualizingStackPanel VerticalAlignment=\"Bottom\"  Orientation=\"Vertical\"&gt;\n                &lt;VirtualizingStackPanel.LayoutTransform&gt;\n                    &lt;ScaleTransform ScaleX=\"1\" ScaleY=\"-1\" /&gt;\n                &lt;/VirtualizingStackPanel.LayoutTransform&gt;\n            &lt;/VirtualizingStackPanel&gt;\n        &lt;/ItemsPanelTemplate&gt;\n    &lt;/ListBox.ItemsPanel&gt;\n    &lt;ListBox.ItemContainerStyle&gt;\n        &lt;Style TargetType=\"ListBoxItem\"&gt;\n            &lt;Setter Property=\"LayoutTransform\"&gt;\n                &lt;Setter.Value&gt;\n                    &lt;ScaleTransform ScaleX=\"1\" ScaleY=\"-1\" /&gt;\n                &lt;/Setter.Value&gt;\n            &lt;/Setter&gt;\n        &lt;/Style&gt;\n    &lt;/ListBox.ItemContainerStyle&gt;\n&lt;/ListBox&gt;\n</code></pre>\n\n<p>If you add some items, you will see that the scrollbar is wrong (original instead inverse). What can I do to transform the scrollbar like done with the content? BTW, If you set  <code>ScrollViewer.CanContentScroll=\"False\"</code> in the ListBox the scrolling is fine. But then Virtualization is lost.</p>\n"},{"tags":["c#","winapi","time","clickonce","administrator"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":3298,"score":2,"question_id":5713825,"title":"Run as administrator: requireAdministrator & ClickOnce + emulating system time","body":"<p>My app uses ClickOnce  tehcnology. Today I needed to run it as administrator. I modified the manifest file from</p>\n\n<pre><code>&lt;requestedExecutionLevel  level=\"asInvoker\" uiAccess=\"false\" /&gt;\n</code></pre>\n\n<p>to</p>\n\n<pre><code>&lt;requestedExecutionLevel  level=\"requireAdministrator\" uiAccess=\"false\" /&gt;\n</code></pre>\n\n<p>However VS cannot compile the project:</p>\n\n<blockquote>\n  <p>Error 35  ClickOnce does not support the request execution level 'requireAdministrator'.  </p>\n</blockquote>\n\n<p>I think it's impossible to use them at once. Isn't it? I need to change the system time, can I do that in application level? Can I emulate it, so app. can do what I want. I change time +2 hours then put back for a second. I got a few dlls and they ask for time.</p>\n"},{"tags":["c#",".net","xml","xml-serialization"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":11572981,"title":"How to XML serialize polymorphic array without wrapping element","body":"<p>Want to serialise my data into this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"ibm850\"?&gt;\n&lt;Batch Name=\"Test batch\"&gt;\n   &lt;ExecuteCommand Command=\"...\" /&gt;\n   &lt;WaitCommand Seconds=\"5\" /&gt;\n&lt;/Batch&gt;\n</code></pre>\n\n<p>But instead I'm getting this (note the wrapping Commands element)</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"ibm850\"?&gt;\n&lt;Batch Name=\"Test batch\"&gt;\n  &lt;Commands&gt;&lt;!-- I want to get rid of thiw wrapper Commands element and just  --&gt;\n    &lt;ExecuteCommand Command=\"...\" /&gt;\n    &lt;WaitCommand Seconds=\"5\" /&gt;\n  &lt;/Commands&gt;\n&lt;/Batch&gt;\n</code></pre>\n\n<p>Here's the sample code used to produce this:</p>\n\n<pre><code>public class BaseCommand //base class\n{\n    [XmlAttribute]\n    public string Result { get; set; }\n}\n\npublic class ExecuteCommand : BaseCommand\n{\n    [XmlAttribute]\n    public string Command { get; set; }\n}\n\npublic class WaitCommand : BaseCommand\n{\n    [XmlAttribute]\n    public int Seconds { get; set; }\n}\n\npublic class Batch\n{\n    [XmlAttribute]\n    public string Name { get; set; }\n\n    private List&lt;BaseCommand&gt; _commands = new List&lt;BaseCommand&gt;();\n    [XmlArrayItem(typeof(ExecuteCommand))]\n    [XmlArrayItem(typeof(WaitCommand))]\n    public List&lt;BaseCommand&gt; Commands\n    {\n        get\n        {\n            return _commands;\n        }\n        set\n        {\n            _commands = value;\n        }\n    }\n\n    public static void Main()\n    {\n        XmlSerializer serializer = new XmlSerializer(typeof(Batch));\n\n        Batch b = new Batch();\n        b.Name = \"Test batch\";\n        b.Commands.Add(new ExecuteCommand() { Command = \"...\" });\n        b.Commands.Add(new WaitCommand() { Seconds = 5 });\n\n        serializer.Serialize(Console.Out, b);\n        Console.Read();\n    }\n}\n</code></pre>\n\n<p>I searched and read heaps of articles on this topic. They all seem to provide solution for serializing collections with a single class type (no inheritance used). I use inheritance and nothing seems to work. Unfortunately I have to output precise XML document due to legacy support</p>\n"},{"tags":["c#","inversion-of-control"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":9,"score":1,"question_id":13280942,"title":"Operation is not valid due to the current state of the object","body":"<p>I am a student and my job was to build my own IoC container. I've read some tutorials/code samples and finally created it but when I try to create instance of it, I get exception like in the topic. Here is my IoC code and test code, I've been trying to figure out what's wrong but just can't find it.</p>\n\n<p>IoC</p>\n\n<pre><code>public class Mkontener: UnresolvedDependenciesException, IContainer\n{\n    private readonly Dictionary&lt;Type, object&gt; container = new Dictionary&lt;Type, object&gt; { };\n\n    public void Register(System.Reflection.Assembly assembly)\n    {\n\n        Type[] mytypes = assembly.GetTypes();\n\n\n        foreach (Type t in mytypes)\n        {\n            if (!container.ContainsKey(t))\n            {\n                container.Add(t, Activator.CreateInstance(t));\n            }\n        }\n        //throw new NotImplementedException();\n    }\n\n    public void Register(Type type)\n    {\n        if (!container.ContainsKey(type))\n        {\n            container.Add(type, Activator.CreateInstance(type));\n        }\n        //throw new NotImplementedException();\n    }\n\n    public void Register(object impl)\n    {\n        Type t = impl.GetType();\n        if (!container.ContainsKey(t))\n        {\n            container.Add(t, impl);\n        }\n\n        // throw new NotImplementedException();\n    }\n\n    public void Register&lt;T&gt;(Func&lt;T&gt; provider) where T : class\n    {\n\n        container.Add(provider.GetType(), provider);\n        //throw new NotImplementedException();\n    }\n\n    public T Resolve&lt;T&gt;() where T : class\n    {\n\n        return (T)Resolve(typeof(T));\n    }\n\n    public object Resolve(Type type)\n    {\n        List&lt;ConstructorInfo&gt; konstruktor = new List&lt;ConstructorInfo&gt; { };\n        foreach (ConstructorInfo cons in type.GetConstructors())\n        {\n            konstruktor.Add(cons);\n        }\n        if (konstruktor.Count == 0)\n        {\n            return Activator.CreateInstance(type);\n        }\n        else\n        {\n            ConstructorInfo active = null;\n            int lparams = 0;\n            foreach (ConstructorInfo cnst in konstruktor)\n            {\n                int inner=0;\n                foreach (ParameterInfo a in cnst.GetParameters())\n                {\n                    inner++;\n                }\n                if (inner &gt; lparams)\n                {\n                    active = cnst;\n                }\n\n            }\n            List&lt;object&gt; lista = new List&lt;object&gt; { };\n            foreach(ParameterInfo param in active.GetParameters())\n            {\n                if (container.ContainsKey(param.GetType()))\n                {\n                    lista.Add(container[param.GetType()]);\n                }\n                else\n                {\n                    //throw new UnresolvedDependenciesException();\n                }\n            }\n\n            object[] obiekty= lista.ToArray();\n            return  Activator.CreateInstance(type, obiekty);\n        }\n        if (container.ContainsKey(type))\n        {\n            return container[type];\n        }\n        else\n        {\n            //throw new UnresolvedDependenciesException();\n        }\n\n    }\n\n\n    public void Register&lt;T&gt;(T impl) where T : class\n    {\n        container.Add(impl.GetType(), impl);\n    }\n}\n</code></pre>\n\n<p>Part of test unit</p>\n\n<pre><code>public void P1__Container_Should_Register_Singleton_As_Object()\n{\n    // Arrange\n    var container = (IContainer)Activator.CreateInstance(LabDescriptor.Container);\n    var singleton = new FakeImpl();\n\n    // Act\n    container.Register(singleton);\n    var result = container.Resolve&lt;IFake&gt;();\n\n    // Assert\n    Assert.That(result, Is.Not.Null);\n    Assert.That(result, Is.SameAs(singleton));\n}\n</code></pre>\n\n<p>Sorry for clumsy code etc. Just starting here.</p>\n"},{"tags":["c#","unit-testing","asp.net-mvc-3","session"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":578,"score":2,"question_id":6990019,"title":"How can I properly Mock the KeysCollection in HttpSessionStateBase?","body":"<p>I setup this mock session object from the example here: <a href=\"http://stackoverflow.com/questions/340827/how-to-moq-an-indexed-property\">How to MOQ an Indexed property</a></p>\n\n<pre><code>/// &lt;summary&gt;\n/// HTTP session mockup.\n/// &lt;/summary&gt;\ninternal sealed class HttpSessionMock : HttpSessionStateBase\n{\n    private readonly Dictionary&lt;string, object&gt; objects = new Dictionary&lt;string, object&gt;();\n\n    public override object this[string name]\n    {\n        get { return (objects.ContainsKey(name)) ? objects[name] : null; }\n        set { objects[name] = value; }\n    }\n}\n</code></pre>\n\n<p>some sample code to produce an error...</p>\n\n<pre><code>var mockSession = new HttpSessionMock();\nvar keys = mockSession.Keys;\n</code></pre>\n\n<p>Error: <strong>The method or operation is not implemented.</strong></p>\n\n<p>I need to implement the Keys property, but can't create a KeysCollection object.</p>\n\n<p>What is the best way to do this?</p>\n\n<p>EDIT: [SOLUTION]</p>\n\n<p>I ended up changing the HttpSessionMock based on the answer given.  This is what I ended up with.  (I also added a reference to System.Linq).</p>\n\n<pre><code>internal sealed class HttpSessionMock : HttpSessionStateBase\n{\n    private readonly NameValueCollection objects = new NameValueCollection();\n\n    public override object this[string name]\n    {\n        get { return (objects.AllKeys.Contains(name)) ? objects[name] : null; }\n        set { objects[name] = (string)value; }\n    }\n\n    public override NameObjectCollectionBase.KeysCollection Keys\n    {\n        get { return objects.Keys; }\n    }\n}\n</code></pre>\n\n<p>note: this mock session will only store strings, not objects.</p>\n"},{"tags":["c#","janus"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":9323231,"title":"How to switch from 4.0.25 to 4.0.18 in Janus Components","body":"<p>I want to change my <strong>Janus Components</strong> from 4.0.25 version to 4.0.18 version without replacing each component one by one.</p>\n\n<p>Anyone know how I can do this? </p>\n"},{"tags":["c#","wpf","wpf-controls"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13261775,"title":"Custom Control's OnMouseLeftButtonDown isn't called","body":"<p>I'm pretty new to WPF, and I'm trying to write a custom control that is basically a TextBlock, but also has a click event. I tried piecing the thing together from various sources, but it does not work.</p>\n\n<p>In the following code, I would expect that <code>OnMouseLeftButtonDown</code> is called when a mouse click is performed on the element. If that happens, I want to raise the <code>Click</code> event. Looking in the debugger, the function is never called.</p>\n\n<p>Did I misunderstand how this is supposed to work, or did some other error find it's way into my code?</p>\n\n<pre><code>namespace EP3_gui.Controls\n{\n    public class ClickableTextBlock : TextBlock\n    {\n        public ClickableTextBlock() : base()\n        { }\n\n        public ClickableTextBlock( Inline inline )\n            : base( inline )\n        { }\n\n        protected override void OnMouseLeftButtonDown( MouseButtonEventArgs e )\n        {\n            base.OnMouseLeftButtonDown( e );\n            RoutedEventArgs args = new RoutedEventArgs( ClickEvent );\n            RaiseEvent( args );\n        }\n\n        public static readonly RoutedEvent ClickEvent = EventManager.RegisterRoutedEvent(\n            \"Click\",\n            RoutingStrategy.Bubble,\n            typeof( RoutedEventHandler ),\n            typeof( ClickableTextBlock )\n        );\n\n        public event RoutedEventHandler Click\n        {\n            add { AddHandler( ClickEvent, value ); }\n            remove { RemoveHandler( ClickEvent, value ); }\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","winforms","caching","singleton"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13280912,"title":"Designing a caching schema for Winforms","body":"<p>I have a Winform application that I am trying to implement caching in order to speed up the process of reading data everytime one of my class methods get called. I am thinking of using a Singleton-like approach. I am thinking of something like this:</p>\n\n<pre><code>public class MyCache {\n    private MyDataClass _cacheData;\n    private static MyCache _cache;\n\n    public static MyCache CreateCache()\n    {\n        return _cache ?? new MyCache();\n    }\n\n    public void CacheData(MyDataClass data)\n    {\n        _cache = data;\n    }\n\n    public MyDataClass GetCache()\n    {\n        return _cache;\n    } \n}\n</code></pre>\n\n<p>Can someone tell me if this approach is good or if there is a better approach I should use?</p>\n"},{"tags":["c#","nhibernate"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13222894,"title":"Very slow update with nHibernate","body":"<p>I'm using nHibernate with one session per method. I'm using Castle Dynamic Proxy to open a session and a transaction before executing the method and I commit the transaction and close the session right after the execution of this method.</p>\n\n<p>I'm using a SQLite database and if set cascade to SaveUpdate or None doesn't change anything. nHIbernate is configured with Fluent nHibernate with the default configuration. </p>\n\n<p>When I flush the session, it takes more than 2 seconds.</p>\n\n<pre><code>public void AddNewChild(LightPatientDto patient, LightPatientDto child)\n{\n    var ePatient = this.Session.Load&lt;Patient&gt;(patient.Id);\n    var eChild = this.Session.Load&lt;Patient&gt;(child.Id);\n\n    switch (ePatient.Gender)\n    {\n        case Gender.Male:\n            eChild.Father = ePatient;\n            break;\n        case Gender.Female:\n            eChild.Mother = ePatient;\n            break;\n        default:\n            Assert.FailOnEnumeration(eChild.Gender);\n            break;\n    }\n\n    this.Session.Update(eChild);\n    this.Session.Flush(); // &lt;== takes more than 2 seconds\n}\n</code></pre>\n\n<p>NHibernate profiler gives me this SQL is executed in 2008 ms. When I copy paste this SQL using a SQLite administration tool, it's executed in 90 ms.</p>\n\n<pre><code>UPDATE Patient\nSET    BirthDate = '1964-05-06T00:00:00.00' /* @p0 */,\n       Fee = 0 /* @p1 */,\n       Height = 0 /* @p2 */,\n       InscriptionDate = '2007-05-21T00:00:00.00' /* @p3 */,\n       PlaceOfBirth = 'xxxxxx' /* @p4 */,\n       PrivateMail = '' /* @p5 */,\n       PrivateMobile = NULL /* @p6 */,\n       PrivatePhone = '0496/xx.xx.xx' /* @p7 */,\n       Reason = 'diabète' /* @p8 */,\n       Father_id = 2 /* @p9 */,\n       Insurance_id = 1 /* @p10 */,\n       Mother_id = NULL /* @p11 */,\n       Practice_id = 1 /* @p12 */,\n       Profession_id = NULL /* @p13 */,\n       Reputation_id = 1 /* @p14 */\nWHERE  Person_id = 3 /* @p15 */\n</code></pre>\n\n<p>How can I optimise the execution time?</p>\n"},{"tags":["c#",".net","xml","linq","xpath"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13280719,"title":"How do I read all XML nodes of a specific name and put them into an array (or list)?","body":"<p>I have an XML:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;ticket&gt;\n    &lt;comments type=\"array\"&gt;\n         &lt;comment&gt; \n               &lt;attachments type=\"array\"&gt;\n                     &lt;attachment&gt;\n                          &lt;url&gt;I NEED WHATEVER IS IN HERE&lt;/url&gt;\n                     &lt;/attachment&gt;\n               &lt;/attachments&gt;\n         &lt;/comment&gt;\n         &lt;comment&gt;\n               &lt;attachments type=\"array\"&gt;\n                     &lt;attachment&gt;\n                          &lt;url&gt;I NEED WHATEVER IS IN HERE&lt;/url&gt;\n                     &lt;/attachment&gt;\n               &lt;/attachments&gt;\n         &lt;comment&gt;\n     &lt;/comments&gt;\n&lt;/ticket&gt;\n</code></pre>\n\n<p>How would I go about getting whatever is inside the URL tag and add it to a <code>&lt;List&gt;</code>? I'm using C#.</p>\n"},{"tags":["c#","textbox","windows-8","microsoft-metro","dynamically-generated"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":4,"score":1,"question_id":13280902,"title":"Save/Restore(Get/Set) absolute position of UI control (textbox) dynamically with C# code in Win8 Metro Store app","body":"<p>as said in title, it's about Windows 8 Metro style store app.</p>\n\n<p>-Textbox is dynamically generated by Code\n - Textbox can be dragged by user to anywhere to the screen\n - user can save the location of textbox anytime\n - user can restore the location of its previously saved location on screen.\n - List item</p>\n\n<p>eg.</p>\n\n<pre><code>TextBox t = new TextBox();\nt.Name = \"TextBoxControl\";\n// add event for dragging\nt.ManipulationDelta += t_ManipulationDelta;\nt.RenderTransform = dragTranslation;\n// Add textbox to screen\nBasic_Root.Children.Add(t)\n</code></pre>\n\n<p>User can drag and textbox anywhere in the screen, but i need to save the position of this dragged textbox's new location. And there is a button, once clicked, will restore the textbox to its previously saved location, may I know how this can be done?</p>\n\n<p>I thought of saving the Margin value of textbox, and set it later for restoring its position, but it didn't work.</p>\n\n<p>I found something about....</p>\n\n<pre><code>var ttv = MainTextBlock.TransformToVisual(Window.Current.Content);\nPoint screenCoords = ttv.TransformPoint(new Point(0, 0)\n</code></pre>\n\n<p>This allow me to see the x,y location of the dragged textbox, so I save the Point, but how can I restore textbox's location with this saved Point?</p>\n\n<p>Many Thanks!</p>\n"},{"tags":["c#","file","parsing","ssis-data-transformations"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13280011,"title":"C# Best way to parse flat file with dynamic number of fields per row","body":"<p>I have a flat file that is pipe delimited and looks something like this as example</p>\n\n<p>ColA|ColB|3*|Note1|Note2|Note3|2**|A1|A2|A3|B1|B2|B3</p>\n\n<p>The first two columns are set and will always be there.</p>\n\n<p>* denotes a count for how many repeating fields there will be following that count so Notes 1 2 3 </p>\n\n<p>** denotes a count for how many times a block of fields are repeated and there are always 3 fields in a block. </p>\n\n<p>This is per row, so each row may have a different number of fields. </p>\n\n<p>Hope that makes sense so far.</p>\n\n<p>I'm trying to find the best way to parse this file, any suggestions would be great.</p>\n\n<p>The goal at the end is to map all these fields into a few different files - data transformation. I'm actually doing all this within SSIS but figured the default components won't be good enough so need to write own code.</p>\n\n<p>UPDATE I'm essentially trying to read this like a source file and do some lookups and string manipulation to some of the fields in between and spit out several different files like in any normal file to file transformation SSIS package.</p>\n\n<p>Using the above example, I may want to create a new file that ends up looking like this</p>\n\n<p>\"ColA\",\"HardcodedString\",\"Note1CRLFNote2CRLF\",\"ColB\"</p>\n\n<p>And then another file</p>\n\n<p>Row1: \"ColA\",\"A1\",\"A2\",\"A3\"</p>\n\n<p>Row2: \"ColA\",\"B1\",\"B2\",\"B3\"</p>\n\n<p>So I guess I'm after some ideas on how to parse this as well as storing the data in either Stacks or Lists or?? to play with and spit out later.</p>\n"},{"tags":["c#",".net","proxy","fiddler"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":108,"score":1,"question_id":12772332,"title":"C# FiddlerCore API to capture data","body":"<p>I am successfully using the FiddlerCore API in C# to intercept web responses from a particular web host and capture JSON data.</p>\n\n<p>The FiddlerCore API seems to block any other web browsing in Chrome, IE, etc whilst my application is running and capturing data.  I understand that FiddlerCore creates a proxy to catch the traffic but wondered if it was possible to stop FiddlerCore from changing the LAN settings in my browser to direct traffic through a proxy?</p>\n\n<p>I am currently Starting my Fiddler instance using the code below:</p>\n\n<pre><code>         Fiddler.FiddlerApplication.Startup(8877, true, true);\n</code></pre>\n\n<p>And I intercept the data packets in my winforms app in the following event</p>\n\n<pre><code>         FiddlerApplication.AfterSessionComplete\n</code></pre>\n"},{"tags":["c#",".net","multithreading","parallel-processing"],"answer_count":5,"favorite_count":2,"up_vote_count":11,"down_vote_count":0,"view_count":6300,"score":11,"question_id":3780870,"title":"Using AsParallel()/Parellel.ForEach() guidelines?","body":"<p>Looking for a little advice on leveraging <code>AsParallel()</code> or <code>Parallel.ForEach()</code> to speed this up.</p>\n\n<p>See the method I've got (simplified/bastardized for this example) below.</p>\n\n<p>It takes a list like \"US, FR, APAC\", where \"APAC\" is an alias for maybe 50 other \"US, FR, JP, IT, GB\" etc. countires. The method should take \"US, FR, APAC\", and convert it to a list of \"US\", \"FR\", plus all the countries that are in \"APAC\".</p>\n\n<pre><code>private IEnumerable&lt;string&gt; Countries (string[] countriesAndAliases)\n{\n    var countries = new List&lt;string&gt;();\n\n    foreach (var countryOrAlias in countriesAndAliases)\n    {\n        if (IsCountryNotAlias(countryOrAlias))\n        {\n            countries.Add(countryOrAlias);\n        }\n        else \n        {\n            foreach (var aliasCountry in AliasCountryLists[countryOrAlias]) \n            {\n                countries.Add(aliasCountry);\n            }\n        }\n    }\n\n    return countries.Distinct();\n}\n</code></pre>\n\n<p>Is making this parallelized as simple as changing it to what's below? Is there more nuance to using <code>AsParallel()</code> than this? Should I be using <code>Parallel.ForEach()</code> instead of <code>foreach</code>? What rules of thumb should I use when parallelizing <code>foreach</code> loops?</p>\n\n<pre><code>private IEnumerable&lt;string&gt; Countries (string[] countriesAndAliases)\n{\n    var countries = new List&lt;string&gt;();\n\n    foreach (var countryOrAlias in countriesAndAliases.AsParallel())\n    {\n        if (IsCountryNotAlias(countryOrAlias))\n        {\n            countries.Add(countryOrAlias);\n        }\n        else \n        {\n            foreach (var aliasCountry in AliasCountryLists[countryOrAlias].AsParallel()) \n            {\n                countries.Add(aliasCountry);\n            }\n        }\n    }\n\n    return countries.Distinct();\n}\n</code></pre>\n"},{"tags":["c#","windows-phone-8"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4,"score":0,"question_id":13280863,"title":"live tile is not updating in Windows Phone","body":"<p>i am developing a windows phone app where application has an option to pin the application to home screen. And i am using ShellTileSchedule class to do schedule the update periodically. Some reason my app is not pushing any update to tile. My app data is completely local, no data is coming from outside.</p>\n\n<p>In my tile update, i am not updating any image on the lile, but only changing the data to display.</p>\n\n<pre><code> foreach (ShellTile tile in ShellTile.ActiveTiles)\n {\n            IconicTileData tileData = GetTileData();\n\n            tileSchedule = new ShellTileSchedule(tile, tileData);\n            tileSchedule.Interval = UpdateInterval.EveryHour;\n            tileSchedule.Recurrence = UpdateRecurrence.Interval;\n            tileSchedule.Count\n            tileSchedule.StartTime = DateTime.Now;\n            tileSchedule.Start();\n\n            tile.Update(tileData);\n}\n</code></pre>\n\n<p>Any help in this regard? Or do i need to background agent to update the tile?</p>\n"},{"tags":["c#",".net","google-api","google-analytics-api"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1314,"score":3,"question_id":9100770,"title":"Difference between Google API libraries: google-api-dotnet-client vs. google-gdata","body":"<p>What is the difference between the <a href=\"http://code.google.com/p/google-api-dotnet-client/\" rel=\"nofollow\">Google APIs Client Library for .NET</a> (google-api-dotnet-client) and <a href=\"http://code.google.com/p/google-gdata/\" rel=\"nofollow\">.NET library for the Google Data API </a> (google-gdata) as they pertain to the <a href=\"http://code.google.com/apis/analytics/\" rel=\"nofollow\">Google Analytics API</a>?</p>\n"},{"tags":["c#","windows-8","windows-store-apps","windows-live","windows-store"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13280783,"title":"Is it possible to communicate two WindowsStore apps through Windows Live SDK?","body":"<p>I plan to create a small application where the user can insert the email which is logged in in Windows 8 of the another computer.</p>\n\n<p>I want to create a communication through Sockets. Until I've investigated WINDOWS LIVE SDK will help me but I'm not really informated about that SDK. Is this correct?</p>\n"},{"tags":["c#","visual-studio-2010","windows-phone-7"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13279769,"title":"Call Method on application launching in Windows Phone SDK 7.1","body":"<p>I need to call a method normally fired by a button of the mainpage.xaml, when the application start.\nDo I need to use the Application_Launching method of the app.xaml? If yes, how?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","windows","button"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13273214,"title":"Programmatically Add \"Start Button\" To Windows 8","body":"<p>There have been others that have asked this question but the common registry setting that was suggested doesn't work any longer.  What I would like to do is something similar to StartIsBack that \"reinvokes\" the code to bring the Start Button/Menu back to Windows 8, or I could replicate the work done similar to the other Windows 8 start button alternatives.</p>\n\n<p>Does anyone know how to programmatically (C++ or C#) reinvoke the start button?</p>\n"},{"tags":["c#","algorithm","line","gradient","pixel"],"answer_count":6,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":367,"score":4,"question_id":4381269,"title":"Line rasterisation: Cover all pixels, regardless of line gradient?","body":"<p>Basically, I want to use a line algo to determine which cells to check for collisions for my raycaster.</p>\n\n<p><a href=\"http://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm\" rel=\"nofollow\">Bresenham</a> isn't great for this as it uses a unified-thickness approach, meaning that it ignores cells that aren't at least half-covering the line. Not great at all, because it means that some segments of my line aren't being checked for intersections with the cells, leading to errors.</p>\n\n<p>I can't seem to find any thick-line algorithms, can anyone help me find one?</p>\n\n<p><img src=\"http://i.stack.imgur.com/VRM4v.png\" alt=\"Red: Bad. Green: Good!\">\n<br>\nGreen: What I would like.<br>\nRed: What I currently have and don't want.</p>\n"},{"tags":["c#","wpf","filenotfoundexception"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":291,"score":0,"question_id":7413907,"title":"BitmapImage filenotfound exception (PresentationCore.resources) on construction","body":"<p>I have a problem with a BitmapImage in wpf. When i create it it gives a filenotfound exception, which says it's missing the PresentationCore.resources assembly. But i've added it to my references list and it still throws the same exception</p>\n\n<pre><code>Uri filename = new Uri(@\"D:\\barcode_zwart_wit.jpg\", UriKind.Absolute);\nBitmapImage image = new BitmapImage(filename); //&lt;-- FileNotFound Exception\n</code></pre>\n\n<ul>\n<li>The image uri is correct.<br/></li>\n<li>The image isn't opened somewhere else</li>\n<li>I've checked the version of the PresentationCore.resources, no problem there.<br/></li>\n<li>The lines are in the setter of a property, which is first launched in the constructor of a usercontrol.<br/></li>\n<li>Visual Studio 2010, .net v4</li>\n</ul>\n\n<p>Does anyone have any idea what's the problem? Does PresentationCore.resources have any dependencies i don't know about?</p>\n"},{"tags":["c#","javascript","ajax"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13280504,"title":"set focus on the first textbox on the page with ajax editor in .net","body":"<p>I a have a web form with few textboxes,dropdowns and finally towards the end of the page is 4 custom ajax editors. So on page load the focus is always inside the last editor and no way it comes to the first text box or top of page.On each page load the cursor goes inside the last editor control.How to bring the focus inside the first text box?\nBelow are the few methods i tried </p>\n\n<p><code>1.&lt;body onload=\"document.body.scrollTop = 0;\"&gt;</code></p>\n\n<pre><code>2.    void Page_Init(object sender, EventArgs e)\n{\n\n    SetFocus(txtReqtitle);\n\n\n}\n</code></pre>\n\n<p>for the above while loading the page i could see the focus goes to the desired text box and then it comes to the last custom control.</p>\n\n<pre><code>3.    if(!Page.ClientScript.IsStartupScriptRegistered(\"scrFocus\"))\n           {\n              string strScript=\"var txtBox=document.getElementById('\" + txtReqtitle.ClientID.ToString() +\"');txtBox.focus();\";\n               ClientScript.RegisterStartupScript(this.GetType(),\"scrFocus\", strScript,true);\n\n\n            }\n</code></pre>\n\n<p>4.</p>\n\n<pre><code>function setFocus() {\ndocument.getElementById(\"txtReqtitle\").focus();\n</code></pre>\n\n<p>}</p>\n\n<pre><code>5. ScriptManager.GetCurrent(this.Page).SetFocus(txtReqtitle);\n</code></pre>\n\n<p>Any ideas? Thanks..</p>\n"},{"tags":["c#","wpf",".net-assembly","serializable"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":40,"score":0,"question_id":13263043,"title":"c# Serializable Class - WPF MainWindow Exception Occurs","body":"<p>I have a WPF application which is hooking into a DLL that I am also writing. The DLL scans a data folder of a 3rd Party application and handles all the interpretation of data within. The WPF is to provide a nice GUI on top of that; I separated them because it may be necessary in the future to write a command line interface for it too.</p>\n\n<p>The scanning of the data folder takes some time so I wanted to save the state of the object (a Repository) and open that instead if the data folder has been scanned and retains the same 'Last Modified' state. I have marked the Repository object as [Serializable] however when I attempt to save the state (from either the WPF or the DLL) I get an exception that the WPF MainWindow is not [Serializable].</p>\n\n<p>If I read the created .dat file it does have some (not sure if all) information from that class.</p>\n\n<p>I don't understand why it would be trying to save any information about the WPF windows. I have tried to mark the window as [Serializable] just to try however that class does not allow it. Searching around the web had me looking into AppDomains since I'm loading a DLL along with the application but that is a little over my head. Below is how I am currently trying to implement it. Edit: The call to serialize is at the bottom of the WPF code. </p>\n\n<p>I should mention that I created an inline class within the WPF namespace and was able to successfully serialize that to a file.</p>\n\n<p>Any help is appreciated.</p>\n\n<p>This is the DLL:</p>\n\n<pre><code>namespace HPOO_XML_Parser\n{\n[Serializable]\npublic class HPOORepository\n{\n\n    string _version;\n    string _path;\n    string _library;\n    string _uuid;\n\n\n    [NonSerialized]\n    BackgroundWorker bWorker = new BackgroundWorker();\n    [NonSerialized]\n    XElement _xmlRepo;      \n\n\n    int _nodeCount;\n    List&lt;Node&gt; nodes;\n    ...\n    Rest of properties and methods\n}\n</code></pre>\n\n<p>And the WPF which calls it</p>\n\n<pre><code>namespace HPOO_Repository_Scanner\n{\n/// &lt;summary&gt;\n/// Interaction logic for MainWindow.xaml\n/// &lt;/summary&gt;\npublic partial class MainWindow : Window\n{\n    HPOORepository repo;\n\n    public MainWindow()\n    {\n        InitializeComponent();\n        StatusVisibility(); // Simply hides progress bar/cancel button\n    }\n\n    private void OpenRepository(object sender, RoutedEventArgs e)\n    {\n\n        string ooHome;\n        using (FolderBrowserDialog browser = new FolderBrowserDialog())\n        {\n            ooHome = Environment.GetEnvironmentVariable(\"ICONCLUDE_HOME\");\n            if (ooHome != null)\n            {\n                browser.SelectedPath = ooHome;\n            }\n            browser.ShowNewFolderButton = false;\n            browser.Description = \"Select a repository to open...\";\n\n            if (browser.ShowDialog() == System.Windows.Forms.DialogResult.OK)\n            {\n                try\n                {\n                    repo = new HPOORepository(browser.SelectedPath);\n                }\n                catch (Exception ex)\n                {\n                    System.Windows.MessageBox.Show(ex.Message, \"Invalid Repository Selected\", MessageBoxButton.OK, MessageBoxImage.Error);\n\n                }\n            }\n            repo.ProgressChanged += new ProgressChangedEventHandler(repo_ProgressChanged);\n\n            prgStatus.Maximum = 100;\n\n            repo.ReadRepository();\n\n        }\n\n    }\nprivate void mnuSave_Click(object sender, RoutedEventArgs e)\n    {\n        SaveRepo(repo);\n    }\n\n    public void SaveRepo(object repository)\n    {\n        BinaryFormatter binFormat = new BinaryFormatter();\n\n        using (Stream fStream = new FileStream(\"test\" + \".dat\",\n            FileMode.Create, FileAccess.Write, FileShare.None))\n        {\n            binFormat.Serialize(fStream, repository);\n        }\n    }\n</code></pre>\n\n<p>Edit: And finally the exception:</p>\n\n<pre><code>System.Runtime.Serialization.SerializationException was unhandled\nMessage=Type 'HPOO_Repository_Scanner.MainWindow' in Assembly 'HPOO Repository Scanner, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' is not marked as serializable.\nSource=mscorlib\nStackTrace:\n\n\n    at System.Runtime.Serialization.FormatterServices.InternalGetSerializableMembers(RuntimeType type)\n       at System.Runtime.Serialization.FormatterServices.GetSerializableMembers(Type type, StreamingContext context)\n       at System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.InitMemberInfo()\n       at System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.InitSerialize(Object obj, ISurrogateSelector surrogateSelector, StreamingContext context, SerObjectInfoInit serObjectInfoInit, IFormatterConverter converter, ObjectWriter objectWriter)\n       at System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.Serialize(Object obj, ISurrogateSelector surrogateSelector, StreamingContext context, SerObjectInfoInit serObjectInfoInit, IFormatterConverter converter, ObjectWriter objectWriter)\n       at System.Runtime.Serialization.Formatters.Binary.ObjectWriter.Write(WriteObjectInfo objectInfo, NameInfo memberNameInfo, NameInfo typeNameInfo)\n       at System.Runtime.Serialization.Formatters.Binary.ObjectWriter.Serialize(Object graph, Header[] inHeaders, __BinaryWriter serWriter, Boolean fCheck)\n       at System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.Serialize(Stream serializationStream, Object graph, Header[] headers, Boolean fCheck)\n       at System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.Serialize(Stream serializationStream, Object graph)\n       at HPOO_Repository_Scanner.MainWindow.SaveRepo(Object repository) in \\\\tsclient\\D\\Dropbox\\_Work\\Visual Studio Projects\\HPOO Repository Scanner\\HPOO Repository Scanner\\HPOO Repository Scanner\\MainWindow.xaml.cs:line 179\n       at HPOO_Repository_Scanner.MainWindow.mnuSave_Click(Object sender, RoutedEventArgs e) in \\\\tsclient\\D\\Dropbox\\_Work\\Visual Studio Projects\\HPOO Repository Scanner\\HPOO Repository Scanner\\HPOO Repository Scanner\\MainWindow.xaml.cs:line 168\n       at System.Windows.RoutedEventHandlerInfo.InvokeHandler(Object target, RoutedEventArgs routedEventArgs)\n       at System.Windows.EventRoute.InvokeHandlersImpl(Object source, RoutedEventArgs args, Boolean reRaised)\n       at System.Windows.UIElement.RaiseEventImpl(DependencyObject sender, RoutedEventArgs args)\n       at System.Windows.UIElement.RaiseEvent(RoutedEventArgs e)\n       at System.Windows.Controls.MenuItem.InvokeClickAfterRender(Object arg)\n       at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter)\n       at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)\n       at System.Windows.Threading.Dispatcher.WrappedInvoke(Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)\n       at System.Windows.Threading.DispatcherOperation.InvokeImpl()\n       at System.Windows.Threading.DispatcherOperation.InvokeInSecurityContext(Object state)\n       at System.Threading.ExecutionContext.runTryCode(Object userData)\n       at System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(TryCode code, CleanupCode backoutCode, Object userData)\n       at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)\n       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)\n       at System.Windows.Threading.DispatcherOperation.Invoke()\n       at System.Windows.Threading.Dispatcher.ProcessQueue()\n       at System.Windows.Threading.Dispatcher.WndProcHook(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)\n       at MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)\n       at MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o)\n       at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter)\n       at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)\n       at System.Windows.Threading.Dispatcher.WrappedInvoke(Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)\n       at System.Windows.Threading.Dispatcher.InvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Boolean isSingleParameter)\n       at System.Windows.Threading.Dispatcher.Invoke(DispatcherPriority priority, Delegate method, Object arg)\n       at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam)\n       at MS.Win32.UnsafeNativeMethods.DispatchMessage(MSG&amp; msg)\n       at System.Windows.Threading.Dispatcher.PushFrameImpl(DispatcherFrame frame)\n       at System.Windows.Threading.Dispatcher.PushFrame(DispatcherFrame frame)\n       at System.Windows.Threading.Dispatcher.Run()\n       at System.Windows.Application.RunDispatcher(Object ignore)\n       at System.Windows.Application.RunInternal(Window window)\n       at System.Windows.Application.Run(Window window)\n       at System.Windows.Application.Run()\n       at HPOO_Repository_Scanner.App.Main() in \\\\tsclient\\D\\Dropbox\\_Work\\Visual Studio Projects\\HPOO Repository Scanner\\HPOO Repository Scanner\\HPOO Repository Scanner\\obj\\x86\\Debug\\App.g.cs:line 0\n       at System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args)\n       at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)\n       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()\n       at System.Threading.ThreadHelper.ThreadStart_Context(Object state)\n       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)\n       at System.Threading.ThreadHelper.ThreadStart()\n  InnerException: \n</code></pre>\n"},{"tags":["c#",".net","https"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13277657,"title":"How do I download the contents of a HTTPS web page?","body":"<p>To get to the page, I need a password. I have the password and I can get to the page.</p>\n\n<p>The DownloadString(URL) function is downloading the contents of the LOG-IN page and not the actual page I want. Why?</p>\n\n<pre><code>using (var client = new WebClient())\n            {\n                var credentials = new NetworkCredential { UserName = \"username\", Password = \"password\" };\n                client.Credentials = credentials;\n\n                string pageContents = client.DownloadString(url);\n\n                if (pageContents.Contains(\"cheetah\"))\n                {\n                    MessageBox.Show(\"yes!\");\n                }\n                else\n                {\n                    MessageBox.Show(\"No\");\n                }\n            }\n</code></pre>\n\n<p>The above is getting the contents of the LOG-IN page as opposed to the page I really want. How do I get passed this?</p>\n"},{"tags":["c#","sockets","https","dns","tunnel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13279475,"title":"Tunnel HTTP, HTTPS and DNS in C#","body":"<p>I want all web traffic (HTTP, HTTPS and DNS - Are there any others?) goes through a local application and goes to a server application and from there goes to internet. How can I do this?</p>\n\n<p>I have wrote an Async TCP server and I know socket Async programming in C# using SocketAsyncEventArgs (I am not a master with just one project but I think I can understand some basics).</p>\n"},{"tags":["c#","jquery","asp.net",".net","sql-server-2005"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":116,"score":0,"question_id":10489740,"title":"Good way to determine if someone left a webpage","body":"<p>I am trying to code an app for work where our clients can edit certain fields. When they click edit, the code will lock the data to be editted. And when they click save the data will unlock. But I am having trouble deciding if I can unlock the data when they click elsewhere, go to another page or site, or even close the browser.</p>\n\n<p>What's a good way to decide if the user has left the edit page?</p>\n\n<p>(We are using C# .NET 3.5 and JQuery and a SQL Server 2005 DB).</p>\n"},{"tags":["c#","xaml","windows-8"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":2,"view_count":35,"score":1,"question_id":13280050,"title":"How do you develop Windows 8 lock screen app?","body":"<p>I want to put some info on my lock screen in Windows 8. can I do my app for that? can it be done in C# / XAML?</p>\n"},{"tags":["c#","c++","dll","function-pointers"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13280323,"title":"Calling a DLL function that contains a function pointer from C#","body":"<p>I have a DLL that is written in C++ that includes exported function that has a function pointers to be used as callback function. </p>\n\n<pre><code>// C++ \nDllExport unsigned int DllFunctionPointer( unsigned int i, unsigned int (*TimesThree)( unsigned int number ) ) {\n    return TimesThree( i )  ; \n}\n</code></pre>\n\n<p>I have a CSharp application that I would like to use to invoke the DLL functions. </p>\n\n<pre><code>// C#\npublic unsafe delegate System.UInt32 CallBack( System.UInt32 number ); \nclass Program\n{\n    [DllImport(\"SimpleDLL.dll\")]\n    public static extern System.UInt32 DllFunctionPointer( System.UInt32 i, CallBack cb) ;\n\n    static unsafe void Main(string[] args)\n    {\n        System.UInt32 j = 3;\n        System.UInt32 jRet = DllFunctionPointer(j, CallBack );\n        System.Console.WriteLine(\"j={0}, jRet={1}\", j, jRet); \n    }\n\n    static System.UInt32 CallBack( System.UInt32 number ) {\n        return number * 3 ; \n    }\n}\n</code></pre>\n\n<p>The problem with the above code is that the application crashes with the following error message. </p>\n\n<pre><code>'CallingACallbackFromADLL.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\\XXXX\\CallingACallbackFromADLL.exe', Symbols loaded.\nManaged Debugging Assistant 'PInvokeStackImbalance' has detected a problem in 'C:\\XXXX\\CallingACallbackFromADLL.vshost.exe'.\nAdditional Information: A call to PInvoke function 'CallingACallbackFromADLL!CallingACallbackFromADLL.Program::DllFunction' has unbalanced the stack. This is likely because the managed PInvoke signature does not match the unmanaged target signature. Check that the calling convention and parameters of the PInvoke signature match the target unmanaged signature.\n\nThe program '[9136] CallingACallbackFromADLL.vshost.exe: Managed (v4.0.30319)' has exited with code 1073741855 (0x4000001f).\n</code></pre>\n\n<p>I am not sure what to do next. </p>\n\n<p>My question is: </p>\n\n<ul>\n<li>What is the correct way to call a C++ DLL function that contains a Callback pointer from a C# application. </li>\n</ul>\n"},{"tags":["c#",".net","wmi","sysadmin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":182,"score":0,"question_id":11508844,"title":"Mount Network Drive with WMI","body":"<p>Trying to write a WMI class function to mount a network drive on any computer (remote or local) using the credentials of the logged in computer. </p>\n\n<p>This is a class for a larger project that I wrote for help desk staff to do first line fixes on remote PC's. The tech types in the the machine name or ip address and the app connects to it and allows to tech to click a couple of buttons and fix some basic items without having to remote(VNC) into the PC. </p>\n\n<p>I've read all over the internet that it is much easier ways than WMI, but due to the remote nature of the app I would rather not use local API calls, nor do I want to worry about uploading script and executing it though a process start. Also other functions are already in WMI so I'd like to keep the code base the same. </p>\n\n<p>The basic idea is to mount <code>H:</code> to <code>//fileserver.example.com/$username</code></p>\n\n<p>NetFixer is already in production use so I'm trying to keep my code nice and neat </p>\n\n<p><img src=\"http://i.stack.imgur.com/2yDn5.png\" alt=\"enter image description here\"></p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Management;\n\nnamespace WMIcontrols\n{\n  public class Remote\n  {\n\n   public string target;\n\n   //Some code skipped here for simplicity sake... \n\n   public bool MountNetDrive(string DriveLetter, string MountLocation)\n    {\n      try\n      {\n          //Mount the network drive\n          return true;\n      }\n      catch\n      {\n          //Mount Failed\n          return false;\n      }\n    }\n  }\n}\n</code></pre>\n"},{"tags":["c#","c#-4.0"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13280358,"title":"cast byte array to object array","body":"<p>Why is </p>\n\n<pre><code>object h = new byte();\n</code></pre>\n\n<p>possible and </p>\n\n<pre><code>object[] h = new byte[5];\n</code></pre>\n\n<p>is not?</p>\n\n<p>How to cast a byte Array to an object Array?</p>\n\n<p>Thank You!</p>\n"},{"tags":["c#","asp.net","ms-word"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13276821,"title":"How to insert Page break when creating MS Word document","body":"<p>I trying to create a Word document via C#. I want to be able to insert a page break at a certain point in my code, however I am not sure on how to do this. I am mostly using StringBuilder to create the html.\nThis is being done in Visual studios 2008 with c#. I've looked at some guides but most of them use code like \"Word variable\". So I'm not sure if \"Word\" comes from an extra downloaded library or what not.</p>\n"},{"tags":["c#","xaml","windows-8","microsoft-metro","c#-4.5"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13280292,"title":"Where in Windows 8 app should you code 'privacy policy'?","body":"<p>my app failed certification with reason : <em>\"4.1.1 Your app must have a privacy statement if it is network-capable\n. . .\nYou must provide access to your privacy policy in the Description page of your app, as well as in the app’s settings as displayed in the Windows Settings charm.\"</em></p>\n\n<p>What are they talking about? what description? how do I set info displayed in windows settings?</p>\n\n<p>the app is C#</p>\n"},{"tags":["c#","asp.net","asp.net-mvc","wcf","http"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":120,"score":0,"question_id":13063983,"title":"Run asynchronous operation in one controller method and get that operation's result in another","body":"<p>I have a long running operation you might read in couple of my another questions (for your reference here is <a href=\"http://stackoverflow.com/questions/12836060/articles-on-how-to-organize-background-queue-operations\">first</a> and <a href=\"http://stackoverflow.com/questions/12900382/how-to-determine-progress-of-pending-operations-in-queue\">second</a>). </p>\n\n<p>In the beginning of whole deal, project expose a form in which user should specify all necessary information about XML file and upload XML file itself. In that method all user input data caught and went to an WCF service that handles such king of files. Controller got only task id of such processing. \nThen user got redirected to progress bar page and periodically retrieves status of task completeness, refreshes the progress bar.</p>\n\n<p>So here is my issue comes. When processing of XML file if over, how can I get results back and show them to user?</p>\n\n<p>I know that HTTP is stateless protocol but there is cookie mechanism that could help in this situation. Of course, I may just save processing results to some temporary place, like a static class in WCF server, but there is a high load on service, so it will eat all of supplied memory.</p>\n\n<p>In other words, I would like to pass task to WCF service (using netNamedPipeBinding) and receive results back as fast as it really possible. I want to escape temporary saving result to some buffer and wait until client will gather it back.</p>\n\n<hr>\n\n<p>As far as I go is using temporary buffer not on service side but at client's:</p>\n\n<pre><code>using (XmlProcessingServiceClient client = new XmlProcessingServiceClient())\n{\n    client.AnalyzeXmlAsync(new Task { fileName = filePath, id = tid });\n    client.AnalyzeXmlCompleted += (sender, e) =&gt;\n    {\n        System.Web.HttpContext.Current.Application.Lock();\n        // here is I just use single place for all clients. I know it is not right, it is just for illustrating purposes.\n        System.Web.HttpContext.Current.Application[\"Result\"] = e;\n        System.Web.HttpContext.Current.Application.UnLock();\n    };\n}\n</code></pre>\n"},{"tags":["c#","xna","sprites"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13279452,"title":"I can't make my sprite move","body":"<p>I'm a complete newbie at XNA and I am currently learning from this tutorial: </p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/bb203893.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/bb203893.aspx</a></p>\n\n<p>The problem occurs when running the program after completion of step five. I don't think it's a typo as others have pointed out the same problem in the comments.</p>\n\n<p>My sprite is meant to bounce around the screen automatically when my program is run, however is does not move even a pixel from 0,0. </p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing Microsoft.Xna.Framework;\nusing Microsoft.Xna.Framework.Audio;\nusing Microsoft.Xna.Framework.Content;\nusing Microsoft.Xna.Framework.GamerServices;\nusing Microsoft.Xna.Framework.Graphics;\nusing Microsoft.Xna.Framework.Input;\nusing Microsoft.Xna.Framework.Media;\n\nnamespace WindowsGame1\n{\n\npublic class Game1 : Microsoft.Xna.Framework.Game\n{\n    GraphicsDeviceManager graphics;\n    SpriteBatch spriteBatch;\n\n    public Game1()\n    {\n        graphics = new GraphicsDeviceManager(this);\n        Content.RootDirectory = \"Content\";\n    }\n\n\n    protected override void Initialize()\n    {\n\n\n        base.Initialize();\n    }\n\n    Texture2D myTexture;\n\n    Vector2 spritePosition = Vector2.Zero;\n\n    Vector2 spriteSpeed = new Vector2(50.0f, 50.0f);\n\n    protected override void LoadContent()\n    {\n\n        spriteBatch = new SpriteBatch(GraphicsDevice);\n        myTexture = Content.Load&lt;Texture2D&gt;(\"Main\");\n\n    }\n\n\n    protected override void UnloadContent()\n    {\n\n    }\n\n\n     void UpdateSprite(GameTime gameTime)\n    {\n        //Move the sprite by speed, scaled by elapsed time\n\n         spritePosition +=\n            spriteSpeed * (float)gameTime.ElapsedGameTime.TotalSeconds;\n\n        int MaxX =\n            graphics.GraphicsDevice.Viewport.Width - myTexture.Width;\n         int MinX = 0;\n\n         int MaxY =\n             graphics.GraphicsDevice.Viewport.Height - myTexture.Height;\n         int MinY = 0;\n\n         //Check for bounce.\n         if (spritePosition.X &gt; MaxX)\n         {\n             spriteSpeed.X *= -1;\n             spritePosition.X = MaxX;\n\n         }\n\n         else if (spritePosition.X &lt; MinX)\n         {\n             spriteSpeed.X *= -1;\n             spritePosition.X = MinX;\n\n         }\n\n         if (spritePosition.Y &gt; MaxY)\n         {\n             spriteSpeed.Y *= -1;\n             spritePosition.Y = MaxY;\n         }\n\n         else if (spritePosition.Y &lt; MinY)\n         {\n             spriteSpeed.Y *= -1;\n             spritePosition.Y = MinY;\n         }\n\n\n    }\n\n\n    protected override void Draw(GameTime gameTime)\n    {\n        GraphicsDevice.Clear(Color.CornflowerBlue);\n\n\n\n        spriteBatch.Begin(SpriteSortMode.BackToFront, BlendState.AlphaBlend);\n        spriteBatch.Draw(myTexture, spritePosition, Color.White);\n        spriteBatch.End();\n\n        base.Draw(gameTime);\n    }\n  }\n}\n</code></pre>\n"},{"tags":["c#","image","ocr"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2683,"score":0,"question_id":5632522,"title":"c# Bitmap.Save A generic error occurred in GDI+ windows application","body":"<p>I am doing OCR application. I have this error when I run the system which the system will save the picturebox3.image into a folder.</p>\n\n<pre><code>//When user is selecting, RegionSelect = true\n    private bool RegionSelect = false;\n    private int x0, x1, y0, y1;\n    private Bitmap bmpImage;\n\nprivate void loadImageBT_Click(object sender, EventArgs e)\n{\n    try\n    {\n        OpenFileDialog open = new OpenFileDialog();\n        open.InitialDirectory = @\"C:\\Users\\Shen\\Desktop\";\n\n        open.Filter = \"Image Files(*.jpg; *.jpeg)|*.jpg; *.jpeg\";\n\n        if (open.ShowDialog() == DialogResult.OK)\n        {\n            singleFileInfo = new FileInfo(open.FileName);\n            string dirName = System.IO.Path.GetDirectoryName(open.FileName);\n            loadTB.Text = open.FileName;\n            pictureBox1.Image = new Bitmap(open.FileName);\n            bmpImage = new Bitmap(pictureBox1.Image);\n        }\n\n    }\n    catch (Exception)\n    {\n        throw new ApplicationException(\"Failed loading image\");\n    }\n}\n\n//User image selection Start Point\nprivate void pictureBox1_MouseDown(object sender, MouseEventArgs e)\n{\n    RegionSelect = true;\n\n    //Save the start point.\n    x0 = e.X;\n    y0 = e.Y;\n}\n\n//User select image progress\nprivate void pictureBox1_MouseMove(object sender, MouseEventArgs e)\n{\n    //Do nothing it we're not selecting an area.\n    if (!RegionSelect) return;\n\n    //Save the new point.\n    x1 = e.X;\n    y1 = e.Y;\n\n    //Make a Bitmap to display the selection rectangle.\n    Bitmap bm = new Bitmap(bmpImage);\n\n\n    //Draw the rectangle in the image.\n    using (Graphics g = Graphics.FromImage(bm))\n    {\n        g.DrawRectangle(Pens.Red, Math.Min(x0, x1), Math.Min(y0, y1), Math.Abs(x1 - x0), Math.Abs(y1 - y0));\n    }\n\n    //Temporary display the image.\n    pictureBox1.Image = bm;\n}\n\n//Image Selection End Point\nprivate void pictureBox1_MouseUp(object sender, MouseEventArgs e)\n{\n    // Do nothing it we're not selecting an area.\n    if (!RegionSelect) return;\n    RegionSelect = false;\n\n    //Display the original image.\n    pictureBox1.Image = bmpImage;\n\n    // Copy the selected part of the image.\n    int wid = Math.Abs(x0 - x1);\n    int hgt = Math.Abs(y0 - y1);\n    if ((wid &lt; 1) || (hgt &lt; 1)) return;\n\n    Bitmap area = new Bitmap(wid, hgt);\n    using (Graphics g = Graphics.FromImage(area))\n    {\n        Rectangle source_rectangle = new Rectangle(Math.Min(x0, x1), Math.Min(y0, y1), wid, hgt);\n        Rectangle dest_rectangle = new Rectangle(0, 0, wid, hgt);\n        g.DrawImage(bmpImage, dest_rectangle, source_rectangle, GraphicsUnit.Pixel);\n    }\n\n    // Display the result.\n    pictureBox3.Image = area;\n\n\n    ** ERROR occuer here!!!!!**\n    area.Save(@\"C:\\Users\\Shen\\Desktop\\LenzOCR\\TempFolder\\tempPic.jpg\"); // error line occcur\n\n    singleFileInfo = new FileInfo(\"C:\\\\Users\\\\Shen\\\\Desktop\\\\LenzOCR\\\\TempFolder\\\\tempPic.jpg\");\n}\n\n\n       private void ScanBT_Click(object sender, EventArgs e)\n{\n    var folder = @\"C:\\Users\\Shen\\Desktop\\LenzOCR\\LenzOCR\\WindowsFormsApplication1\\ImageFile\";\n\n    DirectoryInfo directoryInfo;\n    FileInfo[] files;\n    directoryInfo = new DirectoryInfo(folder);\n    files = directoryInfo.GetFiles(\"*.jpg\", SearchOption.AllDirectories);\n\n    var processImagesDelegate = new ProcessImagesDelegate(ProcessImages2);\n    processImagesDelegate.BeginInvoke(files, null, null);     \n\n    //BackgroundWorker bw = new BackgroundWorker();\n    //bw.DoWork += new DoWorkEventHandler(backgroundWorker1_DoWork);\n    //bw.RunWorkerAsync(bw);\n    //bw.RunWorkerCompleted += new RunWorkerCompletedEventHandler(backgroundWorker1_RunWorkerCompleted);\n}\n\nprivate void ProcessImages2(FileInfo[] files)\n{\n    var comparableImages = new List&lt;ComparableImage&gt;();\n\n    var index = 0x0;\n\n    foreach (var file in files)\n    {\n        if (exit)\n        {\n            return;\n        }\n\n        var comparableImage = new ComparableImage(file);\n        comparableImages.Add(comparableImage);\n        index++;\n    }\n\n    index = 0;\n\n    similarityImagesSorted = new List&lt;SimilarityImages&gt;();\n    var fileImage = new ComparableImage(singleFileInfo);\n\n    for (var i = 0; i &lt; comparableImages.Count; i++)\n    {\n        if (exit)\n            return;\n\n        var destination = comparableImages[i];\n        var similarity = fileImage.CalculateSimilarity(destination);\n        var sim = new SimilarityImages(fileImage, destination, similarity);\n        similarityImagesSorted.Add(sim);\n        index++;\n    }\n\n    similarityImagesSorted.Sort();\n    similarityImagesSorted.Reverse();\n    similarityImages = new BindingList&lt;SimilarityImages&gt;(similarityImagesSorted);\n\n    var buttons =\n        new List&lt;Button&gt;\n            {\n                ScanBT\n            };\n\n    if (similarityImages[0].Similarity &gt; 70)\n    {\n        con = new System.Data.SqlClient.SqlConnection();\n        con.ConnectionString = \"Data Source=SHEN-PC\\\\SQLEXPRESS;Initial Catalog=CharacterImage;Integrated Security=True\";\n        con.Open();\n\n        String getFile = \"SELECT ImageName, Character FROM CharacterImage WHERE ImageName='\" + similarityImages[0].Destination.ToString() + \"'\";\n        SqlCommand cmd2 = new SqlCommand(getFile, con);\n        SqlDataReader rd2 = cmd2.ExecuteReader();\n\n        while (rd2.Read())\n        {\n            for (int i = 0; i &lt; 1; i++)\n            {\n                string getText = rd2[\"Character\"].ToString();\n                Action showText = () =&gt; ocrTB.AppendText(getText);\n                ocrTB.Invoke(showText);\n            }\n        }\n        con.Close();\n    }\n    else\n    {\n        MessageBox.Show(\"No character found!\", \"Error!\", MessageBoxButtons.OK, MessageBoxIcon.Error);\n    }\n\n}\n#endregion\n</code></pre>\n"},{"tags":["c#",".net","windows","windows-8","winrt"],"answer_count":5,"favorite_count":6,"up_vote_count":12,"down_vote_count":0,"view_count":2470,"score":12,"question_id":7426492,"title":"Can old native applications run on Windows8 tablet version?","body":"<p><img src=\"http://i.stack.imgur.com/5TCIt.png\" alt=\"enter image description here\"></p>\n\n<p>I don't understand this picture well.\nIn the Metro style Apps, what does C/C++ mean? Native C/C++? or is it managed C++? They(Metro style apps) don't even have Win32 layer!</p>\n\n<p>To make an application which compatible with both Metro style and Desktop, should we only use .NET code? The old native applications can run on Windows8 Tablet?</p>\n"},{"tags":["c#","asp.net-mvc-3","forms-authentication"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13280273,"title":"Forms authentication in asp.net mvc 3 - ActionResult Register method - how to?","body":"<p>can you please help me. I have written logon and logout methods correctly using forms authentication in asp.net mvc 3.</p>\n\n<pre><code>[HttpPost]\n        public ActionResult LogOn(Guest guest, String returnURL, bool RememberMe = false)\n        {\n            var isValidURL = bl.IsValidReturnUrl(returnURL);\n\n            if (!ModelState.IsValid)\n            {\n                ModelState.AddModelError(\"\", \"The username or password provider is incorrect\");\n                return View(guest);\n            }\n\n            if (bl.IsUserValidated(guest.Username, guest.Password))\n            {\n                FormsAuthentication.SetAuthCookie(guest.Username, RememberMe);\n                if (isValidURL)\n                    return Redirect(returnURL);\n                else\n                    return RedirectToAction(\"Home\", \"Index\");\n            }\n            return View(guest);\n        }\n</code></pre>\n\n<p>How to write a <strong>Register</strong> controller method, I don't know where to start, I have my own database in which I should insert new registered users with their username, password and email. Thanks</p>\n"},{"tags":["c#","asp.net",".net","c#-4.0","iis-7.5"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":7,"score":1,"question_id":13280347,"title":"FormsAuthentication.RedirectToLoginPage Not Working When Application at Root of Site","body":"<p>The application (ASP.Net 4 / C#) I've been developing uses FormsAuthentication.RedirectToLoginPage() to send the user back to the login page after he/she has clicked on a Logout button. </p>\n\n<p>I'm finding that when the application is deployed at the root of a IIS Site, the redirect does not work. Clicking on the logout button simply reloads the page.</p>\n\n<p>When the application is deployed to an Application virtual folder within the site, the redirect works property.</p>\n\n<p>I've also tried using Respond.Redirect(), which also does not work. I've tried recreating the site from scratch (no luck). </p>\n\n<p>The code for the logout button:</p>\n\n<pre><code>    protected void lbLogout_Click(object sender, EventArgs e)\n    {\n        FormsAuthentication.SignOut();\n        Session.Abandon();\n\n        // clear authentication cookie\n        HttpCookie cookie1 = new HttpCookie(FormsAuthentication.FormsCookieName, \"\");\n        cookie1.Expires = DateTime.Now.AddYears(-1);\n        cookie1.Path = FormsAuthentication.FormsCookiePath;\n        cookie1.HttpOnly = true;\n        Response.Cookies.Add(cookie1);\n\n        // clear session cookie \n        HttpCookie cookie2 = new HttpCookie(\"ASP.NET_SessionId\", \"\");\n        cookie2.Expires = DateTime.Now.AddYears(-1);\n        Response.Cookies.Add(cookie2);\n\n        FormsAuthentication.RedirectToLoginPage();\n        //Response.Redirect(\"~/login.aspx\");\n        Response.End();\n    }\n</code></pre>\n\n<p>Thanks for the help!</p>\n"},{"tags":["c#",".net","cluster-analysis","levenshtein-distance","string-similarity"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":69,"score":2,"question_id":13275408,"title":"String similar to a set of strings","body":"<p>I need to compare a set of strings to another set of strings and find which strings are similar (fuzzy-string matching). \nFor example: </p>\n\n<pre><code>{ \"A.B. Mann Incorporated\", \"Mr. Enrique Bellini\", \"Park Management Systems\" } \nand\n{ \"Park\", \"AB Mann Inc.\", \"E. Bellini\" }\n</code></pre>\n\n<p>Assuming a zero-based index, the matches would be 0-1, 1-2, 2-0. Obviously, no algorithm can be perfect at this type of thing.</p>\n\n<p>I have a working implementation of the Levenshtein-distance algorithm, but using it to find similar strings from each set necessitates looping through both sets of strings to do the comparison, resulting in an O(n^2) algorithm. This runs unacceptably slow even with modestly sized sets.</p>\n\n<p>I've also tried a <a href=\"http://matpalm.com/resemblance/jaccard_coeff/\" rel=\"nofollow\">clustering algorithm</a> that uses shingling and the Jaccard coefficient. Unfortunately, this too runs in O(n^2), which ends up being too slow, even with bit-level optimizations. </p>\n\n<p>Does anyone know of a more efficient algorithm (faster than O(n^2)), or better yet, a library already written in C#, for accomplishing this? </p>\n"},{"tags":["c#","sharepoint","sharepoint2010","content-type","sharepoint-designer"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13280088,"title":"How to change default Content type of Wiki Library items in Sharepoint 2010","body":"<p>I am working on a SharePoint 2010 Wiki Library. The items in the Wiki Library have a default content type 'Wiki Page'. </p>\n\n<p>I have created my custom content type with some additional fields. I would like to change the default content type and assign my custom content type to existing items in Wiki Library i.e. from 'Wiki Page' to 'My Custom Content Type'</p>\n\n<p>Please let me know how we can go about changing the content type in Wiki Library.</p>\n\n<p>Any comment/feedback is greaatly appreciated.</p>\n\n<p>Thank you!</p>\n"},{"tags":["c#","forms","datagridview","resize"],"answer_count":4,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":10567,"score":4,"question_id":1607790,"title":"C# Auto Resize Form to DataGridView's size","body":"<p>I have a Form and a DataGridView. I populate the DataGridView at runtime, so I want to know how do I resize the Form dynamically according to the size of the DataGridView? Is there any sort of property or method? Or do I have to determine the size myself and update accordingly?</p>\n"},{"tags":["c#","generics","generic-programming"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":26,"score":5,"question_id":13280294,"title":"Retrieving the unclosed type of a generic type closing a generic type","body":"<p>I’m having an issue (probably due to my lack of familiarity of C# generics) in getting the unclosed type of a generic. I have several methods that look rather similar to the following except for the explicit validator interface in use. </p>\n\n<pre><code>public IEnumerable&lt;IDeleteValidator&lt;T&gt;&gt; GetDeleteValidators&lt;T&gt;()\n{\n    var validatorList = new List&lt;IDeleteValidator&lt;T&gt;&gt;();\n    foreach (var type in GetRecursiveBaseTypesAndInterfaces(typeof(T)))\n    {\n        var validatorType = typeof(IDeleteValidator&lt;&gt;).MakeGenericType(type);\n        var validators = ObjectFactory\n            .GetAllInstances(validatorType).Cast&lt;IDeleteValidator&lt;T&gt;&gt;();\n        validatorList.AddRange(validators);\n    }\n    return validatorList;\n}\n</code></pre>\n\n<p>The method GetRecursiveBaseTypesAndInterfaces does as it says and gathers all base types and interfaces of a given type. So what I'm eventually doing is getting the unclosed type of the explicit validator interface and getting it's type as closed on each of the original type T's base classes and interfaces. This works great, however I'd like to clean up my code and accomplish this in a more generic form than above</p>\n\n<p>knowing that any validator of T will extend IValidator (as bellow)</p>\n\n<pre><code>public interface IDeleteValidator&lt;in T&gt; : IValidator&lt;T&gt; {}\n</code></pre>\n\n<p>My <strong>uncompleted</strong> attempt at a generic version of the above method looks like:</p>\n\n<pre><code>public IEnumerable&lt;TValidator&gt; GetValidators&lt;T, TValidator&gt;() \n    where TValidator : IValidator&lt;T&gt;\n{\n    var validatorList = new List&lt;TValidator&gt;();\n    foreach (var type in GetRecursiveBaseTypesAndInterfaces(typeof(T)))\n    {\n        var unclosedType = ???\n        var validatorType = typeof(unclosedType).MakeGenericType(type);\n        var validators = ObjectFactory\n            .GetAllInstances(validatorType).Cast&lt;TValidator&gt;();\n        validatorList.AddRange(validators);\n    }\n    return validatorList;\n}\n</code></pre>\n\n<p>How do I define <em>unclosedType</em> (or restructure the method) to do the same work as the original method with a call to</p>\n\n<pre><code>GetValidators&lt;Whatever, IDeleteValidator&lt;Whatever&gt;&gt;();\n</code></pre>\n\n<p>Or would it be possible to refine my method more so as a call like the following would be sufficient?</p>\n\n<pre><code>GetValidators&lt;IDeleteValidator&lt;Whatever&gt;&gt;();\n</code></pre>\n"},{"tags":["c#","asp.net"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13279944,"title":"multiply value in 2 dropdownlists","body":"<p>I have the best part of 2 days trying to figure out how to \"times 2 dropdownlists\" with each other and show it in a label...</p>\n\n<p>like in math when u mutiple 2 numbers..</p>\n\n<p>plzz help me...</p>\n\n<p>all suggestions are welcome</p>\n\n<pre><code>Protected void Button1_Click(object sender, EventArgs e)\n{\n     int amount1 = int.parse(DropDownList1.selectedValue.ToString());\n     int amount2 = int.parse(DropDownList1.selectedValue.ToString());\n\n     Label.Text = amount1 * amount2;\n}\n</code></pre>\n\n<p>i get an error:</p>\n\n<p>Cannot implicitly convert type 'Int' to 'string</p>\n"},{"tags":["c#","selenium","ipv6"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":147,"score":5,"question_id":10735404,"title":"Selenium has an IPv6 issue when using firefoxdriver","body":"<p>I am trying to use Selenium to drive some web tests in Firefox, however when I do this</p>\n\n<pre><code>FirefoxDriver _driver = new FirefoxDriver();\n</code></pre>\n\n<p>I get this  exception</p>\n\n<blockquote>\n  <p>An address incompatible with the requested protocol was used\n  [::1]:7055</p>\n</blockquote>\n\n<p>This appears to be some sort of IPv6 vs IPv4 issue that selenium is not going to fix. however I need to work around it. Disabling IPv6 on my Ethernet makes no difference. what else can I try?</p>\n\n<p>Cheers</p>\n"},{"tags":["c#","javascript","video","overlay"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13280277,"title":"Show video overlay from clicking linkButton","body":"<p>I have a page with a gridview.\nOn of the columns is showing an play icon depending on whether there is an video-url in the database. This part is :</p>\n\n<pre><code>&lt;asp:TemplateField HeaderText=\"\" ItemStyle-CssClass=\"video\" &gt;\n    &lt;ItemTemplate&gt;\n        &lt;asp:LinkButton ID=\"lbtVideoUrl\" runat=\"server\" OnClientClick=\"javascript:clicker('http://www.youtube.com/watch?v=qySK7GWFEAg')\" &gt;&lt;img class='&lt;%# Eval(\"Class\", \"{0}\")  %&gt;' src='&lt;%# Eval(\"VideoImage\", \"{0}\")  %&gt;' alt=\"Video\" title='&lt;%# Eval(\"ToolTip\", \"{0}\")  %&gt;' /&gt;&lt;/asp:LinkButton&gt;\n    &lt;/ItemTemplate&gt;\n&lt;/asp:TemplateField&gt;\n</code></pre>\n\n<p>The javascript that should handle this is : </p>\n\n<pre><code>function clicker(theUrl) {\n    var thediv = document.getElementById('displaybox');\n    if (thediv.style.display == \"none\") {\n            thediv.style.display = \"\";\n            thediv.innerHTML = \"&lt;table width='100%' height='100%'&gt;&lt;tr&gt;&lt;td align='center' valign='middle' width='100%' height='100%'&gt;&lt;object width='640' height='360'&gt;&lt;param name='movie' value='\" + theUrl + \"'&gt;&lt;/param&gt;&lt;param name='allowFullScreen' value='true'&gt;&lt;/param&gt;&lt;param name='allowscriptaccess' value='always'&gt;&lt;/param&gt;&lt;embed src='\" + theUrl + \"' type='application/x-shockwave-flash' width='640' height='360' allowscriptaccess='always' allowfullscreen='true'&gt;&lt;/embed&gt;&lt;/object&gt;&lt;br&gt;&lt;br&gt;&lt;a href='#' onclick='return clicker();'&gt;CLOSE WINDOW&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;\";\n    } else {\n        thediv.style.display = \"none\";\n        thediv.innerHTML = '';\n    }\n    return false;\n}\n</code></pre>\n\n<p>However, when i click the button i see the gray overlay and the video field, but before anything is shown the overlay is closed again. I must be missing something, but have no clue what....</p>\n\n<p>One more piece of info (don't know if it is relevant) : i had to add the following to the code behind to get it 'working' so far :</p>\n\n<pre><code>protected void gv_SelectedIndexChanged(object sender, EventArgs e)\n{\n}\n</code></pre>\n\n<p>PS next step is getting the url from the database, so i can add different links to different icons.</p>\n"},{"tags":["c#","hash",".net-3.5","md5"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":27,"score":-1,"question_id":13280271,"title":"Chose checksum algorithm for comparing files","body":"<p>I have to sync up few thousands of files on a regular basis while checking for duplicates. Currently I check the file lengths followed by last byte for each file. If there are clashes, I calculate MD5 hash for the next round of comparison. However, hashing is currently becoming a bottleneck on large files. File sizes are diverse and range between 100kb and 4gb. Can I use some other algorithm other than MD5. I just need a reliable and fast algorithm to calculate the checksum and do not even need to use any cryptographic classes.</p>\n"},{"tags":["c#","arrays","sum","average"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":32,"score":0,"question_id":13279532,"title":"Finding average of the numbers user's type into an array","body":"<p>Could someone please explain to me why my average keeps coming as 0 when I run my program? I have listed the entire code of my project on here and have literally never used arrays before.  Also, is the name of this array mData? I tried reading in my book to determine what to look for in these items and have come up with nothing.</p>\n\n<pre><code>public partial class frmMain : Form\n{\n\n    private const int mSize = 20;\n    private int[] mData = new int[mSize];\n    private int mIndex = 0;\n\n\n    private static void Main()\n    {\n        frmMain main = new frmMain();\n        Application.Run(main);\n    }\n    private frmMain()\n    {\n        InitializeComponent();\n    }\n\n    private void btnEnter_Click(object sender, EventArgs e)\n    {\n        int num;\n        num = int.Parse(txtInput.Text);\n\n        //store num in the array\n        mData[mIndex] = num;\n        mIndex = mIndex + 1;\n\n        //check for full array\n        if (mIndex == mSize)\n        {\n            //inform user that array is full\n            MessageBox.Show(\"The array is full.\");\n            btnEnter.Enabled = false;\n        }\n    }\n\n    private void btnExit_Click(object sender, EventArgs e)\n    {\n        Close();\n    }\n\n    private void btnDisplay_Click(object sender, EventArgs e)\n    {\n        int n;\n\n        for (n = 0; n &lt; mIndex; n++)\n            listBoxOutput.Items.Add(mData[n]);\n    }\n\n    private void btnAverage_Click(object sender, EventArgs e)\n    {\n\n        int sum = 0;\n        int average = 0;\n\n        if (mIndex == 0)\n        {\n            //inform user that array is empty\n            MessageBox.Show(\"The array is empty.\");\n        }\n\n        //add up the values\n        for (int i = 0; i &lt; mData.Length; i++)\n        {\n            sum += mData[i];\n        }\n\n        //divide by the number of values\n        average = sum / mSize;\n\n        listBoxOutput.Items.Add(\"The average of the array is: \" + average);\n    }\n\n}\n</code></pre>\n"},{"tags":["c#","sharepoint"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13269431,"title":"Is there a way to detect the page layout in an ItemAdded event?","body":"<p>In our SharePoint project, we have a page layout in which the user can set a custom checkbox (\"Show as news\") in edit mode. Now our customer asked if we can have this checkbox set to checked per default.</p>\n\n<p>The checkbox is realised as a <code>&lt;SharePointWebControls:BooleanField&gt;</code> in the layout page, with a corresponding <code>&lt;Field Type=\"Boolean\"&gt;</code> in the sitecolumns definition.</p>\n\n<p>I tried adding a <code>&lt;Default&gt;1&lt;/Default&gt;</code> to the sitecolumn definition, and together with changing the default value for the site column through SiteSettings, this worked and the checkbox appeared as checked by default for new pages. However, we have other layouts which also use that field (same content type) and for which we don't want to have the value checked per default.</p>\n\n<p>So, my idea was to set the field value in an event receiver if a page is created. The receiver is called correctly and the item is available, however I can't seem to find a way to determine the page layout from the item I get through the event properties. I tried accessing the layout directly through the field <code>item[\"PublishingPageLayout\"]</code> and also by getting the page as PublishingPage, then calling <code>publishingPage.Layout.Name</code> but in both cases there is no value available (null) for the layout.</p>\n\n<p>I'd be glad if anyone could suggest an alternative way to find out the layout. Or maybe completely other way to achieve what I want.</p>\n"},{"tags":["c#"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13279812,"title":"Sorting a List of Custom Objects","body":"<p>I have a class called Person which contains a property LastName, which reflects a string cooresponding to the Person's last name.</p>\n\n<p>I created a List as follows:</p>\n\n<pre><code>var People = List&lt;Person&gt;\n</code></pre>\n\n<p>What I would like to do is sort the people by their LastName property in alphabetical order.</p>\n\n<p>After looking at some examples, I've tried</p>\n\n<pre><code>People = People.OrderBy(p =&gt; p.LastName);\n</code></pre>\n\n<p>But it does not work.</p>\n"},{"tags":["c#","c#-3.0"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13279362,"title":"How to stop the execution of a method after a specific time?","body":"<p>I need to stop the execution of a method if it has not completed within a limited period of time.</p>\n\n<p>To do this work I can use the <code>Thread.Abort</code> method in this way:</p>\n\n<pre><code>void RunWithTimeout(ThreadStart entryPoint, int timeout)\n{\n    var thread = new Thread(() =&gt;\n    {\n        try\n        {\n            entryPoint();\n        }\n        catch (ThreadAbortException)\n        {   }\n\n    }) { IsBackground = true };\n\n    thread.Start();\n\n    if (!thread.Join(timeout))\n        thread.Abort();\n}\n</code></pre>\n\n<p>Given that I'm using .NET 3.5, is there a better way?</p>\n"},{"tags":["c#","database","winforms","data-binding"],"answer_count":5,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":846,"score":6,"question_id":5209661,"title":"C# - Should i use databinding?","body":"<p>Im developing applications in C# winforms, and have gone down the path of databinding my grids using a bindingsource. My question is:</p>\n\n<p>Is this the best approach to take? Should i manually populate the cells instead of letting the binding source do it for me? Could it lead to problems further down the track?</p>\n\n<p>If there any any situations where databinding would create issues that would be useful.</p>\n\n<p>One of my colleagues swears black and blue to NOT use databinding. I dont really trust what he says, so any pros/cons would be valuable.</p>\n\n<p>EDIT: In the situation of a multi-user applications connecting to a single database and editable datagrids, how would you solve concurrency issues for updating of data?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","process","shellexecute"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13279403,"title":"Launch Shell but not in focus?","body":"<p>I have a simple app that repeatably uses <code>Process.Start</code> to launch one of my console applications. Unfortunately everytime it does this my window loses focus. Since it does this over 100 and takes about an hour to run through my window loses focus more then once per minute.</p>\n\n<p>Is there a way I can launch the process it w/o having the window hidden? but not setting focus to it? Although the app is more like something i would want running in the background i do need to see the console output which is why i require it not to be hidden</p>\n"},{"tags":["c#","do-while"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":7,"score":1,"question_id":13279943,"title":"change asp:FileUpload to Visible=\"true\" using a do while statement","body":"<p>I am trying to create a page that has a variable number of FileUpload fields, depending on the number selected from a drop down list by the user.</p>\n\n<p>my .apsx code is as follows;</p>\n\n<pre><code>            &lt;tr&gt;\n\n            &lt;td&gt;Number of photo's to upload&lt;/td&gt;\n            &lt;td&gt;&lt;asp:DropDownList ID=\"DLPhotoCount\" runat=\"server\" OnSelectedIndexChanged=\"OnSelectedIndexChanged_PhotoCount\" AutoPostBack=\"true\"&gt;\n\n                &lt;asp:ListItem Text=\"...\"&gt;&lt;/asp:ListItem&gt;\n                &lt;asp:ListItem Text=\"1\"&gt;&lt;/asp:ListItem&gt;\n                &lt;asp:ListItem Text=\"2\"&gt;&lt;/asp:ListItem&gt;\n\n            &lt;/asp:DropDownList&gt;&lt;/td&gt;\n\n        &lt;/tr&gt;\n\n        &lt;tr&gt;\n\n            &lt;td&gt;Picture 1:&lt;/td&gt;\n            &lt;td&gt;&lt;asp:FileUpload runat=\"server\" ID=\"Pic1\" Visible=\"false\"/&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n\n       &lt;tr&gt;\n\n            &lt;td&gt;Picture 2:&lt;/td&gt;\n            &lt;td&gt;&lt;asp:FileUpload runat=\"server\" ID=\"Pic2\" Visible=\"false\"/&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n\n        &lt;tr&gt;\n\n            &lt;td&gt;&lt;asp:Button runat=\"server\" ID=\"BtnUploadFiles\" text=\"Upload Files\" OnClick=\"OnClick_BtnUploadFiles\" Visible=\"false\"/&gt;&lt;/td&gt;\n\n        &lt;/tr&gt;\n</code></pre>\n\n<p>and my C# is;</p>\n\n<pre><code>    protected void OnSelectedIndexChanged_PhotoCount(object sender, EventArgs e)\n{\n    string Pic = \"Pic\";\n    int PicNo = Convert.ToInt32(DLPhotoCount.SelectedItem.Text);\n\n    if (DLPhotoCount.SelectedItem.Text != \"...\")\n    {\n        string StPicNo = Pic + PicNo;\n\n        do\n        {                \n            FileUpload StPicNo.Visible = true;\n            PicNo = PicNo + 1;\n\n        }\n        while (PicNo &lt; Convert.ToInt32(DLPhotoCount.SelectedItem.Text + 1));\n\n        BtnUploadFiles.Visible = true;\n\n    }\n    else\n    {\n        Pic1.Visible = false;\n        Pic2.Visible = false;\n        BtnUploadFiles.Visible = false;\n    }\n}\n</code></pre>\n\n<p>Open to suggestions on any alternatives if this isn't the best way to achieve the required functionality</p>\n"},{"tags":["c#","asp.net","twitter","twitterizer"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4,"score":0,"question_id":13280110,"title":"how to get user timeline using twitterizer2","body":"<p>I am using twitterizer2 to try and get a users recent few tweets and then write them to a table using oAuth not the users screen name, but i am new to twitterizer so i don't know how to do this.</p>\n\n<p>how can i do this ?\nthanks</p>\n"},{"tags":["c#","windows-services"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13279276,"title":"C# Service Intergration","body":"<p>Need to build a service that displays a message and locks the computer out (Just by using a Windows Form) when the Network Cable is unplugged (So they cannot proceed without Network - Its for a school where the students keep unplugging the cables to bypass certain blocks)</p>\n\n<p>Ive seen that you can interactive with the desktop with a service if you allow it to, im just wondering will Windows Forms display even if there is no user logged in?</p>\n\n<p>As this program needs to catch them out when there authenticating in, then unplugging it.</p>\n\n<p>Cheers\nRichard</p>\n"},{"tags":["c#","global-hotkey"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13280093,"title":"Global Hotkey Registration","body":"<p>I am hooking a USB remote up to my software, and need to register global hotkeys to work with it. I have the code in place, and it is working as expected, but when I hook the remote up, I found that it requires a specific Left or Right Alt, etc.</p>\n\n<p>Currently, I have my keys defined as such:</p>\n\n<pre><code>    public const int NOMOD = 0x0000;            //  No HotKey\n    public const int ALT = 0x0001;              //  ALT\n    public const int CTRL = 0x0002;             //  CTRL\n    public const int SHIFT = 0x0004;            //  SHIFT\n    public const int WIN = 0x0008;              //  WIN button\n    public const int WM_HOTKEY_MSG_ID = 0x0312; //  Windows message ID for HotKey\n</code></pre>\n\n<p>I have tried to find a mapping for what the code would be for L-Alt, L-CTRL, and L-Shift, but have been unsuccessful. They don't seem to be ASCII. Does anyone know the correct codes for these, or where I can find them? Thanks.</p>\n"},{"tags":["c#","arrays","addressbook"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13279982,"title":"C# Console Application phonebook arrays","body":"<p>I am told to design a phonebook which will use 2D array to store Name and Phone numbers in type : string .\nIt should have the functions like add, remove, print methods.</p>\n\n<p>I am yet struggling in this array. I do not know how to fill the whole of array members with \"none\" whenever a record for name is not present and \"000\" for its number. </p>\n\n<p>by default, i need it to have this printed:\n(20 records of none 000)\nnone 000\nnone 000\nnone 000\n...\nnone 000\nnone 000\nnone 000</p>\n\n<p>I came up with:</p>\n\n<pre><code>string[,] db = new db[20,2];\n</code></pre>\n\n<p>I am not sure though if its the right, but I just want a 2D array which has 20 rows and 2 columns.</p>\n\n<p>Then I wanna use for or foreach loop to fill the elements by none and 000:</p>\n\n<pre><code>for (int i=0; i&lt;db.Length/2; i++)\n     for (int j=0; j&lt;db.Length/20; j++)\n</code></pre>\n\n<p>Could you help me with filling that?\nThanks</p>\n"},{"tags":["c#",".net","c#-4.0","sift"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13279613,"title":"I couldnt use the library that I have already imported as references in my project","body":"<p>I am writing a program for computer vision in c# that part of project SIFT is needed; I downloaded the MEMO library for SIFT :  </p>\n\n<p><a href=\"http://www.nowozin.net/sebastian/tu-berlin-2006/libsift/\" rel=\"nofollow\">http://www.nowozin.net/sebastian/tu-berlin-2006/libsift/</a></p>\n\n<p>In my project I added the two libraries <strong>*<em>libsift.dll &amp; ICSharpCode.SharpZipLib.dll</strong> *</em> as references in to my projects.</p>\n\n<p><img src=\"http://i.stack.imgur.com/86hzx.png\" alt=\"enter image description here\"></p>\n\n<p>Now that I want to mention libsift on top of the code \" USING libsift\" it doesnt recognize it;   </p>\n\n<p><img src=\"http://i.stack.imgur.com/2A24Y.png\" alt=\"enter image description here\"></p>\n\n<p>even more if I wanna make a instance of such class atuo detect doesn't recognize it.</p>\n\n<p><img src=\"http://i.stack.imgur.com/Spmts.png\" alt=\"enter image description here\"></p>\n\n<p>It is weird because I could see the functions of this library in object browser.  </p>\n\n<p><img src=\"http://i.stack.imgur.com/kfmuX.png\" alt=\"enter image description here\">  </p>\n\n<p>I couldnt use the library that I have already imported as references in my project although I could see the functions in object browser? What could be the problem? </p>\n\n<p>(I have c# .Net VS2010 in windows.)</p>\n"},{"tags":["c#","roslyn"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13280008,"title":"How do I compile a C# solution with Roslyn?","body":"<p>I have a piece of software that generates code for a C# project based on user actions.  I would like to create a GUI to automatically compile the solution so I don't have to load up Visual Studio just to trigger a recompile.</p>\n\n<p>I've been looking for a chance to play with Roslyn a bit and decided to try and use Roslyn instead of msbuild to do this.  Unfortunately, I can't seem to find any good resources on using Roslyn in this fashion.</p>\n\n<p>Can anyone point me in the right direction?</p>\n"},{"tags":["c#","wcf","rest","iis7"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13174246,"title":"how to restrict access to WCF restful function to specific IP range?","body":"<p>I've built a Restful WCF service with few simple functions. a new requirememt has been raised. </p>\n\n<p>one of the functions should be accessible only to a specific ip range.</p>\n\n<p>what is the best way to implement this? I thought that an easy way is to simply configure the IIS with a rule that will block ip range according the request pattern - cant find such option.. </p>\n\n<p>Thanks!\nofer</p>\n"},{"tags":["c#","naudio"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13279984,"title":"Intercepting Skype, replacing voice with line-in and currently played audio file","body":"<p>How do you change <a href=\"http://channel9.msdn.com/coding4fun/articles/Skype-Voice-Changer\" rel=\"nofollow\">http://channel9.msdn.com/coding4fun/articles/Skype-Voice-Changer</a> to instead of it using EffectsChannel as the input channel use line-in mixed with the currently played audio file using the WaveOut() device?</p>\n\n<p>So I am playing an audio file with </p>\n\n<pre><code>WaveOut Klangwiedergabegerät = new WaveOut();\n\n//....\n\nvoid abspielen(string Dateiname, float ZielAmplitude)\n{\n    Klangwiedergabegerät.DeviceNumber = cbAusgabegeräte.SelectedIndex;\n    ISampleProvider StückchenHalter = CreateInputStreamS(Dateiname,ZielAmplitude);\n    Klangwiedergabegerät.Init(new SampleToWaveProvider(StückchenHalter));\n    Klangwiedergabegerät.Play();\n}\n\nprivate ISampleProvider CreateInputStreamS(string Dateiname, float Lautstärke)\n{\n    if (Dateiname.EndsWith(\".mp3\"))\n    {\n        mp3Reader = new Mp3FileReader(Dateiname);\n        pcmStream = WaveFormatConversionStream.CreatePcmStream(mp3Reader);\n        waveChannel = new SampleChannel(pcmStream, true);\n    }\n    else if (Dateiname.EndsWith(\".wav\"))\n    {\n        pcmStream = new WaveFileReader(Dateiname);\n        waveChannel = new SampleChannel(pcmStream, true);\n    }\n    else\n    {\n        throw new InvalidOperationException(\"Unsupported extension\");\n    }\n    waveChannel.Volume = Lautstärke;\n    postVolumeMeter = new MeteringSampleProvider(waveChannel);\n    postVolumeMeter.StreamVolume += OnPostVolumeMeter;\n    return postVolumeMeter;\n}\n</code></pre>\n"},{"tags":["c#","javascript","attributes","rename","script#"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13279980,"title":"Specify name of enum value in generated JavaScript with Script#","body":"<p>I could specify name of type or member in generated JavaScript by <code>ScriptName</code> attribute.\nIs it possible to specify enum value names?</p>\n\n<p>I mean following:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>#if !DEBUG\n[ScriptName(\"a0\")]\n#endif\npublic enum AlignType\n{\n    Left = 0, // a1\n    Center = 1, // a2\n    Right = 2 // a3\n}\n</code></pre>\n\n<p>And generated JavaScript:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>a0 = function() { \n};\na0.prototype = {\n    top: 0, \n    center: 1, \n    bottom: 2\n}\na0.registerEnum('a0', false);\n</code></pre>\n\n<p>Is it possible to replace <em>Left</em>, <em>Center</em> and <em>Right</em> with <em>a1</em>, <em>a2</em> and <em>a3</em> in JavaScript code?</p>\n"},{"tags":["c#","regex"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13279439,"title":"String Manipulation Using RegEx","body":"<p>Given the following scenario, I am wondering if a better solution could be written with Regular Expressions for which I am not very familiar with yet.  I am seeing holes in my basic c# string manipulation even though it somewhat works.  Your thoughts and ideas are most appreciated.</p>\n\n<p>Thanks much,</p>\n\n<p>Craig</p>\n\n<p>Given the string \"story\" below, write a script to do the following:</p>\n\n<ol>\n<li>Variable text is enclosed by <code>{ }</code>.</li>\n<li>If the variable text is blank, remove any other text enclosed in <code>[ ]</code>.</li>\n<li>Text to be removed can be nested deep with <code>[ ]</code>.</li>\n</ol>\n\n<p>Format:</p>\n\n<pre><code>    XYZ Company [- Phone: [({404}) ]{321-4321} [Ext: {6789}]]\n</code></pre>\n\n<p>Examples:</p>\n\n<ol>\n<li><p>All variable text filled in.</p>\n\n<pre><code>XYZ Company - Phone: (404) 321-4321 Ext: 6789\n</code></pre></li>\n<li><p>No Extension entered, remove \"Ext:\".</p>\n\n<pre><code>XYZ Company - Phone: (404) 321-4321\n</code></pre></li>\n<li><p>No Extension and no area code entered, remove \"Ext:\" and \"( ) \".</p>\n\n<pre><code>XYZ Company - Phone: 321-4321\n</code></pre></li>\n<li><p>No extension, no phone number, and no area code, remove \"Ext:\" and \"( ) \" and \"- Phone: \".</p>\n\n<pre><code>XYZ Company\n</code></pre></li>\n</ol>\n\n<p>Here is my solution with plain string manipulation.</p>\n\n<pre><code>private string StoryManipulation(string theStory)\n    {\n        // Loop through story while there are still curly brackets\n        while (theStory.IndexOf(\"{\") &gt; 0)\n        {\n            // Extract the first curly text area\n            string lcCurlyText = StringUtils.ExtractString(theStory, \"{\", \"}\");                \n\n            // Look for surrounding brackets and blank all text between\n            if (String.IsNullOrWhiteSpace(lcCurlyText))\n            {\n                for (int lnCounter = theStory.IndexOf(\"{\"); lnCounter &gt;= 0; lnCounter--)\n                {\n                    if (theStory.Substring(lnCounter - 1, 1) == \"[\")\n                    {\n                        string lcSquareText = StringUtils.ExtractString(theStory.Substring(lnCounter - 1), \"[\", \"]\");\n                        theStory = StringUtils.ReplaceString(theStory, (\"[\" + lcSquareText + \"]\"), \"\", false);\n                        break;\n                    }\n                }\n            }\n            else\n            {\n                // Replace current curly brackets surrounding the text\n                theStory = StringUtils.ReplaceString(theStory, (\"{\" + lcCurlyText + \"}\"), lcCurlyText, false);\n            }\n        }\n        // Replace all brackets with blank (-1 all instances)\n        theStory = StringUtils.ReplaceStringInstance(theStory, \"[\", \"\", -1, false);\n        theStory = StringUtils.ReplaceStringInstance(theStory, \"]\", \"\", -1, false);\n        return theStory.Trim();\n    }\n</code></pre>\n"},{"tags":["c#","wcf","web-services","error-handling","windows-server-2003"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13279350,"title":"How do I disable the Visual C++ Runtime Error in a Web Server?","body":"<p>A production web service that runs WCF on a Windows Server 2003 machine was non-responsive.  I captured a memory dump file for analysis in <a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=26798\" rel=\"nofollow\">DebugDiag 1.2</a>.</p>\n\n<p>DebugDiag revealed that a thread encountered an OutOfMemoryException.  Normally, we try to trap all exceptions, print them to the event log, and then return them as a WCF fault.</p>\n\n<p>This OutOfMemoryException was somehow not caught and resulted in a C++ error.  I accept that the .NET runtime was unable to handle this error.  When you're out of memory, you're out of memory.</p>\n\n<p>The analysis revealed that the that one of the threads was attempting to display the Visual C++ runtime error:</p>\n\n<blockquote>\n  <p>Microsoft Visual C++ Runtime Library Runtime Error!  Program: C:\\windows\\system32\\inetsrv\".</p>\n</blockquote>\n\n<p>The stack trace looked like this:</p>\n\n<pre><code>ntdll!KiFastSystemCallRet    \nntdll!ZwRaiseHardError+c    \nuser32!ServiceMessageBox+145    \nuser32!MessageBoxWorker+13e    \nuser32!MessageBoxTimeoutW+7a    \nuser32!MessageBoxTimeoutA+9c    \nuser32!MessageBoxExA+1b    \nuser32!MessageBoxA+45    \nmsvcr71!__crtMessageBoxA+f4   f:\\vs70builds\\3052\\vc\\crtbld\\crt\\src\\crtmbox.c @ 118 + 10 \nmsvcr71!_NMSG_WRITE+12e  f:\\vs70builds\\3052\\vc\\crtbld\\crt\\src\\crt0msg.c @ 240 + 10 \nmsvcr71!abort+7   f:\\vs70builds\\3052\\vc\\crtbld\\crt\\src\\abort.c @ 48 \nkernel32!UnhandledExceptionFilter+12a    \nkernel32!BaseThreadStart+4a    \nkernel32!_except_handler3+61    \nntdll!ExecuteHandler2+26    \nntdll!ExecuteHandler+24    \nntdll!RtlRaiseException+3d    \nkernel32!RaiseException+53    \nmsvcr80!_CxxThrowException+46    \nmscorwks!ThrowOutOfMemory+24 \n</code></pre>\n\n<p>The documentation of <a href=\"http://msdn.microsoft.com/en-us/library/k089yyh0.aspx\" rel=\"nofollow\">abort</a> says:</p>\n\n<blockquote>\n  <p>In a single or multithreaded Windows-based application, abort calls\n  the Windows MessageBox function to create a message box to display the\n  message with an OK button. When the user clicks OK, the program aborts\n  immediately. The message can be suppressed by calling\n  <a href=\"http://msdn.microsoft.com/en-us/library/e631wekh%28v=vs.80%29.aspx\" rel=\"nofollow\">_set_abort_behavior</a> with the appropriate arguments.</p>\n</blockquote>\n\n<p>This message box hung the server.  One thread had triggered a GC, but this thread had disabled preemptive GC.  Most of the rest of the threads where blocking while waiting for the GC to complete.</p>\n\n<p><strong>How do I <a href=\"http://stackoverflow.com/questions/1938715/disable-microsoft-visual-c-runtime-error\">disable the Visual C++ Runtime Error dialog</a> for a web server?</strong></p>\n"},{"tags":["c#",".net","infragistics","tablelayout","noise"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4,"score":0,"question_id":13279895,"title":"Noise box, when a table layout is scrolling, without 'AutoScroll' property enabled","body":"<p>I have a big problem, when I doing a scrolling without 'Autoscrool' property enabled on a table layout, I get a noise box, seems that the layout continue scrolling (see attached image). I have tried update/refresh/invalidate... its container layouts, but I could not get success for my problem.</p>\n\n<p>Other weird behavior that I have is, once have the noise box on the screen, and launched any dialog, the full layout is fixed.</p>\n\n<p>Has anyone had a similar problem before?</p>\n\n<p>see below the code that I'm using to scrool the table layout:</p>\n\n<pre><code>    private void panelSelectorTrackBar_ValueChanged(object sender, EventArgs e)\n    {\n        galleryTableLayoutPanel.Top = panelSelectorTrackBar.Value;\n        dashboardPanelDetails.Hide();\n    }\n</code></pre>\n\n<p>On where <strong>galleryTableLayoutPanel</strong> is a <em>TableLayout</em> instance, <em>panelSelectorTrackBar</em> is an <em>UltraTrackBar</em> instance.</p>\n\n<p><img src=\"http://i.stack.imgur.com/831Yb.png\" alt=\"Noise Box\"></p>\n"},{"tags":["c#","wpf","pixelsense"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13279322,"title":"Finding a dynamically added ScatterViewItem","body":"<p>I have the following: </p>\n\n<pre><code>Window window = Application.Current.Windows.Cast&lt;Window&gt;().SingleOrDefault(x =&gt; x.IsActive);\nScatterView main = UIHelper.FindChild&lt;ScatterView&gt;(window, \"MainScatterView\");\n        main.Items.Add(type);\n\n//Neither of these work\nScatterViewItem parent = (ScatterViewItem)main.ContainerFromElement(type);\n\nScatterViewItem parent = UIHelper.FindVisualParent&lt;ScatterViewItem&gt;(type);\n</code></pre>\n\n<p>The documentation says: <em>When you add an object that is not of type ScatterViewItem, the ScatterView control first wraps the object in a ScatterViewItem control before adding it to the collection</em> <a href=\"http://msdn.microsoft.com/en-us/library/microsoft.surface.presentation.controls.scatterviewitem.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/microsoft.surface.presentation.controls.scatterviewitem.aspx</a></p>\n\n<p>How does one get the scatterviewitem that it has been wrapped in?</p>\n"},{"tags":["c#","performance","asp.net-4.0","code-readability","boolean-operations"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13279096,"title":"how to decide on a bool operators usage, performance issues vs readability","body":"<p>Having even more than two options to choose from, leads me to question, which one to choose, if  the result / outcome is same.</p>\n\n<p>in <code>.NET</code> <code>C#</code>  the following conditions are asking same question using different operators, so the question is , what experienced developers use, i tend to assume that ready made operators like <code>Equals</code> would go through more processing actions.</p>\n\n<p>When and why would you choose <code>!</code> over <code>Equals</code>, and both over 'traditional'  <code>==</code> ?</p>\n\n<pre><code>//bool\nif (!Page.IsPostBack) \n{\n    //bool\n    if (NotAuthorized().Equals(false)) \n    {            \n        AppsCtrls.DDLs_Init();\n\n        //bool\n        if (CurrSeSn.Raised(Flag.MainDataSet_IsPopulated) == false)\n        {\n            initALLDataSet(AllDataStColsSelectionMod.doneViaSP);\n        }\n\n        custid = RConv.Str2int(Request.QueryString[\"custid\"]);\n        username = GetTableData.AsString(\"name\", \"tblCustomers\", \"custid\", custid);\n    }\n}\n</code></pre>\n"},{"tags":["c#","locale","gettext"],"answer_count":0,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":85,"score":2,"question_id":9527480,"title":"gettext(i18n) in process running as root/system process","body":"<p>It's not possible to setlocale of a process running as root, how can I use gettext to obtain localized strings (the locale is not auto detected, nor can I force it to a particular value using setlocale) in such a process. Is there any workaround?</p>\n\n<p>Edit -> Adding the code, I used for testing the issue. I force changed the environment variables - LC_ALL, LANGUAGE, LANG to fr_FR.UTF8. I set the locale to fr_FR.UTF8 explicitly too. All the putenv calls returned 0 and the setlocale call returned \"C\".</p>\n\n<pre><code> int err = putenv(\"LC_ALL=fr_FR.UTF8\");\n err = putenv(\"LANG=fr_FR.UTF8\");\n err = putenv(\"LANGUAGE=fr_FR.UTF8\");\n char *loc = setlocale(LC_ALL, \"fr_FR.UTF8\");\n bindtextdomain(\"default\", \"locale\");\n textdomain(\"default\");\n char *text = gettext(\"hello\");\n</code></pre>\n\n<p>The same code snippet works if I try it in a user process. The exe of both the processes are in same directory, which contains directory locale\\fr\\LC_MESSAGES\\default.mo</p>\n\n<p>Can we change the locale of a process which is running as system process and not user?</p>\n"},{"tags":["c#","asp.net-mvc","linq"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":19,"score":-5,"question_id":13279844,"title":"How to do group by and join table in linq?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13279499/how-to-join-and-group-by-with-linq\">How to join and group by with linq?</a>  </p>\n</blockquote>\n\n\n\n<p>I want to join table and  and group by in linq.\nSo I write </p>\n\n<pre><code>   var query1 = from opv in _opvRepository.Table\n                         join o in _orderRepository.Table on opv.OrderId equals o.Id\n                         join gr in _graduandRepository.Table on opv.graduand_id equals gr.graduand_id\n                         join pv in _productVariantRepository.Table on opv.ProductVariantId equals pv.Id\n                         join p in _productRepository.Table on pv.ProductId equals p.Id\n                         where (opv.ceremony_id == ceremony_id) &amp;&amp;\n                         (!o.Deleted) &amp;&amp; (opv.IsHireItem == true)  &amp;&amp;\n                         (!p.Deleted) &amp;&amp;\n                         (!pv.Deleted) &amp;&amp; (opv.ceremony_id == ceremony_id)\n                          group opv by opv.OrderId into g\n                          select new\n                          {\n                              TotalAmount = g.Sum(x =&gt; x.PriceExclTax),\n                               table2Val = gr\n\n                          };   \n\n\n            var result = query1.ToList().Select(x =&gt;\n            {\n                return new HireItemReportLine()\n                {\n                    Fname = x.table2Val.first_name,\n                  MName = x.table2Val.middle_name,\n                  LName = x.table2Val.last_name,\n                };\n            }).ToList();\n</code></pre>\n\n<p>I want to select the <code>gr</code> table data, <code>opv</code> table data and <code>o</code> table data.</p>\n\n<p>But there is error and it says</p>\n\n<pre><code>The name 'gr' does not exist in the current context\n</code></pre>\n\n<p>How to solve it??</p>\n"},{"tags":["c#",".net","asp.net-mvc","dependency-injection","asp.net-web-api"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12320846,"title":"Some questions about webapi ActionFilterAttribtes, FilterProvider, and Dependency Injection","body":"<p>I see that by default, an MVC4 WebApi project has 2 <code>IFilterProviders</code>: The <code>ConfigurationFilterProvider</code>, and the <code>ActionDescriptorFilterProvider</code>. When setting up a custom <code>IFilterProvider</code> to do property depenency injection, is it appropriate to remove both of these from the Filters collection first? Or is it more appropriate to just remove the <code>ActionDescriptorFilterProvider</code>, and leave the <code>ConfigurationFilterProvider</code> in the collection?</p>\n\n<p>Secondly, I see that after a WebApi Http <code>ActionFilterAttribute</code> is constructed for a particular action, it seems to stay around. For example when I put a custom action filter on an ApiController Get method, it is only constructed the first time that method is called. Subsequent calls to the api method seem to reuse the same filter (constructor breakpoints are only hit during the first invocation). Is this right? Why is it different than an MVC actionfilter, where a new instance is created for each method invocation?</p>\n"},{"tags":["c#",".net","winforms","krypton-toolkit"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1112,"score":2,"question_id":7916607,"title":"How to deselect the text of a combobox","body":"<p>I have a krypton combo box which I data bind with a list of key-value pairs. What's happening is that when i set the selected item in code, it is highlighting the text. How can i prevent this or deselect the text?</p>\n\n<p>I've tried </p>\n\n<pre><code>// 1\ncombo.Select(0,0);\n// 2\ncombo.Focus();\nanotherControl.Focus();\n// 3\ncombo.SelectionStart = 0;\ncombo.SelectionLength = combo.Text.Length;\n// 4 \ncombo.SelectionStart = combo.Text.Length;\ncombo.SelectionLength = 0;\n</code></pre>\n\n<p>Nothing wants to work.\nAny help appreciated.</p>\n"},{"tags":["c#","asp.net-mvc","dependency-injection","ioc-container","asp.net-web-api"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":866,"score":1,"question_id":10930402,"title":"How to do dependency injection to Action Filter on ASP.NET Web API","body":"<p>I really get stuck on the approach to do dependency injection into action filter of web api. I  have an action filter like this:</p>\n\n<pre><code>public class AuthorizationAttribute : ActionFilterAttribute\n{\n    public IApiKeyRepository Repository { get; set; }\n\n    private Guid GetApiKey(string customerKey)\n    {\n        return Repository.GetApiKey(customerKey);\n    }\n\n    public override void OnActionExecuting(HttpActionContext actionContext)\n    {        \n    }\n}\n</code></pre>\n\n<p>I would like to do property injection on the property Repository by using Windsor (but it does not matter which IoC container is used)</p>\n\n<p>I did come up to customize FilterProvider but it did not work out for me, does anyone have solution or running code on this? it will be much appreciated</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","itextsharp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13279489,"title":"Copy/Clone Stream in a loop...","body":"<p>I am fundamentally doing something wrong here within this loop. The first time through the loop, the Stream works fine, but subsequent times through the loop fail with the Stream being corrupted. I know am probably doing something silly. I tried to set the updateTemplate to 0 each time but the InputStream doesn't support the seek. I am basically appending multiple forms that are filled in onto a List here. Any suggestions would be appreciated, especially ones that would result in better performance.</p>\n\n<pre><code>...\nfiles.Add(PDFhelper.fillTemplate(template, mappings));\n\nforeach (Update u in myObject.Updates)\n{\n    mappings = this.GenerateFieldMappings(u);\n    Stream output = new MemoryStream();\n    template.CopyTo(output);\n    files.Add(PDFhelper.fillTemplate(output, mappings)); //First time stream is good  \n\n}\n\nreturn PDFhelper.MergeFiles(files);\n\n...\n</code></pre>\n"},{"tags":["c#","wpf","performance","master-detail"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":36,"score":-2,"question_id":13279655,"title":"How to make my WPF application as FAST as Outlook","body":"<p>The commons WPF applications take some time for loading medium complex views, once the view is loaded it works fine. For example in a Master - Detail view, if the Detail view is very complex and use different DataTemplates take some seconds (2-3 seconds) for load the view.</p>\n\n<p>When i open the Outlook application, for instance, it renders complex views and it is relative much more fast.</p>\n\n<p>Is there a way for increase the performance of my WPF application? Maybe a way for not loading the template's data every time that change the \"master\" item, and load it only one time in the app time live?</p>\n\n<p>i will appreciate any suggestion. </p>\n"},{"tags":["c#","wpf","usercontrols"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13161987,"title":"Why is the Dependency Property not returning its value?","body":"<p>I have a MyUserControl with the following Xaml:</p>\n\n<pre><code>&lt;TextBox Text=\"{Binding InputValueProperty}\" /&gt;\n</code></pre>\n\n<p>In the MyUserControl.xaml.cs I have:</p>\n\n<pre><code>public string InputValue\n{\n    get { return (string)GetValue(InputValueProperty); }\n    set { SetValue(InputValueProperty, value); }\n}\npublic static readonly DependencyProperty InputValueProperty = \n    DependencyProperty.Register(\"InputValueProperty\", typeof(string), \n    typeof(MyUserControl));\n</code></pre>\n\n<p>In my MainWindow.xaml I create a user control:</p>\n\n<pre><code>&lt;local:MyUserControl InputValue=\"My Input\" /&gt;\n</code></pre>\n\n<p>Later on in my MainWindow.xaml.cs I am trying to access this string.  All instances of MyUserControl are contained in a List and I access them with a foreach.</p>\n\n<pre><code>string temp = userControl.InputValue;\n</code></pre>\n\n<p>This is always null.  In my MainWindow.xaml I can see the \"My Input\" in the text box of the user control but I can't ever seem to get it out of there. </p>\n"},{"tags":["c#","linq","entity-framework-4","entity-framework-5"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":32,"score":3,"question_id":13274597,"title":"Entity Framework 5 upgrade from 4","body":"<p>I'm having an issue with the Where clause in a search, in my original version EF4 I could add a Where clause with  2 parameters, the where clause (string predicate) and a ObjectParameter list such as</p>\n\n<pre><code>var query = context.entities.Where(WhereClause.ToString(), Params.ToArray());\n</code></pre>\n\n<p>since my upgrade to EF5 I don't seem to have that option am I missing something?</p>\n\n<p>This was originally used to build dynamic where clause such as \"it.entity_id = @entity_id\" then holding the variable value in the ObjectParameter.</p>\n\n<p>I'm hoping I don't have to rewrite all the searches that have been built out this way, so any assistance would be greatly appreciated.</p>\n\n<p>Cheers</p>\n"},{"tags":["c#","asp.net","sqldatareader","idatareader"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13279698,"title":"IDataReader not reading, no errors","body":"<p>I realize IDataReader is outdated and some view it as dirty code, but on the site I am working on this is what they use. I have an IDataReader statement to run a query to get a specific id from a table using multiple joins. Now this site has a DAL but it only supports the ability to select from one table at a time, so using select statements with joins do not work with it. This is why I am forced to use IDataReader with this.</p>\n\n<pre><code> if (Request.QueryString[\"CategoryId\"].ToString() == \"0\")\n                {\n                    using (IDataReader getCategoryID = DB.GetRS(\"SELECT ItemCatalogCategory.CategoryID FROM UserCustomerCatalog INNER JOIN ItemCatalogCategory ON UserCustomerCatalog.ItemProfileCatalogID = ItemCatalogCategory.ItemProfileCatalogID \" +\n                              \"INNER JOIN ItemCategory ON ItemCatalogCategory.CategoryID = ItemCategory.CategoryID INNER JOIN StoreCatalog ON UserCustomerCatalog.StoreCatalogID = StoreCatalog.StoreCatalogID \" +\n                              \"WHERE UserCustomerCatalog.ItemProfileCatalogID = '\" + Request.QueryString[\"CatalogID\"] + \"' AND UserCustomerCatalog.CustomerID =' \" + Session[\"Customer\"].ToString() + \"' AND ItemCategory.ProductID = '\" + productis + \"'\"))\n                    {\n\n                        if (getCategoryID.Read())\n                        {\n                            string categoryID = getCategoryID[\"ItemCatalogCategory.CategoryID\"].ToString();\n\n                            string lookmike = Request.Url.AbsolutePath + \"?CatalogID=\" + catalogis + \"&amp;ProductID=\" + productis + \"&amp;CatalogIndex=\" + Request.QueryString[\"CatalogIndex\"] + \"&amp;CategoryID=\" + categoryID;\n                            Response.Redirect(Request.Url.AbsolutePath + \"?CatalogID=\" + catalogis + \"&amp;ProductID=\" + productis + \"&amp;CatalogIndex=\" + Request.QueryString[\"CatalogIndex\"] + \"&amp;CategoryID=\" + categoryID);\n\n                        }\n                        else\n                        {\n                            Response.Redirect(Request.Url.AbsolutePath + \"?CatalogID=\" + catalogis + \"&amp;ProductID=\" + productis + \"&amp;CatalogIndex=\" + Request.QueryString[\"CatalogIndex\"] + \"&amp;CategoryID=\" + Request.QueryString[\"CategoryId\"]);\n                        }\n\n                    }//end using getCategoryID\n                }\n</code></pre>\n\n<p>this is what I have, but when it gets to:</p>\n\n<pre><code>if (getCategoryID.Read())\n</code></pre>\n\n<p>it renders as false, there are no exceptions thrown, and no errors or warnings. I have done this type of select in the past with no problems, but I cannot figure out why .Read() is returning false.</p>\n\n<p>Can anyone suggest possible reasons for it not reading? If more code is needed, I can provide as needed. Any help is appreciated, thank you in advance.</p>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13279380,"title":"Prevent form loading until user input","body":"<p>So, management has decided to implement an idea to allow the user to choose the language for the program.  And the way they want it is, in my opinion, silly.  But, I can't change their mind.  Here's how it works.  The main form(<code>frmMain</code>) will start to load.  Before the <code>InitializeComponent()</code>, they want another form(<code>frmLanguage</code>) to load asking the user to select a language.  Now, I can get frmLanguage to pop up at the proper time.  My problem is, how do I prevent or pause frmMain from continuing to load once I've got frmLanguage displayed?</p>\n\n<pre><code>public FrmMain()\n{\n    var language = new FrmLanguage();\n    language.Show();\n\n    // I need to pause the FrmMain right here\n\n    InitializeComponent();\n}\n</code></pre>\n\n<p>I was thinking that threading might be the way to do this, but I've got zero experience with it, so I'm unsure that's even a correct line of thinking.  I don't want to do a <code>Sleep()</code> or similar, cause who knows how long the user will take to enter their choice.  Also, this will be a one-off popup.  I'll be changing a line in a pre-existing INI file so that this won't pop up if they've already selected a language.  Thanks for any and all help.</p>\n"},{"tags":["c#","winforms","chartfx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13035381,"title":"How to put ellipsis at the axis of chartfx graph?","body":"<p>I'm working on ChartFX for windows forms, have a problem. My application must works on screens that have an small size (i.e. 1440x900), I need to display several charts on the same screen (I cannot change it). So, when it happens the axis labels of my charts (charts of the ChartFX) looks cutted.</p>\n\n<p>Somebody does know how a can add ellipsis instead cut labels for the axis labels using chartFX ?</p>\n"},{"tags":["c#",".net","arrays"],"answer_count":1,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":122,"score":8,"question_id":10465099,"title":"Create an array populated with a range of values x through y","body":"<p>Let's say I have integer variables x and y, and I want an array populated with values x through y.  Is there a nice way to do this inline, using C#?</p>\n\n<p>I know I can achieve this using an extension method:</p>\n\n<pre><code>public static int[] ExpandToArray(this int x, int y)\n{\n    var arr = int[y - x + 1];\n    for (int i = x; i &lt;= y; i++) \n    {\n        arr[i-x] = i;\n    }\n    return arr;\n}\n</code></pre>\n\n<p>And then use it to write:</p>\n\n<pre><code>x.ExpandToArray(y);\n</code></pre>\n\n<p>Is there a built-in way (without creating an extension method) in .NET to write something like <code>x.ExpandToArray(y)</code>?</p>\n"},{"tags":["c#","wpf","richtextbox"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":82,"score":4,"question_id":13116278,"title":"How can I type half-space in RichTextBox?","body":"<p>When I press \"Shift + Space\" to type half-space (when I 'm writing in Persian) in a RichTextBox, it just inserts space. It types all other Persian characters correctly, but when it comes to \"Shift+Space\", it types just space.</p>\n\n<p>The name of this character is \"ZERO WIDTH NON-JOINER\" and the information is given in this link: <a href=\"http://www.fileformat.info/info/unicode/char/200c/index.htm\" rel=\"nofollow\">http://www.fileformat.info/info/unicode/char/200c/index.htm</a>.</p>\n\n<p>I should mention that I fixed the problem by handling previewKewDown event; but I like to know what is the problem with this key combination in a RichTextBox.</p>\n\n<p>thanks.</p>\n"},{"tags":["c#"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":29,"score":-3,"question_id":13279499,"title":"How to join and group by with linq?","body":"<p>I want to join tables and want to group by <code>orderID</code> select two tabel data.</p>\n\n<p>So I wrote this query.  </p>\n\n<pre><code> var query1 = from opv in _opvRepository.Table\n                     join o in _orderRepository.Table on opv.OrderId equals o.Id\n                     join gr in _graduandRepository.Table on opv.graduand_id equals gr.graduand_id\n                     join pv in _productVariantRepository.Table on opv.ProductVariantId equals pv.Id\n                     join p in _productRepository.Table on pv.ProductId equals p.Id\n                     where (opv.ceremony_id == ceremony_id) &amp;&amp;\n                     (!o.Deleted) &amp;&amp; (opv.IsHireItem == true)  &amp;&amp;\n                     (!p.Deleted) &amp;&amp;\n                     (!pv.Deleted) &amp;&amp; (opv.ceremony_id == ceremony_id)      \n                     group opv by opv.OrderId into g\n                     select new\n                     {\n                         table1Val = opv,\n                         table2Val = gr,\n                         table3Val = 0\n                     };\n\n\n\n        var result = query1.ToList().Select(x =&gt;\n        {\n            return new HireItemReportLine()\n            {\n                OrderId = x.table1Val.OrderId,                   \n\n              Fname=x.table2Val.first_name,\n\n            };\n        }).ToList();\n</code></pre>\n\n<p>But there is error and it says</p>\n\n<pre><code>The name 'opv' does not exist in the current context\nThe name 'gr' does not exist in the current context\n</code></pre>\n\n<p>How can I do it?</p>\n"},{"tags":["c#","linq","mongodb","query-optimization","mongodb-csharp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13254784,"title":"Is there an \"Explain Query\" for MongoDB Linq?","body":"<p>Is there a way to run <code>.explain()</code> or equivalent on Linq queries? I would want to know </p>\n\n<ul>\n<li>The text of the actual JSON query</li>\n<li>The output of <code>.explain()</code> (indexes used, etc)</li>\n<li>It would also be nice to have the execution time of the query </li>\n</ul>\n"},{"tags":["c#","android","asp.net","gridview"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13279594,"title":"GridView Textbox with forced keypad","body":"<p>I have a GridView that has a column named <code>Run Time</code> and it uses TextBoxes <code>rTime</code>.  I'm going to be bewing this GridView on an andriod operating system and want it to pull a  keypad if someone clicks on the textbox.  This has worked before without the GridView, but I've been getting a <code>The name 'rTime' does not exist in the current context</code> error. Here is my aspx code: `\n    </p>\n\n<pre><code>   &lt;asp:TemplateField HeaderText=\"labelID\" Visible=\"false\"&gt;\n        &lt;ItemTemplate&gt;\n            &lt;asp:Label ID=\"ID\" runat=\"server\" Text='&lt;%# Eval(\"Id\") %&gt;' /&gt;\n        &lt;/ItemTemplate&gt;\n    &lt;/asp:TemplateField&gt;\n\n    &lt;asp:TemplateField HeaderText=\"First Name\"&gt;\n        &lt;ItemTemplate&gt;\n            &lt;asp:Label ID=\"labelfirstname\" Visible=\"true\" runat=\"server\" Text='&lt;%# Eval(\"fName\") %&gt;' /&gt;\n\n        &lt;/ItemTemplate&gt;\n    &lt;/asp:TemplateField&gt;\n     &lt;asp:TemplateField HeaderText=\"Last Name\"&gt;\n        &lt;ItemTemplate&gt;\n            &lt;asp:Label ID=\"labellastname\" Visible=\"true\" runat=\"server\" Text='&lt;%# Eval(\"lName\") %&gt;' /&gt;\n        &lt;/ItemTemplate&gt;\n    &lt;/asp:TemplateField&gt;\n     &lt;asp:TemplateField HeaderText=\"Run Time Needed\"&gt;\n        &lt;ItemTemplate&gt;\n            &lt;asp:Label ID=\"labelrTimeN\" Visible=\"true\" runat=\"server\" Text='&lt;%# Eval(\"rTimeN\") %&gt;' /&gt;\n        &lt;/ItemTemplate&gt;\n    &lt;/asp:TemplateField&gt;\n    &lt;asp:TemplateField HeaderText=\"Run Time\"&gt;\n        &lt;ItemTemplate&gt;\n            &lt;div style=\"display:none\"&gt;&lt;asp:TextBox ID=\"rTime\" runat=\"server\" Height=\"16px\" \n        ontextchanged=\"TextBox1_TextChanged\" Width=\"108px\"&gt;&lt;/asp:TextBox&gt;&lt;/div&gt;\n    &lt;span class=\"style4\"&gt;&lt;strong&gt;Meter Run:&lt;/strong&gt;&lt;/span&gt;&lt;span class=\"style5\"&gt;&amp;nbsp;&lt;/span&gt;&lt;input onblur=\"document.getElementById('&lt;%=rTime.ClientID %&gt;').value = this.value\" \n    type=\"tel\" style=\"width: 100px; height: 31px;\" /&gt;\n        &lt;/ItemTemplate&gt;\n    &lt;/asp:TemplateField&gt;\n\n\n&lt;/Columns&gt;\n&lt;/asp:GridView&gt;`\n</code></pre>\n\n<p>Here is c#:</p>\n\n<pre><code>private bool isEditMode = false;\n    protected void Page_Load(object sender, EventArgs e)\n    {\n\n        if (!Page.IsPostBack)\n        {\n            BindData();\n        }\n        UpdatePanel1.Visible = false;\n    }\n    private void BindData()\n    {\n\n        string connectiongString = \"Data Source=WSCJTCSQ1;Initial Catalog=TestDB;Persist Security Info=True;User ID=v2soft;Password=passwordv2soft\";\n        SqlConnection myConnection = new SqlConnection(connectiongString);\n        SqlDataAdapter ad = new SqlDataAdapter(\"SELECT Id, fName, lName, rTimeN, rTime FROM bleaTest\", myConnection);\n        DataSet ds = new DataSet();\n        ad.Fill(ds);\n        GridView1.DataSource = ds;\n        GridView1.DataBind();\n\n    }\n\n\n\n    protected void Button1_Click(object sender, EventArgs e)\n    {\n        isEditMode = true;\n        UpdatePanel1.Visible = true;\n        BindData();\n    }\n    protected void TextBox1_TextChanged(object sender, EventArgs e)\n    {\n\n    }\n\n    protected void Button2_Click(object sender, EventArgs e)\n    {\n        Update();\n    }\n    protected bool IsInEditMode\n    {\n\n        get { return this.isEditMode; }\n\n        set { this.isEditMode = value; }\n\n    }\n\n\n    private void Update()\n    {\n        StringBuilder sb = new StringBuilder();\n\n        foreach (GridViewRow row in GridView1.Rows)\n        {\n            sb.Append(\"UPDATE bleaTest SET rTime = '\");\n\n            sb.Append((row.FindControl(\"rTime\") as TextBox).Text);\n\n            sb.Append(\"'\");\n\n            sb.Append(\" WHERE id = \");\n\n            sb.Append(Convert.ToInt32((row.FindControl(\"ID\") as Label).Text));\n\n            sb.Append(\" \");\n\n        }\n        string connectiongString = \"Data Source=WSCJTCSQ1;Initial Catalog=TestDB;Persist Security Info=True;User ID=v2soft;Password=passwordv2soft\";\n        SqlConnection myConnection = new SqlConnection(connectiongString);\n        SqlCommand myCommand = new SqlCommand(sb.ToString(), myConnection);\n        myConnection.Open();\n        myCommand.ExecuteNonQuery();\n        myConnection.Close();\n\n        isEditMode = false;\n\n        BindData();\n\n        UpdatePanel1.Visible = false;\n\n    }\n    protected void gvUsers_RowDataBound(object sender, GridViewCommandEventArgs e)\n    {\n\n    }\n</code></pre>\n\n<p>Thank you in advance!!</p>\n"},{"tags":["c#","asp.net-mvc","asp.net-mvc-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13279297,"title":"Alternatives to DisplayName DataAnnotation when displaying run-time data in MVC3 model","body":"<p>I have a requirement to display a label whose text is determined at run-time.</p>\n\n<p>Previously, when the text was known at compile-time, I was able to use the DisplayName DataAnnotation to craft how my model represented its data.</p>\n\n<p>As an example, I used to have this:</p>\n\n<pre><code>[DisplayName(\"Task Template\")]\npublic List&lt;KeyValuePair&lt;int, string&gt;&gt; TaskTemplate { get; set; }\n\n&lt;%= Html.LabelFor(model =&gt; model.TaskTemplate) %&gt;\n&lt;%= Html.DropDownListFor(model =&gt; model.TaskTemplateFlag, new SelectList(Model.TaskTemplate, \"Key\", \"Value\"))%&gt;\n</code></pre>\n\n<p>but now the DisplayName needs to be determined at run-time.</p>\n\n<p>According to <a href=\"http://stackoverflow.com/questions/9434918/displayattribute-name-with-a-variable-dynamic-displayname\">this StackOverflow answer</a> there is no way to do this using a DataAnnotation.</p>\n\n<p>I'm left wondering what best practice is? Do I stop using LabelFor altogether? Should I just store a bunch of string properties in my model, load my values into the properties, and render using DisplayFor?</p>\n\n<p><strong>Update:</strong> I think that this is probably a good enough solution:</p>\n\n<pre><code>public string TaskTemplateLabel { get; set; }\npublic List&lt;KeyValuePair&lt;int, string&gt;&gt; TaskTemplate { get; set; }\n\n//Constructor: TaskTemplateLabel = GetLabelFromDataSource();\n\n&lt;%= Html.LabelFor(model =&gt; model.CurrentDeviceName, Model.TaskTemplateLabel)%&gt;\n</code></pre>\n"},{"tags":["c#","com","memory-leaks"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13279539,"title":"C# interface to COM leaks memory... strangely","body":"<p>I have a C# program that accesses a COM Interface to a piece of simulation software called Aspen Plus.  I have a very strange memory leak.</p>\n\n<p>When I need to get the result values out of the simulation, I run a series of calls like this, in some cases the variable returned might be null, so I insert a check for that.  Then I use FinalReleaseComObject to clean up the COM references.</p>\n\n<pre><code>   public override ValueType recvValueFromSim&lt;ValueType&gt;(string path) {\n       Happ.IHNode tree = this.Aspen.Tree;\n       dynamic node = tree.FindNode(path);\n       ValueType retVal = default(ValueType);\n       if (node != null &amp;&amp; node.Value != null) {\n           retVal = node.Value;\n       }\n       Marshal.FinalReleaseComObject(node);\n       Marshal.FinalReleaseComObject(tree);\n       node = null;\n       return retVal;\n   }\n</code></pre>\n\n<p>Unfortunately, the above code leaks a lot.  It leaks 2MB per simulation.  At first I thought the Garbage Collector would eventually run and clean it up, but no dice.  After running a couple of hundred simulations, I ran out of memory.</p>\n\n<p>The bizarre thing is, the below code works fine and doesn't leak. I didn't like it, because using catch to check for null references seems like bad form, but this doesn't leak.</p>\n\n<pre><code>   public override ValueType recvValueFromSim&lt;ValueType&gt;(string path) {\n      ValueType node;\n      try {\n         node = this.Aspen.Tree.FindNode(path).Value;\n         return node;\n      } catch {\n         return default(ValueType);\n      }\n   }\n</code></pre>\n\n<p>Why doesn't it leak?  Does anybody know?  The belies why I thought I knew about temporary references and releasing COM objects.</p>\n"},{"tags":["c#","printing","ihtmldocument2"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":7,"score":1,"question_id":13272704,"title":"IHTMLDocument2 Printing without Dialog Box","body":"<p>I've been working on a project that automatically prints HTML invoices. It's been particularly challenging as I've needed to keep the CSS formatting.</p>\n\n<p>Following advice, I've found myself using IHTMLDocument2 to carry out my printing. I'm supposed to be able to:</p>\n\n<pre><code>mshtml.IHTMLDocument2 doc = new mshtml.HTMLDocument() as mshtml.IHTMLDocument2;\ndoc.write(htmlContent); //htmlContent is a string of HTML\ndoc.execCommand(\"PRINT\", false, null);\n</code></pre>\n\n<p>The second argument specifies whether to produce the 'Printer Options' box, but it doesn't help. I've read that using \"PRINT\" will always result in a dialog box - however I haven't been able to find an alternative.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["c#",".net","impersonation","dcom"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13278831,"title":"How to impersonate another user for a DCOM connection in C#?","body":"<p>I am trying to connect to a DCOM object on a remote machine which is logged in as a different user from a C# application. I have gotten my code working to connect to the same DCOM object while it is running on the same computer, like so:</p>\n\n<pre><code>MyDCOMType dcomObject;\nType remoteSessionContextType = Type.GetTypeFromProgID(\"ServerApp.MyDCOMType\");\ndcomObject = (MyDCOMType)Activator.CreateInstance(remoteSessionContextType);\nstring version = dcomObject.GetVersion();\n</code></pre>\n\n<p>MyDCOMType is a type implemented in the DCOM application (a VB6 app) that I added as a reference in my project. I have been able to create an instance of it in the C# code and call all of the methods with the expected results. Now I am trying to get it to connect to the same object on the remote machine. I am attempting to impersonate the user on the remote system like so (variable definitions and error handling omitted):</p>\n\n<pre><code>if (LogonUser(\n       userName,\n       domain,\n       password,\n       LOGON32_LOGON_NEW_CREDENTIALS,\n       LOGON32_PROVIDER_WINNT50,\n       out token) != false)\n{\n      if (DuplicateToken(token, (int)_SECURITY_IMPERSONATION_LEVEL.SecurityDelegation, out tokenDuplicate) != false)\n      {\n            impersonationContext = WindowsIdentity.Impersonate(tokenDuplicate.DangerousGetHandle());\n      }\n }\n</code></pre>\n\n<p>Which is then followed by similar code to create the object:</p>\n\n<pre><code>MyDCOMType dcomObject;\nType remoteSessionContextType = Type.GetTypeFromProgID(\"ServerApp.MyDCOMType\", ipAddress);\ndcomObject = (MyDCOMType)Activator.CreateInstance(remoteSessionContextType);\nstring version = dcomObject.GetVersion();\n</code></pre>\n\n<p>Except that the CreateInstance call throws an UnauthorizedAccessException error with error code 80070005 for unauthorized access.</p>\n\n<p>The other thing is that I have C++ code that does the same thing that works perfectly. That code goes like so:</p>\n\n<pre><code>COAUTHINFO      AuthInfo;\nCOAUTHIDENTITY  AuthIdentity;\nCOSERVERINFO    ServerInfo;\nMULTI_QI        Results;\nHRESULT     hr;\nBSTR        version;\n_MyDCOMType     *pSession = NULL;\n\nAuthIdentity.Domain             = (unsigned short *) w_domain;\nAuthIdentity.DomainLength       = wcslen( w_domain);\nAuthIdentity.Flags              = SEC_WINNT_AUTH_IDENTITY_UNICODE;\nAuthIdentity.Password           = (unsigned short *) w_password;\nAuthIdentity.PasswordLength     = wcslen(w_password);\nAuthIdentity.User               = (unsigned short *) w_username;\nAuthIdentity.UserLength         = wcslen(w_username);\n\nAuthInfo.dwAuthnLevel           = RPC_C_AUTHN_LEVEL_CALL;\nAuthInfo.dwAuthnSvc             = RPC_C_AUTHN_WINNT;\nAuthInfo.dwAuthzSvc             = RPC_C_AUTHZ_NONE;\nAuthInfo.dwCapabilities         = EOAC_NONE;\nAuthInfo.dwImpersonationLevel   = RPC_C_IMP_LEVEL_IMPERSONATE;\nAuthInfo.pAuthIdentityData      = &amp;AuthIdentity;\nAuthInfo.pwszServerPrincName    = NULL;\n\nServerInfo.dwReserved1  = 0;\nServerInfo.dwReserved2  = 0;\nServerInfo.pAuthInfo    = &amp;AuthInfo;\nServerInfo.pwszName     = w_nodename;\n\nhr = CoCreateInstanceEx(clsid, NULL, CLSCTX_ALL, &amp;ServerInfo, (ULONG) 1, &amp;Results);\nhr = CoSetProxyBlanket(Results.pItf, RPC_C_AUTHN_WINNT, RPC_C_AUTHZ_NONE, NULL,\n    RPC_C_AUTHN_LEVEL_CALL, RPC_C_IMP_LEVEL_IMPERSONATE, &amp;AuthIdentity, EOAC_NONE);\npSession = (_MyDCOMType *)Results.pItf;\n\nhr = pSession-&gt;raw_GetVersion(&amp;version);\n</code></pre>\n\n<p>It connects to the remote server, creates the DCOM object, and gets data from it just fine. I'd like to figure out how to get my C# code to do the same. Any ideas? Did I mess up one of the enums going to the functions? Am I missing some critical call or doing something all wrong? As background, my computer and the computer I am trying to connect to are both logged in under domain accounts, but neither has permissions on the other. The C++ code impersonates the remote user for the purpose of the DCOM connection. I am trying to do a .NET impersonation in such a way that it will be valid for the network connection given a manually entered username and password.</p>\n\n<p>Alternatively, if it just isn't possible, I suppose I could write a small C++/CLR DLL with the same C++ code to handle the DCOM connection part and reference it from the C# code, but I'm hoping to avoid the extra complexity.</p>\n"},{"tags":["c#",".net","mef"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":13078821,"title":"MEF Composition ImportMany yield two versions of same class","body":"<p>I haven't been able to find an answer for my problem. I'm using MEF to find and create my classes that implement IPlugIn, but I end up with two versions of each PlugIn class. I have determined that the AggregateCatalog only contains one Assembly that contains only 1 type of each class as a Part, but I am still getting two instances of each as the end result. I'm probably just doing something stupid, but I haven't found it yet. I'd appreciate any help...</p>\n\n<pre>\n\n...\n\n    [ImportMany(typeof(IPlugIn))]\n     public System.Lazy>[] Plugins { get; set; }\n\n...\n    //aggregatecatalog only contains one dll containing plugin classes, 4 of them\n    container = new CompositionContainer(aggregateCatalog,\n                                         CompositionOptions.DisableSilentRejection \n                                         | CompositionOptions.IsThreadSafe);\\\n\n    container.SatisfyImportsOnce(this);\n\n    ...\n    public void StartAll()\n    {\n    //We have 8 PlugIns here?? How? \n    if (Plugins == null || Plugins.Count() == 0)\n    {\n\n       log.Warn(\"No PlugIns Available to Start!\");\n       return;\n    }\n\n        foreach (var plug in Plugins)\n        {\n            log.Info(\"Starting PlugIn: \" + plug.Value.GetName());\n            plug.Value.Start();\n        }\n    }\n\n   ...\n\n    [Export(typeof(IPlugIn))]\n    public class MyPlugIn : BasePlugIn, IPlugIn\n\n    ...\n\n</pre>\n\n<p>I'm debugging in Visual Studio. I clearly see only one Assembly loading. The CompositionContainer has only 1 of each. After SatisfyImportOnce in StartAll(), I have two instances of each IPlugIn classes. Is this something with the way I am using ImportMany? I am open to any ideas. </p>\n"},{"tags":["c#","sockets","networking","asynchronous","stream"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13277617,"title":"Buffering stream of strings from socket","body":"<p>I am working on a C# app that passes around strings between networked instances.</p>\n\n<p>The code is currently using async sockets, and everything works great so far (localhost).</p>\n\n<p>However, I am expecting buffering problems when the packets will be split and merged when I'll be going through real interfaces.</p>\n\n<p>Client:</p>\n\n<pre><code>Socket sock;\n// Snip init and connect\n\nstring msg1 = \"Hello\\nWorld\";\nbyte[] data1 = System.Text.Encoding.UTF8.GetBytes(msg1);\nsock.Send(data1);\n\nstring msg2 = \"Foo\\nBar\\nBaz\";\nbyte[] data2 = System.Text.Encoding.UTF8.GetBytes(msg2);\nsock.Send(data2);\n</code></pre>\n\n<p>I'd go with something like this, but I can't figure out an elegant solution to the missing bit:</p>\n\n<p>Server:</p>\n\n<pre><code>Socket sock;\nMemoryStream ms = new MemoryStream();\nQueue&lt;string&gt; strings = new Queue&lt;string&gt;();\n// Snip init and receive connection\nsock.BeginReceive(buffer, 0, MaxSize, SocketFlags.None, new AsyncCallback(OnReceived), null);\n\nvoid OnReceived(IAsyncResult result) {\n  // Snip sanity stuff\n  int bytesReceived = sock.EndReceive(result);\n\n  // Here is where I'd need some help...\n  ms.Write(buffer, 0, bytesReceived);\n  ms.Flush();\n  for (;;) {\n    StreamReader sr = new StreamReader(ms);\n    if (sr.HasAStringTerminationCharacter) { // &lt;-- How?\n      string currentString = sr.ReadUntilTermination(); // &lt;-- How?\n      strings.Enqueue(currentString);\n    }\n    else\n      break;\n  }\n  sock.BeginReceive(buffer, 0, MaxSize, SocketFlags.None, new AsyncCallback(OnReceived), null);\n}\n</code></pre>\n"},{"tags":["c#",".net","sift"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":511,"score":0,"question_id":8444503,"title":"Scale-invariant feature transform C#","body":"<p>Do you know if there is any implementation of Scale-invariant feature transform available in C# .NET? </p>\n\n<p>There is one available in <a href=\"http://www.nowozin.net/sebastian/tu-berlin-2006/libsift/\" rel=\"nofollow\">MONO</a>, but Im having many problems trying to run it.</p>\n"},{"tags":["c#","wpf","entity-framework"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13275949,"title":"update dataGrid back to ef from anonymous type","body":"<p>The following code shows into dataGrid result from two tables</p>\n\n<p>But I understand that I can not update the data back into the DB (since it shows anonymous type)</p>\n\n<pre><code>public class NameAndDone\n{\n    public string document_Name { get; set; }\n    public bool ? document_Done { get; set; }\n}\n\n\n       vagEntities projectE = new vagEntities();\n       var doc = from c in projectE.Person_Documents\n                  join cw in projectE.Documents on c.Document_Id equals cw.Document_Id\n                  where c.Person_Id == selc   \n                  select new NameAndDone { document_Name = cw.Document_Name,document_Done = c.Document_done};\n\n       carsGrid.ItemsSource = doc;\n</code></pre>\n\n<p>and in the xaml </p>\n\n<pre><code>        &lt;DataGrid Grid.Row=\"1\" RowHeight=\"30\" AutoGenerateColumns=\"False\" Margin=\"15,15,15,96\" x:Name=\"carsGrid\" &gt;\n    &lt;DataGrid.Columns&gt;\n            &lt;DataGridTextColumn  Binding=\"{Binding Path=document_Name}\" MinWidth=\"100\" Header=\"Documents\"  /&gt;\n            &lt;DataGridCheckBoxColumn  Binding=\"{Binding Path=document_Done}\" Header=\"Done\" /&gt;\n        &lt;/DataGrid.Columns&gt;\n    &lt;/DataGrid&gt;\n</code></pre>\n\n<p>My question is: Is it possible to update with the saveChanges () function?\nOr I need to change all the code (hope not)</p>\n\n<p>Thanks in advance to anyone who helps (even if I can not understand)</p>\n\n<p>Please, does anyone have an idea?</p>\n"},{"tags":["c#","asp.net","content-management-system","sitecore","sitecore6"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13279060,"title":"Sitecore item:created vs item:added","body":"<p>What is the difference between the events <code>item:created</code> vs <code>item:added</code>? When does each event get hit?</p>\n"},{"tags":["c#","casting","boxing"],"answer_count":7,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":13278911,"title":"Is it possible to box an integer to a custom type object?","body":"<p>I have an int that I am attempting to box, so as to use it in a constructor which takes as a parameter object of <code>CustomType</code>.</p>\n\n<p>An example of what I mean.</p>\n\n<pre><code> int x = 5;\n object a = x;\n\n CustomType test = new CustomType(a)\n\n //constructor in question\n public CustomType(CustomType a)\n {\n   //set some variables etc\n }\n</code></pre>\n\n<p>Howver I get the following error</p>\n\n<pre><code> The best overloaded method match for X has some invalid arguments.\n</code></pre>\n\n<p>So obviously I'm way off the mark.  Where am I going wrong? Is boxing the right solution or should i be looking at type casting?</p>\n"},{"tags":["c#",".net","windows","environment-variables","class-library"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13275338,"title":"How to resolve environment variables programatically in C# without using Environment Enum?","body":"<p>We often use %% delimited environment variables in Command prompt in Windows Xp, 7, Vista, Server 2003-2008R2 and possibly in future windows versions. Examples are:</p>\n\n<pre><code>%windir%\n%systemroot%\n%temp%\n</code></pre>\n\n<p>I need to be able to programatically resolve these environment variables using C#.</p>\n\n<p>Please do not suggest <code>Environmen.SpecialFolder</code> , because i am getting values from a webservice in the above formats and i need to able to programmatically resolve them and determine physical location of these paths on server. My scenario is a class libarary project and i may <strong>NOT</strong> require/be able to use <code>Server.MapPath</code></p>\n\n<p>I am looking for a generic method builtin or custom that can help me resolve all environment variables pro grammatically and calculate local physical paths from these variables just Command Prompt or Windows Explorer or Run Command does !</p>\n\n<p>I have seen questions similar to these on StackOverFlow but couldn't find any marked answers. Please note that <code>Environment.Xxxxx Enum</code> doesnt cater for the scenario i am working through.</p>\n\n<p>Any help is appreciated. I am using .NET 4.0 Complete Framework Profile with C#.</p>\n"},{"tags":["c#","sharepoint2010","workflow","digital-signature","infopath2010"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13180253,"title":"How to reset digital signature of an InfoPath form during c# workflow in Sharepoint 2010?","body":"<blockquote>\n  <p>As the question says, I have an InfoPath form running on SP2010 using a c# workflow upon submission.  If the form is rejected during workflow, then I need to reset it. I have everything under control, EXCEPT how to reset digital signatures to null, nill, nada, nothing, non-extant! Any ideas? I'm looking at Google now, but at current, I'm not even sure of an om for digital signatures?</p>\n</blockquote>\n"},{"tags":["c#","mvvm","windows-8","winrt","windows-store-apps"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":8,"score":1,"question_id":13279397,"title":"How can I create a bindable command proxy","body":"<p>I am currently developing a Windows store app using the MVVM pattern. The ViewModel implements a couple of commands that are used by the view. In some cases I want the view to trigger more than just one command. Therefore I created a CommandGroup class that is derived from ICommand and holds an observable collection of commands. In order to be able to populate this collection using XAML I created another class called CommandProxy that is derived from DependencObject and also implements ICommand.</p>\n\n<p>The idea is to support something like this within the view:</p>\n\n<pre><code>&lt;Button Content=\"Test\"&gt;\n   &lt;Button.Command&gt;\n      &lt;vm:CommandGroup&gt;\n         &lt;vm:CommandGroup.Commands&gt;\n            &lt;vm:CommandProxy Command=\"{Binding Command1}\" CommandParameter=\"{Binding ElementName=Object1}\"/&gt;\n            &lt;vm:CommandProxy Command=\"{Binding Command2}\" CommandParameter=\"{Binding ElementName=Object2}\"/&gt;\n            &lt;vm:CommandProxy Command=\"{Binding Command3}\" CommandParameter=\"{Binding ElementName=Object3}\"/&gt;\n         &lt;/vm:CommandGroup.Commands&gt;\n      &lt;/vm:CommandGroup&gt;\n   &lt;/Button.Command&gt;\n&lt;/Button&gt;\n</code></pre>\n\n<p>Everything looks fine when doing a syntax check, but the bindings are not resolved at runtime. This can be reproduced using the following example assuming the ViewModel implements the command MyCommand and the view contains an element called MyElement:</p>\n\n<pre><code>&lt;Button Content=\"Test\"&gt;\n   &lt;Button.Command&gt;\n      &lt;vm:CommandProxy Command=\"{Binding MyCommand}\" CommandParameter=\"{Binding ElementName=MyElement}\"/&gt;\n   &lt;/Button.Command&gt;\n&lt;/Button&gt;\n</code></pre>\n\n<p>This is a simplyfied version of the CommandProxy class that can be used to reproduce the issue:</p>\n\n<pre><code>public class CommandProxy : DependencyObject, ICommand\n{\n    public static readonly DependencyProperty CommandProperty =\n        DependencyProperty.Register(\"Command\", typeof(object), typeof(CommandProxy), new PropertyMetadata(null));\n\n    public static readonly DependencyProperty CommandParameterProperty =\n        DependencyProperty.Register(\"CommandParameter\", typeof(object), typeof(CommandProxy), new PropertyMetadata(null));\n\n    /// &lt;summary&gt;\n    /// Command\n    /// &lt;/summary&gt;\n    public ICommand Command\n    {\n        get\n        {\n            return (ICommand)GetValue(CommandProperty);\n        }\n\n        set\n        {\n            SetValue(CommandProperty, value);\n        }\n    }\n\n    /// &lt;summary&gt;\n    /// Command Parameter\n    /// &lt;/summary&gt;\n    public object CommandParameter\n    {\n        get\n        {\n            return GetValue(CommandParameterProperty);\n        }\n\n        set\n        {\n            SetValue(CommandParameterProperty, value);\n        }\n    }\n\n    /// &lt;summary&gt;\n    /// Event used to singnal that CanExecute has changed\n    /// &lt;/summary&gt;\n    public event EventHandler CanExecuteChanged;\n\n    /// &lt;summary&gt;\n    /// Create new CommandGroupElement\n    /// &lt;/summary&gt;\n    public CommandProxy()\n    {\n    }\n\n    /// &lt;summary&gt;\n    /// Determine whether command can be executed\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"parameter\"&gt;&lt;/param&gt;\n    /// &lt;returns&gt;&lt;/returns&gt;\n    public bool CanExecute(object parameter)\n    {\n        if (Command != null)\n            return Command.CanExecute(CommandParameter);\n         return false;\n    }\n\n    /// &lt;summary&gt;\n    /// Execute Command\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"parameter\"&gt;Parameter&lt;/param&gt;\n    public void Execute(object parameter)\n    {\n        if (Command != null)\n            Command.Execute(CommandParameter);\n    }\n\n    /// &lt;summary&gt;\n    /// Raise CanExecuteChanged event\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"sender\"&gt;&lt;/param&gt;\n    /// &lt;param name=\"e\"&gt;&lt;/param&gt;\n    protected void raiseCanExecuteChanged()\n    {\n        raiseCanExecuteChanged(this, EventArgs.Empty);\n    }\n\n    /// &lt;summary&gt;\n    /// Raise CanExecuteChanged event\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"sender\"&gt;Parameter&lt;/param&gt;\n    /// &lt;param name=\"e\"&gt;&lt;/param&gt;\n    protected void raiseCanExecuteChanged(object sender, EventArgs e)\n    {\n       if (CanExecuteChanged != null)\n           CanExecuteChanged(this, EventArgs.Empty);\n    }\n}\n</code></pre>\n\n<p>Is there anybody who can tell me what I'm doing wrong or explain me why this does not work?</p>\n\n<p>Kind regards</p>\n\n<p>Thomas</p>\n"},{"tags":["c#","tcp","listener","ports"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13279333,"title":"Listening to multiple ports with TcpListener","body":"<p>I need to listen to about 100 different ports via TCP. Looking at the TcpListener class in C#, it obviously listens on just one port. Does it make sense to create 100 different TcpListener instances each with their own port. </p>\n\n<p>I am not seeing it as a clean solution but it seems like the only option.</p>\n\n<p>Thanks for any opinions in advance</p>\n"},{"tags":["c#","java","launching-application"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":98,"score":4,"question_id":11248691,"title":"Error when launching java program from C#","body":"<p>I trying to launch java program with this code:</p>\n\n<pre><code>ProcessStartInfo info = new ProcessStartInfo();\n        info.WorkingDirectory = @\"D:\\2\\server\";\n        info.FileName = \"java\";\n        info.Arguments = \"-Xms512m -Xmx1536m -Xbootclasspath/p:./libs/jsr166.jar -cp ./libs/*;server.jar server.Server\";\n        ServerProcess = new Process();\n        ServerProcess.StartInfo = info;\n        ServerProcess.Start();\n</code></pre>\n\n<p>But always getting error:</p>\n\n<blockquote>\n  <p>Error occurred during initialization of VM Could not reserve enough\n  space for object heap Could not create the Java virtual machine.</p>\n</blockquote>\n\n<p>But if i create a .bat file with code:</p>\n\n<pre><code>java -Xms512m -Xmx1536m -Xbootclasspath/p:./libs/jsr166.jar -cp ./libs/*;server.jar server.Server\n</code></pre>\n\n<ul>\n<li>all ok!</li>\n</ul>\n\n<p>So i guess something wrong with my C# code?</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#",".net","linq","extension-methods"],"answer_count":1,"favorite_count":6,"up_vote_count":5,"down_vote_count":0,"view_count":44,"score":5,"question_id":13279215,"title":"Wrap a Linq query in a try/catch block using a method declaration","body":"<p>So here is what I would like to be able to do.</p>\n\n<pre><code>var a = Item.CatchLog().Where(x=&gt;x.Property==\"value\").Take(10);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>var a = Item.CatchLog().FirstOrDefault(x=&gt;x.Property==\"value\");\n</code></pre>\n\n<p>or</p>\n\n<pre><code>var a = Item.CatchLog().Any(x=&gt;x.Property==\"value\");\n</code></pre>\n\n<p>Essentially, I would like is for <code>CatchLog()</code> to basically wrap the execution of the query in a try catch, and <code>Debug.WriteLine()</code> the <code>Exception</code> and then <code>throw</code> it. </p>\n\n<p>Any ideas on how I could implement something like this?</p>\n"},{"tags":["c#","linq","entity-framework","casting"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":113,"score":4,"question_id":13276806,"title":"Converting from IEnumerable<IEnumerable<string>> to ICollection<T>","body":"<p>I'm trying to convert an <code>IEnumerable&lt;IEnumerable&lt;string&gt;&gt;</code> to <code>ICollection&lt;Character&gt;</code> but struggling to figure out the right way to do it since the structure of one object is different than the structure of the other.</p>\n\n<p>The reason for conversion is to take a json deserialization and insert that into a database via Entity Framework. The json data isn't normalized and doesn't match the exact structure of the database. In the database I have a <code>movie</code> and a <code>person</code> that have a many-to-many relationship. The bridge table between them is <code>characters</code>. But the json just has a movie object with an array of people objects and each person with an array of the characters they play (<code>IEnumerable&lt;IEnumerable&lt;string&gt;&gt;</code>).</p>\n\n<p>Basically, I need to convert each movie's people and their characters to each movie's character and its respective person.</p>\n\n<pre><code>var movie = dataContractMovies.Select(m =&gt; new Movie {\n    Title = m.Title,\n    // not sure how to convert each Person and their characters\n    Characters = // Need to take each Person and their Characters in m.Cast and cast to a new Character and a new Person for which the Character belongs to\n});\n</code></pre>\n\n<p><strong>Convert From</strong></p>\n\n<pre><code>public class MovieDataContract {\n    [DataMember(Name = \"title\")]\n    public string Title { get; set; }\n\n    [DataMember(Name = \"abridged_cast\")]\n    public virtual IEnumerable&lt;Person&gt; Cast { get; set; }\n}\n\n[DataContract]\npublic class Person {\n    [DataMember(Name = \"name\")]\n    public string Name { get; set; }\n\n    [DataMember(Name = \"characters\")]\n    public IEnumerable&lt;string&gt; Characters { get; set; }\n} \n</code></pre>\n\n<p><strong>Convert To</strong></p>\n\n<pre><code>public partial class Movie {\n    public string Title { get; set; }\n    public virtual ICollection&lt;Character&gt; Characters { get; set; }\n\n    public Movie() {\n        this.Characters = new HashSet&lt;Character&gt;();\n    }\n}\n\npublic partial class Character {\n    public string Name { get; set; }\n    public virtual Movie Movie { get; set; }\n    public virtual Person Person { get; set; }\n}\n\npublic partial class Person {\n    public string Name { get; set; }\n    public virtual ICollection&lt;Character&gt; Characters { get; set; }\n\n    public Person() {\n        this.Characters = new HashSet&lt;Character&gt;();\n    }\n}\n</code></pre>\n"},{"tags":["c#","linq","lambda"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13279000,"title":"Convert lambda expression to linq query","body":"<p>Is there any way to convert this lambda expression in linq query?</p>\n\n<pre><code>function List&lt;ViewModel&gt; CreateViewModels(List&lt;Model&gt; models)\n{\n   return models.Select(x =&gt;\n   {\n      var viewModel = new ViewModel();\n\n      this.UpdateViewModel(x, viewModel);\n\n      return viewModel;\n   }).ToList();\n}\n</code></pre>\n\n<p>Where 'UpdateViewModel' is a function that transfer the values from the Model object to the ViewModel object.</p>\n\n<p>Ok, this code is clean but I'm wondering to know if there is the equivalent with a linq query.</p>\n"},{"tags":["c#",".net","pdf","epub"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13279243,"title":"Validation for epub file and convert epub file to pdf","body":"<p>I have <strong>large</strong> volumes of epub files coming to my server. I have to validate epub file. I am not sure what should I do to validate for valid epub files. </p>\n\n<p>1.Anything specifically I should be validating for checking valid epub files.<br>\n2. What is the best way to convert epub to pdf files.</p>\n\n<p>I am using C# for coding. </p>\n"},{"tags":["c#","windows-8","visual-studio-2012","bing-maps","bing-maps-api"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":13239597,"title":"Why can I not reference Bing Maps in my app?","body":"<p>I tried to add a Reference to Bing Maps in my app by right-clicking on <em>References | Add References | Windows | Extensions | Bing Maps for C#...</em>, but selecting \"OK\" does nothing - the Reference is not added.</p>\n\n<p>I then tried adding it via <em>Tools | Extensions and Updates</em>, but when I installed the latest version (with today's date - 11/5/2012), I then got:</p>\n\n<pre><code>Successfully installed 'BingMapAppSDK 1.0.1011.1716'.\nSuccessfully uninstalled 'BingMapAppSDK 1.0.1011.1716'.\nInstall failed. Rolling back...\nCould not install package 'BingMapAppSDK 1.0.1011.1716'. You are trying to install this package into a project that targets '.NETCore,Version=v4.5', but the package does not contain any assembly references that are compatible with that framework. For more information, contact the package author.\n</code></pre>\n\n<p>Now the button there (at <em>Tools | Extensions and Updates | Bing Maps SDK for C#...</em> says \"Uninstall\" so it is apparently installed, but why can I not add the Reference to my project?</p>\n\n<h2>UPDATE</h2>\n\n<p>It's not just Bing Maps that won't let itself be added to my project's References; when I try to add \"Microsoft Visual C++ Runtime Package,\" it also will not be added; there's no err msg when I select it, it simply doesn't get added...</p>\n\n<p>I have another project which has \"Bing Maps for C#...\" installed as a Reference. Why that one would work and the other one not is both a conundrum and an irritation.</p>\n\n<p>The bizarre thing is that, according to <em>Extensions and Updates  Installed | SDKs</em>, in the working project the only Bing Maps SDK installed is the one for JavaScript... and yet my project does have a Reference to \"Bing Maps for CE, C++, or VB\"...???</p>\n\n<p>Yet if I go to <em>Extensions and Updates | Online | Visual Studio Gallery</em> and search for \"bing maps\" the search results contains \"Bing Maps SDK for Windows Store apps\" with a green check, indicating it is installed.</p>\n\n<p>Could it be my project's configuration? The project that works is set for Debug, x86. The one that doesn't work is set to Debug, Any CPU...???</p>\n\n<p>And if I'm doing something wrong, why is the \"Filtered to: SDKs applicable to  displaying (among other things) \"Bing Maps for C#, C++, or VB\"? </p>\n\n<p>IOW, it's teasing me that it's available, but won't allow it to be added...argghhhh!!!</p>\n\n<h2>UPDATE 2</h2>\n\n<p>Maybe this could be a clue to my problem: In <em>Tools | Extensions and Updates</em>, Bing Maps SDK for Windows Store apps appears in the \"Tools\" category as opposed to the SKDKs category (although Bing Maps SDK for JavaScript) is in the SDKs category...</p>\n\n<h2>UPDATE 3</h2>\n\n<p>Based on Mayank's suggestion, I tried to browse to and add the .dll</p>\n\n<p>That not only didn't work, but also gave me an err msg:</p>\n\n<p><em>\"A reference to C:\\Users\\Clay\\AppData\\Local\\Microsoft SDKs\\Windows\\v8.0\\ExtensionSDKs\\Bing.Maps.Xaml\\1.0\\DesignTime\\CommonConfiguration\\x86\\Bing.Maps.Design.dll' could not be added. The project targets '.NETCore' while the file reference targets .NETFramework'. This is not a supported scenario.</em></p>\n\n<p>If this is truly the problem, how do I switch from .NETCore to .NETFramework? I'm certain I did not explicitly choose .NETCore at any time for this project...</p>\n\n<h2>UPDATE 4</h2>\n\n<p>Elsewhere somebody suggested I compare the .csproj files of an app that does work with the Bing Maps and the one that doesn't. Here's is what I have come up with:</p>\n\n<p>I noticed that the app that IS working with Bing Maps has this in the .csproj file, whereas the other one doesn't:</p>\n\n<pre><code>&lt;Compile Include=\"DataModel\\SampleDataSource.cs\" /&gt;\n    &lt;Compile Include=\"Common\\BindableBase.cs\" /&gt;\n    &lt;Compile Include=\"Common\\BooleanToVisibilityConverter.cs\" /&gt;\n    &lt;Compile Include=\"Common\\BooleanNegationConverter.cs\" /&gt;\n    &lt;Compile Include=\"Common\\LayoutAwarePage.cs\" /&gt;\n    &lt;Compile Include=\"Common\\RichTextColumns.cs\" /&gt;\n    &lt;Compile Include=\"Common\\SuspensionManager.cs\" /&gt;\n    &lt;Compile Include=\"SQLite.cs\" /&gt;\n    &lt;Compile Include=\"SQLiteAsync.cs\" /&gt;\n    &lt;Compile Include=\"ViewModel\\StorageUtils.cs\" /&gt;\n    &lt;Compile Include=\"View\\SectionN.xaml.cs\"&gt;\n      &lt;DependentUpon&gt;SectionN.xaml&lt;/DependentUpon&gt;\n    &lt;/Compile&gt;\n</code></pre>\n\n<p>...although curious (why does one include all of those files, and the other doesn't?), I don't see why this would be a problem.</p>\n\n<p>Also, the working app contains this:</p>\n\n<pre><code>&lt;/PropertyGroup&gt;\n  &lt;PropertyGroup Condition=\"'$(Configuration)|$(Platform)' == 'TSLsARM|\nAnyCPU'\"&gt;\n    &lt;DebugSymbols&gt;true&lt;/DebugSymbols&gt;\n    &lt;OutputPath&gt;bin\\TSLsARM\\&lt;/OutputPath&gt;\n    &lt;DefineConstants&gt;DEBUG;TRACE;NETFX_CORE&lt;/DefineConstants&gt;\n. . .\n</code></pre>\n"},{"tags":["c#","inotifypropertychanged","bindinglist"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":12,"score":2,"question_id":13279186,"title":"INotifyPropertyChanged and the BindingList ListChanged event","body":"<p>If I have a class like the one below:</p>\n\n<pre><code>public class MyClass : INotifyPropertyChanged\n{\n    private BindingList&lt;String&gt; myList;\n\n    public BindingList&lt;String&gt; MyList\n    {\n        get { return myList; }\n        set\n        {\n            if (myList == value) return;\n            myList = value;\n            OnPropertyChanged(\"MyList\");\n        }\n    }\n}\n</code></pre>\n\n<p>Do I need to setup the following event handler:</p>\n\n<pre><code>myList.ListChanged += (object sender, ListChangedEventArgs e) =&gt; OnPropertyChanged(\"MyList\");\n</code></pre>\n\n<p>Or is it detected?  I know that the BindingList class will look for the INotifyPropertyChanged interface on the templated type it is of so it can determine whether it should raise the ListChanged event, but I am uncertain if it works the other way.</p>\n"},{"tags":["c#","windows-8","winrt-xaml"],"answer_count":3,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":2377,"score":3,"question_id":10362566,"title":"How to programmatically respond to Snap in Windows 8 Metro","body":"<p>Is there a way to respond to Snap in C# in a Metro app? When one of the pages is snapped I need to show another one. My idea is to respond to snap by naviating to another page.</p>\n\n<p>I found</p>\n\n<pre><code>var currentView = ApplicationLayout.GetForCurrentView();\ncurrentView.LayoutChanged += new TypedEventHandler&lt;ApplicationLayout, ApplicationLayoutChangedEventArgs&gt;(currentView_LayoutChanged);\n</code></pre>\n\n<p>but it looks like it no longer works in Consumer Preview. Is there another way?</p>\n"},{"tags":["c#","asp.net","appfabric","windows-server","appfabric-cache"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13279038,"title":"AppFabric 1.0 error Server collection cannot be empty","body":"<p>I am getting the following error when I run the simple <strong>Windows Server App Fabric 1.0</strong> demo console application: </p>\n\n<pre><code>ErrorCode&lt;ERRCA0021&gt;:SubStatus&lt;ES0001&gt;:Server collection cannot be empty.\n</code></pre>\n\n<p>Please help me.. What am I missing..?? I have looked every where on the internet and nothing seems to be fixing this issue. thanks..</p>\n\n<p>My application is as follows: </p>\n\n<pre><code>static void Main(string[] args)\n{\n    var factory = new Microsoft.ApplicationServer.Caching.DataCacheFactory(); &lt;--- *** Error here\n\n    var cache = factory.GetDefaultCache();\n    var key = \"mykey\";\n    var obj = cache[key];\n    if (obj == null)\n    {\n        cache[key] = \"I am data for caching\";\n    }\n    obj = cache[key];\n    Console.WriteLine(obj);\n    Console.Read();\n}\n</code></pre>\n\n<p>My app.config is as follows:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;configuration&gt;\n&lt;configSections&gt;\n    &lt;section name=\"dataCacheClients\"\n                type=\"Microsoft.ApplicationServer.Caching.DataCacheClientsSection, Microsoft.ApplicationServer.Caching.Core\" /&gt; \n&lt;/configSections&gt;\n&lt;dataCacheClients&gt;\n&lt;dataCacheClient&gt;\n    &lt;hosts&gt;\n        &lt;host name=\"MyMachineNameHere\" cachePort=\"22233\" /&gt;\n    &lt;/hosts&gt;\n&lt;/dataCacheClient&gt;\n&lt;/dataCacheClients&gt;\n&lt;/configuration&gt;\n</code></pre>\n"},{"tags":["c#","linq","visual-studio-lightswitch"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13017288,"title":"Lightswitch, adding filter to query that relies on unsaved changes","body":"<p>I'm using Lightswitch and I'm trying to populate a dropdown list by filtering the query to the a list of items that have not been selected already.</p>\n\n<p>The code I wrote works, but it is only using the data that has been \"saved\".  I'd like to filter out things that have been added, but not necessarily saved.</p>\n\n<pre><code>partial void NotAssignedToEventEmployee_PreprocessQuery(int? SelectedEventId, ref IQueryable&lt;EmployeeItem&gt; query)\n{\n    query = from a in query\n            where a.AssignmentsAsEmployeeCollection.All(y =&gt; y.EventSetItem.Id != (int)SelectedEventId)\n            select a;\n}\n</code></pre>\n"},{"tags":["c#","asp.net",".net"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13279200,"title":"Session becomes null?","body":"<p>When operating on a HttpSessionStateWrapper object, sometimes it becomes null in the middle of an operation.  In the following code sample, otherSession is NOT the current session. It's the session of a different user:</p>\n\n<pre><code>string id = otherSession == null ? \"\" : otherSession.SessionID; \n</code></pre>\n\n<p>The above line will occasionally fail with a NullReferenceException.  My guess is that after otherSession is checked for null but before the SessionID property is accessed, otherSession is set to null in another thread (not my own thread, but elsewhere in asp.net) so that when the SessionID property is accessed the NullReferenceException occurs. </p>\n\n<p>I am wondering </p>\n\n<ol>\n<li>What causes otherSession to be set to null?</li>\n<li>How can I replicate the circumstances that result in otherSession becoming null so I can ensure my handling of that scenario is adequate?</li>\n</ol>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13253444,"title":"Programmatically calling PreviewTextInput not invoking TextChanged event","body":"<p>I have a <code>TextBox</code> that only allows certain characters to be typed into it; I'm handling this logic in the <code>PreviewTextInput</code> event.  If it's a character that's allowed, then the <code>TextChanged</code> event is fired, otherwise it cancels the <code>TextChanged</code> event.</p>\n\n<p>I have another application that is opened on a second screen while this is running, however even if there is keyboard input while the other application is active, it should still update the currently focused <code>TextBox</code> on the main application.  To do this, I added a listener to the <code>OnKeyPress()</code> event on the second application, which calls the <code>PreviewTextInput</code> event on the focused <code>TextBox</code> in the main application.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>private void ImageEventController_OnKeyPress(char c)\n        {\n            object focusedElement = this.CurrentKeyboardFocus;\n            if (focusedElement != null)\n            {\n                if (focusedElement is TextBox)\n                {\n                    TextBox target = (TextBox)focusedElement;\n                    if (target.IsEnabled)\n                    {\n                        string text = c.ToString();\n                        var routedEvent = TextCompositionManager.PreviewTextInputEvent;\n\n\n         target.RaiseEvent(new TextCompositionEventArgs(\n                    InputManager.Current.PrimaryKeyboardDevice,\n                    new TextComposition(InputManager.Current, target, text)) { RoutedEvent = routedEvent });\n                }\n            }\n        }\n    }\n</code></pre>\n\n<p>When this is called, it goes through the <code>PreviewTextInput</code> event, however the <code>TextChanged</code> event never gets fired even if it's a valid character.  Is there any reason why <code>TextChanged</code> is not getting fired when <code>PreviewTextInput</code> is invoked programmatically?</p>\n\n<p>UPDATE:</p>\n\n<p>I added in this code to the bottom of my <code>PreviewTextInput</code> event listener:</p>\n\n<pre><code>if (!e.Handled)\n{\n     textbox.Text = e.Text;\n}\n</code></pre>\n\n<p>This forces the <code>TextChanged</code> event to fire and fixes the functionality when the second application has focus, however if the main application has focus it causes two TextBoxes to get updated when only pressing one button.</p>\n"},{"tags":["c#",".net","regex"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13278793,"title":"Regex end-of-line anchor doesn't always work","body":"<p>I'm working on an ASP .NET (C#) project that makes use of regular expressions and I'm having trouble with the end-of-line anchors! I'm looking for some text and I want to make sure it only occurs at the end of a string.</p>\n\n<p>Here's some sample input that demonstrates my problem. For this case I'm trying to match the word \"text\" at the end.</p>\n\n<blockquote>\n  <p>This text is my sample text</p>\n</blockquote>\n\n<p>And here are the expressions I've tried (with the IgnoreCase option):</p>\n\n<pre><code>text\\z\ntext\\Z\ntext$\n</code></pre>\n\n<p>Now here's the crazy part. None of these regular expressions work on my system (Windows 8 Pro 64-bit, VS2010, .NET 4.0). I've debugged in my project and I've also tried the \"Regex Tester\" app from the Windows 8 store. It will not match!</p>\n\n<p>However, if I use an online regex tester, for example Derek Slager's at <a href=\"http://derekslager.com/blog/posts/2007/09/a-better-dotnet-regular-expression-tester.ashx\" rel=\"nofollow\">http://derekslager.com/blog/posts/2007/09/a-better-dotnet-regular-expression-tester.ashx</a> which runs on .NET, or this Silverlight one at <a href=\"http://regexhero.net/tester/\" rel=\"nofollow\">http://regexhero.net/tester/</a>, using the exact same patterns and inputs, it matches the final instance of \"text\" with no problem.</p>\n\n<p>I'm confused. I really need reliable end-of-string matching and I don't know what I'm doing wrong.</p>\n\n<p>EDIT: Apparently I can't used compiled regex's. Here's an example using the data the project actually runs on:</p>\n\n<pre><code>class Program\n{\n    static void Main(string[] args)\n    {\n        string url = \"http://192.168.0.113/MidlandGIS/rest/services/Osceola_Assessor_Data/MapServer/?f=pjson\";\n        string pattern = @\"mapserver/\\?f=(json|pjson)$\";\n\n        Regex myRegex = new Regex(pattern, RegexOptions.IgnoreCase &amp; RegexOptions.Compiled);\n        Console.Write(\"Trying compiled regex: \");\n        if (myRegex.IsMatch(url))\n            Console.WriteLine(\"Match\");\n        else\n            Console.WriteLine(\"No match.\");\n\n        myRegex = new Regex(pattern, RegexOptions.IgnoreCase);\n        Console.Write(\"Trying non-compiled regex: \");\n        if (myRegex.IsMatch(url))\n            Console.WriteLine(\"Match\");\n        else\n            Console.WriteLine(\"No match.\");\n\n        Console.Write(\"Trying inline regex: \");\n        if (Regex.IsMatch(url, pattern, RegexOptions.IgnoreCase))\n            Console.WriteLine(\"Match\");\n        else\n            Console.WriteLine(\"No match\");\n\n        Console.Write(\"Press any key to terminate.\");\n        Console.ReadKey();\n    }\n}\n</code></pre>\n\n<p>outputs</p>\n\n<pre><code>Trying compiled regex: No match\nTrying non-compiled regex: Match\nTrying inline regex: Match\nPress any key to terminate.\n</code></pre>\n\n<p>Edit again: OK I'm a complete idiot. I was using bitwise AND when I should be using bitwise OR to combine the regex options. Compiled regex's work just fine now.</p>\n"},{"tags":["c#","oop","class-structure"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":183,"score":1,"question_id":9592030,"title":"C# Array Properties and Class Structure","body":"<p>The current structure of my classes goes a little bit like this:\nPC.Processor.Architecture[0] = The Architecture of the first processor (assuming a multi-processor system).</p>\n\n<p>How I ideally want it is more like this:\nPC.Processor[0].Architecture, because it's a bit more self explanatory this way.</p>\n\n<p>Is there a fairly efficient way of doing this with what I have? Bear in mind there are like, over 9000 properties in each of the classes Processor, Motherboard, Memory etc and WMI calls are not CPU-cheap to run.</p>\n\n<p>Here are the important snippets for my classes</p>\n\n<pre><code>class PC\n{\n    public Processor Processor;\n    public Motherboard Motherboard;\n\n    // Constructor\n    public PC()\n    {\n        Processor = new Processor();\n        Motherboard = new Motherboard();\n    }\n\n    // Method to get all info sequentially\n    public void GetAllInfo()\n    {\n        Processor.GetInfo();\n        Motherboard.GetInfo();\n    }\n}\n\nclass Processor\n{\n    public string[] Architecture;\n    public string[] Availability;\n    public UInt16[] Cores;\n\n    public void GetInfo()\n    {\n        // Get WMI Information from custom process\n        // Returns as an array of ManagementObjects for each matched device (which is a bit like an array of dictionaries)\n        ManagementObject[] WMIData = DataRetriever.GetWMIData(\"Win32_Processor\");\n        try\n        {\n            for (int i = 1; i &lt; WMIData.Length; i++)\n            {\n                this.Architecture[i] = (string)WMIData[i][\"Architecture\"];\n                this.Availability[i] = (string)WMIData[i][\"Availability\"];\n                this.Cores[i] = (UInt16)WMIData[i][\"NumberOfCores\"];\n            }\n        }\n        catch (NullReferenceException e)\n        {\n            // To be implemented\n        }\n    }\n}\n</code></pre>\n\n<p><strong>FURTHERMORE</strong><br>\nThere may be more than one WMI search query per class. For example, HardDrive needs to make use of both Win32_PhysicalMedia and ATAPI_SmartData (or whatever the class actually is.)</p>\n"},{"tags":["c#",".net","xml","linq","linq-to-xml"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13278778,"title":"How to use XElement.Parse and then find the value of a specific element?","body":"<p>I've got some XML that is returned from a REST call that looks like this:</p>\n\n<pre><code>&lt;ArrayOfProperty xmlns=\\\"http://schemas.microsoft.com/HPCS2008R2/common\\\" xmlns:i=\\\"http://www.w3.org/2001/XMLSchema-instance\\\"&gt;\n  &lt;Property&gt;\n    &lt;Name&gt;Id&lt;/Name&gt;\n    &lt;Value&gt;17&lt;/Value&gt;\n  &lt;/Property&gt;\n  &lt;Property&gt;\n    &lt;Name&gt;StartTime&lt;/Name&gt;\n    &lt;Value&gt;11/7/2012 9:13:50 PM&lt;/Value&gt;\n  &lt;/Property&gt;\n  &lt;Property&gt;\n    &lt;Name&gt;State&lt;/Name&gt;\n    &lt;Value&gt;Failed&lt;/Value&gt;\n  &lt;/Property&gt;\n</code></pre>\n\n<p>I'm using the RestSharp API to assist in executing the API calls and trying to use the linq-to-xml XElement.Parse to parse the results.  I'm not sure how to get the value of the state such that from within this document I want to do something like :</p>\n\n<p><code>XElement.Parse(XMLstring).Elements???</code> to get the text \"Failed\" from the set of elements that contains the element State but I want the text \"Failed\" from the <code>&lt;Value&gt;Failed&lt;/Value&gt;</code> element.  That value element can have multiple values but I always want the value that is associated with the state.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["c#","path","system.diagnostics","process.start"],"answer_count":7,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1710,"score":3,"question_id":8003272,"title":"Can Process.Start() take the system PATH into account?","body":"<p>I've been searching and experimenting for a while with this but have had no luck.</p>\n\n<p>I am trying to make a console program to automate some tasks that I couldn't quite do with a BAT file.  I want to call \"signcode.exe\" from the Windows SDK, the bin folder with all the tools in in my system PATH and I can call \"signcode\" from anywhere but Process.Start is ignoring path.</p>\n\n<p>Current code:</p>\n\n<pre><code>System.Diagnostics.Process sign = new System.Diagnostics.Process();\nsign.StartInfo.FileName         = signCommand.Substring(0, signCommand.IndexOf(' '));  // signtool.exe\nsign.StartInfo.Arguments        = signCommand.Substring(signCommand.IndexOf(' ') + 1); // /sign /a file1 file2\n\n// sign.StartInfo.EnvironmentVariables[\"Path\"] = Environment.GetEnvironmentVariable(\"PATH\");  // this doesn't work either\nsign.StartInfo.UseShellExecute              = false;\nsign.StartInfo.RedirectStandardOutput       = true;\nsign.StartInfo.RedirectStandardError        = true;\n\nsign.Start();  // Throws Win32Exception - The system cannot find the file specified\n</code></pre>\n\n<p>I've confirmed that StartInfo.EnvironmentVariables[\"Path\"] matches my system path, and contains the Windows SDK folder.  Setting it manually doesn't work either.</p>\n\n<p>I've even tried setting TempPath as shown on the MSDN page for <a href=\"http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.environmentvariables.aspx\" rel=\"nofollow\">EnvironmentVariables Property</a> but that didn't work either.  I wonder why you would be able to set this if it has no effect.</p>\n\n<p>If System.Diagnostics.Process cannot use the path, are there any other functions I could use?  I'd like to see the output of the command in my console application as well.</p>\n\n<p>Thanks.</p>\n\n<p>EDIT:  Here is some additional debug values:</p>\n\n<pre><code>Console.WriteLine(\"Sign Filename = '{0}'\", sign.StartInfo.FileName);\nSign Filename = 'signtool.exe'\n\nConsole.WriteLine(\"Sign Arguments = '{0}'\", sign.StartInfo.Arguments);\nSign Arguments = '/sign /f C:\\Visual Studio\\Projects\\MGInsight\\MGInsight\\APPARENTINC.pfx /t http://timestamp.comodoca.com/authenticode \"C:\\Visual Studio\\Projects\\MGInsight\\MGInsight\\Publish\\Application Files\\\\MGInsight_0_9_1_85\\MGInsight.exe\" \"C:\\Visual Studio\\Projects\\MGInsight\\MGInsight\\Publish\\Application Files\\\\MGInsight_0_9_1_85\\XPXScanner.dll\" \"C:\\Visual Studio\\Projects\\MGInsight\\MGInsight\\Publish\\Application Files\\\\MGInsight_0_9_1_85\\NetworkCalculations.dll\"'\n\nConsole.WriteLine(\"Sign Path = '{0}'\", sign.StartInfo.EnvironmentVariables[\"Path\"]);\nSign Path = 'C:\\Windows\\system32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\;\"C:\\Program Files\\Intel\\WiFi\\bin\\\";\"C:\\Program Files\\Common Files\\Intel\\WirelessCommon\\\";\"C:\\Program Files (x86)\\cwRsync\\bin\";\"C:\\Program Files (x86)\\Git\\cmd\";\"C:\\Program Files (x86)\\Git\\bin\";\"C:\\Program Files (x86)\\Zend\\ZendServer\\bin\";\"C:\\Program Files (x86)\\Zend\\ZendServer\\share\\ZendFramework\\bin\";\"C:\\Program Files\\Java\\jre6\\bin\";\"C:\\Program Files (x86)\\Microsoft Visual Studio 10.0\\Common7\\IDE\\\";\"C:\\Program Files\\Microsoft Windows Performance Toolkit\\\";C:\\MinGW\\bin;\"C:\\Program Files (x86)\\Microsoft\\ILMerge\";\"C:\\Program Files (x86)\\Microsoft SDKs\\Windows\\v7.0A\\Bin\";C:\\Program Files (x86)\\Nmap'\n</code></pre>\n\n<p>The path <code>\"C:\\Program Files (x86)\\Microsoft SDKs\\Windows\\v7.0A\\Bin\"</code> is where signtool.exe is and I can run it from command prompt by simply typing <code>signtool</code>, but if I run this application from the same prompt, it doesn't register that path.</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":192,"score":-2,"question_id":9592243,"title":"Why does this C# code fail?","body":"<p>This is matrix product which saves the answer in <code>C</code>, such that <code>C=A*B</code>. So why won't the <code>C</code> values change?</p>\n\n<p>It uses special way that it calculates each column, because we want to use this method in Parallel programming such that each column evaluated in a single thread. I have tested something like this in pascal before, but in C# every thing is wrong.</p>\n\n<p>Note: This is for homework and there is no parallel in this code yet.</p>\n\n<pre><code>class Program\n{\n    private static int n = 2;\n    static int[,] A = new int[n, n];\n    static int[,] B = new int[n, n];\n    static int[,] C = new int[n, n];\n    private static void Main(string[] args)\n    {\n        A[0, 0] = 2; A[0, 1] = 3;\n        A[1, 0] = 5; A[1, 1] = 1;\n\n        B[0, 0] = 3; B[0, 1] = 0;\n        B[1, 0] = 1; B[1, 1] = 0;\n\n        C[0, 0] = 0; C[0, 1] = 0;\n        C[1, 0] = 0; C[1, 1] = 0;\n\n        //Calculation \n        for (int z = 0; z &lt; n; z++)\n        {\n            ComputeColumn(z);\n        }\n        PrintAnswer(C);\n        Console.ReadKey();\n    }\n    private static void ComputeColumn(int n)\n    {\n        for (int i = 0; i &lt; n; i++)\n        {\n            for (int k = 0; k &lt; n; k++)\n            {\n                C[i, n] += (A[i, k] * B[k, n]);\n            }\n        }\n    }\n    private static void PrintAnswer(int[,] what)\n    {\n        for (int i = 0; i &lt; n; i++)\n        {\n            for (int j = 0; j &lt; n; j++)\n            {\n                Console.Write(what[i, j] + \" \");\n            }\n            Console.WriteLine();\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","asp.net","signalr"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13279041,"title":"How do i update SignalR in my project on visual studio?","body":"<p>I know this may sound like a newb quesiton, but how can i go about updating my signalR in visual studio.  I know there are some dependencies that must be updated as well so I wanted to know step by step how to upgrade my SignalR.  I am using nuget for my packages.  I am also using SignalR.Ninject, so just wanted to make sure this would be up to date as well.</p>\n\n<p>When I go to my references folder and click on the SignalR dependencies it is version 0.5.1.10625 with nothing to update on the nuget \"updates\" tab</p>\n"},{"tags":["c#","json","serialization"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13278459,"title":"Json Serialization in C#","body":"<p>I'm trying to serialize a local object to json but msdn documentation always seems to confuse me. I believe I am suppose to use the DataContractJsonSerializer but not completely sure, as I have seen mixed responses. I've also had someone recommend Newtonsoft.</p>\n\n<p>Does anyone have any experience with this that can point me in the right direction?</p>\n"},{"tags":["c#",".net","wpf","xaml","mvvm"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13278522,"title":"How to add a context menu for only one level in a TreeView","body":"<p>I've got a TreeView, containing a number of levels of <code>TreeViewItems</code>.</p>\n\n<p>I would like to add a context menu to only one level of items in the TreeView. However, my code produces a result whereby every single item in the TreeView has a context menu.</p>\n\n<p>This is my code:    </p>\n\n<pre><code>//.... foreach item in this level.... \n\n{\nContextMenu cmDatabase = new ContextMenu();\nMenuItem menuItem = new MenuItem();\nmenuItem.Header = \"Close Connection\";\nImage imgMenuIcon = new Image();\nimgMenuIcon.Source = new BitmapImage(new Uri(\"icon.png\"));\nmenuItem.Icon = imgMenuIcon;\ncmDatabase.Items.Add(menuItem);\ntreeViewItem.ContextMenu = cmDatabase;\n}\n</code></pre>\n\n<p>I've also tried manually setting all the other TreeViewItems' contextMenu property to null.  No luck though.  Any ideas?</p>\n"},{"tags":["c#","wpf","multithreading","user-interface","wpf-controls"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":49,"score":4,"question_id":13273289,"title":"WPF Control On Separate UI Thread?","body":"<p>I am making a media player, now.. I have added a realtime search function to search for songs etc. (Some thing like WMP realtime search) i.e while you enter the keywords the searching happens.</p>\n\n<p>During the searching process, accessing the database and loading an IEnumerable is done on another thread via a BackGroundProcess. The UI is updated by invoking a dispatcher of a UIElement.</p>\n\n<p>This process is rather fast, but however while you enter the search keywords in the textbox, there seems to be a small lag, this is beacause the Listbox.ItemSource updating takes some time. \ni.e say you want to search for \"Adele\", when you type in \"a\", the search function loads the results for \"A\", but as we are typing the whole word \"Adele\" , it some time to display the \"d\" \"e\" \"l\" \"e\" and there is a slight lag in between these letters.</p>\n\n<p>During this search process, when I stop updating the UI the search process seems very smooth, this only means to me that the Listbox is locking up the thread, so the rest of the player's UI is stuck there while the Listbox is done with its processing.</p>\n\n<p>So I believe if I can put the Listbox Control to another UI thread, I can maintain the smooth flow of the player irrespective of the time taken to load the Listbox.\nFYI: Data Virutualization is there &amp; ListBox has UI Virtualization is working</p>\n\n<p>How can i put the ListBox control onto another UI Thread?\nWPF, C#</p>\n\n<p>Thanks in advance  :)</p>\n"},{"tags":["c#","asp.net-mvc","upload","google-drive-sdk","google-drive"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13276819,"title":"ResumableUpload with google drive api v2 .net","body":"<p>I'm trying to upload a file to google drive and monitor the upload progress. I'm using .net with api v2.</p>\n\n<p>I was using the DriveService.Files.Insert method that gives me a FilesResource.InsertMediaUpload, and then I'm using the ProgressChanged event to list to the progress. The problem is that this event is called only 3 times: with \"starting\", \"uploading\", \"completed\" states. I would like to have many call in the \"uploading\" state.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>    private UploadToGoogle(...)\n    {\n        //Consider I have an populated File and MemoryStream:\n        MemoryStream contentStream = /*Populated memoryStream*/;\n        File body = /*Populated file*/;\n\n        FilesResource.InsertMediaUpload uploadRequest = null;\n\n        try\n        {\n            contentStream.Position = 0;\n\n            uploadRequest = driveService.Files.Insert(body, contentStream, body.MimeType);\n\n            uploadRequest.ProgressChanged += new Action&lt;Google.Apis.Upload.IUploadProgress&gt;(UploadProgessEvent);\n\n            Action asyncAction = () =&gt;\n            {\n                uploadRequest.Upload();\n                Console.WriteLine(\"Completed!\");\n            };\n\n            var thread = new System.Threading.Thread(new System.Threading.ThreadStart(asyncAction));\n            thread.Start();\n\n        }catch(Exception) {}\n    }\n</code></pre>\n\n<p>There's some content on internet about the ResumableUpload class in older apis, but don't know how to use that in v2. I've found the ResumableUpload class in Google.Apis.Upload namespace, but it's abstract and I have no idea how to use that.</p>\n\n<p>I didn't find anything usefull about progress monitoring in documentation: <a href=\"https://developers.google.com/drive/manage-uploads\" rel=\"nofollow\">https://developers.google.com/drive/manage-uploads</a></p>\n\n<p>And I really don't want to use resumable upload through WebRequest, is there a way to implement that in .net sdk...</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13278962,"title":"Drawing lines with an arrow in the middle","body":"<p>First of all sorry for my English...\nI would like to draw lines with arrows in the middle in c#. How can i do it?</p>\n\n<p>I have done this:</p>\n\n<pre><code>Graphics g = e.Graphics;\ng.SmoothingMode = SmoothingMode.AntiAlias;\n\nPen p = new Pen(Color.Black, 2);\np.StartCap = LineCap.Round;\np.EndCap = LineCap.ArrowAnchor;\ng.DrawLine(p, StartX, StartY, EndX, EndY);\np.Dispose();\n</code></pre>\n\n<p>But it's not enough... I would like to draw the arrow to the line's middle...</p>\n"},{"tags":["c#","multithreading","locking"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13273277,"title":"Prevent Reading and Writing to a File at the Same Time","body":"<p>I have a process that needs to read and write to a file. The application has a specific order to its reads and writes and I want to preserve this order. What I would like to do is implement something that lets the first operation start and makes the second operation wait until the first is done with a first come first served like of queue to access the file. From what I have read file locking seems like it might be what I am looking for but I have not been able to find a very good example. Can anyone provide one?</p>\n\n<p>Currently I am using a TextReader/Writer with .Synchronized but this is not doing what I hoped it would.</p>\n\n<p>Sorry if this is a very basic question, threading gives me a headache :S</p>\n"},{"tags":["c#",".net","itextsharp","pdfsharp"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2466,"score":0,"question_id":6363135,"title":"adding new pages to existing pdf using iTextSharp","body":"<p>I have a pdf file with 1 page.Now I want to add two more pages to it with some data or image.\nI tried this but it doesnot adding new pages :</p>\n\n<pre><code>private void addPage()\n   {\n     Document document = new Document();\n     writer = PdfWriter\n        .GetInstance(document, new FileStream(outputFileName, FileMode.Create));\n\n        document.Open();\n\n        PdfContentByte cb = writer.DirectContent;\n\n\n     for (int pageNumber = 1;pageNumber &lt; reader.NumberOfPages + 2;pageNumber++)\n        {\n            document.SetPageSize(reader.GetPageSizeWithRotation(1));\n            document.NewPage();\n\n            if (pageNumber == 1)\n            {\n                Chunk fileRef = new Chunk(\" \");\n                fileRef.SetLocalDestination(newPdf);\n                document.Add(fileRef);\n            }\n\n            PdfImportedPage page = writer.GetImportedPage(reader, pageNumber);\n            int rotation = reader.GetPageRotation(pageNumber);\n            if (rotation == 90 || rotation == 270)\n            {\n                cb.AddTemplate(\n                    page, 0, -1f, 1f, 0, 0,\n                    reader.GetPageSizeWithRotation(pageNumber).Height\n                );\n            }\n            else\n            {\n                cb.AddTemplate(page, 1f, 0, 0, 1f, 0, 0);\n            }\n        }\n        document.NewPage();\n\n        Paragraph paragraph = new Paragraph();\n        iTextSharp.text.Font titleFont =\n            new iTextSharp.text.Font(\n                iTextSharp.text.Font.FontFamily.HELVETICA\n                , 15\n                , iTextSharp.text.Font.BOLD\n                , BaseColor.BLACK\n            );\n        Chunk titleChunk = new Chunk(\"Comments\", titleFont);\n        paragraph.Add(titleChunk);\n        document.Add(paragraph);\n\n        paragraph = new Paragraph();\n        iTextSharp.text.Font textFont =\n            new iTextSharp.text.Font(\n                iTextSharp.text.Font.FontFamily.HELVETICA\n                , 12\n                , iTextSharp.text.Font.NORMAL\n                , BaseColor.BLACK\n            );\n        Chunk textChunk = new Chunk(\"\", textFont);\n        paragraph.Add(textChunk);\n\n        document.Add(paragraph);\n        }\n\n        document.Close();\n\n  }\n</code></pre>\n"},{"tags":["c#","forms","class","containers"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13278969,"title":"Windows / Web Form to other classes, forms, and etc","body":"<p>So this particular topic has been beaten to death; but apparently my iteration is either not the method of choice or isn't practical for implementation.</p>\n\n<p>The goal is to create a Windows Form and a Web Form.  Those two forms; set a property in a separate class.  Then other classes reference the container; that way as the interface is changed the functionality will change without a lot of recoding.</p>\n\n<p>Windows Form ---> Container &lt;--- Web Form\n                  Container --> Referenced by these: Class 1, Class 2, Class 3</p>\n\n<p>I approached it like this:\nForm:</p>\n\n<pre><code>private Some.Reference.ToClass.Container _container;\npublic void Method(Some.Reference.ToClass.Container Container)\n{\n          _container = Container;\n}\n\nprivate void button_click(object sender, EventArgs e)\n{\n          _container.Name = textbox.Text (or some other component)\n}\n</code></pre>\n\n<p>Class: \"Container\"</p>\n\n<pre><code>public Name { get; set; }\n</code></pre>\n\n<p>Class or Form to Reference:</p>\n\n<pre><code>Class WhateverName\n{\n       private string REFERENCE;\n\n       private Some.Reference.ToClass.Container _container;\n       public void Method(Some.Reference.ToClass.Container Container)\n       {\n                _container = Container;\n       }\n\n       public void NewMethod()\n       {\n              REFERENCE = _container.Name;\n       }\n}\n</code></pre>\n\n<p>It continually doesn't set; it states it's a null object.  What am I missing?  Any help would be appreciated. Or even a nice tutorial for me to compare to learn; or find why it doesn't work would be fine as well.</p>\n"},{"tags":["c#","asp.net","signalr"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13242565,"title":"Disconnect not firing sometimes in signalR","body":"<p>I currently keep my users in a table called OnlineUsers.  When a person connects or disconnects it adds the userid and his connectionid to the table, but for some reason (i believe when multiple browser windows are open) the Disconnect function does not fire sometimes, leaving users in the table and making them appear \"online\" when they really aren't.  Has anyone ran into this problem before and what would be a good way to fix this issue?</p>\n\n<p>UPDATE** (sorry about not putting code, I should have done it in the first place)</p>\n\n<p>Here are my db functions to add and remove from the table:</p>\n\n<pre><code>    public bool ConnectUser(Guid UserId, String ConnectionId)\n            {\n                if (!Ent.OnlineUsers.Any(x =&gt; x.UserId == UserId &amp;&amp; x.ConnectionId == ConnectionId))\n                {\n                    Ent.OnlineUsers.AddObject(new OnlineUser { UserId = UserId, ConnectionId = ConnectionId });\n                    Ent.SaveChanges();\n                    return true;\n                }\n                else\n                    return false;\n            }\n            public void DisconnectUser(Guid UserId, String ConnectionId)\n            {\n                if (Ent.OnlineUsers.Any(x =&gt; x.UserId == UserId &amp;&amp; x.ConnectionId == ConnectionId))\n                {\n                    Ent.OnlineUsers.DeleteObject(ucEnt.OnlineUsers.First(x =&gt; x.UserId == UserId &amp;&amp; x.ConnectionId == ConnectionId));\n                    Ent.SaveChanges();\n                }\n            }\n</code></pre>\n\n<p>Here is my hub class connect and disconnect task:</p>\n\n<pre><code> public Task Disconnect()\n        {\n\n            disconnectUser();                \n            return null;\n        }\n        public Task Reconnect(IEnumerable&lt;string&gt; connections)\n        {\n            connectUser();                \n            return null;\n        }\n        public Task Connect()\n        {\n            connectUser();               \n            return null;\n        }\nprivate void connectUser()\n        {\n            if (onlineUserRepository.ConnectUser(MainProfile.UserId, Context.ConnectionId))\n            {\n                Groups.Add(Context.ConnectionId, Convert.ToString(MainProfile.ChatId));\n            }\n        }\n        private void disconnectUser()\n        {\n            onlineUserRepository.DisconnectUser(MainProfile.UserId, Context.ConnectionId);\n            Groups.Remove(Context.ConnectionId, Convert.ToString(MainProfile.ChatId));\n        }\n</code></pre>\n"},{"tags":["c#","winforms",".net-4.5"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13278888,"title":"c# winforms - is InitializeComponent() function calling while refresh?","body":"<p>I want to ask about function <code>InitializeComponent()</code>. Is called after <code>Invalidate()</code> - invalidating component?</p>\n\n<p>Version: .net 4.5, VS 2012</p>\n"},{"tags":["c#","image","word","openxml"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13278944,"title":"Unable to Insert Dynamic Image into Word Document","body":"<p>I'm working with some code that inserts an image into a Word document. The existing code sets a property like this:</p>\n\n<pre><code>this.Image = contentItem.Picture.Image;\n</code></pre>\n\n<p>Where <code>contentItem.Picture.Image</code> is of type <code>System.Drawing.Image</code>. The existing code takes this property and inserts the image into the document. This code is tested and working fine.</p>\n\n<p>To accomplish my current task, I tried the following:</p>\n\n<pre><code>this.Image = new Bitmap(1, 1);\n</code></pre>\n\n<p>This runs without error, but when I open the resulting document in Word, it shows a box with the text <em>This image cannot currently be displayed.</em></p>\n\n<p>Can anyone see why this won't work, or where I might look to find out why Word doesn't like it?</p>\n"},{"tags":["c#","async-await"],"answer_count":5,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":1653,"score":9,"question_id":8145479,"title":"Can constructors be async","body":"<p>I have a silverlight project where I'm trying to populate some data in a constructor</p>\n\n<pre><code>public class ViewModel\n{\n    public ObservableCollection&lt;TData&gt; Data { get; set; }\n    async public ViewModel()\n    {\n        Data = await GetDataTask();\n    }\n\n    public Task&lt;ObservableCollection&lt;TData&gt;&gt; GetDataTask()\n    {\n        Task&lt;ObservableCollection&lt;TData&gt;&gt; task;\n        //Create a task which represents getting the data\n        return task;\n    }\n}\n</code></pre>\n\n<p>Unfortunately, I'm getting an error: \"The modifier 'async' is not valid for this item\"\nOf course, if I wrap in a standard method and call that from the constructor:</p>\n\n<pre><code>public async void Foo()\n{\n    Data = await GetDataTask();\n}\n</code></pre>\n\n<p>it works fine.  Likewise, if I use the old inside-out way</p>\n\n<pre><code>GetData().ContinueWith(t =&gt; Data = t.Result);\n</code></pre>\n\n<p>That works too.  I was just wondering why we can't call await from within a constructor directly.  There are probably lots of (even obvious) edge cases and reasons against it, I just can't think of any.  I've also search around for an explanation, but can't seem to find any.</p>\n"},{"tags":["c#"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13277719,"title":"How to terminate a console mode app from a BackGroundWorker","body":"<p>I am creating one BackgroundWorker and inside its DoWork function I have the following code:  </p>\n\n<pre><code>        foreach (string newFilepath in newFilesPath)\n        {\n                        if (!File.Exists(encryptedFilePath))\n                        {\n                            encryptedFiles.Add(encryptedFilePath);\n                            Helper.SendErrorMail(null, \"Could not find encrypted file.\", encryptedFilePath);\n                            Application.Exit();\n                        }\n                        else\n                        {\n                            Helper.Count_DataFeeds++;\n                            File.Delete(newFilepath);\n                        }\n        }\n</code></pre>\n\n<p>As per this code I should see only one mail because the Application exists, however I am seeing 8 mails(for each file it is iterating).  Why application is not quitting ? I want to kill the application at once.</p>\n\n<p>It is a console application.</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":76,"score":2,"question_id":11983111,"title":"Detect when new display is connected","body":"<p>I'm writing an application that requires two displays: one for the control panel, the other for the output. What I have is this: if there's only one display, the application shows both forms on it but if there are two, the output form goes to the other.\nThe problem is that this only happens when the application is started. In other words, if the application is already running before the second display is connected, nothing happens unless the user sends the output to the new display manually (assuming they know how to do it).\nWhat I want is that when a new display is connected, the output form is automatically sent to it even while the application is running. I think it has to do with polling a port in a thread but I don't know how to do it. Can anyone help with how to do it? If there is a better solution, I'll gladly welcome it.</p>\n\n<p>(I would have provided some part of the code but I'm typing this from a phone)</p>\n"},{"tags":["c#",".net","multithreading","system.reactive"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":13270559,"title":"ReplaySubject.First() blocks unexpectedly","body":"<p>I am encountering an absolutely bizarre behaviour in a Silverlight application on which I am working. Please see the following code:</p>\n\n<pre><code>var replaySubject = new ReplaySubject&lt;string&gt;(1);\n    replaySubject.OnNext(\"This can never block... surely?\");\n\nvar s = replaySubject.First();\nDebug.WriteLine(s);\n</code></pre>\n\n<p>Basically, my app comes through this piece of code repeated and it always prints out the message... except for in one particular scenario in which the thread blocks on the <code>First()</code> line.</p>\n\n<p>It's always on the UI thread. If I set a break point on the line with <code>First()</code>, and drill into the <code>replaySubject</code> with the debugger, I can see the string in its queue.</p>\n\n<p>Can anyone think of any scenario that would cause the <code>First()</code> call to block here?</p>\n\n<p>BTW: It's RX version 1.1.11111</p>\n"},{"tags":["c#","asp.net-mvc-3","c#-4.0","castle-windsor"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13153370,"title":"Does ASP.NET MVC 3 cache Filters?","body":"<p>I have an UnitOfWork attribute, something like this:</p>\n\n<pre><code>public class UnitOfWorkAttribute : ActionFilterAttribute\n{\n    public IDataContext DataContext { get; set; }\n\n    public override void OnActionExecuted(ActionExecutedContext filterContext)\n    {            \n        if (filterContext.Controller.ViewData.ModelState.IsValid)\n        {\n            DataContext.SubmitChanges();\n        }\n\n        base.OnActionExecuted(filterContext);\n    }\n}\n</code></pre>\n\n<p>As you can see, it has <code>DataContext</code> property, which is injected by Castle.Windsor. <code>DataContext</code> has lifestyle of PerWebRequest - meaning single instance reused for each request.</p>\n\n<p>Thing is, that from time to time I get <code>DataContext is Disposed</code> exception in this attribute and I remember that ASP.NET MVC 3 tries to cache action filters somehow, so may that causes the problem?  </p>\n\n<p>If it is so, how to solve the issue - by not using any properties and trying to use ServiceLocator inside method? </p>\n\n<p>Is it possible to tell ASP.NET MVC to not cache filter if it does cache it?</p>\n"},{"tags":["c#","entity-framework","nhibernate","orm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13277324,"title":"NHibernate, join between tables and return a specific type","body":"<p>I have 2 tables, I'd like place some fields in a result class, but I'm stuck. The code I want look like this with Entity Framework :</p>\n\n<pre><code>var res =   \n(from p in context.EstimationItem\n    join q in ...\n    select new EstimationWithDetail\n    {\n        Estimation = q.Estimation,\n        Id = q.Id,\n        FullName = q.Customer.FirstName + q.Customer.LastName\n\n    }).ToList();\n</code></pre>\n\n<p>In Nibernate, at this time, I have this, but I'm stuck ...</p>\n\n<pre><code>var res =\n    Session.QueryOver&lt;EstimationItem&gt;()\n    .JoinQueryOver(x =&gt; x.Estimation)\n    .Select(\n        x =&gt; x.Estimation.Reference,\n        x =&gt; x.Estimation.CreationDate,\n        x =&gt; x.Price,\n        x =&gt; x.Estimation.Customer.FirstName,\n        x =&gt; x.Estimation.Customer.LastName\n        )\n    .List();\n\npublic class Estimation\n{\n    public virtual string Reference { get; set; }\n    public virtual Customer Customer { get; set; }\n    public virtual DateTime CreationDate { get; set; }\n    public virtual decimal Total { get; set; }\n    public virtual IList&lt;EstimationItem&gt; EstimationItems { get; set; }\n}\n\npublic class EstimationItem\n{\n    public virtual decimal Price { get; set; }\n    public virtual int Quantity { get; set; }\n    public virtual Estimation Estimation { get; set; }\n    public virtual Product Product { get; set; }\n}\n\npublic class EstimationWithDetail\n{\n    public string Reference { get; set; }       //Estimation.Reference\n    public string FullName { get; set; }        //concat FirstName and LastName from Customer\n    public decimal Price { get; set; }          //Estimation.Total\n    public int Id { get; set; }                 //Estimation.Id\n    public DateTime CreationDate { get; set; }  //Estimation.CreationDate\n}\n</code></pre>\n\n<p><strong>Update 1</strong></p>\n\n<p>I tried the code but I get this error : \n<em>InvalidOperarionException, variable 'x' of type 'EstimationItem' referenced from scope '', but it is not defined</em></p>\n\n<pre><code>var res =\n    Session.QueryOver&lt;EstimationItem&gt;()\n    .JoinQueryOver(x =&gt; x.Estimation)\n    .Select(x =&gt; new EstimationWithDetail\n    {\n        Code = x.Estimation.Reference,\n        CreationDate = x.Estimation.CreationDate,\n        Price = x.Estimation.Total,\n        FullName = x.Estimation.Customer.FirstName + x.Estimation.Customer.LastName\n    })\n    .List&lt;EstimationWithDetail&gt;();\n</code></pre>\n\n<p><strong>Update 2 :</strong>\nI tried this too</p>\n\n<pre><code>Estimation a = null;\nCustomer b = null;\nvar res = Session.QueryOver&lt;EstimationItem&gt;()\n    .JoinAlias(c =&gt; c.Estimation, () =&gt; a)\n    .JoinAlias(c =&gt; c.Estimation.Customer, () =&gt; b)\n    .Select(x =&gt; new EstimationWithDetail\n    {\n        Code = a.Reference,\n        Id = a.Id,\n        FullName = b.LastName\n    })\n    .List&lt;EstimationWithDetail&gt;();\n</code></pre>\n"},{"tags":["c#","asp.net","regex"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":2103,"score":0,"question_id":5254197,"title":"format ssn using regex","body":"<p>Hi I need regex in c sharp to display SSN in the format of xxx-xx-6789. i.e 123456789 should be displayed as xxx-xx-6789 in a textfield. The code I am using write now is </p>\n\n<pre><code>string SSN = \"123456789\";\nRegex ssnRegex = new Regex(\"(?:[0-9]{3})(?:[0-9]{2})(?:[0-9]{4})\");\nstring formattedSSN = ssnRegex.Replace(SSN, \"XXX-XX-${last}\");\n</code></pre>\n\n<p>What is correct Reg Expression to mask ssn xxx-xx-6789 ?</p>\n"},{"tags":["c#","outlook","add-in","compose"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13276546,"title":"outlook vsto perform custom send message","body":"<p>I have an Outlook add-in that adds a custom Send button to the NewMailMessage tab in the Compose inspector window. When clicking on this custom button I want to perform some modifications to the email being sent before actually sending it out. How do I get a hold of the email from the button click event? In older versions than Outlook 2010, I know you can programmatically get the \"Send\" <code>CommandBar</code> button and call <code>Execute</code> on it to mimic sending the message. However in 2010 and later versions this method has been deprecated. MSDN suggests to implement the IRibbonExtensibility for Ribbon customizations but do I need to do that for my purpose?</p>\n"},{"tags":["c#","types","language-features","c#-5.0","non-nullable"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":5,"view_count":43,"score":-3,"question_id":13277733,"title":"what are the fundamental problems with having non-nullable reference types in C#?","body":"<p>At this moment there is no such thing as non-nullable types in C#. It is quite obvious that as any other feature it takes time and money to get it developed. No questions here. However I can see a lot of benefits in having it. One of the most obvious one is eliminating the need for null checks and leaving little-to-no chance for null reference exceptions. So assuming I am right, is there a fundamental problem that makes this feature too expensive to add to C#? If so, what is it?</p>\n"},{"tags":["c#",".net","visual-studio-2010","properties","designer"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":1791,"score":3,"question_id":7437004,"title":"How to make a User control property of type Collection<MyClass> editable in Form Designer?","body":"<p>Today at work, I stumbled upon a problem that was driving me nuts.</p>\n\n<p>Basically my goal is this:</p>\n\n<p>I have a <code>UserControl1</code>, with a field of the type <code>Collection&lt;Class1&gt;</code> and a corresponding property <code>Collection&lt;Class1&gt; Prop</code>. Like this:</p>\n\n<pre><code>public class UserControl1 : UserControl\n{\n    private Collection&lt;Class1> field = null;\n    // later changed to:\n    //private Collection&lt;Class1> field = new Collection&lt;Class1>();\n    [Category(\"Data\")]\n    [DefaultValue(null)]\n    [Description(\"asdf\")]\n    public Collection&lt;Class1> prop\n    {\n        get { return field; }\n        set { field = value; }\n    }\n}</code></pre>\n\n<pre><code>// later added:\n//[Serializable]\npublic class Class1\n{\n    private bool booltest; public bool Booltest { get...set...}\n    private int inttest; public int Inttest { get...set...}\n}</code></pre>\n\n<p><b>If you already know what I screwed up: no need to read the rest.</b> I am going to describe what exactly I did.</p>\n\n<p>Now I put the <code>UserControl</code> onto a random Form and change the <code>Prop</code> property. A generic \"Collection Editor\" appears, like the one used for the columns and groups in a listview control. I can enter data as expected. However, when I click OK, the data is gone.</p>\n\n<p>It took me over hour to figure out that I actually have to instantiate my field: <code>private Collection&lt;MyClass&gt; field = new Collection&lt;MyClass&gt;();</code>. Very good, only that the designer entered superspazzing mode. Cascading nightmare error message that can be reduced to: \"You must put <code>[Serializable]</code> before your <code>Class1</code>.\" After doing that I could actually put my <code>UserControl1</code> on the Form again.</p>\n\n<p>But that only works once. When opening the designer of the Form where I use the <code>UserControl1</code> after editing something, it gives me an error:</p>\n\n<p><code>Object of type 'userctltest.Class1[]' cannot be converted to type 'userctltest.Class1[]'.</code></p>\n\n<p>Well. The Error List says:</p>\n\n<p><code>Warning: ResX file Object of type 'userctltest.Class1[]' cannot be converted to type 'userctltest.Class1[]'. Line 134, position 5. cannot be parsed.</code></p>\n\n<p>The designer tries to fetch the Property's data from the resx file. Removing the resx file \"solves\" that exactly once.</p>\n\n<p>The Form can now be displayed again, with my <code>UserControl1</code>. The Collection property <em>is</em> editable, and it is being saved. It actually works. Once. Whenever I change something and then try to open the Form's designer again, the above error occurs again. I can delete the resx file, but that will of course also delete my data.</p>\n\n<p>Relevant resources that helped me so far (among a ton of not so helpful search results):</p>\n\n<p><a href=\"http://www.codeproject.com/Answers/190675/Usercontrol-with-custom-class-property#answer1\" rel=\"nofollow\">http://www.codeproject.com/Answers/190675/Usercontrol-with-custom-class-property#answer1</a><br>\n<a href=\"http://www.codeproject.com/KB/cs/propertyeditor.aspx\" rel=\"nofollow\">http://www.codeproject.com/KB/cs/propertyeditor.aspx</a><br>\n<a href=\"http://www.csharpfriends.com/Articles/getArticle.aspx?articleID=94\" rel=\"nofollow\">http://www.csharpfriends.com/Articles/getArticle.aspx?articleID=94</a><br>\n<a href=\"http://msdn.microsoft.com/en-us/library/system.runtime.serialization.iserializable.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/system.runtime.serialization.iserializable.aspx</a><br></p>\n\n<p>(I also tried implementing ISerializable and overriding GetObjectData with</p>\n\n<p><code>{ info.AddValue(\"testbool\", testbool); info.AddValue(\"testint\", testint); }</code></p>\n\n<p>didn't help either (I also tried the property names instead of the field names))</p>\n\n<p>Sorry for writing this like a bad horror novel btw.</p>\n"},{"tags":["c#","sql-server-2008"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13278669,"title":"Creating Images from SQL Server BLOBs is painfully slow","body":"<p>Has anyone had any issues when converting a BLOB (jpg) from SQL Server 2008 to a file on your file system?  It's taking upward of 5-8 seconds for the blob to be retrieved then file created</p>\n\n<p>ultimately I'm gonna store the filepaths and do quick lookups like that but for the initial hit per jpeg, it takes a long time to create the file and I have to assume there's a way to make it faster or I'm just doing it wrong or in an inefficient way in C#.  I can paste my code but wondering if there's a quick answer for this as it may be a common issue and wanted to know what to check possibly.</p>\n\n<p>If this were a high traffic website it would crash my server.  I assume BLOBs are not the way to go and maybe I should just create a routine to go through that entire SQL Table and create the files on the file system and dump all of them and never go back to SQL Server for each initial creation before I index the filepaths upon creation.</p>\n"},{"tags":["c#","wpf","listview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13278426,"title":"WPF -- property is null when next page is shown","body":"<p>I'm having an issue where on my listview, when I select an item, the row highlight and the value for the property does get set. But when I click on the button to show the second page, the listview isnt highlighted/selected from the previous. The property is null. The two listview on each page reference the same properties for itemsource and selecteditem. Can anyone help me on why second page doesnt trigger property?</p>\n\n<p>MainWindow.xaml</p>\n\n<pre><code>    &lt;UserControl.DataContext&gt;\n        &lt;vm:MainViewModel /&gt;\n    &lt;/UserControl.DataContext&gt;\n\n    &lt;Grid&gt;\n        &lt;Grid.ColumnDefinitions&gt;\n            &lt;ColumnDefinition Width=\"auto\"&gt;&lt;/ColumnDefinition&gt;\n            &lt;ColumnDefinition Width=\"5\"&gt;&lt;/ColumnDefinition&gt;\n            &lt;ColumnDefinition Width=\"auto\"&gt;&lt;/ColumnDefinition&gt;\n            &lt;ColumnDefinition Width=\"5\"&gt;&lt;/ColumnDefinition&gt;\n            &lt;ColumnDefinition Width=\"auto\"&gt;&lt;/ColumnDefinition&gt;\n        &lt;/Grid.ColumnDefinitions&gt;\n        &lt;Button Name=\"btnPrevious\" Content=\"&amp;lt;\" Grid.Column=\"0\" Height=\"300\" Click=\"btnPrevious_Click\"&gt;&lt;/Button&gt;\n        &lt;Grid Width=\"310\" Height=\"300\" Grid.Column=\"2\"&gt;\n            &lt;Frame x:Name=\"UserControlContainer\" NavigationUIVisibility=\"Hidden\" Width=\"310\" /&gt;\n        &lt;/Grid&gt;\n        &lt;Button Name=\"btnNext\" Content=\"&amp;gt;\" Grid.Column=\"4\" Height=\"300\" Click=\"btnNext_Click\"&gt;&lt;/Button&gt;\n    &lt;/Grid&gt;\n</code></pre>\n\n<p>MainWindow.xaml.cs</p>\n\n<pre><code>public partial class MainWindow : UserControl\n    {\n        private FirstPage fPage;\n        private SecondPage sPage;\n\n        private static int oldIndex = 1;\n\n        public FirstPage FPage\n        {\n            get\n            {\n                if (fPage == null)\n                    fPage = new FirstPage();\n\n                return fPage;\n            }\n            set\n            {\n                fPage = value;\n            }\n        }\n\n        public SecondPage SPage\n        {\n            get\n            {\n                if (sPage == null)\n                    sPage = new SecondPage();\n\n                return sPage;\n            }\n            set\n            {\n                sPage = value;\n            }\n        }\n\n        public MainWindow()\n        {\n            InitializeComponent();\n\n            UserControlContainer.Source = new Uri(\"Views\\\\FirstPage.xaml\", UriKind.Relative);\n        }\n\n        private void btnPrevious_Click(object sender, RoutedEventArgs e)\n        {\n            var content = UserControlContainer.Content as UserControl;\n\n            var targetUserControl = this.FPage as UserControl;\n            targetUserControl.DataContext = this.DataContext;\n\n            this.UserControlContainer.NavigateToControl(targetUserControl, oldIndex, 2);\n\n            oldIndex = 2;\n        }\n\n        private void btnNext_Click(object sender, RoutedEventArgs e)\n        {\n            var content = UserControlContainer.Content as UserControl;\n\n            var targetUserControl = this.SPage as UserControl;\n            targetUserControl.DataContext = this.DataContext;\n\n            this.UserControlContainer.NavigateToControl(targetUserControl, oldIndex, 1);\n\n            oldIndex = 1;\n        }\n    }\n</code></pre>\n\n<p>MainViewModel.cs</p>\n\n<pre><code>public class MainViewModel : INotifyPropertyChanged\n{\n    Dictionary&lt;int, string&gt; itemList;\n    KeyValuePair&lt;int, string&gt;? selectedItemList = null;\n\n    public event PropertyChangedEventHandler PropertyChanged;\n\n    private void NotifyPropertyChanged(String PropertyName)\n    {\n        if (PropertyChanged != null)\n        {\n            PropertyChanged(this, new PropertyChangedEventArgs(PropertyName));\n        }\n    }\n\n    public Dictionary&lt;int, string&gt; ItemList\n    {\n        get\n        {\n            itemList = GetItemsList();\n            return itemList;\n        }\n    }\n\n    private Dictionary&lt;int, string&gt; GetItemsList()\n    {\n        var resultList = new Dictionary&lt;int, string&gt;();\n\n        resultList.Add(1, \"Item I\");\n        resultList.Add(2, \"Item II\");\n        resultList.Add(3, \"Item III\");\n\n        return resultList;\n    }\n\n    public KeyValuePair&lt;int, string&gt;? SelectedItemList\n    {\n        get \n        { \n            return selectedItemList; \n        }\n        set\n        {\n            selectedItemList = value;\n            NotifyPropertyChanged(\"SelectedNewPtLevel\");\n        }\n    }\n}\n</code></pre>\n\n<p>FirstPage.xaml</p>\n\n<pre><code>&lt;UserControl.DataContext&gt;\n        &lt;vm:MainViewModel /&gt;\n    &lt;/UserControl.DataContext&gt;\n\n    &lt;Grid&gt;\n        &lt;ListView Name=\"lstFirst\" HorizontalAlignment=\"Left\"  \n                    Height=\"auto\" ItemsSource=\"{Binding Path=ItemList}\" SelectedItem=\"{Binding Path=SelectedItemList}\" \n                    FontSize=\"11\" SelectionMode=\"Single\" Width=\"310\"&gt;\n            &lt;ListView.ItemContainerStyle&gt;\n                &lt;Style TargetType=\"ListViewItem\"&gt;\n                    &lt;Style.Triggers&gt;\n                        &lt;Trigger Property=\"IsSelected\" Value=\"True\"&gt;\n                            &lt;Setter Property=\"Background\" Value=\"Yellow\"&gt;&lt;/Setter&gt;\n                        &lt;/Trigger&gt;\n                    &lt;/Style.Triggers&gt;\n                &lt;/Style&gt;\n            &lt;/ListView.ItemContainerStyle&gt;\n            &lt;ListView.View&gt;\n                &lt;GridView&gt;\n                    &lt;GridView.ColumnHeaderContainerStyle&gt;\n                        &lt;Style&gt;\n                            &lt;Setter Property=\"FrameworkElement.Visibility\" Value=\"Collapsed\"/&gt;\n                        &lt;/Style&gt;\n                    &lt;/GridView.ColumnHeaderContainerStyle&gt;\n                    &lt;GridViewColumn Width=\"69\" DisplayMemberBinding=\"{Binding Key}\"&gt;&lt;/GridViewColumn&gt;\n                    &lt;GridViewColumn Width=\"109\" DisplayMemberBinding=\"{Binding Value}\"&gt;&lt;/GridViewColumn&gt;\n                &lt;/GridView&gt;\n            &lt;/ListView.View&gt;\n        &lt;/ListView&gt;\n    &lt;/Grid&gt;\n</code></pre>\n\n<p>SecondPage.xaml</p>\n\n<pre><code>&lt;UserControl.DataContext&gt;\n        &lt;vm:MainViewModel /&gt;\n    &lt;/UserControl.DataContext&gt;\n\n    &lt;Grid&gt;\n        &lt;ListView Name=\"lstSecond\" HorizontalAlignment=\"Left\"\n                    Height=\"auto\" ItemsSource=\"{Binding Path=ItemList}\" SelectedItem=\"{Binding Path=SelectedItemList}\" \n                    FontSize=\"11\" SelectionMode=\"Single\" Width=\"310\"&gt;\n            &lt;ListView.ItemContainerStyle&gt;\n                &lt;Style TargetType=\"ListViewItem\"&gt;\n                    &lt;Style.Triggers&gt;\n                        &lt;Trigger Property=\"IsSelected\" Value=\"True\"&gt;\n                            &lt;Setter Property=\"Background\" Value=\"Pink\"&gt;&lt;/Setter&gt;\n                        &lt;/Trigger&gt;\n                    &lt;/Style.Triggers&gt;\n                &lt;/Style&gt;\n            &lt;/ListView.ItemContainerStyle&gt;\n            &lt;ListView.View&gt;\n                &lt;GridView&gt;\n                    &lt;GridView.ColumnHeaderContainerStyle&gt;\n                        &lt;Style&gt;\n                            &lt;Setter Property=\"FrameworkElement.Visibility\" Value=\"Collapsed\"/&gt;\n                        &lt;/Style&gt;\n                    &lt;/GridView.ColumnHeaderContainerStyle&gt;\n                    &lt;GridViewColumn Width=\"69\" DisplayMemberBinding=\"{Binding Key}\"&gt;&lt;/GridViewColumn&gt;\n                    &lt;GridViewColumn Width=\"109\" DisplayMemberBinding=\"{Binding Value}\"&gt;&lt;/GridViewColumn&gt;\n                &lt;/GridView&gt;\n            &lt;/ListView.View&gt;\n        &lt;/ListView&gt;\n    &lt;/Grid&gt;\n</code></pre>\n"},{"tags":["c#","concurrency"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13277908,"title":"Does using ConcurrentDictionary TryGetValue within an if statement make the if contents thread-safe?","body":"<p>If I have a ConcurrentDictionary and use the TryGetValue within an if statement, does this make the if statement's contents thread safe? Or must you lock still within the if statement?</p>\n\n<p>Example:</p>\n\n<pre><code>        ConcurrentDictionary&lt;Guid, Client&gt; m_Clients;\n\n        Client client;\n        //Does this if make the contents within it thread-safe? \n        if (m_Clients.TryGetValue(clientGUID, out client))\n        {\n            //Users is a list.\n            client.Users.Add(item);\n        }\n</code></pre>\n\n<p>or do I have to do:</p>\n\n<pre><code>        ConcurrentDictionary&lt;Guid, Client&gt; m_Clients;\n\n        Client client;\n        //Does this if make the contents within it thread-safe? \n        if (m_Clients.TryGetValue(clientGUID, out client))\n        {\n            lock (client)\n            {\n                //Users is a list.\n                client.Users.Add(item);\n            }\n        }\n</code></pre>\n"},{"tags":["c#","java","uml"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13277867,"title":"Showing a recursive method with UML","body":"<p>Is there a way to show a recursive method with UML class diagram modelling?</p>\n\n<p><img src=\"http://i.stack.imgur.com/BztHs.jpg\" alt=\"class diagram\">\n<br/><br/>\nIn the above class I have a static method Calculate and I want to show that this method alone calls itself recursively and not any other methods or the class. How do I show this in UML?</p>\n"},{"tags":["c#","servicestack","ormlite-servicestack"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":12548228,"title":"Is using GetLastInsertId safe for Web Application?","body":"<p>Is this code safe in web application!</p>\n\n<pre><code>public Insert(Student s)\n{\n    con.Save&lt;Student&gt;(s);\n    s.Id=con.GetLastInsertId();\n}\n</code></pre>\n\n<p>I've investigated code of servicestack ormlite </p>\n\n<pre><code>public override long GetLastInsertId(IDbCommand dbCmd)\n{\n    dbCmd.CommandText = \"SELECT SCOPE_IDENTITY()\";\n    return dbCmd.GetLongScalar();\n}\n</code></pre>\n\n<p>So is it big trap for beginners? </p>\n\n<p>And how can we get filled Student instance like EF does? (Only Id must be filled)</p>\n"},{"tags":["c#","objective-c","ios","multidimensional-array"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":41,"score":-3,"question_id":13278272,"title":"iOs's C# Array.GetLength(int dimension) equivalent?","body":"<p>I believe the title says it all.</p>\n\n<p>How to get multidimensional array, dimension one, length (in objective c)?</p>\n\n<p>In C# it's:</p>\n\n<pre><code>Array.GetLength(int dimension)\n</code></pre>\n\n<p>I am looking for the exact equivalent of something like this:</p>\n\n<pre><code>int[10,4] mda = new int[10,4];\nint A = mda.GetLength(1);\n//A=4\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>I know that there are ways to get this without using built in functions..</p>\n"},{"tags":["c#","generics","reflection","runtime"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":53,"score":4,"question_id":13276447,"title":"Create type \"MyClass : OtherClass<MyClass> { }\" at runtime?","body":"<p>Is it possible in C# to create a type at runtime that inherits from a generic class where the template parameter for the base class is the current class being constructed? This will compile fine:</p>\n\n<pre><code>// I have this class:\npublic class OtherClass&lt;T&gt;\n    where T : OtherClass&lt;T&gt;\n{ }\n\n// I want to create this at runtime:\npublic class MyClass : OtherClass&lt;MyClass&gt;\n{ }\n</code></pre>\n\n<p>but I'm not sure how to create the <code>MyClass</code> using <code>System.Reflection.Emit.ModuleBuilder.TypeBuilder</code>:</p>\n\n<pre><code>AssemblyName asn = new AssemblyName(\"test.dll\");\nAssemblyBuilder asb = AppDomain.CurrentDomain.DefineDynamicAssembly(\n    asn, AssemblyBuilderAccess.RunAndSave, @\"D:\\test_assemblies\");\n\nModuleBuilder = modb = asb.DefineDynamicModule(\"test\", \"test.dll\");\n\nTypeBuilder tb = modb.DefineType(\n    \"test\",\n    TypeAttributes.Public | TypeAttributes.Class,\n    typeof(MyClass)); // How to specify inheritance?\n\n// populate properties, fields, methods, etc., emit...\n\ntb.CreateType();\n</code></pre>\n\n<p>Is this possible?</p>\n\n<p>Edit - Based on replies so far, I've tried this:</p>\n\n<pre><code>public class OtherClass&lt;T&gt;\n    where T : OtherClass&lt;T&gt;\n{ }\n\npublic static void CreateSimple()\n{\n    AssemblyName asn = new AssemblyName(\"test\");\n    AssemblyBuilder asb = AppDomain.CurrentDomain.DefineDynamicAssembly(\n        asn, AssemblyBuilderAccess.RunAndSave, @\"D:\\test_asms\");\n    ModuleBuilder modb = asb.DefineDynamicModule(\"test\", \"test.dll\");\n\n    try\n    {\n        TypeBuilder tb = modb.DefineType(\n            \"MyClass\",\n            TypeAttributes.Public | TypeAttributes.Class);\n\n        Type my = tb.CreateType();\n        tb.SetParent(typeof(OtherClass&lt;&gt;).MakeGenericType(my));\n\n        my = tb.CreateType();\n    }\n    catch (Exception e)\n    {\n        throw;\n    }\n}\n</code></pre>\n\n<p>but get this exception:</p>\n\n<pre><code>GenericArguments[0], 'MyClass', on 'MyProject.Factory+OtherClass`1[T]'\nviolates the constraint of type 'T'.\n</code></pre>\n"},{"tags":["c#",".net","asp.net-mvc","architecture","n-tier"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13278329,"title":"Business Layer Facade vs Mingled Business Components","body":"<p>I'm currently designing the foundation for a large application.  We are going with the traditional 3 tier system using EF in the data layer, plain jane c# classes in the business layer and MVC / WCF for the ui layer.  We have prototyped enough of the application to realize that this will work for us, however due to the complexity of the business requirements <strong>it will be common for some of the business components interact with one another.</strong></p>\n\n<p>Consider the following two business components:</p>\n\n<ul>\n<li>RetailManager - Deal with everything related to retail in the system</li>\n<li>CartManager - Deals with everything related to the shopping cart experience</li>\n</ul>\n\n<p>The two interact, for instance, during the checkout process when an item is purchased.  The inventory for the purchased item needs to be reduced.</p>\n\n<p>Here is my thought process so far:</p>\n\n<ol>\n<li><p>Let business components reference each other and ensure cyclical references never happen (CartManager references RetailManager, but never the other way).  \"Checkout\" would be a method on the CartManager class, and it would call a method on the RetailManager to adjust inventory.  While this will work, I'm not sure how well it will scale, and what the maintenance cost will be over time.  It doesn't feel 100% \"right\" to me.</p></li>\n<li><p>Create a Facade between the business components and the UI tier.  In this example, the Facade would have the checkout method and a reference to both managers.  I like this approach more than the first, however I know that not all of my business objects will need a Facade, and I don't want to create a ton of Facade classes just to have empty pass through methods.</p></li>\n</ol>\n\n<p>I'm leaning towards 2, with the caveat that I will only create facade classes where needed.  The UI tier will have access to both the Facade and the business layer components and will have to know when to use which (the only part I don't like about this solution).</p>\n\n<p>I've done a lot of research but haven't been able to come to come up with a solution that feels completely right.</p>\n\n<p>Any thoughts on using the facade pattern in this way, or other ideas to solve the problem are welcome.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","sql","linq","query"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":53,"score":3,"question_id":13276024,"title":"Complex LINQ to SQL Query with dates","body":"<p>I'm building a query with LINQ to SQL in my C# project, but I have some problems with it...</p>\n\n<p>What I want to do, is select the 4 lasts days that are like today (For example, a Friday), so if we're on Friday 28, I want to query for: Friday 21, 14, 7... The last four Fridays but NOT today.</p>\n\n<p>This is easy, I've done that but here's the complex part, I want to <strong>not</strong> query the exceptions I set, for example End of month, which are from 28th to 1st day of each month, so let's say i want to query this (october, fridays):</p>\n\n<p>Today is Friday 26, I want to query:</p>\n\n<p>19, 12, 5 and September 28th (the fourth friday from now), but as I said, 28th is end of month, so i need to return September 21th which is the last friday and it is not end of month... I have the same issues with holidays, but I think if I can handle end of months, I can do with them...</p>\n\n<p>i hope I've explained good for you to understand what I want... Here's my query, which is working but can't handle exceptions. (the field b.day is the Id for each days, 8 means end of month, and 7 holiday)</p>\n\n<pre><code>var values =\n    from b in dc.MyTable\n    where // This means end of month\n    b.day != 8\n\n    // This triggers to query last 4 days\n    &amp;&amp; b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-28)\n    || b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-21)\n    || b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-14)\n    || b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-7)\n    orderby b.id descending\n    group b.valor by b.hora_id into hg\n    orderby hg.Key descending\n\n    select new\n    {\n        Key = hg.Key,\n        Max avg = System.Convert.ToInt32(hg.Average() + ((hg.Average() * intOkMas) / 100)),\n        Min avg = System.Convert.ToInt32(hg.Average() - ((hg.Average() * intOkMenos) / 100))\n    };\n</code></pre>\n"},{"tags":["c#","visual-studio-2012","visual-studio-debugging"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":99,"score":2,"question_id":12934271,"title":"Visual Studio 2012 random debugger startup failure: Unable to start program","body":"<p>I have a managed startup project and quite often when I press F5 the Visual Studio complains with dialog \"Unable to start program '...\\test.exe'\" (no additional information). The process test.exe is actually started in the background but when I try to attach the debugger to it, VS complains that debugger is already attached. To be able to debug again I have to manually kill the test.exe process and restart the VS. I run VS as Administrator. Thanks!</p>\n\n<p>Important information:</p>\n\n<ol>\n<li>Running on Windows Server 2008 x64.</li>\n<li>Application is x64.</li>\n<li>Running VS as Administrator.</li>\n</ol>\n"},{"tags":["c#",".net","wpf","mvvm","avalonedit"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":288,"score":2,"question_id":12344367,"title":"Making AvalonEdit MVVM compatible","body":"<p>I'm trying to make Avalon MVVM compatible in my WPF application. From googling, I found out that <a href=\"http://community.sharpdevelop.net/forums/t/11587.aspx\" rel=\"nofollow\">AvalonEdit is not MVVM friendly</a> and I need to export the state of AvalonEdit by making a class derived from TextEditor then adding the necessary dependency properties. I'm afraid that I'm quite lost in Herr Grunwald's answer <a href=\"http://community.sharpdevelop.net/forums/t/11587.aspx\" rel=\"nofollow\">here</a>:</p>\n\n<blockquote>\n  <p>If you really need to export the state of the editor using MVVM, then I suggest you create a class deriving from TextEditor which adds the necessary dependency properties and synchronizes them with the actual properties in AvalonEdit.</p>\n</blockquote>\n\n<p>Does anyone have an example or have good suggestions on how to achieve this?</p>\n"},{"tags":["c#","xaml","crash","windows-8"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":100,"score":2,"question_id":13215425,"title":"How to handle a Windows 8 XAML/C# app crash","body":"<p>I've got a Windows 8 app in the store right now and it's been certified for Windows 8 and Windows RT devices. Also, in my Windows Store dashboard, no crashes are shown. For some reason, though, a commenter who reviewed my app says that it crashes on launch in Windows RT, and I have no way to test that (I don't have a Windows RT device).</p>\n\n<p>To help diagnose the problem, I've decided to create a crash page which would launch if the app crashed the last time it opened. Is there a way to set some variables right before an app crashes? That way I could, say, create a variable \"recoverymode\" that would launch a page asking for more information the next time the app is launched. Or is there some way to do this for Windows 8 apps that I'm not aware of that will automatically send me crash data?</p>\n"},{"tags":["c#","parameters"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13278558,"title":"How to send parameters to scoreboard","body":"<p>On the application I'm building for a cyclist race, where as cyclists go over the finish line, I have to enter the time (hours, mins, secs) and click the finish button. Once I click the finish button, I want this information to be displayed in lblScoreboard as:</p>\n\n<p>Competitive cyclist No. 1 has completed in 1:23:49</p>\n\n<p>Then as another cyclists time has been entered, the lblScoreboard should look like:</p>\n\n<p>Competitive cyclist No. 1 has completed in 1:23:49<br>Competitive cyclist No. 9 has completed in 1:20:30</p>\n\n<p>The code I've used in my 'Finished' button is:</p>\n\n<pre><code>lblCyclistsFinished.Text = finishLine.Scoreboard(currentCyc);\n</code></pre>\n\n<p>and the code behind the FinishLine class is:</p>\n\n<pre><code>class FinishLine\n{\n    public string Scoreboard(Cyclists cyc)\n    {\n        String msg;\n\n        msg = cyc.ToString();\n\n        return msg;\n    }\n}\n</code></pre>\n\n<p>However, with the code in FinishLine, it will display one result, but as soon as I enter a new result; it replaces the first one so there's only ever 1 result displayed.</p>\n\n<p>The information I want passed is: Type + \"No. \" + Number + \" has completed in \" + Hours + \":\" + Mins + \":\" + Secs;</p>\n"},{"tags":["c#","asp.net","validation","controls"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13278303,"title":"Styling multiple validation controls","body":"<p>I'm using the validation controls (namely <code>RequiredFieldValidator</code> and <code>RegularExpressionValidator</code>) and am having a bit of trouble getting them to style correctly.</p>\n\n<p>The problem is that because I have markup like this:</p>\n\n<pre><code>&lt;asp:RequiredFieldValidator ID=\"EmailRequiredValidator\" ControlToValidate=\"Email\" ErrorMessage=\"Email field is required\" runat=\"server\"&gt;&lt;/asp:RequiredFieldValidator&gt;\n&lt;asp:RegularExpressionValidator ID=\"EmailFormatValidator\" ControlToValidate=\"Email\" ValidationExpression=\"^[_a-z0-9-]+(\\.[_a-z0-9-]+)*@[a-z0-9-]+(\\.[a-z0-9-]+)*(\\.[a-z]{2,4})$\" runat=\"server\" ErrorMessage=\"Invalid email address\"&gt;&lt;/asp:RegularExpressionValidator&gt;\n</code></pre>\n\n<p>the <code>RegularExpressionValidator</code> gets pushed over to the side because the <code>RegularExpressionValidator</code> is in the way. Perhaps a graphical representation will help:</p>\n\n<p><img src=\"http://i.stack.imgur.com/yavUp.png\" alt=\"The problem\"></p>\n\n<p>The \"Invalid email address\" error label is meant to be right next to the input box, but the other validator pushes it to the side.</p>\n\n<p>How can I make the validators invisible until they fire an error message or make them float on top of one another?</p>\n"},{"tags":["c#","powershell"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":652,"score":0,"question_id":7917873,"title":"Calling Powershell from C# and handling exception","body":"<p>I am calling Powershell scripts from C# using Process.Start(). How do I capture exceptions that are raised by the Powershell script in the C# code?</p>\n"},{"tags":["c#"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13278170,"title":"Parse datetime string in the format \"Nov. 7, 2012, 9:02 p.m.\"","body":"<p>How can I parse a date string in the format \"Nov. 7, 2012, 9:02 p.m.\"</p>\n\n<p>I think I'm close. Have tried:</p>\n\n<pre><code>        string line = \"Nov. 7, 2012, 9:02 p.m.\";\n        string format = \"MMM. dd, yyyy, hh:mm p.m.\"; ;\n        DateTime result = DateTime.ParseExact(line, format, null);\n</code></pre>\n"},{"tags":["c#","visual-studio-2008","syntax-error","underline"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":219,"score":0,"question_id":10915455,"title":"Visual Studio 2008 underlining non-error code in red","body":"<p>I have a large C# project in Visual Studio 2008, and nearly half my project is underlined in red errors, most of them are \"Undeclared element\"; the project compiles, builds, debugs, and runs fine, no errors.</p>\n\n<p>I can also type a legitimate error, and it doesn't underline the error, for instance if I write strong.Format() instead of string.Format, it doesn't underline strong????, but it will underline the Format, in string.Format and tell me undeclared element, it makes no sense.</p>\n\n<p>Similar to question:</p>\n\n<ul>\n<li><a href=\"http://stackoverflow.com/questions/9729621/visual-studio-2010-improperly-underlining-code-comments-with-red-error-line-when\">Visual Studio 2010 Improperly underlining code/comments with red error line when there is no error</a></li>\n</ul>\n\n<p>But he never got an answer, and this is VS 2008 and C# instead of VS 2010 and C++</p>\n"},{"tags":["c#","wpf","xml"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":6,"view_count":46,"score":-6,"question_id":13277692,"title":"Is a Database or XML file better for storing information?","body":"<p>I have some information that needs be stored.  These are \"default values\" for certain inputs that are contained in the program.</p>\n\n<p>Would it be better to store this information in a Database or an XML file?  Which is faster?</p>\n\n<p>Currently there are 2 versions of the program that I am re-writing.  1 version uses an XML file and the other uses an Access database.</p>\n\n<p>What do you think is the best one?</p>\n"},{"tags":["c#","windows-7","taskbar"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":31,"score":-1,"question_id":13275763,"title":"How to change the name of your program in C# when clicking and dragging up from the taskbar?","body":"<p>Ok. So in windows 7 you know how you have the icons of open programs. Well when i click and drag up on my C# Windows Form application it says \"WindowsFormApplication3\" When in every possible file in Visual Studio i changed it to the name of my program. And even in task manager it shows my name of the program. How can i change this name that shows when clicking and dragging up from my programs icon in the taskbar?</p>\n"},{"tags":["c#","wcf","rest","stream","basichttpbinding"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13278487,"title":"WCF MemoryStream data corruption issue","body":"<p>I have created a simple REST based WCF service which runs on BasicHttpBinding. In one of my webmethod, I am  returning a Stream which points to a JSON response. </p>\n\n<p>The Method looks like : </p>\n\n<pre><code>[OperationContract]\n        [FaultContract(typeof(ApplicationFault))]\n        [WebInvoke(Method = \"POST\", UriTemplate = \"GetActiveCalls/{nurseid}\")]\n        Stream GetActiveCalls(string nurseid);\n</code></pre>\n\n<p>From the body of the GetActiveCalls, I am creating an object of MemoryStream and returning the same as response. The code looks like  </p>\n\n<pre><code>// Serialize the results as JSON\n                string jsonResult = new JavaScriptSerializer().Serialize(baseResponses);\n\n// ContentType json\nWebOperationContext.Current.OutgoingResponse.ContentType = \"application/json\";\n                WebOperationContext.Current.OutgoingResponse.Headers.Add(\"Cache-Control\", \"no-cache\");\n                var bytes = Encoding.UTF8.GetBytes(jsonResult);\n                //Parse to memorystream\n                var ms = new MemoryStream(bytes);\n                ms.Seek(0, SeekOrigin.Begin);\n                ms.SetLength(bytes.LongLength);\n                return ms;\n</code></pre>\n\n<p>When trying this from client, I get result like</p>\n\n<p>{\"LastEvents\":[{\"FormatValues\":\"Klic 2 3 4\",\"Icon\":null,\"Color\":\"Red\",\"Acknowledged\":false,\"EventID\":28566}],\"Message\":\"\",\"Status\":true}</p>\n\n<p>But sometimes after invoking the same method for multiple times, I start getting the response as : </p>\n\n<p>{\"LastEvents\":[{\"FormatValues\":\"Klic 2 3 4\",\"Icon\":null,\"Color\":\"Red\",\"Acknowledged\":false,\"EventID\":28566}],\"Message\":\"\",\"Statu{\"LastEv</p>\n\n<p>You can see after \"Statu on the JSON response, the stream gets reset and starts getting data from the beginning. </p>\n\n<p>It looks strange to me. Can someone point to if I am missing something. </p>\n\n<p>*From server side, when I put breakpoint, it seems the MemoryStream has correct response.</p>\n"},{"tags":["c#","wpf","splash-screen","timespan","eventlistener"],"answer_count":3,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":129,"score":8,"question_id":13213625,"title":"SplashScreen.Close(Timespan.FromMilliseconds(int)) : Is there an Event dispatched at Timespan Complete?","body":"<p>C# WPF Application</p>\n\n<p>I have a <a href=\"http://msdn.microsoft.com/en-us/library/system.windows.splashscreen.aspx\" rel=\"nofollow\">SplashScreen</a> being displayed at startup for a minimum amount of time by using</p>\n\n<pre><code>Thread.Sleep(int); //int = milliseconds to display splash screen\n</code></pre>\n\n<p>When that sleep time is reached, the code resumes and the SplashScreen fades out to close by using</p>\n\n<pre><code>SplashScreen.Close(Timespan.FromMilliseconds(int)); //int = milliseconds fade-out\n</code></pre>\n\n<p>I would like to pause at this point to wait until the SplashScreen has become 100% transparent and is fully closed, then continue with other tasks, I.E. Writiting to the Console or displaying a MainWindow. </p>\n\n<p>Is there an event fired when the (TimeSpan.FromMilliseconds(int)) is complete?\nAny other suggestions?</p>\n\n<pre><code>namespace StartupSplash\n{\n    public class SplashScreenStartup\n    {\n        //IMPORTANT:set image property to Resource and NOT Splash Screen\n        private SplashScreen Splash = new SplashScreen(\"Resources/SplashScreen.png\");\n\n        public void SplashScreenStartUp()\n        {\n            Splash.Show(false, true);\n            Thread.Sleep(3000); // Pause code, display splash screen 3 seconds\n            Splash.Close(TimeSpan.FromMilliseconds(3000)); // 3 second splash fade-out\n            // I want to wait until splash screen fadeOut has completed before\n            // this next console output is performed.\n            Console.WriteLine(\"Executes before Splash fadeOut completes.\");\n        }\n\n    }\n</code></pre>\n"},{"tags":["c#","facebook","facebook-c#-sdk"],"answer_count":3,"favorite_count":2,"up_vote_count":12,"down_vote_count":0,"view_count":9233,"score":12,"question_id":5171309,"title":"Facebook C# SDK and Access Token","body":"<p>I'd like to be able to authenticate myself <strong>(my profile, not just my app)</strong> on my own web application using the Facebook C# SDK. Using the Graph API, I can get an access token, but that token does not seem to work properly with the Facebook C# as it seems to be stateless.</p>\n\n<p>The error that is thrown is:</p>\n\n<pre><code>(OAuthException) An active access token must be used to query information about the current user.\n</code></pre>\n\n<p>I've poked around the Facebook C# SDK and documentation and most of the info I'm seeing is to redirect users to a login page which is not what I'm looking for.</p>\n\n<p>Does anyone have a good sample of auto-logging in myself so I can pull up my own information?</p>\n\n<p>TIA</p>\n"},{"tags":["c#","asp.net","validation","dynamic-data"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13278422,"title":"Dynamic Data on Entity Framework custom validation using partial methods","body":"<p>I'm using <a href=\"http://msdn.microsoft.com/en-us/library/cc488527.aspx\" rel=\"nofollow\">Dynamic Data</a> and am trying to write custom validation using partial-class method. I've created an ASP.NET Dynamic Data Enties Web Application and added an ADO.NET Entity Data Model to it. I'm using the Customers table from the Northwind database.</p>\n\n<p>I'm simply using an example almost the same as what's supplied on the <a href=\"http://msdn.microsoft.com/en-us/library/cc488527.aspx\" rel=\"nofollow\">MSDN page</a>.</p>\n\n<pre><code>public partial class Customer\n{\n    partial void OnContactTitleChanging(string value)\n    {\n        if (value != null &amp;&amp; value.Length &gt; 1 &amp;&amp; !Char.IsUpper(value[0]))\n            throw new ValidationException(\n            \"Title must start with uppercase letter\");\n    }\n}\n</code></pre>\n\n<p>This seems to work fine, as I can't change a ContactTitle to a value starting with a lowercase letter. </p>\n\n<p>But...</p>\n\n<p>In my database, a record already exists that doesn't start with an uppercase letter. When just listing the current records, the method is already being executed, resulting in the Exception being thrown. <em>(and because I wasn't actually editing anything, there is no DynamicValidator control on the page, and the exception isn't caught)</em></p>\n\n<p>If I use SQL to LINQ Classes in stead of Entity Framework, listing invalid records is no problem. But when I try to edit the incorrect ContactTitle and click Update, the <code>OnContactTitleChanging</code> method is being executed twice. Once with the new <code>value</code>, which is ok, but then once again with the original value, which results in the exception being thrown after all.</p>\n\n<p>Am I missing something here? Is the example on <a href=\"http://msdn.microsoft.com/en-us/library/cc488527.aspx\" rel=\"nofollow\">MSDN</a> too simple?</p>\n"},{"tags":["c#","reflection","collections"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":49,"score":3,"question_id":13277981,"title":"Create a list of types in C#","body":"<p>I'd like to create a list of types, each of which must implement a particular interface.  Like:</p>\n\n<pre><code>interface IBase { }\ninterface IDerived1 : IBase { }\ninterface IDerived2 : IBase { }\n\nclass HasATypeList\n{\n    List&lt;typeof(IBase)&gt; items;\n    HasATypeList()\n    {\n        items.Add(typeof(IDerived1));\n    }\n\n}\n</code></pre>\n\n<p>So I know I can do</p>\n\n<pre><code>List&lt;Type&gt; items;\n</code></pre>\n\n<p>But that won't limit the allowable types in the list to ones that implement IBase.  Do I have to write my own list class?  Not that it's a big deal, but if I don't have to...</p>\n"},{"tags":["c#","wpf","xaml","mvvm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13278040,"title":"Datagrid RowDetails not being updated","body":"<p>I'm having a problem getting the <code>RowDetailsTemplate</code> to update when modifying the collection (\"Items\") that a <code>DataGrid</code> is bound to.  The collection is being modified from within a view model.  When I modify the <i>contents</i> of one of the bound items, the change is updated in both the DataGridRow and RowDetailsTemplate.  E.g.</p>\n\n<pre><code>Items[i].Name = \"new name\";  // RowDetailsTemplate gets updated\n</code></pre>\n\n<p><b>But</b> if I assign one of the items to a totally new object the DataGridRow updated, but the RowDetailsTemplate doesn't get updated. E.g.</p>\n\n<pre><code>Items[i] = new Model {Name = \"new name\"};  // RowDetailsTemplate NOT updated\n</code></pre>\n\n<p>The only thing I thought at first was that I needed to add a listener to the CollectionChanged event of the bound Items and explicitly raise a property change notification. E.g</p>\n\n<pre><code>Items = new ObeservableCollection&lt;Model&gt;();\nItems.CollectionChanged += (o,e) =&gt; OnNotifyPropertyChanged(\"Items\");\n</code></pre>\n\n<p>but that didn't work.</p>\n\n<p>My XAML bindings look like this:</p>\n\n<pre><code>&lt;DataGrid DataContext=\"{StaticResource viewmodel}\" \n          ItemsSource=\"{Binding Items, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}\"&gt;\n  &lt;DataGrid.RowDetailsTemplate&gt;\n    &lt;DataTemplate&gt;\n      &lt;TextBlock Text=\"{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}\"/&gt;\n    &lt;/DataTemplate&gt;\n  &lt;/DataGrid.RowDetailsTemplate&gt;\n&lt;/DataGrid&gt;\n</code></pre>\n\n<p>Why is the <code>DataGridRow</code> notified of the changed Item but not the <code>RowDetailsTemplate</code>?!</p>\n\n<p><b>Update</b>\nDoing a delete/add instead of modifying the collection works.  E.g.</p>\n\n<pre><code>Items.Remove(Items[i]);\nItems.Add (new Model {Name = \"new name\"});  // RowDetailsTemplate updated OK\n</code></pre>\n\n<p>(Oh and the Model class of course implements <code>INotifyPropertyChanged</code>.)</p>\n\n<p>Seems like this might be an issue where I need to refresh the DataContext of the details view?  </p>\n"},{"tags":["c#","wpf","wpfdatagrid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":318,"score":0,"question_id":10257724,"title":"WPF DataGrid - how to set the column headers to have vertical text?","body":"<p>Well, actually rotated -90 degrees from horizontal is what I mean. I need to do this because the text for the header is quite long but the cell value is short, and I want to fit a lot of columns on the screen. Is it possible to do this easily or do I need to learn about resources and templates first? I don't mind a \"hack\" solution!</p>\n"},{"tags":["c#","wpf","datetime","dynamic-data-display"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12937164,"title":"Dynamic Data Display Scattered DateTime Axis","body":"<p>I am trying to chart candlestick markers for a chart of stock prices. I have a marker for every minute of a trading day - 9:30 AM to 4:00 PM. I don't want to display empty space for 4:01 PM to 9:29 AM for each trading day. Is there a way I can remove that time span from my X axis on my graph? I want all the data to look continuous without break in flow. I am using a NumericAxis for my X axis with a TickToDateTimeLabelProvider that I created. Is there a way to change the LabelProvider to fit my needs? Or does it stretch deeper than that? </p>\n\n<p>Here is my code for the LabelProvider:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Windows;\nusing System.Windows.Controls;\n\nnamespace Microsoft.Research.DynamicDataDisplay.Charts {\npublic class TickToDateTimeLabelProvider : NumericLabelProviderBase {\n    public override UIElement[] CreateLabels(ITicksInfo&lt;double&gt; ticksInfo) {\n        var res = new TextBlock[ticksInfo.Ticks.Length];\n        for (int i = 0; i &lt; ticksInfo.Ticks.Length; ++i) {\n            long l = (long)ticksInfo.Ticks[i];\n            if (l &lt; 0)\n                l = 0;\n            DateTime dt = new DateTime(l);\n            res[i] = new TextBlock();\n            res[i].Text = dt.ToString();\n        }\n        return res;\n    }\n}\n}\n</code></pre>\n"},{"tags":["c#","wpf","mvvm","dataset"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13278159,"title":"What is more efficient, a datatable or a custom object?","body":"<p>Normally, when working with data from a database with a forms application, I keep it in a dataset or datatable and pull data out as needed. Now, I am working with WPF and trying to conform more to the MVVM pattern. Converting these datatables to objects make it a little easier to use with MVVM.</p>\n\n<p>For example, if I had a table filled by a query like so -\n<strong>Select p.first_name, p.last_name, p.phone,p.email from person as p where p.first_name = 'Bob'</strong>\nInstead of keeping the datatable, I would just now convert that into a person object.</p>\n\n<p>From a performance standpoint, is there and downfall to making objects or should I stick with datasets and datatables?</p>\n"},{"tags":["c#",".net","office-automation"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":27,"score":1,"question_id":13172108,"title":"Loading an excel application with a file opened inside a windows .NET client app","body":"<p>How to load an Excel application inside an .NET Windows client application?</p>\n\n<p>The excel application should be hosted in windows form just a like any windows user control.</p>\n\n<p>The loaded excel application will open a excel file created already.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","winforms","messagebox"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13277952,"title":"Message Boxes Modal","body":"<p>I've been working at this on and off for a while but essentially I have a class that I call to display message boxes. </p>\n\n<p>I'm trying to get my message boxes to be modal, which is easily done if you specify the form to be modal to. </p>\n\n<p>So my form is declared like this</p>\n\n<pre><code>public partial class MainForm : Form\n</code></pre>\n\n<p>and it is instantiated like this</p>\n\n<pre><code>var mainForm = new MainForm();\n</code></pre>\n\n<p>So I have a class that contains methods which open message boxes like this</p>\n\n<pre><code>MainForm.ActiveForm.Invoke(new MethodInvoker(delegate\n{\n    MessageBox.Show(MainForm.ActiveForm, message, title, buttons, icon);\n}));\n</code></pre>\n\n<p>This works fine, but active form only works when the form is active.....</p>\n\n<p>Anyways is there an easy way around this?</p>\n"},{"tags":["c#","asp.net","url","routing","webforms"],"answer_count":3,"favorite_count":1,"up_vote_count":18,"down_vote_count":0,"view_count":10678,"score":18,"question_id":5967103,"title":"A potentially dangerous Request.Path value was detected from the client (*)","body":"<p>I am recieving the rather self explanatory error:</p>\n\n<p>A potentially dangerous Request.Path value was detected from the client (*).</p>\n\n<p>the issue is that my url contains a *:</p>\n\n<p><a href=\"http://localhost:3286/Search/test\">http://localhost:3286/Search/test</a>*/0/1/10/1</p>\n\n<p>This url is used to populate a search page where 'test*' is the search term and the rest of the url relates to various other filters.</p>\n\n<p>My question is if there is a simple solution to allow me to add these special characters as search terms? </p>\n\n<p>I have tried including the following in the web.config but it has no effect on if the error message is displayed. </p>\n\n<p>Should I be manually encoding / decoding the special characters?</p>\n\n<p>Is there a best practice for doing this? I would like to try and avoid using a query string but i guess it is an option.</p>\n\n<p>The application itself is a c# asp.net webforms application that uses routing to produce the nice URL above.</p>\n\n<p>Any suggestions would be a great help.</p>\n"},{"tags":["c#","arrays","linq","multidimensional"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13278194,"title":"LINQ and Array.Copy","body":"<p>I have the following:</p>\n\n<pre><code>var list = new List&lt;double[]&gt;();\nlist.Add(new double[] { 300, 12, 22 });\nlist.Add(new double[] { 310, 13, 23 });\nlist.Add(new double[] { 320, 14, 24 });\nlist.Add(new double[] { 330, 15, 25 });\n</code></pre>\n\n<p>I would like to get from this a multidimensional array containing the first 2 columns:</p>\n\n<pre><code>double[,] a = { {300,12}, {310,13}, {320,14}, {330,15}}\n</code></pre>\n\n<p>Can I do this using linq? And how?</p>\n"},{"tags":["c#","visual-studio-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13276781,"title":"Error attempting to use \"extern alias\" to reference two different DLLs with the same namespace (Visual Studio 2010)","body":"<p>I've read a couple of articles which lead me to believe that it's possible to reference two DLLs with the same namespace in the same project - see <a href=\"http://blogs.msdn.com/b/ansonh/archive/2006/09/27/774692.aspx\" rel=\"nofollow\">http://blogs.msdn.com/b/ansonh/archive/2006/09/27/774692.aspx</a>.</p>\n\n<p>However, when I attempt to do this, I run into a couple of issues that I have been unable to resolve.</p>\n\n<p>Here's what I have done:</p>\n\n<ol>\n<li>Create a project for a class library, called V1.Model which has class Model.MyClass.  Sign this assembly.</li>\n<li>Create another project for a class library, called Model, which also has class Model.MyClass.  Sign the assemply.</li>\n<li>Copy the DLLs created from the above two projects into a folder, say Versions, and rename them (V1.Model -> V1.Model.dll, Model -> V2.Model.dll).</li>\n<li>Create a console application project, called Test, which references V1.Model.dll and V2.Model.dll.</li>\n<li>Change the \"Aliases\" property of the reference to V1.Model to \"V1\".</li>\n<li>Change the \"Aliases\" property of the reference to V2.Model to \"V2\".</li>\n<li><p>Create the following code which references both assemplies:</p>\n\n<p>extern alias V1;<br>\nextern alias V2;  </p>\n\n<p>static void Main(string[] args)<br>\n{<br>\n    var v1 = new V1::Model.MyClass();<br>\n    var v2 = new V2::Model.MyClass();<br>\n}  </p></li>\n<li><p>Build and run Test</p></li>\n</ol>\n\n<p>When I do this, there are a couple of issues.  </p>\n\n<p>One, the V1.Model.dll is not copied to the bin directory.  (In fact, if I include many versions of the same namespace, it appears that only the DLL with the most recent version is copied).  Of course, I can workaround this issue by manually copying the dll to the bin directory, but I am curious why this is necessary.  Also, note that I have changed the \"Copy Local\" property to true for both references.</p>\n\n<p>Two, when I run the application, I get the following error: </p>\n\n<blockquote>\n  <p>Could not load file or assembly 'Model, Version=1.0.0.0,\n  Culture=neutral, PublicKeyToken=d89c4561a79dd027' or one of its\n  dependencies. The system cannot find the file specified.</p>\n</blockquote>\n\n<p>Any ideas what I am doing wrong?</p>\n\n<p>Thanks,\nEric</p>\n"},{"tags":["c#","regex"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13278011,"title":"Regular Expression start-end position","body":"<p>I need to make a validation in a string with positional information using regex.</p>\n\n<p>Example:</p>\n\n<pre><code>020005254877841100557810AAAAAA841158891BBBB\n</code></pre>\n\n<p>I need to get match position 5 until 10 and has to be only numbers.</p>\n\n<p>How can I do this using RegEx?</p>\n"},{"tags":["c#","string","visual-studio-2010"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":55,"score":0,"question_id":13277667,"title":"C# string replace does not work","body":"<p>I am trying to replace a part of string with another another string. To be more precise\nI have  <code>C:\\Users\\Desktop\\Project\\bin\\Debug</code></p>\n\n<p>and I am trying to replace <code>\\bin\\Debug</code>  with <code>\\Resources\\People</code></p>\n\n<p>I have tried the following:</p>\n\n<p>a) <code>path.Replace(@\"\\bin\\Debug\", @\"\\Resource\\People\\VisitingFaculty.txt\");</code></p>\n\n<p>b) <code>path.Replace(\"\\\\bin\\\\Debug\", \"\\\\Resource\\\\People\\\\VisitingFaculty.txt\");</code></p>\n\n<p>None of the above three seems to work, as the string remains the same and nothing is replaced. Am I doing something wrong? </p>\n"},{"tags":["c#","asp.net","asp.net-mvc","razor","html.dropdownlistfor"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13268589,"title":".Net MVC 4 Dropdownlistfor SelectedItem (Not just selected value, but the selected text)","body":"<p>I have a for loop to generate IEnumerable list:</p>\n\n<pre><code>public static IEnumerable&lt;SelectListItem&gt; loadData()\n{\n    DataTable dt = load_from_database;\n    List&lt;SelectListItem&gt; list = new List&lt;SelectListItem&gt;();\n    foreach (DataRow dr in dt.Rows)\n    {\n        SelectListItem listItem = new SelectListItem();\n        listItem.Text = dr[\"name\"].ToString();\n        listItem.Value = dr[\"id\"].ToString();\n        list.Add(listItem);\n    }\n    return list;\n}\n</code></pre>\n\n<p>And I have the following model:</p>\n\n<pre><code>public class Models\n{\n    public string selectedUserApp { get; set; }\n    public IEnumerable&lt;SelectListItem&gt; userApps  { get; set;  }\n}\n</code></pre>\n\n<p>And the controller:</p>\n\n<pre><code>public ActionResult Index()\n{\n    var model = new UserApplicationModels();\n    userAppsList = loadData();\n    model.userApps = userAppsList;\n    model.selectedUserApp = model.userApps.First().Value;\n\n    return View(model);\n}\n</code></pre>\n\n<p>Then the view:</p>\n\n<pre><code>@model Models\n\n@Html.DropDownListFor(x=&gt;x.selectedUserApp , Model.userApps)\n</code></pre>\n\n<p>What I got is the value of the selected item, but I need to get the text of selected item. </p>\n\n<p>What can I do?</p>\n"},{"tags":["c#","unicode-string"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13277958,"title":"Unicode string in C#","body":"<p>I remember using unicode string in C++ such as this: </p>\n\n<pre><code>std::wstring str = _T(\"a string here\");\n</code></pre>\n\n<p>I wonder what is the equivalent in C#?</p>\n"},{"tags":["c#",".net","iis","application","application-pool"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13278110,"title":"Log Every File Access Attempt on a System and Sort it by User/System Account","body":"<p>I have a strange issue where I need to see why my application pool is crashing due to a permissions issue and no logs are helpful. Is there any way to log every file access attempt on a system and sort it by the user/system account that tried to access it, especially if it fails in accessing the desired file? Even if there are third party applications for this, it would be very helpful.</p>\n"},{"tags":["c#",".net","compiler","clr"],"answer_count":5,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":439,"score":1,"question_id":554405,"title":"Stipulating that a property is required in a class - compile time","body":"<p>Is there a way to stipulate  that the clients of a class should specify a value for a set of properties in a class.  For example (see below code), Can i stipulate that \"EmploymentType\" property in Employment class should be specified at compile time?  I know i can use parametrized constructor and such.  I am specifically looking for outputting  a custom warning or error during compile time.   Is that possible?</p>\n\n<pre><code>public class Employment\n{\n   public EmploymentType EmploymentType {get; set;}\n}\n\npublic enum EmploymentType\n{\n    FullTime = 1,\n    PartTime= 2\n}\n\npublic class Client\n{\n    Employment e = new Employment();\n// if i build the above code, i should get a error or warning saying you should specify value for EmploymentType\n}\n</code></pre>\n"},{"tags":["c#","asp.net-mvc-4","rendering","html-helper","partialview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":22,"score":-1,"question_id":13274860,"title":"What is the alternative in MVC 4 to ViewData.Model.ExecuteResult(ViewContext)?","body":"<p>Anyone know an option to render one or plus partial views pass by controller?</p>\n"},{"tags":["c#"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13277636,"title":"Coding in vb2012, error in FileStream","body":"<p>i am building an application in C# in vb2012. i opened a new project and started editing the <code>MainPage.xaml.cs</code> file to write a main method and then a file read...</p>\n\n<pre><code>FileStream s = new FileStream(\"abc.txt\", File.Read);\n</code></pre>\n\n<p>but it's showing error in <code>FileStream</code> and saying </p>\n\n<blockquote>\n  <p>the type or namespace could not be found</p>\n</blockquote>\n"},{"tags":["c#","vb.net","nullreferenceexception"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13278127,"title":"Cant figure out this NullReferenceException","body":"<p>StackTrace:   at System.Threading._IOCompletionCallback.PerformIOCompletionCallback(UInt32  errorCode, UInt32 numBytes, NativeOverlapped* pOVERLAP)\nSource: mscorlib</p>\n\n<p>I see in the target source something about reflection. So i'll post the very small amount of code that uses reflection.</p>\n\n<p>I normally am able to find NullReferenceExceptions easily. This one though does not appear to be my code, and I can not figure it out to save my life. I have this code bot in VB.net, and C#.Net Both have the same problem. I think that my problem is in how my pointer works, but I could be wrong.</p>\n\n<p>The code is straight forward. I have a barcode scanner attached via usb that is in COM mode. I copied some of my code from another program that uses this same barcode that works perfectly. But to sum up what it does is that it opens, then, by use of reflection, gets the Pointer to the open com port, sets up a DataEventListener. When I scan something i wait 100ms, then spit out the data in string form. Simple as could be. The difference between my code and the other one that works flawlesly is that I have to get the pointer. To turn on my scanner i need a pointer to the comport using IntPtr. C# I use IntPtr, in VB i use SafeFileHandle. Both have the same error. The only time the error occurs is when a data event is fired. This is why I think it has to be with the handle. What is strange is that the Handle is needed to turn on and off the imager so I know i have a valid handle. (just don't know if it is held on to) So does anyone have any help or resources as to why I am having this error?</p>\n\n<p>First up.. VB.NET\nPublic Class ImagerOposDevice\n    Inherits AbstractOPOSDevice\n    Dim PortHandle As SafeFileHandle\n    Dim ImagerPort As SerialPort\n    Public exitCode = 1\n    Sub New(ByVal comName As String)\n        ImagerPort = New SerialPort(comName)\n    End Sub</p>\n\n<pre><code>Protected Overrides Function Open() As Boolean\n    ImagerPort.Open()\n    PortHandle = GetHandleFromSerialPort(ImagerPort)\n\n    If Not PortHandle.IsInvalid Then\n        AddHandler ImagerPort.DataReceived, AddressOf DataReceivedHandler\n    End If\n\n    Return (Not PortHandle.IsInvalid)\nEnd Function\nProtected Overrides Sub Close()\n    Try\n        ImagerPort.Close()\n        ImagerPort.Dispose()\n    Catch ex As Exception\n        Console.WriteLine(ex.Message)\n        Console.ReadLine()\n    End Try\n\nEnd Sub\n\nProtected Overrides Function RunCommand(ByVal X As Integer) As Boolean\n    If X = 0 Then\n        Return TurnImagerOn()\n    ElseIf X = 1 Then\n        Return TurnImagerOff()\n    Else\n        Return False\n    End If\nEnd Function\n\nPrivate Shared Function GetHandleFromSerialPort(ByVal sp As SerialPort) As SafeFileHandle\n    Dim BaseStream As Object = sp.BaseStream\n    Dim BaseStreamType As Type = BaseStream.GetType\n    Return BaseStreamType.GetField(\"_handle\", BindingFlags.NonPublic Or BindingFlags.Instance).GetValue(BaseStream)\nEnd Function\nPrivate Sub DataReceivedHandler(ByVal sender As Object, ByVal e As SerialDataReceivedEventArgs)\n    Try\n        'Dim sp As SerialPort = CType(sender, SerialPort)\n        System.Threading.Thread.Sleep(100)\n        Dim len = ImagerPort.BytesToRead\n        Dim buffer(len - 1) As Byte\n        ImagerPort.Read(buffer, 0, len)\n\n        Dim indata As String = System.Text.ASCIIEncoding.ASCII.GetString(buffer)\n        Console.WriteLine(\"Data Received:\")\n        Console.Write(indata)\n        TurnImagerOff()\n    Catch ex As Exception\n        Console.WriteLine(ex.Message)\n    End Try\n    exitCode = 0\nEnd Sub\n</code></pre>\n\n<p>in my main form it is straight forward</p>\n\n<pre><code>    imager = New ImagerOposDevice(\"COM7\")\n    imager.OpenDevice()\n    imager.SendCommand(0)\n    For index = 1 To 100 Step 1\n        System.Threading.Thread.Sleep(100)\n        If imager.exitCode = 0 Then\n            Exit For\n        End If\n    Next\n    Console.WriteLine(\"Press Enter to Close\")\n    Console.ReadLine()\n    CloseDevices()\n</code></pre>\n\n<p>Now for the C# code. It is a windows form, but the concept is almost identicle.</p>\n\n<pre><code>    public Imager(string Port) : base()\n    {\n        devicePort = new SerialPort(Port);\n    }\n    protected override bool Open()\n    {\n        try\n        {\n            devicePort.Open();\n            deviceHandle = GetHandleFromSerialPort(devicePort);\n            Console.WriteLine(\"Device Handle:{0}\", deviceHandle);\n            Console.WriteLine(\"Device Open:{0}\", devicePort.IsOpen);\n        }\n        catch(Exception ex)\n        {\n            Console.WriteLine(ex.Message);\n        }\n        return devicePort.IsOpen;\n    }\n    protected override bool Close()\n    {\n            devicePort.Close();\n            devicePort.Dispose();\n        return true;\n    }\n    protected override CommandReturnCodes RunCommand(int command)\n    {\n        switch (command)\n        {\n            case 0:\n                TurnImagerOn();\n                break;\n            case 1:\n                TurnImagerOff();\n                break;\n            case 2:\n                ReadLatch();\n                break;\n            case 3:\n                GetPartNumber();\n                break;\n            case 4:\n                GetSerialNumber();\n                break;\n            case 5:\n                GetProductString();\n                break;\n            default:\n                return CommandReturnCodes.FAIL;\n        }\n        return CommandReturnCodes.SUCCESS;\n    }\n    private static IntPtr GetHandleFromSerialPort(SerialPort sp)\n    {\n        Type t = typeof(SerialPort);\n        BindingFlags bf = BindingFlags.Instance | BindingFlags.NonPublic;\n        FieldInfo fi = t.GetField(\"internalSerialStream\", bf);\n        object ss = fi.GetValue(sp);\n        Type t2 = fi.FieldType;\n        FieldInfo fi2 = t2.GetField(\"_handle\", bf);\n        SafeFileHandle _handle = (SafeFileHandle)fi2.GetValue(ss);\n        Type t3 = typeof(SafeFileHandle);\n        FieldInfo fi3 = t3.GetField(\"handle\", bf);\n        IntPtr handle = (IntPtr)fi3.GetValue(_handle);\n        return handle;\n    }\n    public void TurnOnImagerEventListener()\n    {\n        devicePort.DataReceived += new SerialDataReceivedEventHandler(devicePort_DataReceived);\n    }\n\n    void devicePort_DataReceived(object sender, SerialDataReceivedEventArgs e)\n    {\n        System.Threading.Thread.Sleep(100);\n        SerialPort imager = sender as SerialPort;\n        byte[] buffer = new byte[imager.BytesToRead];\n        imager.Read(buffer, 0, imager.BytesToRead);\n        var scannedText = System.Text.Encoding.ASCII.GetString(buffer).Trim();\n        SendBarcodeEvent(scannedText);\n        TurnImagerOff();\n        Console.WriteLine(scannedText);\n    }\n</code></pre>\n\n<p>and to call it is same thing</p>\n\n<pre><code>        im = new Imager(comportBox.Text);\n        im.OpenDevice();\n        im.TurnOnImagerEventListener();\n        im.BarcodeScanned += new DataAvailableHandler(DeviceInformationReceived);\n</code></pre>\n"},{"tags":["c#","serialization"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13277122,"title":"Serializing lists/dictionaries","body":"<p>I have a application that needs to serialize a custom object and send it to a windows service, the custom object contains 2 lists of custom objects and a dictionary of int, string. When i try to serialize the object I am getting the error message:</p>\n\n<p><code>There was an error generating the XML document.</code></p>\n\n<p>I've googled around and found that this is generally due to one of the datatypes not being setup for serialization correctly. So I've gone through and verified the serialization on all the custom classes and as far as I can tell it is setup correctly.</p>\n\n<p>My question now is, are lists and dictionaries serializable by default or does something need to be done in order to serialize them? Or, is there a better way to serialize collections of custom objects to be passed between executables?</p>\n\n<p><strong>Edits:</strong></p>\n\n<p>Main Custom Class:</p>\n\n<pre><code>[Serializable]\nclass MoveInInfoRequest : ServerRequestData\n{ }\n[Serializable]\n[XmlInclude(typeof(GetUnitTypesResponseData)), XmlInclude(typeof(VendorObj.RequiredFields)),\n     XmlInclude(typeof(VendorObj.InsuranceChoice)), XmlInclude(typeof(VendorObj.ProrateSettings))]\npublic class MoveInInfoResponse : ServerResponseData\n{\n    public GetUnitTypesResponseData UnitTypesInfo\n    { get; set; }\n    public List&lt;VendorObj.RequiredFields&gt; RequiredFields \n    { get; set; }\n    public Dictionary&lt;int, String&gt; RentalPeriods\n    { get; set; }\n    public List&lt;VendorObj.InsuranceChoice&gt; InsCoverageAmounts\n    { get; set; }\n    public VendorObj.ProrateSettings ProrateOptions\n    { get; set; }\n}\n</code></pre>\n\n<p>Sampple Sub class: the other two classes are set up similar to this just much longer but they only use default datatypes. </p>\n\n<pre><code>&lt;Serializable(), DataContract([Namespace]:=\"*companyNamespace*\")&gt; _\nPublic Class InsuranceChoice\n    Public Sub New()\n    End Sub\n    &lt;DataMember()&gt; _\n    Public InsuranceChoiceID As Integer\n    &lt;DataMember()&gt; _\n    Public CoverageDescription As String\n    &lt;DataMember()&gt; _\n    Public Premium As Decimal\n    &lt;DataMember()&gt; _\n    Public ActualCoverageAmount As Decimal\n\nEnd Class\n</code></pre>\n"},{"tags":["c#",".net","asp.net-mvc","asp.net-web-api","serializable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13263988,"title":"ASP.NET Web API and [Serializable] class","body":"<p>I have a class that is marked with [Serializable]. When i return it from the Web API the field names are all funky.</p>\n\n<p>Normally the JSON returned is</p>\n\n<pre><code>[{\"OrderId\":797 ...\n</code></pre>\n\n<p>JSON returned when using [Serializable]</p>\n\n<pre><code>[{\"&lt;OrderId&gt;k__BackingField\":797 ...\n</code></pre>\n\n<p>I wan't to mark it serializable to use a BinaryFormatter for caching. Is there any other way than to write a custom serializer or to make a twin class that is not serializable and write monkey code to \"cast\" between the two?</p>\n"},{"tags":["c#","dictionary","map","f#","idiomatic"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13277773,"title":"Compose immutable F# map of list of strings","body":"<p>In C# I could build a <code>Dictionary&lt;string, List&lt;string&gt;&gt;</code> pretty easy. If I was reading through a large database of items I could do the following:</p>\n\n<pre><code>var dict = new Dictionary&lt;string, List&lt;string&gt;&gt;();\nforeach(string[] row in data)\n   if (!dict.ContainsKey(row[0]))\n      dict.add(row[0], new List&lt;string&gt;() { row };\n   else\n      dict[row[0]].add(row);\n</code></pre>\n\n<p>Now the question is, how do I do this in f# with an immutable <code>Map&lt;string, string list&gt;</code>?</p>\n"},{"tags":["c#","facebook"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13278023,"title":"Facebook C# event api + wrong privacy and unable to upload image","body":"<p>I successfully created an event on facebook using the event api but somehow the event privacy remains as 'OPEN' even though I specified as 'SECRET' and if I were to include a logo image it returns this error:</p>\n\n<pre><code>(OAuthException - #324) (#324) Missing or invalid image file\n</code></pre>\n\n<p>I have ensured that the photo exist as well as tried replacing the content type as <strong>\"image/png\"</strong> but still no help.</p>\n\n<p>Please kindly advice what am I doing wrong. Thanks.</p>\n\n<pre><code>public string CreateEvent()\n    {\n            var accessToken = accessTok;\n            FacebookClient facebookClient = new FacebookClient(accessToken);\n            Dictionary&lt;string, object&gt; createEventParameters = new Dictionary&lt;string, object&gt;();\n            createEventParameters.Add(\"owner\", \"IronMan\");\n            createEventParameters.Add(\"name\", \"Test Event\");\n            createEventParameters.Add(\"description\", \"This is a super hero event.\");\n            createEventParameters.Add(\"start_time\", \"2012-11-11T19:00:00-0700\" );\n            createEventParameters.Add(\"location\", \"A Street\");\n\n            //Add the \"venue\" details\n            JsonObject venueParameters = new JsonObject();\n            venueParameters.Add(\"street\", \"19 Phipps St\");\n            venueParameters.Add(\"city\", \"Toronto\");\n            venueParameters.Add(\"state\", \"ON\");\n            venueParameters.Add(\"zip\", \"L2A 2V2\");\n            venueParameters.Add(\"country\", \"Canada\");\n            venueParameters.Add(\"latitude\", \"43.6654507\");\n            venueParameters.Add(\"longitude\", \"-79.38569580000001\");\n            createEventParameters.Add(\"venue\", venueParameters);\n\n            createEventParameters.Add(\"privacy\", \"SECRET\");\n            createEventParameters.Add(\"updated_time\", DateTime.Now.ToString(CultureInfo.InvariantCulture));\n\n            // Add the event logo image\n            string uploadPath = Server.MapPath(\"~/Images\");\n            string fullPath = uploadPath + \"\\\\bb.png\";\n            FacebookMediaObject logo = new FacebookMediaObject()\n                                           {\n                                               ContentType = \"image/jpeg\",\n                                               FileName = fullPath\n                                           };\n            logo.SetValue(File.ReadAllBytes(logo.FileName));\n            createEventParameters[\"@file.jpg\"] = logo;\n\n          JsonObject result = facebookClient.Post(\"/me/events\", createEventParameters) as JsonObject;\n\n            // TODO: Use the info above and create event natively so that it will appear on my map.\n\n        return result[\"id\"].ToString();\n    }\n</code></pre>\n"},{"tags":["c#",".net","asynchronous","windows-services","parallels"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":47,"score":0,"question_id":13277742,"title":"C# Console Application using Parallels or Async","body":"<p>There is a lot of examples and talk out there about parallels, concurrency and now asynchronous calls with .NET 4.5. We are looking for the best solution for our application as a lot of this talk is confusing to us. </p>\n\n<p>We have a console application which needs to run every minute, it currently checks for XML files in a directory and then if any exist, it loops through each one synchronously, loading each as an XMLDocument, parsing it using LINQ and List objects and then saving it to the database. The XML files are relatively small, the biggest ones are maybe 400kb with most in that 20-85kb range.  </p>\n\n<p>We are trying to determine the best route performance wise as there are sometimes 30-50 files and it takes more than a minute to run, pushing it into the time where it needs to run again. With the files currently being processed synchronously, there seems to be an opportunity to process them more quickly since each one is independent of the others, but aren't sure the best approach here in regards to thread safety and performance.</p>\n\n<p>Here is our code, I took a bunch of stuff out to keep just the main components to keep it simple. The Engine.ProcessXML is the call to another method which determines the type of document, then calls the appropriate LINQ parsing method and database layer method for saving.</p>\n\n<pre><code>string feedsDir = ConfigHelper.FeedsDirectory;\n\nif (Directory.Exists(feedsDir))\n{\n    //get full xml file paths\n    string[] filePaths = Directory.GetFiles(feedsDir, \"*.xml\");\n\n    //get total number of files to be processed\n    int fileCount = filePaths.Length;\n\n    if (fileCount &gt; 0)\n    {\n        //loop through each file to process\n        foreach (string file in filePaths)\n        {\n            if (File.Exists(file))\n            {\n                //load the file into xml document object\n                XDocument xmlDoc = XDocument.Load(file);\n\n                //if xml document not empty, process\n                if (xmlDoc != null)\n                {\n                    //parse and save document data\n                    Engine.ProcessXML(xmlDoc);\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Side Note:  We have looked into creating a windows service and some FileSystemWatcher class, but we are currently wanting to keep the complexity down. The console app is easier to debug right now and want to address this first performance issue. We can always go back and wrap our console application in a service once it is performing at maximum speed, per-say. And getting this app on parallels or some type of multi-threading, if possible, would make a service easier to convert to since that would probable be needed. </p>\n"},{"tags":["c#","java","oracle","comments","code-comments"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":78,"score":1,"question_id":13277865,"title":"What is the best approach for inline code comments?","body":"<p>We are doing some refactor to a 20 years old legacy code, and I'm having a discussion with my colleague about the comments format in the code (plsql,java).</p>\n\n<p>There is no a default format for comments, but in most cases people do something like this in the comment:</p>\n\n<pre><code>// date (year, year-month, yyyy-mm-dd, dd/mm/yyyy), (author id, author name, author nickname) and comment\n</code></pre>\n\n<p>the proposed format for future and past comments that I want is:</p>\n\n<pre><code>// {yyyy-mm-dd}, unique_author_company_id, comment\n</code></pre>\n\n<p>My colleague says that we only need the comment, and must reformat all past and future comments to this format:</p>\n\n<pre><code>// comment\n</code></pre>\n\n<p>My arguments:</p>\n\n<ul>\n<li>I say for maintenance reasons, it´s important to know when and who\ndid a change (even this information is in the SCM).</li>\n<li>The code has life and hence has history.</li>\n<li>Because without the change date it is impossible to know when a change was introduced without opening the SCM tool and searching in the long object history.</li>\n<li>because the author is very important, a change by author X is more credible than a change of author Y</li>\n<li>Agility reasons, no need to open and navigate the SCM tool</li>\n<li>people would be more afraid of changing something that someone did 15 years ago, than something that was recently done...</li>\n</ul>\n\n<p>My colleague's arguments:</p>\n\n<ul>\n<li>The history is in the SCM</li>\n<li>Developers must not be aware of history of the code directly in the code</li>\n<li>Package gets 15k lines long and unstructured comments make this packages harder to understand</li>\n</ul>\n\n<p>What do you think is the best approach? or do you have a better approach to solve this problem?</p>\n"},{"tags":["c#",".net","embedded","netduino"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":21,"score":-2,"question_id":13277992,"title":"C# WPF to Embedded programming transition","body":"<p>I've been learning C# .NET Framework for around 4-6 months (still starting) using some books, and have currently made my way up to Collections and Generics. I'll probably spend the next two months covering the rest up to LINQ and/or Garbage Collections.</p>\n\n<p>The thing is, I started to become interested in embedded systems and found out that you can use C# to code it through .NET MF, which mean I wouldn't have to learn C or C++.\nSo, I would like to know if the knowledge I'll have by that time (2 months) will be enough to start working on Embedded (using C# .NET Micro Framework and Netduino) or I should probably see more about plain C# like Multithreading, async and other advanced features ?</p>\n\n<p>I want use embedded just as a hobby, at least by now, as I'll still have a long way through university. Although, I'll probably pick it as a career then.</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["c#",".net","amazon-web-services","amazon-cloudsearch"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":101,"score":1,"question_id":12051613,"title":"Are there libraries to search Amazon CloudSearch from .NET?","body":"<p>What libraries are out there to perform searches in AWS' CloudSearch domains? The AWS SDK is virtually devoid of search capabilities.</p>\n\n<hr>\n\n<p>I would like to use Amazon CloudSearch for a project to search in pre-existing databases for certain customer-related data for billing purposes.</p>\n\n<p>We already have extensive experience with Solr-based search services, but in this particular instance we do not want to host the search service in-house and already have experience with AWS.</p>\n\n<p>The Amazon SDK provides a decent .NET-based approach to administer search domains. But: Apparrently it lacks any capability whatsoever to actually <strong>search</strong> for things.</p>\n\n<p>I have found <a href=\"https://github.com/Bigjono/AWS-CloudSearch\" rel=\"nofollow\">a few</a> <a href=\"https://github.com/breaker05/Amazon-CloudSearch\" rel=\"nofollow\">attempts</a> to provide a search API, but nothing that works OOTB. Any suggestions or experience with CloudSearch from within .NET?</p>\n\n<p>(Yes, I know it is easy to just chug parameters in a web service call and deal with the JSON reply; a wrapper / library just would deal better with the messy details of parsing etc.)</p>\n"},{"tags":["c#","windows-phone-7","qr-code","contact","vcard"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13277956,"title":"Scan QR code (vcard) and save the contact on windows phone 7","body":"<p>Hi guys I'm developing an app, but I have a problem with saving vcard as contact functionality, here is how it works step by step:</p>\n\n<ol>\n<li><p>Scan the QR Code (a vCard Data v2.1 <a href=\"http://www.printbusinesscards.com/marketing/qrcode/QR-Code-Quality-Standards-Test.php\" rel=\"nofollow\">http://www.printbusinesscards.com/marketing/qrcode/QR-Code-Quality-Standards-Test.php</a> Test Case 12.02)</p></li>\n<li><p>Now i store the dats in a string and i pass it to a new page (BEGIN:VCARD\nVERSION:2.1\nN:Standard;Joe;;;\nFN:Joe Standard12.02\nTEL:999-999-0001\nTEL;WORK:999-999-0002\nTEL;HOME:999-999-0003\nTEL;CELL:999-999-0004\nTEL;CELL;WORK:999-999-0005\nTEL;CELL,WORK:999-999-0006\nTEL;CELL;WORK;VOICE;MSG:999-999-0007\nTEL;CELL;WORK;VOICE;type=MSG:999-999-0008\nTEL;CELL;WORK;type=VOICE;type=MSG:999-999-0009\nEND:VCARD)</p></li>\n<li><p>Now I have the problem, I want to save the string (vcard) as contact, is there a fast way, or i need to parse all the string?</p></li>\n</ol>\n\n<p>(actually should work as builtin windows phone bing qr readear)</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","parameters","switch-statement","class-library","using-statement"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":13266258,"title":"C# switch library using with program paremeters","body":"<p>I have a project with two class libraries.\nI need to switch between them programatically, with application parameters, something like</p>\n\n<pre><code>if(arg == \"a\")\n    using LibraryA;\nif(arg == \"b\")\n    using LibraryB;\n\nnamespace Project\n{\n    public class MyClass\n    {\n    // my code here\n    }\n}\n</code></pre>\n"},{"tags":["c#","android","mono","monodroid","xamarin"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":39,"score":5,"question_id":13277146,"title":"Mono for Android - Supported Architecture - Drop x86?","body":"<p>We have a near complete application, and are trying to squeeze under the 50MB download limit for Google Play.</p>\n\n<p>When inspecting our APK to try to find ways to drop our file size, I noticed the <code>lib\\x86</code>, <code>lib\\armeabi</code>, and <code>lib\\armeabi-v7a</code> directories that are described <a href=\"http://docs.xamarin.com/Android/Guides/Advanced_Topics/CPU_Architecture\">here</a>.  They correspond to the 'Supported architecture' option in project options of a Mono for Android project.</p>\n\n<p>If I remove x86, I save around 1.1 MB on our APK size.  (This is almost enough to get us under 50MB)</p>\n\n<ul>\n<li>What are the drawbacks for removing x86?  </li>\n<li>Will my APK still run on x86 devices?</li>\n<li>Is there any substantial market share on Google Play for x86 devices?</li>\n<li>If it will not work on x86, will Google Play prevent my APK from being installed on x86 devices?</li>\n</ul>\n"},{"tags":["c#","asp.net"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":366,"score":1,"question_id":5522900,"title":"asp.net form control ID is null on enumeration","body":"<p>I have a simple ASP.Net page, and I am enumerating through the controls doing things to the controls via reflection (localising the page - but that is whole other can of managerial dictat type worms). So...I have a test page thus:</p>\n\n<pre><code>&lt;%@ Page Title=\"\" Language=\"C#\" MasterPageFile=\"~/Master Pages/Root.master\" AutoEventWireup=\"true\" CodeFile=\"refelectiontest.aspx.cs\" Inherits=\"refelectiontest\" %&gt;\n\n&lt;asp:Content ID=\"Content1\" ContentPlaceHolderID=\"ContentPlaceHolder1\" Runat=\"Server\"&gt;\n\n    &lt;asp:Button ID=\"Button1\" runat=\"server\" Text=\"Button\" /&gt;\n\n    &lt;asp:Label ID=\"Label1\" runat=\"server\" Text=\"Label\"&gt;&lt;/asp:Label&gt;&lt;asp:Label ID=\"Label2\"\n        runat=\"server\" Text=\"Label\"&gt;&lt;/asp:Label&gt;\n\n    &lt;asp:Label ID=\"Label3\" runat=\"server\" Text=\"Label\"&gt;&lt;/asp:Label&gt;\n\n&lt;/asp:Content&gt;\n</code></pre>\n\n<p>And then in the code behind, I want to iterate through the controls...</p>\n\n<p>So I have this (the master page can deal with itself)</p>\n\n<pre><code>protected void Page_Load(object sender, EventArgs e)\n    {\n        if (!IsPostBack)\n        {\n\n            try\n            {\n\n                foreach (Control ctrl in Form.Controls)\n                {\n                    if (ctrl is ContentPlaceHolder)\n                    {\n                        ContentPlaceHolder chp = ctrl as ContentPlaceHolder;\n                        foreach (Control control in chp.Controls)\n                        {\n                string strID = control.ID;\n                //do stuff based on the the ID\n                        }\n                    }\n\n\n                }\n\n            }\n            catch (Exception ex)\n            {\n                Response.Write(ex.ToString());\n            }\n        }\n\n    }\n</code></pre>\n\n<p>Now, if I just run this, it barfs with an object null exception. And if I step through the code, putting a breakpoint on the control.ID line, then indeed the ID is null. However, if I then expand the control object, the ID fills itself out and all is well.</p>\n\n<p>It looks like the ID is only getting completed at the last moment - how can I ensure that I can get the ID without getting null?\nThe same thing happens if I don't use the master page.\nThanks.</p>\n"},{"tags":["c#",".net","permissions"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":3456,"score":2,"question_id":1475964,"title":"writing files to Common Application Data folder denied","body":"<p>i have used the follwing function to write data to user application folder</p>\n\n<pre><code>private void WriteToLog(string source, string method, string msg)\n{\n\n string LogFile =Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData) + \"\\\\test\";            \n LogFile = LogFile + \"\\\\Log.txt\";\n StreamWriter sw = new StreamWriter(LogFile, true );\n string str = DateTime.Now.ToString() + \"source=\" + source + \"\\t Method=\" + method + \"\\t\" + msg;\nsw.WriteLine(str);\nsw.Flush();\nsw.Close();\n}\n</code></pre>\n\n<p>the above code working perfectly in administrator accounts, but failed in limited user accounts</p>\n"},{"tags":["c#","log4net","quartz.net-2.0","common.logging","log4net-configuration"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13277333,"title":"Quartz.Net - Common Logging with log4net","body":"<p>I'm trying to implement Quartz.Net. As long as there is no logging configured everything works (the debug output shows <em>\"no configuration section  found - suppressing logging output\"</em>).</p>\n\n<p>When logging is enabled I'll get the following error: <strong>Failed obtaining configuration for Common.Logging from configuration section 'common/logging'</strong>.</p>\n\n<p>Inner exeption: <strong>An error occurred creating the configuration section handler for common/logging: Unable to create type 'Common.Logging.Log4Net.Log4NetLoggerFactoryAdapter, Common.Logging.Log4net'</strong> </p>\n\n<p>I used several resources as <a href=\"http://netcommon.sourceforge.net/docs/1.2.0/reference/html/logging.html#logging-adapters-log4net\" rel=\"nofollow\">this one</a> to varify my configuration, but as far as I see it should be correct.</p>\n\n<p>My app.config:</p>\n\n<pre><code>  &lt;configSections&gt;\n    &lt;section name=\"quartz\" type=\"System.Configuration.NameValueSectionHandler, System, Version=1.0.5000.0,Culture=neutral, PublicKeyToken=b77a5c561934e089\" /&gt;\n    &lt;sectionGroup name=\"common\"&gt;\n      &lt;section name=\"logging\" type=\"Common.Logging.ConfigurationSectionHandler, Common.Logging\" /&gt;\n    &lt;/sectionGroup&gt;\n    &lt;section name=\"log4net\" type=\"log4net.Config.Log4NetConfigurationSectionHandler, log4net\" /&gt;\n  &lt;/configSections&gt;\n  &lt;common&gt;\n    &lt;logging&gt;\n      &lt;factoryAdapter type=\"Common.Logging.Log4Net.Log4NetLoggerFactoryAdapter, Common.Logging.Log4net\"&gt;\n        &lt;arg key=\"configType\" value=\"INLINE\" /&gt;\n      &lt;/factoryAdapter&gt;\n    &lt;/logging&gt;\n  &lt;/common&gt;  \n  &lt;log4net&gt;\n    &lt;appender name=\"ConsoleAppender\" type=\"log4net.Appender.ConsoleAppender\"&gt;\n      &lt;layout type=\"log4net.Layout.PatternLayout\"&gt;\n        &lt;param name=\"ConversionPattern\" value=\"%-6p%d{yyyy-MM-dd hh:mm:ss} – %m%n\" /&gt;\n      &lt;/layout&gt;\n    &lt;/appender&gt;\n    &lt;root&gt;\n      &lt;level value=\"DEBUG\" /&gt;\n      &lt;appender-ref ref=\"ConsoleAppender\" /&gt;\n    &lt;/root&gt;\n  &lt;/log4net&gt;\n  &lt;quartz&gt;\n    &lt;add key=\"quartz.scheduler.instanceName\" value=\"Driver.Service.Scheduler\" /&gt;\n    &lt;add key=\"quartz.threadPool.type\" value=\"Quartz.Simpl.SimpleThreadPool, Quartz\" /&gt;\n    &lt;add key=\"quartz.threadPool.threadCount\" value=\"10\" /&gt;\n    &lt;add key=\"quartz.threadPool.threadPriority\" value=\"2\" /&gt;\n    &lt;add key=\"quartz.jobStore.misfireThreshold\" value=\"60000\" /&gt;\n    &lt;add key=\"quartz.jobStore.type\" value=\"Quartz.Simpl.RAMJobStore, Quartz\" /&gt;\n  &lt;/quartz&gt;\n</code></pre>\n\n<p>I referenced the following assemblies:<br>\nquartz.dll, version 2.01.100<br>\ncommon.logging.dll, version 2.0.0.0<br>\ncommon.logging.log4net.dll, version 2.0.0.0<br>\nlog4net.dll, version 1.2.10.0</p>\n\n<p>I cannot find a reason for the error given. All help is welcome, apparently I forget something...</p>\n"},{"tags":["c#","regex","sorting"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13276990,"title":"RegExp Natural Sorting issue","body":"<p>I am working on an application that needs to display different columns of information naturally sorted. A while back I found <a href=\"http://www.codeproject.com/Articles/22517/Natural-Sort-Comparer\" rel=\"nofollow\">this</a> article that has a good description and code. I modified it some since we have columns that also show dates and ended up with this:</p>\n\n<pre><code>public class NaturalComparer : Comparer&lt;string&gt;, IDisposable\n{\n    private Dictionary&lt;string, string[]&gt; table;\n\n    public NaturalComparer()\n    {\n        table = new Dictionary&lt;string, string[]&gt;();\n    }\n\n    public void Dispose()\n    {\n        table.Clear();\n        table = null;\n    }\n\n    public override int Compare(string x, string y)\n    {\n        if (x == y)\n        {\n            return 0;\n        }\n\n            DateTime xValueD, yValueD;\n            if (DateTime.TryParse(x, out xValueD) &amp;&amp; DateTime.TryParse(y, out yValueD))\n                return xValueD.CompareTo(yValueD);\n\n\n        string[] x1, y1;\n        if (!table.TryGetValue(x, out x1))\n        {\n            x1 = Regex.Split(x.Replace(\" \", \"\"), \"([0-9]+)\");\n            table.Add(x, x1);\n        }\n        if (!table.TryGetValue(y, out y1))\n        {\n            y1 = Regex.Split(y.Replace(\" \", \"\"), \"([0-9]+)\");\n            table.Add(y, y1);\n        }\n\n        for (int i = 0; i &lt; x1.Length &amp;&amp; i &lt; y1.Length; i++)\n        {\n            if (x1[i] != y1[i])\n            {\n                return PartCompare(x1[i], y1[i]);\n            }\n        }\n        if (y1.Length &gt; x1.Length)\n        {\n            return 1;\n        }\n        else if (x1.Length &gt; y1.Length)\n        {\n            return -1;\n        }\n        else\n        {\n            return 0;\n        }\n    }\n\n    private static int PartCompare(string left, string right)\n    {\n        int x, y;\n        if (!int.TryParse(left, out x))\n        {\n            return left.CompareTo(right);\n        }\n\n        if (!int.TryParse(right, out y))\n        {\n            return left.CompareTo(right);\n        }\n\n        return x.CompareTo(y);\n    }\n}\n</code></pre>\n\n<p>Now it also needs to process a special type of string data and it is not doing what we need. The strings show information of ranges of data and they look like this:</p>\n\n<pre><code>string[] list = { \"Empty Values\",\"x&lt;0\" , \"1000.0 &lt; x &lt;=1500.0\", \"900.0 &lt; x &lt;= 1000.0\",\"3000.0 &lt; x &lt;= 3500.0\", \"800.0 &lt; x &lt;=900.0\" };\n</code></pre>\n\n<p>Sorted it should look like:</p>\n\n<pre><code>x &lt; 0\n800.0 &lt; x &lt;= 900.0\n900.0 &lt; x &lt;= 1000.0\n1000.0 &lt; x &lt;= 1500.0\n3000.0 &lt; x &lt;= 3500.0\nEmpty Values\n</code></pre>\n\n<p>However, it ends up with:</p>\n\n<pre><code>800.0 &lt; x &lt;= 900.0\n900.0 &lt; x &lt;= 1000.0\n1000.0 &lt; x &lt;= 1500.0\n3000.0 &lt; x &lt;= 3500.0\nEmpty Values\nx &lt; 0\n</code></pre>\n\n<p>So, logically I think it is doing what it is designed to do, because it picks on the letter and sorts based on that. I would like to keep it searching with regular expressions since it is fast. However, I have no idea how to set them up so it searches, and sorts, correctly. Any ideas, help, readings, or code would be appreciated.\nThanks</p>\n"},{"tags":["c#","asp.net","reportviewer"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13169719,"title":"set textbox value in Reportviewer using asp.net c#","body":"<p>i have a reportviewer containing a a textbox and tablix.\nThe tablix is populated using a datasource(which gets data using  a stored proc with 2 parameters from a query string).\nHow do i specify the value of the query strings as the value of my reportviewer textbox.\nsomething like:\nThis ReportfFrom query String val1 to query String val 2.</p>\n\n<p>markup:</p>\n\n<pre><code>&lt;rsweb:ReportViewer ID=\"ReportViewer1\" runat=\"server\" \n    CssClass=\"ReportAlignment\" Font-Names=\"Verdana\" Font-Size=\"8pt\" \n    InteractiveDeviceInfos=\"(Collection)\" WaitMessageFont-Names=\"Verdana\" \n    WaitMessageFont-Size=\"14pt\" Width=\"550px\"&gt;\n    &lt;LocalReport ReportPath=\"TempEmpWageSummaryReport.rdlc\"&gt;\n        &lt;DataSources&gt;\n            &lt;rsweb:ReportDataSource DataSourceId=\"LoadWageSummary\" Name=\"DataSet1\" /&gt;\n        &lt;/DataSources&gt;\n    &lt;/LocalReport&gt;\n&lt;/rsweb:ReportViewer&gt;\n&lt;asp:SqlDataSource ID=\"LoadWageSummary\" runat=\"server\" \n    ConnectionString=\"&lt;%$ ConnectionStrings:stockerConnectionString %&gt;\" \n    SelectCommand=\"procTempEmployeeWageSummaryReport\" \n    SelectCommandType=\"StoredProcedure\"&gt;\n    &lt;SelectParameters&gt;\n        &lt;asp:QueryStringParameter Name=\"startDate\" QueryStringField=\"start\" \n            Type=\"String\" /&gt;\n        &lt;asp:QueryStringParameter Name=\"endDate\" QueryStringField=\"end\" Type=\"String\" /&gt;\n    &lt;/SelectParameters&gt;\n&lt;/asp:SqlDataSource&gt;\n</code></pre>\n\n<p>The code behind</p>\n\n<pre><code>protected void Page_Load(object sender, EventArgs e)\n    {\n        string start = Server.UrlDecode(Request.QueryString[\"start\"]);\n        string end = Server.UrlDecode(Request.QueryString[\"end\"]);\n        //this.ReportViewer1.LocalReport.ReportEmbeddedResource = \"TempEmpWageSummaryReport.rdlc\";\n        string param0 = \"GROUPED TEMPORARY EMPLOYEE WAGE SUMMARY REPORT FROM \" + start + \"to \" + end;\n        ReportParameter rp = new ReportParameter(\"ReportParameter1\", param0);\n        this.ReportViewer1.LocalReport.SetParameters(new ReportParameter[] { rp });\n\n        this.ReportViewer1.LocalReport.Refresh();\n\n        //BindReport();\n    }\n</code></pre>\n\n<p>Thanks.</p>\n"},{"tags":["c#","windows-vista"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":5103,"score":4,"question_id":1572442,"title":"Saving a file to Application Data in c#","body":"<p>I used the following method to save a file to the folder  Application Data in c#</p>\n\n<pre><code>string path = \n    Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData);\n</code></pre>\n\n<p>Its working fine in windows XP, but i cannt find such a folder path i Windows vista.\nWhere is this folder located in Vista and how can i save the file to this folder</p>\n"},{"tags":["c#","arrays"],"answer_count":7,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":61,"score":3,"question_id":13277737,"title":"Why does the array have more elements than I've defined?","body":"<p>So, I've got this function which reads from an INI file:</p>\n\n<pre><code>private void GetRigInfo()\n{\n    RigInfo = new string[9];\n    var fileLocation = new string[2];\n\n    // The problem is that there's no telling where the hddrigsite.ini will be \n    stored.  So, we have to find out where it is from the hddconfig.ini.\n    Log(\"Locating rig info\");\n\n    // There's no telling if this will be on a 32 or 64 bit OS.  Check for both\n    var rigInfoLocation = File.ReadAllLines(Environment.Is64BitOperatingSystem ?\n                          @\"C:\\Program Files (x86)\\HDD DrillView\\hddconfig.ini\" : \n                          @\"C:\\Program Files\\HDD DrillView\\hddconfig.ini\");\n\n    // This should get us the location of the rigsite info we need.\n    foreach (var s in rigInfoLocation.Where(s =&gt; s.Contains(\"data_dir\")))\n    {\n        fileLocation = s.Split('=');\n    }\n\n    RigInfo = File.ReadAllLines(fileLocation[1] + \"\\\\hddrigsite.ini\");\n\n    Log(\"Rig info found\");\n}\n</code></pre>\n\n<p>Now, when I step through, and get to the last <code>Log()</code> in the function, and I hover over <code>RigInfo</code>, Visual Studio intellisense shows me <code>RigInfo{string[30]}</code>.  Now, I've always understood that <code>= new string[9]</code> would create a 9 element array.  So why is it allowed to have 30 elements?  When I run the program, I get no errors or anything when it comes to this array.  Matter of fact, it works just the way that I need it to in the overall scheme of things.  Thanks for any and all help in understanding how and why this is the way it is.  Also attached screenshot for better visual aid.</p>\n\n<p><img src=\"http://i.stack.imgur.com/hsFyy.png\" alt=\"Confusing intellisense\"></p>\n"},{"tags":["c#","asp.net","asprepeater"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13277526,"title":"asp:repeater show count of items in each category","body":"<p>I have a simple repeater that gets the 'groups' of 'widgets' The home page lists all of the groups:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;ItemTemplate&gt;\n    &lt;tr&gt;\n        &lt;td width=\"60\" class=\"center\"&gt;&lt;%# DataBinder.Eval(Container.DataItem, \"Number\") %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;a href=\"Stories.aspx?ProjectID=&lt;%# DataBinder.Eval(Container.DataItem, \"ProjectId\") %&gt;\"&gt;&lt;%# DataBinder.Eval(Container.DataItem, \"Name\") %&gt;&lt;/a&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%# DataBinder.Eval(Container.DataItem, \"Description\") %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n&lt;/ItemTemplate&gt;\n</code></pre>\n\n<p><strong>Code Behind</strong></p>\n\n<pre><code>private void LoadForm()\n{\n    using (MarketingWebContentEntities context = new MarketingWebContentEntities())\n    {\n        rptGroup.DataSource = (from groups in context.URLGroup\n                               select groups).ToList();\n        rptGroup.DataBind();\n    }\n}\n</code></pre>\n\n<p>I would like within the repeater to show number of 'widgets' within each 'group'.  I know I'd need to run a query on the 'widgets' table to see how many items are in that list.  I'm just unsure how to add that within the repeater mark-up.</p>\n"},{"tags":["c#","fxcop"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":60,"score":3,"question_id":13277238,"title":"Why does FxCop insist on IDisposable for a struct","body":"<p>I have the code similar to the following in one of my projects:</p>\n\n<pre><code>internal enum ArtworkType\n{\n    Undefined = 0,\n    Bmp = 1,\n    Gif = 2,\n    Jpeg = 3,\n    Png = 4\n}\n\n[StructLayout(LayoutKind.Sequential)]\ninternal struct TagArtwork\n{\n    internal IntPtr data;\n    internal int size;\n    internal ArtworkType type;\n}\n</code></pre>\n\n<p>When I run FxCop on this code, I get run into warning <a href=\"http://msdn.microsoft.com/en-us/library/ms182173.aspx\" rel=\"nofollow\">CA1049</a>. This struct is used for interoperability with a native code library, so it pretty much <strong>has</strong> to have this layout. Why does FxCop give me grief about this struct? I have other structs in the same source file, which also have <code>IntPtr</code> members, but FxCop does not complain about those.</p>\n\n<p>For example, the following code does <strong>not</strong> trigger the same warning:</p>\n\n<pre><code>internal enum ItemType\n{\n    Implicit = 0,\n    Utf8 = 1,\n    Utf16 = 2,\n    Sjis = 3,\n    Html = 6,\n    Xml = 7,\n    Uuid = 8,\n    Isrc = 9,\n    Mi3p = 10,\n    Gif = 12,\n    Jpeg = 13,\n    Png = 14,\n    Url = 15,\n    Duration = 16,\n    DateTime = 17,\n    Genres = 18,\n    Integer = 21,\n    Riaa_pa = 24,\n    Upc = 25,\n    Bmp = 27,\n    Undefined = 255\n}\n\n[StructLayout(LayoutKind.Sequential)]\ninternal struct MP4ItmfData\n{\n    internal byte typeSetIdentifier;\n    internal ItemType typeCode;\n    internal int locale;\n    internal IntPtr value;\n    internal int valueSize;\n}\n</code></pre>\n\n<p>I suppose I could implement <code>IDisposable</code> on the struct, but that just seems wrong. Likewise, I could simply suppress the warning, but at the moment, I want to understand what it is about this particular struct that is triggering the warning, when it's not that much different than the other seven structs I have in the same source file. Alternatively, I'd happily accept an explanation of why the other structs <strong>don't</strong> trigger this warning.</p>\n"},{"tags":["c#","debugging"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":18,"score":-1,"question_id":13275024,"title":"Debugging an issue with COM object and RCW","body":"<p>In my C# WinForms app I have a child app that is using a old VB 6.0 or maybe VC 6.0 ActiveX control as a text editor ( old ActiveX version of TXTextControl if you have used it).\nIn VS IDE when I close this child app that has this activeX control and then I close the main app and I get this error:</p>\n\n<p><img src=\"http://i.stack.imgur.com/vZaF7.png\" alt=\"enter image description here\"></p>\n\n<p>What are some techniques and ideas that you suggest for digigng into this and finding whats going on?  This does not happen if I run my app out side of VS IDE. </p>\n"},{"tags":["c#",".net","iis","crystal-reports","application-pool"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13277769,"title":"Application Pool Crashes when Web Site is Not Running as Network Service","body":"<p>I have a site running Crystal Reports Viewer in IIS 7 but for security reasons we want it to run the application pool under the ApplicationPoolIdentity. We noticed the application pool keeps crashing when we switched it from Network Service to ApplicationPoolIdentity and we want to give extra permissions to the ApplicationPoolIdentity on certain folders on the drive in order to remedy this situation. The problem is, we gave a ton of permissions to different folders, but as far as we can tell we cannot pinpoint why the application pool keeps crashing and what file it cannot access. We checked a lot of different log files, but maybe we skipped over some that could be of more importance. Is there anything out there to show us where the problem is, whether it be a certain log I haven't come across or some sort of tracing I can use to get to the files that I need to give this identity permissions? The pool crashes when trying to load Crystal Reports Viewer and gives no errors, just says it is unreachable.</p>\n"},{"tags":["c#","asp.net","report-viewer2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13277395,"title":"When using Report Viewer and asked for datasource my data access class does not show up","body":"<p>I am new to using the report viewer control. </p>\n\n<p>The way I am currently creating a report is by calling a stored procedure and inserting input parameters to query a table in a database and to return a list of rows. </p>\n\n<p>The rows are inserted into a Data Table and the Data Table is returned.</p>\n\n<p>The data table is binded to a gridview which the user can view.</p>\n\n<p>Now my problem....</p>\n\n<p>I would like to use the report viewer to display the data instead of the gridview so the users can easily export the data and view a nice graph with it.</p>\n\n<p>The Stored Procedure is called from my data access class which is just a class I have in my project (it is not in a folder).</p>\n\n<p>When I go to create a report viewer and get asked for my datasource my data access class does not show up.  How can I get the results (the returned data table) from my stored procedure function to get inserted into the report viewer?</p>\n"},{"tags":["c#","popup","excel-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13269557,"title":"DoNotPromptForConvert Fails to Suppress popup in Excel 2010","body":"<p>I'm have a .Net project that is automating the transfer of information between Excel workbooks.  The code opens up an Excel 2010 application, opens up a Workbook that is in xlExcel8 format, creates a blank workbook in xlExcel8 format and transfers a page from the first workbook to the blank workbook. I have not been able to suppress the pop-up message when I save the blank workbook even though I've used the DoNotPromptForConvert command. The Code I've been using is:</p>\n\n<pre><code>        private static void QuickTest()\n    {\n        Object M = Type.Missing;\n\n        string FullFileName2 = \"C:\\\\Users\\\\Bill Corry\\\\Venrock\\\\SusansProject\\\\Test.xls\";                //blank WkbkName\n        string FullFileName = \"C:\\\\Users\\\\Bill Corry\\\\Venrock\\\\SusansProject\\\\VRQtrCompInfoReqv8.xls\";   //Template\n        XLHlpr XLH = new XLHlpr();      // start a helper class \n\n        XL.Workbook srcWkBk = XLH.OpenExistingWorkbook(FullFileName, false);    //open WkBk with Format xlExcel8\n        srcWkBk.DoNotPromptForConvert = true;                                   //try to suppress pop-up message\n\n        XL.Workbook WkBk = XLH.GetNewWorkbook();                                //open blank workbook \n        WkBk.DoNotPromptForConvert = true;\n        WkBk.SaveAs(FullFileName2, XL.XlFileFormat.xlExcel8, M, M, M, M, XL.XlSaveAsAccessMode.xlNoChange, M, M, M, M, M);  //no popup here\n            //Copy Worksheet from first file to blank workbook\n        XL.Worksheet WkSht = (XL.Worksheet)srcWkBk.Worksheets[1];           \n        WkSht.Copy(WkBk.Worksheets[1], M);\n        WkBk.DoNotPromptForConvert = true;\n        WkBk.Save();                                  //Popup occurrs on this step\n        WkBk.Close(false, M, M);\n        srcWkBk.Close(M, M, M);                     \n    }\n</code></pre>\n"},{"tags":["c#","ado.net","tableadapter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13260129,"title":"SUM child column of tableadapter","body":"<p>I have a tableadapter (<code>SettlementCurrentTableAdapter</code>) with a relation. parent table is (<code>SettlementCurrent</code>) child table is (<code>Trips</code>). </p>\n\n<p>I need to SUM each row (<code>tripLoadedMiles</code>) in (<code>Trips</code>) and display the total in a label (<code>labelWelcomeSetTotalMiles</code>).</p>\n\n<p>I would like to do this in code and not sql as i use this tableadapter to display other labels.</p>\n\n<p>Can someone help me figure this out. i am new to C# and i use Visual C#.</p>\n\n<pre><code>        this.settlementCurrentTableAdapter.Fill(this.myLeaseDataSet.SettlementCurrent);\n        MyLeaseDataSet.SettlementCurrentRow settlementCurrent;\n        settlementCurrent = myLeaseDataSet.SettlementCurrent.Last();\n\n        var settlementCurrentID = settlementCurrent.setID;\n\n        this.tripsTableAdapter.FillByTripSetID(this.myLeaseDataSet.Trips, settlementCurrentID);\n        MyLeaseDataSet.TripsCurrentDataTable settlementTrips;\n        settlementTrips = myLeaseDataSet.Trips.SOMETHING();\n\n        var totalMiles = settlementTrips.tripLoadedMiles.Sum();\n</code></pre>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":27,"score":5,"question_id":13178656,"title":"AppBarButtonStyle: Changing Content from code","body":"<p>How to change Content of Button which style is AppBarButtonStyle from code-behind? I would like to change an icon and I do it like that:</p>\n\n<pre><code>private void ChangemyButtonIcon()\n{\n   myButton.SetValue(AutomationProperties.NameProperty, \"new text\");\n   myButton.Content = \"&amp;#xE15D;\"; // &lt;--- works wrong\n}\n</code></pre>\n\n<p>but then instead of standard icon inside button text displays.</p>\n\n<p>Do you know how to do it in right way?\nThank you in advance for help\nMaciek</p>\n"},{"tags":["c#","dependency-injection","unity"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13275826,"title":"Unity named mapping issue","body":"<p>I have two implementations of <code>IEmailService</code>, one for testing and one for live (is-A). And I have a <code>BusinessService</code> that has-A <code>IEmailService</code> reference. </p>\n\n<pre><code>BusinessService\n    IEmailService (has-A)\n\nIEmailService\n    TestEmailService (is-A)\n    LiveEmailService (is-A)\n</code></pre>\n\n<p>In unity config, I register the two <code>IEmailService</code> implementations as follows. </p>\n\n<pre><code>&lt;unity xmlns=\"http://schemas.microsoft.com/practices/2010/unity\"&gt;\n&lt;container&gt;\n  &lt;register type=\"DataAccess.IEmailService, DataAccess\"\n            mapTo=\"DataAccess.LiveEmailService, DataAccess\"\n            name=\"Live\"&gt;\n    &lt;lifetime type=\"singleton\" /&gt;\n  &lt;/register&gt;\n  &lt;register type=\"DataAccess.IEmailService, DataAccess\"\n            mapTo=\"DataAccess.TestEmailService, DataAccess\"\n            name=\"Test\"&gt;\n    &lt;lifetime type=\"singleton\" /&gt;\n  &lt;/register&gt;\n&lt;container&gt;\n&lt;/unity&gt;\n</code></pre>\n\n<p>Based on the <code>appSetting</code> for <code>IEmailService</code> I want Unity to pick the correct implementation. This will help while testing. </p>\n\n<pre><code>&lt;appSettings&gt;\n    &lt;add key=\"IEmailService\" value=\"Test\"/&gt;\n&lt;/appSettings&gt;\n</code></pre>\n\n<p>The issue is when unity resolves <code>BusinessService</code>, it tries to resolve <code>(none)</code> named mapping of <code>IEmailService</code> instead of <code>Live</code> or <code>Test</code> and throws an <code>ResolutionFailedException</code>.</p>\n\n<p><code>container.Resolve&lt;BusinessService&gt;();</code> throws below exception:</p>\n\n<pre><code>BusinessServices.Test.BusinessServiceTest_Integration.Test103:\n\nMicrosoft.Practices.Unity.ResolutionFailedException : Resolution of the dependency failed, type = \"BusinessServices.BusinessService\", name = \"(none)\".\nException occurred while: while resolving.\nException is: InvalidOperationException - The current type, DataAccess.IEmailService, is an interface and cannot be constructed. Are you missing a type mapping?\n-----------------------------------------------\nAt the time of the exception, the container was:\n\n  Resolving BusinessServices.BusinessService,(none)\n  Resolving parameter \"emailService\" of constructor BusinessServices.BusinessService(DataAccess.IEmailService emailService)\n    Resolving DataAccess.IEmailService,(none)\n\n  ----&gt; System.InvalidOperationException : The current type, DataAccess.IEmailService, is an interface and cannot be constructed. Are you missing a type mapping?\n</code></pre>\n\n<p>The workaround I came up with is to specify the registrations in code as well and have a wrapper method around <code>container.RegisterType</code> to register <code>IEmailService</code> with <code>(none)</code> named mapping as well based on the <code>appSetting</code> value. </p>\n\n<pre><code>IUnityContainer container;\n\n// registering unity\nstatic void Load()\n{\n    container = new UnityContainer().LoadConfiguration();\n\n    RegisterType&lt;IEmailService, TestEmailService&gt;(\"Test\");\n    RegisterType&lt;IEmailService, LiveEmailService&gt;(\"Live\");\n}\n\n// register the `Test` or `Live` implementation with `(none)` named mapping as per appSetting\nstatic void RegisterType&lt;TFrom, TTo&gt;(string name) \n    where TTo : TFrom\n{\n    var tFromAppSetting= ConfigurationManager.AppSettings[typeof(TFrom).Name];\n    if (!string.IsNullOrEmpty(tFromAppSetting) &amp;&amp; tFromAppSetting == name)\n        container.RegisterType&lt;TFrom, TTo&gt;();\n}\n</code></pre>\n\n<p>This works, but I end up specifying the registrations in two places - config as well as code. Is there a better way for doing this?</p>\n"},{"tags":["c#","xaml","windows-phone-8"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13276136,"title":"Where is ProgressRing Control?","body":"<p>I am trying to write a Windows Phone 8 SDK-based application.  I keep seeing mention of a ProgressRing control but I don't see it in the Toolbox or in the xaml designer.</p>\n\n<p>How do I use this?</p>\n"},{"tags":["c#","asp.net","application-name"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13270089,"title":"c# How to get a meaninful name of website or executable","body":"<p>We have an internal error reporting system (inside our functions dll) and one of the info pieces we send is the name of the application that caused it. </p>\n\n<p>Current code:</p>\n\n<pre><code>string applicationname= Assembly.GetCallingAssembly().GetName().Name;\n</code></pre>\n\n<p>The problem is when the error is send from one of our websites as it sends application names like \"App_Code.6p_c415d\".</p>\n\n<p>One possible way was determining if the app is an executable or a website dinamically (how do we do that?) and in the case of being a website get the folder containing it or so...</p>\n\n<p>But if you have better ways we are open to any idea ^^</p>\n"},{"tags":["c#","domain-driven-design"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13277306,"title":"DDD: Object Id must be 0 before inserting in database","body":"<p>I am trying to learn DDD, and i am making a simple demo project.</p>\n\n<p>Right now, i have a generic repository</p>\n\n<pre><code>public class Repository&lt;T&gt; where T : class, IAggregateRoot\n{\n    public void Add(T entity)\n    {\n        ObjectSet.AddObject(entity);\n    }\n}\n</code></pre>\n\n<p>and a <code>Product</code> class</p>\n\n<pre><code>public class Product : IAggregateRoot\n{\n    private Guid _id = Guid.Empty;\n    public Guid Id\n    {\n        get { return _id; }\n        private set { _id = value; }\n    }\n    public string Name { get; private set; }\n\n    protected Product() { }\n    public Product(string name)\n    {\n        Name = name;\n    }\n}\n</code></pre>\n\n<p>The idea is that i want that a Product which has been created to have an empty Guid. It should get a new Guid only when is inserted into databse.</p>\n\n<pre><code>Product product = new Product(\"Hello World\");\nproduct.Id == Guid.Empty; // True\n</code></pre>\n\n<p>How is right now, when i call the repository to insert a product, it inserts it in database with an empty Guid.</p>\n\n<pre><code>var repository = new Repository&lt;Product&gt;();\nrepository.Add(product);\n</code></pre>\n\n<p>Where should i put the Guid generation of the Product? In the repository? If yes, how should i do it, because i have a generic repository.</p>\n\n<p>Thank you</p>\n"},{"tags":["c#","string"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":55,"score":0,"question_id":13277517,"title":"Replace all single quotes with two single quotes in a string","body":"<p>I am trying to read value from DB using c#.\nThe query string contains multiple single quotes - such as: Esca'pes' (the query strings are being read from a text file)</p>\n\n<p>So, I wanted to replace all the single quotes with two single quotes before forming the SQL query. My code is as below:</p>\n\n<pre><code>if (name.Contains('\\''))\n{\n    name = name.Replace('\\'','\\''');  \n}\n</code></pre>\n\n<p>How to fix this?</p>\n"},{"tags":["c#","database","idisposable"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":13049784,"title":"Whats the correct way to dispose table adapters and data sets?","body":"<p>I've been working on a project that uses table adapters and datasets to access an access database. I'm near completion and ran code analysis from visual studio and it came up with some errors about needing to implement IDisposable on specific classes that I use these methods. While I've looked at a few different things on this about having a dispose method or using a using block, I'm not really sure how to make this work. The dataset and table adapters are created as global variables to be used by the whole class, many classes will call on other classes which will also use different table adapters and datasets. I've tried creating a Dispose method, but I don't know when to call it and I am wondering if it is called at the wrong time will it crash my program. Here is a sample of one of the classes that I need to implement Idisposable :</p>\n\n<pre><code>   using System;\n   using System.Collections.Generic;\n   using System.Linq;\n    using System.Text;\n\n namespace recipeDataBase \n {\n     class NewRecipe : IDisposable\n     {\n         recipiesNewDataSet recipeDataSet = new recipiesNewDataSet();\n         recipiesNewDataSetTableAdapters.RecipeTableAdapter recipeTableAdapter = new      recipiesNewDataSetTableAdapters.RecipeTableAdapter();\n    recipiesNewDataSetTableAdapters.RecipeIngredientTableAdapter recipeIngredientTableAdapter = new recipiesNewDataSetTableAdapters.RecipeIngredientTableAdapter();\n    recipiesNewDataSetTableAdapters.RatingTableAdapter ratingTableAdapter = new recipiesNewDataSetTableAdapters.RatingTableAdapter();\n    recipeDataBase.recipiesNewDataSetTableAdapters.IngredientTableAdapter ingredientTableAdapter = new recipiesNewDataSetTableAdapters.IngredientTableAdapter();\n    private RecipeInfo newRecipe;\n    private RatingNum originalRatingNum;\n    private RatingNum newRating;\n    private RecipeInfo originalRecipe;\n    private string[] ingredients;\n\n    public NewRecipe(RecipeInfo incommingNewRecipe, RatingNum IncommingNewRating, string[] incommingIngredients)\n    {\n        newRecipe = incommingNewRecipe;\n        newRating = IncommingNewRating;\n        ingredients = incommingIngredients;\n        CreateNewRecipe();\n        UpdateNewRecipe();\n    }\n    public void CreateNewRecipe()\n    {\n        originalRatingNum = new RatingNum();\n        originalRecipe = new RecipeInfo();\n        originalRatingNum.cookingTime = 0;\n        originalRatingNum.easeOfCooking = 0;\n        originalRatingNum.familyRating = 0;\n        originalRatingNum.healthRating = 0;\n        originalRatingNum.userRating = 0;\n\n        ratingTableAdapter.Fill(recipeDataSet.Rating);\n        ratingTableAdapter.Insert(originalRatingNum.userRating, originalRatingNum.familyRating, originalRatingNum.healthRating, originalRatingNum.easeOfCooking, originalRatingNum.cookingTime);\n        Query getNewRecipeNumbers = new Query();\n        int newRatingNumber = getNewRecipeNumbers.newRatingNum();\n\n\n\n        originalRatingNum.ratingNum = newRatingNumber;\n        newRating.ratingNum = newRatingNumber;\n        newRecipe.ratingNum = newRatingNumber;\n        originalRecipe.recipeName = \"newRecipe\";\n        originalRecipe.nationality = \"newRecipe\";\n        originalRecipe.recipeEvent = \"newRecipe\";\n        originalRecipe.source = \"newRecipe\";\n        originalRecipe.type = \"newRecipe\";\n        originalRecipe.servings = \"0\";\n        originalRecipe.ratingNum = newRatingNumber;\n\n\n        recipeTableAdapter.Fill(recipeDataSet.Recipe);\n        recipeTableAdapter.Insert(originalRecipe.recipeName, originalRecipe.nationality, originalRecipe.recipeEvent, originalRecipe.source, originalRecipe.type, originalRecipe.servings, originalRecipe.ratingNum); \n        int newRecipeNum = getNewRecipeNumbers.newRecipeNum();\n        newRecipe.recipeNum = newRecipeNum;\n        originalRecipe.recipeNum = newRecipeNum;\n        recipeDataSet.AcceptChanges();\n    }\n\n    public void UpdateNewRecipe()\n    {\n        UpdateRatingNum updateRatingNum = new UpdateRatingNum(originalRatingNum, newRating);\n        UpdateRecipe updateRecipe = new UpdateRecipe(newRecipe, originalRecipe);\n\n        UpdateIngredients updateIngredients = new UpdateIngredients(ingredients);\n        UpdateRecipeIngredient updateRecpeIngredients = new UpdateRecipeIngredient(ingredients, newRecipe.recipeNum);\n        recipeDataSet.AcceptChanges();\n\n    }\n\n\n    public void Dispose()\n    {\n        ratingTableAdapter.Dispose();\n        recipeTableAdapter.Dispose();\n        recipeTableAdapter.Dispose();\n        ingredientTableAdapter.Dispose();\n        recipeDataSet.Dispose();\n        throw new NotImplementedException();\n    }\n}\n</code></pre>\n\n<p>}</p>\n\n<p>As you can see I did implement Idisposable and used the automatically created method to put all of the table adapters and dataset in there to be disposed, but how do I use it and where?</p>\n\n<p>Thanks for the help</p>\n\n<p>Craig</p>\n"},{"tags":["c#","wcf","logging"],"answer_count":5,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":4935,"score":4,"question_id":1927975,"title":"Best way to log errors in WCF","body":"<p>What's the best way to catch and log errors when developing a WCF service layer, and why?</p>\n\n<p>I can think of three ways,</p>\n\n<p>1) Manual try/catches around each method.</p>\n\n<p>2) Leave the responsibility to the WCF engine.</p>\n\n<p>3) Use a third party library such as Enterprise Library Policy Injection/Logging.</p>\n"},{"tags":["c#","wcf","web-services","logging"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":589,"score":3,"question_id":7328743,"title":"log soap request and response from Wcf web service to a text file using log4net","body":"<p>Is there there any simple way of getting a WCF Service to log SOAP requests and responses to a text file.</p>\n\n<p>I want to log the messages on server, just to clarify.</p>\n"},{"tags":["c#","asp.net","css"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":24,"score":3,"question_id":13275487,"title":"Making a div format properly next to a img in asp.net","body":"<p>Hi i made a user control that is a image and a div. When i hover over the image the div appears. I am having problems getting the div to be next to the image in the right place. I want to be able to have the div position itself dynamically so if the image is placed on the left or right it will be on the side that is of screen. </p>\n\n<p>Here is the code </p>\n\n<pre><code>    &lt;a id=\"&lt;%=this.ClientID%&gt;_helpButton\" href=\"#\" onclick=\"popUp('FeedBack.aspx?helpID=', 'feedback')\"\nonmouseover=\"unhidden('&lt;%=this.ClientID%&gt;_div1', '&lt;%=this.ClientID%&gt;_ShowMore', '&lt;%=this.ClientID%&gt;_helpButton')\"\nonmouseout=\"unhidden('&lt;%=this.ClientID%&gt;_div1', '&lt;%=this.ClientID%&gt;_ShowMore', '&lt;%=this.ClientID%&gt;_helpButton')\"\nstyle=\"top: 50%; left: 50%;\"&gt;\n&lt;img src=\"help.gif\" alt=\"Help Button\" style=\"border: 0\" /&gt;&lt;/a&gt;\n\n    &lt;div id=\"&lt;%=this.ClientID%&gt;_div1\" class=\"helper\" style=\"visibility: hidden; border: 3px solid black;\nbackground-color: Gray; width: 40%; height: auto; word-wrap: break-word; position: absolute;\"&gt;\n&lt;asp:Literal ID=\"Literal1\" runat=\"server\" Text=\"\" /&gt;\n&lt;br /&gt;\n&lt;a id=\"link1\" onclick=\"displayMore('&lt;%=this.ClientID%&gt;_ShowMore')\" href=\"#\"&gt;more\n&lt;/a&gt;\n&lt;div id=\"&lt;%=this.ClientID%&gt;_ShowMore\" style=\"visibility: hidden;\" class=\"helper2\"&gt;\n    &lt;asp:Literal ID=\"helpText1\" runat=\"server\" Text=\"\" /&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["c#",".net","xml","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13260131,"title":"How to parse XML header and nested sections using LINQ","body":"<pre><code>XElement documentRoot = XElement.Parse(@\"&lt;OrdersReport Date='2012-08-01'&gt;\n                &lt;SettingHeader&gt;\n                  &lt;SettingId&gt;1&lt;/SettingId&gt;\n                &lt;/SettingHeader&gt;\n                  &lt;Client&gt;\n                    &lt;ClientId&gt;1&lt;/ClientId&gt;\n                    &lt;Orders&gt;\n                      &lt;Order&gt;\n                        &lt;OrderNumber&gt;1&lt;/OrderNumber&gt;\n                        &lt;ShipAddress&gt;123 Main St.&lt;/ShipAddress&gt;\n                        &lt;ShipCity&gt;MyCity&lt;/ShipCity&gt;\n                        &lt;ShipState&gt;AZ&lt;/ShipState&gt;\n                      &lt;/Order&gt;\n                      &lt;Order&gt;\n                        &lt;OrderNumber&gt;2&lt;/OrderNumber&gt;\n                        &lt;ShipAddress&gt;111 Main St.&lt;/ShipAddress&gt;\n                        &lt;ShipCity&gt;OtherCity&lt;/ShipCity&gt;\n                        &lt;ShipState&gt;AL&lt;/ShipState&gt;\n                      &lt;/Order&gt;\n                      &lt;OrderCancelled&gt;\n                        &lt;OrderNumber&gt;3&lt;/OrderNumber&gt;\n                        &lt;ShipAddress&gt;222 Main St.&lt;/ShipAddress&gt;\n                        &lt;ShipCity&gt;CancelledCity&lt;/ShipCity&gt;\n                        &lt;ShipState&gt;AL&lt;/ShipState&gt;\n                      &lt;/OrderCancelled&gt;\n                    &lt;/Orders&gt;\n                    &lt;Returns&gt;\n                      &lt;Amount&gt;\n                        &lt;OrderId&gt;2&lt;/OrderId&gt;\n                        &lt;OrderId&gt;3&lt;/OrderId&gt;\n                        &lt;OrderId&gt;21&lt;/OrderId&gt;       \n                      &lt;/Amount&gt;\n                    &lt;/Returns&gt;\n                  &lt;/Client&gt;\n                  &lt;Client&gt;\n                    &lt;ClientId&gt;2&lt;/ClientId&gt;    \n                  &lt;/Client&gt;\n                &lt;/OrdersReport&gt;\");\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>        var orders = documentRoot.Descendants(\"Order\")\n                       .Concat(documentRoot.Descendants(\"OrderCancelled\"))\n                       .Select(x =&gt; new\n                       {\n                           OrderNumber = (int)x.Element(\"OrderNumber\"),\n                           ShipAddress = (string)x.Element(\"ShipAddress\"),\n                           ShipCity = (string)x.Element(\"ShipCity\"),\n                           ShipState = (string)x.Element(\"ShipState\")\n                       });\n\n        foreach (var o in orders)\n        {\n            Console.WriteLine(o.OrderNumber + \" \" + o.ShipAddress + \" \" \n                + o.ShipCity);\n        }\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1 123 Main St. MyCity\n2 111 Main St. OtherCity\n3 222 Main St. CancelledCity\n3 222 Main St. CancelledCity\n</code></pre>\n\n<p>How do I append <em>ClientId</em> and <em>SettingId</em> like the below output?</p>\n\n<p>Target output:</p>\n\n<pre><code>1 123 Main St. MyCity ClientId 1 SettingId 1\n2 111 Main St. OtherCity ClientId 1 SettingId 1\n...\n</code></pre>\n"},{"tags":["c#",".net","xml","xml-serialization"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13262551,"title":"Generic type serialization with two similarly named generic arguments","body":"<p>I would like to be able to serialize a generic type against several different entities using the C# XmlSerializer. For example i want to serialize:</p>\n\n<pre><code>GenericThing&lt;MyApp.A&gt; and GenericThing&lt;MyApp.B&gt;\n</code></pre>\n\n<p>This all works well until i have something like the following:</p>\n\n<pre><code>GenericThing&lt;MyApp.A.Entity&gt; and GenericThing&lt;MyApp.B.Entity&gt;\n</code></pre>\n\n<p>Because these two classes have the same name the serializer cant differentiate between the two entities and attempts to serialize both to <code>GenericThingOfEnitity</code>.</p>\n\n<p>Is there a way of decorating <code>GenericThing</code> so that it is more specific about its generic argument during serialization (ie serializes to <code>GenericThingOfMyApp.B.Enitity</code> or similar)? I unfortunately don't have control over either <code>MyApp.A</code> or <code>MyApp.B</code></p>\n"},{"tags":["c#","crash","windows-8","crash-reports","windows-store-apps"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13224661,"title":"Windows Store app crashes, quality reports, and CEIP","body":"<p>Microsoft's Antoine Leblond <a href=\"http://blogs.msdn.com/b/windowsstore/archive/2012/06/27/improving-apps-with-quality-reports.aspx\" rel=\"nofollow\">discusses here</a> how the Windows Store dashboard shows app crashes, which is nice.</p>\n\n<p>Separately, Microsoft has <a href=\"http://technet.microsoft.com/en-us/library/jj618322.aspx\" rel=\"nofollow\">an article</a> that talks about their Windows Customer Experience Improvement (CEIP) system, noting that CEIP is turned off by default in Windows 8. However, the article also says this:</p>\n\n<blockquote>\n  <p>When Windows 8 is installed and the computer is started for the first\n  time, the Initial Configuration Tasks dialog box appears. Accepting\n  the default recommendations for Initial Configuration Tasks turns on\n  the Customer Experience Improvement Program</p>\n</blockquote>\n\n<p>That to me indicates that most users will probably accept the default and CEIP will be turned on in most people's installs.</p>\n\n<p>So my main question is: <strong>Are the quality reports in the Windows Store dashboard done through CEIP, or is CEIP bypassed and the reports are always sent for Windows Store apps?</strong></p>\n\n<p>Kind of related, do these quality reports work and send stack traces for C# apps as well as C++ apps?</p>\n"},{"tags":["c#",".net","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":63,"score":0,"question_id":13266324,"title":"accessing database","body":"<p>Here is my problem; I have a hosted and published database on godaddy servers. I have also published my website. However, when I tried to use one of visual studio's tools such as chart, or data view or any tool that wants me to specify a data source, I get the </p>\n\n<pre><code>\"error 40: could not open a connection to sql server\".\n</code></pre>\n\n<p>In most cases, I have worked around this issue by writing the code instead of using these tools on the \".cs\" sections, but now I need to update my database model and I really would prefer not to write that amount of code. The connection string I choose works perfectly, it can update and gather values from database on the published website. But when I Right click on the models section and select \"update model from database\" the update wizard cannot access the database with the very same connection string. Like I said, this problem occurs on every tool that wants me to select a data source.</p>\n\n<p>Is this a permission issue regarding visual studio or something else? \nThanks in advance.</p>\n"},{"tags":["c#",".net","string","script#"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":42,"score":2,"question_id":13260153,"title":"Using Script# code with string operations in standart C# .NET project","body":"<p>I added reference of Script# to my standart console application. After that I was trying to invoke some method from there but was getting the following error:</p>\n\n<p><img src=\"http://i.stack.imgur.com/uSDdc.png\" alt=\"MissingMethodException\"></p>\n\n<p>I suppose it happened on the following line:</p>\n\n<pre><code>string[] lines = s.Split(';');\n</code></pre>\n\n<p>My assumption is that usual <strong>mscorlib</strong> library has not method <code>public string[] Split(char separator)</code>, but has <code>public string[] Split(params char[] separator)</code></p>\n\n<p>Is it possible to write valid code with such string operations both for a Script# project and for a standart C# .NET project? Due to this problem I have to write duplicate code for both projects with minimal difference.</p>\n\n<p><strong>P.S.</strong> I tried to use assemblty binding redirects, as discussed in <a href=\"http://stackoverflow.com/q/8104853/1046374\">this SO</a> question, but it didn't help me.</p>\n"},{"tags":["c#","listbox","margin"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13277097,"title":"How can I programmatically change a listbox margin?","body":"<p>I am trying to change the margin around a set of programmatically generated listboxes using the following code:</p>\n\n<pre><code>newListBox.Margin = new Thickness(0, 0, 0, 0);\n</code></pre>\n\n<p>However this gives me the error:</p>\n\n<pre><code>the type or namespace Thickness could not be found\n</code></pre>\n\n<p>I tried adding <code>using System.Windows</code> namespace but I still get the same error. Can anyone help please?</p>\n"},{"tags":["c#","button","numericupdown"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13276444,"title":"How do I disable a button when the value in the NumericUpDown control is greater than a certain number?","body":"<p>The button only disables after I click on it. I want it to disable without any interaction as soon as the value in the NumericUpDown control is incremented above a specific point. I have goggled but found no answers, here is my code:             </p>\n\n<pre><code>    private void mybtn_Click(object sender, EventArgs e)\n    {            \n        if (numericud.Value &gt; myArray[r, c] || myArray[r, c] == 0)\n            DisableButton(mybtn);            \n        myArray[r, c] = CalcNewMax(myArray[r, c]);\n        OpenNewForm();\n    }\n\n    private void DisableButton(Button selectedbtn)\n    {\n        selectedbtn.Enabled = false;\n    }\n</code></pre>\n\n<p>Any help is much appreciated, thanks!</p>\n"},{"tags":["c#","asp.net","webcontrols"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13277012,"title":"Casting string to Web Control and targeting variable in container","body":"<p>Using VWD 2010 C#. Default.aspx(.cs).<br>\nWhats to happen: A button changes the color of a label with <code>ID = \"Day31\"</code>.\nGiven that it is the 31st day of the month for this example.\nThe button and label are positioned inside a table inside \"MainContent\".</p>\n\n<pre><code>protected void Red_Click(object sender, EventArgs e)\n{\n    ContentPlaceHolder MainContent = Page.Master.FindControl(\"MainContent\") as   ContentPlaceHolder;\n    int theday;\n    theday = System.DateTime.Now.Day; // example the day is 31st\n    string str=\"Day\"+theday;\n    ClientScript.RegisterStartupScript(this.GetType(), \"myalert\", \"alert('\" + str+ \"');\", true);\n    Label dayLabel = FindControl(str) as Label;\n\n    dayLabel.BackColor = System.Drawing.Color.Red; // this line error, \"Null\"\n}\n</code></pre>\n\n<p>Question: Why is there a <code>Null</code> error message at this line of code?</p>\n"},{"tags":["c#","wpf","progress-bar"],"answer_count":3,"favorite_count":5,"up_vote_count":9,"down_vote_count":0,"view_count":9972,"score":9,"question_id":1194620,"title":"How do I display progress during a busy loop?","body":"<p>I'm working in C# and WPF, very new to both. </p>\n\n<p>I have a loop that reads plenty of data from an external source. The process takes about 20 seconds, and I want to show the progress to the user. I don't need any fancy progress bars, so I chose to plot my progress in a label that will say \"Step 1/1000\", then change to \"Step 2/1000\" etc.</p>\n\n<p>My code looks something like this:</p>\n\n<pre><code>// \"count\" is the number of steps in the loop, \n// I receive it in previous code\n\nString countLabel = \"/\"+count.ToString();\n\nfor (i = 0; i &lt; count; i++)\n{\n    ... do analysis ...\n    labelProgress.Content = \"Step \"+i.ToString()+countLabel\n}\n</code></pre>\n\n<p>However, during that analysis the screen is \"stuck\" and the progress does not show as advancing. I understand this behavior from my past in C++, where I would probably have a separate thread showing a progress bar receiving notifications from the loop, or some form of repaint/refresh, or forcing the window/app to process its message queue.</p>\n\n<p>What's the right way to do it in C#? I'm not tied to the label, so if there's a simple progress-bar popup screen I could use instead of this label it would also be great...</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","gui","user-interface","windows-7"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13277319,"title":"Disabling windows 7 interface shadows","body":"<p>Is there any method to disable the shadow under a window in my application via C#? I searched on Internet but nothing helps me...</p>\n"},{"tags":["c#","constructor","arguments"],"answer_count":10,"favorite_count":0,"up_vote_count":7,"down_vote_count":1,"view_count":110,"score":6,"question_id":13260021,"title":"Why am I getting a \"does not contain a constructor that takes 0 arguments\" error? C#","body":"<p>On my form load, I have this code:</p>\n\n<pre><code>    private void Form1_Load(object sender, EventArgs e)\n    {\n        CharityCyclists cyclist1 = new CharityCyclists();\n        CharityCyclists cyclist2 = new CharityCyclists(\"a\", 1, \"Finished\", 0, 0, 0, \"One Wheel\", 1, 500);\n\n        cyclist1.Type = \"Novelty Charity Cyclist\";\n        cyclist1.Number = 1;\n        cyclist1.Finished = \"Not Finished\";\n        cyclist1.Hours = 0;\n        cyclist1.Mins = 0;\n        cyclist1.Secs = 0;\n        cyclist1.Bicycle = \"Tricycle\";\n        cyclist1.Wheels = 3;\n        cyclist1.FundsRaised = 300;\n    }\n</code></pre>\n\n<p>However, I'm getting a error saying \"'CycleEvent.CharityCyclists' does not contain a constructor that takes 0 arguments\", it says the error is to do with this part of the code:</p>\n\n<pre><code>CharityCyclists cyclist1 = new CharityCyclists();\n</code></pre>\n\n<p>Here is my CharityCyclists class:</p>\n\n<pre><code>class CharityCyclists : Cyclists\n{\n    private string bicycle;\n    private int wheels;\n    private double fundsRaised;\n\n    public string Bicycle\n    {\n        get { return bicycle; }\n        set { bicycle = value; }\n    }\n\n    public int Wheels\n    {\n        get { return wheels; }\n        set { wheels = value; }\n    }\n\n    public double FundsRaised\n    {\n        get { return fundsRaised; }\n        set { fundsRaised = value; }\n    }\n\n    public CharityCyclists(String type, int number, String finished, int hours, int mins, int secs, string bicycle, int wheels, double fundsRaised) : base(type, number, finished, hours, mins, secs, fundsRaised)\n    {\n        this.bicycle = bicycle;\n        this.wheels = wheels;\n        this.FundsRaised = fundsRaised;\n    }\n\n    public override string ToString()\n    {\n        return base.ToString() + \" riding a \" + bicycle + \" with \" + wheels + \" wheels\" ;\n    }\n}\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["c#","algorithm","image","hardware","autofocus"],"answer_count":4,"favorite_count":6,"up_vote_count":10,"down_vote_count":0,"view_count":2082,"score":10,"question_id":4224817,"title":"Autofocus algorithm for USB microscope","body":"<p>I'm trying to design an auto-focus system for a low cost USB microscope. I have been developing the hardware side with a precision PAP motor that is able to adjust the focus knob in the <a href=\"http://www.dealextreme.com/details.dx/sku.29661\" rel=\"nofollow\">microscope</a>, and now I'm in the hard part.</p>\n\n<p>I have been thinking about how to implement the software. The hardware have two USB ports, one for the microscope camera and another for the motor. My initial idea is to write an application in C# that is able to get the image from the microscope and to move the motor forth and backwards, so far so good :)</p>\n\n<p>Now I need a bit of help with the auto-focus, how to implement it? There is any good algorithm for this? Or maybe an image processing library that will help my in my task?</p>\n\n<p>I have been googleling but with no success... I'll appreciate any help/idea/recommendation!</p>\n\n<p>Many thanks :) </p>\n\n<p><strong>EDIT:</strong> Thanks guys for your answers, i'll try all the options and get back here with the results (or maybe more questions).</p>\n"},{"tags":["c#","php","asp.net-mvc","drupal","authentication"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13277128,"title":"Single authentication with Drupal and ASP.NET","body":"<p>I'm an experienced C# developer with a small amount of PHP experience.  I am looking at getting a Drupal instance up and running, but, I will need an ASP.NET instance running along with it since there is going to be custom development work that needs to be done.</p>\n\n<p>I was wondering if anyone had ideas for how to combine authentication for Drupal and ASP.NET so that I don't need to make users authenticate more than once while using the two sites together.</p>\n"},{"tags":["c#","xaml","controls","microsoft-metro"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13276715,"title":"update control on another page windows 8 metro app c#","body":"<p>This is a basic process that I cannot find any info on in Google or reference books on my Kindle account.</p>\n\n<p>In regular forms applications pre-Windows 8, if you are on form 2 and you want to update something on form 1, you just type:</p>\n\n<pre><code>form1.Default.controlOnForm1.text = \"updated text\";\n</code></pre>\n\n<p>This does not work in Windows 8.  </p>\n\n<p>I feel silly asking this, but I have lots of info I need to send across my app.</p>\n\n<p>Thank you.  </p>\n"},{"tags":["c#","wpf","data-binding","memory-leaks"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13275183,"title":"Memory leak caused by ItemsControl's items not released","body":"<p>I am facing a pretty annoying problem on my WPF/MVVM application:\nBasically, I have an <code>ItemsControl</code> object with a variable <code>ItemsSource</code>. \nThe source is an <code>IList&lt;DateTime&gt;</code>, and the result will be an <code>ItemsControl</code> creating one chart for each date in the source.</p>\n\n<p>This simple case creates a big problem in my application: the one we all fear about, the one we all make nightmares about: <strong>the unfamous Memory Leak :-(</strong></p>\n\n<p>The scenario here is VERY basic: Let's assume my <code>ItemsSource</code> has two items. The <code>ItemsControl</code> will create two charts accordingly. Now, the <code>ItemsSource</code> is changed to <code>null</code> => <code>ItemsControl</code> is cleared, and a new <code>ItemsSource</code> is initialized with, say 3 components. The <code>ItemsControl</code> will create 3 charts.\nThe problem? The 2 previous charts still exist in memory! So when I changed a databound property for a chart (for example the scale), it will update the 5 charts, including the two which were supposed to be cleared.</p>\n\n<p>So what basically happens is... if one of my clients uses the application for two hours, and updates this control many times, the app will end up updating stuff for 500 different charts => it gets extremely long</p>\n\n<p>I read a lot about memory leaks caused by DataBinding and tried to avoid it as much as possible. Thus, all of the databound properties implement <code>INotifyPropertyChanged</code> as advised by <a href=\"http://support.microsoft.com/kb/938416\" rel=\"nofollow\">this kb article</a></p>\n\n<p>Here is the guilty code:</p>\n\n<p><strong>The control's XAML code:</strong></p>\n\n<pre><code>&lt;Grid&gt;\n    &lt;ScrollViewer VerticalScrollBarVisibility=\"Auto\"&gt;\n        &lt;ItemsControl x:Name=\"graphContainer\"&gt;\n            &lt;ItemsControl.Resources&gt;\n                &lt;conv:MaturityToDateTimeConverter x:Key=\"MaturityToDateTimeConverter\" /&gt;\n                &lt;conv:ImpliedForwardsOnMaturityConverter x:Key=\"ImpliedForwardsOnMaturityConverter\" /&gt;\n            &lt;/ItemsControl.Resources&gt;\n            &lt;ItemsControl.ItemsPanel&gt;\n                &lt;ItemsPanelTemplate&gt;\n                    &lt;WrapPanel Background=\"#808080\" Width=\"{Binding (FrameworkElement.ActualWidth),\n                                    RelativeSource={RelativeSource \n                                    AncestorType={x:Type ItemsControl}}}\"\n                        Margin=\"4\" /&gt;\n                &lt;/ItemsPanelTemplate&gt;\n            &lt;/ItemsControl.ItemsPanel&gt;\n            &lt;ItemsControl.ItemTemplate&gt;\n                &lt;DataTemplate&gt;\n                    &lt;Border BorderBrush=\"Black\" Background=\"#333333\" BorderThickness=\"1\"&gt;\n                        &lt;controls:VolatilityGraph Margin=\"3\"\n                                                  GraphForeground=\"White\"\n                        Height=\"310\" Width=\"395\" \n                        GraphicType=\"Smile\"\n                        ShowAllData=\"{Binding DataContext.DataModel.ShowAllData, UpdateSourceTrigger=PropertyChanged,\n                                            RelativeSource={RelativeSource FindAncestor, \n                                                        AncestorType={x:Type controls:VolatilityCharts}}}\"\n\n                        ShowDifferenceGraph=\"{Binding DataContext.DataModel.ShowDifference, UpdateSourceTrigger=PropertyChanged,\n                                            RelativeSource={RelativeSource FindAncestor, \n                                                        AncestorType={x:Type controls:VolatilityCharts}}}\"\n                        IsModulable=\"False\"\n                        VolatilityMatrices=\"{Binding DataContext.DataModel.VolatilityMatrices, UpdateSourceTrigger=PropertyChanged,\n                                            RelativeSource={RelativeSource FindAncestor, \n                                                        AncestorType={x:Type controls:VolatilityCharts}}}\"\n                        StartingPoint=\"{Binding Converter={StaticResource MaturityToDateTimeConverter}}\"\n                        ShowStartingPointOnly=\"True\"\n                        DisplayedGraphs=\"{Binding DataContext.DataModel.DisplayedGraphs, UpdateSourceTrigger=PropertyChanged,\n                                            RelativeSource={RelativeSource FindAncestor, \n                                                        AncestorType={x:Type controls:VolatilityCharts}}}\"\n                        ColorsDictionary=\"{Binding DataContext.DataModel.ColorsDictionary, UpdateSourceTrigger=PropertyChanged,\n                                            RelativeSource={RelativeSource FindAncestor, \n                                                        AncestorType={x:Type controls:VolatilityCharts}}}\"\n                        BackgroundGraphsColor=\"{Binding DataContext.DataModel.BackgroundGraphsColor, UpdateSourceTrigger=PropertyChanged,\n                                            RelativeSource={RelativeSource FindAncestor, \n                                                        AncestorType={x:Type controls:VolatilityCharts}}}\"\n                        LZGraphsColor=\"{Binding DataContext.DataModel.LZGraphsColor, UpdateSourceTrigger=PropertyChanged,\n                                            RelativeSource={RelativeSource FindAncestor, \n                                                        AncestorType={x:Type controls:VolatilityCharts}}}\"\n                        CurrentStock=\"{Binding DataContext.DataModel.CurrentStock, UpdateSourceTrigger=PropertyChanged,\n                                            RelativeSource={RelativeSource FindAncestor, \n                                                        AncestorType={x:Type controls:VolatilityCharts}}}\"\n                        XMin=\"{Binding DataContext.DataModel.MinStrike, UpdateSourceTrigger=PropertyChanged,\n                                            RelativeSource={RelativeSource FindAncestor, \n                                                        AncestorType={x:Type controls:VolatilityCharts}}}\"\n                        XMax=\"{Binding DataContext.DataModel.MaxStrike, UpdateSourceTrigger=PropertyChanged,\n                                            RelativeSource={RelativeSource FindAncestor, \n                                                        AncestorType={x:Type controls:VolatilityCharts}}}\"\n                        MouseWheelZoomEnabled=\"True\"\n                        MouseDragZoomEnabled=\"True\"\n                        MoveablePointEnabled=\"False\"\n                        &gt;\n                            &lt;controls:VolatilityGraph.Forward&gt;\n                                &lt;MultiBinding Converter=\"{StaticResource ImpliedForwardsOnMaturityConverter}\"&gt;\n                                    &lt;Binding Path=\"DataContext.DataModel.ImpliedForwards\" UpdateSourceTrigger=\"PropertyChanged\"\n                                             RelativeSource=\"{RelativeSource FindAncestor, \n                                                        AncestorType={x:Type controls:VolatilityCharts}}\" /&gt;\n                                    &lt;Binding Path=\".\" /&gt;\n                                    &lt;Binding Path=\"Maturities\" RelativeSource=\"{RelativeSource FindAncestor, \n                                                        AncestorType={x:Type controls:VolatilityCharts}}\" /&gt;\n                                &lt;/MultiBinding&gt;\n                            &lt;/controls:VolatilityGraph.Forward&gt;\n                        &lt;/controls:VolatilityGraph&gt;\n                    &lt;/Border&gt;\n                &lt;/DataTemplate&gt;\n            &lt;/ItemsControl.ItemTemplate&gt;\n        &lt;/ItemsControl&gt;\n\n\n    &lt;/ScrollViewer&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p><strong>The control's code behind:</strong></p>\n\n<pre><code>public partial class VolatilityCharts : UserControl\n    {\n        #region Dependency Properties\n\n        #region Maturities\n\n        /// &lt;summary&gt;\n        /// Maturities list\n        /// &lt;/summary&gt;\n        public static readonly DependencyProperty MaturitiesProperty =\n            DependencyProperty.Register(\"Maturities\",\n                                        typeof(IEnumerable),\n                                        typeof(VolatilityCharts),\n                                        new PropertyMetadata(MaturitiesChanged));\n\n        /// &lt;summary&gt;\n        /// Maturities\n        /// &lt;/summary&gt;\n        /// &lt;value&gt;The Maturities.&lt;/value&gt;\n        public IEnumerable Maturities\n        {\n            get { return (IEnumerable)GetValue(MaturitiesProperty); }\n            set { SetValue(MaturitiesProperty, value); }\n        }\n\n        /// &lt;summary&gt;\n        /// Handler called when the binding on Maturities changed\n        /// &lt;/summary&gt;\n        /// &lt;param name=\"source\"&gt;&lt;/param&gt;\n        /// &lt;param name=\"e\"&gt;&lt;/param&gt;\n        private static void MaturitiesChanged(DependencyObject source, DependencyPropertyChangedEventArgs e)\n        {\n            VolatilityCharts @this = source as VolatilityCharts;\n            @this.LoadCharts();\n        }\n\n        #endregion\n\n        #endregion\n\n        #region Properties\n\n        /// &lt;summary&gt;\n        /// Shortcut to UnderlyingsDataService\n        /// &lt;/summary&gt;\n        public IVolatilityChartsModel DataModel\n        {\n            get;\n            set;\n        }\n\n        #endregion\n\n        #region ctor\n        /// &lt;summary&gt;\n        /// Create a new instance of VolatilityCharts class\n        /// &lt;/summary&gt;\n        public VolatilityCharts()\n        {\n            this.DataContext = this;\n            InitializeComponent();\n        }\n\n        #endregion\n\n        #region charts of smile\n\n        /// &lt;summary&gt;\n        /// Loads the charts.\n        /// &lt;/summary&gt;\n        internal void LoadCharts()\n        {\n            graphContainer.ItemsSource = this.Maturities;\n        }\n        #endregion\n    }\n</code></pre>\n\n<p><strong>And the code generating the control:</strong> <em>(note: this code is called ONLY ONCE, on application startup. I therefore have only one created instance of <code>VolatilityCharts</code> during the program lifetime)</em></p>\n\n<pre><code>    private static VolatilityCharts GenerateAllCharts()\n    {\n        VolatilityCharts charts = new VolatilityCharts();\n        AllChartsViewModel allChartsViewModel = new AllChartsViewModel(DataModel);\n        charts.DataContext = allChartsViewModel;\n        //// Binding maturities\n        Binding maturitiesBinding = new Binding(\"DataModel.ModelMaturities\");\n        maturitiesBinding.UpdateSourceTrigger = UpdateSourceTrigger.PropertyChanged;\n        maturitiesBinding.Mode = BindingMode.OneWay;\n        maturitiesBinding.IsAsync = true;\n\n        charts.SetBinding(VolatilityCharts.MaturitiesProperty, maturitiesBinding);\n\n        return charts;\n    }\n</code></pre>\n\n<p>Does anybody have any idea on how could I fix this problem?</p>\n\n<p>If you have any question please let me know</p>\n\n<p>Thank you!</p>\n"},{"tags":["c#","nhibernate","object","reference-type"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":80,"score":0,"question_id":13274508,"title":"Calling ToString() on a Reference Type","body":"<p>Given two object arrays I need to compare the differences between the two (when converted to a string). I've reduced the code to the following and the problem still exists:</p>\n\n<pre><code>public void Compare(object[] array1, object[] array2) {\n    for (var i = 0; i &lt; array1.Length; i++) {\n        var value1 = GetStringValue(array1[i]);\n        var value2 = GetStringValue(array2[i]);\n    }\n}\n\npublic string GetStringValue(object value) {\n    return value != null &amp;&amp; value.ToString() != string.Empty ?\n        value.ToString() : \"No Value\";\n}\n</code></pre>\n\n<p>The code executes fine no matter what object arrays I throw at it. However if one of the items in the array is a reference type then somehow the reference is updated. This causes issues later.</p>\n\n<p>It appears that this happens when calling ToString() against the object reference. I have updated the GetStringValue method to the following (which makes sure the object is either a value type or string) and the problem goes away.</p>\n\n<pre><code>public string GetStringValue(object value) {\n    return value != null &amp;&amp; (value.GetType().IsValueType || value is string)\n        &amp;&amp; value.ToString() != string.Empty ? value.ToString() : \"No Value\";\n}\n</code></pre>\n\n<p>However this is just a temporary hack as I'd like to be able to override the ToString() method on my reference types and compare them as well.</p>\n\n<p>I'd appreciate it if someone could explain why this is happening and offer a potential solution. Thanks</p>\n\n<p><strong>Edit</strong>:</p>\n\n<p>To help further explain my application. This piece of code is taken from an NHibernate event listener. I think the problem lies from NHibernate adding it's own wrapper around a class to deal with lazy loading. Here's the error it throws:</p>\n\n<blockquote>\n  <p>collection [<em>*</em>] was not processed by flush()</p>\n</blockquote>\n"},{"tags":["c#","asp.net","vb.net","html-agility-pack"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13275576,"title":"How can I use HTMLAgilityPack to download a CSV file?","body":"<p>I have the code to go to a website, login with the hidden fields and cookies and include a browser header so that I appear as a normal user.</p>\n\n<p>Now that I am in the protected content I need to download a csv file that I have found within the document using HTMLAgilityPack.</p>\n\n<p>I would like to grab the csv with HTMLAgilityPack so that I can continue to use the cookies and browser user-agent string already setup.</p>\n\n<p>From what I have read HTMLAgilityPack parses the dom. I would expect a csv file to cause an error and return null. But I have seen vague references of being able to grab the raw data of the page/file requested before it is parsed. If so, that would be the solution but I cannot find how to do that.</p>\n"},{"tags":["c#",".net"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13276944,"title":"System.Web.Helpers can't be loaded on one server, works everywhere else, what could be wrong?","body":"<h2>Exception</h2>\n\n<pre><code>Exception: Could not load file or assembly 'System.Web.Helpers, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040) \n</code></pre>\n\n<h2>Stack Trace</h2>\n\n<pre><code>at MyWebApp.Logic.Managers.ImagesManager.SaveImage(Stream imageFileStream, Site site)\nat MyWebApp.WebSite.Controllers.ImageController.AddGalleryImage(String qqfile, HttpPostedFileBase uploadFile) in \nC:\\Users\\jhr\\Documents\\subversion\\MyProject\\trunk\\MyWebApp.WebSite\\Controllers\\ImageController.cs:line 67\n</code></pre>\n\n<p>Line #67 of <code>ImageController.cs</code></p>\n\n<pre><code>Image image = _imagesManager.SaveImage(fileStream, site);\n</code></pre>\n\n<p><code>ImagesManager</code> is using the class <code>WebImage</code> out of <code>System.Web.Helpers</code>. This works on multiple laptops and a development server, but I can't get it to work on our QA server.</p>\n\n<p><code>System.Web.Helpers.dll</code> with the correct version is the <code>bin</code> directory of my application <strong>just like on the machines where it works</strong>. I am using the same <code>web.config</code> on all the machines as well. </p>\n\n<p>I am copying a working application from one machine to the other, which is supposed to be configured exactly the same, but I get this exception only on one machine.</p>\n\n<h3>What am I missing?</h3>\n"},{"tags":["c#","windows-mobile","windows-mobile-6"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13251177,"title":"How can I know if this method is supported in Windows Mobile?","body":"<p>There are some classes (of the .NET framework 3.5) that contain some methods that are supported in .NET Compact Framework, and some methods that are not supported. There are also some classes that does not exists for the .NET Compact Framework.</p>\n\n<p>For example for the <a href=\"http://msdn.microsoft.com/en-us/library/system.io.file_members%28v=vs.90%29.aspx\" rel=\"nofollow\"><code>System.IO.File</code></a> class, the <code>File.Create</code> function is supported by .NET Compact Framework, but the <code>File.Encrypt</code> function is not.</p>\n\n<p>Another example: the <code>System.IO.File</code> class is supported by .NET Compact Framework, but the <code>System.Diagnostic.StackTrace</code> is not.</p>\n\n<p>I need to tell to the compiler something like this:</p>\n\n<pre><code>#ifdef COMPACT_FRAMEWORK   // I'm compiling this from a smart device project\n\nMyEncryptMethod(\"filename\");\n\n#else // I'm compiling this from a desktop project\n\nFile.Encrypt(\"filename\");\n\n#endif\n</code></pre>\n\n<p>How can I do?<br>\n(The specific version is Windows Mobile 6.1 Professional).</p>\n"},{"tags":["c#","code-contracts"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13276958,"title":"Why whould I want to disable .NET Code Contracts","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3111332/net-4-0-code-contracts-when-to-use-when-are-they-a-waste-of-time\">.net 4.0 Code Contracts. When to use? When are they a waste of time?</a>  </p>\n</blockquote>\n\n\n\n<p>I started to read the full documentation of the .NET Code Contracts and I noticed that you can specify the compiler not to emit the code corresponding to your contracts. But I was wondering WHY someone would want to do that?! I mean, from the documentation, code contracts are about specifying pre / post / invariants about your code.</p>\n\n<p>Looking at another question <a href=\"http://stackoverflow.com/questions/3111332/net-4-0-code-contracts-when-to-use-when-are-they-a-waste-of-time\">.net 4.0 Code Contracts. When to use? When are they a waste of time?</a>, it seems that contracts should guard against invalid state of an object, but then again, why would I want to disable them! In doing so, wouldn't I open the door for a mountain of problems?</p>\n\n<p>Should they be used as business validation, like making sure that a <code>startDate &lt;= endDate</code> or should I use the good old if-then-throw for business? If I disable the code contracts my class could now be in an invalid state.</p>\n\n<p>So my question remains, why would I want to disable code contracts?</p>\n"},{"tags":["c#",".net","expression-blend","blend","expression-blend-4"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":6,"score":1,"question_id":13277135,"title":"Sort Properties of my Control in Expression Blend designer","body":"<p>I created my new Category \"MyCategory\" to store all my Properties of my Control, in design mode (Expression Blend 4), like theses categories:</p>\n\n<p><img src=\"http://i.stack.imgur.com/J4Jsd.png\" alt=\"enter image description here\"></p>\n\n<p>By default, all my properties under my Category are sorted alphabetically. </p>\n\n<p>Is it possible to choose the order ?</p>\n\n<p>Thank you.</p>\n"},{"tags":["c#","xaml","video","windows-store-apps"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13277133,"title":"Play a video on the default media player from a Windows Store App?","body":"<p>I want to implement a function that plays a video in the default media player from a windows store apps that uses Xaml and C#.</p>\n\n<p>I don't want to embed the player I want to open a new window with the default player and tell it to play the selected file.</p>\n\n<p>All the samples that I've found are to create an embedded player or send to a device.</p>\n\n<p>Can anybody help me?\nThanks...</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13276973,"title":"Fisrt line of private void listBox1_SelectedIndexChanged(object sender, EventArgs e) always gets an error","body":"<p>im trying delete an item on a listbox but when I press the button to delete it the first line of the code in the private void listBox1_SelectedIndexChanged(object sender, EventArgs e) gets an error.</p>\n\n<pre><code>private void listBox1_SelectedIndexChanged(object sender, EventArgs e)\n  {\n      textBox1.Text = listBox1.SelectedItem.ToString();   \n  }\n</code></pre>\n\n<p>here is the error\nObject reference not set to an instance of an object.</p>\n"},{"tags":["c#","table","field","resultset"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":29,"score":-1,"question_id":13276832,"title":"How do I check if a ResultTable has a field or not?","body":"<p>So for example:</p>\n\n<pre><code>while(reader.Read())\n{\n   var test = reader[\"NonExistentField\"];\n}\n</code></pre>\n\n<p>That will give me an error. Testing for null (<code>reader[\"NonExistentField\"] == null ?</code>) does the same.</p>\n"},{"tags":["c#","javascript","encryption","rc4-cipher"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":13075326,"title":"RC4 Algorithm: Unable to Encrypt / Decrypt data where client uses Javascript and Server c#","body":"<p>I need to pass encrypted (and base64 encoded) string data between a .NET 4.0 WCF application hosted in IIS (basicHttpBinding) and an internal client application system that uses a JavaScript RC4 algorithm implementation to encrypt / decrypt data. </p>\n\n<p>So far I have not succeeded in sending data encrypted by the client to the server and then decrypting it on the server (or the reverse - where the client decrypts data received from a server response). We have tried a few variations of RC4 algorithms found in JavaScript files on the internet (and also AES).</p>\n\n<p>I have converted the version of the RC4 algorithm the client is using to C# (JavaScript file located at: <a href=\"https://gist.github.com/2185197\" rel=\"nofollow\">https://gist.github.com/2185197</a>). I created an html page to test the JavaScript encrypt / decrypt functionality in a purely client-side manner. This works. Similarly, through unit testing, I have established that the c# Encrypt / Decrypt also works within the .NET WCF service. With these tests, there was no base64 Encoding / Decoding.</p>\n\n<p>Using the c# RC4 algorithm, I can successful handle encryption / decryption of data sent over the wire where the encrypted data is base64 encoded AND where the client is a .NET application (using same C# algorithm implementation class as the server) </p>\n\n<p>I have stepped through the client-side JavaScript (Firebug) and C# (Visual Studio) algorithm line by line, verifying if variable values match. Everything matches except for where code converts an integer value to String (via Char). The result here is inconsistent. Below is the problem line.</p>\n\n<p>Below is the line of code for each implementation.</p>\n\n<p>C#: \nvar charX = Convert.ToChar(26).ToString();</p>\n\n<p>JavaScript:</p>\n\n<p>Var charX = String.fromCharCode(26);</p>\n\n<p>Some visual differences might simply be due to the rendering abilities of Firebug and Visual Studio. [My understanding is that they both should be rendering UTF8 Encoded strings]. I have read that the JavaScript Engine and JavaScript Language differ in their encoding. As such Microsoft has implemented a fix [https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/fromCharCode] that I tried to implement without success. There might be some encoding that I need to implement in the C# code; but as yet have not yet identified </p>\n\n<p>As per the above example for integer value 26, C# code shows a left arrow when the variable value is inspected. The JavaScript shows a white space. For the JavaScript, this is consistent with the tests done via the W3Shools (http://www.w3schools.com/jsref/tryit.asp?filename=tryjsref_fromcharcode)</p>\n\n<p>Do I need to perform some sort of Encoding in the .NET application to ensure that the character handling is consistent in JavaScript v C#?</p>\n\n<p>Thanks in advance.</p>\n\n<p>Below is the JavaScript code:</p>\n\n<pre><code> function rc4(key, str) {\n        var s = [], j = 0, x, res = '';\n        for (var i = 0; i &lt; 256; i++) {\n            s[i] = i;\n        }\n        for (i = 0; i &lt; 256; i++) {\n            j = (j + s[i] + key.charCodeAt(i % key.length)) % 256;\n            x = s[i];\n            s[i] = s[j];\n            s[j] = x;                \n        }\n        i = 0;\n        j = 0;\n        for (var y = 0; y &lt; str.length; y++) {\n            i = (i + 1) % 256;\n            j = (j + s[i]) % 256;\n            x = s[i];\n            s[i] = s[j];\n            s[j] = x;\n\n            //res += String.fromCharCode(str.charCodeAt(y) ^ s[(s[i] + s[j]) % 256]);\n\n            var sx = s[i] + s[j];\n            var ssx =  s[sx % 256];\n            var fromChar1 =str.charCodeAt(y);\n            var fromChar2 = (fromChar1 ^ ssx);\n            var fromChar3 = String.fromCharCode(fromChar2);  //******  PROBLEM LINE *******\n            //var fromChar3 = fixedFromCharCode(fromChar2);                \n            res += fromChar3;\n        }\n        return res;\n    }\n\n    //Fix as per Microsoft\n    //https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/fromCharCode\n     function fixedFromCharCode(codePt) {\n        if (codePt &gt; 0xFFFF) {\n            codePt -= 0x10000;\n            return String.fromCharCode(0xD800 + (codePt &gt;&gt; 10), 0xDC00 + (codePt &amp; 0x3FF));\n        }\n        else {\n            return String.fromCharCode(codePt);\n        }\n    }\n</code></pre>\n\n<p>Below is the c# code:</p>\n\n<pre><code>public class RC4\n{\n    public static string Encrypt(string key, string data)\n    {\n        var s = new List&lt;int&gt;();\n        var j = 0;\n\n        var x = 0;\n        var res = string.Empty;\n\n        for (var i = 0; i &lt; 256; i++)\n        {\n            s.Add(i);\n        }\n\n        for (var i = 0; i &lt; 256; i++)\n        {\n            var unicodeInt01 = ConvertedCharacterToItsUnicodeNumberic(key, i);\n\n            j = (j + s[i] + unicodeInt01) % 256;\n\n            x = s[i];\n            s[i] = s[j];\n            s[j] = x;\n        }\n\n        var f = 0;\n        j = 0;\n        for (var y = 0; y &lt; data.Length; y++)\n        {\n            f = (f + 1) % 256;\n            j = (j + s[f]) % 256;\n            x = s[f];\n            s[f] = s[j];\n            s[j] = x;\n\n            var unicodInt02 = ConvertedCharacterToItsUnicodeNumberic(data, y);\n            var convStringOperationApplied = unicodInt02 ^ s[(s[f] + s[j]) % 256];\n\n            var charX = Convert.ToChar(convStringOperationApplied);   //******  PROBLEM LINE *******\n            var val = new string(charX, 1);\n            res += val;\n\n        }\n\n        return res;\n    }\n\n    private static int ConvertedCharacterToItsUnicodeNumberic(string key, int i)\n    {\n        return key.ElementAt(i % key.Length);\n    }\n\n    public static string Decrypt(string key, string data)\n    {\n        return Encrypt(key, data);\n    }\n}\n</code></pre>\n"},{"tags":["c#",".net","linq","linq-to-entities"],"answer_count":6,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":666,"score":4,"question_id":1689199,"title":"C# - code against a property using the property name as a string","body":"<p>What's the simplest way to code against a property in C# when I have the property name as a string?  For example, I want to allow the user to order some search results by a property of their choice (using LINQ).  They will choose the \"order by\" property in the UI - as a string value of course.  Is there a way to use that string directly as a property of the linq query, without having to use conditional logic (if/else, switch) to map the strings to properties.  Reflection?</p>\n\n<p>Logically, this is what I'd like to do:</p>\n\n<pre><code>query = query.OrderBy(x =&gt; x.\"ProductId\");\n</code></pre>\n\n<p>Update:\nI did not originally specify that I'm using Linq to Entities - it appears that reflection (at least the GetProperty, GetValue approach) does not translate to L2E.</p>\n"},{"tags":["c#","winforms","treeview"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":753,"score":3,"question_id":10362988,"title":"Treeview flickering?","body":"<p>I came to know that by adding TreeView.BeginUpdate will prevent flickering of treeview, but when i added it in to my project all nodes of my treeview disappears, Can any body tell me why it happens, here is the code snippet where i used TreeView.BeginUpdate and TreeView.EndUpdate</p>\n\n<pre><code>  TreeNode treeNode = new TreeNode(\"Windows\");\n        treeView1.Nodes.Add(treeNode);\n        //\n        // Another node following the first node.\n        //\n        treeNode = new TreeNode(\"Linux\");\n        treeView1.Nodes.Add(treeNode);\n        //\n        // Create two child nodes and put them in an array.\n        // ... Add the third node, and specify these as its children.\n        //\n        TreeNode node2 = new TreeNode(\"C#\");\n        TreeNode node3 = new TreeNode(\"VB.NET\");\n        TreeNode[] array = new TreeNode[] { node2, node3 };\n        //\n        // Final node.\n        //\n        treeNode = new TreeNode(\"Dot Net Perls\", array);\n        treeView1.Nodes.Add(treeNode);\n</code></pre>\n"},{"tags":["c#","linq","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13267721,"title":"LINQ Query - Only get Order and MAX Date from Child Collection","body":"<p>I'm trying to get a list that displays 2 values in a label from a parent and child (1-*) entity collection model.  </p>\n\n<p>I have 3 entities:</p>\n\n<ol>\n<li>[<strong>Customer</strong>]: CustomerId, Name, Address, ...  </li>\n<li>[<strong>Order</strong>]: OrderId, OrderDate, EmployeeId, Total, ... </li>\n<li>[<strong>OrderStatus</strong>]: OrderStatusId, StatusLevel, StatusDate, ...</li>\n</ol>\n\n<p>A <strong>Customer</strong> can have MANY <strong>Order</strong>, which in turn an Order can have MANY <strong>OrderStatus</strong>, i.e. \n[<strong>Customer</strong>] 1--* [<strong>Order</strong>] 1--* [<strong>OrderStatus</strong>]</p>\n\n<p>Given a CustomerId, I want to get all of the Orders (just OrderId) and the LATEST (MAX?) OrderStatus.StatusDate for that Order.</p>\n\n<p>I've tried a couple of attempts, but can seem to get the results I want.</p>\n\n<pre><code>private IQueryable&lt;Customer&gt; GetOrderData(string customerId)\n{\n     var ordersWithLatestStatusDate = Context.Customers\n\n     // Note: I am not sure if I should add the .Expand() extension methods here for the other two entity collections since I want these queries to be as performant as possible and since I am projecting below (only need to display 2 fields for each record in the IQueryable&lt;T&gt;, but thinking I should now after some contemplation.\n\n     .Where(x =&gt; x.CustomerId == SelectedCustomer.CustomerId)\n     .Select(x =&gt; new Custom \n     {\n         CustomerId = x.CustomerId,\n         ...\n         // I would like to project my Child and GrandChild Collections, i.e. Orders and OrderStatuses here but don't know how to do that. I learned that by projecting, one does not need to \"Include/Expand\" these extension methods.  \n     });\n     return ordersWithLatestStatusDate ;\n}\n</code></pre>\n\n<p>---- UPDATE 1 ----</p>\n\n<p>After the great solution from User: <a href=\"http://stackoverflow.com/users/470005/lazyberezovsky\">lazyberezovsky</a>, I tried the following:</p>\n\n<pre><code>var query = Context.Customers\n            .Where(c =&gt; c.CustomerId == SelectedCustomer.CustomerId)\n            .Select(o =&gt; new Customer \n            { \n                Name = c.Name, \n                LatestOrderDate = o.OrderStatus.Max(s =&gt; s.StatusDate) \n            });\n</code></pre>\n\n<p>In my hastiness from my initial posting, I didn't paste everything in correctly since it was mostly from memory and didn't have the exact code for reference at the time.  My method is a strongly-typed IQueryabled where I need it to return a collection of items of type T due to a constraint within a rigid API that I have to go through that has an IQueryable query as one of its parameters. I am aware I can add other entities/attributes by either using the extension methods .Expand() and/or .Select().  One will notice that my latest UPDATED query above has an added \"new Customer\" within the .Select() where it was once anonymous.  I'm positive that is why the query failed b/c it couldn't be turn into a valid Uri due to LatestOrderDate not being a property of Customer at the Server level.  FYI, upon seeing the first answer below, I had added that property to my client-side Customer class with simple { get; set; }.  So given this, can I somehow still have a Customer collection with the only bringing back those 2 fields from 2 different entities?  The solution below looked so promising and ingenious!</p>\n\n<p>---- END UPDATE 1 ----</p>\n\n<p>FYI, the technologies I'm using are OData (WCF), Silverlight, C#.</p>\n\n<p>Any tips/links will be appreciated.</p>\n"},{"tags":["c#","winforms","visual-studio-2010",".net-4.0","listbox"],"answer_count":5,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":5792,"score":1,"question_id":6504336,"title":"Get the value for a listbox item by index","body":"<p>This must be very easy but I am stuck.\nI have a listbox with X Items. Each Item has a text description (Whhich appears in the listbox) and its value(numerical). \nI want to be able to get the value property for an item, using the index number of the item.</p>\n"},{"tags":["c#","jquery","asp.net-mvc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13276570,"title":"ReferenceError: Model not defined in view","body":"<p>I get the following error, \"ReferenceError: Cat is not defined\", when trying to pass a model to view and print out it's text value with JavaScript. Why is there a reference error and how to fix it?</p>\n\n<p>Model:</p>\n\n<pre><code>public class Animal\n{\n    public List&lt;SelectListItem&gt; AnimalList { get; set; }\n\n    public Animal()\n    {\n        SelectListItem animalItem = new SelectListItem();\n        animalItem.Text = \"Cat\";\n        animalItem.Value = \"1\";\n\n        AnimalList = new List&lt;SelectListItem&gt;();\n        AnimalList.Add(animalItem);\n    }\n}\n</code></pre>\n\n<p>Controller:</p>\n\n<pre><code>    public ActionResult Index()\n    {\n        var model = new Animal();\n\n        return View(model);\n    }\n</code></pre>\n\n<p>View:</p>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;\n$(document).ready(function () {\n    @foreach (var item in Model.AnimalList)\n    {\n        &lt;text&gt;\n            console.log(@item.Text);\n        &lt;/text&gt;\n    }\n});\n&lt;/script&gt;\n</code></pre>\n\n<p>By the way. It works fine if I set the text to a number, for example 0.</p>\n"},{"tags":["c#","vsto","outlook-addin","outlook-2010"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13261075,"title":"C# Outlook 2010 Addin - AppointmentItem.ItemProperties.Add Exception","body":"<p>I am working on an Outlook add-in that adds a Form Region to IPM.Appointment message classes. When this region is showed, it will first add a few properties to the AppointmentItem.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>Outlook.AppointmentItem appItem;\n\nprivate void FormRegion_FormRegionShowing(object sender, System.EventArgs e)\n{\n    try\n    {\n        appItem = (Outlook.AppointmentItem)this.OutlookItem;\n\n        appItem.ItemProperties.Add(\"CustomProperty\", Outlook.OlUserPropertyType.olText);\n    }\n    catch (Exception ex)\n    {\n        MessageBox.Show(ex.ToString());\n    }\n}\n</code></pre>\n\n<p>This works fine on my calendar, but if I try to use the addin with a delegate calendar that I have either Editor or Owner access to, it throws the following exception:</p>\n\n<pre><code>System.UnauthorizedAccessException: You don't have appropriate permission to perform this operation.\n  at Microsoft.Office.Interop.Outlook.Itemproperties.Add(String Name, OlUserPropertType Type, ObjectAddToFolderFields, Object DisplayFormat)\n  at ThisAddin.FormRegion.FormRegion_FormRegionShowing(Ovject sender,EventArgs e)\n</code></pre>\n\n<p>Any and all help is appreciated!</p>\n"},{"tags":["c#","xml-documentation"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13267304,"title":"C#: How to display generic parameter arguments in xml documentation","body":"<p>I can reference a generic type/method definition like this:</p>\n\n<pre><code>/// &lt;summary&gt;\n/// Takes a &lt;see cref=\"Func{T}\"/&gt;.\n/// &lt;/summary&gt;\npublic void Method&lt;T&gt;(Func&lt;T&gt; func) { }\n</code></pre>\n\n<p>However this does not work:</p>\n\n<pre><code>/// &lt;summary&gt;\n/// Takes a &lt;see cref=\"Func{Int32}\"/&gt;.\n/// &lt;/summary&gt;\npublic void Method(Func&lt;int&gt; func) { }\n</code></pre>\n\n<p>ReSharper / the generated help file says <code>Func&lt;TResult&gt;</code>.</p>\n"},{"tags":["c#","ilmerge"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13276481,"title":"Embedding\\Merging .NET v1 Assemblies on .NET v4+ Assembly","body":"<p>I have a C# library with some assemblies developed by us and some third-party o I need put everything in a single assembly file.</p>\n\n<p>When I try to <strong>merge</strong> everything using ILMerge I got the following error:</p>\n\n<blockquote>\n  <p>An exception occurred during merging: </p>\n  \n  <p>ILMerge.Merge: The assembly 'TestLibrary' is not marked as\n  containing only managed code.   (Consider using the /zeroPeKind option\n  -- but read the documentation first!)\n       em ILMerging.ILMerge.Merge()\n       em ILMerging.ILMerge.Main(String[] args)</p>\n</blockquote>\n\n<p>When I remove TestLibrary from the Merge, it works fine. But to get my project working I have reference the TestLibrary separately and enable useLegacyV2RuntimeActivationPolicy=\"true\".</p>\n\n<p>So, after a little more research I decided to try using Embedded Resources using <a href=\"http://blogs.msdn.com/b/microsoft_press/archive/2010/02/03/jeffrey-richter-excerpt-2-from-clr-via-c-third-edition.aspx\" rel=\"nofollow\" title=\"Jeffrey Richter\">Jeffrey Richter</a>:</p>\n\n<pre><code>AppDomain.CurrentDomain.AssemblyResolve += (sender, args) =&gt; {\n   String resourceName = \"AssemblyLoadingAndReflection.\" +\n      new AssemblyName(args.Name).Name + \".dll\";\n   using (var stream = Assembly.GetExecutingAssembly().GetManifestResourceStream(resourceName)) {\n      Byte[] assemblyData = new Byte[stream.Length];\n      stream.Read(assemblyData, 0, assemblyData.Length);\n      return Assembly.Load(assemblyData);\n   }\n};\n</code></pre>\n\n<p>It loads the resource bytes but fails on Assembly.Load saying that the program have a incorrect format.</p>\n\n<p>The TestLibrary is a C++ .Net v1.0 Library.</p>\n"},{"tags":["c#","class","partial"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13276804,"title":"partial class does not contain definition","body":"<p>I got a weird problem and finally fixed it. Just like to share this expeirence so other people will search this topic and get the answer.\nI defined 2 partial classes, and compiled with the error of \"does not contain a definition for ...\". It was weird because it worked when the 2 classes were individual classes.</p>\n\n<p>Here is the code:</p>\n\n<p>Before:\nFoo1.cs</p>\n\n<pre><code>public class foo1{public void xyz(){}}\n</code></pre>\n\n<p>Foo2.cs</p>\n\n<pre><code>public class foo2{}\n</code></pre>\n\n<p>After:\nFoo1.cs</p>\n\n<pre><code>public partial class foo1{  public void xyz(){}}\n</code></pre>\n\n<p>Foo2.cs</p>\n\n<pre><code>public partial class foo1{}\n</code></pre>\n\n<p>Compilation said \"MyNamespace.foo1 does not contain a definition for xyz\". But xyz was good when the class was not partial! This could be caused by different namespaces. But I doubted that. Because if namespaces were different, it would not compile.</p>\n\n<p>I figured out at last. The problem was in Foo1.cs, the namespace was not defined but it was defined in Foo2.cs. Before I defined the partial class, the compiler provided a default namespace to Foo1.cs, that was the same as the one defined explicitly in Foo2.cs. But with the partial class, the compiler would not provide a default namespace to the partial class. This is why the compiler complained when a third party called foo1.xyz().</p>\n\n<p>I learned a lesson that always define the namespace explicitly for each single cs file, except that you do not define the namespace.</p>\n"},{"tags":["c#",".net","winapi","cracking","detours"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13276741,"title":"Prevent detouring functions. Avoid cracking","body":"<p>There is an application that checks for activation using DLL <code>Check</code> function. <code>Check</code> returns 1 if application is activated and 0 otherwise. I create simple application and DLL containing function <code>MyCheck</code> (which always returns 1) with the same signature and detoured <code>Check</code> function with my version using MS detours lib for function hooking. Obviously it works and the application is successfully cracked, so I need to avoid it.</p>\n\n<ol>\n<li><p>I tried to call <code>Check</code> function directly (by specifying exact address), without even using <code>GetProcAddress</code>, but looks like detours lib is modifying the function body itself, not export table.</p>\n\n<pre><code>[UnmanagedFunctionPointer(CallingConvention.StdCall)]\nprivate delegate bool CheckFunctionDelegate();\n\nstatic void Main(string[] args)\n{\n    ProcessModule module = Process.GetCurrentProcess().Modules\n        .Cast&lt;ProcessModule&gt;()\n        .First(m =&gt; m.ModuleName == \"licensing_check.dll\");\n\n\n    IntPtr procedurePtr = IntPtr.Add(module.BaseAddress, 0x00003FF0);\n\n    // Calling validation function by pointer\n    CheckFunctionDelegate checkFunction = (CheckFunctionDelegate)\n        Marshal.GetDelegateForFunctionPointer(procedurePtr, typeof(CheckFunctionDelegate));\n\n    if (checkFunction())\n    {\n        // do some stuff\n    }\n}\n</code></pre>\n\n<p>}</p></li>\n<li><p>Then I tried to read function body and I see that after detour MD5 checksum differs from the original one. So I'm trying to read entire contents of DLL in memory and check it to confirm that DLL contents are not changed, but it doesn't work either. It throws <code>AccessViolationException</code>.</p>\n\n<p>Process.EnterDebugMode();</p>\n\n<p>ProcessModule module = Process.GetCurrentProcess().MainModule;\nbyte[] data = new byte[module.ModuleMemorySize];\nMarshal.Copy(module.BaseAddress, data, 0, module.ModuleMemorySize);</p></li>\n</ol>\n\n<p>I used MainModule here, but it gives the same error for each module in <code>Process.GetCurrentProcess().Modules</code> collection.</p>\n\n<p>I would appreciate any help on this, I'm not necessarily expecting to solve it in one of the ways I describe, any good solution is acceptable.</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","string"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":30,"score":-3,"question_id":13276210,"title":"A method to execute cmd prompt command going wrong","body":"<p>I have this method </p>\n\n<pre><code>private void _executeCommand(string commandStr, int timeout)\n         {\n\n            try\n            {\n               System.Diagnostics.ProcessStartInfo procStartInfo =\n                   new System.Diagnostics.ProcessStartInfo(\"cmd\", \"/c \" + commandStr);\n               procStartInfo.RedirectStandardOutput = true;\n               procStartInfo.UseShellExecute = false;\n               // Do not create the black window.\n               procStartInfo.CreateNoWindow = true;\n               // Now we create a process, assign its ProcessStartInfo and start it\n               System.Diagnostics.Process proc = new System.Diagnostics.Process();\n               proc.StartInfo = procStartInfo;\n               proc.Start();\n               Thread.Sleep(timeout);\n\n            }\n            catch (ExecutionEngineException e)\n            {\n\n               throw e;\n\n            }}\n</code></pre>\n\n<p>somehow, if I pass a string called <code>myCmd</code>, <code>_executeCommand(myCmd, timeout)</code>, it does nothing. But if I pass the exact string value of <code>myCmd</code>, <code>_executeCommand(\"copy //data//file \\\"C://Program Files/myApp\\\"\", timeout)</code>, it was able to execute. Could anyone see what the problem is? </p>\n"},{"tags":["c#","vb.net","mixed","mixed-language"],"answer_count":3,"favorite_count":8,"up_vote_count":8,"down_vote_count":0,"view_count":5470,"score":8,"question_id":2339776,"title":"Mixing VB.Net and C# Code in an ASP.Net Web Site project?","body":"<p>The question quite an older and often asked around, i have similar questions here but my question is a bit more specific.</p>\n\n<p>Q1. Is it legal to mix C# and VB.Net code in ASP.Net Web site? Will it work or not? If it works how it may be done? Any sample will be good.</p>\n\n<p>Q2. If there are any repercussions of mixing C# and VB.Net code then please do share those as well.</p>\n\n<p>I have a web project that is coded in VB.Net. I am working on one module of the project. and i want to code in C#. I cant convert the whole project to C# because i am not the only one working on the project. However, the module i intend to build , i want to have that built in C#. </p>\n\n<p>I have heard that in case of web projects, if we code part in C# and part in VB.net then there are problems compiling the project to a dll. Is that true? if yes then what is the solution. </p>\n\n<p>Also, if i am building a dynamic link library in .Net then can i mix C# and Vb.Net code?</p>\n"},{"tags":["c#","wpf","data-binding","dynamic"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13276674,"title":"Get property type of dynamic object in C# (even when value is null)","body":"<p>I have a DynamicObject wrapper that is basically forwarding property values from another private object instance (amongst other things). But is there any way of returning the property-type dynamically as well?</p>\n\n<p>The reasong I'm asking is because I'm having trouble with bindings in WPF trying to convert the view-value (<strong>string</strong> in my case with a textbox bound to a double property) to a presenter value of type <strong>object</strong> instead of <strong>double</strong> (which it would if the object was not dynamic and the property had a returntype of double).</p>\n\n<p>If there where something like TryGetMemberType it would be great...</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13276236,"title":"C# Custom paste like feature","body":"<p>I am trying to create a way or inserting text anywhere on the system in Windows, much like the clipboard works. For example, pressing ctrl+shift+1 would 'paste' text set in my application into where the user is currently pointing the cursor. </p>\n\n<p>For example, if my application sets it to be 'local.network' and the user presses ctrl+shift+1 in their browser address bar, it would paste in 'local.network'. I then want to have different values set, depending on what number the user presses. Is this possible or can I not create a system wide function like this?</p>\n"},{"tags":["c#",".net","vb.net","winforms","exception"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13276201,"title":"PDB file and error handling?","body":"<p>We have a windows form application running across different customers, when they get errors we log into a database &amp; using that stack information that is logged, we correct the issue.</p>\n\n<p>However there are issues that occur only in production, the stack shows for example</p>\n\n<blockquote>\n  <p>CalculateTotals(method name) :NullReferenceException: Object reference not set to instance of an object.</p>\n</blockquote>\n\n<p>The CalculateTotals is a method name, that has lots of sub-method calls &amp; more lines, i am not able to get the exact line # of the code where it fails.</p>\n\n<p>My application's PDB file is not sent to customers (when they do installation),</p>\n\n<p>how do i keep a copy of that .PDB file (may be in a remote location and \nnot make it part of installation) and use that to \ndebug the errors &amp; get the exact line?</p>\n"},{"tags":["c#"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13276587,"title":"DialogResult.Ok like Custom Class","body":"<p>I am trying to develop a custom input dialog box. In its constructor I want to take a parameter as follows-</p>\n\n<pre><code>PromptType.Question\nPromptType.Information\nPromptType.Feedback\n//etc....\n\nprivate void buttonTest_Click(object sender, System.EventArgs e) \n{\n   InputBoxResult result = InputBox.Show(\"Some title\",PromptType.Question);\n}\n</code></pre>\n\n<p>How can i do it?? </p>\n"},{"tags":["c#","file-io","filestream"],"answer_count":2,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":49,"score":8,"question_id":13276506,"title":"Is it safe to keep C# Filestream open for long periods of time?","body":"<p>Inside my web service, I open a filestream to a file on local disk. I keep this around for the lifetime of the service. For every query that comes in, I use the filestream to read the disk.\nI do this to avoid having to reopen the filestream on every query. Latency of this path is critical (should less than few ms). I use SSD to keep disk IO time to 0.1ms or less.</p>\n\n<p>Can the filestream 'go bad' (become invalid) over long periods of time (days). Is it safer to just reopen the filestream on every query? If I have to reopen, what's the overhead of constantly reopening a filestream several times a second?</p>\n"},{"tags":["c#","debugging","process.start"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13276634,"title":"Visual Studio - Keeping command window open","body":"<p>So I'm debugging a C# program in Visual Studio, and it launches a command window for <code>Process.Start</code>.</p>\n\n<p>I want to keep this window open - however the method I tried - doing a <code>Console.Readline();</code> didn't work.</p>\n\n<p>Is there a standard way to keep a console window open so that I can see what happens when the program executes? It would be very helpful for debugging</p>\n"},{"tags":["c#",".net","asp.net-mvc-3","linq","entity"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13276745,"title":"Creating Navigation Property without foreign key?","body":"<p>I am trying to create a navigation property for my data model using an existing database.  The data has a shared key (like a foreign key) however it is not specified that way in the database.  Here is what it looks like:</p>\n\n<pre><code> [Table(\"Alpha\")]\n    public class Alpha\n    {\n        public int AlphaID { get; set; }\n\n        public int AlphaGroupID { get; set; }\n\n        public int? ParentAlphaID { get; set; }\n\n        public int? CodeID { get; set; }\n\n        public int? BracketCodeID { get; set; }\n\n        public string Title { get; set; }\n    }\n\n\n\n\n\n[Table(\"AlphaGroup\")]\n    public class AlphaGroup\n    {\n        [Column(\"AlphaGroupID\")]\n        public int AlphaGroupID { get; set; }\n\n        public string Title { get; set; }\n\n        public string TitleAddon { get; set; }\n\n    }\n</code></pre>\n\n<p>AlphaGroupID needs to be a navigation property to AlphaGroupID but is not a foreign key.  Is there a way to accomplish this?</p>\n"},{"tags":["c#",".net","datetime","timespan"],"answer_count":15,"favorite_count":6,"up_vote_count":24,"down_vote_count":0,"view_count":10004,"score":24,"question_id":1525990,"title":"Difference in months","body":"<p>In C#/.NET <code>TimeSpan</code> has <code>TotalDays</code>, <code>TotalMinutes</code>, etc. but I can't figure out a formula for total months difference. Variable days per month and leap years keep throwing me off. How can I get <strong>TotalMonths</strong>?</p>\n\n<p><strong>Edit</strong> Sorry for not being more clear: I know I can't actually get this from <code>TimeSpan</code> but I thought using <code>TotalDays</code> and <code>TotalMinutes</code> would be a good example to express what I was looking for ... except I'm trying to get Total Months.</p>\n\n<p>Example: Dec 25, 2009 - Oct 6, 2009 = 2 TotalMonths. Oct 6th to Nov 5th equals 0 months. On Nov 6th, 1 month. On Dec 6th, 2 months</p>\n"},{"tags":["c#","https"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13276576,"title":"How do I get the contents of a web page that is behind a log-in page?","body":"<p>This works, expect, I'm downloading the string of the log-in page and not the actual page (url variable).</p>\n\n<p>How do I get the contents of a page that is behind a log-in?</p>\n\n<pre><code>var credentials = new NetworkCredential { UserName = \"xxxxxx\", Password = \"yyyyyy\" };\nusing (var client = new WebClient())\n{\n    client.Credentials = credentials;\n\n    string page = client.DownloadString(url);\n\n    if (page.Contains(\"cheetah\"))\n    {\n         MessageBox.Show(\"cheetah exists\");\n    }\n    else\n    {\n         MessageBox.Show(\"NOPE\");\n    }\n }\n</code></pre>\n"},{"tags":["c#","visual-studio-2005","file-association","process.start"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":749,"score":3,"question_id":884012,"title":"How to bring up the \"Windows cannot open this file\" dialog?","body":"<p>My users can attach documents to various entities in the application.  Of course, if user A attaches a .TIFF file, user B may not have a viewer for that type of file.  </p>\n\n<p>So I'd like to be able to bring up this dialog:</p>\n\n<p><img src=\"http://www.angryhacker.com/toys/cannotopen.png\" alt=\"alt text\" /></p>\n\n<p>My application is C# with VS2005.<br />\nCurrently I do Process.Start and pass in the file name.  If no association is found, it throws an exception.</p>\n"},{"tags":["c#","parameters","ado.net","sqldataadapter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13276602,"title":"c# Using Parameters.AddWithValue in SqlDataAdapter","body":"<p>How can i use Parameters.Add.WithValue in SqlDataAdapter. Below searching codes.</p>\n\n<pre><code>var da = new SqlDataAdapter(\"SELECT * FROM annotations WHERE annotation LIKE '%\"+txtSearch.Text+\"%'\", _mssqlCon.connection);\nvar dt = new DataTable();\nda.Fill(dt);\n</code></pre>\n\n<p>I rewrote the code like this:</p>\n\n<pre><code>SqlDataAdapter da;\nda = new SqlDataAdapter(\"SELECT * FROM annotations WHERE annotation LIKE '%@search%'\", _mssqlCon.connection);\nda.SelectCommand.Parameters.AddWithValue(\"@search\",txtSearch.Text);\nvar dt = new DataTable();\nda.Fill(dt);\n</code></pre>\n\n<p>But failed. Could you help me where is my fault?<br /> Yours sincerely.</p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":32,"score":3,"question_id":13274792,"title":"Filter DataGridView","body":"<p>ive searched the internet for a solution for my problem, me and my studygrp is making a datagridview that takes information from a classLibrary. all that works but now we got to filter it but all i can find is by bindingsource but thats not what i was thinking. i just want a simple filter so that u can enter something in a textbox and it shows it on the datagridview if it contains that information. ive tryed </p>\n\n<pre><code>try\n   {\n      ((DataTable)dataGridView1.DataSource).DefaultView.RowFilter = \"FromColumn like '%\" + textBox1.Text + \"%'\";\n   }\ncatch (Exception) { }\n</code></pre>\n\n<p>but it doesnt work like i want it to hmmn... anyone that can help?</p>\n"},{"tags":["c#","inheritance","oop","compiler-errors"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":612,"score":1,"question_id":3558177,"title":"How to prevent hide or override on a public property","body":"<p>I have an abstract base class that has a Property on it that I would like to prevent both hiding, aka new, and override on.</p>\n\n<pre><code>public abstract class DomainObject\n{\n    public bool IsDeleted { get; set; }\n}\n\npublic class BankAccount : DomainObject\n{\n    public bool IsDeleted { get; set; }\n}\n</code></pre>\n\n<p>The issue is: I need BankAccount to inherit from the base DomainObject class, so I can't mark it as sealed, but I want to prevent the situation, an override or new, of IsDeleted at compile time.</p>\n"},{"tags":["c#",".net","string.format"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":57,"score":5,"question_id":13276418,"title":"How string.Format handles null values?","body":"<p>In the following code below, why the two string.Format behave the same way? In the first one, no exception is thrown and in the second one an ArgumentNullException is thrown.</p>\n\n<pre><code>static void Main(string[] args)\n{\n    Exception e = null;\n    string msgOne = string.Format(\"An exception occurred: {0}\", e);\n    string msgTwo = string.Format(\"Another exception occurred: {0}\", null);\n}\n</code></pre>\n\n<p>Could someone please help me understand the difference between the two?</p>\n"},{"tags":["c#","visual-studio-2010","oracle","cultureinfo"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13275628,"title":"ToDecimal Regional / Culture problems","body":"<p>I'm receiving from the Oracle database the following value (as varchar): <code>7876,72</code>\nIn Visual Studio it's read as a <code>String</code></p>\n\n<p><strong>CASE 1 (expected case):</strong></p>\n\n<p>When I'm debuggin I see: <code>7876.72</code> and when I try to <code>Convert.ToDecimal(\"7876.72\")</code> I'm getting <code>7876.72D</code></p>\n\n<p><strong>CASE 2 (wrong case):</strong></p>\n\n<p>When I'm debuggin I see: <code>7876,72</code> and when I try to <code>Convert.ToDecimal(\"7876,72\")</code> I'm getting <code>787672D</code></p>\n\n<p>I'm checking the <code>CultureInfo.CurrentCulture</code> and <code>RegionInfo.CurrentRegion</code> and it's the same on both machines...</p>\n\n<p>The main reason of this is because:</p>\n\n<p><code>Convert.ToDecimal(\"7876,72\").ToString(\"0,0.00\", CultureInfo.InvariantCulture)</code> gives me: <code>787,672.00</code> and it should be <code>7,876.72</code>.</p>\n\n<p><strong>Global.asax - Application_Start</strong></p>\n\n<pre><code>Dim newCulture As CultureInfo = DirectCast(System.Threading.Thread.CurrentThread.CurrentCulture.Clone(), CultureInfo)\nnewCulture.DateTimeFormat.ShortDatePattern = \"yyyy/MM/dd\"\nnewCulture.DateTimeFormat.DateSeparator = \"/\"\nnewCulture.NumberFormat.CurrencyDecimalSeparator = \".\"\nnewCulture.NumberFormat.NumberDecimalSeparator = \".\"\nThread.CurrentThread.CurrentCulture = newCulture\n</code></pre>\n\n<p>Any ideas on how to keep the same value on both machines?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["c#","vb.net","reboot"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":78,"score":5,"question_id":13276147,"title":"programmatically reboot in safe mode then execute program","body":"<p>I have a program and once the is button clicked I want a message to appear that will tell user that the computer is rebooting (with ok/cancel option), then the computer will reboot. Yet the kicker is, I want it to reboot into safe mode. Then when the user is logged into safe mode, it will automatically start a program on startup.</p>\n\n<p>Now I realize that this is possible by programmatically editing boot.ini with /safemode, task to start program once computer logs in,then telling the computer to reboot.However, the end user is assumed to have not enough knowledge of Windows to reverse these settings manually.</p>\n\n<p>What I want is, after the end user is done with the program in Windows Safe Mode, they can simply reboot the computer and resume using Windows with out manually changing any settings to the way they were before booting into safe mode. </p>\n\n<p>NOTE* the program that will run in safe mode, has been tested to work in safe mode. I just need to know how to get the end user to safe mode and run the program automatically with out the end user having any knowledge of how to reverse these settings.</p>\n\n<p>Could anyone suggest a method to execute all this madness?  An example in C# or vb.net would be great!</p>\n\n<p>Thank you in advance!</p>\n\n<p>Ben</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":36,"score":-1,"question_id":13275975,"title":"CircularBuffer highly efficient implementation (both thread-safe and not thread-safe)","body":"<p>Could someone suggest good CircularBuffer implementation? I need both \"not thread-safe\" and \"thread-safe\" versions. I expect following operations:</p>\n\n<ul>\n<li>ability to provide size of the buffer when creating</li>\n<li>adding elements</li>\n<li>iterating elements</li>\n<li>removing elements while iterating</li>\n<li>probably removing elements</li>\n</ul>\n\n<p>I expect implementation to be highly optimized in terms of speed and used memory, average and worst times etc.</p>\n\n<p>I expect \"not thread-safe\" implementation to be extremely fast. I expect \"thread-safe\" implementation to be fast, probably using \"lock-free code\" for synchronization and it's ok to have some restrictions if this is required for speed.</p>\n\n<p>If buffer is too small to store new (added) element it's ok to silenty override existent element or raise exception.</p>\n\n<p>Should I use disruptor.net?</p>\n\n<p>Adding link to a good example <a href=\"http://stackoverflow.com/questions/8860684/disruptor-net-example\">Disruptor.net Example</a></p>\n"},{"tags":["c#","xml"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":370,"score":1,"question_id":1928005,"title":"C# Display in XML Format","body":"<p>I am expecting an xml as output when execute the following</p>\n\n<pre><code>XElement Root = XElement.Load(@\"d:\\xmlfiles\\Customers.xml\");\nXElement BringContact = Root.Element(\"Contact\");\nResponse.Write(BringContact);\n</code></pre>\n\n<p>as</p>\n\n<pre><code>&lt;Contact&gt;\n  &lt;Company&gt;Alfreds Futterkiste&lt;/Company&gt;\n  &lt;City&gt;Berlin&lt;/City&gt;\n&lt;/Contact&gt;\n</code></pre>\n\n<p>But the Response.Write() displays  values only\nas</p>\n\n<pre><code>Alfreds Futterkiste Berlin\n</code></pre>\n\n<p>What is the code change do i need?</p>\n"},{"tags":["c#",".net-3.5","llblgenpro"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13276538,"title":"Llblgen update table?","body":"<p>Simply i wanna know </p>\n\n<p><strong>update table set (name,surname) values ('John','Locke') where Id=1</strong> \nsql statment equivalent in llblgen, i tried below code but it didn't work.</p>\n\n<pre><code>            Entity e = new Entity();\n            entity.Id = 1;\n            entity.name = \"John\";\n            entity.surname = \"Locke\";\n            entity.Save();\n</code></pre>\n\n<p>can anyone help?</p>\n"},{"tags":["c#","linq","collections"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":216,"score":1,"question_id":6228129,"title":"Linq Get Collection of collocated equal objects","body":"<p>The following code shows what I want to do:</p>\n\n<pre><code>public static IEnumerable&lt;IEnumerable&lt;T&gt;&gt; DoIt&lt;T&gt;(this IEnumerable&lt;T&gt; that)\n{\n    if (that == null)\n        throw new ArgumentNullException();\n\n    if (that.Count() &gt; 1)\n    {\n        var result = new Collection&lt;IEnumerable&lt;T&gt;&gt;();\n        var collection = new Collection&lt;T&gt;();\n\n        collection.Add(that.ElementAt(0));\n        for (int i = 1; i &lt; that.Count(); ++i)\n        {\n            if (!that.ElementAt(i).Equals(that.ElementAt(i - 1)))\n            {\n                result.Add(collection);\n                collection = new Collection&lt;T&gt;();\n            }\n\n            collection.Add(that.ElementAt(i));\n        }\n\n        result.Add(collection);\n        return result;\n    }\n\n    return new Collection&lt;IEnumerable&lt;T&gt;&gt;() { that };\n}\n</code></pre>\n\n<p>I'm only using custom implementations like that one, if there is no appropriate implementation already existing. Is there any way to do the same with the standard framework?</p>\n"},{"tags":["c#","sql-server","sqlcommand"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13276173,"title":"SQL command returns invalid object name database.table","body":"<p>I run this code:</p>\n\n<pre><code>                    SqlConnection polaczenie;\n                    polaczenie = new SqlConnection(dane_polaczenia);\n                    SqlCommand cmd = new SqlCommand();\n                    cmd.Connection = polaczenie;\n                    polaczenie.Open();\n                    cmd.CommandText = @\"SELECT * FROM test.test\";\n                    cmd.ExecuteNonQuery();\n</code></pre>\n\n<p>After executing I got exception <code>Invalid object name 'test.test'.</code> </p>\n\n<p>Database and table values are correct.</p>\n\n<p>How to specify <code>database.table</code> in <code>CommandText</code> correctly?</p>\n"},{"tags":["c#","visual-studio-2010","performance-testing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13276513,"title":"Best way to load test without webtest in Visual Studio","body":"<p>I've been running load tests to test the overall performance of the system we're building, but I've run in to an issue and I'm not sure of the best way to solve it. What I want to do is have some other commands that get run that are not a web request, but I would like to still use all the loadtest functionality (counter monitoring, concurrent users, etc....). I haven't found a way to do this without having to make an actual webtest. I can obviously cheat the webtest and have it return a dummy web request. But I was curious if there was a better way of doing this. It seems like something that would be at least somewhat common but I was unable to find any information.</p>\n"},{"tags":["c#","winforms","cmd","cmd.exe"],"answer_count":3,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":394,"score":4,"question_id":11767654,"title":"Sending commands to cmd prompt in C#","body":"<p>For one of my implementations I am working on a tool that is supposed to send/retrieve commands/results to/from the cmd window. Everything works fine but the Use case below fails to do anything. It seems as if my application is waiting for something (instead of displaying the result) </p>\n\n<p>From my tool I navigate to the python folder . From the python folder I try to launch  python.exe but at this point, my editor does not do anything. it simply keeps on waiting. </p>\n\n<p>For your kind consideration I am also linking the video here. It would be easier for you guys to understand what I am trying to say. </p>\n\n<p><a href=\"http://www.youtube.com/watch?v=MkGZOQSMXuM\" rel=\"nofollow\">View the Video here (on youtube)</a></p>\n\n<p>I am also attaching the code that I currently have. </p>\n\n<pre><code>            ProcessStartInfo info = new ProcessStartInfo(\"cmd.exe\");\n\n            string argument = null;\n            if (!string.IsNullOrEmpty(startingDirectory) &amp;&amp; System.IO.Directory.Exists(startingDirectory))\n            {\n               argument += @\"cd\\\";\n            }\n            else\n            {\n                argument += \"\\\"\";\n            }\n            info.Arguments = argument;\n            info.CreateNoWindow = true;\n            info.RedirectStandardError = true;\n            info.RedirectStandardInput = true;\n            info.RedirectStandardOutput = true;\n            info.UseShellExecute = false;\n             this.shellProcess = System.Diagnostics.Process.Start(info);\n            this.shellProcess.EnableRaisingEvents = true;\n            //this.InputStream.AutoFlush = true;\n            this.shellProcess.Exited += new EventHandler(ProcessExited);\n            this.ErrorBeginRead();\n            this.OutputBeginRead();\n\n private void OutputBeginRead()\n    {\n        this.shellProcess.StandardOutput.BaseStream.BeginRead(outputBuffer, 0, outputBuffer.Length, new AsyncCallback(this.OnOutputInput), this.shellProcess);\n    }\n\n        private void ErrorBeginRead()\n    {\n        this.shellProcess.StandardError.BaseStream.BeginRead(errorBuffer, 0, errorBuffer.Length, new AsyncCallback(this.OnErrorInput), this.shellProcess);\n    }\n</code></pre>\n\n<p>Thank you !</p>\n\n<p>EDIT:\nLaunching python is just an example. I need to use the same method for other normal cmd line commands as well.It would be nice, if somebody can point what i am doing wrong with the code that I have  or what I must do , in order to achieve the intended functionality. </p>\n\n<p>EDIT 2 : The normal cmd commands are working perfectly. The command line tools like python,perl are not working .</p>\n\n<p>Edit 3 : So I managed to do move a wee bit forward following Jamie's suggestions. The ui is not \"hanging\" anymore. but when i access the python interpreter , the interpreter's output is still not visible in my tool. Any suggestions why that might be happening ? </p>\n"},{"tags":["c#",".net","generics"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13257835,"title":"How can I run Generic Find method from a List on the Visual Studio Immediate Window?","body":"<p>I just want to debug calling Find from Immediate Window, is it possible?</p>\n\n<pre><code>            Customer found = listOfCustomers.Find(\n                delegate(Customer cu)\n                {\n                    return cu.Name.ToLower().Contains(\"adam\");\n                }\n            );\n</code></pre>\n"},{"tags":["c#","xmpp","winrt","ejabberd","agsxmpp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":124,"score":0,"question_id":12559363,"title":"XMPP Libraries for Metro Apps in WinRT","body":"<p>Could you please list down some XMPP Libraries which supports for Metro Apps in WinRT? </p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","asp.net-mvc-3","model-binding","mvc-editor-templates"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13275702,"title":"Custom binding for DateTime not working when EditorTemplate is in place","body":"<p>As the default editors that MVC3 provides for DateTime are not HTML5 friendly, I have coded the following custom Editor Template:</p>\n\n<p>(DateTime.cshtml)</p>\n\n<pre><code>@model DateTime?\n\n&lt;input type=\"date\" value=\"@{ \n    if (Model.HasValue) {\n        @Model.Value.ToISOFormat() // my own extension method that will output a string in YYYY-MM-dd format\n    }\n}\" /&gt;\n</code></pre>\n\n<p>Now, this works fine, but then I had the problem of the dates not being correctly parsed, being that the ISO dates are not not parsed with the default DateTime binding. So, I implemented my own binder:</p>\n\n<pre><code>public class IsoDateModelBinder: DefaultModelBinder\n{\n    const string ISO_DATE_FORMAT = \"YYYY-MM-dd\";\n\n    public override object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)\n    {\n        var value = bindingContext.ValueProvider.GetValue(bindingContext.ModelName);\n\n        if (string.IsNullOrEmpty(value.AttemptedValue))\n            return null;\n\n        DateTime date;\n        if (DateTime.TryParseExact(value.AttemptedValue, ISO_DATE_FORMAT, CultureInfo.InvariantCulture, DateTimeStyles.None, out date));\n            return date;\n\n        return base.BindModel(controllerContext, bindingContext);\n    }\n}\n</code></pre>\n\n<p>And I have registered it (Global.asax.cs):</p>\n\n<pre><code>System.Web.Mvc.ModelBinders.Binders.Add(typeof(DateTime), new IsoDateModelBinder());\nSystem.Web.Mvc.ModelBinders.Binders.Add(typeof(DateTime?), new IsoDateModelBinder());\n</code></pre>\n\n<p>However, when the custom edit template is in place, the custom binder won't get called at all. I had removed it from the solution and the custom binder is correctly called -- although at that point the format is wrong because the custom editor hadn't provide the correct controls.</p>\n\n<p>So, what am I missing?</p>\n"},{"tags":["c#","silverlight","datagrid","icomparer"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13276175,"title":"How to specify an IComparer for a particular property on a model that can be used for Silverlight DataGrid column sorting","body":"<p>I have a Silverlight datagrid with a column who's binding is set to a string property on the model. These strings are alphanumeric, so I have created a custom IComparer to sort them appropriately. My question is how can I force the grid to use this custom comparer when sorting by this column?</p>\n\n<p>One of my ideas was perhaps there is some attribute that can be applied on the model's string property that I am binding to, that would explicitly specify the comparer to use when comparing this value with another string?</p>\n"},{"tags":["c#","sql-server-ce"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":18,"score":4,"question_id":13273466,"title":"Set Identity In sqlce table to auto increment?","body":"<p>I am a begginer programmer (High-School student) and my teacher has given me a task to make a primary key inside a <code>sqlce</code> table automatically increment every time I insert a new row into my database ( I dont think he knows how to do it either :)</p>\n\n<p>Here is my Current Code:</p>\n\n<pre><code>using (SqlCeConnection con = new SqlCeConnection(conString))\n{\n\n    con.Open();\n\n\n    using (SqlCeCommand com = new SqlCeCommand(\"INSERT INTO Occupational VALUES(@employedBeforeBool, @nameofEmployer, @Addressemployed,@specificsAtEmployer,@employmentOnDischarge, @yearsExperienceWithEmployer, @desireToReturnToEmployer, @farmingExperienceBool, @tradesorapprentiship, @whattradesorapprentiship, @SoldierID, @Occupational_ID)\", con))\n    {\n        com.CommandText = \"SET IDENTITY_INSERT Occupational ON\";\n        com.Parameters.AddWithValue(\"@employedBeforeBool\", Soldier1.employedBeforeBool);\n        com.Parameters.AddWithValue(\"@nameofEmployer\", Soldier1.nameOfEmployer);\n        com.Parameters.AddWithValue(\"@Addressemployed\", Soldier1.addressOfEmployer);\n        com.Parameters.AddWithValue(\"@specificsAtEmployer\", Soldier1.specificsAtEmployer);\n        com.Parameters.AddWithValue(\"@employmentOnDischarge\", Soldier1.employmentOnDischarge);\n        com.Parameters.AddWithValue(\"@yearsExperienceWithEmployer\", Soldier1.yearsExperienceWithEmployer);\n        com.Parameters.AddWithValue(\"@desireToReturnToEmployer\", Soldier1.desireToReturnToEmployer);\n        com.Parameters.AddWithValue(\"@farmingExperienceBool\", Soldier1.farmingExperienceBool);\n        com.Parameters.AddWithValue(\"@tradesorapprentiship\", Soldier1.tradeOrApprenticeship);\n        com.Parameters.AddWithValue(\"@whattradesorapprentiship\", Soldier1.whattradesorapprentiship);\n        com.Parameters.AddWithValue(\"@SoldierID\", SoldierID);\n        //com.Parameters.AddWithValue(\"@Occupational_ID\", counter);\n\n        com.ExecuteNonQuery();\n    }\n</code></pre>\n\n<p>My program doesnt crash when I run it and it looks like it is inserting but nothing is showing up inside the table.</p>\n\n<p>Thanks for any help that I get</p>\n"},{"tags":["c#","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13276130,"title":"Populate ComboBox and Textfields from Excel","body":"<p>I have an excel spreadsheet, that contains client information. I would like to populate a combo box (comboBox1) with unique values from Column A. I would then like a second combo box (comboBox2) to list the values from Column B that exist where comboBox1=Column A. Finally, I would like to populate text fields with column's C, D, E and so on....</p>\n\n<p>I have mocked up a quick screen of my desired result:</p>\n\n<p><img src=\"http://i.stack.imgur.com/xxvEg.png\" alt=\"enter image description here\"></p>\n\n<p>This would be derived from the following spreadsheet:</p>\n\n<p><img src=\"http://i.stack.imgur.com/INR2w.png\" alt=\"enter image description here\"></p>\n\n<p>The data in the spreadsheet changes from time to time, which is why I can not hard code the information.</p>\n\n<p>I am not sure where to even start with this. Do I load the data into 2D arrays or is there a better way of doing it?</p>\n"},{"tags":["c#","asp.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13276077,"title":"Replacing newline in multiline textbox with <br/>","body":"<p>I am trying to use a multiline textbox to insert text into a table which is displayed as html.  I want to with javascript take the text inside of the textbox and find where the user pressed enter and place \"<code>&lt;br/&gt;</code>\" in that position so when the text is displayed it will show line break.  Any ideas on how I could do this?</p>\n\n<p>I tried something like this but it did not work.</p>\n\n<pre><code>var text = document.getElementById(\"announcementid\").value;\n\n\n            var newtext = text.replace(\"\\n\", \"&lt;br/&gt;\");\n\n            text = newtext;\n</code></pre>\n"},{"tags":["c#","asp.net","session-variables"],"answer_count":6,"favorite_count":31,"up_vote_count":39,"down_vote_count":0,"view_count":64124,"score":39,"question_id":621549,"title":"How to access session variables from any class in ASP.NET?","body":"<p>I have created a class file in the App_Code folder in my application. I have a session variable </p>\n\n<pre><code>Session[\"loginId\"]\n</code></pre>\n\n<p>I want to access this session variables in my class, but when I am writing the following line then it gives error</p>\n\n<pre><code>Session[\"loginId\"]\n</code></pre>\n\n<p>Can anyone tell me how to access session variables within a class which is created in app_code folder in ASP.NET 2.0 (C#)</p>\n"},{"tags":["c#","moles"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13276250,"title":"Mole HttpRequest.Files","body":"<p>I am unit testing a web application and I am using Moles to mock up a <code>HttpRequest</code>.  I am now trying to test some file upload functionality that uses <code>HttpRequest.Files</code>, so I am trying to find the correct way to mole out that functionality.  This is what I have tried so far, but calls to the <code>HttpRequest.Files.Count</code> are throwing a null reference exception.  I am guessing that I am not approaching something correctly in how I am constructing the <code>HttpFileCollection</code> object.  Can anyone provide some guidance or the correct way to mole out the <code>HttpFileCollection</code> object?</p>\n\n<pre><code> HttpRequest req = new HttpRequest(@\"C:\\SomeFile.txt\", \"http://localhost/VirtualPath/\", \"\");\n MHttpRequest mReq = new MHttpRequest(req)\n        {\n            InstanceBehavior = Microsoft.Moles.Framework.MoleBehaviors.Fallthrough,\n            FilesGet = () =&gt;\n                {\n                    HttpFileCollection collection = new HttpFileCollection();\n                    System.Web.Moles.MHttpFileCollection filecoll = new MHttpFileCollection(collection)\n                    {\n                        InstanceBehavior = Microsoft.Moles.Framework.MoleBehaviors.Fallthrough\n                    };\n\n                    System.Web.Moles.MHttpPostedFile file = new MHttpPostedFile();\n                    System.IO.MemoryStream ms = new System.IO.MemoryStream();\n                    Bitmap b = new Bitmap(100, 100);\n\n                    b.Save(ms, System.Drawing.Imaging.ImageFormat.Png);\n\n                    file.ContentLengthGet = () =&gt; { return (int)ms.Length; };\n                    file.ContentTypeGet = () =&gt; { return \"image/png\"; };\n                    file.FileNameGet = () =&gt; { return \"filename.png\"; };\n                    file.InputStreamGet = () =&gt; { return ms; };\n\n                    filecoll.ItemGetInt32 = value =&gt; { \n                        return file;\n                    };\n\n                    return filecoll;\n                }\n        };\n</code></pre>\n"},{"tags":["c#","sockets","windows-8","windows-store-apps","windows-store"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":9,"score":-1,"question_id":13276228,"title":"How to establish a communication to another computer using Microsoft Account?","body":"<p>I was seeing an app which connects to another computer using Microsoft Account (through email): Mine Sweeper.</p>\n\n<p>I'm interested to create an app where I introduced its Microsoft Account and establish a communication between themselves (like a chat) using Sockets. Any idea about how to resolve the account?</p>\n"},{"tags":["c#","asp.net","label","messagebox"],"answer_count":8,"favorite_count":0,"up_vote_count":2,"down_vote_count":3,"view_count":314,"score":-1,"question_id":7929097,"title":"What is the best way to display error/warning messages on website app?","body":"<p>I'm creating a website app(ASP.NET, C#) and I just want to know the best way to display error/warning messages. Is it better to do it by MessageBox or thru a Label? Just need some suggestions.</p>\n"},{"tags":["c#","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":41,"score":5,"question_id":13276003,"title":"Thumbs on line corner points do not relocate points","body":"<p>I am developing a drawing application in which one can draw various types of lines. On the line corner points I have placed a thumb using an itemsControl. The thumbs should move that corner point when the user left mouse clicks on it and drags the mouse. What's happening now is that when I do this the point and thumb move a little bit, but then it loses mouse capture right away and doesn't move anymore. When I debug the first dragdelta event that gets fired correctly has a full visual tree traced up from the sending thumb to the itemscontrol and beyond, but sometimes when it fires the next time, the thumb's location has not been updated, and the containing content presenter has null parents in the visual tree. </p>\n\n<p>This is the portion of the xaml related to the line thumb points:</p>\n\n<pre><code>&lt;ItemsControl x:Name=\"PART_LineRelocate\" ItemsSource=\"{Binding pointsObservableCollection}\"  Visibility=\"Collapsed\" &gt;\n    &lt;ItemsControl.ItemTemplate&gt;\n        &lt;DataTemplate DataType=\"{x:Type s:LineCornerPoint}\" &gt;\n           &lt;Grid&gt;\n              &lt;c:PointRelocateThumb VerticalAlignment=\"Center\" HorizontalAlignment=\"Center\" Focusable=\"True\"  x:Name=\"PART_PointRelocateThumb\" Cursor=\"Hand\"/&gt;\n           &lt;/Grid&gt;\n        &lt;/DataTemplate&gt;\n     &lt;/ItemsControl.ItemTemplate&gt;\n     &lt;ItemsControl.ItemsPanel&gt;\n         &lt;ItemsPanelTemplate&gt;\n            &lt;Canvas IsItemsHost=\"True\" /&gt;\n         &lt;/ItemsPanelTemplate&gt;\n     &lt;/ItemsControl.ItemsPanel&gt;\n     &lt;ItemsControl.ItemContainerStyle &gt;\n         &lt;Style &gt; \n            &lt;Style.Triggers&gt;\n                  &lt;DataTrigger Value=\"BrokenLinkLine\" Binding=\"{Binding RelativeSource={RelativeSource AncestorType={x:Type s:ToolLine}}, Path=indicator}\" &gt;\n                      &lt;Setter  Property=\"Canvas.Left\" Value=\"{Binding Corner.X}\" /&gt;\n                      &lt;Setter Property=\"Canvas.Top\" Value=\"{Binding Corner.Y}\"   /&gt;\n                  &lt;/DataTrigger&gt;\n\n                     ....More of these datatriggers for the different types of lines\n              &lt;/Style.Triggers&gt;\n         &lt;/Style&gt;\n   &lt;/ItemsControl.ItemContainerStyle&gt;\n</code></pre>\n\n<p></p>\n\n<p>The code for PointRelocateThumb:</p>\n\n<pre><code> public PointRelocateThumb()\n    {\n\n        base.DragDelta += new DragDeltaEventHandler(this.PointRelocateThumb_DragDelta);\n\n    }\n    void PointRelocateThumb_DragDelta(object sender, System.Windows.Controls.Primitives.DragDeltaEventArgs e)\n    {\n        PointRelocateThumb prt = (PointRelocateThumb)sender;\n        LineCornerPoint lcp = (LineCornerPoint)prt.DataContext;\n        Point thumbPoint = new Point(Canvas.GetLeft((ContentPresenter)prt.TemplatedParent), Canvas.GetTop((ContentPresenter)prt.TemplatedParent));\n        ToolLine toolLine = null;\n        DrawingCanvas designer = null;\n        ItemsControl itemsControl = ItemsControl.ItemsControlFromItemContainer(prt.TemplatedParent);\n        if (itemsControl != null)\n            toolLine = itemsControl.DataContext as ToolLine;\n        if (toolLine != null)\n            designer = VisualTreeHelper.GetParent(toolLine) as DrawingCanvas;\n        if (toolLine != null &amp;&amp; designer != null &amp;&amp; toolLine.IsSelected)\n        {\n            thumbPoint = new Point(thumbPoint.X + Canvas.GetLeft(toolLine) + 3.5, thumbPoint.Y + Canvas.GetTop(toolLine) + 3.5);\n\n            toolLine.undoBounding();\n            if (System.String.Compare(toolLine.indicator, \"BrokenLinkLine\") == 0\n                || System.String.Compare(toolLine.indicator, \"LinkLine\") == 0\n                || System.String.Compare(toolLine.indicator, \"OrthogonalLinkLine\") == 0\n                || System.String.Compare(toolLine.indicator, \"BrokenLine\") == 0\n                || System.String.Compare(toolLine.indicator, \"Line\") == 0\n                || System.String.Compare(toolLine.indicator, \"Polygon\") == 0)\n            {\n                if (toolLine.pathFigure.StartPoint.Equals(thumbPoint))\n                {\n                    toolLine.pathFigure.StartPoint = new Point(modifyingToolLine.pathFigure.StartPoint.X + e.HorizontalChange, modifyingToolLine.pathFigure.StartPoint.Y + e.VerticalChange);                    }\n                else\n                {\n                    foreach (LineSegment ls in toolLine.pathSegmentCollection)\n\n                    {\n                        if (ls.Point.Equals(thumbPoint))\n                        {\n                            ls.Point = new Point(ls.Point.X + e.HorizontalChange, ls.Point.Y + e.VerticalChange);\n                            break;\n                        }\n\n                    }\n                }\n            }\n           toolLine.regenerateBoundingItem();\n        }\n        e.Handled = true;\n    } \n }\n</code></pre>\n\n<p>}</p>\n\n<p>Tooline is the line class. What undo binding does is that it makes it so that toolLine has Canvas.Left and Canvas.Top set to 0, but scales the points so that they are still located at the same point - i.e. by adding the old Canvas.Left and Canvas.Top values of the toolLine to each point in the line.</p>\n\n<p>The code for regenerate Bounding item is below:</p>\n\n<pre><code>public void regenerateBoundingItem()\n{\n     //Following line of code just regenerates the underlying path for the toolLine from the \n     //new pathsegmentCollection and pathFigure start point.  \n    regenerateThisLine();\n    double leftMostPoint = double.MaxValue, topMostPoint = double.MaxValue, bottomMostPoint = double.MinValue, rightMostPoint = double.MinValue;\n    getBoundingPoints(ref leftMostPoint, ref topMostPoint, ref bottomMostPoint, ref rightMostPoint);\n\n     //subtracts leftMost point and topMostPoint from each point in the line\n     scaleLinePoints(leftMostPoint, topMostPoint); \n     Canvas.SetLeft(this, leftMostPoint);\n     Canvas.SetTop(this, topMostPoint);\n     this.Width = rightMostPoint - leftMostPoint;\n     this.Height = bottomMostPoint-topMostPoint;\n      regenerateObservableCollection();\n      regenerateThisLine();\n}\nprivate void regenerateObservableCollection()\n{\n    if (this.pointsObservableCollection == null)\n        this.pointsObservableCollection = new ObservableCollection&lt;LineCornerPoint&gt;();\n    this.pointsObservableCollection.Clear();\n    LineCornerPoint startPt = new LineCornerPoint(new Point(this.pathFigure.StartPoint.X - 3.5, this.pathFigure.StartPoint.Y - 3.5));\n    this.pointsObservableCollection.Add(startPt);\n    if (System.String.Compare(indicator, \"BrokenLine\") == 0\n        || System.String.Compare(indicator, \"BrokenLinkLine\") == 0\n        || System.String.Compare(indicator, \"LinkLine\") == 0\n        || System.String.Compare(indicator, \"Polygon\") == 0\n       || System.String.Compare(indicator, \"Line\") == 0)\n    {\n        foreach (LineSegment ls in pathSegmentCollection)\n        {\n            LineCornerPoint pt = new LineCornerPoint(new Point(ls.Point.X - 3.5, ls.Point.Y - 3.5));\n            this.pointsObservableCollection.Add(pt);\n         }\n     }\n}\n</code></pre>\n\n<p>The template for PointRelocateThumb is an ellipse of width and height 7 - which explains why I have to offset all the thumb locations by 3.5.</p>\n"},{"tags":["c#",".net","azure","windows-azure-storage","azure-storage-blobs"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":31,"score":0,"question_id":13270873,"title":"loading lots of Azure blob data in a WPF app","body":"<p>I've been given a task to build a prototype for an app. I don't have any code yet, as the solution concepts that I've come up with seem stinky at best... </p>\n\n<p><strong>The problem:</strong></p>\n\n<p>the solution consist of various Azure projects which do stuff to lots of data stored in Azure SQL db-s. Almost every action that happens creates a gzipped log file in blob storage. So that's one .gz file per log entry.</p>\n\n<p>We should also have a small desktop (WPF) app that should be able to read, filter and sort these log files.</p>\n\n<p>I have absolutely 0 influence on how the logging is done, so this is something that can not be changed to solve this problem.</p>\n\n<p><strong>Possible solutions that I've come up with (conceptually):</strong></p>\n\n<p><strong>1:</strong></p>\n\n<ul>\n<li>connect to the blob storage</li>\n<li>open the container</li>\n<li>read/download blobs (with applied filter)</li>\n<li>decompress the .gz files</li>\n<li>read and display</li>\n</ul>\n\n<p>The problem with this is that, depending on the filter, this could mean a whole lot of data to download (which is slow), and process (which will also not be very snappy). I really can't see this as a usable application.</p>\n\n<p><strong>2:</strong></p>\n\n<ul>\n<li>create a web role which will run a WCF or REST service</li>\n<li>the service will take the filter params and other stuff and return a single xml/json file with the data, the processing will be done on the cloud</li>\n</ul>\n\n<p>With this approach, will I run into problems with decompressing these files if there's a lot of them (will it take up extra space on the storage/compute instance where the service is running).</p>\n\n<p><strong>EDIT:</strong> what I mean by filter is limit the results by date and severity (info, warning, error). The .gz files are saved in a structure that makes this quite easy, and I will not be filtering by looking into the files themselves.</p>\n\n<p><strong>3:</strong></p>\n\n<ul>\n<li>some other elegant and simple solution that I don't know of</li>\n</ul>\n\n<p>I'd also need some way of making the app update the displayed logs in real time, which i suppose would need to be done with repeated requests to the blob storage/service.</p>\n\n<hr>\n\n<p>This is not one of those \"give me code\" questions. I am looking for advice on best practices, or similar solutions that worked for similar problems. I also know this could be one of those \"no one right answer\" questions, as people have different approaches to problems, but I have some time to build a prototype, so I will be trying out different things, and I will select the right answer, which will be the one that showed a solution that worked, or the one that steered me in the right direction, even if it does take some time before I actually build something and test it out.</p>\n"},{"tags":["c#","enums","iterate","function-parameter"],"answer_count":7,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":11845,"score":6,"question_id":492115,"title":"C# enums as function parameters?","body":"<p>Can you pass a standard c# enum as a parameter? </p>\n\n<p>For example:</p>\n\n<pre><code>enum e1\n{\n    //...\n}\n\nenum e2\n{\n    //...\n}\n\npublic void test()\n{\n    myFunc( e1 );\n    myFunc( e2 );\n}\n\npublic void myFunc( Enum e )\n{\n    // Iterate through all the values in e\n}\n</code></pre>\n\n<p>By doing this I hope to retrieve all the names within any given enum. What would the Iteration code look like?</p>\n"},{"tags":["c#","async-await","c#-4.5"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":86,"score":2,"question_id":13260167,"title":"Wrong C# compiler error message on async lambda type inference","body":"<p>I bumped into this C# compiler error and while I'm ok with the compiler not being able to infer the type of the lambda the error message seems wrong. Here's the relevant piece of code:</p>\n\n<pre><code>Func&lt;object&gt; lambda = async () =&gt; { return await Task.FromResult(1); };\n</code></pre>\n\n<p>and here's the compiler error:</p>\n\n<blockquote>\n  <p>error CS4010: Cannot convert async lambda expression to delegate type '<code>System.Func&lt;object&gt;</code>'. An async lambda expression may return <code>void</code>, <code>Task</code> or <code>Task&lt;T&gt;</code>, none of which are convertible to '<code>System.Func&lt;object&gt;</code>'.</p>\n</blockquote>\n\n<p>The part I don't quite understand is the last sentence. The lambda is indeed returning <code>Task&lt;int&gt;</code>, but why does the compiler think that it should try to convert it to <code>System.Func&lt;object&gt;</code>?</p>\n\n<p>On the other hand, if what the error message is trying to convey is that <code>System.Func&lt;Task&lt;int&gt;&gt;</code> cannot be assigned to <code>System.Func&lt;object&gt;</code>, that doesn't seem to be the case thanks to generic delegate covariance which means that this works just fine instead:</p>\n\n<pre><code>Func&lt;object&gt; lambda = new Func&lt;Task&lt;int&gt;&gt;(async () =&gt; { return await Task.FromResult(1); });\n</code></pre>\n"},{"tags":["c#","windows-phone-7","xaml"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13276070,"title":"WP7 Dialer number displaying number","body":"<p>In Wp7 phone when user open the keypad and press various digits those number are displayed at top of screen and once you enter digits which are more than which can be displayed. Those numbers are automatically displayed on right side. Can anyone tell how to implement feature like that?</p>\n"},{"tags":["c#","image","png","spreadsheet","gif"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13275858,"title":"spreadsheet to image file","body":"<p>Conversion of an Excel spreadsheet to image. Programming problem in C#. Starting from an Excel spreadsheet and I need to generate a gif or png file displaying the content of the spreadsheet.</p>\n"},{"tags":["c#","ms-access"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":38,"score":-5,"question_id":13275958,"title":"C# and Microsoft Access Database","body":"<p>I'm using V. C#. I use a database which my tables are in that. When I running my project one of my tables is deleting automticly. What can I do. Please help.\nhere is my sorce code :</p>\n\n<pre><code>private void button2_Click(object sender, EventArgs e)\n{\n    OleDbConnection baglanti2 = new OleDbConnection(\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=taban.accdb\");\n    baglanti2.Open();\n    komut = new OleDbCommand(\"SELECT tc,ad FROM gecmis WHERE tc='\" + textBox1.Text + \"'\", baglanti2);\n    oku = komut.ExecuteReader();\n    if (oku.Read())\n    {//eger aranan veri databasede varsa\n        MessageBox.Show(\" Hosgeldin \" + oku[\"ad\"]);\n    }\n    oku.Close();\n    baglanti2.Close();\n}\n</code></pre>\n"},{"tags":["c#","visual-studio"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13275960,"title":"upgrading: how to remove a project reference","body":"<p>I am uninstalling part of an application that involves a reference no longer used. How do I remove that project from the references folder programmatically?</p>\n\n<p>In other words, I can manually click to expand the References node and delete the reference there. However, how would I do that as part of an uninstaller program?</p>\n"},{"tags":["c#","asp.net-mvc-3","linq","entity-framework","lambda"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13273012,"title":"How to combine two model list to one model","body":"<p>Please see code below :</p>\n\n<pre><code>public class NewsFilterModel\n{\n    public CtArticleDetail ArticleDetail { get; set; }\n\n    public PcPage Page { get; set; }\n}\n\npublic IEnumerable&lt;NewsFilterModel&gt; GetNewsFilterModelByTagNames(string tagNames, int status)\n{\n     var resultArticle = db.CtArticleDetail.Where(m =&gt; m.tagNames == tagNames);\n     var resultPage  = db.PcPage.Where(m =&gt; m.tagNames == tagNames);\n}\n</code></pre>\n\n<p>Can anyone please advice what the best way to combine two model to one model which is NewsFilterModel ?</p>\n\n<p>What I am trying to achieve is:</p>\n\n<p>NewsFilterModelList</p>\n\n<pre><code>1.Article1\n2.Page1\n3.Article2\n4.Page2\n5.Article3\n6.Page3\n</code></pre>\n\n<p>I've ended this like below: </p>\n\n<pre><code>foreach (var item in pageResult)\n            {\n                resultList.Add(new NewsFilterModel { ArticleDetail = null, Page = item, Date = item.UpdatedOn.ToDateTime() });\n            }\n\n            foreach (var item in tempArticleList)\n            {\n                resultList.Add(new NewsFilterModel { ArticleDetail = item, Page = null, Date = item.LiveDate.ToDateTime() });\n            }\n\n            return resultList.AsEnumerable();\n</code></pre>\n\n<p>Anyone has better idea, please advice.</p>\n"},{"tags":["c#","entity-framework","asp.net-web-api",".net-4.5"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":134,"score":3,"question_id":13077328,"title":"Serialization Issues with Web API and Entity Framework Contract First Many to Many Relationship","body":"<p>I am attempting to use EF with Code First and the Web API.  I don't have any problems until I get into serializing Many-to-Many relationships.  When I attempt to execute the following web api method below I get the following error message:</p>\n\n<pre><code>public class TagsController : ApiController\n{\n\n        private BlogDataContext db = new BlogDataContext();\n\n        // GET api/Tags\n        public IEnumerable&lt;Tag&gt; GetTags()\n        {\n            return db.Tags.AsEnumerable();\n        }\n}\n</code></pre>\n\n<p>I get the following error:</p>\n\n<blockquote>\n  <p>'System.Data.Entity.DynamicProxies.Tag_FF17EDDE6893000F7672649A39962DB0CA591C699DDB73E8C2A56203ED7C7B6D'\n  with data contract name\n  'Tag_FF17EDDE6893000F7672649A39962DB0CA591C699DDB73E8C2A56203ED7C7B6D:http://schemas.datacontract.org/2004/07/System.Data.Entity.DynamicProxies'\n  is not expected. Consider using a DataContractResolver or add any\n  types not known statically to the list of known types - for example,\n  by using the KnownTypeAttribute attribute or by adding them to the\n  list of known types passed to DataContractSerializer.</p>\n</blockquote>\n\n<p>I have read some SO articles (<a href=\"http://stackoverflow.com/questions/11315311/using-navigation-properties-in-entity-framework-code-first\">article 1</a>, <a href=\"http://stackoverflow.com/questions/9071118/efcf-many-to-many-in-a-detached-context\">article 2</a>) that the fix is to add the following attribute:</p>\n\n<blockquote>\n  <p>[DataContract (IsReference=true)]</p>\n</blockquote>\n\n<p>but this has had no effect.  Also using [IgnoreDataMember] does not have an effect.  The only option that does seem to work is to set Configuration.ProxyCreationEnabled to false.  Is this my only option?  Am I missing something?</p>\n\n<p><em><strong>Sample POCO objects:</em></strong></p>\n\n<p><strong>Tag</strong></p>\n\n<pre><code>[DataContract(IsReference = true)]\npublic class Tag\n{\n        public Tag()\n        {\n            this.Blogs = new HashSet&lt;Blog&gt;();\n        }\n\n        [Key]\n        [DataMember]\n        public int Id { get; set; }\n\n        [DataMember]\n        public string Name { get; set; }\n\n        [IgnoreDataMember]\n        public virtual ICollection&lt;Blog&gt; Blogs { get; set; }\n}\n</code></pre>\n\n<p><strong>Blog</strong></p>\n\n<pre><code>[DataContract(IsReference = true)]\npublic class Blog\n{\n    public Blog()\n    {\n        this.Tags = new HashSet&lt;Tag&gt;();\n    }\n\n    [Key]\n    [DataMember]\n    public int Id { get; set; }\n\n    [DataMember]\n    public string Name { get; set; }\n\n    [IgnoreDataMember]\n    public virtual ICollection&lt;Tag&gt; Tags { get; set; }\n}\n</code></pre>\n"},{"tags":["c#","asp.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13275907,"title":"MapPath vs VirtualPathUtility.ToAbsolute","body":"<p>I am using c#, asp.net and working on a web application.  </p>\n\n<p>I initially had a relative path as such which I needed to be an absolute path.\nThe below works but need to get the absolute path:</p>\n\n<pre><code>    return Chart.RenderChartHTML(\"../../Charts/MSLine.swf\");\n</code></pre>\n\n<p>I tried the following which didn't work (note that it gives me the complete path on my hard drive to .swf):</p>\n\n<pre><code>    string mslinepath = HttpContext.Current.Server.MapPath(\"Charts/MSLine.swf\");\n\n    return Chart.RenderChartHTML(mslinepath);\n</code></pre>\n\n<p>I then tried the following which works:</p>\n\n<pre><code>    string mslinepath = VirtualPathUtility.ToAbsolute(\"~/Charts/MSLine.swf\");\n\n    return Chart.RenderChartHTML(mslinepath);\n</code></pre>\n\n<p>Wondering why VirtualPathUtility.ToAbsolute works while the other one doesn't.  </p>\n"},{"tags":["c#","primes"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":51,"score":-1,"question_id":13275080,"title":"Input an Integer and get its prime factors and duplicates","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/5872962/prime-factors-in-c-sharp\">Prime Factors In C#</a>  </p>\n</blockquote>\n\n\n\n<p>I am trying to get this coding to give me all the prime factors of the integer that is inputted, including its duplicates. I have this current code and it seems to be working sort of but it isn't showing all of it's prime factors and duplicates. Any help would be appreciated.</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\n\nnamespace _1_Numeric_Problem\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            string myInput;\n            int myInt;\n            int p;\n\n            Console.WriteLine((\"Please input an integer\"));\n\n            myInput = Console.ReadLine();\n            myInt = Int32.Parse(myInput);\n\n            {\n                for (int i = 2; i &gt; 1; i++)\n                {\n                    if (i == 100000)\n\n                        break;\n\n                    if (myInt % i == 0)\n                    {\n\n                        if (i &lt;= 3)\n                        {\n\n                            Console.Write(\"{0} \", i);\n                            Console.ReadLine();\n                            continue;\n                        }\n\n                        else\n                        {\n                            for (p = 2; p &lt; i; p++)\n                                if (i % p != 0)\n                                {\n                                    Console.Write(\"{0} \", i);\n                                    Console.ReadLine();\n                                    return;\n                                    Console.ReadLine();\n                                }\n                                else\n                                {\n                                    p++;\n                                    continue;\n                                }\n\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","xna","hlsl"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13274501,"title":"XNA .FBX Vertex Color Missing","body":"<p>When I vertex paint and export my models from Blender (and Maya) for use in my XNA 4.0 project, I somehow lose the vertex color channel for the model. I use no custom model object or content pipelines and my own shader throws me the error:</p>\n\n<p><em><strong>The current vertex declaration does not include all the elements required by the current vertex shader. Color0 is missing.</em></strong></p>\n\n<p>I tryed to reopen the model in other modeling tools and the vertex colors are there.\nWhat could cause the vertex color channel to not get loaded in XNA 4.0?</p>\n"},{"tags":["c#","sharepoint"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":742,"score":1,"question_id":6140787,"title":"How to get the Last Added Document ID in SharePoint using List.asmx","body":"<p>Actually I want to add the title and other fields value, but I don't have the Item Id? I am adding Document content using WebRequest. it added successfully, to add other information title etc I am using Batch Element but it not do any change and If I pass ID manually, it set the values as expected.</p>\n"},{"tags":["c#","asp.net","session-variables"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":2169,"score":2,"question_id":9623150,"title":"Asp.net session variable","body":"<p>I have a asp.net project with c# code behind. I have a static class called GlobalVariable where I store some information, like the currently selected product for example.</p>\n\n<p>However, I saw that when there are two users using the website, if one changes the selected product, if changes it for everybody. The static variables seem to be commun to everybody.</p>\n\n<p>I would want to create (from the c# code) some kind of session variable used only from the c# code, but not only from the page, but from any class.</p>\n"},{"tags":["c#","asp.net","entity-framework","asp.net-webforms"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13173530,"title":"How to retrieve data from my Entitiy Model in code-behind","body":"<p>I created my tables, then my <code>Entity Model</code> (<code>Model1.edmx</code>).\n<br>I can drag &amp; drop a <code>GridView</code> and <code>EntityDataSource</code> control, they work fine.</p>\n\n<p>but I need to use my data model in code-behind. \n<br>I should be able to query a single record.\n<br>For example, in <code>Page_Load</code> event I want to fill the textboxes with specific record.</p>\n\n<p>I don't know where to begin with, the namespaces, instantiating the object etc. Any help is appreciated.</p>\n\n<p>I'm using <code>WebForms</code>(c#) with <code>EntityFramework</code></p>\n"},{"tags":["c#","vb.net","vb.net-to-c#"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":55,"score":5,"question_id":13275895,"title":"C# equivalent to \"Not MyEnum.SomeValue\"","body":"<p>I'm trying to convert some VB.net code to C#.  I used SharpDevelop to do the heavy lifting; but the code it generated is breaking on some of the enum manipulation and I'm not sure how to fix it manually.</p>\n\n<p>Original VB.net code:</p>\n\n<pre><code>Enum ePlacement\n    Left = 1\n    Right = 2\n    Top = 4\n    Bottom = 8\n    TopLeft = Top Or Left\n    TopRight = Top Or Right\n    BottomLeft = Bottom Or Left\n    BottomRight = Bottom Or Right\nEnd Enum\n\nPrivate mPlacement As ePlacement\n\n''...\n\nmPlacement = (mPlacement And Not ePlacement.Left) Or ePlacement.Right\n</code></pre>\n\n<p>generated C# code:</p>\n\n<pre><code>public enum ePlacement\n{\n    Left = 1,\n    Right = 2,\n    Top = 4,\n    Bottom = 8,\n    TopLeft = Top | Left,\n    TopRight = Top | Right,\n    BottomLeft = Bottom | Left,\n    BottomRight = Bottom | Right\n}\n\nprivate ePlacement mPlacement;\n\n//...\n\n//Generates CS0023:   Operator '!' cannot be applied to operand of type 'Popup.Popup.ePlacement'\nmPlacement = (mPlacement &amp; !ePlacement.Left) | ePlacement.Right;\n</code></pre>\n\n<p>Resharper suggests adding the <code>[Flags]</code> attribute to the enum; but doing so doesn't affect the error.</p>\n"},{"tags":["c#",".net","winrt","microsoft-metro"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1019,"score":0,"question_id":8300197,"title":"How to download a webpage in MetroStyle app (WinRT) and C#","body":"<p>I'm creating a MetroStyle app and I want to use a website API that is based on the HTTP Get methods. For instance to login I should download the XML returned by this URL:</p>\n\n<p><code>websitehost.com/api/login.php?u=username&amp;p=password</code></p>\n\n<p>The problem is that the new MetroStyle apps won't let me to use many of the methods I've been using for years in .Net so how can I download the returned XML document and parse it?</p>\n"},{"tags":["c#","list"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13275768,"title":"list.add seems to be adding a reference to the original object?","body":"<p>I have created a couple custom classes (<code>NTDropDown</code> and <code>NTBaseFreight</code>) which I use to store data that I retrieve from a DB. I initialize a List of <code>NTBaseFreight</code> and 2 lists for <code>NTDropDown</code>. </p>\n\n<p>I can successfully use <code>List.Add</code> to add freights to the freights list, but as I debug the code, my 2 dropdown lists contain only 1 <code>NTDropDown</code>, which always has the same values as <code>NTDropDown</code> (I'm assuming this is a referencing problem, but what am I doing wrong)?</p>\n\n<p>To give an example, on the second row, if the carrier and <code>carrier_label</code> were <code>\"001\", \"MyTruckingCompany\"</code> and I put a break on the if statement for <code>frt_carriers</code>, both frt_carriers and frt_modes would contain only 1 item in their list, with the values <code>\"001\", \"MyTruckingCompany\"</code>...the same values in <code>NTDropDown</code>.</p>\n\n<p>Code:</p>\n\n<pre><code>List&lt;NTDropDown&gt; frt_carriers = new List&lt;NTDropDown&gt;();\nList&lt;NTDropDown&gt; frt_modes = new List&lt;NTDropDown&gt;();\nList&lt;NTBaseFreight&gt; freights = new List&lt;NTBaseFreight&gt;();\nNTDropDown tempDropDown = new NTDropDown();\nNTBaseFreight tempFreight = new NTBaseFreight();\n\n//....Code to grab data from the DB...removed\n\nwhile (myReader.Read())\n{\n    tempFreight = readBaseFreight((IDataRecord)myReader);\n\n    //check if the carrier and mode are in the dropdown list (add them if not)\n    tempDropDown.value = tempFreight.carrier;\n    tempDropDown.label = tempFreight.carrier_label;\n    if (!frt_carriers.Contains(tempDropDown)) frt_carriers.Add(tempDropDown);\n\n    tempDropDown.value = tempFreight.mode;\n    tempDropDown.label = tempFreight.mode_label;\n    if (!frt_modes.Contains(tempDropDown)) frt_modes.Add(tempDropDown);\n\n    //Add the freight to the list\n    freights.Add(tempFreight);\n}\n</code></pre>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13265259,"title":"How to use C# to confirm a computer has the harddisk raid or not?","body":"<p>Can I use C# to confirm a computer has harddisk raid or not? WMI only can know how many harddisk on the computer. There are no keywords can know the computer has the raid or not.</p>\n"},{"tags":["c#","wpf","styles"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":16,"score":2,"question_id":13275765,"title":"WPF TextBlock Style Underline on Mouse Hover","body":"<p>Simple question. Can the following WPF C# code cut down some weight? I mean, WTF, uh... I mean WPF, come one. Have you every seen CSS? I only want to underline the Text when I hover with the mouse just like a link. Do I really have to add 9 lines for that?</p>\n\n<pre><code>&lt;TextBlock x:Name=\"Cassette_tblPrintLabel\" Text=\"Print Label\" Canvas.Left=\"154\" Canvas.Top=\"215\" Foreground=\"#FF3355FF\" Cursor=\"Hand\" MouseDown=\"Cassette_lblPrintLabel_MouseDown\"&gt;\n    &lt;TextBlock.Style&gt;\n        &lt;Style TargetType=\"TextBlock\"&gt;\n            &lt;Style.Triggers&gt;\n            &lt;Trigger Property=\"IsMouseOver\" Value=\"True\"&gt;\n                &lt;Setter Property=\"TextBlock.TextDecoration\" Value=\"Underline\" /&gt;\n            &lt;/Trigger&gt;\n            &lt;/Style.Triggers&gt;\n        &lt;/Style&gt;\n    &lt;/TextBlock.Style&gt;\n&lt;/TextBlock&gt;\n</code></pre>\n\n<p>Thanks in advance!</p>\n"},{"tags":["c#","visual-studio-2008","tfs","tfs2008"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13275776,"title":"directory not empty message after get latest","body":"<p>Environment: Visual Studio 2008 and Team Foundation Server 2008</p>\n\n<p>I am getting a \"Cannot delete because directory not empty\" message after doing a Get Latest. Any ideas why?</p>\n"},{"tags":["c#","bitmap","texture2d","sharpdx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13038312,"title":"SharpDX Texture2D to Bitmap","body":"<p>I have a problem with using SharpDX. I convert a Bitmap, lock the bits with the lockBits method and then create a DataStream and build a Texture2D from it. This seems to work quite well, no error occurs.\nNow I have the following problem. I want to convert the Texture2D back to a Bitmap. There is a method called Texture2D.ToStream(size, texture2D, stream) but when I try this only an error occurs.\nCan anyone help me with this issue? A conversion to an Image or WriteableBitmap would be also okay.</p>\n"},{"tags":["c#","arrays","generics","multidimensional-array"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13275780,"title":"Method to check if a point is in array's bounds","body":"<p>I'd like to make a method that will accept any two-dimensional array and a point and check if the point's coordinates are within the array's dimensions.</p>\n\n<p>I don't understand how to pass any kind of 2d array into this method.</p>\n\n<pre><code>Check(&lt;T&gt;[,] arr, Point p)\nCheck(Array[,] arr, Point p)\n</code></pre>\n\n<p>Both give me different kinds of errors.</p>\n"},{"tags":["c#","api","url","google"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13275735,"title":"Accessing Google address API getting unauthorized response","body":"<p>I am at a loss as to how not to get the following error after calling the Google API to standardize an address using C# .NET 2008:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>System.Net.WebException: The remote server returned an error: (401) Unauthorized.\n</code></pre>\n\n<p>My main code is as such:</p>\n\n<pre><code>string clientId = \"hiddenclientID\";\nstring signature = \"hiddenKey\";\n\nstring url = \"http://maps.googleapis.com/maps/api/geocode/xml?address=\"+address.Replace(' ', '+')+\"&amp;client=\"+clientId+\"&amp;sensor=false\";\n\nstring signedUrl = Sign(url, signature);\n\nHttpWebResponse response = (HttpWebResponse)WebRequest.Create(signedUrl).GetResponse();\n\nMessageBox.Show(response.ToString());\n</code></pre>\n\n<p>My Sign() function is as such:</p>\n\n<pre><code>public static string Sign(string url, string keyString) {       \nASCIIEncoding encoding = new ASCIIEncoding();        \n\nstring usablePrivateKey = keyString.Replace(\"-\", \"+\").Replace(\"_\", \"/\");       \nbyte[] privateKeyBytes = Convert.FromBase64String(usablePrivateKey);        \nUri uri = new Uri(url);       \nbyte[] encodedPathAndQueryBytes = encoding.GetBytes(uri.LocalPath + uri.Query);        \n\nHMACSHA1 algorithm = new HMACSHA1(privateKeyBytes);       \nbyte[] hash = algorithm.ComputeHash(encodedPathAndQueryBytes);        \nstring signature = Convert.ToBase64String(hash).Replace(\"+\", \"-\").Replace(\"/\", \"_\");        \n\nreturn uri.Scheme+\"://\"+uri.Host+uri.LocalPath + uri.Query +\"&amp;signature=\" + signature;     \n            }\n</code></pre>\n\n<p>I am only trying to get the XML response from my request at this point.</p>\n\n<p>Any help would be great.</p>\n"},{"tags":["c#","asp.net-mvc","razor"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13275664,"title":"Passing parameters to a partial view using Html.Action","body":"<p>I am developing an MVC application (razor syntax), and I am having issues passing parameters into my <code>Html.Action</code> call. Below is a search page I am implementing. Note, the model contains distinct values to be used in the dropdowns.</p>\n\n<p>Call From View:</p>\n\n<pre><code>@using(Html.BeginForm(\"Search\", \"Home\", FormMethod.Get, null)){\n\n@Html.LabelFor(model =&gt; model.siteCode)\n@Html.DropDownListFor(model =&gt; model.siteCode, new SelectList(Model.siteCode), \"All\")\n\n@Html.LabelFor(model =&gt; model.group)\n@Html.DropDownListFor(model =&gt; model.group, new SelectList(Model.group), \"All\")\n}\n\n@Html.Action(\"ShowOrderData\", \"Home\", new {siteCode = Model.siteCode, group = Model.group}\n</code></pre>\n\n<p>Action in Controller:</p>\n\n<pre><code>public ActionResult ShowOrderData(string siteCode = \"\",\n                                        string group = \"\",)\n{\n        var model = _db.ToolOrders\n            .Where(r =&gt; r.SiteCD_LOC.Contains(siteCode))\n            .Where(r =&gt; r.GroupCode.Contains(group))\n\nreturn PartialView(\"_OrderData\", model);\n}\n</code></pre>\n\n<p>Note: There may be some syntactical errors. There are about 10 more parameters being passed and I didn't want to clog up the code blocks.</p>\n\n<p>So when debugging with this code, empty strings are sent to my <em>ShowOrderData</em> controller. I attempted to add .ToString in the Html.Action call ( <code>Model.siteCode.ToString()</code> ), and a LINQ statement will show up instead. I am guessing this method is wrong because the model does not contain any information from the previous request.</p>\n\n<p>How do I properly send data from the QueryString to a partial view? I've seen methods that access the queryString directly via request.querystring, but I've also heard that it is bad practice to use that in a view.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","service","access-denied","windows-xp-sp3"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":840,"score":1,"question_id":2286801,"title":"Can't access web service when connected to the network :: HTTP 407","body":"<p>I have a console application that communicates with a web service. Both of them are on the same machine.</p>\n\n<p>When I am accessing the web service with the LAN disabled, it connects without a problem. But if the LAN is enabled and connected to our office network, I receive this error:</p>\n\n<p>\"HTTP 407 Proxy Authentication required - The ISA Server requires authorization to fulfill the request. Access to the Web Proxy service is denied.\"</p>\n\n<p>We've been hunting the source of the problem for three days now. We have tried everything that we can think of. Any ideas what's causing the problem?</p>\n\n<p>Additional notes:\n- The machine is in a Workgroup setup but with DNS suffix (computer.local). When accessing the web service, we type the address as \"http://machine.computer.local/service.asmx\"</p>\n\n<ul>\n<li><p>I talked to the IT guys and they said that we don't have an ISA server installed</p></li>\n<li><p>There is no \"proxy\" set in IE.</p></li>\n<li><p>The machine is in mint condition.</p></li>\n</ul>\n"},{"tags":["c#","visual-studio-2010","loops","dataset"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":14,"score":2,"question_id":13275622,"title":"Create a Set of String with Column Header as string title and string value as row 0 value","body":"<p>I have column 1 column 2 and column 3. At row 0 for each of these i have Values 1,2,3 respectively. </p>\n\n<p>How can I build a loop that will set </p>\n\n<pre><code>string column 1 = 1\nstring column 2 = 2\nstring column 3 = 3 \n</code></pre>\n\n<p>so that the strings name is the column headers and the value of the string is the value in row 0 of that column.</p>\n\n<p>This needs to be done for about 150+ columns and I am looking to avoid individually typing out. </p>\n\n<p>Columns are in a table called \"ShipmentInfo\"</p>\n"},{"tags":["c#","reflection"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13270183,"title":"Type conversion issue when setting property through reflection","body":"<p>We have a property of type <code>long?</code> that gets filled with an <code>int</code>.</p>\n\n<p>This works fine when i just set the property directly <code>obj.Value = v;</code> but when i try and set the property through reflection <code>info.SetValue(obj, v, null);</code> it gives me a the following exception:</p>\n\n<blockquote>\n  <p>Object of type 'System.Int32' cannot be converted to type 'System.Nullable`1[System.Int64]'.</p>\n</blockquote>\n\n<p>This is a simplified scenario:</p>\n\n<pre><code>    class TestClass\n    {\n        public long? Value { get; set; }\n    }\n\n    [TestMethod]\n    public void TestMethod2()\n    {\n        TestClass obj = new TestClass();\n        Type t = obj.GetType();\n\n        PropertyInfo info = t.GetProperty(\"Value\");\n        int v = 1;\n\n        // This works\n        obj.Value = v;\n\n        // This does not work\n        info.SetValue(obj, v, null);\n    }\n</code></pre>\n\n<p>Why does it not work when setting the property through <code>reflection</code> while it works when setting the property directly?</p>\n"},{"tags":["c#","asp.net-mvc","asp.net-mvc-2"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13270775,"title":"Why Not looking for the View in the correct location","body":"<p>I'm an MVC newbie so this might sound trivial.I have my 2 Views(EnterLogin.aspx,ShowLogin.aspx) in a folder called <code>LoginForm</code> in Views.\nHere is my Global.asax.cs below</p>\n\n<pre><code>public class MvcApplication : System.Web.HttpApplication\n{\n    public static void RegisterRoutes(RouteCollection routes)\n    {\n        routes.IgnoreRoute(\"{resource}.axd/{*pathInfo}\");\n\n        routes.MapRoute(\n            \"Default\", // Route name\n            \"{controller}/{action}/{id}\", // URL with parameters\n            new { controller = \"LoginForm\", action = \"ShowLogin\", id = UrlParameter.Optional } // Parameter defaults\n        );\n    }\n\n    protected void Application_Start()\n    {\n        AreaRegistration.RegisterAllAreas();\n\n        RegisterRoutes(RouteTable.Routes);\n    }\n}\n</code></pre>\n\n<p>Here is my ShowLogin.aspx design code</p>\n\n<pre><code>&lt;form method=\"post\" action=\"EnterLogin\" runat=\"server\"&gt;\n    Hello, i'm login page\n    Enter Name   &lt;asp:TextBox ID=\"txtName\" runat=\"server\"&gt;&lt;/asp:TextBox&gt;\n    &lt;input type=\"submit\" value=\"PressMe\" /&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Here are my controllers</p>\n\n<pre><code>public class LoginFormController : Controller\n{\n    public ActionResult ShowLogin()\n    {\n        return View();\n    }\n\n    public ActionResult EnterLogin()\n    {\n        return View(\"EnterLogin\");\n    }\n}\n</code></pre>\n\n<p>On running the application it first loads with url </p>\n\n<pre><code>http://localhost:50224/\n</code></pre>\n\n<p>and shows the ShowLogin.aspx View</p>\n\n<p>On clicking the button I'm calling <code>EnterLogin</code> controller to show <code>EnterLogin</code> View but it looks in URL</p>\n\n<pre><code>http://localhost:50224/EnterLogin\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>http://localhost:50224/LoginForm/EnterLogin\n</code></pre>\n\n<p>What could be causing this?</p>\n"},{"tags":["c#",".net","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":12964757,"title":"Pass sysname in datatable TVP","body":"<p>I have a stored procedure using the type below as a param</p>\n\n<pre><code>    CREATE TYPE [dbo].[columnOrderTableType] AS TABLE\n     ([id]                     [int]        IDENTITY(1,1) NOT NULL\n     ,[columnName]             [sysname]                  NOT NULL\n</code></pre>\n\n<p>I need to pass a datatable from my api as TVP to this sproc</p>\n\n<p>When I use string as value for the columnName I get an error saying that type doesnt match the types reqd for columnOrderTableType</p>\n\n<p>How do I pass a sysname in datatable?</p>\n"},{"tags":["c#","xsd.exe"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13275685,"title":"Generate class from XSD with short class names","body":"<p>Is there a tool that will generate deeply-nested classes with short class names, e.g. just the element name?</p>\n\n<p>The data could be thought of like this XML:</p>\n\n<pre><code>&lt;Family&gt;\n  &lt;GreatGrandParent&gt;\n    &lt;GrandParent&gt;\n      &lt;Parent/&gt;\n      &lt;Parent&gt;\n        &lt;Child /&gt;\n        &lt;Child /&gt;\n      &lt;/Parent&gt;\n      &lt;Parent/&gt;\n    &lt;/GrandParent&gt;\n    &lt;GrandParent/&gt;\n  &lt;/GreatGrandParent&gt;\n&lt;/Family&gt;\n</code></pre>\n\n<p>but when I generate the class using XSD.exe, I get unwieldy class names representing the entire tree like \"FamilyGreatGrandParentGrandParentParentChild\" rather than \"Child\" at the leaf level.</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13275532,"title":"Including 3rd party code as source vs dll","body":"<p>There is a Github project for a C# library that I'd like to use. Is it more conventional to include the source as a separate project in my Visual Studio solution and build the dll as part of the regular compilation process, or to build a dll separately and include just that in my project reference?</p>\n"},{"tags":["c#","xna"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13273781,"title":"XNA-Moving rotated camera(view) relative to world","body":"<p>So I've been trying to get this to work but no luck so far, hopefully you can help. The thing is I have a camera in my project that the user can freely move with mouse and buttons. \nCurrently like so:\n<code>move = new Vector3(0, 0, -1) * moveSpeed;\n      move = new Vector3(0, 0, 1) * moveSpeed;\n...\n</code>\nAnd then I just add move vector to cameraPos vector: <code> cameraPos += move </code></p>\n\n<p>Then problem is if I rotate the camera and then try to move, for example down, it will not move straight down but in a certain angle. I am assuming this is due to moving on local axis. But what I want to do is to move on a world axis. Is something like that possible, or do I have to somehow calculate the angle and then move on more than one axis?</p>\n\n<p>Best regards!</p>\n"},{"tags":["c#","html-agility-pack","keynotfoundexception"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13275620,"title":"KeyNotFoundException with using HtmlEntity.DeEntitize() method","body":"<p>I am currently working on a scraper written in C# 4.0. I use variety of tools, including the built-in WebClient and RegEx features of .NET. For a part of my scraper I am parsing a HTML document using HtmlAgilityPack. I got everything to work as I desired and went through some cleanup of the code.</p>\n\n<p>I am using the <code>HtmlEntity.DeEntitize()</code> method to clean up the HTML. I made a few tests and the method seemed to work great. But when I implemented the method in my code I kept getting <code>KeyNotFoundException</code>. There are no further details so I'm pretty lost. My code looks like this:</p>\n\n<pre><code>WebClient client = new WebClient();\nstring html = HtmlEntity.DeEntitize(client.DownloadString(path));\nHtmlDocument doc = new HtmlDocument();\ndoc.LoadHtml(html);\n</code></pre>\n\n<p>The HTML downloaded is UTF-8 encoded. How can I get around the <code>KeyNotFound</code> exception?</p>\n"},{"tags":["c#","wpf","c#-4.0"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13275235,"title":"What is the difference between Activator.CreateInstance and a standard constructor?","body":"<p>What is the diffrenece between the two examples below? What is the purpose of <code>Activator</code>, why would I use it?</p>\n\n<p>1.</p>\n\n<pre><code>string objTypeName = \"Foo\";\nFoo foo = (Foo)Activator.CreateInstance(Type.GetType(objTypeName));\n</code></pre>\n\n<p>2.</p>\n\n<pre><code>Foo foo = new Foo()\n</code></pre>\n\n<p>I went through below the pages linked below, but didn't get a clear picture.</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/system.activator_methods.aspx\" rel=\"nofollow\">Here</a> , <a href=\"http://stackoverflow.com/questions/7598088/purpose-of-activator-createinstance-with-example\">here</a> and <a href=\"http://msdn.microsoft.com/en-us/library/wccyzw83.aspx\" rel=\"nofollow\">here</a>.</p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13273887,"title":"LINQ query to group records by month within a period","body":"<p>I am looking for some help on adapting the following LINQ query to return all dates within the next 6 months, even those where no records fall within the given month.</p>\n\n<pre><code>var maxDate = DateTime.Now.AddMonths(6);\n\nvar orders = (from ord in db.Items\n\nwhere (ord.Expiry &gt;= DateTime.Now &amp;&amp; ord.Expiry &lt;= maxDate)\n\ngroup ord by new\n    {\n        ord.Expiry.Value.Year,\n        ord.Expiry.Value.Month\n    }\ninto g\nselect new ExpiriesOwnedModel\n    {\n        Month = g.Select(n =&gt; n.Expiry.Value.Month).First(),\n        Quantity = g.Count()\n    }).ToList();\n</code></pre>\n\n<p>I'd really appreciate any assistance or pointers on how best to implement this.</p>\n"},{"tags":["c#","string","c#-4.0"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":33,"score":0,"question_id":13275069,"title":"'u0022' to introduce quotation marks to string C#","body":"<p>I have a string property that returns a directory, it has \"program file//\" in it, so to use it in a command prompt, I have to use quotation mark around the string. But if I do the following</p>\n\n<pre><code>string myDic = someDic;\n\nstring myCmdPrptDic = '\\u0022' + someDic + \"\\u0022'\n</code></pre>\n\n<p>myCmdPrptDic ends up like \\\"C://Program Files//myApp\\\" and will not work under cmd prompt. Is there a way to just create \"C://Program Files//myApp\" only? Or maybe I should just use a stringBuilder....</p>\n\n<p>I just need to generate a string like:</p>\n\n<pre><code>copy //data/file// \"C://program files//myapp\"\n</code></pre>\n\n<p>but I could not do it as </p>\n\n<pre><code>string = \"copy //data//file\" +\" \"+ '\\u0022' + someDic + \"\\u0022';\n</code></pre>\n"},{"tags":["c#","wpf","wcf","mvvm","user-roles"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":91,"score":2,"question_id":13206409,"title":"Assigning Roles to Application Users","body":"<p>As in all the Line-Of-Business Applications, an application may have multiple <code>Users</code> with some <code>Roles</code> assigned to them. We have recently shifted to WPF MVVM Architecture and looking for best way to assign role to each logged in user. There are many terms floating over internet like Authentication, RoleManager, LoginService etc, but I am not sure which to work out with.</p>\n\n<p><strong>Here is what we have:</strong></p>\n\n<p>A small business application (With 20 Forms), developed within a single-project. We use <code>MVVM</code> architecture, <code>LINQ-to-SQL</code> as DataAccess and <code>Model</code>, with <code>Repository pattern</code> and <code>Unit Of Work</code>.</p>\n\n<p><strong>What we want:</strong></p>\n\n<p>There are different forms and each form has <em>insert</em>, <em>update</em>, <em>delete</em>, <em>print</em> etc operations. What we want is to restrict a logged in user according to his role - to the task he can perform. i.e for e.g. Admin is free to do \"<em>anything</em>\" with the application, while some other users may not be allowed to view some forms or carry out some operations (viz. update or delete).</p>\n\n<p>So how can we achieve this; what kind of service could be used for carrying out this complete mechanism using MVVM architecture within a Desktop LOB application. A technical term or tutorial link will be helpful.</p>\n\n<p>I hope I am clear and thank you very much in advance.</p>\n\n<p><strong>Edit:</strong>  I went through many forums and articles around, but all of them focuses on ASP.NET. Still cannot find a concrete implementation for assignment of roles within WPF. And the sources on ASP.NET doesn't comply well with WPF.  </p>\n"},{"tags":["c#","visual-studio","port","p2p","firewall"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":20,"score":1,"question_id":13275547,"title":"Open ports for p2p chat","body":"<p>I want to write a p2p chat program using server in c#.\nBasically, when client A would want to send a message to client B,\nthe server will notify client B for the request, and open\nport and create socket. The messages will transfer directly from\none clint to the other.</p>\n\n<p>The Question:\nHow can i open port on the firewall and save it in the NAT?\nIs there any c# code for that (open source)?</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13274444,"title":"Get mouse coords relative to other window","body":"<p>I would like to get the mouse coords relative to another window (window client area), the window is not part of my application. </p>\n\n<p>I would prefer to do this without delving into the Win32 API and dll imports, but I'm not sure if it's possible.</p>\n\n<p>The basic idea is: My C# WPF app will have the users focus, when the user presses a hot key(CTRL + C) the app will get the coords relative to the client area of an earlier specified window. It's just a quick app I need to make for in-house development assistance.</p>\n"},{"tags":["c#","c++","sharing"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":57,"score":-2,"question_id":13275264,"title":"Sharing variables between C# and C++","body":"<p>I'm writing a software in c# which needs to call many times and by many threads some functions in a c++ unmanaged dll. </p>\n\n<p>I'm able to call the functions, but at every call I have to pass complex variables, most of which are the same for each thread. \nSo I was considering sharing variables by the c# class and the c++ dll functions, instead of passing them every time.</p>\n\n<p>Are Memory mapped files all I need, or there exist more appropriate solutions?<br>\nThank you.</p>\n"},{"tags":["c#","report-viewer2010"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":9,"score":1,"question_id":13275514,"title":"Reportviewer: Subscript in a label","body":"<p>I am using MS reportviewer, C# (VS 2010)</p>\n\n<p>In a tablix column header, is it possible to display a letter as subscript in a label?</p>\n"},{"tags":["c#","coded-ui-tests"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":51,"score":-1,"question_id":12989046,"title":"Obtain List of Test Cases for a Coded UI Project Programatically","body":"<p>I have a coded ui project, in which i have a set of test cases recorded (methods)\nIs there a way to obtain the list of test cases programmatically(C#) and also get the description i have given during the Record phase</p>\n"},{"tags":["c#"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":577,"score":1,"question_id":6915638,"title":"Reading csv file into a DataTable using C#?","body":"<p>I have a number of Python scripts I wrote a while back, to do some data munging.\nI need to 'port' some of those scripts to C#.</p>\n\n<p>Python provides a CSV module which facilitates importing CSV data from file into a dictionary. I want to have the same functionality in my library, but since I am new to C#, decided to come in here to ask for the best practices way to import CSV data into a DataTable.</p>\n\n<p>Do I roll my own, or is there a 'CSV module' ala Python?</p>\n"},{"tags":["c#","ef-migrations","entity-framework-5","code-first-migrations"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":607,"score":0,"question_id":11974439,"title":"Changing column default values in EF5 Code First","body":"<p>I'm trying to use CF to build a model for an existing database.  I have a column in which I forgot to set a sane default value.  And rather than compromise the purity of the initial migration by changing it, I just figured I'd create another migration (that's what migrations are for, right?  :) </p>\n\n<pre><code>public override void Up()\n{\n    AlterColumn(\"Config\", \"DefaultTaxPerDollar\", c => c.Decimal(nullable: false, precision: 19, scale: 5, defaultValue: 0.087m));\n}\n\npublic override void Down()\n{\n    AlterColumn(\"Config\", \"DefaultTaxPerDollar\", c => c.Decimal(nullable: false, precision: 19, scale: 5, defaultValue: 0.0m));\n\n}\n\n</code></pre>\n\n<p>But this produces <code>Column already has a DEFAULT bound to it.</code> error from the SQL Server.  </p>\n\n<p>How does one change a default value using CF migrations?  Or, how does one simply remove a default value (and subsequently re-create it with a different value)?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>Here is the SQL generated:</p>\n\n<pre><code>ALTER TABLE [Config] ADD CONSTRAINT DF_DefaultTaxPerDollar DEFAULT 0.087 FOR [DefaultTaxPerDollar]\nALTER TABLE [Config] ALTER COLUMN [DefaultTaxPerDollar] [decimal](19, 5) NOT NULL\n</code></pre>\n\n<p>I think I may have found a solution, to use the <code>Sql()</code> method with some complex SQL inspired by <a href=\"http://thisisnotcnn.blogspot.com/2011/03/get-default-constraint-name-for.html\" rel=\"nofollow\">this</a> post.  The problem stems from the fact that SQL Server uses constraints to implement defaults (OH! how I miss MySQL!) with a generated name for the constraint.  So the Code First team could not simply change or remove/re-create the default value easily.</p>\n"},{"tags":["c#",".net","windows","semaphore"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":17,"score":-2,"question_id":13275439,"title":"What is the maximum length of a named Semaphore's name?","body":"<p>What is the maximum length of a <a href=\"http://msdn.microsoft.com/en-us/library/system.threading.semaphore.aspx\" rel=\"nofollow\">Semaphore</a>'s name?  It makes sense that there would be one, as it maps to an underlying kernel semaphore, but the documentation does not seem to specify it precisely.</p>\n"},{"tags":["c#","treeview"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":5959,"score":2,"question_id":1327079,"title":"How can move up and move down selected item programmatically in treeview in c#?","body":"<p>i have one treeview and 2 button\ni want when click on UP_button, above Node selected if i am click on DOWN_button then selection should be go down</p>\n"},{"tags":["c#","asp.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13275207,"title":"c# get absolute path of relative path","body":"<p>I  am calling a method in c# as follows:</p>\n\n<pre><code>    return Chart.RenderChartHTML(\"../../Charts/MSLine.swf\");\n</code></pre>\n\n<p>The thing is that the path can be different depending on what \nfolder I am calling RenderChartHTML from.</p>\n\n<p>I tried the following so that it finds the absolute path but not working: </p>\n\n<pre><code>    string mslinepath = HttpContext.Current.Server.MapPath(\"~/Charts/MSLine.swf\");\n\n    return Chart.RenderChartHTML(mslinepath);\n</code></pre>\n"},{"tags":["c#",".net","winforms","keyevent"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":26,"score":2,"question_id":13274936,"title":"A Form's key events go missing","body":"<p>I have a bug in my application that I don't know how to how to attack. Basically, key events \"go missing\" after some time. I have added event handlers to KeyDown, KeyPressed and KeyUp that write to the console (both for the Form and one of its TextBoxes). Here's the correct order of things:</p>\n\n<pre><code>control_PreviewKeyDown\nShellForm_KeyDown\ncontrol_KeyDown\nShellForm_KeyPress\ncontrol_KeyPress\nShellForm_KeyUp\ncontrol_KeyUp\n</code></pre>\n\n<p>In the failed state (which I can't reproduce consistently), I get these events when pressing a key (TextBox has focus):</p>\n\n<pre><code>ShellForm_KeyUp\ncontrol_KeyUp\n</code></pre>\n\n<p>Form.KeyPreview is true.</p>\n\n<p>It's the same for all TextBoxes in the Form; they are not disabled and not set to readonly, but it's no longer possible to write text.</p>\n\n<p>Problem is, I don't really know where to begin.</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13267941,"title":"WebRequest Does Not Contain A Definition For Create","body":"<p>I ran a console application yesterday to send and receive web request and web response and it works fine. Today I'm testing the same method on my form application and I get the error WebRequest Does Not Contain A Definition For Create. All my imports are the same. It's a bit strange and I don't know what I'm doing wrong. This is the code to my console application:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing HtmlAgilityPack;\nusing System.Net;\nusing System.IO;\n\nnamespace WebrequestCsharp\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            StreamWriter sw;\n            sw = File.AppendText(\"c:\\\\Temp\\\\webresponse.txt\");\n            //Create a Web-Request to an URL\n            HttpWebRequest HWR_Request = (HttpWebRequest)WebRequest.Create(\"http://www.hitta.se/ericsson/företag_och_personer\");\n\n            //Send Web-Request and receive a Web-Response\n            HttpWebResponse HWR_Response = (HttpWebResponse)HWR_Request.GetResponse();\n\n            //Translate data from the Web-Response to a string\n            Stream S_DataStream = HWR_Response.GetResponseStream();\n            StreamReader SR_DataStream = new StreamReader(S_DataStream, Encoding.UTF8);\n            string s_ResponseString = SR_DataStream.ReadToEnd();\n            S_DataStream.Close();\n            sw.WriteLine(s_ResponseString);\n            sw.Flush();\n            sw.Close();\n\n            HtmlDocument doc = new HtmlDocument();\n            doc.Load(\"c:\\\\Temp\\\\webresponse.txt\");\n            Console.ReadKey();\n        }\n\n\n    }\n}\n</code></pre>\n\n<p>And this is my form application that cannot accept my Create:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing HtmlAgilityPack;\nusing System.Net;\nusing System.IO;\n\nnamespace PhoneFind\n{\n    class WebRequest\n    {\n        private String url { get; set; }\n        private String searchEngine { get; set; }\n        HttpWebRequest HWR_Request = (HttpWebRequest)WebRequest.Create(\"http://www.hitta.se/ericsson/företag_och_personer\");\n        public WebRequest(String url, String searchEngine)\n        {\n            this.url = url;\n            this.searchEngine = searchEngine;\n        }\n\n        // sends a request to the search engine \n        public String sendRequest(String url, String searchEngine)\n        {\n            switch (searchEngine){\n                case \"hitta\":\n                    //Create a Web-Request to a URL\n\n                    //Send Web-Request and receive a Web-Response\n                    HttpWebResponse HWR_Response = (HttpWebResponse)HWR_Request.GetResponse();\n\n                    //Translate data from the Web-Response to a string\n                    Stream S_DataStream = HWR_Response.GetResponseStream();\n                    StreamReader SR_DataStream = new StreamReader(S_DataStream, Encoding.UTF8);\n                    string s_ResponseString = SR_DataStream.ReadToEnd();\n                    S_DataStream.Close();\n                    break;\n            }\n            return \"\";\n\n        }\n\n    }\n}\n</code></pre>\n"},{"tags":["c#",".net","visual-studio-2010","visual-studio","visual-studio-2012"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13273842,"title":"Code Contracts + Code Analysis","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2950081/can-one-make-code-analysis-understand-code-contracts\">Can one make Code Analysis understand Code Contracts?</a>  </p>\n</blockquote>\n\n\n\n<p>I think about starting to use <a href=\"http://msdn.microsoft.com/en-us/devlabs/dd491992.aspx\" rel=\"nofollow\">Code Contracts</a> in my code base.</p>\n\n<p>I already use Code Analysis with all rules enabled and a goal of zero warnings.</p>\n\n<p>However, when using <code>Contract.Requires(parameter != null)</code> I get a warning from Code Analysis, namely CA1062:</p>\n\n<blockquote>\n  <p>CA1062 : Microsoft.Design : In externally visible method 'Foo', validate parameter 'parameter' before using it.</p>\n</blockquote>\n\n<p>That's unfortunate, I don't want to disable that rule as I find it useful. But I also don't want to suppress every false occurrence of it.</p>\n\n<p>Is there a solution?</p>\n"},{"tags":["c#","asp.net",".net","network-share"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":505,"score":0,"question_id":10684879,"title":"Reading File From Network Location","body":"<p>I am having Bunch of Files in A folder which is shared on Network Drive . I am trying to Access those Files into my Code . But It is giving an error:</p>\n\n<blockquote>\n  <p>System.IO.DirectoryNotFoundException was unhandled by user code</p>\n</blockquote>\n\n<pre><code>Fname = txtwbs.Text;\nDirectoryInfo objDir = new DirectoryInfo(\"Y:\\\\\");\n_xmlpath = objDir + \"\\\\\" + Fname + \"\\\\\" + Fname + \".xml\";\nif (File.Exists(_xmlpath ))\n{\n    reader(_xmlpath);\n}\n</code></pre>\n\n<p>I have Also used:</p>\n\n<pre><code>file = fopen(\"\\\\\\\\10.0.2.20\\\\smartjobs\\\\Eto\\\\\"+Fname);   \n</code></pre>\n\n<p>I am Able to Read File from My Local PC But it is giving Exception Only for Network Location .Please let me know how can I read File From Network Shared Location .</p>\n\n<p>And Also How Can I Make A tree view of Folders into Asp.net Web Application . </p>\n\n<p>Directory Structure is Like that </p>\n\n<pre><code>\\\\10.0.2.20\\Smartjobs\\Eto\\\n</code></pre>\n\n<p>this is Parent Directory It is congaing Nos of Folder having XML Documents.</p>\n"},{"tags":["c#","asp.net","servicestack"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":24,"score":2,"question_id":13275268,"title":"Multiple Assemblies for Multiple Services","body":"<p>I'm not sure how to organize my project. I have a solution with multiple services. eg. ShoppingCart, UrlShortener. The AppHostBase can only take one assembly however. I'm also interested in separation of concerns and in future use cases if separating Interface assemblies from ServiceModel assemblies. Should my domain model need to know about the interface (perhaps client requirements?) then at least the namespace won't get flooded with unnecessary DTO's etc.</p>\n\n<p>So right now I see it as such, each being separate assemblies/projects:</p>\n\n<pre><code>MyApp.RestServices.ShoppingCartService.Interface\nMyApp.RestServices.ShoppingCartService.ServiceModel\nMyApp.RestServices.UrlShorteningService.Interface\nMyApp.RestServices.UrlShorteningService.ServiceModel\n</code></pre>\n\n<p>I'm confused in the fact that when registering the AppHost you can only configure one Assembly. </p>\n\n<pre><code>public AppHost() : base(\"MyApp's REST services\", \n    typeof(MyApp.RestServices.ShoppingCartService.Interface).Assembly) {}\n</code></pre>\n\n<p>In my case I want separate assemblies for different services, eg. Short Url Service, Shopping Cart Service.  I don't want to have to put them all in one project.</p>\n\n<pre><code>public AppHost() : base(\"MyApp's REST services\", \n    new[]{\n          typeof(MyApp.RestServices.ShoppingCartService.Interface).Assembly,\n          typeof(MyApp.RestServices.Interface.ShoppingCartService).Assembly}\n) {}\n</code></pre>\n\n<p>I'm really quite new so there is a lot I can be missing but I do wish to get it right for the long term as I continue to learn.</p>\n"},{"tags":["c#","asp.net","gridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13274934,"title":"Binding dropdownlist when adding a new row in gridview","body":"<p>I have a drop down and some textboxes in a gridview and im binding the DDL from DB values and i have to add a new row with same DDL and textboxes but how can i bind the DDL when a new row is created??</p>\n"},{"tags":["c#","wpf","xaml"],"answer_count":4,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":5372,"score":8,"question_id":3837755,"title":"Binding to Self/'this' in XAML","body":"<p>Simple WPF/XAML question. In XAML, how do I reference the Self/this object in a given context? In a very basic app with a main window, one control, and a coded C# property of the window, I want to bind a property of the control to the hand coded property of the window. </p>\n\n<p>In code, this is very easy - in the Window's constructor, I added this:</p>\n\n<pre><code>Binding bind = new Binding();\nbind.Source = this;\nbind.Path = new PropertyPath(\"ButtonWidth\");\nbutton1.SetBinding(WidthProperty, bind);\n</code></pre>\n\n<p>Obviously, I have a property called ButtonWidth, and a control called button1. I can't figure out how to do this in XAML. Various attempts like the following example have not worked:</p>\n\n<pre><code>&lt;Button x:Name=\"button1\" Width=\"{Binding Source=Self Path=ButtonWidth}\"/&gt;\n\n&lt;Button x:Name=\"button1\" Width=\"{Binding RelativeSource={RelativeSource Self} Path=ButtonWidth}\"/&gt; \n</code></pre>\n\n<p>etc</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","image","processing","mask","digital"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13275122,"title":"Applying Masks in Digital Image Processing","body":"<p>Im currently adding different features to a very simple digital image processing program. It is coded using the unsafe methods.\nThis program only works with greyscale images. </p>\n\n<p>My question is how do i apply masks to pixels?</p>\n\n<p>For example a Sobel Mask for horizontal lines only:</p>\n\n<blockquote>\n  <p>Gx = -1, -2, -1, 0, 0, 0, 1, 2, 1</p>\n</blockquote>\n\n<p>The expected outcome for this would be:</p>\n\n<p><img src=\"http://i.stack.imgur.com/M7FP4.jpg\" alt=\"enter image description here\"></p>\n\n<p>My code to obtain pixels:</p>\n\n<pre><code>private void obtainPixelsToolStripMenuItem_Click(object sender, System.EventArgs e)\n    {\n\n        Graphics g = this.CreateGraphics();\n\n        int width = original_image.Width - 2;\n        int height = original_image.Height - 2;\n\n        int total_val = 0;\n        int avg = 0;\n\n\n        Rectangle r = new Rectangle(535, 50, original_image.Width, original_image.Height);\n        Rectangle r2 = new Rectangle(0, 0, original_image.Width, original_image.Height);\n\n        proc_image = original_image.Clone(r2, PixelFormat.Format8bppIndexed);\n\n\n        BitmapData bmDataOR = original_image.LockBits(new Rectangle(0, 0, width, height), ImageLockMode.ReadWrite, PixelFormat.Format8bppIndexed);\n        BitmapData bmDataPR = proc_image.LockBits(new Rectangle(0, 0, width, height), ImageLockMode.ReadWrite, PixelFormat.Format8bppIndexed);\n\n        int stride = bmDataOR.Stride;\n\n\n\n        unsafe\n        {\n            byte* o = (byte*)(void*)bmDataOR.Scan0;\n            byte* p = (byte*)(void*)bmDataPR.Scan0;\n\n            byte[] pix_val = new byte[9];\n\n\n            for (int y = 0; y &lt; height; ++y)\n            {\n                for (int x = 0; x &lt; width; ++x)\n                {\n                    pix_val[0] = o[y * stride + x];\n                    pix_val[1] = o[y * stride + x + 1];\n                    pix_val[2] = o[y * stride + x + 2];\n                    pix_val[3] = o[(y + 1) * stride + x];\n                    pix_val[4] = o[(y + 1) * stride + x + 1];\n                    pix_val[5] = o[(y + 1) * stride + x + 2];\n                    pix_val[6] = o[(y + 2) * stride + x];\n                    pix_val[7] = o[(y + 2) * stride + x + 1];\n                    pix_val[8] = o[(y + 2) * stride + x + 2];\n\n            //Do something with pixel values\n\n                }\n            }\n\n            proc_image.UnlockBits(bmDataPR);\n            original_image.UnlockBits(bmDataOR);\n\n            g.DrawImage(proc_image, r);\n\n        }\n\n    }\n</code></pre>\n\n<p>Am i right in thinking the mask should be a float array?\nand then how do i apply the mask to the pixel values?</p>\n"},{"tags":["c#","sockets","priority"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13274641,"title":"Priority in socket communication","body":"<p>I have a client-server communication between a mobile and a PC(server). \nIn the communication I have four sockets: two of these are to send and receive data, and the other two are for some kind of keep alive since I need to detect as fast as I can the disconnection.</p>\n\n<p>As long as the connection is OK the data will travel without any problem. But I want to establish some priority in order to be sure that the keep alive (remember: two sockets) channel is always sending data, unless the connection between server-client is dead.</p>\n\n<p>Is there any way to achieve this? I hope to be clear.</p>\n\n<p>Thanks for any help.</p>\n"},{"tags":["c#","asp.net"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13275249,"title":"pass array from one method to another","body":"<p>i have program one array of array in C# and asp.net\none method inside a button read a file and the next one is goin to send the array of array to a web services, in order to read the file i used a fileupload, in the first method the file is read correctly and the array is full and that is all the button is goin to do the second method in the second button is goin to send this array to web service, however i try to used a global variable for this but it returns an error saying that the array is empty, so waht i do is insted of an array i saved in a list the lis is save as a Session this way i recover the list in the second method and star to read again, this procese taker much memory space, is it posible to send the array of array to the second button whit out losig the data?</p>\n\n<p>here is part of mi code first button: for an exemple let say that obj=10 and carac=2 so my array will 10 by 2</p>\n\n<pre><code>dat= FileUpload1.PostedFile.InputStream;\n        string line;\n        string [] splitt;\n                int n=0;\n           string [] datos =new string[carac];\ndouble [][] dimencion= new double [obj][] ;\n        System.IO.StreamReader sr = new System.IO.StreamReader(dat);\n        line = sr.ReadLine();\n        while (line != null)\n                {\n                dimencion[n] = new double[carac];\n                for (int m2 = 0; m2 &lt; carac; m2++)\n                    {\n                     datos = line.Split(new Char[] {' ',',','\\t'});\n                     dimencion[n][m2] = Convert.ToDouble(datos[m2]);\n                     }\n                 n = n + 1;\n                line = sr.ReadLine();\n                 }\n</code></pre>\n\n<p>so i try to send de varable dimencion to the second button but nothing having dimencion as a global varible</p>\n\n<pre><code>{\nFirstService mySvc = new FirstService();\nmySvc.Parametros(dimencion);\n}\n</code></pre>\n"},{"tags":["c#","printing","raw-data"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13274965,"title":"Inserting physical carriage returns in string to be sent to printer","body":"<p>I am need to insert physical carriage returns into text to be sent to a printer. So far I have been unsuccessful finding any documentation on how to do this. I am sure it is out there but not sure of the correct terms to define this process.</p>\n\n<p>This is an example that I got from a program printing to the same printer. Where line 1, 2, 3, 4 are there are carriage returns in the text. Below is basically what I need the data to look like that is being sent to the printer. </p>\n\n<p><img src=\"http://i.stack.imgur.com/WZQbv.jpg\" alt=\"Basically what I need the code to look like\"></p>\n\n<p>Thanks in advance for any help!</p>\n\n<h3>NOTE:</h3>\n\n<p>This is what is being sent to the printer</p>\n\n<pre><code>strStrm += \"1W1D44000010002025,LA \" + comboBox1.SelectedItem.ToString() + ((char)13) + ((char)10);\nstrStrm += textBox2.Text + ((char)13) + ((char)10);\nstrStrm += txtYear.Text + ((char)13) + ((char)10);\nstrStrm += strID_Ord + ((char)13) + ((char)10);\nstrStrm += strID_Item + ((char)13) + ((char)10);\nstrStrm += strItemPar + ((char)13) + ((char)10);\n</code></pre>\n\n<p>And this is what the printer is receiving</p>\n\n<pre><code>1W1D44000010002025,LA,Line 1 \nLine 2\nLine 3\nLine 4\n</code></pre>\n\n<p>But I need it to look like the image above where the Carriage Returns are sent to the printer and not formatted into the string.</p>\n"},{"tags":["c#","winforms","multithreading","listview"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13274990,"title":"C# Thread ListView","body":"<p>I'm a fairly new to .net and I'm still struggling to understand a lot things, and right now I'm trying to accomplish something relatively simple but I've failed every single time, I would like to add a Thread to my program, this Thread would be responsible to perform the Upload operations to a web server and keep my program responsive providing the feedback of the operations to my users by updating a ListView, where the users would see all the status of the file uploads.</p>\n\n<p>I don't know how to put this Thread inside the program to make it responsive, I couldn't find any examples so far and I'm trying to find a little sample to show me the use of Thread and WinForms in action.</p>\n"},{"tags":["c#","amazon-ec2","amazon-web-services"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13271793,"title":"Any way to view and EC2 instance AlarmStatus value using AmazonEC2 API?","body":"<p>I was wondering if there was a way to view an ec2 instance's alarm status through the AmazonEC2 API?</p>\n\n<p><img src=\"http://i.stack.imgur.com/zB0vE.png\" alt=\"AlarmStatus\"></p>\n\n<p>We've implemented a working solution to get specific metric values using the AmazonCloudWatch.GetMetricStatistics method:</p>\n\n<pre><code>var reg = new GetMetricStatisticsRequest()\n            {\n                MetricName = metric,\n                Period = 60 * 30,\n                Statistics = new List&lt;string&gt; { AVERAGE },\n                Dimensions = dimensions,\n                Namespace = \"AWS/EC2\",\n                EndTime = DateTime.Now.ToUniversalTime(),\n                StartTime = DateTime.Parse(startTime)\n            };\n\ndata.Columns.Add(AVERAGE);\ndata.Columns.Add(TIMESTAMP);\n\nvar points = Service.GetMetricStatistics(reg).GetMetricStatisticsResult.Datapoints.OrderBy(p =&gt; p.Timestamp);\n</code></pre>\n\n<p>But it would be more useful to check the Alarm status directly.</p>\n\n<p>We've iterated over the AmazonEC2.DescribeInstancesResponse result but no joy so far. Has anyone achieved this yet?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","linq"],"answer_count":4,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":77,"score":7,"question_id":13271880,"title":"Partial ungrouping list of duplicate values","body":"<p>I know how to group data using LINQ, and I know how to split it into separate items, but I have no idea how to only partially ungroup it.  </p>\n\n<p>I have a set of data which looks something like this: </p>\n\n<pre><code>var data = new Dictionary&lt;Header, Detail&gt;()\n{\n    { new Header(), new Detail { Parts = new List&lt;string&gt; { \"Part1\", \"Part1\", \"Part2\" } } }\n};\n</code></pre>\n\n<p>In order to process this correctly, I need every instance of a duplicate part to be a separate entry in the dictionary (although it doesn't matter if it remains a dictionary - <code>IEnumerable&lt;KeyValuePair&lt;Header, Detail&gt;&gt;</code> is perfectly acceptable).  However, I don't want to split up the <code>Parts</code> list entirely - having different parts in the list is fine.</p>\n\n<p>Specifically, I want the end data to look like this:</p>\n\n<pre><code>{\n  { new Header(), new Detail { Parts = new List&lt;string&gt; { \"Part1\", \"Part2\" } } },\n  { new Header(), new Detail { Parts = new List&lt;string&gt; { \"Part1\" } } },\n}\n</code></pre>\n\n<p>For a more complex example:</p>\n\n<pre><code>var data = new Dictionary&lt;Header, Detail&gt;()\n{\n    { new Header(1), new Detail { Parts = new List&lt;string&gt; { \"Part1\", \"Part1\", \"Part2\" } } },\n\n    { new Header(2), new Detail { Parts = new List&lt;string&gt; { \"Part1\", \"Part2\" } } },\n\n    { new Header(3), new Detail { Parts = new List&lt;string&gt; { \"Part1\", \"Part2\", \"Part2\", \"Part2\", \"Part3\", \"Part3\"} } }\n};\n\nvar desiredOutput = new List&lt;KeyValuePair&lt;Header, Detail&gt;&gt;()\n{\n    { new Header(1), new Detail { Parts = new List&lt;string&gt; { \"Part1\", \"Part2\" } } },\n    { new Header(1), new Detail { Parts = new List&lt;string&gt; { \"Part1\" } } },\n\n    { new Header(2), new Detail { Parts = new List&lt;string&gt; { \"Part1\", \"Part2\" } } },\n\n    { new Header(3), new Detail { Parts = new List&lt;string&gt; { \"Part1\", \"Part2\", \"Part 3\" } } },\n    { new Header(3), new Detail { Parts = new List&lt;string&gt; { \"Part2\", \"Part3\" } } },\n    { new Header(3), new Detail { Parts = new List&lt;string&gt; { \"Part2\" } } }\n};\n</code></pre>\n\n<p>Any advice? </p>\n"},{"tags":["c#","coded-ui-tests","page-refresh"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13256868,"title":"Assert on Page Refresh Coded UI","body":"<p>I have a test that needs to verify that an autorefresh property has been set.  My first thought would be to <code>.WaitForControlExist()</code> on a loading page that happens when the page refreshes but Coded UI is too slow to capture that control as it disappears after a half second or so.</p>\n\n<p>My question is whether or not there is a method that will wait for the page to be refreshed that has some sort of timeout similar to WaitForControlExist() </p>\n"},{"tags":["c#"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13275042,"title":"add cookie to WebClient","body":"<p>I want download pdf with WebClient but i need send cookie with request</p>\n\n<p>how can add cookie to WebClient then download pdf\n<code>\n WebClient webClient = new WebClient();</p>\n\n<p>webClient.DownloadFile(\"http://........\", \"C://2.pdf\");</p>\n\n<p></code></p>\n"},{"tags":["c#","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13232660,"title":"Concurrency issues with EF5 / Base Repository","body":"<p>I've finished writing a new application which has now been deployed into the live environment however my global error handler is picking up these exceptions several times throughout the day. These errors come in batches and are one of the four in bold. </p>\n\n<p>MVC 4, IIS 6, Windows Server 2003, .Net .4.0, EF 5 (latest from NuGet)</p>\n\n<p><strong>The type 'ARandomModelInMyContext’ has been mapped more than once.</strong></p>\n\n<p><strong>Index was out of range. Must be non-negative and less than the size of the collection.</strong> </p>\n\n<pre><code>Parameter name: index\nSystem.ThrowHelper.ThrowArgumentOutOfRangeException() at System.Data.Metadata.Edm.MetadataCollection`1.get_Item(Int32 index) at System.Data.Mapping.DefaultObjectMappingItemCollection.ContainsMap(GlobalItem cspaceItem, ObjectTypeMapping&amp; map) at\n</code></pre>\n\n<p><strong>The context cannot be used while the model is being created.</strong></p>\n\n<pre><code>System.Data.Entity.Internal.LazyInternalContext.InitializeContext() at System.Data.Entity.Internal.InternalContext.GetEntitySetAndBaseTypeForType(Type entityType) at System.Data.Entity.Internal.Linq.InternalSet`1.Initialize()\n</code></pre>\n\n<p><strong>The underlying provider failed on Open. The connection was not closed. The connection's current state is connecting.</strong></p>\n\n<p>The structure of the application is a pretty standard MVC4 application with a Service Layer and a repository layer.</p>\n\n<ul>\n<li>A service creates a repo in the constructor </li>\n<li>Repository creates a new Context in the repository constructor like so:</li>\n</ul>\n\n<p><code>public class MyRepository : BaseRepository&lt;MyModel&gt;, IMyRepository</code></p>\n\n<p>With the constructor:</p>\n\n<pre><code>public MyRepository() : base(new MyEntities())\n{\n}\n</code></pre>\n\n<p>Base Repository looks like this:</p>\n\n<pre><code>public class BaseRepository&lt;TEntity&gt; where TEntity : class\n{\n    internal CRMEntities Context;\n    internal DbSet&lt;TEntity&gt; dbSet;\n    public BaseRepository(MyEntities context)\n    {\n        this.Context = context;\n        dbSet = context.Set&lt;TEntity&gt;();\n    }\n}\n</code></pre>\n\n<p>There shouldn't be any concurrency issues as I'm not making directly using any threading or async.</p>\n\n<p>Any ideas? Can my repository structure be improved? I've made all the constructors DI-able however I'm not using an IoC container yet.</p>\n\n<p>Would wrapping the construction of the Context in the repository in lock be worth while? For example:  </p>\n\n<pre><code>public class BaseRepository&lt;TEntity&gt; where TEntity : class\n{\n    internal MyEntities Context;\n    internal DbSet&lt;TEntity&gt; dbSet;\n    private static object _lock = new object();\n\n    public BaseRepository(MyEntities context)\n    {\n        lock (_lock)\n        {\n            this.Context = context;\n            dbSet = context.Set&lt;TEntity&gt;();\n        }\n    }\n }\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12403775,"title":"C# get original resource text for control","body":"<p>If I change the text of a button (say, \"Next\" to \"Finish\"), is there a way of finding the original text so I can put it back, by referring to the resources (i.e. retrieve the word \"Next\" from the resources)?</p>\n\n<p>Obviously I could store the original before changing it, but I am curious as to whether there is a more elegant way of referring to it (e.g. in the same way you refer to a resourced string: <code>global::MyProject.Properties.Resources.LeString</code>).</p>\n"},{"tags":["c#","goto"],"answer_count":4,"favorite_count":0,"up_vote_count":5,"down_vote_count":2,"view_count":121,"score":3,"question_id":13274661,"title":"Should I use goto statement?","body":"<p>I have a piece of code like the following:</p>\n\n<pre><code>try\n{\nWork:\n\n   while(true)\n   {\n      // Do some work repeatedly...\n   }\n}\ncatch(Exception)\n{\n   // Exception caught and now I can not continue \n   // to do my work properly\n\n   // I have to reset the status before to continue to do my work\n   ResetStatus();\n\n   // Now I can return to do my work\n   goto Work; \n}\n</code></pre>\n\n<p>Are there better alternatives compared to using <code>goto</code>? Or is this a good solution?</p>\n"},{"tags":["c#",".net","visual-studio-2010"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":59,"score":-1,"question_id":13274651,"title":"C# .net 4 dependency","body":"<p>I have a standalone tool developed in C# Visual Studio Express 2010.\nMy problem is that this tool will fail to start on machines having no .NET installed, and asking for .NET 4 on machines has .NET under 3.5 or lower. \nWhat I basically want to do is to install .NET 4 from my application before the main script runs. I can write a program to download it from an official webpage, also to run the installer etc. But the main problem still exists, the app won't even reach the download part as it won't run on machines...\nI've googled around and found that you can include dll-s etc., but I still doubt I can proceed without a proper .NET installation. So how can run dotnetfx.exe with my .NET dependent application?\nYour attention and ideas are much appreciated.\nCs.</p>\n"},{"tags":["c#","function","plot","console-application"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":43,"score":-2,"question_id":13274418,"title":"C#: How to plot a function using console","body":"<p>I want to plot any polynomial function in C# using the console application, without using any windows or forms, I searched a lot but all I found was in window application or involving MATLAB and what I want is something just in the console.</p>\n\n<p>I want it to plot any polynomial function given, for example; the coefficients are stored in an array, and i want to plot the function related to it, for example:</p>\n\n<p>The array is:</p>\n\n<p><code>double[] array = new double[4] { 2 , 0 , -4 , 3 };</code></p>\n\n<p>Then the function is: 3X^3 - 4X^2 + 2</p>\n\n<p>And it will be plotted on the XY-Plane like this:</p>\n\n<p>For Example: X + 1</p>\n\n<p><a href=\"http://i.stack.imgur.com/SD3tb.jpg\" rel=\"nofollow\">http://i.stack.imgur.com/SD3tb.jpg</a></p>\n\n<p>Any help is appreciated.</p>\n\n<p>Update:</p>\n\n<p>Using the method you provided, I tried this code:</p>\n\n<pre><code>        WriteAt(\"|\", 40, 0);\n        WriteAt(\"|\", 40, 1);\n        WriteAt(\"|\", 40, 2);\n        WriteAt(\"|\", 40, 3);\n        WriteAt(\"|\", 40, 4);\n        WriteAt(\"|\", 40, 5);\n        WriteAt(\"|\", 40, 6);\n        WriteAt(\"|\", 40, 7);\n        WriteAt(\"|\", 40, 8);\n        WriteAt(\"|\", 40, 9);\n\n        WriteAt(\"-----------------------------------------\", 20, 10);\n\n        WriteAt(\"|\", 40, 11);\n        WriteAt(\"|\", 40, 12);\n        WriteAt(\"|\", 40, 13);\n        WriteAt(\"|\", 40, 14);\n        WriteAt(\"|\", 40, 15);\n        WriteAt(\"|\", 40, 16);\n        WriteAt(\"|\", 40, 17);\n        WriteAt(\"|\", 40, 18);\n        WriteAt(\"|\", 40, 19);\n        WriteAt(\"|\", 40, 20);\n\n        WriteAt(\"*\", 32, 12);\n        WriteAt(\"*\", 34, 11);\n        WriteAt(\"*\", 36, 10);\n        WriteAt(\"*\", 38, 9);\n        WriteAt(\"*\", 40, 8);\n        WriteAt(\"*\", 42, 7);\n        WriteAt(\"*\", 44, 6);\n        WriteAt(\"*\", 46, 5);\n        WriteAt(\"*\", 48, 4);\n</code></pre>\n\n<p>And I got this:</p>\n\n<p><a href=\"http://i.stack.imgur.com/cqLz2.jpg\" rel=\"nofollow\">http://i.stack.imgur.com/cqLz2.jpg</a></p>\n\n<p>So, now I have to give the WriteAt function the points that must be drawn but putting in mind that the origin is (40,10) in my plotting ??</p>\n\n<p>I subtract 2 from the x-axis because the \"-\" is half the size of the \"|\" so the plot will be kinda scaled.</p>\n"},{"tags":["c#","java","sql-server","jdbc","odbc"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13274852,"title":"What Java and/or C# frameworks are avaiable to implement SQL server accessible via ODBC/JDBC?","body":"<p>I need to figure out how to create server which behaves like SQL server in respect of accepting connections via ODBC, JDBC, etc, but implemented by me on C# (and/or Java) I.e. I don't want to create tables, call stored procs etc.\nFor the sake of example I just want to have query implemented:</p>\n\n<p>select * from HardcodedTableOfMyFavoriteColors</p>\n\n<p>Any other queries should just fail. The query should return just few colors (hardcoded in server code).</p>\n\n<p>If somebody interested why I need such thing the answer is below.</p>\n\n<p>My actual purpose is to be able to create C# (or Java) server accessible via JDBC/ODBC/etc way from legacy app with strictly defined set of queries. I hope framework will be able to parse query to XML to make my life a bit easier. However response data will be generated by my code and could be something depending on other systems, time etc. On client side response should look like usual SQL server response processed via the same JDBC/ODBC etc API calls.\nBy doing such substitution I hope to reimplement bloated stored procedure logic in C# (or Java) without need to change clients.</p>\n\n<p>Unfortunately I have to have implementation of such SQL-mimic server on both Linux and Windows because I forced to deal with home-grown Java library on Linux and C# on Windows to access custom COM objects.</p>\n\n<p>Anyone?</p>\n"},{"tags":["c#","linq","syntax","forex"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":55,"score":1,"question_id":13250328,"title":"LINQ to object Open High Low Close (OHLC)","body":"<p>I would like to achieve same results from code sample below by using syntax LINQ query to object.\nPlease, help me guys.</p>\n\n<pre><code>public static List&lt;OHLC&gt; OHLC(List&lt;FileRaw&gt; fileRawsList, TimeSpan timeSpan, DateTime beginDate, DateTime endOfLoopDate)\n    {\n\n        List&lt;OHLC&gt; ohlcList = new List&lt;OHLC&gt;();\n\n        for (DateTime i = beginDate; i &lt; endOfLoopDate; )\n        {\n            DateTime iLow = i;\n            DateTime iMax = i.Add(timeSpan);\n            OHLC ohlcRaw = new OHLC()\n                {\n                    Open = fileRawsList.Where(p =&gt; p.Time &gt;= iLow).Where(p =&gt; p.Time &lt;= iMax).Select(p =&gt; p.Bid).DefaultIfEmpty().First(),\n                    High = fileRawsList.Where(p =&gt; p.Time &gt;= iLow).Where(p =&gt; p.Time &lt;= iMax).Select(p =&gt; p.Bid).DefaultIfEmpty().Max(),\n                    Low = fileRawsList.Where(p =&gt; p.Time &gt;= iLow).Where(p =&gt; p.Time &lt;= iMax).Select(p =&gt; p.Bid).DefaultIfEmpty().Min(),\n                    Close = fileRawsList.Where(p =&gt; p.Time &gt;= iLow).Where(p =&gt; p.Time &lt;= iMax).Select(p =&gt; p.Bid).DefaultIfEmpty().Last(),\n                    Time = fileRawsList.Where(p =&gt; p.Time &gt;= iLow).Where(p =&gt; p.Time &lt;= iMax).Select(p =&gt; p.Time).DefaultIfEmpty(iLow).First()\n                };\n\n            i = i.Add(timeSpan);\n            ohlcList.Add(ohlcRaw);\n        }\n        return ohlcList;\n    }\n</code></pre>\n\n<p>it produce</p>\n\n<pre><code>Open: 1.229570, High: 1.233580, Low: 1.221730, Close: 1.224630, Date: 01/08/2012 00:00:02\nOpen: 1.224620, High: 1.240460, Low: 1.213320, Close: 1.217490, Date: 02/08/2012 00:00:03\nOpen: 1.217530, High: 1.239160, Low: 1.217230, Close: 1.238650, Date: 03/08/2012 00:00:02\nOpen: 0,        High: 0,        Low: 0,        Close: 0,        Date: 04/08/2012 00:00:02\nOpen: 1.239720, High: 1.239830, Low: 1.239180, Close: 1.239460, Date: 05/08/2012 17:00:03\n</code></pre>\n"},{"tags":["c#","image-processing","try-catch","unsafe"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":2,"view_count":54,"score":2,"question_id":13261875,"title":"try catch exceptions in unsafe code","body":"<p>I am writing some image processing code and use C# to do low level pixel manipulation. Every once in a while, an accessViolationException happens.</p>\n\n<p>There are several approaches to this typical problem, some think code should be written robustly so to not have access violation exceptions, and as far as I try, the application is going fine however I would like to add a try catch so that iff something were to happen, the application would not fail in too ugly of a way.</p>\n\n<p>So far, I have put in some example code to test it out</p>\n\n<pre><code>unsafe\n{\n    byte* imageIn = (byte*)img.ImageData.ToPointer();\n    int inWidthStep = img.WidthStep;\n    int height = img.Height;\n    int width = img.Width;\n    imageIn[height * inWidthStep + width * 1000] = 100; // make it go wrong\n}\n</code></pre>\n\n<p>When I put a try catch around this statement, I still get an exception. Is there a way to catch exceptions generated in an unsafe block?</p>\n\n<p>Edit: as stated down below, this type of exception is no longer handled unless the checking of them is explicitly enabled by adding this attribute to the function and adding the \"using System.Runtime.ExceptionServices\".</p>\n\n<pre><code>[HandleProcessCorruptedStateExceptions]\n    public void makeItCrash(IplImage img)\n    {\n        try\n        {\n            unsafe\n            {\n                byte* imageIn = (byte*)img.ImageData.ToPointer();\n                int inWidthStep = img.WidthStep;\n                int height = img.Height;\n                int width = img.Width;\n                imageIn[height * inWidthStep + width * 1000] = 100; // to make it crash\n            }\n        }\n        catch(Exception e)\n        {\n            // log the problem and get out\n        }\n    }\n</code></pre>\n"},{"tags":["c#","token","lex","lexical-analysis"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13274890,"title":"how to identify digits and expressions","body":"<p>i have been working on a simple lexical analyzer which generates lexemes and tokens\nmy program opens a .cpp file and from then it displays libraries,operators,variables,reserved words and data types,i have 2 problems </p>\n\n<ol>\n<li>i want to change the program so that it opens .cpp and .txt files and generate tokens and lexemes i.e(displays libraries,operators,variables,reserved words and data types) </li>\n</ol>\n\n<p>2.its not displaying digits and expressions</p>\n\n<p>how can i go about solving problems 1 and 2</p>\n\n<p>code for opening a .cpp file//this code only opens .cpp files but i want to modify it so that it opens .txt files too</p>\n\n<pre><code>private void btnOpen_Click(object sender, EventArgs e)\n        {\n            if (openFileDialog1.ShowDialog() == DialogResult.OK)\n            {\n                if (openFileDialog1.FileName.EndsWith(\".cpp\".ToUpper()))\n                {\n                    txtPath.Text = openFileDialog1.FileName;\n                    rTextSource.Text = AnalyzerBackWork.readFullFile(txtPath.Text);                    \n                }\n                else\n                {\n                    MessageBox.Show(\"Must Open a .cpp file\");\n                }\n            }\n            else\n            {\n                return;\n            }\n        } \n</code></pre>\n\n<p>code for searching operators , i want to make a code that will search for digits and expressions</p>\n\n<pre><code>public static void myMain()\n        {            \n            char[] word = new Char[500];\n            int counter = 0;\n            char[] lib = new Char[500];\n            int libCounter = 0;\n\n            ReadFile();\n\n            for (cnt = 0; cnt &lt; index; cnt++)\n            {\n                // FOR CHECKING OPERATORS\n\n                if (Token[cnt] == '+' || Token[cnt] == '-' || Token[cnt] == '*' || Token[cnt] == '/' || Token[cnt] == '%' || Token[cnt] == '&amp;' || Token[cnt] == '^'\n                    || Token[cnt] == '&lt;' || Token[cnt] == '&gt;' || Token[cnt] == '!' || Token[cnt] == '=')\n                {\n                    if (Token[cnt] == '+')\n                    {\n                        if (Token[cnt + 1] == '+')\n                            operators[operatorCount++] = Token[cnt] + \"\" + Token[cnt + 1];\n                        else\n                            operators[operatorCount++] = Token[cnt].ToString();\n                    }\n                    else if (Token[cnt] == '-')\n                    {\n                        if (Token[cnt + 1] == '-')\n                            operators[operatorCount++] = Token[cnt] + \"\" + Token[cnt + 1];\n                        else\n                            operators[operatorCount++] = Token[cnt].ToString();\n                    }\n                    else if (Token[cnt] == '&lt;')\n                    {\n                        if (Token[cnt + 1] == '=')\n                            operators[operatorCount++] = Token[cnt] + \"\" + Token[cnt + 1];\n                        else\n                            operators[operatorCount++] = Token[cnt].ToString();\n                    }\n                    else if (Token[cnt] == '&gt;')\n                    {\n                        if (Token[cnt + 1] == '=')\n                            operators[operatorCount++] = Token[cnt] + \"\" + Token[cnt + 1];\n                        else\n                            operators[operatorCount++] = Token[cnt].ToString();\n                    }\n                    else if (Token[cnt] == '!')\n                    {\n                        if (Token[cnt + 1] == '=')\n                            operators[operatorCount++] = Token[cnt] + \"\" + Token[cnt + 1];\n                        else\n                            operators[operatorCount++] = Token[cnt].ToString();\n                    }\n                    else if (Token[cnt] == '=')\n                    {\n                        if (Token[cnt + 1] == '=')\n                            operators[operatorCount++] = Token[cnt] + \"\" + Token[cnt + 1];\n                        else\n                            operators[operatorCount++] = Token[cnt].ToString();\n                    }\n                    else\n                        operators[operatorCount++] = Token[cnt].ToString();\n                }\n</code></pre>\n"},{"tags":["c#","asp.net","visual-studio-2008","entity-framework"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":10579,"score":2,"question_id":1562807,"title":"Entity framework with \"Group By\" and/or \"Order by\"","body":"<p>Say we've got a project that allows user to download things. On the main page, I want to show the Most downloaded files ordered by the number of download! All that using EF.</p>\n\n<p>How can i do this !! I've tried many things with Group By (Its a nightmare when you've got a lot of informations in an object). And i still dunno how to do this...</p>\n\n<pre><code>var query = from details in m_context.TransactionDetails\n                        where details.Chanson != null\n                        group details by details.Items into AnItem\n                        orderby AnItem.Count()\n                        select new Item() {\n                            IdItem = Chansons.Key.IdItem,\n                            ItemState= Chansons.Key.ItemState,\n                            [...This object got something like 20 including links to other objects ... ]\n                        };\n</code></pre>\n\n<p>Anyone have an idea?</p>\n\n<p>Thanks :o)</p>\n\n<p>Oh and sorry for my english, I'm giving my best but im from Quebec (Usualy talk french).</p>\n"},{"tags":["c#","sql","database","api","concurrency"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":90,"score":2,"question_id":13224787,"title":"Database recommendations needed -> Columnar, Embedded (if possible), fast, fast, fast","body":"<p>I am searching for the ideal database structure/solution that meets most of my below requirements but so far I utterly failed. Can you please help?</p>\n\n<p>My tasks: I run a process in .Net 4.5 (C#) and generate (generally) value types that I want to use for further analysis in other applications and therefore like to either preserve in-memory or persist on disk. More below. The data is generated within different tasks/threads and thus a row based data format does not lend itself well to match this situation (because the data generated in different threads is generated at different times and is thus not aligned). Thus I thought a columnar data structure may be suitable but please correct me if I am wrong.</p>\n\n<p>Example:</p>\n\n<p>Tasks/Thread #1 generates the following data at given time stamps</p>\n\n<p>datetime.ticks / value of output data</p>\n\n<p>1000000001 233.23</p>\n\n<p>1000000002 233.34</p>\n\n<p>1000000006 234.23\n...</p>\n\n<p>Taks/Thread #2 generates the following data at given time stamps</p>\n\n<p>datetime.ticks / value of output data</p>\n\n<p>1000000002 33.32</p>\n\n<p>1000000005 34.34</p>\n\n<p>1000000015 54.32\n...</p>\n\n<p>I do not need to align the time stamps at the .Net run-time, I am first and foremost after preserving the data and to process the data within R or Python at a later point.</p>\n\n<p>My requirements:</p>\n\n<ul>\n<li><p>Fast writes, fast writes, fast writes: It can happen that I generate 100,000- 1,000,000 data points per second and need to persist (worst case) or retain in memory the data. Its ok to run the writes on its own thread so this process can lag the data generation process but limitation is 16gb RAM (64bit code), more below.</p></li>\n<li><p>Preference is for columnar db format as it lends itself well to how I want to query the data later but I am open to any other structure if it makes sense in regards to the examples above (document/key-value also ok if all other requirements are met, especially in terms of write speed). </p></li>\n<li><p>API that can be referenced from within .Net. Example: HDF5 may be considered capable by some but I find their .Net port horrible.Something that supports .Net a little better would be a plus but if all other requirements are met then I can deal with something similar to the HDF5 .Net port.  </p></li>\n<li><p>Concurrent writes if possible: As described earlier I like to write data concurrently from different tasks/threads.</p></li>\n<li><p>I am constrained by 16gb memory (run .Net process in 64bit) and thus I probably look for something that is not purely in-memory as I may sometimes generate more data than that. Something in-memory which persists at times or a pure persistence model is probably preferable. </p></li>\n<li><p>Preference for embedded but if a server in a client/server solution can run as a windows service then no issue. </p></li>\n<li><p>In terms of data access I have strong preference for a db solution for which interfaces from R and Python already exist because I like to use the Panda library within Python for time series alignments and other analysis and run analyses within R.</p></li>\n<li><p>If the API/library supports in addition SQL/SQL-like/Linq/ like queries that would be terrific but generally I just need the absolute bare bones such as load columnar data in between start and end date (given the \"key\"/index is in such format) because I analyze and run queries within R/Python.</p></li>\n<li><p>If it comes with a management console or data visualizer that would be a plus but not a must. </p></li>\n<li><p>Should be open source or priced within \"reach\" (no, KDB does not qualify in that regards ;-)</p></li>\n</ul>\n\n<p>OK, here is what I have so far, and again its all I got because most db solution simply fail already on the write performance requirement:</p>\n\n<ul>\n<li>Infobright and Db4o. I like what I read so far but I admit I have not checked into any performance stats</li>\n<li>Something done myself. I can easily store value types in binary format and index the data by datetime.ticks (8 bit longs), I just would need to somehow write scripts to load/deserialize the data in Python/R. But it would be a massive tasks if I wanted to add concurrency, a query engine, and other goodies. Thus I look for something already out there. </li>\n</ul>\n"},{"tags":["c#",".net","serialization"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13274421,"title":"Change object at runtime to serializable .NET","body":"<p>I would like change object to ISerializable at runtime. Something like</p>\n\n<pre><code>&lt;!-- language: c# --&gt;\nvar nonSerializeObject = new NonSerialize();\nISerializable mySerializeObject = \n      somethingforserializable.serialize(nonSerializeObject,TypeOfObject);\n</code></pre>\n"},{"tags":["c#","inversion-of-control","prism","unity"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13274701,"title":"Should I put all the constructor parameters in the interface to be resolved for the Unity?","body":"<p>I am using Prism with Unity to do the IoC. I have some classes that have some value type parameters (e.g., string path, int number) in their constructors. </p>\n\n<p>How should I deal with these parameters if I want to resolve these classes? </p>\n\n<p>Should I put these parameter into interface or should I put them into a function and call it after the class is resolved?</p>\n\n<p>Thanks,</p>\n\n<p>Wei</p>\n"},{"tags":["c#","selenium","for-loop","webdriver","window-handles"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":477,"score":1,"question_id":11237357,"title":"selenium webdriver window handles c# switchTo failed","body":"<p>Here comes 2 windows pop out during the testing.</p>\n\n<p>my code:</p>\n\n<pre><code>string BaseWindow = driver.CurrentWindowHandle;                 \nReadOnlyCollection&lt;string&gt; handles = driver.WindowHandles;\n\nforeach(string handle in handles)                    \n{                         \nBoolean a=driver.SwitchTo().Window(handle).Url.Contains(\"Main\");\nif (a == true)  \n{       \nInitialSetting.driver.SwitchTo().Window(handle);      \nbreak;\n}  \n}                \n</code></pre>\n\n<p>I want to switch to the window which url contains \"Main\". But when the test is running, it switches between two windows continuously and it doesn't stop.</p>\n\n<p>I debug and found the <code>foreach</code> didn't break even when the <code>boolean a</code> is true.</p>\n\n<p>How can I resolve this? </p>\n"},{"tags":["c#","wpf","collectionviewsource"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":24,"score":2,"question_id":13274763,"title":"Correct Way to bind ComboBox to CollectionViewSource","body":"<p>Hey i have a CollectionViewSource Property on my ViewModel.</p>\n\n<p>This ViewModel is bound to a ComboBox this way:</p>\n\n<pre><code>&lt;ComboBox   ItemsSource=\"{Binding Products.View}\" \nSelectedItem=\"{Binding SelectedEntity.Product}\"  \nIsSynchronizedWithCurrentItem=\"True\"/&gt;\n</code></pre>\n\n<p>When binding to an existing SelectedEntity it works fine.</p>\n\n<p>When i try to bind to an <code>SelectedEntity</code>, that dosn't posses a Product i want to display the first Item from the List. Therefore i tried to use <code>Products.View.MoveCurrentToFirst()</code>, but still the first item isn't displayed.</p>\n\n<p>It of course works when i set <code>SelectedEntity.Product = Products.View.CurrentItem.</code></p>\n\n<p>What can i do, to improve my code? This looks somewhat wrong to me...</p>\n"},{"tags":["c#","visual-studio-2010","dynamics-crm-2011"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13272194,"title":"Context message for UPDATE is not working","body":"<p>I am working on a CRM Dynamics Plugin. There is a field on custom entity named \"email\". I want to make sure that for two entity records email addresses should be unique. For that purpose I have written following code:</p>\n\n<pre><code>public class Class1 : IPlugin\n{\n    public void Execute(IServiceProvider serviceProvider)\n    {\n        // Obtain the execution context from the service provider.\n        Microsoft.Xrm.Sdk.IPluginExecutionContext context = (Microsoft.Xrm.Sdk.IPluginExecutionContext)\n            serviceProvider.GetService(typeof(Microsoft.Xrm.Sdk.IPluginExecutionContext));\n\n        // Get a reference to the organization service.\n        IOrganizationServiceFactory factory =\n        (IOrganizationServiceFactory)serviceProvider.GetService(typeof(IOrganizationServiceFactory));\n        IOrganizationService service = factory.CreateOrganizationService(context.UserId);\n\n\n        // The InputParameters collection contains all the data passed in the message request.\n        if (context.InputParameters.Contains(\"Target\") &amp;&amp;\n            context.InputParameters[\"Target\"] is Entity)\n        {\n            Entity entity = (Entity)context.InputParameters[\"Target\"];\n\n            //&lt;/snippetAccountNumberPlugin2&gt;\n\n            // Verify that the target entity represents an account.\n            // If not, this plug-in was not registered correctly.\n            if (context.MessageName.ToUpper() == \"CREATE\")\n            {\n                if (entity.LogicalName == \"new_assignment1entity\")\n                {\n                    try\n                    {\n                        QueryExpression query = new QueryExpression(\"new_assignment1entity\");\n                        query.ColumnSet.AddColumns(\"new_email\");\n                        EntityCollection result1 = service.RetrieveMultiple(query);\n                        foreach (var a in result1.Entities)\n                        {\n                            int size = result1.Entities.Count;\n                            if (a.Attributes[\"new_email\"].ToString().Equals(entity[\"new_email\"]))\n                                throw new InvalidPluginExecutionException(\"Duplicate Email found!\");\n                        }\n                    }\n                    catch (FaultException&lt;Microsoft.Xrm.Sdk.OrganizationServiceFault&gt;)\n                    {\n                        //You can handle an exception here or pass it back to the calling method.\n                        throw new InvalidPluginExecutionException(\"Some problem occurred while Querying Records!\");\n                    }\n                }\n            }\n            else if (context.MessageName.ToUpper() == \"UPDATE\")\n            {\n                if (entity.LogicalName == \"new_assignment1entity\")\n                {\n                    try\n                    {\n                        QueryExpression query = new QueryExpression(\"new_assignment1entity\");\n                        query.ColumnSet.AddColumns(\"new_email\");\n                        EntityCollection result1 = service.RetrieveMultiple(query);\n                        foreach (var a in result1.Entities)\n                        {\n                            int size = result1.Entities.Count;\n                            if (a.Attributes[\"new_email\"].ToString().Equals(entity[\"new_email\"]))\n                                throw new InvalidPluginExecutionException(\"Duplicate Email found!\");\n                        }\n                    }\n                    catch (FaultException&lt;Microsoft.Xrm.Sdk.OrganizationServiceFault&gt;)\n                    {\n                        //You can handle an exception here or pass it back to the calling method.\n                        throw new InvalidPluginExecutionException(\"Some problem occurred while Querying Records!\");\n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>When User creates a new entity record with duplicate email address this code works and shows a dialog box printing error message. But when User edit an existing record (update and existing record) and makes the email address duplicate then this code does not work and updated record with duplicated email address saved.<br/>\nI am guessing that Context message with UPDATE else part is not working.<br/>\nPlease help me out.</p>\n"},{"tags":["c#"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13273855,"title":"Converting string to ToolStripMenuItem","body":"<p>I have a menu structure already set up on a form and I want to programatically enable or disable certain menu items using a database.</p>\n\n<p>I have got to the last stage where I have a class of <code>AllowedMenu</code> and <code>CodeNames</code> (which match the toolstripmenuitems exactly), and all I want to do it convert the <code>CodeName</code> into a <code>ToolStripMenuItem</code> from a String.</p>\n\n<p>How could I do this?</p>\n"},{"tags":["c#","asp.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13274336,"title":"validation expression for datetime like month/date/year","body":"<p>I need a validation expression for datetime like month/date/year.I tried many expressions.But all contains validation for time also...So please help me...</p>\n"},{"tags":["c#","garbage-collection"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":48,"score":-1,"question_id":13274234,"title":"Library code calling GC.Collect() unnecessarily","body":"<p>A call to a 3rd-party provided compiled .NET DLL is calling GC.Collect() on every call to Submit(). Here's a sample of the disassembled code:</p>\n\n<pre><code>public bool Submit(string destPath, ...)\n{\n    bool result;\n    try\n    {\n        GC.Collect();\n        result = this.Submit_private(destPath, ...);\n</code></pre>\n\n<p>Other than disassembling and re-compiling the code, is there a recommended way to remove this unnecessary call?</p>\n\n<p>Additional info:</p>\n\n<ul>\n<li>The vendor says the code was written by a \"contractor\". I'm assuming it was put there to slow down the calls to Submit() in dev/test - it was written for .NET 1.1 and they don't have a newer version. It's a class library, intended to be re-used - why would you ever put a GC.Collect() on a method you expect callers to call continuously?</li>\n<li>The Submit_private() method validates, constructs, sends an HTTP request. It also processes the response message.</li>\n</ul>\n"},{"tags":["c#","asp.net","asp.net-mvc","login","forms-authentication"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13273375,"title":"Why does my login page keep reloading, without trying to authenticate?","body":"<p>In Controllers/AccountController.cs:</p>\n\n<pre><code>public class AccountController : Controller\n{\n    //\n    // GET: /Account/Login\n    public ActionResult Login()\n    {\n        return View();\n    }\n    ...\n}\n</code></pre>\n\n<p>In web.config:</p>\n\n<pre><code>&lt;authentication mode=\"Forms\"&gt;\n  &lt;forms loginUrl=\"~/Account/Login\" defaultUrl=\"~/Home/Index\" name=\".ASPXFORMSAUTH\"/&gt;\n&lt;/authentication&gt;\n&lt;authorization&gt;\n  &lt;deny users=\"?\"/&gt;\n&lt;/authorization&gt;\n</code></pre>\n\n<p>In Views/Account/Login.aspx:</p>\n\n<pre><code>&lt;script runat=\"server\" type=\"text/C#\"&gt;\n    protected void Page_Load(object sender, EventArgs e) {...}\n    protected void OnAuthenticate(object sender, AuthenticateEventArgs e) {...}\n    protected void OnLoggedIn(object sender, EventArgs e){...}\n    protected void OnLoginError(object sender, EventArgs e){...}\n&lt;/script&gt;\n\n...\n\n&lt;asp:Login ID=\"login1\" runat=\"server\" \n           DestinationPageUrl=\"~/Views/Home/Index.aspx\"\n           OnAuthenticate=\"OnAuthenticate\" \n           OnLoggedIn=\"OnLoggedIn\" \n           OnLoginError=\"OnLoginError\"&gt;\n    ...\n    &lt;asp:Button ID=\"loginButton\" runat=\"server\" CommandName=\"Login1\" Text=\"Login\" ValidationGroup=\"login1\" TabIndex=\"4\" /&gt;\n    ...\n&lt;/asp:Login&gt;\n</code></pre>\n\n<p><code>Page_Load</code> is called, but then <code>OnAuthenticate</code>, <code>OnLoggedIn</code>, and <code>OnLoginError</code> are never called. Why is that?</p>\n\n<p>I am using MVC, and what happens after clicking the \"Login\" button is I am taken back to the AccountController. This returns the Login.aspx View, so the login page just gets reloaded.</p>\n"},{"tags":["c#","windows","events"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13257499,"title":"How to create CRITICAL events for Windows Event Viewer?","body":"<p>I searched on stackoverflow for previously asked questions and did not find much that helped.</p>\n\n<p>I'm trying to create a c# app that can create windows events (locally and remotely).  I would like to be able to create Critical event-levels (maybe verbose too?).</p>\n\n<p>Anyways, I've been digging around for a couple days now and can't find an answer.  Help would be much appreciated.</p>\n"},{"tags":["c#","asp.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13272641,"title":"How to Assign a data column value to specific word uisng C#","body":"<p>I have a field in my table in which I would like to set a string  like “COMPLETE”.   Initially the field is empty  and I want to set it some kind of text like “COMPLETE”  Here is what I have so far…</p>\n\n<pre><code>   string ID = GV_Action.Rows[0].Cells[1].Text;\n\n    SqlConnection con = new SqlConnection(ConfigurationManager.ConnectionStrings[\"MyConnectionString\"].ConnectionString);\n\n    SqlCommand cmd = new SqlCommand(\"sp_Update\", con);\n    cmd.CommandType = CommandType.StoredProcedure;\n\n    cmd.Parameters.Add(\"@ID\", SqlDbType.VarChar).Value = ID;\n\n    cmd.Connection = con;\n    con.Open();\n    cmd.ExecuteNonQuery();\n    con.Close();\n</code></pre>\n\n<p>in my Strored procedure below i am using a default ID but would like to pass the paramter ID  and not use the fixed value how can i do that?\nhere is how i created the proc\nCREATE PROC sp_Update</p>\n\n<p>AS</p>\n\n<p>EXEC msdb.dbo.sp_start_job N'UpdateField';</p>\n\n<p>GO</p>\n\n<p>EXEC sp_Update</p>\n\n<p>and here is job that i am calling when the procedure kicks off\nupdate MyTable</p>\n\n<p>set Status = 'Complete'\n  where Post_ID = 303</p>\n"},{"tags":["c#",".net","wpf","entity-framework"],"answer_count":3,"favorite_count":0,"up_vote_count":22,"down_vote_count":1,"view_count":4643,"score":21,"question_id":6089403,"title":"Delete all entities in Entity Framework","body":"<p>I want to delete content of all tables (all entities using Entity Framework 4+).\nHow can this be done?</p>\n\n<p>Thanks, James</p>\n"},{"tags":["c#","asp.net","html","asp.net-mvc","webclient"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13273688,"title":"Right Accept Type?","body":"<p>In my ASP.NET MVC app, I am providing a link to a .csv file:</p>\n\n<pre><code>WebClient wc = new WebClient();\n                    wc.Headers.Add(\"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.0.3705;)\");\n                    wc.Headers.Add(\"Accept\", \"text/plain,text/html,application/xml;q=0.9,*/*;q=0.8\");                   \n                    wc.Headers.Add(\"Accept-Charset\", \"ISO-8859-1,utf-8;q=0.7,*;q=0.3\");\n                    byte[] csvBytes = wc.DownloadData(url);\n                    return File(csvBytes, \"application/octet-stream\", \"Target.csv\"); \n</code></pre>\n\n<p>The url returns the following data:</p>\n\n<pre><code>&lt;string xmlns=\"http://schemas.microsoft.com/2003/10/Serialization/\"&gt;\n\"PAUL\",\"SMITH\",\"A &amp; P CONSTRUCTION\",\"211 N JACKSON ST\",\"PAPILLION\",\"NE\",\"68046\" \"JEROME\",\"HALSEY\",\"A A A LOCATING INC\",\"1906 SOUTHVIEW DR\",\"NEW YORK\",\"NY\",\"68046\" \"MIKE\",\"GIBILISCO\",\"ABSOLUTE SECURITY INC\",\"944 S JEFFERSON ST\",\"OMAHA\",\"NE\",\"68102\"\n&lt;/string&gt;\n</code></pre>\n\n<p>When I open the .csv, I get the right data except for first row/first column:</p>\n\n<pre><code>&lt;string xmlns=\"http://schemas.microsoft.com/2003/10/Serialization/\"&gt;\"PAUL\"  SMITH   A &amp;amp; P CONSTRUCTION  211 N JACKSON ST    PAPILLION   NE  68046\n</code></pre>\n\n<p>What Accept type should I use to get rid of the string tag.</p>\n"},{"tags":["c#","winforms","visual-studio-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13230311,"title":"Why does MS Chart only display x-axis labels for some data points?","body":"<p>When I bind the data to the barchart. I am not able to see the labels in the X-axis for some bars. E.g: i bind four data to the chart. The chart is displaying only 2nd and 4th data label.</p>\n"},{"tags":["c#","c#-4.0","xna","xna-4.0","spritefont"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":4,"view_count":78,"score":1,"question_id":13243130,"title":"How to draw special characters in XNA?","body":"<p>I want to draw special characters like: \"π,Ω,θ,ξ\" in XNA by using method \n<code>SpriteBatch.DrawString()</code>, but I get an exception saying those <strong>characters aren't available</strong> in the SpriteFont file. Is there any solution for this?</p>\n"},{"tags":["c#","visual-studio","installer","suite"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13274602,"title":"Creating a Windows Installer Using Visual Studio for a Suite","body":"<p>I have several C# programs that I would like to create an installer for as a suite. I'm wanting to create this in Visual Studio if possible using the Setup Project. This is my first time creating an installer for a suite, so I am unfamiliar with what most people use and how to do it. I'm also open to what other tools that I could use that might be able to get the job done better/easier. Here is what I'm wanting to be able to do:</p>\n\n<ul>\n<li><p>Licensing agreement that has the standard agree checkbox/radio button</p></li>\n<li><p>Type in a CD Key and the installer will automatically know what programs to install based on how the CD key is configured.</p></li>\n</ul>\n\n<p>OR</p>\n\n<ul>\n<li><p>Have a list of checkboxes displaying each program (similar to office) and the user can check which ones they would like to install. And maybe after selecting, have an option to type in the CD key to verify they have rights to use those programs. I'm not sure if this could be done during the installation process or if it would be best to do it when the program loads.</p></li>\n<li><p>Creates an uninstaller</p></li>\n<li><p>Other normal steps in an installation (Readme, Program location, etc.)</p></li>\n</ul>\n\n<p><strong>The main component I'm wanting out of this is to install programs that I select.</strong></p>\n"},{"tags":["c#","il2js"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13273574,"title":"How do I invoke IL2JS correctly?","body":"<p>So I saw Microsoft open-sourced <a href=\"https://github.com/Reactive-Extensions/IL2JS\" rel=\"nofollow\">IL2S</a>, which seems to be a tool to compile a silverlight applications to pure javascript via compiling the IL.</p>\n\n<p>However, I can't seem to get it to work.  When I run: </p>\n\n<blockquote>\n  <p>PS C:\\source\\IL2JS-master\\bin> ./il2jsr -rewrite C:\\FlatRedBallProjects\\Test1\\Te\n  st1\\Test1\\Bin\\Debug\\Test1.dll  -out test.js -reference .\\IL2JS_mscorlib.dll</p>\n</blockquote>\n\n<p>When I run this I get</p>\n\n<blockquote>\n  <p>error 3003: No assembly name resembled the special 'JSTypes' assembly\n  1 errors, 0 warnings</p>\n</blockquote>\n\n<p>So I tried to add another -reference option for jstypes and got the following output:</p>\n\n<blockquote>\n  <p>PS C:\\source\\IL2JS-master\\bin> ./il2jsr -rewrite C:\\FlatRedBallProjects\\Test1\\Test1\\Test1\\Bin\\Debug\\Test1.dll  -out test.js -reference .\\IL2JS_mscorlib.dll -reference  .\\IL2JS_JSTypes_silverlight.dll</p>\n  \n  <p>error 3005: Unable to load assembly from file 'C:\\source\\IL2JS-master\\bin': cannot load mscorlib\n  1 errors, 0 warnings</p>\n</blockquote>\n\n<p>So it seems like you can only have one -reference option, but you need to somehow reference both jstypes and mscorlib assemblies.</p>\n\n<p>What am I doing wrong?</p>\n\n<p><hr>\n<b>Edit</b>: \nSo after some more debugging it seems like the correct way to do this is to use 2 -reference arguments.  The reason why the latter doesn't work is because of </p>\n\n<pre><code>        CCI.SystemTypes.Initialize(false, true, ResolveReference);\n\n        // ----------------------------------------\n        // Account for mscorlib being loaded\n        // ----------------------------------------\n        mscorlib = CCI.SystemTypes.SystemAssembly;\n        if (mscorlib == null || mscorlib.Directory == null)\n</code></pre>\n\n<p>In <code>AssemblyLoader.cs</code>.  That last if statement fails (<code>mscorlib.Directory</code> is null).  Now the question is why...</p>\n"},{"tags":["c#",".net","dynamic","assemblies","code-generation"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13272877,"title":"CSharpCodeProvider and resolution of dynamic assemblies","body":"<p>I have an application where I'm using CSharpCodeProvider to allow for integrated scripting via C# code.  The scripts can refer to dynamically emitted assemblies (these are created via IL Emit); to allow this reference, I save the dynamically generated assembly to a file on disk, then add this location to the CompilerParameters.ReferencedAssemblies collection.</p>\n\n<p>This works fine for the first compilation and execution of the script.  I have code that instantiates a class generated from the script, which has a constructor taking parameters, of which some are types from the dynamically emitted assembly.  It looks like this:</p>\n\n<pre><code>        var hostType = _compilerResults.CompiledAssembly.GetType(\"ExMod.Engine.ScriptHost\");\n\n        var parameters = new List&lt;object&gt;();\n        parameters.Add(simulation);\n\n        var extraParameters =\n            simulation.Environment.Controllers.\n            Select(c =&gt; c.GetPrecompiledContext()).\n            Where(c =&gt; c != null);\n        parameters.AddRange(extraParameters);\n\n        _scriptHost = (ScriptHostBase)Activator.CreateInstance(hostType, parameters.ToArray());\n</code></pre>\n\n<p>The extraParameters expression is where the references to the external dynamically generated types get added.</p>\n\n<p>The problem occurs when I attempt to compile and run the script a second time.  It only occurs if I've also re-emitted a new version of my IL Emit assembly.  The Exception occurs on the Activator.CreateInstance call and is:</p>\n\n<p><code>MissingMethodException: Constructor on type 'ExMod.Engine.ScriptHost' not found.</code></p>\n\n<p>Observations:</p>\n\n<ol>\n<li>I've confirmed via the Debugger that a constructor does exist with the correct parameters.</li>\n<li>I've also confirmed (using the Make Object ID in the Debugger) that the issue is caused because the 'Controller' parameter in the constructor (referenced type from the dynamically emitted assembly) is referring to the original dynamic assembly, rather than the most recently emitted dynamic assembly, which is why the types don't match and the constructor does not resolve.</li>\n<li>When I run the CSharpCodeProvider compiler and then try to run the script, it never calls my AppDomain AssemblyResolve event, which is where I have special logic to always resolve to the 'most recent' dynamic assembly.</li>\n</ol>\n\n<p>My theory is that somehow the CSharpCodeProvider is resolving the 'earliest' dynamic assembly rather than the 'latest'. This occurs because they both have the same name and location.  The question: how do I get the CSharpCodeProvider to resolve to the latest version of the dynamic assembly?</p>\n\n<p>I've considered changing the location for each dynamically emitted assembly, but I'd prefer not to create a bunch of copies on disk for each script iteration.</p>\n"},{"tags":["c#","autofac"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13274547,"title":"passing optional parameter to autofac","body":"<p>I am trying to use Autofac and register the below class which receives one of the parameter as optional parameter (or rather null).\nMy classes are:</p>\n\n<pre><code>class BaseSpanRecord : ISpanRecord\n{\n    public BaseSpanRecord(RecordType recordType, List&lt;SpanRecordAttribute&gt; properties)\n    {\n        RecordType = recordType;\n        Properties = properties;\n    }\n}\n</code></pre>\n\n<p>Here <em>RecordType</em> is an enum and <em>SpanRecordAttribute</em> is a class with only properties for which i don't want to create any interface.</p>\n\n<p>In the constructor <em>RecordType</em> and <em>Properties</em> are the two public properties of the interface <em>ISpanRecord</em>\nThis class can be instantiated in the following ways in different places in the program:</p>\n\n<pre><code>ISpanRecord spanFileRecord = new BaseSpanRecord(recordType, null);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>ISpanRecord spanFileRecord = new BaseSpanRecord(recordType, recordAttributeList);\n</code></pre>\n\n<p>How should i try to register this in the Autofac container so that in can handle the above two cases?\nOr should i change something in the way <em>BaseSpanRecord</em> class has been written to make its registration easier?</p>\n"},{"tags":["c#","visual-studio-2008"],"answer_count":10,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":3911,"score":7,"question_id":1477582,"title":"Error Creating Debug Information - Code Won't Compile","body":"<p>I'm using VS 2008. When ever I make a change in my code and try to compile I get the following error:</p>\n\n<blockquote>\n  <p>Error 7\tUnexpected error creating\n  debug information file 'C:\\Documents\n  and Settings\\jbezanson\\My\n  Documents\\MyProjects\\DispatchBoard\\DispatchBoard\\obj\\Debug\\DispatchBoard.PDB'\n  -- 'C:\\Documents and Settings\\jbezanson\\My\n  Documents\\MyProjects\\DispatchBoard\\DispatchBoard\\obj\\Debug\\DispatchBoard.pdb:\n  The process cannot access the file\n  because it is being used by another\n  process. '    DispatchBoard</p>\n</blockquote>\n\n<p>Using Process Explorer, it is always <code>devenv.exe</code> that is locking the file. If I run in Release mode this does not happen. It started 2 days ago when I started a WPF application, and since then it happens with every application I work on.</p>\n\n<p>The only info I could find from Google was referring to a bug in VS 2003. </p>\n\n<p>Anyone else have this problem? How do I fix it? It is getting very annoying having to kill the file handle every time I want to compile.</p>\n"},{"tags":["c#","asp-classic","routing","iis-7.5","webmatrix"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13274000,"title":"Is there a way to have IIS default document (default.asp) take precedence over .Net routing?","body":"<p>I am trying to migrate a site from classic ASP to .Net (using WebMatrix).  I am planning on mixing the new .cshmtl pages in with the legacy .asp files and slowly migrate the site over time.  To date, I have individual .asp pages for each piece of content (each url).  As I move to .Net, the content will be coming from a database, so there will not be specific pages for each url.  I love the power of routing that is available in .Net and it works well and plays nicely with the classic ASP with one exception so far.  </p>\n\n<p>My example is that I have an ASP page located at /crafts/default.asp and currently reference that everywhere as just /crafts/.  The IIS default document setting takes care of serving the default.asp page when i just reference /crafts/.  I want to start to post new items into this area of the site but run as .Net pages.  so I created a /crafts.cshtml page which is designed to handle different urls and go to the database and lookup the item and display the info.  So as an example I have legacy page at /crafts/fall-crafts.asp and this works fine - because there is an .asp page sitting there named that.  But when i reference /crafts/ .Net takes over and serves the /crafts.cshtml page instead of serving the /crafts/default.asp file.  Is there something I can do to keep the power of .Net routing in place, but still have IIS serve the default document in this case? </p>\n"},{"tags":["c#","asp.net","generic-handler","sagepay"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13274232,"title":"ASP.NET handle a POST from Sage Pay","body":"<p>I am writing an asp.net web application to talk to sage pay and make payments via their server to server method. At present my site collects user details and then sends a transaction registration HttpRequest to their server. Their server then responds to my request with some details and a redirect link. I check out the reponse object and then redirect to their payment page where the users payment details (card number etc) can be entered. Once the user has clicked confirm then sage will send a POST to a url of my choosing which I can then process and tell them whether to continue with the transaction or not.</p>\n\n<p>What I am aiming to do is receive the POST from them, check the content and respond accordingly. I must then give them as part of my  success or failure url which their site will send the user too on completion of the transaction. If I were sending a request first it would be easy but I am not. They just need an address to send the response to and then I must process it.</p>\n\n<p>My question is this. How can I handle an HttpRequest (I assume this is what it will be?) in my web application? </p>\n\n<p>Can I do this by telling them to respond to a generic handler? If I were to give them the url of my generic handler could I process the POST in there and then respond to them?</p>\n"},{"tags":["c#","windows","winrt-xaml"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13274495,"title":"WinRT XAML TextBlock - Hyperlink Feature","body":"<p>I have a textblock as given below. I would like to make just one word clickable. Kind of like a hyperlink to another page.</p>\n\n<pre><code>&lt;TextBlock&gt;\n    &lt;Run Text=\"I can haz \" /&gt;\n    &lt;Run Text=\"Cheezburger\" Click=\"Cheezburger_Click\" /&gt;\n&lt;/TextBlock&gt;\n</code></pre>\n\n<p>Is such functionality possible?</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":13260191,"title":"Winforms controls and \"generic\" events handlers. How can I do this?","body":"<p>In the demo of the ObjectListView control there is this code (in the \"Complex Example\" tab page) to allow for a custom editor (a ComboBox) (Adapted to my case and edited for clarity):</p>\n\n<pre><code>EventHandler CurrentEH;\nprivate void ObjectListView_CellEditStarting(object sender,\n                                             CellEditEventArgs e)\n{\n    if (e.Column == SomeCol)\n    {\n        ISomeInterface M = (e.RowObject as ObjectListView1Row).SomeObject; //(1)\n        ComboBox cb = new ComboBox();\n        cb.Bounds = e.CellBounds;\n        cb.DropDownStyle = ComboBoxStyle.DropDownList;\n        cb.DataSource = ISomeOtherObjectCollection;\n        cb.DisplayMember = \"propertyName\";\n        cb.DataBindings.Add(\"SelectedItem\", \n                            M, \"ISomeOtherObject\", false,\n                            DataSourceUpdateMode.Never);\n        e.Control = cb;\n        cb.SelectedIndexChanged += \n            CurrentEH = (object sender2, EventArgs e2) =&gt;\n                M.ISomeOtherObject = \n                    (ISomeOtherObject)((ComboBox)sender2).SelectedValue;   //(2)\n    }\n}\n\nprivate void ObjectListView_CellEditFinishing(object sender,\n                                               CellEditEventArgs e)\n{\n    if (e.Column == SomeCol)\n    {\n        // Stop listening for change events\n        ((ComboBox)e.Control).SelectedIndexChanged -= CurrentEH;\n        // Any updating will have been down in the SelectedIndexChanged\n        // event handler.\n        // Here we simply make the list redraw the involved ListViewItem\n        ((ObjectListView)sender).RefreshItem(e.ListViewItem);\n        // We have updated the model object, so we cancel the auto update\n        e.Cancel = true;\n    }\n}\n</code></pre>\n\n<p>I have too many other columns with combo editors inside objectlistviews to use a copy&amp; paste strategy (besides, copy&amp;paste is a serious source of bugs), so I tried to parameterize the code to keep the code duplication to a minimum. ObjectListView_CellEditFinishing is a piece of cake:</p>\n\n<pre><code>HashSet&lt;OLVColumn&gt; cbColumns = new HashSet&lt;OLVColumn&gt; (new OLVColumn[] { SomeCol, SomeCol2, ...};\n\nprivate void ObjectListView_CellEditFinishing(object sender,\n                                               CellEditEventArgs e)\n{\n    if (cbColumns.Contains(e.Column)) ...\n</code></pre>\n\n<p>but ObjectListView_CellEditStarting is the problematic.</p>\n\n<p>I guess in CellEditStarting I will have to discriminate each case separately:</p>\n\n<pre><code>private void ObjectListView_CellEditStarting(object sender,\n                                             CellEditEventArgs e)\n{\n    if (e.Column == SomeCol)\n        // code to create the combo, put the correct list as the datasource, etc.\n    else if (e.Column == SomeOtherCol)  \n        // code to create the combo, put the correct list as the datasource, etc.\n</code></pre>\n\n<p>And so on.</p>\n\n<p>But how can I parameterize the \"code to create the combo, put the correct list as the datasource, etc.\"? Problem lines are </p>\n\n<p>(1) Get SomeObject. the property NAME varies.</p>\n\n<p>(2) Set ISomeOtherObject, the property name varies too.</p>\n\n<p>The types vary too, but I can cover those cases with a generic method combined with a not so \"typesafe\" API (for instance, the cb.DataBindings.Add and cb.DataSource both use an <code>object</code>)</p>\n\n<p>Reflection? more lambdas? Any ideas? Any other way to do the same?</p>\n\n<p>PS: I want to be able to do something like this:</p>\n\n<pre><code>private void ObjectListView_CellEditStarting(object sender,\n                                             CellEditEventArgs e)\n{\n    if (e.Column == SomeCol)\n        SetUpCombo&lt;ISomeInterface&gt;(ISomeOtherObjectCollection,\n                                   \"propertyName\",\n                                   SomeObject,\n                                   ISomeOtherObject);\n\n    else if (e.Column == SomeOtherCol)  \n        SetUpCombo&lt;ISomeInterface2&gt;(ISomeOtherObject2Collection,\n                                   \"propertyName2\",\n                                   SomeObject2\n                                   ISomeOtherObject2);\n</code></pre>\n\n<p>and so on. Or something like that.</p>\n\n<p>I know, parameters SomeObject and ISomeOtherObject are not real parameters per see, but you get the idea of what I want. I want not to repeat the same code skeleton again and again and again.</p>\n\n<p>One solution would be \"preprocessor generics\" like C's DEFINE, but I don't thing c# has something like that.</p>\n\n<p>So, does anyone have some alternate ideas to solve this?</p>\n"},{"tags":["c#","gridview","windows-mobile"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13247404,"title":"Get Value of a colum from GridView Windows Mobile 6.0","body":"<p>Somebody please tell me how to get the value of the first column of the selected row of gridview in windows mobile application 6.0 (Emulator is standard). I used to get this value from the windows application by using the code shown below but this is not working in windows mobile 6.0 standard verstion</p>\n\n<pre><code>dgridShipmentItemTypes.Rows[nIndex].Cells[\"dgridShmtItmTypeName\"].Value.ToString();\n</code></pre>\n"},{"tags":["c#","asp.net","itextsharp"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4936,"score":0,"question_id":8414637,"title":"iTextSharp HTMLWorker ParseHTML Tablestyle and PDFStamper","body":"<p>Hi I have succesfully used a HTMLWorker to convert a gridview using asp.NET / C#.</p>\n\n<p>(1) I have applied some limited style to the resulting table but cannot see how to apply tablestyle for instance grid lines or apply other formatting style such as a large column width for example for a particular column. \n(2) I would actually like to put this text onto a pre-existing template which contains a logo etc. I've used PDF Stamper before for this but cannot see how I can use both PDFStamper and HTMLWorker at once. HTMLWorker needs a Document which implements iDocListener ... but that doesnt seem compatible with usign a PDFStamper. I guess what I am looking for is a way to create a PDFStamper, write title etc, then add the parsed HTML from the grid. The other problem is that the parsed content doesnt interact with the other stuff on the page. For instance below I add a title chunk to the page. Rather than starting below it, the parsed HTML writes over the top. How do I place / interact the parsed HTML content with the rest of what is on the PDF document ? </p>\n\n<p>Thanks in advance\nRob</p>\n\n<p>Here';s the code I have already </p>\n\n<pre><code>            Document pdfDoc = new Document(PageSize.A4, 10f, 10f, 30f, 0f);\n\n            HTMLWorker htmlWorker = new HTMLWorker(pdfDoc);\n\n            StyleSheet styles = new StyleSheet();\n            styles.LoadTagStyle(\"th\", \"size\", \"12px\");\n            styles.LoadTagStyle(\"th\", \"face\", \"helvetica\");\n            styles.LoadTagStyle(\"span\", \"size\", \"10px\");\n            styles.LoadTagStyle(\"span\", \"face\", \"helvetica\");                \n            styles.LoadTagStyle(\"td\", \"size\", \"10px\");\n            styles.LoadTagStyle(\"td\", \"face\", \"helvetica\");     \n\n            htmlWorker.SetStyleSheet(styles);\n\n            PdfWriter.GetInstance(pdfDoc, HttpContext.Current.Response.OutputStream);\n\n            pdfDoc.Open();\n\n            //Title - but this gets obsured by data, doesnt move it down\n            Font font = new Font(Font.FontFamily.HELVETICA, 14, Font.BOLD);\n            Chunk chunk = new Chunk(title, font);                \n            pdfDoc.Add(chunk);\n\n\n            //Body\n            htmlWorker.Parse(sr);\n</code></pre>\n"},{"tags":["c#","asp.net","pdf","itextsharp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13270321,"title":"How to place the text in desired position of a new page in pdf?","body":"<p>I am using CSharp and iTextSharp for creating pdf.</p>\n\n<p>This is my code to place the text:</p>\n\n<pre><code>        PdfContentByte cb = writer.DirectContent;\n        cb.BeginText();\n        cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, text, width, height, 0);\n        cb.EndText();\n</code></pre>\n\n<p>After I create new page using.</p>\n\n<pre><code>        doc.NewPage();\n</code></pre>\n\n<p>and try to place the text in new page like this is not working:</p>\n\n<pre><code>        cb.BeginText();\n        cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, text, width, height, 0);\n        cb.EndText();\n</code></pre>\n\n<p>But This is working:</p>\n\n<pre><code>        ColumnText.ShowTextAligned(cb, Element.ALIGN_LEFT,\n        new Phrase(Petrol[i], font), 451 + i * x, 684, 0)\n</code></pre>\n\n<p>Can someone explain why cb.ShowTextAligned() is not worked.</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#",".net","code-contracts"],"answer_count":1,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":40,"score":6,"question_id":13274102,"title":"CodeContracts: false warning \"Possibly unboxing a null reference\"","body":"<p><img src=\"http://i.stack.imgur.com/dyPL2.png\" alt=\"enter image description here\"></p>\n\n<p>In the image above, you can see a warning from Code Contracts. I don't think this is legit, as <code>this</code> can never be <code>null</code>.</p>\n\n<p>Is this a bug or am I missing something?</p>\n\n<hr>\n\n<p>This property is a member of the following class:</p>\n\n<pre><code>public class NHibernateIQueryableQueryBase&lt;TEntity, TQuery, TQueryInterface&gt;\n    : IQuery&lt;TEntity&gt;, IFluentQueryInterface&lt;TEntity, TQueryInterface&gt;\n    where TQuery : NHibernateIQueryableQueryBase&lt;TEntity, TQuery,\n                                                 TQueryInterface&gt;,\n                   TQueryInterface\n    where TQueryInterface : IQuery&lt;TEntity&gt;\n</code></pre>\n\n<hr>\n\n<p>Update:<br>\nChanging the property to the following still shows the warning - on the line <code>return result;</code>:</p>\n\n<pre><code>public TQueryInterface And\n{\n    get\n    {\n        var result = this as TQuery;\n        return result;\n    }\n}\n</code></pre>\n"},{"tags":["c#","amazon-ec2","amazon-web-services"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13274353,"title":"Easiest way to get EC2 instance attributes within the instance itself","body":"<p>Can you guys show me how to retrieve instanceId, dns public name and type of current EC2 instance from where I'm running the code... </p>\n\n<p>I'm playing with <code>DescribeInstanceAttribute()</code>, but it needs to supply the instanceId to the request, and I can't find how to get the id of currently running instance.</p>\n"},{"tags":["c#","wpf","xaml","datagrid","string-formatting"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13272144,"title":"How can i format a string as currency in a data bound DataGrid in WPF C#?","body":"<p>I have some data being shown in a DataGrid.  The data comes from SQL, where a \"money\" type can be null.  When i display this data, all is OK when i format the data in a double column format as currency.  ie:</p>\n\n<p>internal void FillGrid()\n        {</p>\n\n<pre><code>        bD = new DataTable();\n        DataTable dt = EmployerQuery();  //queries the SQL DB\n\n\n        bD.Columns.Add(new DataColumn(\"ID\", typeof(int)));\n        bD.Columns.Add(new DataColumn(\"EmployerName\", typeof(string)));\n        bD.Columns.Add(new DataColumn(\"FlatMinAmount\", typeof(double)));\n        bD.Columns.Add(new DataColumn(\"DistrictRate\", typeof(double)));\n        bD.Columns.Add(new DataColumn(\"VendorRate\", typeof(double)));\n        bD.Columns.Add(new DataColumn(\"Description\", typeof(string)));\n        bD.Columns.Add(new DataColumn(\"EmployeeCount\", typeof(int)));\n\n        foreach (DataRow sqlRow in dt.Rows)\n        {\n            var row = bD.NewRow();\n            row[\"ID\"] = sqlRow[\"ClientID\"];\n            row[\"EmployerName\"] = sqlRow[\"OfficialName\"];\n            row[\"FlatMinAmount\"] = sqlRow[\"FlatMinAmount\"];\n            row[\"DistrictRate\"] = sqlRow[\"DistrictRate\"];\n            row[\"VendorRate\"] = sqlRow[\"VendorRate\"];\n            row[\"Description\"] = sqlRow[\"Description\"];\n            row[\"EmployeeCount\"] = sqlRow[\"EmployeeCount\"];\n\n            bD.Rows.Add(row);\n\n        }    \n</code></pre>\n\n<p></p>\n\n<p>However, I then save the data as a .csv file.  When i read that file back, the values for \"FlatMinAmount\" that were null are not allowed to be inserted into a column type double, so I cannot format the data columns as type double, since many are null.  </p>\n\n<pre><code>&lt;dg:DataGrid Name=\"newGrid\" ItemsSource=\"{Binding ElementName=readGrid, Path=readGrid}\" AutoGenerateColumns=\"False\"\n                 Margin=\"5\" Height=\"175\" Width=\"Auto\" ColumnWidth=\"Auto\"&gt;\n        &lt;dg:DataGrid.Columns&gt;\n            &lt;dg:DataGridTextColumn Binding=\"{Binding ID}\" Header=\"Employer ID\" Width=\"Auto\" IsReadOnly=\"True\"/&gt;\n            &lt;dg:DataGridTextColumn Binding=\"{Binding EmployerName}\" Header=\"Employer Name\" Width=\"Auto\" IsReadOnly=\"True\"/&gt;\n            &lt;dg:DataGridTextColumn Binding=\"{Binding FlatMinAmount, StringFormat=C}\" Header=\"FlatMinAmount\" Width=\"Auto\" IsReadOnly=\"True\"/&gt;\n            &lt;dg:DataGridTextColumn Binding=\"{Binding DistrictRate, StringFormat=C}\" Header=\"District Rate\" Width=\"Auto\" IsReadOnly=\"True\"/&gt;\n            &lt;dg:DataGridTextColumn Binding=\"{Binding VendorRate, StringFormat=C}\" Header=\"Vendor Rate\" Width=\"Auto\" IsReadOnly=\"True\"/&gt;\n            &lt;dg:DataGridTextColumn Binding=\"{Binding Description}\" Header=\"Description\" Width=\"Auto\" IsReadOnly=\"True\"/&gt;\n            &lt;dg:DataGridTextColumn Binding=\"{Binding EmployeeCount}\" Header=\"EmployeeCount\" Width=\"*\" IsReadOnly=\"True\"/&gt;\n        &lt;/dg:DataGrid.Columns&gt;\n    &lt;/dg:DataGrid&gt;\n\n\nDataTable r = new DataTable();\n\n        try\n        {\n            //string csv = string.Empty;\n\n            //r.Columns.Add(\"ID\", typeof(int));\n            //r.Columns.Add(\"EmployerName\", typeof(string));\n            //r.Columns.Add(\"FlatMinAmount\",typeof(double));\n            //r.Columns.Add(\"DistrictRate\", typeof(double));\n            //r.Columns.Add(\"VendorRate\", typeof(double));\n            //r.Columns.Add(\"Description\", typeof(string));\n            //r.Columns.Add(\"EmployeeCount\", typeof(int));\n\n            r.Columns.Add(\"ID\");\n            r.Columns.Add(\"EmployerName\");\n            r.Columns.Add(\"FlatMinAmount\");\n            r.Columns.Add(\"DistrictRate\");\n            r.Columns.Add(\"VendorRate\");\n            r.Columns.Add(\"Description\");\n            r.Columns.Add(\"EmployeeCount\");\n\n            // Read sample data from CSV file\n            using (CsvFileReader reader = new CsvFileReader(filename))\n            {\n                CsvRow row = new CsvRow();\n                while (reader.ReadRow(row))\n                {\n                    //foreach (string s in row)\n                    {\n                        r.Rows.Add(row[0], row[1], row[2], row[3], row[4], row[5], row[6]);\n\n\n                    }\n\n                }\n            }\n</code></pre>\n\n<p>(readGrid is then set to r in code-behind) </p>\n\n<p>If they are string, then i cannot use the StringFormat=C in the binding to show $ etc.  Also, it seems I cannot style a DataGridTextColumn.  So, how can i display the values I read in from .csv as $xx.xx?</p>\n"},{"tags":["c#"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":65,"score":0,"question_id":13273508,"title":"Extension method must be defined in a non-generic static class","body":"<p>I'm getting the above error. I saw other similar posts on this error but I don't seem to find where the problem is. I changed my class type to static and the error resists. This is the entire code to my main form class:</p>\n\n<p>I Edited my class. This is how it looks like now and the error has changed to:Missing partial modifier on declaration of type 'PhoneFind.frmMain'; another partial declaration of this type exists.</p>\n\n<pre><code>namespace PhoneFind\n{\n    public partial class frmMain : Form\n    {\n        // the path to the temporary file to store the webresponse\n        String path = \"c:\\\\Temp\\\\webresponse.txt\";\n        public frmMain()\n        {\n            InitializeComponent();\n            comboSelectSearchEngine.SelectedIndex = 0;\n            ofdPhones.Filter = \"txt files (*.txt)|*.txt\";\n            listbxMessages.Items.Clear();\n            addItemToListBox(listbxMessages, \"Welcome to ActionBase Phone Find!\");\n            addItemToListBox(listbxMessages, \"Select the file containing the numbers.\");\n            radioNumbers.Checked = true;\n        }\n\n        private void frmMain_Load(object sender, EventArgs e)\n        {\n\n        }\n\n        private void btnLoadFile_Click(object sender, EventArgs e)\n        {\n            if (ofdPhones.ShowDialog() == System.Windows.Forms.DialogResult.OK)\n            {\n                txtFile.Text = ofdPhones.FileName;\n\n                // Read the file line by line and add the numbers to the numbers listbox.\n                listbxNumbers.Items.Clear();\n                String line;\n                int numbersCounter = 0;\n                System.IO.StreamReader file = new System.IO.StreamReader(ofdPhones.FileName);\n                while ((line = file.ReadLine()) != null)\n                {\n                    listbxNumbers.Items.Add(line.Trim());\n                    numbersCounter++;\n                }\n                addItemToListBox(listbxMessages, ofdPhones.FileName + \" loaded.\");\n                addItemToListBox(listbxMessages, numbersCounter + \" records found in the file.\");\n\n            }\n        }\n\n        // add item to the listbox and move scroll to the end of the listbox for the latest messages to be visibile to the viewer\n        private void addItemToListBox(ListBox listbox, String item)\n        {\n            listbox.Items.Add(item);\n            listbox.SelectedIndex = (listbox.Items.Count - 1);\n        }\n\n        private void radioNumbers_CheckedChanged(object sender, EventArgs e)\n        {\n            if (!radioNumbers.Checked)\n            {\n                grpbxNumbers.Text = \"Names and Addresses\";\n            }\n            else\n            {\n                grpbxNumbers.Text = \"Numbers\";\n            }\n        }\n\n        private void btnRun_Click(object sender, EventArgs e)\n        {\n            if (listbxNumbers.Items.Count == 0)\n            {\n                MessageBox.Show(\"No records have been loaded.\" + \"\\n\" + \"Use the browse button to load records.\", \"Error\", MessageBoxButtons.OK, MessageBoxIcon.Error);\n            }\n            else if (!CheckForInternetConnection())\n            {\n                MessageBox.Show(\"No internet connection.\", \"Error\", MessageBoxButtons.OK, MessageBoxIcon.Error);\n            }\n            else\n            {\n                String response;\n                switch (comboSelectSearchEngine.SelectedIndex)\n                {\n                    case 0: // Hitta.se\n                        foreach (String item in listbxNumbers.Items)\n                        {\n                            WebRequestObj request = new WebRequestObj(item, \"hitta\");\n                            response = request.sendRequest();\n                            if (response.Equals(\"Error\"))\n                            {\n                                addItemToListBox(listbxMessages, \"Error sending '\" + item + \"' to the server.\");\n                            }\n                            else\n                            {\n                                //create a temporary file to work on the response\n                                StreamWriter sw;\n                                if (!File.Exists(path)) {\n                                    sw = File.CreateText(path);\n                                }\n                                try\n                                {\n                                    File.WriteAllText(path, String.Empty); // clear the content of the file\n                                    sw = File.AppendText(path);\n                                    sw.WriteLine(response);\n                                    sw.Flush();\n                                    sw.Close();\n                                    String s = findResultType(path);\n                                    MessageBox.Show(s);\n                                }\n                                catch (IOException ioe)\n                                {\n                                    MessageBox.Show(ioe.Message,\"Error\", MessageBoxButtons.OK, MessageBoxIcon.Error);\n                                }\n\n\n                            }\n                        }\n                        break;\n                }\n            }\n        }\n\n        public bool CheckForInternetConnection()\n        {\n            try\n            {\n                using (var client = new System.Net.WebClient())\n                using (var stream = client.OpenRead(\"http://www.google.com\"))\n                {\n                    return true;\n                }\n            }\n            catch\n            {\n                return false;\n            }\n        }\n\n        /*\n         * findResultType\n         * gets the web response and finds out if the matching result of the search termis one of the following:\n         * 1. one person (oneperson)\n         * 2. one company (onecompany)\n         * 3. more than one person, no company (manypersonnocompany)\n         * 4. no person, more than one company (nopersonmanycompany)\n         * 5. more than one person, more than one company (manypersonmanycompany)\n         * 6. no person, no company (nopersonnocompany)\n         */\n        public String findResultType(String reponsepath)\n        {                   \n            HtmlAgilityPack.HtmlDocument doc = new HtmlAgilityPack.HtmlDocument();\n            doc.Load(reponsepath);\n            List&lt;String&gt; itemList = new List&lt;String&gt;();\n            IEnumerable&lt;String&gt; v = null;\n            var item = doc.DocumentNode.SelectNodes(\"//body[@id='person']\");\n\n            if (item != null)\n            {\n                v = item.Select(p =&gt; p.InnerText);\n                itemList = v.ToList();\n                if (itemList.Count == 1)\n                    return \"oneperson\";\n            }\n            else\n            {\n                item = doc.DocumentNode.SelectNodes(\"//body[@id='company']\");\n                if (item != null)\n                {\n                    v = item.Select(p =&gt; p.InnerText);\n                    itemList = v.ToList();\n                    if (itemList.Count == 1)\n                        return \"onecompany\";\n                }\n            }\n\n            //for (int i = 0; i &lt; itemList.Count; i++)\n            //{\n            //    MessageBox.Show(itemList[i]);\n            //    //console.writeline(itemlist[i]);\n            //}\n            //console.writeline(itemlist.count + \" results found.\");\n            return \"\";\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#",".net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13274113,"title":"Variables that accept values with pipe | as separator","body":"<p>I have six variables of type <code>String</code>, they contain 0/1 value retrieved from a DB field bit.</p>\n\n<p>So,these variables are value of radio boxes, that have Y=1 | N=0. </p>\n\n<p>Now,  I have a Varilable,  that accept one or more enumerator values, they are separated by pipe \"|\".</p>\n\n<pre><code>if (bool.Parse(mht_ReadAccess) &amp;&amp; bool.Parse(mht_WriteAccess))\n{\n  var grantAccessRequest = new GrantAccessRequest\n  {\n    PrincipalAccess = new PrincipalAccess\n    {\n      AccessMask = AccessRights.WriteAccess | AccessRights.ReadAccess,\n      Principal = userreference\n    },\n    Target = recordentityreference\n  };\n}\n</code></pre>\n\n<p>Now, this is a static way to solve this problem.  If I have 6 variables like \"mht_WriteAccess\" , how can I check how many of them are set on  true, and automatically change the situation for the \"AccessMask\" variable, and so pass all the right enum values with pipe.</p>\n\n<p>I want to know if there's a way to do this automatically, maybe with any cycle?</p>\n"},{"tags":["c#","sql-server","crystal-reports"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13274399,"title":"CrystalDecisions.CrystalReports.Engine.ReportDocument' threw an exception","body":"<p>Once my crystal report sap 2010 was corrupted and re installed my crystal report software but nothing changed after that i followed the instruction on this link </p>\n\n<pre><code>http://social.msdn.microsoft.com/Forums/en-US/vscrystalreports/thread     /c0a40e76-7bd9-4113-85a7-190873318c07/\n</code></pre>\n\n<p>and after installing crystal report software i re installed my software and the things start working again. Now i am facing same error again </p>\n\n<pre><code>CrystalDecisions.CrystalReports.Engine.ReportDocument' threw an exception\n</code></pre>\n\n<p>But the above is not a permenant solution, Please Help.</p>\n"},{"tags":["c#","oracle","plsql","odp.net"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":99,"score":0,"question_id":12416315,"title":"Using C# and ODP.NET and Oracle, how do you get an associative array (pl/sql table) from a stored procedure","body":"<p>Using C# 4.0 and ODP.NET.  We have a stored procedure that is part of a package that takes two in parameters and returns a pl/sql table.</p>\n\n<p>I have googled for hours and have found many examples of code here and elsewhere where you pass an array to a stored procedure, but have not found a single example where you get a pl/sql table back.</p>\n\n<p>Is this possible?  I believe it has to be but not sure anymore.</p>\n\n<p>Note: I am NOT getting back a ref cursor, it is a pl/sql table (associate array)</p>\n"},{"tags":["c#","sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":41,"score":0,"question_id":13273333,"title":"Compare two Tables SQLSE","body":"<p>I want to know if that possible to compare two columns in two different tables in one database using C# with SQLSE.  if the two table has the same data in order, i can say the two tables are match; otherwise, there is no match.</p>\n\n<p>// More info </p>\n\n<p>I want to compare two column has repeated value the two column vlaues come from actual combination of visits for two patients and i want to check do they visit the hospital on the same date and rational insted to go for every 5 combination and compare the match i want to compare the whole table</p>\n"},{"tags":["c#","entity-framework","mvc","jqgrid"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13274096,"title":"Good programming principles while using EF/Code First/Repository Pattern/Table Per Type (TPT)?","body":"<p>Just curious.</p>\n\n<p>Say I have a Base entity and I'm deriving about 10 different child entities from it using the Table Per Type method. I also have a generic repository which can fetch me data from each of these child entities. I eventually want to map each of the child entities to a separate view model and link each of the view models to its own grid (JqGrid) on my website, with each grid having its own Create, Read, Update, Delete methods. I can do all of that, but I'm not sure what's the proper way to go about it while keeping code to a minimum.</p>\n\n<p>Right now, I have every field defined (from both the parent and child entity) in each of my view models. Is it better to have a \"parent\" view model and then deriving the child view models from it in order to mimic the inheritance structure of the entities? I wouldn't think so....having inheritance in view models doesn't make much sense to me.</p>\n\n<p>Also, I really don't want to duplicate CRUD operations for each grid. Is that considered good practice? Should each view model have its own set of CRUD operations in this case?</p>\n\n<p>Take 'Read' for instance. I'm basically returning JSON data based on the ID (key) field of the view model for each grid. And since all grids will have this ID column (part of the parent entity), should I only have one function that takes care of this for all grids? Should I be using reflections? Should I be making use of polymorphic properties of the parent/child entities?</p>\n\n<p>Or is it better to keep these operations separate for each grid?</p>\n\n<p>Hmmm..</p>\n"},{"tags":["c#",".net","linq","extension-methods","ienumerable"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":67,"score":0,"question_id":13270063,"title":"Is there any built-in .NET Framework alternative for my extension method?","body":"<p>I got this nice method which I use in many cases.</p>\n\n<pre><code>internal static IEnumerable&lt;TResult&gt; RoundTrip&lt;TSource, TResult&gt;\n (this IEnumerable&lt;TSource&gt; e, Func&lt;TSource, TSource, TResult&gt; currentNextAction)\n{\n    using (IEnumerator&lt;TSource&gt; enumer = e.GetEnumerator())\n    {\n        if (!enumer.MoveNext())\n            yield break;\n\n        bool flag = true;\n        TSource first = enumer.Current;\n\n        do\n        {\n            TSource current = enumer.Current;\n            TSource next = (flag = enumer.MoveNext()) ? enumer.Current : first;\n            yield return currentNextAction(current, next);\n        } while (flag);\n    }\n}\n</code></pre>\n\n<p>I have looked <a href=\"http://msdn.microsoft.com/en-us/library/system.linq.enumerable.aspx\" rel=\"nofollow\">MSDN</a> for some built-in alternatives, but could not find them. Is there any?</p>\n\n<p>And, is there anything I could improve in this code?</p>\n\n<p><strong>EDIT</strong>: New code for non-enumeratorable method.</p>\n\n<pre><code>internal static IEnumerable&lt;TResult&gt; RoundTrip&lt;TSource, TResult&gt;\n (this IEnumerable&lt;TSource&gt; e, Func&lt;TSource, TSource, TResult&gt; currentNextAction)\n{\n    bool flag = false;\n    TSource first = default(TSource);\n    TSource previous = default(TSource);\n\n    foreach (TSource item in e)\n    {\n        if (!flag)\n        {\n            flag = true;\n            first = previous = item;\n            continue;\n        }\n\n        yield return currentNextAction(item, previous);\n        previous = item;\n    }\n\n    if (flag)\n        yield return currentNextAction(previous, first);\n    else\n        yield break;\n}\n</code></pre>\n\n<p>(I like the first one by the way)</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":5,"view_count":32,"score":-4,"question_id":13273796,"title":"Working Lyrics Service?","body":"<p>I need a Lyrics provider for my media player.\nSearched the web and found alot of samples. None of them work now, either the service is down or service has changed the API :S</p>\n\n<p>Can someone direct me to a working API Service for a lyrics providing app??</p>\n\n<p>According to my knowledge these sites don't supply their services for developers anymore\nLyricsPlugin : Not Working\nLyricWiki : Not Working\nLeosLyrics\nLyrDB(worked sometime back though)</p>\n\n<p>.Net 4, C#, WPF</p>\n\n<p>Thanks in advance.\nHave a nice day! :)</p>\n"},{"tags":["c#",".net","wpf","vb.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13274253,"title":"WPF ,Window AllowTransparency , Poor Performance Fix","body":"<p>Performance for a Windows Presentation Foundation (WPF)-based program may be less than expected. For example, you may experience jittery animation, a low frame rate, or high CPU usage. This problem occurs if the program uses the layered windows feature. This feature is enabled if the value of the Windows.AllowsTransparency property is set to TRUE.</p>\n"},{"tags":["c#","asp.net-mvc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13273144,"title":"What approach should be used for model binding to an exisiting session object?","body":"<p>Here's my problem:</p>\n\n<p>We have an intranet asp.net mvc 3 application with a controlled set of users. We have a Person class, that contains a large amount of information, that is initially loaded and stored in the session. The data/editing for this object spans across many screens. Basically, each screen is a subset of the Person's data.  </p>\n\n<p>I'm trying to take advantage of the built in model binding in asp.net mvc. Should I create a data class that binds the form data from each screen and then updates my session object using a service object?  </p>\n\n<p>Example below: DxFormData contains a subset of the person data and will only be used as a parameter on this method. </p>\n\n<pre><code> public ActionResult Dx(DxFormData data)\n {\n    // Update current session Person object with data passed in if modelstate is valid\n    var viewModel = this.GetDxViewModel();        \n    return View(viewModel);\n }\n\npublic class DxForm Data\n{\n    public string AdmitDx { get; set; }\n    public string PrinDx { get; set; }\n}\n</code></pre>\n\n<p>I'm looking for thoughts on this approach and if there's a better solution available to me. The problem that I see, is that the person class contains all the data and I'm creating another class with a subset of that data. Obviously, duplicating the properties.</p>\n\n<p>Side note: I did write a custom model binder that returned the session person for binding. However, I am continually getting errors when it attempts to bind. </p>\n"},{"tags":["c#",".net","windows-8"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":49,"score":3,"question_id":13274145,"title":"using .net 4 projects with 4.5 target?","body":"<p>I am new to .NET and c#.</p>\n\n<p>There are so many good examples out there made for .NET 4.0, but when I do NUGET it complains that the target .net version mismatches.</p>\n\n<p>I am developing for Windows 8 and Windows Phone 8, so they use .NET 4.5.</p>\n\n<p>Is there any way to just convert the old projects and force them to use .NET 4.5? \nOr do I need to wait for the author to update his project?</p>\n"},{"tags":["c#","email"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13273914,"title":"net.mail and web.mail vs gmail","body":"<p>I am wondering, if I can use <code>System.Net.Mail</code> with 465 port and <code>System.Web.Mail</code> with 587 port. For example for gmail, I cannot switch ports in this example as it will throw transport protocol exception...</p>\n\n<pre><code>using web = System.Web.Mail;\nusing net = System.Net.Mail;\n\nprivate void SendMail()\n{\n    web.MailMessage webMail = new web.MailMessage();\n    webMail.To = \"MAILTO@gmail.com\";\n    webMail.From = \"MAILFROM@gmail.com\";\n\n    webMail.Fields.Add(\"http://schemas.microsoft.com/cdo/configuration/sendusing\", \"2\");\n    webMail.Fields.Add(\"http://schemas.microsoft.com/cdo/configuration/smtpusessl\", \"true\");            \n    webMail.Fields.Add(\"http://schemas.microsoft.com/cdo/configuration/smtpauthenticate\", \"1\");\n    webMail.Fields.Add(\"http://schemas.microsoft.com/cdo/configuration/sendusername\", \"LOGIN\");\n    webMail.Fields.Add(\"http://schemas.microsoft.com/cdo/configuration/sendpassword\", \"PASSWORD\");\n    webMail.Fields.Add(\"http://schemas.microsoft.com/cdo/configuration/smtpserverport\", 465);\n    web.SmtpMail.SmtpServer = \"smtp.gmail.com\";\n    web.SmtpMail.Send(webMail);\n\n    net.SmtpClient smtp = new net.SmtpClient();\n    smtp.UseDefaultCredentials = false;\n    smtp.Credentials = new System.Net.NetworkCredential(\"LOGIN\", \"PASSWORD\");\n    smtp.Port = 587;\n    smtp.Host = \"smtp.gmail.com\";\n    smtp.EnableSsl = true;\n\n    var netMail = new net.MailMessage(new net.MailAddress(\"MAILFROM@gmail.com\", \"\", System.Text.Encoding.UTF8),\n                                      new net.MailAddress(\"MAILTO@gmail.com\", \"\", System.Text.Encoding.UTF8));\n\n    smtp.Send(netMail); \n}\n</code></pre>\n\n<p>I am asking because even the simplest second <code>Net.Mail</code> cannot be sent under Russian Win 7 64x in .Net 2.0 build - it throws exception about invalid character in the header... And We.Mail works as expected. But I dont want to use it...</p>\n"},{"tags":["c#",".net","isolatedstorage"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":7089,"score":6,"question_id":1112681,"title":"Can I get a path for a IsolatedStorage file and read it from external applications?","body":"<p>I want to write a file where an external application can read it, but I want also some of the IsolatedStorage advantages, basically insurance against unexpected exceptions. Can I have it?</p>\n"},{"tags":["c#",".net","sqlite3","compact-framework","system.data.sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13249669,"title":"Updating Multiple Tables using single connection object in System.Data.SQLite","body":"<p>I am using Compact Framework <code>SQLite ADO adapter(System.Data.SQLite)</code> to update the database on my device. I am storing my <code>DB</code> in file. The DB contains 3-4 table which may get access concurrently. My query is, can I execute insert, update, read on these tables using single <code>SQLiteConnection</code> object?  </p>\n\n<p>Thanks,\nOmky</p>\n"},{"tags":["c#","multithreading","task"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":67,"score":3,"question_id":13273929,"title":"c# Task do not work without sleep between them","body":"<p>I'm using Task in c# to send file via FTP in multithread.</p>\n\n<p>here is my function (file is a list of strings)</p>\n\n<pre><code> Task&lt;bool&gt;[] result = new Task&lt;bool&gt;[file.Count];\n        int j = 0;\n        foreach (string f in file)\n        {  \n            result[j] = new Task&lt;bool&gt;(() =&gt; ftp.UploadFtp(f, \"C:\\\\Prova\\\\\" + f + \".txt\", j));\n            result[j].Start();\n            j++;\n\n            //System.Threading.Thread.Sleep(50);\n\n        }\n        Task.WaitAll(result, 10000);\n</code></pre>\n\n<p>and the function to upload files</p>\n\n<pre><code>public static bool UploadFtp(string uploadFileName, string localFileName, int i)\n    {\n        FtpWebRequest request = (FtpWebRequest)WebRequest.Create(\"ftp://127.0.0.1/\" + uploadFileName + \".txt\");\n        //settare il percorso per il file da uplodare\n        //FtpWebRequest request = (FtpWebRequest)WebRequest.Create(\"ftp://desk.txt.it/\");\n        request.Method = WebRequestMethods.Ftp.UploadFile;\n\n        request.Credentials = new NetworkCredential(\"ftp_admin\", \"\");\n        //request.Credentials = new NetworkCredential(\"avio\", \"avio_txt\");\n        try\n        {\n            Console.WriteLine(uploadFileName);\n            Console.WriteLine(i);\n            StreamReader sourceStream = new StreamReader(localFileName);\n            byte[] fileContents = File.ReadAllBytes(localFileName);\n\n            sourceStream.Close();\n            request.ContentLength = fileContents.Length;\n\n            Stream requestStream = request.GetRequestStream();\n            requestStream.Write(fileContents, 0, fileContents.Length);\n            requestStream.Close();\n\n            FtpWebResponse response = (FtpWebResponse)request.GetResponse();\n\n            //MessageBox.Show(\"Upload File Complete, status {0}\", response.StatusDescription);\n\n            response.Close();\n            return true;\n        }\n        catch (Exception e)\n        {\n            return false;\n        }\n\n    }\n</code></pre>\n\n<p>in this way the program try always to save the last file of the list, but if I add a Sleep(50) it uploads the files correctly.\nit seems that the program starts 4 task doing the same job (saving the last file) only if I do not use sleep, but I do not understand why and I don't know how to solve the problem.</p>\n\n<p>Can someone help me? thank you</p>\n"},{"tags":["c#","casting","type-conversion","unboxing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13269809,"title":"Automatic unboxing","body":"<p>I have an array of objects (<code>object[]</code>). All the items in this array have the same type (unknown at compile time). I need to convert this array in a typed array, that is, if the items are integers, I want to get an <code>int[]</code>.</p>\n\n<p>I've looked into the <code>Array.ConvertAll</code> method, but I need to specify a specific type in the template, meaning that I have to get the element type then call <code>ConvertAll</code> for each case possible.</p>\n\n<p>I've also looked into the keyword <code>dynamic</code> with no more luck (looks like <code>dynamic[]</code> is the same as <code>object[]</code>).</p>\n\n<p>How can I achieve this?</p>\n"},{"tags":["c#","encryption","rsa","public-key-encryption"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13272063,"title":"How / Should I Encrypt Variable Size Data with RSA (RSACryptoServiceProvider)","body":"<p>In my research I have found mixed messages on this subject so I'm looking for expertise to explain the best approach to encrypting variable amounts of data.</p>\n\n<p><strong>Requirements:</strong></p>\n\n<p>[Edit: Adding additional requirement #3 in response to comment]</p>\n\n<ol>\n<li><p>I would like to use RSA for the public/private key encryption scheme\nso I can distribute the public key to an application that should\nencrypt data but should not know how to decrypt it</p></li>\n<li><p>I need to support data lengths from 16 characters (credit card\nnumber) to kilobytes (serialized objects) and beyond.  Most of the\n    data I encrypt will be small (credit cards, addresses, etc).</p></li>\n<li><p>This is for encrypting data at rest.</p></li>\n</ol>\n\n<p><strong>Options I'm Aware Of:</strong></p>\n\n<ol>\n<li><p><strong>RSA-ONLY:</strong> Use <code>RSACryptoServiceProvider</code> to encrypt all data using public key. \nIterate through the data in blocks that are less than the key size\nminus padding.</p></li>\n<li><p><strong>HYBRID:</strong> Use <code>AesCryptoServiceProvider</code> to encrypt the data, calling\n<code>.GenerateKey()</code> and <code>.GenerateIV()</code> to generate a random key and IV.\nThen use RSACryptoServiceProvider to encrypt the above key and IV\nand prepend or append that to the data.</p></li>\n</ol>\n\n<p>It seems to my the Hybrid approach gives me the best of both worlds.  Strong block cipher (AES) and distributed public key (RSA).</p>\n\n<p>What are the pros and cons of these approaches?  What is the standard?  Surprisingly I have not found much opinion or information on the subject and would appreciate any references you might have.</p>\n\n<p><strong>Bonus:</strong>\nI am rolling my own for various reasons including corporate licensing restrictions but I'm curious if there is a good standard opensource approach for C#.</p>\n"},{"tags":["c#","sql","xml","escaping"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13273860,"title":"Backslashes in XML returned from stored procedure","body":"<p>I have written a stored procedure that returns my rows as XML with the following syntax:</p>\n\n<pre><code>FOR XML PATH ('customer'), ROOT ('customers'), TYPE\n</code></pre>\n\n<p>Running the query from the stored procedure in SSMS produces output that when clicked, looks just fine.  </p>\n\n<p>However, calling that stored procedure from C# gives me XML that I assume has double quotes that are escaped, thus:</p>\n\n<pre><code>&lt;customers&gt;&lt;customer id=\\\"123456\\\" firstName=\\\"ABE\\\" lastName=\\\"LINCOLN\\\" dob=\\\"02/12/1809\\\"&gt;\n</code></pre>\n\n<p>My C# code looks like this:</p>\n\n<pre><code>public string GetCustomerXML()\n{\n     string xml = string.Empty;\n     XmlDocument xmlDoc = new XmlDocument();\n\n     using (SqlConnection myConnection = new SqlConnection(connectionString))\n     {\n          myConnection.Open();\n\n          using (SqlCommand cmd = new SqlCommand(\"GetData_CreateXML\", myConnection))\n          {\n               cmd.CommandType = CommandType.StoredProcedure;\n\n               using (XmlReader reader = cmd.ExecuteXmlReader())\n               {\n                   while (reader.Read())\n                   {\n                       xmlDoc.Load(reader);\n                       xml = xmlDoc.OuterXml.ToString();\n                   }\n               }\n           }\n     }\n\n     return xml;\n}\n</code></pre>\n\n<p>What am I getting wrong here? </p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","txtextcontrol"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":9,"view_count":57,"score":-6,"question_id":13273278,"title":"compile and execute lines of code from txt in C#","body":"<p>I have on text s this lines:</p>\n\n<pre><code>myData = myData.Replace(\".jpg\", \"&gt;JPG&lt;\");\nmyData = myData.Replace(\".gif\", \"&gt;GIF&lt;\");\nmyData = myData.Replace(\".png\", \"&gt;PNG&lt;\");\nmyData = myData.Replace(\".tif\", \"&gt;TIF&lt;\");\n</code></pre>\n\n<p>and on my C# program i wont  one by one, on a cicle for:</p>\n\n<pre><code>for (int l=0; w&lt;listWithLines.Count;l++)\n{\n// MY LINE\n// listWithLines[l]\n}\n</code></pre>\n"},{"tags":["c#",".net","outlook"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13274078,"title":"Outlook 2003+ Embedding signatures with images to all sent emails","body":"<p>I have a Win Form application that does some boring accounting stuff and then sends it's data to some lucky recipients. I am using the Outlook 12.0 Interop objects and my applications environment ranges from office 2003 on XP to office 2007 on Win 7.</p>\n\n<p>My issue lies with sending the corporate signature with the sent emails.\nIt contains two images and I would like to embed these images so they appear to be part of the body (assuming the receiving mail client supports that).</p>\n\n<p>I have tried a few different methods of accomplishing this; but still no luck!</p>\n\n<p>I have tried:</p>\n\n<ul>\n<li><p>Extracting the html data from the signatures folder, changing the\nhtml img tags src attribute to include 'file///'. This causes Outlook\nto replace the 'file///' with 'CID' and I assumed it would also embed\nthe image... we should never assume :|. This is the method I found\nworked best for getting the rest of the signature.</p></li>\n<li><p>(After creating a new MailItem) - Grabbing the HTMLBody of the MailItem\nand extracting the relevant part including the signature... This\ndidnt work due to the new MailItem object being very inconsistent\nwith it's signature. By that I mean sometimes the new item would\ninclude the signature and sometimes it wouldn't! :s I cannot figure out why it is not    always there, no other part of my code has changed!</p></li>\n</ul>\n\n<p>I read on another post here about the GetInspector property... Apparently just calling this will do 'Some stuff' and the signature will magically appear in your mail item... NO!</p>\n\n<p>Things I can't do:</p>\n\n<ul>\n<li>I cannot (as much as i would like to) shove the images online\nsomewhere and point to them in the emails html.</li>\n<li>I cannot use SMTP(It has to be through Outlook... sigh).</li>\n</ul>\n\n<p>I am thinking that the best way seems to be my original method of messing about with the CID, but I do not really know much about what Outlook is doing in the background so I am having trouble figuring out what else I need to do to get the images sent along with the email.</p>\n\n<p>Hoping someone out there has some idea about what I am doing wrong or what else I could try.</p>\n\n<p>Please let me know if code would be helpful and I will post, (Most of the code tried is from this site... I just cannot find the links again and am trying to avoid making this question tooooo long).</p>\n\n<p>Many thanks</p>\n"},{"tags":["c#","dropbox"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13273835,"title":"Searching DropBox for all files and folders under directory","body":"<p>Imagine that I have a file/folder structure setup like this in my dropbox.</p>\n\n<pre><code>Pictures\n    photo1.png\n    photo2.png\n    TestFolder1\n        April.png\n        MyPictures\n             ProfilePic.png\n    TestFolder2\n        2012\n            August\n                Photos\n                    photo3.png\n                    photo4.png\n</code></pre>\n\n<p>Now I want to get all the files and folders that are contained in the pictures directory. So I use the Dropbox REST API to make a call to the WebService to return all the files and folders in the path I requested. So for example the path might be \"Pictures\". It then returns JSON with all the data contained in the folder, but does not descend into any of the subfolders. How do I get dropbox to dig into all of the subfolders and return a list of all subfolder/subfiles.</p>\n\n<p>Code:</p>\n\n<pre><code>        var uri = new Uri(new Uri(DropboxRestApi.BaseUri), String.Format(\"metadata/{0}/{1}\", root, path));\n        try\n        {\n            var json = GetResponse(uri);\n            return ParseJson&lt;File&gt;(json);\n        }\n        catch\n        {\n            Console.WriteLine(\"Error fetching files.\");\n        }\n        return null;\n</code></pre>\n"},{"tags":["c#"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13272894,"title":"Move multiple items in a list","body":"<p>I have a list class that implements <code>IEnumerable&lt;T&gt;</code>.<br>\nType T is a complex class with a string member as unique identifier. But it's enough to take just <em>int</em> as element type for explanations.</p>\n\n<p>I want to move multiple items one step to left.<br>\nExample:<br>\nOriginal list: <strong><em>0</strong>, 1, 2, <strong>3</strong>, <strong>4</strong>, 5</em><br>\nNow all bold items (0,3,4) should be moved to left (as far as possible).<br>\nResult list: <strong><em>0</strong>, 1, <strong>3</strong>, <strong>4</strong>, 2, 5</em>  </p>\n\n<p>Is there a good algorithm to do that? Maybe just with LINQ.</p>\n\n<p>Edit: Answers for a <code>List&lt;T&gt;</code> list are welcome. (Thanks for hint by TylerOhlsen.)<br>\nEdit2: One selected item should not pass another selected item.</p>\n"},{"tags":["c#","web-services","excel","file","upload"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13273693,"title":"Uploading and saving an Excel file C# webservice using javascript","body":"<p>I have a javascript code that uploads a file to the server using XMLHttpRequest object. I am accepting the file as a Stream in the web service that is written using C#:</p>\n\n<pre><code>int uploadFile(Stream file)\n{\n    using (FileStream fileStream = File.Create(System.AppDomain.CurrentDomain.BaseDirectory + \"file.csv\"))\n            {\n                byte[] buffer = new byte[8 * 1024];\n                int len;\n                while ((len = file.Read(buffer, 0, buffer.Length)) &gt; 0)\n                {\n                    fileStream.Write(buffer, 0, len);\n                }    \n            }\n    //process file\n    return 0;\n}\n</code></pre>\n\n<p>In javascript the file is sent as a form data object:</p>\n\n<pre><code>var fd = new FormData(document.forms.namedItem(\"file\"));\nvar req = new XMLHttpRequest();\nreq.open(\"POST\", url, true);\nreq.send(fd);\n</code></pre>\n\n<p>Now, I am trying to save the Excel file on the server. I am reading the stream into a byte array and writing it to a csv file. But the error I am facing is corrupted data in the csv file.</p>\n\n<p>Where am I going wrong or is there any other way to upload and save file through web service?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","ienumerable","resultset"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13242706,"title":"How do I set a variable based on specific element from database call?","body":"<p>Ok, I'll preface this with the fact that I am new to c# and using WebMatrix.  I'm trying to do a database call as part of page and get information specific to \"Category\" and then use that data from the database to put information on the page - including for example, setting the page title to be the CategoryTitle from the database.  Below is my sample code and I know I am just not understanding something, but basically I get the data from the database (which includes a bunch of stuff about the category like; id, title, description, etc) into an IEnumerable (which i don't fully understand what that is) and then I just want to reference the CategoryTitle (which is the name of the field in the database and result set.  When I use the code below, I get the following error \"Compiler Error Message: CS1061: 'System.Collections.Generic.IEnumerable' does not contain a definition for 'CategoryTitle' and no extension method 'CategoryTitle' accepting a first argument of type 'System.Collections.Generic.IEnumerable' could be found (are you missing a using directive or an assembly reference?)\"</p>\n\n<p>I know the \"categoryData.CategoryTitle;\" part is wrong, but how do I do what I am trying to?  I can get it to work using a foreach loop and doing \"foreach(var row in categoryData)\" and then saying \"row.CategoryData\", but i feel like i shouldn't have to do that since its only one record in the result set.</p>\n\n<pre><code>@{\n\n    Layout = \"~/layouts/_layout.cshtml\";\n\n    var categoryID = 1;\n    IEnumerable&lt;dynamic&gt; categoryData = null;\n\n    var db = Database.Open(\"Connection\"); \n    categoryData = db.Query(\"exec sp_get_Category @CategoryID=\" + categoryID);\n\n    Page.Title = categoryData.CategoryTitle;\n\n}\n</code></pre>\n"},{"tags":["c#","encoding","ascii","smartcard","vfp"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":328,"score":1,"question_id":9309094,"title":"Visual FoxPro (VFP) CTOBIN and BINTOC Functions - Equivalent In .Net","body":"<p>We are rewriting some applications previously developed in Visual FoxPro and redeveloping them using .Net ( using C# ) </p>\n\n<p>Here is our scenario:\nOur application uses smartcards. We read in data from a smartcard which has a name and number. The name comes back ok in readable text but the number, in this case '900' comes back as a 2 byte character representation (131 &amp; 132) and look like this - ƒ„</p>\n\n<p>Those 2 special characters can be seen in the extended Ascii table.. now as you can see the 2 bytes are 131 and 132 and can vary as there is no single standard extended ascii table ( as far as I can tell reading some of the posts on here )</p>\n\n<p>So... the smart card was previously written to using the BINTOC function in VFP and therefore the 900 was written to the card as ƒ„. And within foxpro those 2 special characters can be converted back into integer format using CTOBIN function.. another built in function in FoxPro..</p>\n\n<p>So ( finally getting to the point ) - So far we have been unable to convert those 2 special characters back to an int ( 900 ) and we are wondering if this is possible in .NET to read the character representation of an integer back to an actual integer.</p>\n\n<p>Or is there a way to rewrite the logic of those 2 VFP functions in C#?</p>\n\n<p><strong>UPDATE</strong>:\nAfter some fiddling we realise that to get 900 into 2bytes we need to convert 900 into a 16bit Binary Value, then we need to convert that 16 bit binary value into a decimal value.</p>\n\n<p>So as above we are receiving back 131 and 132 and their corresponding binary values as being 10000011 ( decimal value 131 ) and 10000100 ( decimal value 132 ).\nWhen we concatenate these 2 values to '1000001110000100' it gives the decimal value 33668 however if we removed the leading 1 and transform '000001110000100' to decimal it gives the correct value of 900... </p>\n\n<p>Not too sure why this is though... </p>\n\n<p>Any help would be appreciated.</p>\n"},{"tags":["c#","sqlite","orm","ormlite-servicestack"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13262935,"title":"Keeping classes and table schemas in sync when using an ORM","body":"<p>I haven't had a lot of experience with ORMs. I'm trying to figure out the best way to handle the adding/removing of properties from a mapped class, ideally in an automatic and generic way.</p>\n\n<p>I'm using ServiceStack.OrmLite and SQLite.</p>\n\n<p>The purpose of the database is a document store. There are no foreign keys/referential integrity concerns.</p>\n\n<p>E.G.</p>\n\n<pre><code>public class Foo\n{\n   public Bar {get; set;}\n   public Baz {get; set;}\n}\n</code></pre>\n\n<p>Creates the table Foo with the columns Bar, Baz. </p>\n\n<p>In an ideal world the Foo class would never changed so I wouldn't have to worry about this, but in reality it could.</p>\n\n<p>Lets say Foo also needs a Quz property.</p>\n\n<pre><code>public class Foo\n{\n   public Bar {get; set;}\n   public Baz {get; set;}\n   public Quz {get; set;}\n}\n</code></pre>\n\n<p>Reading is fine, Quz just comes back as null, but inserting fails because there is no Quz column. This makes sense.</p>\n\n<p>Lets say that Baz is no longer required.</p>\n\n<pre><code>public class Foo\n{\n   public Bar {get; set;}\n   public Quz {get; set;}\n}\n</code></pre>\n\n<p>Reading/inserting works fine, however the underlying table would still have the Baz column which is a bit messy.</p>\n\n<p>Given that it is a server app, and won't be restarted often, a couple of things I've considered and dismissed:</p>\n\n<ul>\n<li><p>On start, If the Foo table exists, read it in to a temporary store, drop and recreate Foo (meaning that the table would be created with the correct schema) and then reinsert the data. This appears to work fine and does the job of keeping the schema in sync with the class, however it is too slow.</p></li>\n<li><p>On start, query the underlying table to gets its column definitions and use reflection to work out what the columns for the Foo class should actually be. Add/Drop columns as necessary. I'm pretty sure I could get this approach to work, but it's more complicated than ideal, and I'm not convinced it is a good idea.</p></li>\n</ul>\n"},{"tags":["c#","bitmap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13273678,"title":"Store the databits of a bitmap into a int array","body":"<p>In Java i would do something like this</p>\n\n<pre><code>int[] pixels = ((DataBufferInt) image.getRaster().getDataBuffer()).getData();\n</code></pre>\n\n<p>where image is a BufferedImage and then alter the pixels in there and make my own blitting methods but how am i supposed to do something like this in C#? I know i can use a Bitmap to replace BufferedImage in C# but i'm not sure about making a reference to the data like shown above.</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":4,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":1624,"score":6,"question_id":4809520,"title":"How to allow copying message on MessageBox","body":"<p>How can I allow selecting and copying of text from MessageBox in WPF?</p>\n"},{"tags":["c#","url","slash"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13273476,"title":"Get anything after first slash in URL","body":"<p>I can get my browser url using : <code>string url = HttpContext.Current.Request.Url.AbsoluteUri;</code>\nBut say if I have a url as below :</p>\n\n<pre><code>http://www.test.com/MyDirectory/AnotherDir/testpage.aspx\n</code></pre>\n\n<p>How would I get the \"MyDirectory\" part of it, is there a utility in .NET to get this or do I need string manipulation ?</p>\n\n<p>If I do string manipulation and say anything after first instance of \"/\" then wouldnt it return the slash after http:? It would work if my url was <code>www.test.com/MyDirectory/AnotherDir/testpage.aspx</code></p>\n\n<p>Can someone please help</p>\n"},{"tags":["c#",".net","ado.net","edmx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":17,"score":-2,"question_id":13273720,"title":"Edmx Entity model inheritance","body":"<p>I want to create a generic Entity Model, with some classes and logics above, to put into a DLL and reuse that in various projects. I keep in mind the possibility to extend the generic ModelContainer in another in every project and use the extended ModelContainer to access database. I ask you if it is possible to do so in a \"clean way\" or I need some work around or \"bad stuff\".\nThank you all.</p>\n"},{"tags":["c#",".net","asp.net","web-config","settings"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":1684,"score":3,"question_id":6289388,"title":"Custom type application settings in ASP.NET","body":"<p>Just now I came across ApplicationSettings in .NET WinForms that could handle complex types.<br>\nCurrently I am using AppSettings in my ASP.NET WebForms which can handle only string.<br>\nCan I use ApplicationSettings in Webforms? If so how?</p>\n"},{"tags":["c#","ado.net"],"answer_count":7,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":47200,"score":4,"question_id":1042618,"title":"How to create a DataTable in c# and how to add rows?","body":"<p>Can any body please help me creating DataTable in c#. I did like this</p>\n\n<pre><code> DataTable dt = new DataTable();\n dt.clear();\n dt.Columns.Add(\"Name\");\n dt.Columns.Add(\"Marks\");\n</code></pre>\n\n<p>and how to see the structure of DataTable.</p>\n\n<p>Now i want to add for name : ravi and Marks : 500 how to do this one </p>\n\n<p>Any Help will be greatly appreciated!</p>\n"},{"tags":["c#","dependency-injection","ndepend","static-code-analysis"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13197482,"title":"Finding code only used in special classes via NDepend","body":"<p>I am trying to get rid of dead code in our codebase using NDepend. Since we are using dependency injection I want to find interfaces (and the implementations) only used in classes that deriving from the registry base:</p>\n\n<pre><code>public class PresenterRegistry : Registry\n{\n    public PresenterRegistry()\n    {\n        For&lt;IExamplePresenter&gt;().Use&lt;ExamplePresenter&gt;();\n    }\n}\n</code></pre>\n\n<p>Is there any way to do this?</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","ruby","mono","port"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":13246099,"title":"Using C# to reference a port number to service name","body":"<p>On Linux using MONO.</p>\n\n<p>How do I use C# to pair a port number to a service ? </p>\n\n<p>example:</p>\n\n<pre><code>port 80 = http\nport 443 = https\n</code></pre>\n\n<p>and output it to the console, I need this for a simple port scanner I built.</p>\n\n<p>I know this function exists in ruby:</p>\n\n<pre><code>Socket.getservbyport(80, \"tcp\")\n</code></pre>\n"},{"tags":["c#","wpf","datacontext","dataitems"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2220,"score":1,"question_id":2859978,"title":"Populate datagrid using Datacontext in C# WPF","body":"<p>I'm trying to get data from file. The file first has three lines of text that describes the file, then there is a header for the data below. I've managed to extract that. What I'm having problems is getting the data below the header line. The data below the header line can look like \"1   2   3  4  5   6     7   8   9   abc\". </p>\n\n<pre><code>DataGrid dataGrid1 = new DataGrid();\nmasterGrid.Children.Add(dataGrid1);\n\nusing (TextReader tr = new StreamReader(@filename))\n{\n    int lineCount = 1;\n    while (tr.Peek() &gt;= 0)\n    {\n        string line = tr.ReadLine();\n        {\n            string[] data = line.Trim().Split(' ');\n\n            Dictionary&lt;string, object&gt; sensorData = new Dictionary&lt;string, object&gt;();\n\n            for (int i = 0, j = 0; i &lt; data.Length; i++)\n            {\n                //I know that I'm delimiting the data by a space before.\n                //but the data from the text file doesn't necessarily have\n                //just one space between each piece of data\n                //so if I don't do this, spaces will become part of the data.\n                if (String.Compare(data[i],\" \") &gt; 0)\n                {\n                    sensorData[head[j]] = data[i];\n                    j++;\n                }\n            }\n\n            sensorDatas.Add(sensorData);\n\n            sensorData = null;\n\n        }\n        lineCount++;\n    }\n}\n\ndataGrid1.DataContext = sensorDatas;\n</code></pre>\n\n<p>I can't figure out why this doens't work. If I change \"dataGrid1.DataContext = sensorDatas;\" to \"dataGrid1.ItemsSource = sensorDatas;\" then I get the data in the proper columns, but I also get some Raw View data such as: Comparer, Count, Keys, Values as columns, which I don't want.</p>\n\n<p>Any insight?</p>\n"},{"tags":["c#",".net","image","web","download"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13273697,"title":"How do I download pictures from a webpage based on their LINKS on this page?","body":"<p>This is what I have so far but I'm running into an issue.</p>\n\n<p>The page <a href=\"https://xxxxxxxx.zendesk.com/tickets/33126\" rel=\"nofollow\">https://xxxxxxxx.zendesk.com/tickets/33126</a> contains a link to a .jpg image. I want to download this image. The page could have several images so I need to scan the page to find all the .jpg, .gif, etc.</p>\n\n<pre><code>I'm having an issue with my code at the end. I'll explain there.\n\n    public static void GetTicketAttachments(string url)\n    {   \n        GetImages(\"https://xxxxxxxx.zendesk.com/tickets/33126\");   \n    }\n\nstatic void GetImages(string url)\n    {\n        string responseString;\n        HttpWebRequest initialRequest = (HttpWebRequest)WebRequest.Create(url);\n        using (HttpWebResponse initialResponse = (HttpWebResponse)initialRequest.GetResponse())\n        {\n            using (StreamReader reader = new StreamReader(initialResponse.GetResponseStream()))\n            {\n                responseString = reader.ReadToEnd();\n            }\n\n            List&lt;string&gt; imageset = new List&lt;string&gt;();\n            Regex regex = new Regex(@\"f=\"\"[^\"\"]*jpg|bmp|tif|gif|png\", RegexOptions.IgnoreCase);\n            foreach (Match m in regex.Matches(responseString))\n            {\n                if (!imageset.Contains(m.Value))\n                    imageset.Add(m.Value);\n            }\n            for (int i = 0; i &lt; imageset.Count; i++)\n                imageset[i] = imageset[i].Remove(0, 3);\n            totalFiles = imageset.Count;\n            currentFiles = totalFiles;\n\n            foreach (string f in imageset)\n            {\n                ThreadPool.QueueUserWorkItem(new WaitCallback(DownloadImage), f);\n            }\n        }\n    }\n</code></pre>\n\n<p>The issue happens here. The object \"path\" is always null for some reason. Therefore I cannot download the picture.</p>\n\n<pre><code>static void DownloadImage(object path)\n    {\n        currentFiles--;\n        path = Path.GetFileName(path.ToString());\n        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(path.ToString());\n        using (HttpWebResponse response = (HttpWebResponse)request.GetResponse())\n        {\n            Image image = Image.FromStream(response.GetResponseStream());\n            image.Save(@\"C:\\\" + Path.GetFileName(path.ToString()));\n        }\n    }\n</code></pre>\n\n<p>Anyone know what could be the issue? The \"picture count\" is indeed counting 1 (one link TO a picture on the page). </p>\n"},{"tags":["c#","winapi","modal","outlook-2007","inspector"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":753,"score":3,"question_id":5784237,"title":"How to : Given HWND, discover if window is Modal or not","body":"<p>For any given window I handle, I need a way to find out whether or not the given window is Modal.</p>\n\n<p>Far as I can tell, there are no methods that do exactly that, which is why I need some clever workaround to work this out!</p>\n\n<p>Help is appreciated!</p>\n\n<p>EDIT : Why is my GetWindow(,GW_OWNER) failing? :(</p>\n\n<pre><code>    [DllImport(\"user32.dll\", SetLastError = true, CharSet = CharSet.Auto)]\n    internal static extern IntPtr FindWindow(string lpClassName, string lpWindowName);\n    [DllImport(\"user32.dll\", SetLastError = true)]\n    internal static extern IntPtr GetWindow(IntPtr hWnd, GetWindow_Cmd uCmd);\n    [DllImport(\"user32.dll\", ExactSpelling = true)]\n    internal static extern IntPtr GetAncestor(IntPtr hwnd, GetAncestor_Flags gaFlags);\n    [DllImport(\"user32.dll\", SetLastError = false)]\n    internal static extern IntPtr GetDesktopWindow();\n    [DllImport(\"user32.dll\", SetLastError = true)]\n    internal static extern int GetWindowLong(IntPtr hWnd, int nIndex);\n\n    const UInt32 WS_DISABLED = 0x8000000;\n\n\n    internal enum GetAncestor_Flags\n    {\n        GetParent = 1,\n        GetRoot = 2,\n        GetRootOwner = 3\n    }\n\n    internal enum GetWindow_Cmd : uint\n    {\n        GW_HWNDFIRST = 0,\n        GW_HWNDLAST = 1,\n        GW_HWNDNEXT = 2,\n        GW_HWNDPREV = 3,\n        GW_OWNER = 4,\n        GW_CHILD = 5,\n        GW_ENABLEDPOPUP = 6\n    }\n\n\n\nIntPtr _inspHwnd = FindWindow(\"rctrl_renwnd32\", inspector.Caption); // searching for a window with this name\n        if (_inspHwnd.ToInt32() != 0) // found window with this name\n        {\n            IntPtr _ownerHwnd = GetWindow(_inspHwnd, GetWindow_Cmd.GW_OWNER);\n            if (_ownerHwnd.ToInt32() != 0)\n            {\n                IntPtr _ancestorHwnd = GetAncestor(_ownerHwnd, GetAncestor_Flags.GetParent);\n                if (_ancestorHwnd == GetDesktopWindow())\n                {\n                    if (GetWindowLong(_ancestorHwnd, -16) == WS_DISABLED) \n                    { \n                        // inspector is probably modal if you got all the way here\n                        MessageBox.Show(\"modal flag tripped\");\n                    }\n                }\n            }\n        }\n</code></pre>\n"},{"tags":["c#","asp.net",".net","vb.net","usercontrols"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13249082,"title":"When does usercontrol visible property affect its children?","body":"<p>I have a <strong>ASP.NET userControl</strong> that contains other controls. \nSometimes, when changing the visible property of the usercontrol, it does change the visible value of its children, but sometimes it doesn't. </p>\n\n<p>I thought it depended on the moment the property was changed during the page life cycle, cause it seemed to work well when changed in the <code>Page_PreRender</code> event, but I got a case when it didn't work.</p>\n\n<p>Any idea, on how I could affect the visibility of all the controls of the user control just through the visible property of this one? I don't want to make a loop through all the children to set their visbile property.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","webbrowser","ftpwebrequest"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":19,"score":3,"question_id":13270303,"title":"C# webbrowser not showing updated result","body":"<p>Hey guys i am having trouble with webbrowser or may be ftp .. i am uploading a picture and when i navigate the webbrowser it shows me the old photo, yet the picture im uploading gets to the ftp and gets overwrite .. heres the code</p>\n\n<pre><code> webBrowser1.Refresh(WebBrowserRefreshOption.Completely);\n        webBrowser1.Navigate(\"www.google.com\");\n        openFileDialog1.ShowDialog();\n        string filename = Path.GetFullPath(openFileDialog1.FileName);\n\n        FileInfo toUpload = new FileInfo(@\"upload.jpg\");\n        FtpWebRequest request = (FtpWebRequest)WebRequest.Create(\"ftp://fingercube.co.cc/public_html/objimg/\" + toUpload.Name);\n        request.Method = WebRequestMethods.Ftp.UploadFile;\n        request.Credentials = new NetworkCredential(\"username\", \"pass\");\n        Stream ftpStream = request.GetRequestStream();\n        FileStream file = File.OpenRead(filename);\n        int lenght = 2;\n        byte[] buffer = new byte[lenght];\n        int bytesRead = 0;\n        do\n        {\n            bytesRead = file.Read(buffer, 0, lenght);\n            ftpStream.Write(buffer, 0, bytesRead);\n        }\n\n        while (bytesRead != 0);\n        file.Close();\n        ftpStream.Close();\n\n\n       webBrowser1.Navigate(\"http://fingercube.co.cc/objimg/\"+toUpload.Name);\n</code></pre>\n\n<p>it shows me the old photo everytime .. but the photo is uploaded every time ! :(</p>\n"},{"tags":["c#",".net","vb.net"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13273601,"title":"Right Data Structure for Cascading Controls","body":"<p>Suppose I had a series of tables in a database with (for example purposes) information about the menu items in a series of restaurants. \nSo, for example, we have, say 10 tables:</p>\n\n<pre><code>Rest_1, Rest_2, Rest_3, .... Rest_10 \n(Names being more complex, though, in the real situation)\n</code></pre>\n\n<p>And every table has the EXACT SAME column structure, say (Just making this up for illustration purposes, so forgive the weakness of the example):</p>\n\n<pre><code>Col1 (Primary Key) = Menu_Item\nCol2               = Menu_Category  (Desert, Appetizer, ...)\nCol3               = Item_Cost\nCol4               = Item_SalePrice\nCol5               = Item_Popularity\nCol6               = Seasonal_Item  (Boolean - Is it seasonal)\nCol7               = Min_Order      (Boolean - Is there a minimum order from the vendor)  \nCol8               = In_Stock       (Boolean - Is it in stock now)  \n....\n</code></pre>\n\n<p>Now, I have a Windows Form with, say, 3 comboBoxes and a checkbox:</p>\n\n<pre><code>cboRestaurant\ncboMenuCategory\ncboPopularity\nckInStock\n</code></pre>\n\n<p>And a DataView which, based upon what the user chooses above, shows the correct (filtered) information which can then be used for processing something.</p>\n\n<p>So, my situation is that we would:</p>\n\n<ol>\n<li>Populate the Restaurant combobox</li>\n<li>Based upon the user's selection of cboRestaurant &amp; the ckInStock.checked status, populate the cboMenuCategory combobox</li>\n<li>Based upon 1 &amp; 2, populate the cboPopularity combobox</li>\n<li>Based upon what user chose for all the comboboxes / checkbox, populate the dataview.</li>\n</ol>\n\n<p>... Again, I know this is a weak example, but I'm trying to convey the concept.</p>\n\n<hr>\n\n<p>So... Based upon what I've picked up online, what I'm seeing as being the best case to accomplish this would be to:</p>\n\n<ol>\n<li>Query each Table and store the results in a DataTable  (This I can do)</li>\n<li>Store those datatables in a Dataset                    (This I can do)</li>\n</ol>\n\n<p>What I don't know how to do is to let the dataset know how all the datatables are related (All have the same column names) <strong>AND</strong> bind the comboboxes to the dataset such as to filter the information based upon what was selected in the previous combobox.</p>\n\n<h2>OR</h2>\n\n<p>Create a list(of custom object) that will hold all these variables from all the tables and then Linq-Query that list based upon the <code>combobox.SelectedIndexChanged</code> \\ <code>ckInStock.CheckedChanged</code> events - this seems much worse since we're constantly querying and re-querying.</p>\n\n<hr>\n\n<h2>So, my first question is:</h2>\n\n<p>If solution #1 is right, how do I create the conglomerated dataset and have the comboboxes have the correct filtered data based upon the preceding comboboxes and checkbox value?</p>\n\n<h2>My Second question is:</h2>\n\n<p>Is there just a better way to accomplish this IN TOTAL that I just don't know about - A built in better object that does the cascading filtering for you, or how best to accomlish this otherwise?</p>\n"},{"tags":["c#",".net","encoding","character-encoding","special-characters"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13272149,"title":"Encoding special characters into Byte array","body":"<p>Few days ago I've asked a question about german special characters.\nI can encode and decode characters like ö, ä or ü now. But.. some characters left and I need to encode/decode them too. </p>\n\n<p>For example, characters that fails: ² ³ € µ Ü Ö Ä ~ ´ §</p>\n\n<p>Here is code: </p>\n\n<pre><code>    private static byte[] MyGetBytesArray(string data)\n    {\n        Encoding enc = new UTF8Encoding(true, true);\n        return enc.GetBytes(data);\n    }\n\n    private static string MyGetString(byte[] data)\n    {\n        Encoding enc = new UTF8Encoding(true, true);\n        return enc.GetString(data);\n    }\n</code></pre>\n\n<p>I'm looking for a solution to encode/decode all characters. I'm writing an encrypt/decrypt algorythm, and I don't know what user will paste into program. I need to give back exactly the same. </p>\n\n<p>Thanks for help, again.. </p>\n\n<p>EDIT:\nOk, UnicodeEncoding works (I think). It is my encrypt/decrypt algoryth now:/ I'm still not sure what is going on (I thnik it is sth with zeros. During encoding by Unicode zero is after every character), but encoding special characters wokrs. At least that test was successfull: </p>\n\n<pre><code>string text = File.ReadAllText(opd.FileName, Encoding.Default);\nbyte[] byt = getBytesArray(text);\nstring text2 = getString(byt);\n\nif (text2 == text)\n{\n    MessageBox.Show(\"OK\");\n}\nelse\n{\n    MessageBox.Show(\"FAIL\");\n}\n</code></pre>\n\n<p>BTW. Encoding.Default is correct right ? </p>\n"},{"tags":["c#","sql","vb.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":13095357,"title":"VS 2010 SQL Update for SQL Statement","body":"<p>Please bear with me as I'm just beginning to learn this stuff. </p>\n\n<p>I have a VS 2010 Web project up and I'm trying to understand how I can make a custom <code>UpdateCommand</code> (Because I chose to write my own SQL statement, I do not have the option for VS 2010 to auto generate an update command for me.) Problem is: I don't know what the <code>UpdateCommand</code> should look like. Here is my Select:</p>\n\n<pre><code>SELECT * FROM Dbo.MainAsset, dbo.Model, dbo.Hardware WHERE MainAsset.device = Hardware.DeviceID AND MainAsset.model = Model.DeviceID\n</code></pre>\n\n<p>Which, VS 2010 turns into:</p>\n\n<pre><code>SELECT MainAsset.pk, MainAsset.img, MainAsset.device, MainAsset.model, MainAsset.os, MainAsset.asset, MainAsset.serial, MainAsset.inyear, MainAsset.expyear, MainAsset.site, MainAsset.room, MainAsset.teacher, MainAsset.FirstName, MainAsset.LastName, MainAsset.Notes, MainAsset.Dept, MainAsset.AccountingCode, Model.Model AS Hardware, Model.pk AS Model, Model.DeviceID, Hardware.Computer, Hardware.pk AS Expr3, Hardware.DeviceID AS Expr4 FROM MainAsset INNER JOIN Hardware ON MainAsset.device = Hardware.DeviceID INNER JOIN Model ON MainAsset.model = Model.DeviceID\n</code></pre>\n\n<p>How would I approach updating one column, say \"MainAsset.site\" if that's changed in the Gridview DDL? Any help constructive help would be appreciated. Thank you.</p>\n"},{"tags":["c#",".net","sql-server","stream"],"answer_count":4,"favorite_count":38,"up_vote_count":123,"down_vote_count":0,"view_count":106681,"score":123,"question_id":411592,"title":"How do I save a stream to a file?","body":"<p>I have a <code>StreamReader</code> object that I initialized with a stream, now I want to save this stream to disk (the stream may be a <code>.gif</code> or <code>.jpg</code> or <code>.pdf</code>).</p>\n\n<p>Existing Code:</p>\n\n<pre><code>StreamReader sr = new StreamReader(myOtherObject.InputStream);\n</code></pre>\n\n<ol>\n<li>I need to save this to disk (I have the filename).</li>\n<li>In the future I may want to store this to SQL Server.</li>\n</ol>\n\n<p>I have the encoding type also, which I will need if I store it to SQL Server, correct?</p>\n"},{"tags":["c#","wpf","pages"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13268597,"title":"Ispost back like functionality in WPF pages","body":"<p>I am building a WPF application which contains a large number of pages. I want to know whether there is any function which is similar to IsPostBack in Asp.Net. I just wanted to know is this the first time the specific page is loading. Thanks in advance.</p>\n"},{"tags":["c#","asp.net-mvc-3","dynamic","razor","viewmodel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13272873,"title":"How to create dynamic DropDownList with several complex types? ASP.NET MVC 3","body":"<p>guys. I have these ViewModels:</p>\n\n<pre><code>public class CandidateViewModel\n{\n    public string Name { get; set; }\n    public IList&lt;CourseViewModel&gt; Courses { get; set; }\n    //...\n}\n\npublic class OptionViewModel\n{\n    public int Number { get; set; }\n    public string Description { get; set; }\n    //...\n}\n\npublic class CourseViewModel\n{\n    public string Name { get; set; }\n    public string SelectedCourse { get; set; }\n    public IList&lt;OptionViewModel&gt; Options { get; set; }\n\n    public CourseViewModel(int options)\n    {\n        Options.Add(new OptionViewModel(-1, string.Empty));\n        for (int count = 1; count &lt;= options; ++count)\n            Options.Add(new OptionViewModel(\n                count, string.Format(\"Option {0}\", count)));\n\n        Options.Add(new OptionViewModel(0, \"Don't want it\"));\n    }\n}\n</code></pre>\n\n<p>Well, I want to create a number of DropDownLists equals the number of Courses into CandidateViewModel. Each dropdown should be as options the OptionViewModel list of CourseViewModel instance. I need my final result like this:</p>\n\n<pre><code>&lt;select name=\"Course1\"&gt;\n    &lt;option value=\"-1\"&gt;&lt;/option&gt;\n    &lt;option value=\"1\"&gt;Option 1&lt;/option&gt;\n    &lt;option value=\"2\"&gt;Option 2&lt;/option&gt;\n    &lt;option value=\"3\"&gt;Option 3&lt;/option&gt;\n    &lt;option value=\"0\"&gt;Don't want it&lt;/option&gt;\n&lt;/select&gt;\n\n&lt;select name=\"Course2\"&gt;\n    &lt;option value=\"-1\"&gt;&lt;/option&gt;\n    &lt;option value=\"1\"&gt;Option 1&lt;/option&gt;\n    &lt;option value=\"2\"&gt;Option 2&lt;/option&gt;\n    &lt;option value=\"3\"&gt;Option 3&lt;/option&gt;\n    &lt;option value=\"0\"&gt;Don't want it&lt;/option&gt;\n&lt;/select&gt;\n</code></pre>\n\n<p>However, my .cshtml page has CandidateViewModel as Model, and I can't create by \"Html.DropDownListFor\" trhu Razor. Can you help me, please?</p>\n\n<p>Thank you so much, guys!</p>\n"},{"tags":["c#","app-config","configurationelement"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13272418,"title":"overriding/replacing ConfigurationElements in app.config in runtime","body":"<p>I have two ConfigurationElement objects (one of which is in the running application's app.config) and I need to replace that one with the other. I also have the ConfigurationElementCollection that the first element belongs to. It looks like the Add and Remove methods are protected internal. Is it not intended for me to be able to update the ConfigurationElementCollection object in runtime? If so, what are the alternatives?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","pcap.net"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13272565,"title":"Split packet into 2 packets with pcapdotnet","body":"<p>How can I split a packet into two packets using pcapdotnet? This is what I tried, but I don't know whether it's correct:</p>\n\n<pre><code>    public IEnumerable&lt;Packet&gt; splitPacket(Packet packet)\n    {\n        EthernetLayer ethernet = (EthernetLayer)packet.Ethernet.ExtractLayer();\n        IpV4Layer ipV4Layer = (IpV4Layer)packet.Ethernet.IpV4.ExtractLayer();\n        DateTime packetTimestamp = packet.Timestamp;\n        ILayer payload = packet.Ethernet.IpV4.Payload.ExtractLayer();\n        IpV4Fragmentation.Equals(packet, packet);\n\n        yield return PacketBuilder.Build(packetTimestamp, ethernet, ipV4Layer, payload);\n    }\n</code></pre>\n"},{"tags":["c#","build","const","pre-buildevent"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13273617,"title":"Computed const value constantly one build behind","body":"<p>While updating our build incrementer program that runs during the <strong>pre-build</strong> event, I noticed a potential problem that can cause quite a bit of issues. Building the application the first time successfully updates <code>BuildInfo.cs</code> and calculates all of the const values. Each subsequent build and successful execution of the pre-build event updates the proper file (as provided below) but each computed const value is out of date from the last build.</p>\n\n<pre><code>// In externally modified file BuildInfo.cs which is updated by our pre-build\n// tool to update the version information and produce new consts.\nnamespace ConstProblem.Properties {\n  static class BuildInfo {\n    internal const string AssemblyVersionString = \"1.1.0.0\";\n    internal const string BuildDate = \"2012-11-07T08:52:32.5480259-07:00\";\n    internal const string FileVersionString = \"1.1.12312.852\";\n    internal const string Full = \"v1.1 (Build: 2012-11-07 08:52)\";\n    internal const string Short = \"1.1\";\n  }\n}\n\n// Program.cs. Reproduces the problem for this question.\nnamespace ConstProblem {\n  class Program {\n    const string UserAgent = \"ConstProblem/\" + Properties.BuildInfo.Short;\n\n    static void Main() {\n      System.Console.WriteLine(UserAgent);\n    }\n  }\n}\n</code></pre>\n\n<p>As an example, the application was originally built with the <code>AssemblyVersionString</code> at <code>1.0.0.0</code>. The above program ran and compiled as expected. Increasing this to 1.1 and building/running the application a second time produced <code>ConstProblem/1.0</code> as it's output and has this as it's values</p>\n\n<pre><code>// From the Immediate Window\nProperties.BuildInfo\nConstProblem.Properties.BuildInfo\n    base {object}: object\n    AssemblyVersionString: \"1.1.0.0\"\n    BuildDate: \"2012-11-07T08:51:46.8404556-07:00\"\n    FileVersionString: \"1.0.12312.851\"\n    Full: \"v1.0 (Build: 2012-11-07 08:51)\"\n    Short: \"1.0\"\n</code></pre>\n\n<p>As you can see, the <code>AssemblyVersionString</code> was updated <code>1.1.0.0</code> properly but the rest of the computed values did not. If I were to build and execute a third time (and increase to 1.2) they would update to the information provided above.</p>\n\n<p>I have confirmed that the output file by the pre-build event outputs all of the information correctly and exits with a status of 0 to allow the build to continue. I am at a loss as to why the const's are constantly one build behind. The build utility is also something I wrote and it just uses a template and replaces the contents of the BuildInfo.cs if the file is checked-out.</p>\n\n<p>My environment is running Visual Studio 2010 Ultimate and compiling in .Net 4. I've reproduced this in both Console and Web applications. I got the idea for using const values from the comments in <a href=\"http://blogs.msdn.com/b/junfeng/archive/2004/02/28/81407.aspx\" rel=\"nofollow\" title=\"How to get the assembly version and file version of your own assembly? -Junfeng Zhang\">How to get the assembly version and file version of your own assembly?</a></p>\n"},{"tags":["c#","hierarchy"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13271634,"title":"Hierarchy from Flat Data w/ out parentID childID","body":"<pre><code>| Level1      | Level2               | Level3       | Level4|\n\n| ELECTRONICS | TELEVISIONS          | NULL         | NULL  |\n\n| ELECTRONICS | TELEVISIONS          | LCD          | NULL  |\n\n| ELECTRONICS | PC                   | NULL         | NULL  |\n\n| ELECTRONICS | PORTABLE ELECTRONICS | MP3 PLAYERS  | FLASH |\n\n| ELECTRONICS | PORTABLE ELECTRONICS | CD PLAYERS   | NULL  |\n\n| ELECTRONICS | PORTABLE ELECTRONICS | 2 WAY RADIOS | NULL  |\n</code></pre>\n\n<p>In a legacy database I have this table, I am trying to print it out in a nice hierarchy html ul li list. I have been trying different answers here on stackoverflow to build the objects in C# but they all have parentID and childID and that dosent work for me in this case.</p>\n\n<p>I am trying this code, but I do understand that it is really bad,</p>\n\n<pre><code>    List&lt;Node&gt; FlatToHierarchy(IList&lt;SearchWord&gt; list)\n    {\n        List&lt;Node&gt; nodes = new List&lt;Node&gt;();\n\n        foreach (SearchWord x in list)\n        {\n            if (x.Level2 != \" \" &amp;&amp; x.Level3 == \" \")\n            {\n                Node node = new Node();\n                node.Parent = x.Level1;\n                node.Child = x.Level2;\n                node.Keyword = x.Keyword;\n                nodes.Add(node);\n                //dict.Add(node.Parent, node);\n            }\n\n            if (x.Level3 != \" \" &amp;&amp; x.Level4 == \" \")\n            {\n                Node node = new Node();\n                node.Parent = x.Level2;\n                node.Child = x.Level3;\n                node.Keyword = x.Keyword;\n                nodes.Add(node);\n                //dict.Add(node.Parent, node);\n            }\n\n            if (x.Level4 != \" \")\n            {\n                Node node = new Node();\n                node.Parent = x.Level3;\n                node.Child = x.Level4;\n                node.Keyword = x.Keyword;\n                nodes.Add(node);\n                //dict.Add(node.Parent, node);\n            }\n        }\n\n        return nodes;\n    }\n</code></pre>\n"},{"tags":["c#","asp.net-mvc","validation"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13057682,"title":"Custom validation class - How to make universal","body":"<p>I am attempting to create a custom validation attribute for my MVC application.  My code as written, works great for the properties specified in the code.  I now want to expand it, so it  is more general, because I have 5 other properties I would like to use this same attribute on.<br>\nThe general idea is if the specified other property is true, then the property attached to the attribute must be > 0.</p>\n\n<p>I assume the way to do this is to create a constructor that accepts the value of the property and the value of the other property, but I can't seem to get it going.  The specific problem I having is I can't find the correct way to pull in the needed values.</p>\n\n<p>Here is what I have:</p>\n\n<pre><code>public class MustBeGreaterIfTrueAttribute : ValidationAttribute\n{\n    protected override ValidationResult IsValid(object value, ValidationContext context)\n    {\n        var model = context.ObjectInstance as HistoryViewModel;\n        //ValidationResult result = null;\n\n        // Validate to ensure the model is the correct one\n        if (context.ObjectInstance.GetType().Name == null)\n        {\n            throw new InvalidOperationException(string.Format(\n                    CultureInfo.InvariantCulture, \"Context of type {0} is not supported. \"\n                                                  + \"Expected type HistoryViewModel\",\n                                                   context.ObjectInstance.GetType().Name));\n        }\n\n        // Here is the actual custom rule\n        if (model.HistoryModel.IsRetired == true)\n        {\n            if (model.CounterA == 0)\n            {\n                return new ValidationResult(\"Please enter more information regarding your History\");\n            }\n        }\n        else if ( model.HistoryModel.IsRetired == true )\n        {\n            if ( model.ROCounter &gt; 0 )\n\n            return ValidationResult.Success;\n        }\n\n        // If all is ok, return successful.\n        return ValidationResult.Success;\n\n    }\n\n    //  Add the client side unobtrusive 'data-val' attributes\n    //public IEnumerable&lt;ModelClientValidationRule&gt; GetClientValidationRules(ModelMetadata metadata, ControllerContext context)\n    //{\n\n    //}\n\n}\n</code></pre>\n\n<p>Thank you for you time.</p>\n"},{"tags":["c#","asp.net"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13273475,"title":"Is there automatic formatting for an asp:literal control?","body":"<p>Is there a way to automatically format a <code>string</code> for literal insertion into JavaScript code?</p>\n\n<p>Say you have this in your page:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;script type=\"text/javascript\"&gt;\n    var strvar = &lt;asp:Literal runat=\"server\" id=\"ltrStrvar\"&gt;&lt;/asp:Literal&gt;;\n&lt;/script&gt;\n</code></pre>\n\n<p>And in your server-side code:</p>\n\n<pre class=\"lang-csharp prettyprint-override\"><code>protected void Page_Load(object sender, EventArgs e) {\n    ltrStrvar.Text = \"hello \\\"world\\\"\";\n}\n</code></pre>\n\n<p>Is there a way to <em>automatically</em> have it escape the string and surround it with quotes for error-free insertion into JavaScript, so all I have to do is set the <code>Text</code> property with an arbitrary string? I know how to do it <em>manually</em> but was looking for a more elegant solution.</p>\n"},{"tags":["c#","windows","service","installer"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13273565,"title":"ServiceAccount.User multiple windows services installer","body":"<p>I have a basic windows installer for multiple services (C#). I am using user authentication. \nThe username/password is prompted for each service that is being installed. I need to limit this to one prompt?</p>\n\n<p>In one of my services I am doing the following:</p>\n\n<pre><code>private void serviceProcessInstaller1_BeforeInstall(object sender, InstallEventArgs e)\n{\n    this.serviceProcessInstaller1.Account = ServiceAccount.User;\n    GetServiceAccount(ref serviceProcessInstaller1);\n}\n\npublic static void GetServiceAccount(ref ServiceProcessInstaller installer)\n{\n    ServiceInstallerDialog myInstaller = new ServiceInstallerDialog();\n\n    myInstaller.ShowDialog();\n\n\n    if (myInstaller.Result == ServiceInstallerDialogResult.OK)\n    {\n        installer.Account = ServiceAccount.User;\n        installer.Username = myInstaller.Username;\n        installer.Password = myInstaller.Password;\n    }\n}\n</code></pre>\n\n<p>This takes care of one service how can I pass these parameters to the\nother services in my installer?</p>\n"},{"tags":["c#","c#-4.0","quartz.net","quartz.net-2.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13264115,"title":"How ignore Misfires in Quartz.Net?","body":"<p>This is my Quartz configuration:</p>\n\n<pre><code>  &lt;quartz&gt;\n    &lt;add key=\"quartz.scheduler.instanceName\" value=\"EmailScheduler\" /&gt;\n    &lt;!-- Configure Thread Pool --&gt;\n    &lt;add key=\"quartz.threadPool.type\" value=\"Quartz.Simpl.SimpleThreadPool, Quartz\" /&gt;\n    &lt;add key=\"quartz.threadPool.threadCount\" value=\"10\" /&gt;\n    &lt;add key=\"quartz.threadPool.threadPriority\" value=\"Normal\" /&gt;\n    &lt;!-- Configure Job Store --&gt;\n    &lt;add key=\"quartz.jobStore.misfireThreshold\" value=\"60000\" /&gt;\n    &lt;add key=\"quartz.jobStore.type\" value=\"Quartz.Impl.AdoJobStore.JobStoreTX, Quartz\" /&gt;\n    &lt;add key=\"quartz.jobStore.driverDelegateType\" value=\"Quartz.Impl.AdoJobStore.StdAdoDelegate, Quartz\" /&gt;\n    &lt;add key=\"quartz.jobStore.dataSource\" value=\"default\" /&gt;\n    &lt;add key=\"quartz.jobStore.lockHandler.type\" value=\"Quartz.Impl.AdoJobStore.UpdateLockRowSemaphore, Quartz\" /&gt;\n    &lt;add key=\"quartz.dataSource.default.provider\" value=\"SqlServer-20\" /&gt;\n    &lt;add key=\"quartz.dataSource.default.connectionString\" value=\"data source= ......\" /&gt;\n    &lt;add key=\"quartz.jobStore.tablePrefix\" value=\"QRTZ_\" /&gt;\n  &lt;/quartz&gt;\n</code></pre>\n\n<p>here is my <code>IInterruptableJob</code>:</p>\n\n<pre><code>public class JobC : Quartz.IInterruptableJob\n{\n    public void Interrupt()\n    {\n        Console.WriteLine(\"Job Interrupt() called at \" + DateTime.Now);\n    }\n\n    public void Execute(IJobExecutionContext context)\n    {\n        // what code i should write here to detect misfires???\n        Console.WriteLine(\"FireTime at \" + context.FireTimeUtc.Value + \" PreviousFireTime at:\" + (context.PreviousFireTimeUtc.HasValue ? context.PreviousFireTimeUtc.Value.ToString() : \"NULL\"));\n    }\n}\n</code></pre>\n\n<p>Here is my job and trigger:</p>\n\n<pre><code>var job = JobBuilder.Create&lt;JobC&gt;().WithIdentity(new JobKey(\"JobC\")).RequestRecovery(true).Build();\nvar trigger = TriggerBuilder.Create()\n    .WithSimpleSchedule(x =&gt; x\n        .RepeatForever()\n        .WithIntervalInSeconds(2)\n            // I'm ignoring misfires here, but seems it not works!\n        .WithMisfireHandlingInstructionIgnoreMisfires())\n    .StartNow()\n    .Build();\n\nvar scheduler = new Quartz.Impl.StdSchedulerFactory().GetScheduler();\nscheduler.Start();\nscheduler.ScheduleJob(job, trigger);\n</code></pre>\n\n<p>After i call <code>scheduler.PauseAll()</code> all jobs pause and after calling <code>scheduler.ResumeAll()</code> all missed fires, gets fires! but i want to ignore them and just continue by now.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","asp.net","vb.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13273416,"title":"How to get windows username","body":"<p>I am trying to get the windows username on an aspx page.</p>\n\n<p>I have tried the following:</p>\n\n<pre><code>&lt;% System.Threading.Thread.CurrentPrincipal = new System.Security.Principal.WindowsPrincipal(System.Security.Principal.WindowsIdentity.GetCurrent()) %&gt;\n&lt;%= System.Threading.Thread.CurrentPrincipal.Identity.Name %&gt;\n</code></pre>\n\n<p>But all that does is give me <em>IIS APPPOOL/SBalance</em>  - which is not the windows username!</p>\n\n<p>However if I add the following server control:\n     \nthis does successfully pre-populate with my domain and username.</p>\n\n<p>So how can I get the domain/username as a string on the aspx page without using a login control?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","camera"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":29,"score":-3,"question_id":13239061,"title":"Camera Snapshot in net framework 2.0","body":"<p>Hi how can i snapshot an image from my web camera am using net2.0 c#\nwithout showing the dialog of selecting a camera.\nso basic ->\nHow can i select the default camera then get an snapshot image\ni have tried wia but i can not make it select the default camera and\ntake the snapshot.</p>\n\n<p>I wish my application to work from xp to windows 8</p>\n"},{"tags":["c#",".net"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13272091,"title":"Transfer Cookie from WebBrowser to Webrequest","body":"<p>I get the cookies from InternetGetCookieEx and then pass it to WebRequest however this won't work for Hotmail. The result is </p>\n\n<blockquote>\n  <p><strong>Cookies must be allowed</strong>  Your browser is currently set to block cookies. Your browser must allow cookies before you can use Windows\n  Live ID.</p>\n</blockquote>\n\n<pre><code>[DllImport(\"wininet.dll\", CharSet = CharSet.Auto, SetLastError = true)]\nstatic extern bool InternetGetCookieEx(string pchURL, string pchCookieName, StringBuilder pchCookieData, ref uint pcchCookieData, int dwFlags, IntPtr lpReserved);\nconst int INTERNET_COOKIE_HTTPONLY = 0x00002000;\n\npublic static string GetGlobalCookies(string uri)\n{\n    uint datasize = 1024;\n    StringBuilder cookieData = new StringBuilder((int)datasize);\n    if (InternetGetCookieEx(uri, null, cookieData, ref datasize, INTERNET_COOKIE_HTTPONLY, IntPtr.Zero)\n        &amp;&amp; cookieData.Length &gt; 0)\n    {\n        return cookieData.ToString().Replace(';', ',');\n    }\n    else\n    {\n        return null;\n    }\n}\n\nhttpWebRequest.CookieContainer.SetCookies(\n    webBrowser.Document.Url, \n    GetGlobalCookies(webBrowser.Document.Url.AbsoluteUri)\n    );\n</code></pre>\n"},{"tags":["c#","java","android"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":84,"score":0,"question_id":13262539,"title":"How to achieve following c# behaviour in java (Android)","body":"<p>when i was programming in c# i was making very often use of events. Now I would like to achieve something similar in Java. I know both languages are diffrent and there are some diffrences in implementing such mechanism. Well to give better picture maybe i will describe a little what i want to get, because i might confuse some of terminology:</p>\n\n<p><strong>MyClass</strong> contains code that handles launching <strong>MyEvent</strong> and some code that in certain situations launches that event. </p>\n\n<p><strong>MyEventArgs</strong> is class that transports data from <strong>MyClass</strong> and is sent along with event launch, so function that handles <strong>MyEvent</strong> has some additional information about state of <strong>MyClass</strong> instance.</p>\n\n<p>And there is <strong>MyApp</strong> class that in main method contains instance of <strong>MyClass</strong> and code handling <strong>MyEvent</strong> and when event is raised inside <strong>MyClass</strong> certain actions are performed in code that listens to <strong>MyEvent</strong>.</p>\n\n<p>If it's still unclear, what i mean to achieve is exactly like c# mechanism that is behind button click, just instead of button there is my class, there are my event arguments instead of mouse event args and there is behaviour designed by me instead of click.</p>\n\n<p>I've tried to google some answers to my problem and for example i found sites like:</p>\n\n<p><a href=\"http://javarevisited.blogspot.com/2011/12/observer-design-pattern-java-example.html\" rel=\"nofollow\">http://javarevisited.blogspot.com/2011/12/observer-design-pattern-java-example.html</a> <a href=\"http://www.javaworld.com/javaworld/javaqa/2002-03/01-qa-0315-happyevent.html\" rel=\"nofollow\">http://www.javaworld.com/javaworld/javaqa/2002-03/01-qa-0315-happyevent.html</a>   </p>\n\n<p>And either im just lost and I'm looking in bad places/using bad keywords, or what more possible i can't understand anything out of these examples/i can't transform them to work in way I need.</p>\n\n<p>What im asking for, is some example, or atleast some draft of code handling such mechanism with use of <strong>MyClass,</strong>  <strong>MyEvent,</strong>  <strong>MyEventArgs,</strong> names, pointing code i should use in my class to raise event and some sample use of class and handling of event in Main method, so it would help me wrap my mind around this problem.</p>\n\n<p><strong>==========Edit========</strong></p>\n\n<p>Maybe there are some things like that avaliable for android developers? As my goal is to get to get into mobile apps development after i dust off java.</p>\n\n<p><strong>==========Edit========</strong></p>\n\n<p>If anyone still interested, here is some sample code, it doesn't use names i metioned, just shows in general what im looking for:</p>\n\n<p>And is there no exact solution, maybe somone would suggest something similar to thing im looking for?</p>\n\n<p><strong>frmTest.cs</strong></p>\n\n<pre><code>namespace SampleApp\n{\n    public partial class frmTest : Form\n    {\n        CountdownTimer ctmrTest;\n\n        public frmTest()\n        {\n            InitializeComponent();\n            ctmrTest = new CountdownTimer(100);\n            ctmrTest.CountdownTimerTick += new CountdownTimer.CountdownTimerTickEventHandler(ctmrTest_CountdownTimerTick); \n        }\n\n        void ctmrTest_CountdownTimerTick(object sender, CountdownTimerEventArgs ea)\n        {\n            lblTimer.Text = ea.timeString;\n            if (ea.countdownFinished) countdownEnd();\n        }\n\n        private void btnStart_Click(object sender, EventArgs e)\n        {\n            ctmrTest.Reset();\n            ctmrTest.Start();\n        }\n\n        void countdownEnd()\n        {\n            MessageBox.Show(\"Finish\");\n        }\n    }\n}\n</code></pre>\n\n<p><strong>CountdownTimer.cs</strong></p>\n\n<pre><code>namespace SampleApp\n{\n    public class CountdownTimer\n    {\n        Timer tmrTicks = new Timer();\n        int secondsLeft = 0;\n        int numberOfSecondsToCountdown = 0;\n\n        public bool IsWorking\n        {\n            get { return tmrTicks.Enabled; }\n        }\n\n        public CountdownTimer(int seconds)\n        {\n            ...\n        }\n\n        void tmrTicks_Tick(object sender, EventArgs e)\n        {\n            ...\n            WhenCountdownTimerTick(new CountdownTimerEventArgs(secondsLeft, numberOfSecondsToCountdown, true));\n        }\n\n        public void Reset()\n        {\n            ...\n            WhenCountdownTimerTick(new CountdownTimerEventArgs(secondsLeft, numberOfSecondsToCountdown, false));\n        }\n\n        public void Stop()\n        {\n            tmrTicks.Enabled = false;\n        }\n\n        public void Start()\n        {\n            ,,,\n        }\n\n        public delegate void CountdownTimerTickEventHandler(object sender, CountdownTimerEventArgs ea);\n\n        public event CountdownTimerTickEventHandler CountdownTimerTick;\n\n        protected virtual void WhenCountdownTimerTick(CountdownTimerEventArgs ea)\n        {\n            if (CountdownTimerTick != null)\n            {\n                CountdownTimerTick(this, ea);\n            }\n        }\n    }\n}\n</code></pre>\n\n<p><strong>CountdownTimerEventArgs.cs</strong></p>\n\n<pre><code>namespace SampleApp\n{\n    public class CountdownTimerEventArgs : EventArgs\n    {\n        public string timeString = \"\";\n        public bool countdownFinished = false;\n\n        public CountdownTimerEventArgs(int secondsLeft, int SecondsToCountdown, bool isfinished)\n        {\n            countdownFinished = isfinished;\n            timeString = string.Format(\"{0:00}:{1:00}\", secondsLeft / 60, secondsLeft % 60);\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","asp.net","http","httpcontext"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13273312,"title":"HttpContext.Current.Request.Url.Host what it returns?","body":"<p>I'm having a local application which has a path:</p>\n\n<pre><code>http://localhost:950/m/pages/Searchresults.aspx?search=knife&amp;filter=kitchen\n</code></pre>\n\n<p>but when this goes to integration environment or perhaps the production, it will be something like</p>\n\n<pre><code>http://www.someshopping.com/m/pages/SearchResults.aspx?search=knife&amp;filter=kitchen\n</code></pre>\n\n<p>For some case I need to pass just:</p>\n\n<pre><code>www.someshopping.com\n</code></pre>\n\n<p>to my XSLT file and in one of the function I'm using this:</p>\n\n<pre><code>string currentURL = HttpContext.Current.Request.Url.Host;\n</code></pre>\n\n<p>this returns me \"<strong>localhost</strong>\" in local environment. Will the same code return me:</p>\n\n<p><strong>www.someshopping.com</strong> in production  (I DO NOT need <strong>http://</strong>)</p>\n\n<p>just don't want to take any chance. So asked this silly question.</p>\n"},{"tags":["c#","list","exception","outofmemoryexception"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":46,"score":-2,"question_id":13273139,"title":"OutOfMemoryException in List C#","body":"<p>I'm working on some tool and I'm getting strange OutOfMemoryException even if I have 2Gb memory free(tool consumes 200Mb).\nHere is stack trace:</p>\n\n<pre><code>    System.OutOfMemoryException: Exception of type 'System.OutOfMemoryException' was thrown.\n      at System.Collections.Generic.List`1.set_Capacity(Int32 value)\n      at System.Collections.Generic.List`1.EnsureCapacity(Int32 min)\n      at MySolution.MyClass.BeginSomethingAsync(Object state)\n      at System.Threading._ThreadPoolWaitCallback.WaitCallback_Context(Object state)\n      at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)\n      at System.Threading._ThreadPoolWaitCallback.PerformWaitCallbackInternal(_ThreadPoolWaitCallback tpWaitCallBack)\n  at System.Threading._ThreadPoolWaitCallback.PerformWaitCallback(Object state)\n</code></pre>\n\n<p>I'm sure that List has only 10,000 items.\nI have found some information (http://bytes.com/topic/net/answers/721871-why-outofmemoryexception-thrown) but this didnt help me. </p>\n"},{"tags":["c#",".net","obfuscation"],"answer_count":6,"favorite_count":7,"up_vote_count":6,"down_vote_count":3,"view_count":3222,"score":3,"question_id":1857685,"title":"How to create own dotnet obfuscator","body":"<p>I know that dot net dlls and exe contain their assemblies with them so every body can extract code from it. So please tell me how can i create my own .net obfuscator and if there exist any other way to protect my application to deassemble. and plez dont give me link of any paid obfuscator. i would prefer code sample in c# or vb.net</p>\n"},{"tags":["c#","database","listbox"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3148,"score":0,"question_id":2438796,"title":"Transferring data from one list box to another c#","body":"<p>Ok so I have 2 list boxes one is connected to a database the other isnt.</p>\n\n<p>I want to be able to send the selected item from the listbox connected to the database to the one that isnt.</p>\n\n<p>Ive written this code</p>\n\n<pre><code>listBox2.Items.Add(listBox1.SelectedItem);\n</code></pre>\n\n<p>But instead of copyin the item i get \"</p>\n\n<pre><code>System.Data.DataRowView\n</code></pre>\n\n<p>Anyone havin any advice?</p>\n"},{"tags":["c#","delete","directory","folder"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13265743,"title":"The technique which deletes an execution file itself and a folder includes it","body":"<p>I am developing the program which deletes the execution file itself for a uninstaller. Because it was the theme frequently taken up also at this site, I found the way easily.</p>\n\n<p>One of answer is-><a href=\"http://www.codeproject.com/Articles/31454/How-To-Make-Your-Application-Delete-Itself-Immedia\" rel=\"nofollow\">http://www.codeproject.com/Articles/31454/How-To-Make-Your-Application-Delete-Itself-Immedia</a>. I referred to this and wrote it.</p>\n\n<pre><code>string dir = Path.GetDirectoryName(Application.ExecutablePath);\nProcessStartInfo psi = new ProcessStartInfo();\npsi.WindowStyle = ProcessWindowStyle.Hidden;\npsi.FileName = \"cmd\";\npsi.Arguments = \"/C rmdir /s /q \\\"\" + dir + \"\\\"\";\nProcess p = Process.Start(psi);\nApplication.Exit();\n</code></pre>\n\n<p>Deleting its file was succeeded, on the other hand, the folder was not deleted. Although I would like to also delete a folder including it, are there any good ways? </p>\n"},{"tags":["c#","service","window","execution"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13273199,"title":"How is code executed in a window service?","body":"<p>I was asked to develop a C# windows service. However I am used to create GUI with User Input.</p>\n\n<p>Since windows services are automated, I would like to know how is the code executed.</p>\n\n<p>I mean how can I control the flow?</p>\n\n<p>Could someone clarify? I don't find a lot of information about window services... </p>\n"},{"tags":["c#","push-notification","android-gcm"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13268460,"title":"PushSharp: Getting Android GCM Push Notification without push message","body":"<p>I am using PushSharp library to send push notification from my application.</p>\n\n<pre><code>PushService push = new PushService();\nvar reg_id_d = \"APA91bETd-LsqnZjA-HKrnBOY3FbEhmWchpiwuhRkiv4gUdGDuvwDRB7YURICZ131XppDAUNUBLGe_vEPkQ-JR8UaVX7Y-NCkEfastCBLIYcUoFtt5cPafeKXHywi0WGDYW33ZQqr3oy\";\nvar project_id_d = \"482885626272\";\nvar api_key_d = \"AIzaSyAbh7R5KQR3KM7W_y-yS-Ao-JNiihNz7tE\"; // \"AIzaSyDcKfuW77GTwA46L6sqD41YhGf2j5S8o2w\";\nvar package_name_d = \"com.get.deviceid\";\n\npush.StartGoogleCloudMessagingPushService(new GcmPushChannelSettings(project_id_d, api_key_d, package_name_d));\npush.QueueNotification(NotificationFactory.AndroidGcm()\n                .ForDeviceRegistrationId(reg_id_d)\n                .WithCollapseKey(\"NONE\")\n                .WithJson(\"{\\\"alert\\\":\\\"Alert Text!\\\",\\\"badge\\\":\\\"1\\\"}\"));\n</code></pre>\n\n<p>I am getting notification on my device but with blank message..</p>\n\n<p>I have tried with sever code available in C# to send GCM push notification, but getting same problem of having blank message. </p>\n\n<p>I tried using PHP to send notification. and it is working as expected. so, I am not sure what is wrong in my above code. Can anyone please help me on this?</p>\n"},{"tags":["c#","casting","boolean","equality","value-type"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":2,"view_count":63,"score":2,"question_id":13272552,"title":"Comparing value types cast to object","body":"<p>I have a method which returns an object, which could be one of a number of different data types, including strings, numbers and bools; and at some point I need to compare the equality of two values returned from this method. I'm using <code>==</code> instead of <code>Equals()</code> because I need different number types to compare - ie. <code>3 == 3.0</code> - which is working fine for strings and numbers, but for some reason it falls down when I'm comparing boolean values.</p>\n\n<p>What would be the best way to solve this problem? I'd prefer not to have to detect the type and cast if bool, but I will do if there is no other solution</p>\n\n<p>My code looks something like:</p>\n\n<pre><code>private object GetValue() {\n    // does some stuff, returns either a boolean, string or number value\n}\n\nvar value1 = GetValue();\nvar value2 = GetValue();\nif (value1 == value2) {\n    // do something\n}\n</code></pre>\n"},{"tags":["c#",".net"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":4,"view_count":56,"score":-3,"question_id":13273205,"title":"Need advice on program logic","body":"<p>The program comes to the page and makes pressing buttons</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Windows.Forms;\n\n\nnamespace Bot\n{\n    public partial class FormWindow : Form\n    {\n        Random rnd;\n        Settings settingsForm;\n        Timer tm;\n        CallTimers callTimers;\n\n        public FormWindow()\n        {\n            rnd = new Random();\n            settingsForm = new Settings();\n            tm = new Timer();\n            tm.Tick += new EventHandler(tm_Tick);\n            wb = new WebBrowser();\n            InitializeComponent();\n        }\n\n        private void wb_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)\n        {\n            if (wb.Document.GetElementById(\"login-email\") != null)\n            {\n                wb.Document.GetElementById(\"login-email\").InnerText = settingsForm.tEmail.Text;\n                wb.Document.GetElementById(\"login-password\").InnerText = settingsForm.tPassword.Text;\n                Method_1(\"button luxury\")[0].InvokeMember(\"click\");\n            }\n\n               CallMethodAfterDelay(KrysomahHunting, 5000, tm);\n\n                if (wb.Url.AbsoluteUri == \"http://www.moswar.ru/metro/\" &amp;&amp; wb.ReadyState == WebBrowserReadyState.Complete)\n                {\n                    wb.Stop();\n                    method_2(\"c\", \"Выследить Крысомаху\")[0].InvokeMember(\"click\");\n                    Method_1(new string[] { \"button\" })[0].InvokeMember(\"click\");\n                }\n        }\n\n        //go to page \n        public void GoPage(string string_9, string string_10)\n        {\n            this.wb.Stop();\n            string additionalHeaders = \"Content-Type: application/x-www-form-urlencoded\" + Environment.NewLine;\n            this.wb.Navigate(string_9, \"\", Encoding.UTF8.GetBytes(string_10), additionalHeaders);\n        }\n\n\n        public List&lt;HtmlElement&gt; Method_1(params string[] ClassNames)\n        {\n            List&lt;HtmlElement&gt; list = new List&lt;HtmlElement&gt;();\n            foreach (HtmlElement htmlElement in wb.Document.All)\n            {\n                for (int i = 0; i &lt; ClassNames.Length; i++)\n                {\n                    string b = ClassNames[i];\n                    if (htmlElement.GetAttribute(\"className\") == b)\n                    {\n                        list.Add(htmlElement);\n                        break;\n                    }\n                }\n            }\n            return list;\n        }\n\n\n        private void ButtonStart_Click(object sender, EventArgs e)\n        {\n            if (this.settingsForm.tEmail.Text == \"\" || this.settingsForm.tPassword.Text == \"\")\n            {\n                MessageBox.Show(\"Отсутствует логин и\\\\или пароль для входа на сервер МосВара.\\nВвести их можно, нажав на кнопку \\\"Настройки\\\".\", \"Ошибка\", MessageBoxButtons.OK, MessageBoxIcon.Hand);\n                return;\n            }\n            wb.Navigate(\"http://www.moswar.ru\");\n        }\n\n        private void tm_Tick(object sender, EventArgs e)\n        {\n            ((MethodInvoker)tm.Tag).Invoke();\n            tm.Stop();\n        }\n\n        //go to page through time \n         public void CallMethodAfterDelay(MethodInvoker MethodToCall, int Delay,Timer tm)\n       {\n           tm.Interval = Delay;\n           tm.Tag = MethodToCall;\n           tm.Start();\n       }\n        public void KrysomahHunting()\n        {\n            GoPage(\"http://www.moswar.ru/metro/\", \"\");\n        }\n\n        private List&lt;HtmlElement&gt; method_2(string string_9, string string_10)\n        {\n            List&lt;HtmlElement&gt; list = new List&lt;HtmlElement&gt;();\n            foreach (HtmlElement htmlElement in this.wb.Document.All)\n            {\n                if (htmlElement.GetAttribute(\"className\") == string_9 &amp;&amp; htmlElement.InnerText != null &amp;&amp; htmlElement.InnerText.IndexOf(string_10) != -1)\n                {\n                    list.Add(htmlElement);\n                }\n            }\n            return list;\n        }\n\n    }\n}\n</code></pre>\n\n<p>Help how to articulate the logic</p>\n\n<p>In this piece of code</p>\n\n<pre><code>private void wb_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)\n        {\n            if (wb.Document.GetElementById(\"login-email\") != null)\n            {\n                wb.Document.GetElementById(\"login-email\").InnerText = settingsForm.tEmail.Text;\n                wb.Document.GetElementById(\"login-password\").InnerText = settingsForm.tPassword.Text;\n                Method_1(\"button luxury\")[0].InvokeMember(\"click\");\n            }\n\n               CallMethodAfterDelay(KrysomahHunting, 5000, tm);\n\n                if (wb.Url.AbsoluteUri == \"http://www.moswar.ru/metro/\" &amp;&amp; wb.ReadyState == WebBrowserReadyState.Complete)\n                {\n                    wb.Stop();\n                    method_2(\"c\", \"Выследить Крысомаху\")[0].InvokeMember(\"click\");\n                    Method_1(new string[] { \"button\" })[0].InvokeMember(\"click\");\n                }\n\n        }\n</code></pre>\n\n<p>When the program comes to the method </p>\n\n<pre><code>method_2(\"c\", \"Выследить Крысомаху\")[0].InvokeMember(\"click\");\n</code></pre>\n\n<p>throws Exception ArgumentOutRangeException</p>\n\n<p>I supposethat this couldbe caused by </p>\n\n<pre><code>private void wb_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)\n</code></pre>\n\n<p>Heconstantly checks.Ifapagethatexecute methods .And because the method once already done its job, there is no longer the values</p>\n\n<p>And so we get an exception ArgumentOutRangeException. Help how to make the logic for this case!</p>\n"},{"tags":["c#",".net","c#-4.0","sso","saml-2.0"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":7,"score":1,"question_id":13273256,"title":"Error while deserializing SAML2 response to Saml2SecurityToken","body":"<p>I have a SAML Reponse which I want to convert to a Saml2SecurityToken.\nThis is what I do:</p>\n\n<pre><code>// SAMLResponseString is a base64 encode SAML2 XML string\nstring SAMLResponse = SamlHelper.DecodeFrom64(SAMLResponseString);\nXmlReader reader = new XmlTextReader(new StringReader(SAMLResponse));\n\nvar certificate = new X509Certificate2(\"[path]\", \"[password]\");\nList&lt;SecurityToken&gt; tokens = new List&lt;SecurityToken&gt;();\ntokens.Add(new X509SecurityToken(certificate));\n\nSecurityTokenResolver outOfBandTokenResolver =\n  SecurityTokenResolver.CreateDefaultSecurityTokenResolver(new \n  ReadOnlyCollection&lt;SecurityToken&gt;(tokens), true);\nvar securityToken = (Saml2SecurityToken) WSSecurityTokenSerializer.DefaultInstance.ReadToken(reader, null);\n</code></pre>\n\n<p>On the last line (of the WSSecurityTokenSerializer), I get the following error:</p>\n\n<pre><code>Cannot read the token from the 'Response' element with the 'urn:oasis:names:tc:SAML:2.0:protocol' namespace for BinarySecretSecurityToken, with a '' ValueType. If this element is expected to be valid, ensure that security is configured to consume tokens with the name, namespace and value type specified.\n</code></pre>\n\n<p>My Response is starting with: (without the space between &lt; and samlp:Response):</p>\n\n<pre><code>&lt; samlp:Response xmlns:samlp=\"urn:oasis:names:tc:SAML:2.0:protocol\" xmlns:saml=\"urn:oasis:names:tc:SAML:2.0:assertion\" Version=\"2.0\"&gt;\n</code></pre>\n\n<p>Does anyone know what is going wrong here?</p>\n"},{"tags":["c#","asp.net"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13273097,"title":"using selected text in asp.net textbox","body":"<p>I have a textbox that has regular text in it.  I want a user to be able to select a word and create a hyperlink from that word.  I will be doing this by basically using that word and replacing it with an a tag and adding url info.  My question is how can I get the users selected text from c# code behind.  I saw something about selectedtext but that only works for windows forms textbox.  Any ideas?</p>\n\n<p>thanks,</p>\n"},{"tags":["c#",".net","reflection"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13273180,"title":"c# Reflection of a nested struct property","body":"<p>I'm trying to do some dynamic text to object parsing, however, I have run into a snag when creating and setting nested property values for structs.</p>\n\n<p>If I have a property in an object that is a struct, whenever I use reflection to obtain the struct object and set any of it's properties/fields, the value on the object is not changed.  Take the object graph below.</p>\n\n<pre><code>public struct MyStruct\n{\n    public int MyIntProp {get;set;}\n}\n\npublic class MyObj\n{\n    public MyStruct NestedStruct {get;set;}\n}\n\nPropertyInfo pInfo = (myObj.GetType()).GetProperty(\"NestedStruct\");\nobject nestedStruct = pInfo.GetValue(myObj); // This is the nested struct however it is only a copy not the actual object\nPropertyInfo intInfo = (pInfo.PropertyType).GetProperty(\"MyIntProp\");\nintInfo.SetValue(nestedStruct, 23); // this sets the MyIntProp on the nestedStruct, but it is not set on the myObj.NestedStruct.  My goal is to set object on that NestedStruct via reflection.\n</code></pre>\n\n<p>When I use reflection to obtain the NestedStruct property and then set the MyIntProp on that struct, the original MyObj.NestedStruct.MyIntProp doesn't change.  Naturally I attribute this to the fact that the struct is a value type and not a reference type.  </p>\n\n<p>So the real question is how I can use reflection to obtain the reference to a value type.</p>\n"},{"tags":["c#","github","open-source","nuget"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":25,"score":3,"question_id":13272672,"title":"Directory structure for a NuGet published github hosted project","body":"<p>For a github hosted open sourced C# project which is also available via NuGet, how should one organize the source? Specifically:</p>\n\n<ul>\n<li>should the .nuspec file be in the github repository?</li>\n<li>should the .nuspec file be in the same folder as the .csproj file?</li>\n<li>how about the NuGet package tree (the /lib, /content stuff), since is generated, should it be in git?</li>\n</ul>\n\n<p>My thinking is that the NuGet part is separate from the github hosting, as in the project source are available but the .nuspec is not, since the publishing in NuGet is not an open source operation per-se. None wants that every fork to build and publish a <em>new</em> NuGet package, so that the open source Foo package ends up in the gallery as 'Rick's Foo' vs. 'John's Foo' vs. 'Alice's Foo' etc. </p>\n\n<p>But on the other hand I do want the github source depot to act as a one-stop repository for the project, if I open my other laptop and enlist from there, I should be able to build/package/push w/o recreating the whole NuGet infrastructure from scratch (ie. only enter my API key, nothing more).</p>\n\n<p>These two requirements are contradicting each other, Did I miss something obvious?</p>\n"},{"tags":["c#","trace","nlog","system.diagnostics"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":11,"score":1,"question_id":13260672,"title":"Automatically log System.diagnostics.trace messages to an Nlog target","body":"<p>Say you have C# trace messages all over an application. Something like:       </p>\n\n<pre><code>Trace.TraceInformation(\"Service Started\"); \n</code></pre>\n\n<p>How do you automatically log this to an nLog target without having to add code like the following to all the classes that have trace messages? </p>\n\n<pre><code>using NLog;\nprivate static Logger logger = LogManager.GetCurrentClassLogger();\n</code></pre>\n\n<p>Is there a way to do this without including traces produced by the .NET Framework itself, which <a href=\"http://nlog-project.org/2010/09/02/routing-system-diagnostics-trace-and-system-diagnostics-tracesource-logs-through-nlog.html\" rel=\"nofollow\">this article</a> demonstrates how to do? </p>\n"},{"tags":["c#","process","kill"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13273163,"title":"Restart a process","body":"<p>I want to restart a program.<br />\nI've found the process and have called Kill method, then i've runned it again:<br />\nprocess.Kill();<br />\nprocess.Start();<br /></p>\n\n<p>It stops but doesn't start.<br />\nAlso if I put Exited event it never fires.<br />\nWhat's the problem?</p>\n"},{"tags":["c#","asp.net","asp.net-mvc-3"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13272886,"title":"Hybrid asp.net 4 and MVC application","body":"<p>I am in the process of migrating a asp.net 4 project to MVC 3 - with plans to migrate to MVC4 once everything had been migrated.  I followed this post:</p>\n\n<p><a href=\"http://www.hanselman.com/blog/IntegratingASPNETMVC3IntoExistingUpgradedASPNET4WebFormsApplications.aspx\" rel=\"nofollow\">http://www.hanselman.com/blog/IntegratingASPNETMVC3IntoExistingUpgradedASPNET4WebFormsApplications.aspx</a></p>\n\n<p>Created an Area, added the Controllers and Views folders, created a controller</p>\n\n<pre><code>public class HomeController : Controller\n{\n  public ActionResult Index()\n  {\n    return View();\n  }\n}\n</code></pre>\n\n<p>Ran the application and checked the standard Aspx pages and then worked fine and then went to the path of the Controller and get the \"Error: Value can not be null. Parameter name: incomingMarkupParser\" error.  So, I then removed the return View(); and replaced it with return Content(\"Hello world\"); and this worked with no problems at all.</p>\n\n<p>So I thought to myself, is there a problem with the area... Created a Controllers and Views folder and tried again - same problem.</p>\n\n<p>System.Web.Razor is version 2.0.0.0\nSystem.Web.WebPages is version 1.0.0.0 (also tried version 2)</p>\n\n<p>Web.Config</p>\n\n<pre><code>  &lt;assemblies&gt;\n    &lt;add assembly=\"System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A\" /&gt;\n    &lt;add assembly=\"System.Web.Extensions.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" /&gt;\n    &lt;add assembly=\"System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089\" /&gt;\n    &lt;add assembly=\"System.Data.Entity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" /&gt;\n    &lt;add assembly=\"System.Web.Abstractions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" /&gt;\n    &lt;add assembly=\"System.Web.Helpers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" /&gt;\n    &lt;add assembly=\"System.Web.Routing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" /&gt;\n    &lt;add assembly=\"System.Data.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089\" /&gt;\n    &lt;add assembly=\"System.Web.Mvc, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" /&gt;\n    &lt;add assembly=\"System.Web.WebPages, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" /&gt;\n  &lt;/assemblies&gt;\n\n  &lt;namespaces&gt;\n    &lt;add namespace=\"System.Web.Helpers\" /&gt;\n    &lt;add namespace=\"System.Web.Mvc\" /&gt;\n    &lt;add namespace=\"System.Web.Mvc.Ajax\" /&gt;\n    &lt;add namespace=\"System.Web.Mvc.Html\" /&gt;\n    &lt;add namespace=\"System.Web.Routing\" /&gt;\n    &lt;add namespace=\"System.Web.WebPages\"/&gt;\n  &lt;/namespaces&gt;\n</code></pre>\n\n<p>I know the problem is to do with Razor but I cannot find what.  Has anyone else experienced this, and if so how did they overcome it?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","asp.net","gridview","textbox","validator"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13180696,"title":"How to globalize RegularExpressionValidator Error Message?","body":"<p>Is there any way where we can globalize RegularExpressionValidator errorMessage? and instead of calling the error message from  we can call it off a resource file ?\nHere is what I have:</p>\n\n<pre><code>&lt;FooterTemplate&gt;\n                                    &lt;asp:TextBox ID=\"addCREDIT_TYPE\" style=\"WIDTH: 55px\" Runat=\"Server\" MaxLength=\"1\"&gt;&lt;/asp:TextBox&gt;\n                                    &lt;asp:RegularExpressionValidator ID=\"valCreditType\" ControlToValidate=\"addCREDIT_TYPE\" ValidationExpression=\"B|P|C|b|p|c\"\n                                    ErrorMessage=\"Invalid Type. Enter B or C or P\" Runat=\"server\" Display=\"Dynamic\"&gt;&lt;/asp:RegularExpressionValidator&gt;\n                                    &lt;/FooterTemplate&gt;\n</code></pre>\n"},{"tags":["c#","wpf","xaml","visual-studio-2012","kinect"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13256124,"title":"KinectColorViewer and SDK 1.6","body":"<p>I'm new to Kinect and VS Development, and I was using the <a href=\"http://channel9.msdn.com/Series/KinectQuickstart\" rel=\"nofollow\">Windows Kinect Quickstart Series</a>, but unfortunately, it was meant for Kinect SDK v1.00.</p>\n\n<p>I got stuck on KinectColorView usage, and I'cant proceed (I have been Googlin' for 2 days now). I also found this very similar question: <a href=\"http://stackoverflow.com/questions/12609858/using-kinectcolorviewer-in-sdk1-5\">Using KinectColorViewer in SDK1.5</a> here on StackOverflow but couldn't solve my problem. I know that I'm close, but i need help.</p>\n\n<p><strong>The problem is: that I can't get my KinectColorViewer to work.</strong></p>\n\n<p>I added it to the XAML designer, but it seems I can't bind it to the SensorManager. \nHere is my XAML code:</p>\n\n<pre><code>&lt;Window\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:WpfViewers=\"clr-namespace:Microsoft.Samples.Kinect.WpfViewers;assembly=Microsoft.Samples.Kinect.WpfViewers\" xmlns:Toolkit=\"clr-namespace:Microsoft.Kinect.Toolkit;assembly=Microsoft.Kinect.Toolkit\" xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"d\" x:Class=\"KinectSetupDev.MainWindow\"\n    Title=\"MainWindow\" Height=\"768\" Width=\"1024\" Loaded=\"Window_Loaded_1\" Closed=\"Window_Closed_1\"&gt;\n\n    &lt;Grid HorizontalAlignment=\"Left\" Height=\"736\" VerticalAlignment=\"Top\" Width=\"1012\" Margin=\"2,2,0,0\"&gt;\n         &lt;TextBlock x:Name=\"tbMessages\" HorizontalAlignment=\"Left\" Height=\"60\" Margin=\"10,662,0,0\" TextWrapping=\"Wrap\" VerticalAlignment=\"Top\" Width=\"992\"/&gt;\n         &lt;WpfViewers:KinectColorViewer x:Name=\"KinectColorViewer\" KinectSensorManager=\"{Binding KinectSensorManager}\" HorizontalAlignment=\"Left\" Height=\"240\" Margin=\"608,27,0,0\" VerticalAlignment=\"Top\" Width=\"320\" BorderThickness=\"1\" BorderBrush=\"Black\"/&gt;\n    &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>Nothing to report about the XAML code, except that i had to add the chunk</p>\n\n<pre><code>\"KinectSensorManager=\"{Binding KinectSensorManager}\"\n</code></pre>\n\n<p>in the KinectColorViewer item by writing it, because I couldn't find the way to this by the XAML designer's GUI (so I have some doubts about its viability).</p>\n\n<p>Here is my code-behind (<em>I almost totally copied it by the question: <a href=\"http://stackoverflow.com/questions/12609858/using-kinectcolorviewer-in-sdk1-5\">Using KinectColorViewer in SDK1.5</a> so I can't understand why it's not working!!</em>)</p>\n\n<pre><code>namespace KinectSetupDev\n{\n  public partial class MainWindow : Window\n  {\n    // Automatically finds a Kinect for you.\n    private readonly KinectSensorChooser sensorChooser = new KinectSensorChooser();\n\n    public KinectSensorManager KinectSensorManager01 { get; private set; }\n\n    public MainWindow()\n    {\n        InitializeComponent();\n        DataContext = this;\n\n    }\n\n    private void Window_Loaded_1(object sender, RoutedEventArgs e)\n    {\n        // Initialize the Kinect sensor manager.\n        KinectSensorManager01 = new KinectSensorManager();\n        KinectSensorManager01.KinectSensorChanged += this.KinectSensorChanged;\n\n        // Locate an available sensor.\n        sensorChooser.Start();\n\n        // Bind chooser's sensor value to the local sensor manager.\n        var kinectSensorBinding = new Binding(\"Kinect\") { Source = this.sensorChooser };\n        BindingOperations.SetBinding(this.KinectSensorManager01, KinectSensorManager.KinectSensorProperty, kinectSensorBinding);\n    }\n\n    private void Window_Closed_1(object sender, EventArgs e)\n    {\n        UninitializeKinectServices(KinectSensorManager01.KinectSensor);\n    }\n\n    #region Kinect Discovery &amp; Setup\n\n    private void KinectSensorChanged(object sender, KinectSensorManagerEventArgs&lt;KinectSensor&gt; args)\n    {\n        if (null != args.OldValue)  \n            UninitializeKinectServices(args.OldValue);\n\n        if (null != args.NewValue)\n            InitializeKinectServices(KinectSensorManager01, args.NewValue);\n    }\n\n    // Kinect enabled apps should customize which Kinect services it initializes here.\n    private void InitializeKinectServices(KinectSensorManager kinectSensorManager, KinectSensor sensor)\n    {\n        // Application should enable all streams first.\n        kinectSensorManager.ColorStreamEnabled = true;\n        kinectSensorManager.DepthStreamEnabled = true;\n        kinectSensorManager.SkeletonStreamEnabled = true;\n\n        // Start the sensor!\n        try\n        {\n            sensor.Start();\n            sensorChooser.Kinect.ElevationAngle = 10;\n            tbMessages.Text = \"Kinect Started\";\n        }\n        catch (System.IO.IOException)\n        {\n            sensor = null;\n            tbMessages.Text = \"Kinect Not Started\" + \"\\r\";\n        }\n    }\n\n    // Kinect enabled apps should uninitialize all Kinect services that were initialized in InitializeKinectServices() here.\n    private void UninitializeKinectServices(KinectSensor sensor)\n    {\n        if (sensor != null)\n        {\n\n            if (sensor.IsRunning)\n            {\n                sensorChooser.Kinect.ElevationAngle = 0;\n                sensor.Stop();\n                sensor.AudioSource.Stop();\n\n            }\n        }\n    }\n\n    #endregion Kinect Discovery &amp; Setup\n\n  }\n}\n</code></pre>\n\n<p>I tried to add the line  <code>DataContext = this;</code>  in the contructor, but it does not work.</p>\n\n<p><strong>The application runs, my Kinect starts but the KinectColorViewer does not show anything.</strong></p>\n\n<p><em>Moreover, can anyone tell the difference between</em>  <code>sensor.SkeletonStream.Enable();</code> \n<em>and</em>  <code>kinectSensorManager.SkeletonStreamEnabled = true;</code>  <em>??</em></p>\n"},{"tags":["c#","asp.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13272865,"title":"how to manipulate the URL path in c# asp.net?","body":"<p>I have the following path:</p>\n\n<blockquote>\n  <p>-http://localhost/portal/reportview.aspx</p>\n</blockquote>\n\n<p>but I need to retrieve the first 3 parts:</p>\n\n<blockquote>\n  <p>-http://localhost/portal/</p>\n</blockquote>\n\n<p>Ive tried <code>HttpContext.Current.Request.Url.GetLeftPart();</code> with no luck.</p>\n"},{"tags":["c#","database","path","privileges","appdata"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":22,"score":2,"question_id":13272429,"title":"Crash for the deletion of a database in AppData: Access denied","body":"<p>I have this code for creating a path for a database:</p>\n\n<pre><code>static string folder = Application.UserAppDataPath; \nstatic string fisier = \"prog.db\"; \nstring file = folder + \"\\\\\" + fisier;\n</code></pre>\n\n<p>And this code for delete the database:</p>\n\n<pre><code>if (System.IO.File.Exists(file))\n   System.IO.File.Delete(file);\n</code></pre>\n\n<p>And this code for wirting the database:</p>\n\n<pre><code>if (!System.IO.File.Exists(file)) \n            {\n                System.IO.File.WriteAllText(file, \"\");\n            }\n</code></pre>\n\n<p>The codes work perfectly, but the problem is with the privileges. To some people, is a problem with the deleting of database, the application will crash becouse will can not delete the database. Not works only for some people, in my case, work perfectly, but I want to resolve the problem to not crash if you don't have the privileges.</p>\n"},{"tags":["c#","itextsharp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13258280,"title":"How do I 'Save As' an existing pdf in ItextSharp?","body":"<p>What I want to do is write variables to an existing PDF template and allow the user to save as after clicking get results? is this possible?</p>\n"},{"tags":["c#","vb.net","compiler","attributes"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13260695,"title":"What other neat tricks does the SpecialNameAttribute allow?","body":"<p>In researching <a href=\"http://stackoverflow.com/questions/13259162/vb-net-power-operator-overloading-from-c-sharp\">a question</a> on implementing the Visual Basic Power (<code>^</code>) operator, I learned that the <a href=\"http://msdn.microsoft.com/en-us/library/System.Runtime.CompilerServices.SpecialNameAttribute.aspx\" rel=\"nofollow\"><code>System.Runtime.CompilerServices.SpecialNameAttribute</code></a> class allows one to implement this operator in C# for use in VB.</p>\n\n<p>Interestingly, the <a href=\"http://msdn.microsoft.com/en-us/library/System.Runtime.CompilerServices.SpecialNameAttribute.aspx\" rel=\"nofollow\">documentation</a> states:</p>\n\n<blockquote>\n  <p>The <strong>SpecialNameAttribute</strong> class is not currently used in the .NET Framework, but is reserved for future use.</p>\n</blockquote>\n\n<p>My question is:  What other neat tricks are available when using this attribute? </p>\n\n<p>(side question - is the documentation inaccurate or is this a semantic issue since the attribute is apparently used by the <em>compiler</em> but not the <em>framework</em>?)</p>\n"},{"tags":["c#","linq"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":111,"score":3,"question_id":13270662,"title":"How to make AND operator in C# linq?","body":"<pre><code>IEnumerable&lt;WireUsrTgInfo&gt; lstWireData = \n    (from var in lstWireUsrTgInfo\n     where var.bWireData == true &amp;&amp; var.bWireData == false --&gt; This is not working\n     select var).AsEnumerable&lt;WireUsrTgInfo&gt;();\n</code></pre>\n\n<p>How to do this ... </p>\n"},{"tags":["c#","web-services"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12679114,"title":"Send custom object through webservices Error","body":"<pre><code>   [WebService(Namespace = \"http://tempuri.org/\")]\n[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]\n[System.ComponentModel.ToolboxItem(false)]\n// To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. \n// [System.Web.Script.Services.ScriptService]\npublic class Service1 : System.Web.Services.WebService\n{\n\n    [WebMethod]\n    public LoginResponse SignUp(string email, string password)\n    {\n        LoginResponse s = new LoginResponse();\n        //s.Code = \"123434\";\n        //s.Message = \"Signup succeed\";\n        //s.UserId = \"\";\n        return s;\n    }\n\n    [WebMethod]\n    public SendCodeResponse SendCode(string userId, string barCode)\n    {\n        SendCodeResponse scr = new SendCodeResponse();\n        scr.code = \"\";\n        return scr;\n    }\n\n\n\n[Serializable]\n    public class LoginResponse\n    {\n        string code;\n        string message;\n        string userId;\n\n        [XmlElement(Type = typeof(string), ElementName = \"Code\")]\n        public string Code\n        {\n            get { return code; }\n            set { code = value; }\n        }\n\n        [XmlElement(Type = typeof(string), ElementName = \"Message\")]\n        public string Message\n        {\n            get { return message; }\n            set { message = value; }\n        }\n\n        [XmlElement(Type = typeof(string), ElementName = \"UserId\")]\n        public string UserId\n        {\n            get { return userId; }\n            set { userId = value; }\n        }\n    }\n\n\n    [Serializable]\n    public class SendCodeResponse\n    {\n        string code;\n        [XmlElement(Type = typeof(string), ElementName = \"Code\")]\n        public string Code\n        {\n            get { return code; }\n            set { code = value; }\n        }\n    }\n</code></pre>\n\n<p>When I run this webservice it gives me\n\nServer Error in '/' Application.</p>\n\n<p>The XML element 'SendCodeResponse' from namespace 'http://tempuri.org/' references a method and a type. Change the method's message name using WebMethodAttribute or change the type's root element using the XmlRootAttribute.</p>\n\n<p>Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. </p>\n\n<p>Exception Details: System.InvalidOperationException: The XML element 'SendCodeResponse' from namespace 'http://tempuri.org/' references a method and a type. Change the method's message name using WebMethodAttribute or change the type's root element using the XmlRootAttribute.</p>\n\n<p>\nPlease help me.</p>\n"},{"tags":["c#","asp.net","repeater"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13272805,"title":"How to pass in the entire object into a function in a repeater?","body":"<p>In my codebehind I have:</p>\n\n<pre><code>List&lt;Products&gt; products = \nrptr.Datasource = products;\n\n\nprotected string GetVariants(Product product)\n{\n  //\n}\n</code></pre>\n\n<p>In my repeater I have:</p>\n\n<pre><code>&lt;itemTemplate&gt;\n\n&lt;li&gt;  &lt;%# Eval(\"Name\") %&gt;\n&lt;li&gt;  &lt;%# GetVariants(?????????????) %&gt;\n\n&lt;/itemTemplate&gt;\n</code></pre>\n\n<p>How do I pass the product object to the GetVariants method?</p>\n"},{"tags":["c#","xaml","stackpanel","windows-store-apps"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13241742,"title":"Add Expansion Button to Stackpanel","body":"<p>I'd like to add Elements to a StackPanel (or Listbox / Listview if it would make that easier) and automatically add a Button (like \"...\") to indicate that there are more children than there is space for.\nConsider a calendar that has appointment items in each day. If there are more appointments than as much as can be displayed a button is displayed to go to a detailed view for that day.</p>\n\n<p>Can this be done automatically, or how do I calculate the positions of the stackpanel and its items.</p>\n\n<p>It's for windows store development in c#.</p>\n"},{"tags":["c#","sockets","client","endpoint","reconnect"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13271817,"title":"Connect to the same End Point using Socket","body":"<p>I'm using the <a href=\"http://msdn.microsoft.com/en-us/library/system.net.sockets.socket%28v=vs.90%29.aspx\" rel=\"nofollow\">Socket</a> class in a client TCP/IP application to connect my client to a server.</p>\n\n<p>I have the following code:</p>\n\n<pre><code>var endPoint = new IPEndPoint(IPAddress.Parse(IP), port);\nvar client = new Socket(AddressFamily.InterNetwork, SocketType.Stream,\n                        ProtocolType.Tcp);\n\nclient.Connect(endPoint);\n\ntry\n{\n    while (true)\n    {\n        // Do work...\n        // Receive/Send data from/to server\n    }\n}\ncatch (SocketException)\n{\n    /* At some point the server disconnects...\n    Exception catched because the server close the connection\n    Socket error 10054 - WSAECONNRESET */\n\n    // So I try to reconnect\n    if(client.Connected == false)\n    {\n        /* The following line throws a InvalidOperationException.\n        Message: After disconnecting the socket, you can reconnect only \n        asynchronously from a different EndPoint. BeginConnect must be \n        called on a thread that will not close until the operation completes.*/\n        client.Connect(endPoint);   \n\n        /* So I try instead Socket.BeginConnect, but the following line\n        throws a SocketException 10061 - WSAECONNREFUSED */\n        client.BeginConnect(endPoint, ConnectCallback, client);\n\n        /* And also the following code throws a \n            SocketException 10061 - WSAECONNREFUSED */\n        client = new Socket(AddressFamily.InterNetwork, SocketType.Stream,\n                                ProtocolType.Tcp);\n        client.Connect(endPoint);\n    }\n} \n</code></pre>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/ms740668%28v=vs.85%29.aspx\" rel=\"nofollow\">Here</a> a list of socket error.<br><br></p>\n\n<p>So, at some point the server close the connection, I need to know what is the best method to know when the server is ready for accept another connection and how to connect again to the same End Point.</p>\n"},{"tags":["c#","vsto","excel-interop"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":4837,"score":1,"question_id":7099770,"title":"HRESULT: 0x800A03EC on Worksheet.range","body":"<p>I am getting HRESULT: 0x800A03EC on Worksheet.range method. Number of rows are more than 70K. Office 2007.</p>\n\n<p>Code:</p>\n\n<pre><code>Microsoft.Office.Interop.Excel.Range neededRange\n    = currentWS.Range[cell.Cells[1, 1], cell.Cells[nRowCount, nColumnCount]];\n</code></pre>\n\n<p>Here my rowcount is more than 65530 . Breaks on this function. I have observed that it breaks only when row count goes more than 65530.</p>\n"},{"tags":["c#","web-applications","bitmap","webbrowser","xelement"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":29,"score":-4,"question_id":13272162,"title":"web browser in C# without using my own web browser class","body":"<p>i have no idea about what im doing the problem is that i got the assignment without any further explanation all what i have to do is make a program with main form that will load an html file into it but without using web browser class and the Html will contain a text and images and the only hint i got is i'll be using \"Xelement to read the file from a Dom tree and render it into a bitmap file that will be displayed into the form\" </p>\n"},{"tags":["c#","sql-server","sql-server-2005","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2107,"score":1,"question_id":6824188,"title":"SqlDataSourceEnumerator.Instance.GetDataSources() does not locate local SQL server 2008 instance","body":"<p>I use the following code to list all the remote and local SQL Server instances:</p>\n\n<pre><code>public static void LocateSqlInstances()\n  {\n     using( DataTable sqlSources = SqlDataSourceEnumerator.Instance.GetDataSources())\n     {\n        foreach(DataRow source in sqlSources.Rows )\n        {\n           string instanceName = source[\"InstanceName\"].ToString();\n\n           if (!string.IsNullOrEmpty(instanceName))\n           {\n              Console.WriteLine(\" Server Name:{0}\", source[\"ServerName\"]);\n              Console.WriteLine(\"   Instance Name:{0}\", source[\"InstanceName\"]);\n              Console.WriteLine(\"   Version:{0}\", source[\"Version\"]);\n              Console.WriteLine();\n           }\n        }\n        Console.ReadKey();\n     }\n  }\n</code></pre>\n\n<p>running the code on my local machine. The code can find and list a SQL server express instance (version 9.0.5000) installed but failed to list the other SQL server instance (version 10.0.1600).</p>\n\n<p>I've done a lot of research on the Internet and made sure that 1-the Sql Broswer is runing and 2 - the UDP port 1434 is open.</p>\n\n<p>Anybody knows why? Thanks.</p>\n"},{"tags":["c#","xml","attributes","unity3d"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13272359,"title":"how to read and print specific attributes from xml c #","body":"<p>Lets say I have xml file:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;Test Description=\"Test XML\" VersionFormat=\"123\" ProtectedContentText=\"(Test test)\"&gt;\n    &lt;Testapp&gt;\n        &lt;TestappA&gt;\n            &lt;A Id=\"0\" Caption=\"Test 0\" /&gt;\n            &lt;A Id=\"1\" Caption=\"Test 1\" /&gt;\n            &lt;A Id=\"2\" Caption=\"Test 2\" /&gt;\n            &lt;A Id=\"3\" Caption=\"Test 3\"&gt;\n                &lt;AA&gt;\n                    &lt;B Id=\"4\" Caption=\"Test 4\" /&gt;\n                &lt;/AA&gt;\n            &lt;/A&gt;\n        &lt;/TestappA&gt;\n        &lt;AA&gt;\n            &lt;Reason Id=\"5\" Caption=\"Test 5\" /&gt;\n            &lt;Reason Id=\"6\" Caption=\"Test 6\" /&gt;\n            &lt;Reason Id=\"7\" Caption=\"Test 7\" /&gt;\n        &lt;/AA&gt;\n    &lt;/Testapp&gt;\n&lt;/Test&gt;\n</code></pre>\n\n<p>I need to read the values of attributes Caption from this xml without using LINQ as the purpose of this code is perform this in Unity3D, after spending all night to make this real I wrote a code which doesn't work. Please help! </p>\n\n<p>code snipped: </p>\n\n<pre><code>// XML settings\nXmlReaderSettings settings = new XmlReaderSettings();\nsettings.IgnoreWhitespace = true;\nsettings.IgnoreComments = true;                        \n\n// Loop through the XML to get all text from the right attributes\nusing (XmlReader reader = XmlReader.Create(sourceFilepathTb.Text, settings))\n{\n    while (reader.Read())\n    {\n        if (reader.NodeType == XmlNodeType.Element)\n        {\n            if (reader.HasAttributes)\n            {\n                if (reader.GetAttribute(\"Caption\") != null)\n                {                                \n                    MessageBox.Show(reader.GetAttribute(\"Caption\"));\n                }                            \n            }\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#",".net","entity-framework",".net-assembly"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13271262,"title":"Entity Framework meta data","body":"<p>I have a piece of code</p>\n\n<pre><code> using (InContext inContext = new InContext())\n</code></pre>\n\n<p>When I right click the definition, it points to <code>C:\\Users\\me\\AppData\\Local\\Temp\\....</code></p>\n\n<p>What is that? A defined dll?</p>\n\n<pre><code>    #region Assembly SharedObjects.dll, v4.0.30319\n   // C:\\source\\blah\\blah\\packages\\SharedObjects.1.0.4659.22817\\lib\\net40\\SharedObjects.dll\n    #endregion\n\n   using blahSharedObjects;\n   using System;\n   using System.Data.Entity;\n\n   namespace something\n   {\n       public class InContext : DbContext\n   {\n       public InContext();\n       public InContext(string connectionString);\n\n\n        public DbSet&lt;InDetails&gt; InDetailRecords { get; set; }\n        public string IPAddress { get; set; }\n\n        public string UserName { get; set; }\n\n   }\n</code></pre>\n\n<p>}</p>\n"},{"tags":["c#","html-agility-pack"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":43,"score":-2,"question_id":13272217,"title":"ArgumentNullException unhandled","body":"<p>I'm new to C#. I have an implicit typed variable defined like this:</p>\n\n<pre><code> var item = doc.DocumentNode.SelectNodes(\"//body[@id='person']\")\n                                  .Select(p =&gt; p.InnerText);\n</code></pre>\n\n<p>This var sometimes returns <code>null</code>. And that's where visual studio asks me to handle the <code>ArgumentNullException</code>. But if I do that my <code>var</code> remains unknown to the rest of my <code>try</code>-<code>catch</code> and I can no longer use it.</p>\n\n<p>Someone advised me to use the null object design pattern but I don't how am I supposed to implement it for a <code>var</code>. Does anyone know how I should handle such situations because I'm tired of handling the null case each and every time.</p>\n"},{"tags":["c#","multithreading","compression"],"answer_count":5,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1365,"score":2,"question_id":1211225,"title":"Multithreaded compression in C#","body":"<p>Is there a library in .net that does multithreaded compression of a stream? I'm thinking of something like the built in <code>System.IO.GZipStream</code>, but using multiple threads to perform the work (and thereby utilizing all the cpu cores).</p>\n\n<p>I know that, for example 7-zip compresses using multiple threads, but the C# SDK that they've released doesn't seem to do that.</p>\n"},{"tags":["c#","web-services"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13259236,"title":"Web Service background process without human interaction","body":"<p>I would like my web service to call a clean up routine every X hours, with no input from any user, or any call to \"Start Clean up Services\".  I understand I can call a method to start this service, but I want no user interaction at all.  I want to publish this service, and it automatically starts, and runs my clean up process every X hours.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["c#","process.start"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13272693,"title":"Launching a file using Process.Start works, but adding conditions does not","body":"<p>So I am trying to launch a printer script using cscript from C#, and cscript launches a visual basic file. So sort of a daisy chain (and I want to keep this daisy chain intact for certain reasons).</p>\n\n<p>Here's the code:</p>\n\n<pre><code>Process.Start(\"c:/windows/system32/cscript.exe c:/windows/System32/Printing_Admin_Scripts/en-US/prnport.vbs\");\n</code></pre>\n\n<p>Now, when I launch ONLY cscript, no problems.</p>\n\n<p>However when I add the condition of prnport.vbs to the cscript launch, I get this error in Visual Studio:</p>\n\n<pre><code>\"The system cannot find the file specified\"\n</code></pre>\n\n<p>But I can confirm the file path is correct - <code>prnport.vbs</code> DOES exist in <code>/en-US</code>.</p>\n\n<p>So what am I doing wrong here? Can you not pass arguments (and in this case, the file path is being passed as an argument to cscript.exe) when using Process.Start?</p>\n\n<p>New to C# and confused about the proper way to do this.</p>\n"},{"tags":["c#","process","parallel-processing","threadpool"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13270508,"title":"Parallel processing of large number of processes","body":"<p>I use a <code>ThreadPool</code> to execute several processes in parallel, like shown <a href=\"http://www.mindstick.com/Articles/8a6ce546-6516-46c7-9398-edc0d28a38f1/\" rel=\"nofollow\">here</a>\nwith a difference that I start my own process/program with some parameters. In few words, this program calculates some values and write them into a text file, which I compare afterwards.</p>\n\n<pre><code>public void StartProcess()\n{\n    string par = @\"-p \"\"foo\"\" -c 17\";\n    Process p = Process.Start(@\"C:\\MyProgramm.exe\", par); \n    p.EnableRaisingEvents = true;\n    p.Exited += new EventHandler(p_Exited);\n}\n\nvoid p_Exited(object sender, EventArgs e)\n{            \n    // Indicates that the process has been completed\n    this.doneEvent.Set();\n    Console.WriteLine(\"thread {0} end...\", ThreadIndex);\n}\n</code></pre>\n\n<p>For a small number of threads it works fine. In my case I must start about 200 threads, but in <code>WaitHandle.WaitAll</code> method I get a <code>NotSuppotedException</code> </p>\n\n<blockquote>\n  <p>The number of objects in waitHandles is greater than the system\n  permits.</p>\n</blockquote>\n\n<p>My question now is: Is there a possibility of <code>ThreadPool</code> class to manage a large number of threads? Something like a queue, starting new processes when other has been completed.\nTo be simple, in my case a process = thread.</p>\n"},{"tags":["c#","asp.net","gridview"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":600,"score":1,"question_id":7534335,"title":"Accessing GridView Cells Value","body":"<p>Hi I am trying to access the integer value of the first cell but i am getting this error</p>\n\n<pre><code>Unable to cast object of type 'System.Web.UI.WebControls.DataControlFieldCell' to type 'System.IConvertible'.\n</code></pre>\n\n<p>And the value i have stored in that cell is an ID like 810 </p>\n\n<p>My Code</p>\n\n<pre><code>int myID = Convert.ToInt32(GridView1.Rows[rowIndex].Cells[0]);\n</code></pre>\n"},{"tags":["c#","winforms","listview","listviewitem"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":342,"score":2,"question_id":3356224,"title":"C#: Prevent ListViewItem Image to be rendered selected","body":"<p>I was wondering whether it would be possible to have a ListView, in which items can be selected as usual with one difference. When a ListViewItem is selected, I would like to see the selection in the text label, however I would prefer the image to remain the same. The reason for this is, that currently the blue selection drawn ontop of the image looks horrible (the effect is even worse on transparent images!). </p>\n\n<p>I was hoping of not having to use the DrawItem handler, but I guess the hopes are slim. </p>\n\n<p>thanks a lot, </p>\n\n<p>best</p>\n\n<p>Frank</p>\n\n<p>EDIT: I thought I better add a screenshot showing the issue. I'm using the ListView in LargeIcon mode. </p>\n\n<p>** oups I'm not allowed to add pictures yet * so here the link to it. sorry for the inconvenience. <em>*</em> </p>\n\n<p><a href=\"http://cl.ly/adb9c6d29ffc0e2e1b5e\" rel=\"nofollow\">http://cl.ly/adb9c6d29ffc0e2e1b5e</a></p>\n\n<p>As you can see the selected element is 'Rate vs. Species'. However, I would love for the blue tint on the icon to disappear. </p>\n\n<p>Thanks again. </p>\n"},{"tags":["c#","data-binding","asp-classic","telerik","radgrid"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":11,"score":1,"question_id":13272290,"title":"Telerik RadGrid using Multiple Columns","body":"<p>I am having a problem with the RadGrid using Multiple Columns when I Bind a DataSource to the RadGrid. Firstly let me show some screenshots of what I am trying to do.</p>\n\n<p>This is an example from Teleriks website under demos and the multiple columns (summary column) is what I am trying to achieve \n<img src=\"http://i.stack.imgur.com/77UPN.png\" alt=\"RadGrid Example from Telerik/demo\"></p>\n\n<p>This is the exception I am getting when I try and bind the control to a DataSource</p>\n\n<p><img src=\"http://i.stack.imgur.com/gv7BA.png\" alt=\"RagGridException\"></p>\n\n<p>This is the RadGrid I have set up in my ASP page.</p>\n\n<p><img src=\"http://i.stack.imgur.com/tKaSv.png\" alt=\"RaGrid Asp\"></p>\n\n<p>Firstly I don't want to bind the datasource in my asp page. Secondly I wanted the \"Product\" and \"Other\" ColumnGroups to be used only as a Summary column and not to be bound to a datasource since these ColumnGroups are only used as headers for the other Columns.</p>\n\n<p>Is there a workaround to not allow the ColumnGroups not to be bound to a DataSource while the normal columns are?</p>\n"},{"tags":["c#",".net","diagram","system.drawing"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":1793,"score":3,"question_id":1993468,"title":"Creating Visio look-a-like diagrams programatically","body":"<p>I need to programatically create Visio look-a-like diagrams as a drawing. Mostly we are going to create network layout diagrams similar to this <a href=\"http://i.msdn.microsoft.com/Bb232815.a27c390d-e9d7-4b2d-97ef-ced4fa09856c%28ja-jp,office.12%29.gif\" rel=\"nofollow\">one</a>. </p>\n\n<p>Is there a component that could speed-up the development or some technique we could use? Generally we could do this on our own via System.Drawing, but this might get tricky for more complex network diagrams as we would have to ensure there are no visual overlappings. </p>\n\n<p><strong>UPDATE:</strong> No Visio available.\n<strong>UPDATE 2:</strong> I would love if these could be eye candy</p>\n"},{"tags":["c#","javascript","asp.net-mvc","signalr"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":4994,"score":1,"question_id":7594978,"title":"Using SignalR with ASP.NET MVC3","body":"<p>I'm attempting to use SignalR hubs in an application, but am having no luck currently. I've read through <a href=\"http://www.hanselman.com/blog/AsynchronousScalableWebApplicationsWithRealtimePersistentLongrunningConnectionsWithSignalR.aspx\" rel=\"nofollow\">Scott Hanselman's article</a>, and also looked at <a href=\"http://beyondrelational.com/modules/24/syndicated/370/Posts/9623/signalr-with-mvc3-chat-app-build-asynchronous-real-time-persistant-connection-websites.aspx\" rel=\"nofollow\">this</a> blog post which shows how to implement it in MVC, basically doing the same thing. Unfortunately, I'm having no luck. On the client side, the javascript seems to work fine [apart from nothing happening] but when I place breakpoints in the code it shows that the controller is being called, not the hub code. The code I'm using is this:</p>\n\n<pre><code>// Client side javascript:\nvar hooking;\n$(function() {\n    // Setup SignalR\n    hooking = $.connection.hooking;\n    hooking.removeLead = function(ref) {\n        $(\"lead\" + ref).remove();\n    };\n    $.connection.hub.start();\n    }\n});\n\n// Hooking.cs (placed in application root)\npublic class Hooking : Hub\n{\n    public void Submit(string jsonString)\n    {\n        var serializer = new JavaScriptSerializer();\n        var json = serializer.Deserialize&lt;HookingLeadResult&gt;(jsonString);\n        Clients.removeLead(json.Ref); // Remove lead from client hooking windows\n        // update lead gen\n    }\n}\n</code></pre>\n\n<p>When I call <code>hooking.submit(resultJson);</code> later in my code for some reason it calls the Index action of my HookingController (which is the current page). Anyone know how to correctly call the Submit function from Hooking.cs?</p>\n"},{"tags":["c#",".net","membership-provider","sqlmembershipprovider"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":13271544,"title":"writing custom membership provider","body":"<p>i am writing the custom membership provider class by implementing System.Web.Security.membershipprovider.</p>\n\n<p>now my problem is while accessing the class i am getting error as</p>\n\n<p>error code :</p>\n\n<pre><code>String reference not set to an instance of a String.\nParameter name: s\n</code></pre>\n\n<p>Stack trace:</p>\n\n<pre><code>   at System.Text.Encoding.GetBytes(String s)\n   at ss.Provider.EncodePassword(String password) \n   at ss.Provider.CreateUser(String username, String password, String email, String passwordQuestion, String passwordAnswer, Boolean isApproved, Object providerUserKey, MembershipCreateStatus&amp; status) \n   at System.Web.UI.WebControls.CreateUserWizard.AttemptCreateUser()\n   at System.Web.UI.WebControls.CreateUserWizard.OnNextButtonClick(WizardNavigationEventArgs e)\n   at System.Web.UI.WebControls.Wizard.OnBubbleEvent(Object source, EventArgs e)\n   at System.Web.UI.WebControls.CreateUserWizard.OnBubbleEvent(Object source, EventArgs e)\n   at System.Web.UI.WebControls.Wizard.WizardChildTable.OnBubbleEvent(Object source, EventArgs args)\n   at System.Web.UI.Control.RaiseBubbleEvent(Object source, EventArgs args)\n   at System.Web.UI.WebControls.Button.OnCommand(CommandEventArgs e)\n   at System.Web.UI.WebControls.Button.RaisePostBackEvent(String eventArgument)\n   at System.Web.UI.WebControls.Button.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument)\n   at System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument)\n   at System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData)\n   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)\n</code></pre>\n\n<p>and my class as</p>\n\n<p>create user:</p>\n\n<pre><code> public override MembershipUser GetUser(object userID,bool userIsOnline)\n        {\n            SqlConnection sqlConnection = new SqlConnection(connectionString);\n            SqlCommand sqlCommand = new SqlCommand(\"User_SelByUserID\", sqlConnection);\n\n            sqlCommand.CommandType = CommandType.StoredProcedure;\n            sqlCommand.Parameters.Add(\"@userID\", SqlDbType.UniqueIdentifier).Value = userID;\n\n            MembershipUser membershipUser = null;\n            SqlDataReader sqlDataReader = null;\n\n            try\n            {\n                sqlConnection.Open();\n\n                sqlDataReader = sqlCommand.ExecuteReader(CommandBehavior.CloseConnection);\n\n                if (sqlDataReader.HasRows)\n                {\n                    sqlDataReader.Read();\n                    membershipUser = GetUserFromReader(sqlDataReader);\n\n                    if (userIsOnline)\n                    {\n                        SqlCommand sqlUpdateCommand = new SqlCommand(\"User_UpdateActivityDate_ByUserID\", sqlConnection);\n\n                        sqlUpdateCommand.CommandType = CommandType.StoredProcedure;\n                        sqlUpdateCommand.Parameters.Add(\"@userID\", SqlDbType.NVarChar, 255).Value = userID;\n                        sqlUpdateCommand.Parameters.Add(\"@applicationName\", SqlDbType.NVarChar, 255).Value = applicationName;\n                        sqlUpdateCommand.ExecuteNonQuery();\n                    }\n                }\n            }\n            catch (SqlException e)\n            {\n                //Add exception handling here.\n            }\n            finally\n            {\n                if (sqlDataReader != null) { sqlDataReader.Close(); }\n            }\n\n            return membershipUser;\n\n        }\n</code></pre>\n\n<p>Encode password:</p>\n\n<pre><code>private string EncodePassword(string password)\n        {\n            string encodedPassword = password;\n\n            switch (PasswordFormat)\n            {\n                case MembershipPasswordFormat.Clear:\n                    break;\n                case MembershipPasswordFormat.Encrypted:\n                    encodedPassword = Convert.ToBase64String(EncryptPassword(Encoding.Unicode.GetBytes(password)));\n                    break;\n                case MembershipPasswordFormat.Hashed:\n                    HMACSHA1 hash = new HMACSHA1();\n                    hash.Key = HexToByte(machineKey.ValidationKey);\n                    encodedPassword = Convert.ToBase64String(hash.ComputeHash(Encoding.Unicode.GetBytes(password)));\n                    break;\n                default:\n                    throw new ProviderException(\"Unsupported password format.\");\n            }\n\n            return encodedPassword;\n        }\n</code></pre>\n\n<p>the password given string is Gowtham!1</p>\n\n<p>Updated:</p>\n\n<pre><code>  public override MembershipUser CreateUser(string username, string password, string email, string passwordQuestion, string passwordAnswer, bool isApproved, object providerUserKey, out MembershipCreateStatus status)\n        {\n\n            ValidatePasswordEventArgs args = new ValidatePasswordEventArgs(username, password, true);\n\n            OnValidatingPassword(args);\n\n            if (args.Cancel)\n            {\n                status = MembershipCreateStatus.InvalidPassword;\n                return null;\n            }\n\n            if ((RequiresUniqueEmail &amp;&amp; (GetUserNameByEmail(email) != String.Empty)))\n            {\n                status = MembershipCreateStatus.DuplicateEmail;\n                return null;\n            }\n\n            MembershipUser membershipUser = GetUser(username, false);\n\n            if (membershipUser == null)\n            {\n                System.DateTime createDate = DateTime.Now;\n\n                SqlConnection sqlConnection = new SqlConnection(connectionString);\n                SqlCommand sqlCommand = new SqlCommand(\"User_Ins\", sqlConnection);\n\n                sqlCommand.CommandType = CommandType.StoredProcedure;\n                sqlCommand.Parameters.Add(\"@returnValue\", SqlDbType.Int, 0).Direction = ParameterDirection.ReturnValue;\n                sqlCommand.Parameters.Add(\"@username\", SqlDbType.NVarChar, 255).Value = username; ;\n                sqlCommand.Parameters.Add(\"@applicationName\", SqlDbType.NVarChar, 255).Value = applicationName;\n                sqlCommand.Parameters.Add(\"@password\", SqlDbType.NVarChar, 255).Value = EncodePassword(password);\n                sqlCommand.Parameters.Add(\"@email\", SqlDbType.NVarChar, 128).Value = email;\n                sqlCommand.Parameters.Add(\"@passwordQuestion\", SqlDbType.NVarChar, 255).Value = passwordQuestion;\n                sqlCommand.Parameters.Add(\"@passwordAnswer\", SqlDbType.NVarChar, 255).Value = EncodePassword(passwordAnswer);\n                sqlCommand.Parameters.Add(\"@isApproved\", SqlDbType.Bit).Value = isApproved;\n                sqlCommand.Parameters.Add(\"@comment\", SqlDbType.NVarChar, 255).Value = String.Empty;\n\n                try\n                {\n                    sqlConnection.Open();\n\n                    sqlCommand.ExecuteNonQuery();\n                    if ((int)sqlCommand.Parameters[\"@returnValue\"].Value == 0)\n                    {\n\n                        status = MembershipCreateStatus.Success;\n                    }\n                    else\n                    {\n                        status = MembershipCreateStatus.UserRejected;\n                    }\n                }\n                catch (SqlException e)\n                {\n                    //Add exception handling here.\n\n                    status = MembershipCreateStatus.ProviderError;\n                }\n                finally\n                {\n                    sqlConnection.Close();\n                }\n\n                return GetUser(username, false);\n            }\n            else\n            {\n                status = MembershipCreateStatus.DuplicateUserName;\n            }\n\n            return null;\n        }\n</code></pre>\n"},{"tags":["c#","asp.net","gridview","csv"],"answer_count":1,"favorite_count":3,"up_vote_count":1,"down_vote_count":0,"view_count":6390,"score":1,"question_id":6674555,"title":"Export gridview data into CSV file","body":"<p>I have a gridview control in ASP.Net 2.0 and i need to export this gridview data into CSV file.</p>\n\n<p>I have bind this gridview with the dataset.After binding the dataset to the gridview i have done some changes in the gridview data like if I got 0 in dataset then i show 0 as \"Started\" in the gridview and if i got 1 in the dataset then I show 1 as \"Not Started\" in the gridview. </p>\n\n<p>So, i can't use dataset directly for exporting. What i need is..<strong>i want the code (in c#) that export my gridview data(not dataset's data) into CSV file.</strong></p>\n"},{"tags":["c#",".net","excel","usercontrols","vsto"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":198,"score":3,"question_id":12270735,"title":"Getting a handle to a NamedRange control in C#","body":"<p>I'm developing an application-level AddIn for Excel 2007 using C# (.NET 4.0). Questions similar to this one have been previously asked >></p>\n\n<p><a href=\"http://stackoverflow.com/questions/11374023/resizing-namedrange-throws-a-controlnotfoundexception\">Resizing NamedRange throws a ControlNotFoundException</a></p>\n\n<p><a href=\"http://stackoverflow.com/questions/7152020/c-sharp-excel-addin-accessing-controls\">C# excel addin - Accessing Controls</a></p>\n\n<p>but the responses to them (where there were any) did not work for me. So I would like to give a detailed description of what I'm trying to do, and what happens when I try to do it.</p>\n\n<p>Very briefly, my problem is that I'm not able to get hold of NamedRange control objects for modifying them, after they have been instantiated and initialized elsewhere in the code.</p>\n\n<p>Please read on for a more complete description.</p>\n\n<p>When the AddIn starts, it creates a NamedRange control and attaches it to some cells on a particular worksheet >></p>\n\n<pre><code>Worksheet worksheet = Globals.Factory.GetVstoObject(\n                Globals.ThisAddIn.Application.ActiveWorkbook.ActiveSheet);\nExcel.Range cell = worksheet.Range[\"A1\"];\n_configParams.HeaderNamedRange = worksheet.Controls.AddNamedRange(cell, \"HeaderCells\");\n_configParams.HeaderNamedRange.RefersTo = \"=\" + worksheet.Name + \"!$A$1:$A$5\";\n</code></pre>\n\n<p>After the AddIn has started, I want to allow the User to re-specify the cells to which this NamedRange control can point. In order to do so, I'm getting the User to select a range of cells and then get hold of the selected cells' location (as a String) in a suitable event-handler method.</p>\n\n<p>I then intend to programmatically re-specify the cells that the above NamedRange control points to. I have tried the following approaches, but neither of them work.</p>\n\n<p>[Approach 1]</p>\n\n<pre><code>Worksheet controlWorksheet = Globals.Factory.GetVstoObject(Globals.ThisAddIn.Application.ActiveWorkbook.ActiveSheet);\n((NamedRange)(controlWorksheet.Controls[\"HeaderCells\"])).RefersTo = newHeaderCellsLocation;\n</code></pre>\n\n<p>On running the above code, it throws a ControlNotFoundException, and I get the following message:</p>\n\n<pre><code>Microsoft.VisualStudio.Tools.Applications.Runtime.ControlNotFoundException was unhandled by user code\n  Message=This document might not function as expected because the following control is missing: PortfolioHeaderCells. Data that relies on this control will not be automatically displayed or updated, and other custom functionality will not be available. Contact your administrator or the author of this document for further assistance.\n  Source=Microsoft.Office.Tools.Excel.Implementation\n  StackTrace:\n       at Microsoft.Office.Tools.Excel.NamedRangeImpl.GetObjects()\n       at Microsoft.Office.Tools.Excel.NamedRangeImpl.EnsureProxy()\n       at Microsoft.Office.Tools.Excel.NamedRangeImpl.get_Proxy()\n       at Microsoft.Office.Tools.Excel.NamedRangeImpl.AttachSupport()\n       at Microsoft.Office.Tools.Excel.NamedRangeImpl.ResetControl()\n       at Microsoft.Office.Tools.Excel.NamedRangeImpl.set_RefersTo(String value)\n       at ExcelListenerAddIn.Configuration.ListenerConfigManager.ActivateListenerConfiguration(ListenerConfigParams newConfiguration, Boolean cameFromConfigFile) in C:\\Users\\jag201\\Documents\\Visual Studio 2010\\Projects\\PoC\\ExcelListenerAddIn\\Configuration\\ListenerConfigManager.cs:line 97\n       at ExcelListenerAddIn.TaskPanes.ListenerConfigurator._activateNewConfigButton_Click(Object sender, EventArgs e) in C:\\Users\\jag201\\Documents\\Visual Studio 2010\\Projects\\PoC\\ExcelListenerAddIn\\TaskPanes\\ListenerConfigurator.cs:line 131\n       at System.EventHandler.Invoke(Object sender, EventArgs e)\n       at System.Windows.Forms.Control.OnClick(EventArgs e)\n       at System.Windows.Forms.Button.OnClick(EventArgs e)\n       at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)\n       at System.Windows.Forms.Control.WmMouseUp(Message&amp; m, MouseButtons button, Int32 clicks)\n       at System.Windows.Forms.Control.WndProc(Message&amp; m)\n       at System.Windows.Forms.ButtonBase.WndProc(Message&amp; m)\n       at System.Windows.Forms.Button.WndProc(Message&amp; m)\n       at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message&amp; m)\n       at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp; m)\n       at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)\n  InnerException: System.Runtime.InteropServices.COMException\n       Message=Exception from HRESULT: 0x800A03EC\n       Source=Microsoft.VisualStudio.Tools.Office.Runtime\n       ErrorCode=-2146827284\n       StackTrace:\n            at Microsoft.VisualStudio.Tools.Office.Runtime.Interop.IHostItemProvider.GetHostObject(String primaryType, String primaryCookie, IntPtr&amp; hostObject)\n            at Microsoft.VisualStudio.Tools.Office.Runtime.DomainCreator.ExecuteCustomization.Microsoft.Office.Tools.IHostItemProvider.GetHostObject(Type primaryType, String primaryCookie)\n            at Microsoft.Office.Tools.Excel.NamedRangeImpl.GetObjects()\n       InnerException:\n</code></pre>\n\n<p>[Approach 2]</p>\n\n<p>I then saw <a href=\"http://stackoverflow.com/questions/2416727/set-excel-named-ranges-via-c\">Set Excel Named Ranges via C#?</a> and so tried to use the approach described in the answer there:</p>\n\n<pre><code>Worksheet controlWorksheet = Globals.Factory.GetVstoObject(Globals.ThisAddIn.Application.ActiveWorkbook.ActiveSheet);\ncontrolWorksheet.Names.Item(\"HeaderCells\", Type.Missing, Type.Missing).RefersTo = newHeaderCellsLocation;\n</code></pre>\n\n<p>On running the above code, I get the following exception and message:</p>\n\n<pre><code>System.Runtime.InteropServices.COMException was unhandled by user code\n  Message=Exception from HRESULT: 0x800A03EC\n  Source=\"\"\n  ErrorCode=-2146827284\n  StackTrace:\n       at System.RuntimeType.ForwardCallToInvokeMember(String memberName, BindingFlags flags, Object target, Int32[] aWrapperTypes, MessageData&amp; msgData)\n       at Microsoft.Office.Interop.Excel.Names.Item(Object Index, Object IndexLocal, Object RefersTo)\n       at ExcelListenerAddIn.Configuration.ListenerConfigManager.ActivateListenerConfiguration(ListenerConfigParams newConfiguration, Boolean cameFromConfigFile) in C:\\Users\\jag201\\Documents\\Visual Studio 2010\\Projects\\PoC\\ExcelListenerAddIn\\Configuration\\ListenerConfigManager.cs:line 97\n       at ExcelListenerAddIn.TaskPanes.ListenerConfigurator._activateNewConfigButton_Click(Object sender, EventArgs e) in C:\\Users\\jag201\\Documents\\Visual Studio 2010\\Projects\\PoC\\ExcelListenerAddIn\\TaskPanes\\ListenerConfigurator.cs:line 131\n       at System.EventHandler.Invoke(Object sender, EventArgs e)\n       at System.Windows.Forms.Control.OnClick(EventArgs e)\n       at System.Windows.Forms.Button.OnClick(EventArgs e)\n       at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)\n       at System.Windows.Forms.Control.WmMouseUp(Message&amp; m, MouseButtons button, Int32 clicks)\n       at System.Windows.Forms.Control.WndProc(Message&amp; m)\n       at System.Windows.Forms.ButtonBase.WndProc(Message&amp; m)\n       at System.Windows.Forms.Button.WndProc(Message&amp; m)\n       at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message&amp; m)\n       at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp; m)\n       at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)\n  InnerException:\n</code></pre>\n\n<p>So, in both approaches, the exception from HRESULT is the same: 0x800A03EC. Also, the exception is being thrown in the line where I try to get hold of the NamedRange control and re-specify the cells it points to.</p>\n\n<p>I have stepped through my code, and a NamedRange control does indeed exist where/when I try to modify the NamedRange object.</p>\n\n<p>I then checked the type of the <code>controlWorksheet.Controls[\"HeaderCells\"]</code> object using the following code >></p>\n\n<pre><code>Worksheet controlWorksheet = Globals.Factory.GetVstoObject(Globals.ThisAddIn.Application.ActiveWorkbook.ActiveSheet);\nSystem.Windows.Forms.MessageBox.Show((controlWorksheet.Controls[\"HeaderCells\"]).ToString());\n</code></pre>\n\n<p>This results in a MessageBox containing \"Microsoft.Office.Tools.Excel.NamedRangeImpl\". If I'm not mistaken, this Type is not exposed by the Excel Object Model, and so I wonder if the problem is being caused by my casting a NamedRangeImpl object to a NamedRange control object.</p>\n\n<p>Your help is much appreciated. If there is any further information that I can provide, please let me know. Thanks in advance!</p>\n"},{"tags":["c#",".net","winrt",".net-4.5"],"answer_count":1,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":1889,"score":7,"question_id":7596919,"title":"WinRT - TCP clients?","body":"<p>I am building an IRC client in the new WinRT <code>(.NET 4.5</code>) framework for Windows 8 Metro applications.</p>\n\n<p>However, I have some issues. I've already figured out that I need to use a <code>StreamSocket</code> to read TCP data, but I may be doing something wrong.</p>\n\n<p>The reason I believe this is because I am not receiving any data.</p>\n\n<p>Below you see my code. I haven't been able to find any code samples on the web regarding this.</p>\n\n<pre><code>class IRCClient\n{\n    private StreamSocket tcpClient;\n    public string Server = \"holmes.freenode.net\";\n    public int Port = 6665;\n\n    public IRCClient()\n    {\n        tcpClient = new StreamSocket();\n    }\n\n    public async void Connect()\n    {\n        await tcpClient.ConnectAsync(\n                         new Windows.Networking.HostName(Server), \n                         Port.ToString(), \n                         SocketProtectionLevel.PlainSocket);\n\n        DataReader reader = new DataReader(tcpClient.InputStream);\n        string data = reader.ReadString(reader.UnconsumedBufferLength);\n\n        MessageDialog dialog = new MessageDialog(data);            \n    }\n}\n</code></pre>\n\n<p>Data is always an empty string following that code. Furthermore, UnconsumedBufferLength always returns 0.</p>\n\n<p>How come?</p>\n"},{"tags":["c#","vb.net","printing","serial-port","thermal-printer"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":116,"score":0,"question_id":11978254,"title":"Capture Thermal Printer Data from www.dpd.co.uk to PDF","body":"<p>I am trying to achieve the following:</p>\n\n<ul>\n<li>Put a shipment into www.dpd.co.uk</li>\n<li>When the shipping label is about to be printed, capture the data that is going to be sent to the Citizen thermal printer</li>\n<li>Turn this data into a PDF file</li>\n<li>Save this PDF into a PNG file for use later (Already have code for this).</li>\n</ul>\n\n<p>So, I need help with <b>capturing data</b> that would usually be sent via COM Port to the Thermal Printer and put what would come out on the label into a PDF.</p>\n\n<p>I am open to try ANY coding engines (VB.net, C#, etc)</p>\n"},{"tags":["c#","asp.net","drop-down-menu","selectedvalue","databound"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1661,"score":2,"question_id":6746745,"title":"Setting SelectedValue of a data bound DropDownList","body":"<p>I have an asp.net dropDownList which is automatically bound to a sqlDataSource to values of client type on page load. On page load I am also creating a Client object, one of it's properties is ClientType. I am trying to set the SelectedValue of the ddl according to the value of the ClientType property of the Client object unsuccessfully. I recieve the following error message  \"System.ArgumentOutOfRangeException: 'ddlClientType' has a SelectedValue which is invalid because it does not exist in the list of items\". I understand that this is because the list has not yet been populated when I'm trying to set the selected value. Is there a way of overcoming this problem? Thank you! </p>\n"},{"tags":["c#"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":37,"score":-1,"question_id":13272322,"title":"System.InvalidOperationException: Category does not exist","body":"<pre><code>var performanceCounterCategory = new PerformanceCounterCategory(\"Network Interface\")\n{\n   MachineName = target.FullyQualifiedDomainName\n};\nWindowsUserImpersonator impersonator = null;\ntry\n{\n    // impersonate user if required\n    impersonator = GetImpersonator();\n    performanceCounterCategory.ReadCategory();// exeption\n    var interfaces = performanceCounterCategory.GetInstanceNames();\n    var length = interfaces.Length;\n    netBytesTotalPerSecCountersField = new List&lt;PerformanceCounter&gt;();\n    for (var i = 0; i &lt; length; i++)\n    {\n        if (interfaces[i].Contains(\"Loopback\"))\n        {\n            continue;\n        }\n        var counter = new PerformanceCounter\n        {\n            MachineName = target.FullyQualifiedDomainName,\n            CategoryName = \"Network Interface\",\n            CounterName = \"Bytes Total/sec\",\n            InstanceName = interfaces[i]\n        };\n</code></pre>\n\n<p>It works fine with some windows machines, but does not work with others. For example, it works fine with win 7 ultimate but throws an exeption for win 7 enterprise. What's wrong? Why would it work with some and not work with others?</p>\n"},{"tags":["c#","wpf","mvvm","outlook"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13251705,"title":"Failing to create an email with outlook interop when outlook has already been opened","body":"<p>How do you open an outlook window? I tried the code below but this doesn't work when an instance of outlook is already running - </p>\n\n<pre><code>System.Diagnostics.Process[] processes = System.Diagnostics.Process.GetProcessesByName(\"OUTLOOK\");\n\nint processCount = processes.Length;\nif (processCount != 0)\n{\n    **outlookApp = Marshal.GetActiveObject(\"Outlook.Application\") as Microsoft.Office.Interop.Outlook.Application;** this is throwing the below error **\n}\nelse\n{\n    outlookApp = new Microsoft.Office.Interop.Outlook.Application();\n}\n</code></pre>\n\n<p>And I got:</p>\n\n<pre><code>Error:\nOperation unavailable (Exception from HRESULT: 0x800401E3 (MK_E_UNAVAILABLE))\n</code></pre>\n\n<p>Can someone please give an alternate approach or changes to the above code?</p>\n"},{"tags":["c#","serial-port"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13260710,"title":"Byte array not being initialized to correct size?","body":"<p>I am writing an application that receives some input from a long range radio via a serial connection. I am currently using the SerialPort C# class to receive and send data, but I am having a few issues. I've noticed that the function I have for receiving data is not correctly setting the buffer byte array size. All data is being sent in bytecode (Hex). </p>\n\n<p>Say the other node sends 103 bytes of data. Stepping through my code and setting a breakpoint at the \"Read()\" line, I see that \"serialPort1.BytesToRead-1\" evaluates to 103, BUT the byte[] array is only initialized to 17. I have no explanation for this behavior. As a result, only the first 17 bytes are put into the array. Continuing through the step through, this same event is triggered, this time with \"serialPort1.BytesToRead-1\" evaluating to 85 (presumably since only the first 17 of the 103 bytes were read.</p>\n\n<p>If I hardcore the data array size at 103, it works flawlessly in one pass. However, at the moment I am unable to store all the data in my byte array in one pass, which is causing a lot of problems. Anyone know why my byte array is being initialized to such an arbitrary size???</p>\n\n<pre><code>private void serialPort1_DataReceived(object sender, SerialDataReceivedEventArgs e)\n{\n        byte[] data = new byte[serialPort1.BytesToRead - 1];\n        serialPort1.Read(data, 0, data.Length);\n        DisplayData(ByteToHex(data) /*+ \"\\n\"*/);\n}\n</code></pre>\n"},{"tags":["c#","asp.net",".net","vb.net"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13271611,"title":"What are the things that i have to Do and Don't when an application to be Globalized and Localized?","body":"<p><strong>What are the areas we needed to change in the code when an application to be Globalized and Localized?</strong></p>\n\n<p>For example</p>\n\n<p><strong>Do</strong></p>\n\n<pre><code>string datenew = Convert.ToDateTime(\"10/31/2012\", CultureInfo.InvariantCulture)\n                        .ToString();\n</code></pre>\n\n<p><strong>Don't</strong></p>\n\n<pre><code>string datenew = Convert.ToDateTime(\"10/31/2012\").ToString();\n</code></pre>\n"},{"tags":["c#","serial-port","clear"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13268001,"title":"C# serial port clear","body":"<p>I need to achieve this statement on serial port communication:</p>\n\n<blockquote>\n<pre><code>SUCCESS   Purge: TXCLEAR RXCLEAR  \n</code></pre>\n</blockquote>\n\n<p>But when I call <code>mySerialPort.discartInBuffer();</code> or  <code>mySerialPort.discartOutBuffer();</code>, all I got is this:</p>\n\n<blockquote>\n<pre><code>SUCCESS   Purge: RXABORT RXCLEAR  \nSUCCESS   Purge: TXABORT TXCLEAR\n</code></pre>\n</blockquote>\n\n<p>Is there any way to call both clear commands as it is in first example?\n(Communication was sniffed via PortMon)</p>\n\n<p>Appreciate you help, thanks. </p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13272267,"title":"Programatically execute Ctrl-H","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/7307868/c-sharp-simulate-key-press\">C# Simulate Key Press</a>  </p>\n</blockquote>\n\n\n\n<p>I need a way in C# to \"type\" <kbd>Ctrl</kbd>+<kbd>H</kbd> in code when a user clicks a button.  I am working on a Word addin that customizes the ribbon.  When a user clicks my \"Replace\" button, I want the Replace dialog to show.  I can't figure out how to get to that dialog box, but <kbd>Ctrl</kbd>+<kbd>H</kbd> brings it up.  Is there a way to do that?</p>\n"},{"tags":["c#","winforms","clickonce"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":14,"score":2,"question_id":13272174,"title":"ClickOnce deployed application has blinking cursor but no focus","body":"<p>We have an application deployed via ClickOnce which has a weird problem.  When you start the application and we show our login dialog the User name field will have a blinking cursor as if the control has focus but as soon as you start typing nothing happens.  You have to actually click the dialog window to give it focus.  </p>\n\n<p>If you click away again though the User name field won't have a blinking cursor anymore so it's almost like the control has focus but not really?</p>\n\n<p>Has anyone ran into this problem?  We need our app to have focus when it starts...</p>\n\n<p>One thing to mention is we're actually using a UI framework (XF.UI.Smart) which has a ShellPresenter/ShellView idea.  The shell is being hidden while the login dialog shows.  Could this hiding of the main window be the problem?</p>\n"},{"tags":["c#",".net","vb.net"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":60,"score":0,"question_id":13272056,"title":"FormatNumber for c#","body":"<p>Im struggling to get the right syntax to use in c# for the vb function FormatNumber...i will say that 'iPremium' is an object as it returns data from a tableadapter.</p>\n\n<p>the value that 'ipremium' holds is 943.4000 and the idea is to only have two decimal places after the '.', i would hope this is acheivable using the right syntax but unfortunately not being a c# expert, it could take a while to figure this out.</p>\n\n<p>here's the vb code:</p>\n\n<pre><code>  iPremium = FormatNumber(iPremium, 2, TriState.True)\n</code></pre>\n\n<p>any idea's on how this is acheivable? </p>\n\n<p>thanks for any idea's and suggestions and excuse the ignorance if this is not worded correctly</p>\n"},{"tags":["c#",".net","excel","sharepoint","pia"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1853,"score":4,"question_id":6960693,"title":"Excel process doesn't get closed","body":"<p>I know similar questions have been asked before but I still need to ask this question as I am not able to get my EXCEL (32) process closed once I am done using it.</p>\n\n<p>As you can see in the code below, once <code>ProcessRFAFData</code> function finishes its execution, the EXCEL process doesn't get closed (I can still see <code>EXCEL.EXE*32</code> in the task manager).</p>\n\n<p>For this reason, when <code>SaveErrors</code> starts its execution, I get the following exception:</p>\n\n<p><code>System.Runtime.InteropServices.COMException (0x800A03EC):<br>\nMicrosoft Office Excel cannot open or save any more documents because there is not enough available memory or disk space.<br>\n• To make more memory available, close workbooks or programs you no longer need.<br>\n• To free disk space, delete files you no longer need from the disk you are saving to.<br>\nat Microsoft.Office.Interop.Excel.Workbooks.Add(Object Template)<br>\nat NextG.RFAFImport.Layouts.NextG.RFAFImport.RFAFDataImporter.&lt;&gt;c__DisplayClass9.b__6()<br>\nat Microsoft.SharePoint.SPSecurity.&lt;&gt;c__DisplayClass4.b__2()<br>\nat Microsoft.SharePoint.Utilities.SecurityContext.RunAsProcess(CodeToRunElevated secureCode)<br>\nat Microsoft.SharePoint.SPSecurity.RunWithElevatedPrivileges(WaitCallback secureCode, Object param)<br>\nat Microsoft.SharePoint.SPSecurity.RunWithElevatedPrivileges(CodeToRunElevated secureCode)<br>\nat NextG.RFAFImport.Layouts.NextG.RFAFImport.RFAFDataImporter.SaveErrors()</code></p>\n\n<p>Here is the code that executes the Excel processes:</p>\n\n<pre><code>try {\n    ProcessRFAFData(FileName);\n} catch (Exception ex) {\n    Status = \"ERROR: \" + ex.ToString();\n}\n\nif (Errors.Count() &gt; 0) {\n    SaveErrors();\n}\n</code></pre>\n\n<p>Here are all the functions interacting with Excel:</p>\n\n<pre><code>private void ReleaseObject(object obj) {\n    try {\n        System.Runtime.InteropServices.Marshal.ReleaseComObject(obj);\n        obj = null;\n    } catch (Exception) { } finally {\n        GC.Collect();\n    }\n}\n\nprivate void ProcessRFAFData(string FileName) {\n    Microsoft.Office.Interop.Excel.Application XLA = null;\n    Microsoft.Office.Interop.Excel.Workbook XLW = null;\n    Microsoft.Office.Interop.Excel.Worksheet XLS = null;\n\n    bool error = false;\n\n    try {\n        SPSecurity.RunWithElevatedPrivileges(delegate() {\n            XLA = new Microsoft.Office.Interop.Excel.Application();\n            XLW = XLA.Workbooks.Open(FileName, 0, true,\n                Type.Missing, null, null, true, Microsoft.Office.Interop.Excel.XlPlatform.xlWindows,\n                Type.Missing, false, false, Type.Missing, false, Type.Missing, Type.Missing);\n\n            int index = RFAFTabExists(ref XLW);\n            if (index == 0) return;\n\n            XLS = (Microsoft.Office.Interop.Excel.Worksheet)XLW.Worksheets.get_Item(index);\n\n            if (!ValidProjectID(ref XLS)) return;\n\n            ParseData(ref XLS);\n\n            XLW.Close(true, Type.Missing, Type.Missing);\n            XLA.Quit();\n\n            ReleaseObject(XLS);\n            ReleaseObject(XLW);\n            ReleaseObject(XLA);\n        });\n    } catch (SP.ServerException ex) {\n        // output error\n    } catch (Exception ex) {\n        // output error\n    }\n}\n\nprivate int RFAFTabExists(ref Microsoft.Office.Interop.Excel.Workbook XLW) {\n    int index = 0;\n    foreach (Microsoft.Office.Interop.Excel.Worksheet w in XLW.Worksheets) {\n        if (w.Name.Equals(settings.Collection[\"RFAFTabName\"])) index++;\n    }\n\n    return index;\n}\n\nprivate bool ValidProjectID(ref Microsoft.Office.Interop.Excel.Worksheet XLS) {\n    using (SP.ClientContext CTX = new SP.ClientContext(SiteURL)) {\n        var projectId = XLS.Cells.get_Range(settings.Collection[\"ProjectIDCell\"], Type.Missing).Text.ToString();\n\n        var project = // getting list of projects from SharePoint\n\n        if (project.Count() &gt; 0) {\n            ProjectID = XLS.Cells.get_Range(settings.Collection[\"ProjectIDCell\"], Type.Missing).Text.ToString();\n            return true;\n        }\n    }\n\n    return false;\n}\n\nprivate void ParseData(ref Microsoft.Office.Interop.Excel.Worksheet XLS) {\n    ListData.Add(\"HID\", GetHID(XLS.Cells.get_Range(settings.Collection[\"HIDCell\"],\n        Type.Missing).Text.ToString()));\n\n    if (ListData[\"HID\"].Equals(\"0\")) Errors.Add(new ImportError {\n        Reason = \"Hub ID does not exist in this project workspace.\",\n        Reference = string.Format(\"Hub ID: {0}\", XLS.Cells.get_Range(settings.Collection[\"HIDCell\"],\n        Type.Missing).Text.ToString())\n    });\n\n    int row = Int32.Parse(settings.Collection[\"StartRow\"]);\n    while (!NoMoreData(ref XLS, row)) {\n        string PRSIN = XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"PRSIN\"], row), Type.Missing).Text.ToString();\n\n        string NOC = ValidateNumber(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"NOC\"], row), Type.Missing).Text.ToString());\n\n        string UEIRP = ValidateNumber(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"UEIRP\"], row), Type.Missing).Text.ToString());\n\n        string LAT = ValidateLatLon(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"LAT\"], row), Type.Missing).Text.ToString());\n\n        string LON = ValidateLatLon(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"LON\"], row), Type.Missing).Text.ToString());\n\n        string PJ = GetPJ(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"JurisdictionCol\"], row), Type.Missing).Text.ToString(),\n            XLS.Cells.get_Range(string.Format(\"{0}{1}\", settings.Collection[\"StateCol\"], row),\n            Type.Missing).Text.ToString());\n\n        string ST = GetState(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"JurisdictionCol\"], row), Type.Missing).Text.ToString(),\n            XLS.Cells.get_Range(string.Format(\"{0}{1}\", settings.Collection[\"StateCol\"], row),\n            Type.Missing).Text.ToString());\n\n        ListItemData.Add(new ListItem {\n            ProposedRemoteSiteItemNumber = PRSIN,\n            NumberOfCarriers = NOC,\n            UsableEIRP = UEIRP,\n            Latitude = LAT,\n            Longitude = LON,\n            PrimaryJurisdiction = PJ,\n            State = ST\n        });\n\n        row++;\n    }\n}\n\nprivate bool NoMoreData(ref Microsoft.Office.Interop.Excel.Worksheet XLS, int row) {\n    return string.IsNullOrEmpty(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n        settings.Collection[\"ProposedRemoteSiteItemNumberCol\"], row), Type.Missing).Text.ToString());\n}\n\nprivate void SaveErrors() {\n    Microsoft.Office.Interop.Excel.Application XLA = null;\n    Microsoft.Office.Interop.Excel.Workbook XLW = null;\n    Microsoft.Office.Interop.Excel.Worksheet XLS = null;\n\n    object MissingValue = System.Reflection.Missing.Value;\n\n    try {\n        try {\n            SPSecurity.RunWithElevatedPrivileges(delegate() {\n                XLA = new Microsoft.Office.Interop.Excel.Application();\n                XLW = XLA.Workbooks.Add(MissingValue);\n                XLS = (Microsoft.Office.Interop.Excel.Worksheet)XLW.Worksheets.get_Item(1);\n\n                XLS.Cells[1, 1] = \"Reason for error\";\n                XLS.Cells[1, 2] = \"Reference\";\n\n                XLS.get_Range(\"A1\").Font.Bold = true;\n                XLS.get_Range(\"B1\").Font.Bold = true;\n\n                int row = 2;\n                foreach (ImportError e in Errors) {\n                    XLS.Cells[row, 1] = e.Reason;\n                    XLS.Cells[row, 2] = e.Reference;\n\n                    row++;\n                }\n\n                XLW.SaveAs(ErrorLogFileName, Microsoft.Office.Interop.Excel.XlFileFormat.xlWorkbookNormal,\n                    MissingValue, MissingValue, MissingValue, MissingValue,\n                    Microsoft.Office.Interop.Excel.XlSaveAsAccessMode.xlExclusive, MissingValue,\n                    MissingValue, MissingValue, MissingValue, MissingValue);\n\n                XLW.Close(true, MissingValue, MissingValue);\n                XLA.Quit();\n\n                ReleaseObject(XLS);\n                ReleaseObject(XLW);\n                ReleaseObject(XLA);\n            });\n        } catch (Exception ex) {\n            Status = \"ERROR: \" + ex.ToString();\n        }\n\n        // Uploading excel file to SharePoint document library\n\n    } catch (Exception) { }\n}\n</code></pre>\n\n<p>I would really appreciate any help you can provide me in this.</p>\n"},{"tags":["c#","windows","file-locking"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":632,"score":1,"question_id":7007671,"title":"File.Open for read access denied on executing file in Windows","body":"<p>I have a problem with file permissions on executing files in Windows that seems to be solved after following a forum tip[1], but I cannot understand why. Maybe you guys can help.</p>\n\n<p>I'm checking the banner of a file by executing it (reading the console output) and then opening the same file for reading afterwards using FileStream:</p>\n\n<pre><code>public void fileMD5(string filename) {\n  if (!File.Exists(filename)) return NT.Fail(\"File does not exist: \" + filename);\n\n  BinaryReader stream = new BinaryReader(File.Open(filename,\n      FileMode.Open, FileAccess.Read, FileShare.ReadWrite));\n  int bufferSize = 4096;\n  byte[] buffer = new byte[bufferSize];\n  int readBytes;\n  while ((readBytes = stream.Read(buffer, 0, bufferSize)) &gt; 0) {\n    md5Hasher.TransformBlock(buffer, 0, readBytes, buffer, 0);\n  }\n  stream.Close();\n}\n\nfileMD5('sample.exe');\n</code></pre>\n\n<p>and every once in a while I would get \"file is being used by another process\". From Wikipedia I know that Windows will set a lock on executing files denying write access[2], but I'm only reading. Also the process should have stopped already when I try to open it.</p>\n\n<p>From the forum post it would seem that adding a FileShare.ReadWrite would help and it seems that It does:</p>\n\n<pre><code>FileStream stream = File.Open('sample.exe', \n    FileMode.Open, FileAccess.Read, FileShare.ReadWrite);\n</code></pre>\n\n<p>But I don't understand why. Is there a race condition here that I don't see?</p>\n\n<p>Also the File.Open call seems to be much quicker with FileShare.ReadWrite instead of the default (which I guess is FileShare.Read).</p>\n\n<p>[1] <a href=\"http://www.xtremevbtalk.com/archive/index.php/t-192118.html\" rel=\"nofollow\">http://www.xtremevbtalk.com/archive/index.php/t-192118.html</a></p>\n\n<p>[2] <a href=\"http://en.wikipedia.org/wiki/File_locking#In_Microsoft_Windows\" rel=\"nofollow\">http://en.wikipedia.org/wiki/File_locking#In_Microsoft_Windows</a></p>\n"},{"tags":["c#","unity3d","gree"],"answer_count":3,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":57,"score":6,"question_id":13269246,"title":"Is there something like python decorators for c#?","body":"<p>I am wrapping calls to an API and most of my methods have in their first lines:</p>\n\n<pre><code>if ( !Gree.Authorizer.IsAuthorized() )\n{\n    return;\n}\n</code></pre>\n\n<p>In python I would decorate those methods with something like <code>@login_required</code>.</p>\n\n<p>What would you use to refactor that type of logic in <code>c#</code>?</p>\n"},{"tags":["c#","asp.net","web-services",".net-3.5","ninject"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13269324,"title":"Ninject .Net 3.5 SOAP Webservice issues","body":"<p>this is my first time posting up here and trust me I have searched high and low for an answer to my question but have had very little success.</p>\n\n<p>Background: I have currently started trying to re-factor our existing SOAP web service (.Net 3.5) in order to do some IOC and DI using Ninject.  I have a CacheManager which I am trying to initalize in the web method, however the injection does not seem to kick in.</p>\n\n<p>I have an console application that calls the webservice with the below:</p>\n\n<pre><code>static void Main(string[] args)\n    {\n        TestService service = new CachingService.TestService();\n\n        DataResult result = service.GetSomething(1);\n    }\n</code></pre>\n\n<p>The webservice is below: TestService.asmx.cs</p>\n\n<pre><code>[WebMethod(Description = \"Get something\")]\npublic DataResult GetSomething(int param)\n{\n    try\n    {\n        return this.CacheManager.Get();\n    }\n    catch (Exception ex)\n    {\n        throw;\n    }\n}\n</code></pre>\n\n<p>Base.cs (TestService.asmx.cs inherits Base to initialize CacheManager)</p>\n\n<pre><code>public class Base\n{\n    [Inject]\n    public ICacheManager CacheManager\n    {\n        get\n        {\n            if (cacheProxy == null)\n            {\n                cacheProxy = new CacheProxy();\n            }\n            return cacheProxy.CacheManager;\n        }\n    }  \n}\n</code></pre>\n\n<p>CacheProxy.cs</p>\n\n<pre><code>public class CacheProxy\n{\n    [Inject]\n    public ICacheManager CacheManager { get; set; }\n}\n</code></pre>\n\n<p>CacheManager.cs</p>\n\n<pre><code>public class CacheManager : ICacheManager\n{\n   //implements iCacheManager methods\n}\n</code></pre>\n\n<p>App_Start/NinjectWebCommon.cs</p>\n\n<pre><code>private static void RegisterServices(IKernel kernel)\n    {\nkernel.Bind&lt;ICacheManager&gt;()\n            .ToMethod(x =&gt; x.Kernel.Get&lt;ICacheManagerFactoryBuilder&gt;().GetCacheManagerFactory().CreateCacheManager())\n            .InRequestScope();\n}\n</code></pre>\n\n<p>CacheManagerFactoryBuilder.cs</p>\n\n<pre><code>public class CacheManagerFactoryBuilder : ICacheManagerFactoryBuilder\n{\n    private ICacheManagerFactory _Factory;\n\n    public CacheManagerFactoryBuilder(ICacheManagerFactory factory)\n    {\n        _Factory = factory;\n    }\n\n    public ICacheManagerFactory GetCacheManagerFactory()\n    {\n        return _Factory;\n    }\n}\n</code></pre>\n\n<p>CacheManagerFactory.cs</p>\n\n<pre><code>public class CacheManagerFactory : ICacheManagerFactory\n{\n    private readonly ICacheManager Manager;\n\n    public CacheManagerFactory(ICacheManager manager)\n    {\n        if (this.Manager == null)\n        {\n            this.Manager = manager;\n        }\n    }\n\n    public ICacheManager CreateCacheManager()\n    {\n        return this.Manager;\n    }\n\n}  \n</code></pre>\n\n<p>Everytime I run the console application and it hits <strong>GetSomething</strong>, <strong>CacheManager</strong> is null.  Why is it that the injection is not happening when I do a call to the web method?</p>\n"},{"tags":["c#","wpf","storyboard","itemscontrol"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13259366,"title":"Animate height change when the DataContext of an ItemsControl changes in WPF","body":"<p>I have an <code>ItemsControl</code> that binds to its <code>DataContext</code>. When the <code>DataContext</code> changes, I want the height change of <code>ItemsControl</code> animated. I tried to specify a <code>DataContextChanged</code> event for the <code>ItemsControl</code>: </p>\n\n<pre><code>&lt;ItemsControl x:Name=\"items\" ItemsSource=\"{Binding}\" ItemTemplate=\"{StaticResource LocationTemplate}\" DataContextChanged=\"Items_DataContextChanged\"&gt;\n</code></pre>\n\n<p>And in the handler, I tried to create a <code>DoubleAnimation</code> for height. However, I don't know how to specify <code>From</code> and <code>To</code> properties. Anyone can help? Thanks!</p>\n"},{"tags":["c#","algorithm","google-maps","google","google-api"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":13249778,"title":"Google algorithm for text on broken lines","body":"<p>I wonder what kind of algorithm <code>Google</code> uses to show up text (like streets/rivers names etc.) on the map? Especially I want to know how they render the strings that they are folded (e.g. <code>N Cahuenga Blvd</code>).</p>\n\n<p>I tried to have a look at <code>Google API</code>, but I couldn't find anything useful... :(</p>\n\n<p><img src=\"http://i.stack.imgur.com/n1BLT.png\" alt=\"Example\"></p>\n"},{"tags":["c#","asp.net","cookies","webforms","asp.net-4.0"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13058574,"title":"Check if Cookie Exists","body":"<p>From a quick search on <em>Stack Overflow</em> I saw people suggesting the following way of checking if a cookie exists:</p>\n\n<pre><code>HttpContext.Current.Response.Cookies[\"cookie_name\"] != null\n</code></pre>\n\n<p>or (inside a <code>Page</code> class):</p>\n\n<pre><code>this.Response.Cookies[\"cookie_name\"] != null\n</code></pre>\n\n<p>However, when I try to use the indexer (or the Cookies.Get method) to retrieve a cookie that does not exist it seems to actually <strong>create</strong> a 'default' cookie with that name and return that, thus no matter what cookie name I use it never returns null. (and even worse - creates an unwanted cookie)</p>\n\n<p>Am I doing something wrong here, or is there a different way of simply checking for the existance of a specific cookie by name?</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":9,"view_count":44,"score":-8,"question_id":13272205,"title":"using GUI based c#","body":"<p>using a form1 in GUI based c# how can i create two circle and fill color in them such that if i take the mouse cursor on form1 client area and click on them then the color of the circle  will change simultaneously.</p>\n"},{"tags":["c#","reflection","copy"],"answer_count":5,"favorite_count":8,"up_vote_count":15,"down_vote_count":0,"view_count":15605,"score":15,"question_id":1198886,"title":"C# Using Reflection to copy base class properties","body":"<p>I would like to update all properties from MyObject to another using Reflection. The problem I am coming into is that the particular object is inherited from a base class and those base class property values are not updated.</p>\n\n<p>The below code copies over top level property values.</p>\n\n<pre><code>public void Update(MyObject o)\n{\n    MyObject copyObject = ...\n\n    FieldInfo[] myObjectFields = o.GetType().GetFields(\n    BindingFlags.NonPublic | BindingFlags.Public | BindingFlags.Instance);\n\n    foreach (FieldInfo fi in myObjectFields)\n    {\n        fi.SetValue(copyObject, fi.GetValue(o));\n    }\n}\n</code></pre>\n\n<p>I was looking to see if there were any more BindingFlags attributes I could use to help but to no avail.</p>\n"},{"tags":["c#","algorithm"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":1,"view_count":130,"score":3,"question_id":13270865,"title":"convert string \"172406\" to integers 17, 24, 06 fast","body":"<p>I need to convert fast the string in format \"HHmmss\" to DateTime or integers. I've tested such code:</p>\n\n<pre><code>Console.WriteLine(\"decoding \" + text);\nlong microseconds = sw.ElapsedTicks / (Stopwatch.Frequency / (1000L * 1000L));\nConsole.WriteLine(\"start time \" + microseconds);\nfield = DateTime.ParseExact(text, \"HHmmss\", null);\nmicroseconds = sw.ElapsedTicks / (Stopwatch.Frequency / (1000L * 1000L));\nConsole.WriteLine(\"finish time \" + microseconds);\n</code></pre>\n\n<p>and the output is</p>\n\n<pre>\ndecoding 172400\nstart time 121\nfinish time 244\n\ndecoding 172400\nstart time 236\nfinish time 383\n\ndecoding 172400\nstart time 116\nfinish time 416\n\ndecoding 172400\nstart time 235\nfinish time 421\n\ndecoding 172359\nstart time 149\nfinish time 323\n</pre>\n\n<p>so in average about 150 microseconds. What's a lot of time, i'm writing HFT software and the best HFT has in average 10 microseconds \"tick-to-trade\" time (this includes everything!). I understand that using c# this is imposible however i still think that 150 microseconds is too much even using c#.</p>\n\n<p>Now I want to use another algorithm, however I don't know how to \"extract\" integers from the text:</p>\n\n<pre><code>field = new DateTime(DateTime.Now.Year, DateTime.Now.Month, DateTime.Now.Day, /*extract hour, min, sec from text*/)\n</code></pre>\n\n<p>What can you suggest and what would be the fastest way?\nPlease do not ask why I'm care about perfomance instead just suggest how to do that faster.</p>\n\n<p><strong>Results:</strong></p>\n\n<p>Using <code>DateTime.ParseExact(text, \"HHmmss\", null)</code> about 6-8 ticks</p>\n\n<p>Using <code>TimeSpan ts = TimeSpan.ParseExact(text, \"hhmmss\", null);</code> about 3-4 ticks</p>\n\n<p>Using <code>int hour = 10 * text[0] + text[1] - 11 * '0';</code>... about 0 ticks</p>\n\n<p>Acutally much less than 0 ticks if using loop for measurements. Actually it was found that last version is 100 times faster than other.</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>    long startMicroseconds = sw.ElapsedTicks /*/ (Stopwatch.Frequency / (1000L * 1000L))*/;\n\n    //TimeSpan ts = TimeSpan.ParseExact(text, \"hhmmss\", null);\n\n    //int hour = 10 * text[0] + text[1] - 11 * '0';\n    //int minute = 10 * text[2] + text[3] - 11 * '0';\n    //int second = 10 * text[4] + text[5] - 11 * '0';\n\n    field = DateTime.ParseExact(text, \"HHmmss\", null);\n\n    long finishMicroseconds = sw.ElapsedTicks /*/ (Stopwatch.Frequency / (1000L * 1000L))*/;\n    Console.WriteLine(\"elappsed \" + (finishMicroseconds - startMicroseconds));\n</code></pre>\n"},{"tags":["c#","asp.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":157,"score":0,"question_id":12039379,"title":"“does not contain a definition for ...and no extension method ...accepting a first argument for type error","body":"<p>I've got the following error:</p>\n\n<pre><code>'DirectActivity' does not contain a definition for 'ddl_jobcode_Id2' and no extension method 'ddl_jobcode_Id2' accepting a first argument of type 'DirectActivity' could be found (are you missing a using directive or an assembly reference?)\n</code></pre>\n\n<p>In my aspx, I created a DropDownList like this:</p>\n\n<pre><code>&lt;asp:DropDownList ID=\"ddl_jobcode_Id2\" runat=\"server\" DataSourceID=\"ddl_ActivityType2\"\n                            DataTextField=\"jobCode\" DataValueField=\"ID\" SelectedValue='&lt;%# Bind(\"jobCode_ID2\", \"{0}\") %&gt;'\n                            OnDataBound=\"ddl_jobcode_Id2_DataBound\" \n                            onselectedindexchanged=\"ddl_jobcode_Id2_SelectedIndexChanged1\" \n                            AutoPostBack=\"True\"&gt;\n                        &lt;/asp:DropDownList&gt;\n</code></pre>\n\n<p>I need to add a control so that in the .cs file I worte </p>\n\n<pre><code>protected void ddl_jobcode_Id2_SelectedIndexChanged1(object sender, EventArgs e)\n{\n    if(this.ddl_jobcode_Id2.SelectedValue == \"19\" )\n     {  ...}}\n</code></pre>\n\n<p>and it just shows this error on <code>ddl_jobcode_Id2</code></p>\n\n<p>could anyone help me please? many thanks!!!</p>\n"},{"tags":["c#","asp.net","facebook-connect"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":2982,"score":0,"question_id":2094946,"title":"Example of ASP.NET/C# using Facebook Connect Toolkit 3.0","body":"<p>Are there any examples of fully functioning code with C# and Facebook Connect with version 3.0 of the toolkit?</p>\n\n<p><strong>NOTE:</strong> I am specifically interested in version 3.0 of the toolkit. There are plenty of 2.0 examples out there but the 3.0 toolkit deprecates many of the 2.0 objects which makes these examples useless. I am <strong>ONLY</strong> interested in examples with 3.0</p>\n"},{"tags":["c#","asp.net","datagrid","grid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13269839,"title":"retrieve data by clicking on a gridview cell in asp.net using c#","body":"<p>I have a gridview </p>\n\n<pre><code>&lt;asp:GridView ID=\"wbsdataGV1\" runat=\"server\" Width=\"790px\" AutoGenerateColumns=\"False\"\n                                    OnSelectedIndexChanged=\"wbsdataGV1_SelectionChanged\" DataKeyNames=\"WBSCode\"&gt;\n                                    &lt;Columns&gt;\n\n                                        &lt;asp:TemplateField HeaderText=\"WBS Code\"&gt;\n                                            &lt;ItemTemplate&gt;\n                                                &lt;asp:LinkButton ID=\"LinkButton1\" runat=\"server\" Text='&lt;%# Eval(\"WBSCode\") %&gt;'&gt;&lt;/asp:LinkButton&gt;\n                                            &lt;/ItemTemplate&gt;\n                                            &lt;ControlStyle Width=\"100px\" /&gt;\n                                            &lt;ItemStyle BorderStyle=\"Solid\" BorderWidth=\"1px\" /&gt;\n                                        &lt;/asp:TemplateField&gt;\n                                        &lt;asp:TemplateField HeaderText=\"Description\"&gt;\n                                            &lt;ItemTemplate&gt;\n                                                &lt;asp:TextBox ID=\"TextBox40\" runat=\"server\" Text='&lt;%# Eval(\"Description\") %&gt;' ReadOnly=\"true\"\n                                                    Width=\"300px\"&gt;&lt;/asp:TextBox&gt;\n                                            &lt;/ItemTemplate&gt;\n                                            &lt;ControlStyle Width=\"300px\" /&gt;\n                                            &lt;ItemStyle BorderStyle=\"Solid\" BorderWidth=\"1px\" /&gt;\n                                        &lt;/asp:TemplateField&gt;\n                                        &lt;asp:TemplateField HeaderText=\"Territory Code\"&gt;\n                                            &lt;ItemTemplate&gt;\n                                                &lt;asp:Label ID=\"Label45\" runat=\"server\" Text='&lt;%# Eval(\"TerritoryCode\") %&gt;'&gt;&lt;/asp:Label&gt;\n                                            &lt;/ItemTemplate&gt;\n                                            &lt;ControlStyle Width=\"100px\" /&gt;\n                                            &lt;ItemStyle BorderStyle=\"Solid\" BorderWidth=\"1px\" /&gt;\n                                        &lt;/asp:TemplateField&gt;\n                                        &lt;asp:TemplateField HeaderText=\"Amount\"&gt;\n                                            &lt;ItemTemplate&gt;\n                                                &lt;asp:Label ID=\"Label46\" runat=\"server\" Text='&lt;%# Eval(\"AmountReleased\") %&gt;'&gt;&lt;/asp:Label&gt;\n                                            &lt;/ItemTemplate&gt;\n                                            &lt;ControlStyle Width=\"100px\" /&gt;\n                                            &lt;ItemStyle BorderStyle=\"Solid\" BorderWidth=\"1px\" /&gt;\n                                        &lt;/asp:TemplateField&gt;\n                                    &lt;/Columns&gt;\n                                    &lt;HeaderStyle BackColor=\"Wheat\" BorderStyle=\"Solid\" BorderWidth=\"1px\" /&gt;\n                                    &lt;RowStyle BorderStyle=\"Solid\" BorderWidth=\"1px\" HorizontalAlign=\"Center\" /&gt;\n                                &lt;/asp:GridView&gt;\n</code></pre>\n\n<p>now in the link button i want to click it and retrieve that row's data in the same page and show it...</p>\n\n<p>i am using </p>\n\n<pre><code>protected void wbsdataGV1_SelectionChanged(object sender, EventArgs e)\n{\n    string rowID = (string)this.wbsdataGV1.SelectedDataKey.Value;\n    con.Open();\n    SqlCommand cmd = new SqlCommand(\" select WBSCode,Description,TerritoryCode,AmountReleased from WBS where WBSCode='\"+rowID+\"'\");\n    cmd.Connection = con;\n    SqlDataAdapter da = new SqlDataAdapter(cmd);\n    DataTable dt = new DataTable();\n    da.Fill(dt);\n    if (dt.Rows.Count &gt; 0)\n    {\n        wbssearchdata1.DataSource = dt;\n        wbssearchdata1.DataBind();\n    }\n\n    con.Close();\n}\n</code></pre>\n\n<p>this code but its not firing on the click .. so how can i solve this.. any help? </p>\n"},{"tags":["c#","linq"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":65,"score":1,"question_id":13270938,"title":"how to write this LINQ query of 3 tables?","body":"<ul>\n<li><p>Table1 CAR (CARID, CarModelID ,CARuniqueinfo1, CARUniqueinfo2): contians all cars have been entered to the warehouse.</p></li>\n<li><p>Table2 CarModel (CarModelID ,Modelinfo1 ,Modelinfo2 ) </p></li>\n<li><p>Table3 Sale (SaleID, CarID, clientID, EmpID) </p></li>\n</ul>\n\n<p>What is the Linq Query that returns :</p>\n\n<p>number of sold cars only for ModelID=101</p>\n\n<pre><code>DataClassesDataContext db = new DataClassesDataContext(); \n</code></pre>\n"},{"tags":["c#","asp.net","html","css"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":12,"score":-1,"question_id":13272136,"title":"While giving rowspan and removing cell i m getting error \"Specified argument was out of the range of valid values\"","body":"<p><img src=\"http://i.stack.imgur.com/OqHaA.png\" alt=\"enter image description here\">    ASPX page</p>\n\n<pre><code>    &lt;table id=\"tableAppointment\" runat=\"server\" cellspacing=\"1\" width=\"100%\" bgcolor=\"#cccccc\"&gt;\n                                    &lt;tr class=\"csstextheader\"&gt;\n                                        &lt;td width=\"70px\"&gt;\n                                        &lt;/td&gt;\n                                        &lt;td width=\"70px\"&gt;\n                                            &lt;b&gt;Time Slot&amp;nbsp;&lt;/b&gt;\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td width=\"70px\"&gt;\n                                            08:00AM\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            00\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;08:00AM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            15\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;08:00AM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            30\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;08:00AM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            45\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            09:00AM\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            00\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;09:00AM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            15\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;09:00AM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            30\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;09:00AM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            45\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            10:00AM\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            00\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;10:00AM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            15\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;10:00AM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            30\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;10:00AM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            45\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            11:00AM\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            00\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;11:00AM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            15\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;11:00AM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            30\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;11:00AM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            45\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            12:00PM\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            00\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;12:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            15\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;12:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            30\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;12:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            45\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            01:00PM\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            00\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;01:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            15\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;01:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            30\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;01:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            45\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            02:00PM\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            00\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;02:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            15\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;02:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            30\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;02:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            45\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            03:00PM\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            00\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;03:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            15\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;03:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            30\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;03:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            45\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            04:00PM\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            00\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;04:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            15\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;04:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            30\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;04:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            45\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            05:00PM\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            00\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;05:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            15\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;05:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            30\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;05:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            45\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            06:00PM\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            00\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;06:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            15\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;06:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            30\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;06:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            45\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            07:00PM\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            00\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;07:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            15\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;07:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            30\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;07:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            45\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                &lt;/table&gt;\n\nC#\n\nprotected void ReadFixedAppointments(string appId, string pID, string Acq_Modality_ID, string patientName, string dbHour, string dbMinute, int rowspan, string status)\n    {\n        string rowHourText = \"\";\n        string hour = \"\";\n        string rowMinuteText = \"\";\n        string matchedHour = \"\";\n        string cellAcqModalityID = \"\";\n        int row = -1;\n        int col = -1;\n\n        for(int i = 0; i &lt;= tableAppointment.Rows.Count - 1; i++)\n        {           \n            rowHourText = tableAppointment.Rows[i + 1].Cells[0].InnerText.Trim();\n\n            if(matchedHour == \"\" &amp;&amp; rowHourText != \"\")\n            {\n                if(rowHourText.Substring(5, 2) == \"PM\")\n                {\n                    hour = Convert.ToString(Convert.ToInt32(rowHourText.Substring(0, 2)) + 12);\n                    if(hour == \"24\")\n                        hour = \"12\";\n                }\n                else\n                {\n                    hour = rowHourText.Substring(0, 2);\n                }\n            }\n            if(hour == dbHour &amp;&amp; matchedHour == \"\")\n            {\n                matchedHour = hour;\n            }\n            rowMinuteText = tableAppointment.Rows[i + 1].Cells[1].InnerText.Trim();\n            if(Convert.ToInt32(rowMinuteText) == Convert.ToInt32(dbMinute) &amp;&amp; hour == dbHour)\n            {\n                row = i;\n                break;\n            }\n        }\n\n        for(int k = 0; k &lt; tableAppointment.Rows[0].Cells.Count; k++)\n        {\n            cellAcqModalityID = tableAppointment.Rows[0].Cells[k].Attributes[\"ID\"];\n            if(cellAcqModalityID != null &amp;&amp; cellAcqModalityID != \"\")\n            {\n                if(Acq_Modality_ID == cellAcqModalityID)\n                {\n                    col = k;\n                    break;\n                }\n            }\n        }\n\n        if(col != -1)\n        {\n            if(rowspan == 1 &amp;&amp; tableAppointment.Rows[row + 1].Cells[col].Attributes[\"class\"] == null)\n            {\n                tableAppointment.Rows[row + 1].Cells[col].RowSpan = rowspan;\n                tableAppointment.Rows[row + 1].Cells[col].InnerHtml = \"&lt;span id=\" + pID + \" name=\" + appId + \"&gt;\" + patientName + \"&lt;/span&gt;\";\n\n                if(status == \"CHECKED IN\")\n                {\n                    tableAppointment.Rows[row + 1].Cells[col].Attributes.Add(\"class\", \"csstdgreen\");\n                }\n                else\n                {\n                    tableAppointment.Rows[row + 1].Cells[col].Attributes.Add(\"class\", \"csstdred\");\n                }\n                tableAppointment.Rows[row + 1].Cells[col].Attributes.Add(\"valign\", \"top\");\n            }\n            if(rowspan == 2 &amp;&amp; tableAppointment.Rows[row + 1].Cells[col].Attributes[\"class\"] == null)\n            {\n                if(tableAppointment.Rows[row + 2].Cells.Count &gt;= col)\n                {\n                    tableAppointment.Rows[row + 2].Cells.RemoveAt(col);\n                }\n                else\n                {\n                    tableAppointment.Rows[row + 2].Cells.RemoveAt(tableAppointment.Rows[row + 2].Cells.Count - 1);\n                }\n                tableAppointment.Rows[row + 1].Cells[col].RowSpan = rowspan;\n                tableAppointment.Rows[row + 1].Cells[col].InnerHtml = \"&lt;span id=\" + pID + \" name=\" + appId + \"&gt;\" + patientName + \"&lt;/span&gt;\";\n\n                if(status == \"CHECKED IN\")\n                {\n                    tableAppointment.Rows[row + 1].Cells[col].Attributes.Add(\"class\", \"csstdgreen\");\n                }\n                else\n                {\n                    tableAppointment.Rows[row + 1].Cells[col].Attributes.Add(\"class\", \"csstdred\");\n                }\n            }\n\n            if(rowspan == 3 &amp;&amp; tableAppointment.Rows[row + 1].Cells[col].Attributes[\"class\"] == null)\n            {\n\n                if(tableAppointment.Rows[row + 2].Cells.Count &gt;= col)\n                {\n                    tableAppointment.Rows[row + 2].Cells.RemoveAt(col);\n                }\n                else\n                {\n                    tableAppointment.Rows[row + 2].Cells.RemoveAt(tableAppointment.Rows[row + 2].Cells.Count - 1);\n                }\n                if(tableAppointment.Rows[row + 3].Cells.Count &gt;= col)\n                {\n                    tableAppointment.Rows[row + 3].Cells.RemoveAt(col);\n                }\n                else\n                {\n                    tableAppointment.Rows[row + 3].Cells.RemoveAt(tableAppointment.Rows[row + 3].Cells.Count - 1);\n                }\n                tableAppointment.Rows[row + 1].Cells[col].RowSpan = rowspan;\n                tableAppointment.Rows[row + 1].Cells[col].InnerHtml = \"&lt;span id=\" + pID + \" name=\" + appId + \"&gt;\" + patientName + \"&lt;/span&gt;\";\n\n                if(status == \"CHECKED IN\")\n                {\n                    tableAppointment.Rows[row + 1].Cells[col].Attributes.Add(\"class\", \"csstdgreen\");\n                }\n                else\n                {\n                    tableAppointment.Rows[row + 1].Cells[col].Attributes.Add(\"class\", \"csstdred\");\n                }\n            }\n        }\n    }\n\n    private int calculateRowspan(string startHour, string endHour, string startMinute, string endMinute)\n    {\n        int rowSpan = 0;\n        int hour = Convert.ToInt32(endHour) - Convert.ToInt32(startHour);\n        int minute = Convert.ToInt32(endMinute) - Convert.ToInt32(startMinute);\n        if(hour != 0)\n        {\n            hour = hour * 60;\n            hour = hour + minute;\n            rowSpan = hour / 15;\n        }\n        else\n        {\n            rowSpan = minute / 15;\n        }\n        return rowSpan;\n    }\n\n**I m fetching appId, pID, Acq_Modality_ID, patientName, dbHour, dbMinute, rowspan, status from database.\n\n    Now what i do matching  html cell with dbHour and dbMinute i have stored Acq_Modality_ID in first rows cells id atrribute like  CR(CR1) CR(CR2) CT(CT1) CT(CT2)\n\n    Calculating rowsapn using total time while each time slot is 15 minute\n\n    if user selects two cells then total time is 30 rowspan= 30/15=2.\n\n    In image i m selecting 3 slots so total time is 45 so calculate rowspan= 45/15=3 \n\n\n    While giving rowspan  and removing cell i m getting error \"Specified argument was out of the range of valid values\".\n\n\n    So how ca i tackle it. Confused since 4 days.**\n</code></pre>\n"},{"tags":["c#","resources"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":10,"score":1,"question_id":13272109,"title":"Using application's *.resx from a generic DLL","body":"<p>I'm creating a generic DLL that creates documents from models and can be used either for winForms or for webForms. It's composed of a main class that I instantiate with certain parameters. \nI'd like my DLL to be able to lookup in the resource files without being tied down to 1 technology.</p>\n\n<p>So to say, I know how to access my resource files (<code>*.resx</code>) in a WebForm :</p>\n\n<pre><code>HttpContext.GetGlobalResourceObject(\"Global\", \"myLabel\")\n</code></pre>\n\n<p>I have a few restrictions :</p>\n\n<ol>\n<li>I don't want to transfer the HttpContext to the DLL as it will tie it to the application</li>\n<li>I don't want to rename the resource files from <code>*.resx</code> to <code>*.resource</code> because they are used in the application</li>\n<li>I don't want to pass all the labels over to the DLL because then my models won't be modifiable as I need</li>\n<li>I'd like to place a marker in my document models that is like this <code>&lt;%resource(Global,myLabel)%&gt;</code></li>\n</ol>\n\n<p>I've been looking at passing the class a resource object using <code>ResourceManager</code> but it never gets hold of my <code>*.resx</code> files.</p>\n\n<p>Does anyone know how to acheive the final goal? Either passing a resource object to the class either picking up the resource object from inside the class.</p>\n"},{"tags":["c#","asp.net","listview","viewstate","objectdatasource"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13269937,"title":"Sorting a ListView using an ObjectDataSource with a LinkButton and ViewState","body":"<p>I am using a ListView to display paginated data:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;asp:ListView ID=\"listOfItems\" runat=\"server\" DataSourceID=\"ItemsDataSource\" EnableModelValidation=\"True\" InsertItemPosition=\"FirstItem\" ItemPlaceholderID=\"ItemRowContainer\"&gt;\n    &lt;LayoutTemplate&gt;\n        &lt;div class=\"tablecontainer\"&gt;\n            &lt;div class=\"pagination-top\"&gt;\n                &lt;custom:TablePaginationControl ID=\"TablePaginationControl1\" runat=\"server\" ControlID=\"listOfItems\" ShowPageSizeList=\"true\" /&gt;\n            &lt;/div&gt;\n            &lt;table class=\"list-view\"&gt;\n                &lt;tr&gt;\n                    &lt;th class=\"first-column\" width=\"350px\"&gt;\n                        &lt;asp:LinkButton ID=\"SortByName\" runat=\"server\" CommandArgument=\"Name\" CommandName=\"SortMainList\" OnCommand=\"SortItems\" Text=\"&lt;%$ Resources:Name %&gt;\"&gt;&lt;/asp:LinkButton&gt;\n                    &lt;/th&gt;\n                    ...\n                &lt;/tr&gt;\n                &lt;tbody&gt;\n                    &lt;tr runat=\"server\" id=\"ItemRowContainer\" /&gt;\n                &lt;/tbody&gt;\n            &lt;/table&gt;\n        &lt;/div&gt;\n    &lt;/LayoutTemplate&gt;\n    ...\n&lt;/asp:ListView&gt;\n</code></pre>\n\n<p>The datasource definition:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;asp:ObjectDataSource ID=\"ItemsDataSource\" runat=\"server\" EnablePaging=\"True\" InsertMethod=\"AddItems\" SelectCountMethod=\"SelectItemsCount\" SelectMethod=\"SelectItems\" TypeName=\"SHLCentral.TheLibrary.Web.View.DocumentManagementControl, ClientPortal.Web, Version=1.0.0.0, Culture=neutral, PublicKeyToken=cd2852a10d692fb9\" UpdateMethod=\"UpdateItems\"&gt;\n    ...\n&lt;/asp:ObjectDataSource&gt;\n</code></pre>\n\n<p>The revelant code behind is made of these two methods:</p>\n\n<pre><code>public IEnumerable&lt;ListDocumentsResult&gt; SelectItems(\n    int maximumRows,\n    int startRowIndex)\n{\n    var results = Controller.ListDocuments(new ListDocumentsRequest());\n\n    PropertyInfo sortProperty;\n    try\n    {\n        sortProperty = typeof (ListDocumentsResult).GetProperty((string) ViewState[\"mainListSortColumn\"]);\n    }\n    catch\n    {\n        sortProperty = null;\n    }\n    Func&lt;ListDocumentsResult, object&gt; sortFunction = sortProperty == null\n                            ? (Func&lt;ListDocumentsResult, object&gt;) (ldr =&gt; ldr.LastUpdatedDate)\n                            : (ldr =&gt; sortProperty.GetValue(ldr, new object[0]));\n\n    return\n        (sortProperty == null || !((bool) ViewState[\"mainListSortAsc\"])\n             ? results.OrderByDescending(sortFunction)\n             : results.OrderBy(sortFunction))\n            .Skip(startRowIndex)\n            .Take(maximumRows);\n}\n\nprotected void SortItems(object sender, CommandEventArgs e)\n{\n    if (e.CommandName == \"SortMainList\")\n    {\n        var sortColumn = (string) e.CommandArgument;\n        if ((string)ViewState[\"mainListSortColumn\"] == sortColumn)\n        {\n            ViewState[\"mainListSortAsc\"] = !(bool)ViewState[\"mainListSortAsc\"];\n        }\n        else\n        {\n            ViewState[\"mainListSortAsc\"] = true;\n            ViewState[\"mainListSortColumn\"] = sortColumn;\n        }\n        DataBind();\n    }\n}\n</code></pre>\n\n<p>So my intention this: when the users clicks on the <code>LinkButton</code> contained in the \"Name\" column header (I left out all but one column for clarity), the <code>SortItems</code> method is called: it sets the sorted column name and sort order into the <code>ViewState</code>, then reloads the <code>ListView</code> using the <code>DataBind</code> method. In the Select method of the <code>ObjectDataSource</code>, we read this <code>ViewState</code> values and use them to order the data.</p>\n\n<p>Putting breakpoints on all these methods, I can see there is this sequence of calls when I click the <code>LinkButton</code>:</p>\n\n<ul>\n<li><code>OnLoad</code></li>\n<li><code>SortItems</code></li>\n<li><code>SelectItems</code></li>\n</ul>\n\n<p>The problem I have is that when I get to the <code>SelectItems</code> method, the <code>ViewState</code> is totally empty (it has 0 keys): if I set a breakpoint on the Load method of the page, I see the control containing all this is only loaded once. The <code>DataBind</code> method does not seem to trigger any loading of the control, it seems to be just triggering the <code>SelectItems</code> method of a new instance of the control (meaning that if, instead of using <code>ViewState</code>, I set an instance field in the <code>SortItems</code> method, the field is null when getting in the <code>SelectItems</code> method).</p>\n\n<p>I am sure that the <code>ViewState</code> is active on the page (I can find the <code>ViewState</code> keys on the browser side using a Firefox extension for instance).</p>\n\n<p>There is something not quite clear to me about the life cycle of the page/control. Could someone explain what it is to me?</p>\n"},{"tags":["c#","reflection","intellisense"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":1,"view_count":392,"score":4,"question_id":9086136,"title":"How to hide public methods from intellisense","body":"<p>I want to hide public methods from the intellisense member list.  I have created an attribute that when applied to a method will cause the method to be called when its object is constructed.  I've done this to better support partial classes.  The problem is that in some environments (such as Silverlight), reflection cannot access private members even those of child classes.  This is a problem since all of the work is done in a base class. I have to make these methods public, but I want them to be hidden from intellisense, similar to how the <code>Obsolete</code> attribute works.  Frankly, because I am anal about object encapsulation. I've tried different things, but nothing has actually worked.  The method still show up in the member drop-down.</p>\n\n<p><strong>How do I keep public methods from showing up in intellisense when I don't want them to be called by clients?</strong> How's that for a <em>real</em> question, Philistines! This can also apply to MEF properties that have to be public though sometimes you want to hide them from clients.</p>\n"},{"tags":["c#","java","php","website","interop"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":70,"score":4,"question_id":13271772,"title":"How does PHP website communicate with Java and C# programs efficiently","body":"<p>I have a website written in PHP, the website accepts code snippets written in different programming languages (Java and C#) and perform some static analysis and returns the results to the user. I already wrote different analyzers for Java and C# respectively. The Java analyzer is written in Java; the C# analyzer is written in C#. </p>\n\n<p>My problem is how the PHP website can communicate with those analyzers written in different languages in an efficient way. That is: when the PHP website receives some Java code, it can invokes the Java analyzer, etc. I can of course use PHP’s exec to launch the analyzer process, but that is too slow.</p>\n"},{"tags":["c#",".net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13268634,"title":"Web data scrapper without httpwebrequest in .net","body":"<p>In .net there are some .net classes which uses IE component.By them we can read htmldom and do login and data scrapping.\nKindly can any body give me the name of those classes /assemblies where it is present.I myself used it to login and data scrapping quite a way back</p>\n"},{"tags":["c#","wpf","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1915,"score":2,"question_id":4348408,"title":"how to close window form which is hosting WPF user control from within a WPF user control","body":"<p>I want to close a window form that is hosting a WPF user control. Something like this as used while closing a current form in window application. But for WPF application I am not able to get reference to user controls parent</p>\n\n<p>How to get Form which is hosting this control so that I can close my form</p>\n\n<p>this.Close()</p>\n"},{"tags":["c#","jquery","asp.net","dialog","popup"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13270236,"title":"Show a confirmation/dialogbox in asp.net(c#)","body":"<p>Functionality I need to achieve is: \nConfirmbutton_Click</p>\n\n<p>Show a popup/dialogbox:</p>\n\n<p>On click of Yes, I need to validate Email-Id and other personal details submitted.\n    If validation fails, show error messages and return false.\n    If email-id and other details are correct, then hide/show few Divs.</p>\n\n<p>I had achieved this functionality in jQuery but now I am supposed to do it in server side. Firstly because the Divs were not showing up each time correctly and secondly due to security concern.  </p>\n\n<p>The suggestions I got on googling ask to write complete code (in script tag) at server side. That would be too much as I need to validate many fields.<br>\nAlso, is there a way I can just do the validations at client side and come back to server side and show my Divs depending upon the validation result ? The client script will be executed before server side, so it is achievable.</p>\n\n<p>I don't want to create a new popup page for this.</p>\n\n<p>If anyone could help me with correct code or pointers to one, how to validate and show divs(showing div to be done from server side).</p>\n\n<h2>UPDATED:</h2>\n\n<p>I am midway, if anyone could help me any:</p>\n\n<p>In page load(not post back) I hv added:</p>\n\n<pre><code>btnConfirm.Attributes.Add(\"onclick\", \"if(confirm('Confirm - Are you sure you want to go ahead.')) onConfirm(); else return false;\");\n</code></pre>\n\n<p>In jQuery code i have added validations as:</p>\n\n<pre><code>function onConfirm() {    \n    //Check if email-id is not blank, else show message and return to the page\n    if (isBlank($('#emailAddress').val()) == false) {\n        $('#errorBlankEmail').show();\n        return false;\n    }\n}\n    //Text validation functions\n    function isBlank(valueSent) {\n        if ($.trim(valueSent) == \"\")\n            return false;\n        else\n            return true;\n}\n</code></pre>\n\n<p>and the button code as: </p>\n\n<pre><code>&lt;asp:Button ID=\"btnConfirm\" runat=\"server\"   Text=\"Confirm\"  onclick=\"Confirm_Click\" /&gt;\n</code></pre>\n\n<p>And the server side code for this:</p>\n\n<pre><code>protected void Confirm_Click(object sender, EventArgs e)\n    {\n        divConfirm.Visible = true;\n    }\n</code></pre>\n\n<p>Now when I click on button, it works until I validate and validation fails, it executes the server side code. Is there a way where I can avoid the server-side code if result is false in client click code ?</p>\n"},{"tags":["c#","xsd","jaxb","xml-schema"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13246810,"title":"Does the Xml Schema spec define the serialization of optional attributes with a default?","body":"<p>Firstly, the Xml Schema spec <em>does</em> specify the <strong>parsing</strong> of an <code>optional attribute with a default value</code>: if such an attribute is absent in an xml document, then when parsed with the XSD, they appear to be present, and having that default value.</p>\n\n<p>Secondly, some tools apply this idea to <strong>serialization</strong>, so that attributes with default values are omitted (in other words: given <code>an optional attribute with a default value</code>, when an attribute has that value, it is omitted).</p>\n\n<p>However, as far as I can tell, this serialization behaviour is <strong>not specified</strong> in the Xml Schema. But it's a complex spec, and maybe I missed it - does the spec define serialization of <code>optional attribute with a default value</code>?</p>\n\n<hr>\n\n<p>If not, maybe it has become a <em>de facto</em> standard - do many tools implement this behaviour?  I've seen that Microsoft and MarkLogic do it:</p>\n\n<ul>\n<li>C# <a href=\"http://stackoverflow.com/questions/3411542/xml-serialization-of-the-default-values-of-optional-attributes\">XML Serialization of the default values of optional attributes</a></li>\n<li>\".net\" (in general?) <a href=\"http://stackoverflow.com/questions/11857274/including-xml-attribute-when-the-value-is-the-same-as-the-default\">Including xml attribute when the value is the same as the default</a></li>\n<li>marklogic <a href=\"http://stackoverflow.com/questions/13143530/default-schema-values-in-marklogic\">Default Schema Values in MarkLogic</a></li>\n</ul>\n\n<p>But not JAXB:</p>\n\n<ul>\n<li><strong>not</strong> JAXB <a href=\"http://stackoverflow.com/questions/8885011/jaxb-avoid-saving-default-values\">JAXB Avoid saving default values</a></li>\n</ul>\n\n<hr>\n\n<p>Finally, - and perhaps here I teeter on the precipice of subjectivity - what <strong>should</strong> be the behaviour?</p>\n\n<p>Omitting attributes with default values reduces clutter, especially if the default value is expected and common. e.g. <code>minOccurs</code> and <code>maxOccurs</code> default to <code>1</code> in an XSD itself - if you've been processing an XSD, and then serialize the result, having them suddenly appear on every <code>&lt;element&gt;</code>, <code>&lt;sequence&gt;</code>, <code>&lt;choice&gt;</code> etc makes it less readable.</p>\n\n<p>OTOH, in objects and data structures, if there is a default value, we expect it to be there if we look at it.  Therefore, it can be surprising when an attribute that has a default value is omitted - as the above SO questions show.</p>\n\n<p>I think it might depend on whether you consider the result to be data, or a representation of data.  With a representation, it can be very convenient to modify it to make it more readable.  But with data, you expect it to exactly <em>be</em> the data. Thoughts?</p>\n"},{"tags":["c#","asp.net","asp.net-mvc","mvc","asp.net-mvc-2"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13272019,"title":"Single click on button not working but double click does the work","body":"<p>Here is my html code</p>\n\n<pre><code>&lt;form runat=\"server\"&gt;\n    Hello, i'm login page\n    Enter Name   &lt;asp:TextBox ID=\"txtName\" runat=\"server\"&gt;&lt;/asp:TextBox&gt;\n    &lt;input type=\"submit\" value=\"PressMe\" onclick=\"location.href='&lt;%: Url.Action(\"EnterLogin\", \"LoginForm\") %&gt;'\" /&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Here is my controller code</p>\n\n<pre><code>public class LoginFormController : Controller\n{\n    public ActionResult ShowLogin()\n    {\n        return View();\n    }\n\n    public ActionResult EnterLogin()\n    {\n        ViewData[\"Name\"] = Convert.ToString(Request.Form[\"txtName\"]);\n        return View(\"EnterLogin\");\n    }\n}\n</code></pre>\n\n<p>On clicking <strong>PressMe</strong> button the expected output is to display Enter Login View but it doesn't.If i double click on the button then it works fine.\nAny reason for single click not to work??</p>\n"},{"tags":["c#","web-services"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13271981,"title":"How do i capture incomming and out going xml when call web service","body":"<p>i am calling a third part web service from window application. i just tried to capture xml response &amp; request generated by that web service when we call but fail. search google and found lots of article and follow their instruction and code nothing works.</p>\n\n<p>as a sample i follow this instruction from this url \n<a href=\"http://knowledgecenter.zuora.com/kb/How_do_I_capture_the_SOAP_API_Request_and_Response%3F\" rel=\"nofollow\">http://knowledgecenter.zuora.com/kb/How_do_I_capture_the_SOAP_API_Request_and_Response%3F</a>\nhttp://msdn.microsoft.com/en-us/library/ms179346.aspx</p>\n\n<p>can anyone tell me any easy way out to capture incomming and out going xml when call &amp; work with web service. looking for help.</p>\n"},{"tags":["c#","winforms","datagridview","telerik"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":13259013,"title":"Compare 2 different columns in the datagridview","body":"<p>In my datagridview, Four columns <code>1&amp;2</code> are read only col <code>3</code> &amp; <code>4</code> got number values. I want to compare that <code>4th</code> col must be greater that <code>3rd</code> column. \nFor example: \n<img src=\"http://i.stack.imgur.com/7fpSh.jpg\" alt=\"enter image description here\"></p>\n\n<p>If the <code>4</code> col value is less than the 3rd column then I want to propose message doesn't navigate to another control. </p>\n\n<p>My simple approach seems not working. How can i compare 2 specific columns for this kind of condition??</p>\n\n<pre><code>    private void datagridview_CellValidating(object sender, CellValidatingEventArgs e)\n    {\n        try\n        {\n\n            int bbor = datagridview.CurrentCell.ColumnIndex;\n            int ebor = datagridview.CurrentCell.RowIndex;\n            if (ebor &lt;= bbor)\n            {\n                MessageBox.Show(\"Please verify the value\");\n                e.Cancel = true;\n            }\n        }\n        catch (Exception exception)\n        {\n\n        }\n\n    }\n</code></pre>\n"},{"tags":["c#","web-services","ews","exchange-server","exchangewebservices"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13270962,"title":"Simulate ExchangeServer web service","body":"<p>As you already know, Win7 Outlook can connect to ExchangeServer. \n<a href=\"http://www.washington.edu/itconnect/wares/uwexchange/outlook2010.html\" rel=\"nofollow\">http://www.washington.edu/itconnect/wares/uwexchange/outlook2010.html</a></p>\n\n<p>I want to develop server app in C#, to which Outlook will be able to connect too.\nAll in order to sync my server data (contacts, calendar, tasks, etc.) with Outlook.</p>\n\n<p>What I know is that ExchangeServer use EWS for client communication.\nCan I develop web service based on EWS Managed API to communicate/sync with Outlook ?</p>\n\n<p>If cannot, what are the other options(managed or unmanaged code) ?</p>\n"},{"tags":["c#","asp.net"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13270700,"title":"how to move auto generated columns to left side?","body":"<p>i  have gridview and i am adding rows at runtime using datatable as datasource.but i want to add delete command field to grid view.I add it and run it.But i got delete button at left position.I want to change that delete button to last of gridview.Means after autogenerated columns.Please help me.Thanks in advance</p>\n"},{"tags":["c#","ajax","asp.net-mvc","asp.net-web-api"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13271804,"title":"ASP.net WebAPI return a file through ajax call","body":"<p>I am currently looking for a way to force a download of a file which is returned through a WebAPI controller.</p>\n\n<p>I was using <a href=\"http://www.shawnmclean.com/blog/2012/04/force-download-of-file-from-asp-net-webapi/\" rel=\"nofollow\">http://www.shawnmclean.com/blog/2012/04/force-download-of-file-from-asp-net-webapi/</a> as a reference.</p>\n\n<p>On my client I am using an ajax GET call to send up an ID of an object and try to download the file</p>\n\n<pre><code>    exportList: (foo, callback) =&gt;\n        path = '/api/export/id'\n        path = path.replace(\"id\", foo.id)\n        $.ajax(\n            url: path,\n            dataType: 'text',\n            success: (data) =&gt;\n                callback(data)\n            error: (data) =&gt;\n                callback(false)\n        )\n</code></pre>\n\n<p>On the server-side, I have the above URI routed to the method below</p>\n\n<pre><code>    [AcceptVerbs(\"GET\")]\n    public HttpResponseMessage ExportList(int id)\n    {\n        string file = fooService.ExportList(id);\n\n        if (file == null)\n        {\n            return Request.CreateResponse(HttpStatusCode.NoContent);\n        }\n        HttpResponseMessage result = new HttpResponseMessage(HttpStatusCode.OK);\n        result.Content = new StringContent(file);\n        result.Content.Headers.ContentType = new MediaTypeHeaderValue(\"application/octet-stream\");\n        result.Content.Headers.ContentDisposition = new ContentDispositionHeaderValue(\"attachment\");\n        result.Content.Headers.ContentDisposition.FileName = \"List.csv\";\n\n        return result;\n    }\n</code></pre>\n\n<p>The fooService.ExportList method simply creates a csv string. </p>\n\n<p>When watching the request come back to the client, the response does have the csv string in it, but the client is not prompted or forced to download it.  </p>\n\n<p>Is this the correct way to go about this?</p>\n"},{"tags":["c#","visual-studio","oracle11g","odp.net"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13270315,"title":"Accessing oracle database from c# with odb.net","body":"<p>I'm trying to access Oracle 11g DB.\nAccording to connectionstring.com , the connstring should be :</p>\n\n<pre><code>Driver={Oracle in OraClient11g_home1};Dbq=myTNSServiceName;Uid=user;Pwd=passwd;\n</code></pre>\n\n<p>Anyhow I'm getting an ArgumentException:  'Driver' is not a valid word.</p>\n\n<p>Thank you.</p>\n\n<p>Greetings</p>\n\n<p>R. Bada</p>\n"},{"tags":["c#","dll","access-specifier"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":31,"score":3,"question_id":13270414,"title":"Inconsistent accessibility: base class is less accessible than class","body":"<p>So I have an abstract base class in a DLL and child classes of that class. I want the childs to be public, but the base to be private so that it cannot be accessed outside of the dll.</p>\n\n<p>How do I do that?</p>\n"},{"tags":["c#","pixelsense"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13271913,"title":"SurfaceInkCanvas scales strokes when painting out of bounds","body":"<p>I have a <code>ScatterView</code> that contains an image over which I should be able to draw.</p>\n\n<pre><code>&lt;s:ScatterView HorizontalAlignment=\"Center\" Margin=\"0,0,0,0\" Name=\"desk\" VerticalAlignment=\"Center\"&gt;\n    &lt;s:ScatterViewItem Width=\"200\" Height=\"200\"&gt;\n        &lt;Grid&gt;\n            &lt;Image Name=\"img1\" Source=\"/Resources/Desert.jpg\"/&gt;\n            &lt;Viewbox&gt;\n                &lt;s:SurfaceInkCanvas Name=\"cvs1\"/&gt;\n            &lt;/Viewbox&gt;\n        &lt;/Grid&gt;\n    &lt;/s:ScatterViewItem&gt;\n&lt;/s:ScatterView&gt;\n</code></pre>\n\n<p>I noticed that whenever I draw an ink trail towards the border of the image, the previous strokes scale down. I do not want this to happen. How can I change this behavior?</p>\n"},{"tags":["c#","javascript","asp.net","json","xml-serialization"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13271369,"title":"Convert JSON to XML","body":"<p>I know this has been asked many many times.</p>\n\n<p>But honestly with so many tries, the solutions are not working for me.</p>\n\n<p>As I am working in <strong>ASP.Net 1.1</strong>, so can not handle this .net level.</p>\n\n<p>So I went ahead a tried many solution i.e <strong>using javascript library, jquery library</strong> to do this.</p>\n\n<p>Some tool are converting, but appending <strong>&lt;0>, &lt;1> &lt;2></strong> and so on..Which while doing LoadXml is throwing format error.</p>\n\n<p>I need a simple function or a good library which can convert a JSON object to XML.</p>\n\n<p>Please suggest if there are any.</p>\n\n<p>I have tried these to name a few :</p>\n\n<p><a href=\"http://code.google.com/p/x2js/\" rel=\"nofollow\">This gave me the xml having &lt;0>, &lt;1> ,&lt;2> sort of tags.</a></p>\n\n<p><a href=\"http://ruchirawageesha.blogspot.in/2011/06/xml-to-json-and-json-to-xml-conversion.html\" rel=\"nofollow\">This Did not work at all.</a> </p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I have deleted the middle JSON and XML data as it was huge :</p>\n\n<p>JSON</p>\n\n<pre><code>\"{\\\"CrashTestResult\\\":[[\\\"Crash Test Note\\\",\\\"Results based on a 35 MPH frontal crash and 38.5 MPH side crash.  Results are reported in a range of one to five stars, with five stars indicating the best crash protection for vehicles within \\\\\"TIRES, P265/70R17 ALL-SEASON, BLACKWALL\\\",\\\"$0.00\\\"],[\\\"TIRES\\\",\\\"TIRES, P265/70R17 ON-/OFF-ROAD, WHITE OUTLINED-LETTER\\\",\\\"$125.00\\\"],[\\\"TIRES\\\",\\\"TIRES, P265/70R17 ON-/OFF-ROAD, BLACKWALL\\\",\\\"$150.00\\\"],[\\\"TIRES\\\",\\\"TIRES, P265/70R17 ALL-SEASON, WHITE OUTLINED-LETTER\\\",\\\"$125.00\\\"],[\\\"TIRES\\\",\\\"TIRES, P275/55R20 ALL-SEASON, BLACKWALL\\\",\\\"$0.00\\\"],[\\\"Drivetrain Years\\\",\\\"5\\\"],[\\\"Roadside Assistance Miles/km\\\",\\\"100,000\\\"],[\\\"Roadside Assistance Years\\\",\\\"5\\\"]],\\\"Wheel\\\":[\\\"WHEELS, 4 - 17\\\\\\\" X 7.5\\\\\\\" (43.2 CM X 19.1 CM) ALUMINUM, 5-SPOKE\\\",\\\"WHEELS, 4 - 17\\\\\\\" X 7.5\\\\\\\" (43.2 CM X 19.1 CM) ALUMINUM, 5-SPOKE\\\",\\\"WHEELS, 4 - 20\\\\\\\" X 8.5\\\\\\\" (50.8 CM X 21.6 CM) PAINTED ALUMINUM\\\"]}\"\n</code></pre>\n\n<p>Want XML like </p>\n\n<pre><code>\"&lt;?xml version=\\\"1.0\\\" encoding=\\\"utf-16\\\"?&gt;\\r\\n&lt;VINDescription xmlns:xsd=\\\"http://www.w3.org/2001/XMLSchema\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\"&gt;\\r\\n  &lt;CrashTestResult xmlns=\\\"http://autoexact.com/VINDecoder/\\\"&gt;\\r\\n    &lt;ArrayOfstring xmlns=\\\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\\\"&gt;\\r\\n      &lt;string&gt;Crash Test Note&lt;/string&gt;\\r\\n      &lt;string&gt;Results based on a 35 MPH frontal crash and 38.5 MPH side crash.  Results are reported in a range of one to five stars, with five stars indicating the best crash protection for vehicles within the same weight class.  This test used driver and passenger belts and airbags.&lt;/string&gt;\\r\\n    &lt;/ArrayOfstring&gt;\\r\\n    &lt;ArrayOfstring xmlns=\\\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\\\"&gt;\\r\\n      &lt;string&gt;Frontal Driver&lt;/string&gt;\\r\\n      &lt;string&gt;* * * *&lt;/string&gt;\\r\\n    &lt;/ArrayOfstring&gt;\\r\\n    &lt;ArrayOfstring xmlns=\\\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\\\"&gt;\\r\\n      &lt;string&gt;Frontal Passenger&lt;/string&gt;\\r\\n      &lt;string&gt;* * * *&lt;/string&gt;\\r\\n    &lt;/ArrayOfstring&gt;\\r\\n&lt;string&gt;$2,755.00&lt;/string&gt;\\r\\n    &lt;/ArrayOfstring&gt;\\r\\n    &lt;ArrayOfstring xmlns=\\\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\\\"&gt;\\r\\n      &lt;string&gt;CPOS PKG&lt;/string&gt;\\r\\n      &lt;string&gt;28F CUSTOMER PREmas.microsoft.com/2003/10/Serialization/Arrays\\\"&gt;\\r\\n      &lt;string&gt;Basic Miles/km&lt;/string&gt;\\r\\n      &lt;string&gt;36,000&lt;/string&gt;\\r\\n    &lt;/ArrayOfstring&gt;\\r\\n    &lt;ArrayOfstring xmlns=\\\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\\\"&gt;\\r\\n      &lt;string&gt;Basic Years&lt;/string&gt;\\r\\n      &lt;string&gt;3&lt;/string&gt;\\r\\n    &lt;/ArrayOfstring&gt;\\r\\n    &lt;ArrayOfstring xmlns=\\\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\\\"&gt;\\r\\n      &lt;string&gt;Corrosion Miles/km&lt;/string&gt;\\r\\n      &lt;string&gt;100,000&lt;/string&gt;\\r\\n    &lt;/ArrayOfstring&gt;\\r\\n    &lt;ArrayOfstring xmlns=\\\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\\\"&gt;\\r\\n      &lt;string&gt;Corrosion Years&lt;/string&gt;\\r\\n      &lt;string&gt;5&lt;/string&gt;\\r\\n    &lt;/ArrayOfstring&gt;\\r\\n    &lt;ArrayOfstring xmlns=\\\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\\\"&gt;\\r\\n      &lt;string&gt;Drivetrain Miles/km&lt;/string&gt;\\r\\n      &lt;string&gt;36,000&lt;/string&gt;\\r\\n    &lt;/ArrayOfstring&gt;\\r\\n    &lt;ArrayOfstring xmlns=\\\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\\\"&gt;\\r\\n      &lt;string&gt;Drivetrain Note&lt;/string&gt;\\r\\n      &lt;string&gt;Unlimited Years/Unlimited Miles for vehicles sold after 07/26/2007&lt;/string&gt;\\r\\n    &lt;/ArrayOfstring&gt;\\r\\n    &lt;ArrayOfstring xmlns=\\\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\\\"&gt;\\r\\n      &lt;string&gt;Drivetrain Years&lt;/string&gt;\\r\\n      &lt;string&gt;3&lt;/string&gt;\\r\\n    &lt;/ArrayOfstring&gt;\\r\\n  &lt;/Warranty&gt;\\r\\n  &lt;Wheel xmlns=\\\"http://autoexact.com/VINDecoder/\\\" /&gt;\\r\\n&lt;/VINDescription&gt;\"\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13271858,"title":"Can't see class within DLL","body":"<p>I have created a DLL to house a class that I want to use across multiple applications, as well the DBML created by LINQ.</p>\n\n<p>The problem I am having is that the class is not visible/usable from external applications when the compiled DLL is set as a reference, although all the LINQ objects are. Also, when I manually import the .cs file then I can use the class as expected.</p>\n\n<p>I have built the class as static, and the code is as follows:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\n\nusing System.ComponentModel;\nusing System.Data;\n\nnamespace OsgShared\n{\n    static class GlobalClass\n    {\n        public static USER CurrentUser { get; set; }\n\n        private static Dictionary&lt;string,int&gt; _SysDetIDs;\n        public static Dictionary&lt;string,int&gt; SysDetIDs { get { return _SysDetIDs; } }\n\n        private static Dictionary&lt;string, int&gt; _AccInfoTypeIDs;\n        public static Dictionary&lt;string, int&gt; AccInfoTypeIDs { get { return _AccInfoTypeIDs; } }\n\n        private static Dictionary&lt;string, int&gt; _AccGroupTypeIDs;\n        public static Dictionary&lt;string, int&gt; AccGroupTypeIDs { get { return _AccGroupTypeIDs; } }\n\n        private static Dictionary&lt;string, int&gt; _EntTypeIDs;\n        public static Dictionary&lt;string, int&gt; EntTypeIDs { get { return _EntTypeIDs; } }\n\n        /// &lt;summary&gt;\n        /// Populates Dictionary objects containing database reference data\n        /// &lt;/summary&gt;\n        public static void PopulateDictionaries()\n        {\n            _SysDetIDs = new Dictionary&lt;string,int&gt;();\n            _AccInfoTypeIDs = new Dictionary&lt;string,int&gt;();\n            _AccGroupTypeIDs = new Dictionary&lt;string,int&gt;();\n            _EntTypeIDs = new Dictionary&lt;string, int&gt;();\n\n            OsgDBDataContext db = new OsgDBDataContext();\n\n            // Populates Dictionaries here\n\n            db.Dispose();\n        }\n    }\n}\n</code></pre>\n\n<p>Is there anything obviously wrong with how I've set this class up that's preventing it from appearing when used via a DLL?</p>\n\n<p>Many thanks</p>\n"},{"tags":["c#","popup","umbraco"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13270497,"title":"Creating a custom pop up for Umbraco back office","body":"<p>I am developing a multi-lingual site where content nodes are automatically copied to each language as they are created. Is there any way to implement a custom popup to confirm that it should be copied to all instead?</p>\n\n<p>Or is it possible to open a browser popup with c# as all I really need is a bool value from a message box?</p>\n\n<p>[EDIT: corrected from publish to copy]\n[EDIT2: added suggestion]</p>\n"},{"tags":["c#","tridion"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":53,"score":1,"question_id":13267701,"title":"SDL Tridion C# code fragment can't find engine, package or log fields in context","body":"<p>I'm quite new to Tridion development and I'm having my first \"basic\" issue.\nI've written a simple C# code fragment in a TBB (using content manager text editor) and I've tried to use engine, package and log fields (as I know they are made available by Tridion) but  I receive an error saying \"the name does not exist in context\".\nHere is the code:</p>\n\n<pre><code>&lt;%@ Page Language=\"C#\" ContentType=\"text/html\" ResponseEncoding=\"utf-8\" %&gt;\n&lt;div&gt;\n        &lt;!-- TemplateBeginRepeat name=\"Component.Fields.crociera\" --&gt;\n              &lt;!-- TemplateBeginIf cond=\"prezzo&lt;250\" --&gt;\n                     Go to @@location@@&lt;br/&gt;\n              &lt;!-- TemplateEndIf --&gt;\n        &lt;!-- TemplateEndRepeat --&gt;\n&lt;/div&gt;\n&lt;%\nString ts = DateTime.Now.ToString(\"d MMM yyyy\");\nResponse.Write(\"&lt;br/&gt;\"+ts);\nengine.getSession();\n%&gt;\n</code></pre>\n\n<p>When I save the TBB and publish the page I receive this error:</p>\n\n<pre><code>Compilation Error\n\nDescription: An error occurred during the compilation of a resource required to service this request. Please review the following specific error details and modify your source code appropriately. \n\nCompiler Error Message: CS0103: The name 'engine' does not exist in the current context\n\nSource Error:\n\n\nLine 31: Response.Write(\"&lt;br/&gt;\"+ts);\nLine 32: engine.getSession();\nLine 33: %&gt;                         \nLine 34:                  &lt;/div&gt;\n\nSource File: c:\\inetpub\\wwwroot\\stage\\pj\\ricerca\\ricerca.aspx    Line: 32 \n</code></pre>\n\n<p>Probably I miss something or do something wrong, does anyone recognize the problem?</p>\n"},{"tags":["c#","asp.net-mvc-3","razor"],"answer_count":5,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":313,"score":2,"question_id":8040482,"title":"Why does Razor not like this?","body":"<p>Ive got a mega annoying problem I have a view with:</p>\n\n<pre><code>@{\n\n        if(ViewBag.Section == \"Home\")\n        {\n           &lt;div id=\"headerfrontPage\"&gt;   \n        }\n        else\n        {\n            &lt;div id=\"header\"&gt;   \n        }\n\n\n     }\n</code></pre>\n\n<p>And I get a compilation error:</p>\n\n<blockquote>\n  <p>The code block is missing a closing \"}\" character.  Make sure you have\n  a matching \"}\" character for all the \"{\" characters within this block,\n  and that none of the \"}\" characters are being interpreted as markup.</p>\n</blockquote>\n\n<p>How do I conditionally write a div? Its for a hack bascially...</p>\n"},{"tags":["c#","wpf","radio-button"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":13170299,"title":"WPF Radiobutton TwoWay Binding causes always two Property calls. How to distinguish?","body":"<p>I have several RadioButtons combined in one Group so that only one can be checked. The RadioButtons are bound to boolean Properties.</p>\n\n<p>This works very well and my program reacts on the changes of these Properties.</p>\n\n<p>Suppose <code>optA</code> is selected. Next I select <code>optB</code>, the value of <code>PropertyB</code> is set to true and my program reacts accordingly. However, at this time both <code>optA</code> and <code>optB</code> are true until the Group of Radio buttons updates <code>optA</code> to false  which again triggers my \"IsSelected\" event.</p>\n\n<p>I think this is totally correct behavior...\nBut how can I distinguish between a change from the user and the automated change from the group?</p>\n\n<p>Edit: Code</p>\n\n<pre><code>&lt;RadioButton Name=\"featureCheckBox\" GroupName=\"featureRadioButtonGroup\" IsChecked=\"{Binding Path=IsSelected, Mode=TwoWay}\" /&gt;\n\n public bool IsSelected { \n\n        get{ return _isSelected; }\n        set { PropertyChanged.ChangeAndNotify(ref _isSelected, value, () =&gt; IsSelected); }\n    }\n</code></pre>\n"},{"tags":["c#","com","outlook","outlook-2010","comexception"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13271829,"title":"Outlook COMException","body":"<p>System.Runtime.InteropServices.COMException  ..Your server administrator has limited the number of items you can open simultaneously...</p>\n\n<p>at Microsoft.Office.Interop.Outlook._AppointmentItem.get_UserProperties()</p>\n\n<pre><code>        var calendar = outlookApplication.GetNamespace(\"MAPI\").GetDefaultFolder(OlDefaultFolders.olFolderCalendar);\n\n        if (calendar == null || calendar.Items == null)\n        {\n            return null;\n        }\n\n        var calendarItems = calendar.Items;\n\n        if (calendarItems != null &amp;&amp; calendarItems.Count &gt; 0)\n        {\n            // Dont convert to LINQ or foreach please -&gt; may cause Outlook memory leaks. \n            for (int counter = 1; counter &lt;= calendarItems.Count; counter++)\n            {\n                var appointment = calendarItems[counter] as AppointmentItem;\n\n                if (appointment != null)\n                {\n                    var userProperty = appointment.UserProperties.Find(\"myInformation\");\n\n                    if (userProperty != null &amp;&amp; userProperty.Value == myValue)\n                    {\n                        return appointment ;\n                    }\n                }\n            }\n        }\n</code></pre>\n\n<p>Maybe its appointment.UserProperties.Find(\"myInformation\") cause COMException?</p>\n"},{"tags":["c#","ios","monotouch","monotouch.dialog"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13267573,"title":"Updating Monotouch.Dialog RootElement","body":"<p>I have been following the code from the monotouch.dialog task sample app (http://docs.xamarin.com/ios/Guides/User_Interface/MonoTouch.Dialog/Elements_API_Walkthrough).</p>\n\n<p>Something I dont seem able to work out, is when the user clicks the + button a new row to the table is added. The user touches this and navigates to another screen where they can enter information. Now, when they navigate back to the root view, I want the list of rootElements to be updated so the entered name is used instead of the default name 'connection'</p>\n\n<p>How would I go about updating the text for each of the RootElements based upon what has been entered?</p>\n\n<p>I hope that all makes sense!</p>\n\n<p>-- code below.</p>\n\n<pre><code>public override bool FinishedLaunching (UIApplication app, NSDictionary options)\n{\n    window = new UIWindow (UIScreen.MainScreen.Bounds);\n\n    RootElement _rootElement = new RootElement (\"To Do List\"){ new Section()};\n\n    DialogViewController _rootVC = new DialogViewController (_rootElement);\n\n    // This adds an 'add' button to the root view controller, and handles by delegate,the push to a screen where you can add a new vCenter connection profile.\n    UIBarButtonItem _addButton = new UIBarButtonItem (UIBarButtonSystemItem.Add);\n    _rootVC.NavigationItem.RightBarButtonItem = _addButton;\n\n    _addButton.Clicked += (sender, e) =&gt;  {\n        var connectionProfile = new connectionProfile{};\n        // See, on the line below, I add a default RootElement with the text New Connection.\n\n        var connectionProfileElements = new RootElement (\"New Connection\") {\n            new Section () {\n                // When they enter the name on the next line of code, I want to use this to update the New Connection text on the root screen.\n                new EntryElement (\"Name\", \"Enter Connection Name\", connectionProfile._connectionName),\n                new EntryElement (\"VC Address\", \"Enter VC Address\", connectionProfile._address),\n                new EntryElement (\"VC Port\", \"Enter VC Port\", connectionProfile._port),\n                new EntryElement (\"Username\", \"Enter Username\", connectionProfile._userID),\n                new EntryElement (\"Password\", \"Enter Password\", connectionProfile._password,true)}      \n            };\n            _rootElement [0].Add (connectionProfileElements);\n        };\n\n        UINavigationController _nav = new UINavigationController (_rootVC);\n        window.RootViewController = _nav;\n        window.MakeKeyAndVisible ();\n\n        return true;\n    }\n}\n</code></pre>\n\n<p>And :</p>\n\n<pre><code>public class connectionProfile\n{\npublic connectionProfile ()\n    {\n    }\n\n    public string _connectionName { get; set; }\n    public string _address { get; set; }\n    public string _port { get; set; }\n    public string _userID {get; set; }\n    public string _password { get; set; }\n}\n</code></pre>\n"},{"tags":["c#","asp.net","post","controls"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13271705,"title":"Displaying information to the user after page processing","body":"<p>I'm (very) new to ASP.NET and am building a registration form. I built an empty web site, added <code>Register.aspx</code> and populated it with all the form elements that're usually presented on a registration page. I also made the form submit to the Register.aspx page.</p>\n\n<p>Now, I want to catch the POST data after it's submitted. I saw there was a <code>Page_Load</code> method in Register.aspx.cs, and within that I've done:</p>\n\n<pre><code>if (Request.HttpMethod == \"POST\")\n{\n    // Validate inputs and show information to the user\n}\n</code></pre>\n\n<p>But now I have no idea how I can print things to the page. After some digging I tried to use a Label control, so I put this on my Register.aspx page:</p>\n\n<pre><code>&lt;asp:Label ID=\"StatusLabel\" runat=\"server\" Text=\"\"&gt;&lt;/asp:Label&gt;\n</code></pre>\n\n<p>but when I try to access it using <code>StatusLabel.Text</code> from within Register.aspx.cs I get an error saying it doesn't exist in the current context.</p>\n\n<p>I'm thoroughly confused, how can I achieve what I want to do?</p>\n\n<p>Cheers!</p>\n"},{"tags":["c#",".net-4.0","lua","luainterface"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":950,"score":2,"question_id":5902285,"title":"LuaInterface - Compiling under .Net 3.5 / .Net 4.0 FileLoadException","body":"<p>A project of mine utilizes LuaInterface. I've begun migrating it from XNA to OpenTX, as well as rewriting it under .Net 4.0.</p>\n\n<p>I started moving my Lua class over, to find that i get an exception when debugging (FileLoadException)</p>\n\n<pre><code>Mixed mode assembly is built against version 'v2.0.50727' of the runtime and cannot be loaded in the 4.0 runtime without additional configuration information.\n</code></pre>\n\n<p>When i rebuilt LuaInterface, i changed the .Net Framework in its properties from .Net 2.0 to .Net 4.0 (as well as its client mode) and .Net 3.5.</p>\n\n<p>Both of these settings give me the error stating its still built using 2.0.</p>\n\n<p>I've attempted many solutions here at StackOverflow as well as MSDN, stating to setup an app.config and even change Application Pools for some ungodly reason...</p>\n\n<p>Anyway, every solution i've attempted failed, stating that its STILL using 2.0.</p>\n\n<p>I've used 'IL DASM' and it states its built using 3.5/4.0.</p>\n\n<p>Any ideas as to whats going on? Been messing with this all day. Am I simply being naive to think that changing a single setting could fix my problems?</p>\n\n<p>Any help would be GREATLY appreciated.</p>\n"},{"tags":["c#","windows-phone-7.1"],"answer_count":3,"favorite_count":0,"up_vote_count":13,"down_vote_count":0,"view_count":3224,"score":13,"question_id":7313291,"title":"Windows phone 7.1 ListPicker, easy way to go full mode?","body":"<p>I'm trying to use the <code>ListPicker</code> controller with <code>ListPickerMode=\"Full\"</code>, to get the fullscreen pick window. However it just generate an error when i try</p>\n\n<p>\"A first chance exception of type 'System.Windows.Markup.XamlParseException' occurred in System.Windows.dll</p>\n\n<p>Additional information: Set property <code>Microsoft.Phone.Controls.ListPicker.ListPickerMode</code> threw an exception. [Line: 49 Position: 57]\"</p>\n\n<p>Here's my code:</p>\n\n<pre><code>&lt;toolkit:ListPicker x:Name=\"OutputSelector\" ListPickerMode=\"Full\"   \nMargin=\"0,542,6,0\" Header=\"Output Type\" Width=\"450\" VerticalAlignment=\"Top\" /&gt;\n</code></pre>\n\n<p>I populate my ListPicker in C# using a list to set as ItemSource if that is any help.\nAnother thing is that when i try to write \"ListPickerMode\" in xml it doest give it as an option, but when i have written the whole thing it suggest \"Full\" \"expanded\" and \"Normal\".</p>\n\n<p>If i add 5 items to the ListPicker it automatically uses FullMode, and i have tried changing ItemCountThreshold=\"0\" but that just generate more errors.</p>\n\n<p>I'm using Windowns Phone 7.1 OS 2011 aug release.</p>\n\n<p>It's probably just me that is stupid, first day with Windows Phone programing :)</p>\n\n<p>UPDATE!</p>\n\n<p>Well it looks like ItemCountThreshold &amp; ListPickerMode was remove for 7.1 or something, atleast in XAML part, not the C# part, where they are read only.</p>\n\n<p>Solution for my problem!</p>\n\n<pre><code>&lt;toolkit:ListPicker x:Name=\"OutputSelector\" ExpansionMode=\"FullScreenOnly\"   \nMargin=\"0,542,6,0\" Header=\"Output Type\" Width=\"450\" VerticalAlignment=\"Top\" /&gt;\n</code></pre>\n\n<p>The ExpansionMode will make the Listpicker appear in fullscreen or expanded.</p>\n"},{"tags":["c#","crystal-reports","dataset","subreport"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13271748,"title":"Using Subreport in main crystal report","body":"<p>I need to create a crystal report using 2 Datatable\nName of Dataset is Dataset1\nand two datatables are :\n1.Booking_details\n2.av_details</p>\n\n<p>Using these two Datasets I need to create 1 crystal report.</p>\n\n<p>What i did was used subreport,\nmain report will contain Booking_details, and \nsubreport will contain av_details.</p>\n\n<p>However, I am able to get details on main report, but subreport just shows heading rest is blank.</p>\n\n<p>Here are my codes :</p>\n\n<pre><code>    private void crystalReportViewer1_Load(object sender, EventArgs e)\n    {\n        DataSet1 ds = new DataSet1();\n        Printfpreport printfp = new Printfpreport();\n        Printfpsubreport printfpsub = new Printfpsubreport();\n       // printbillbooking printfp = new printbillbooking();\n        printfp.SetDataSource(dt);\n        printfpsub.SetDataSource(dt_av);\n\n        crystalReportViewer1.ReportSource = printfp;\n\n        //crystalReportViewer1.ReportSource = printfpsub;\n        crystalReportViewer1.Refresh();\n\n\n    }\n</code></pre>\n\n<p>If you need any more info do let me know wil post it .</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","wpf","workflow-foundation-4","workflowservice"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":13199533,"title":"Workflow Service custom tracking participant that talks to an client-side endpoint(s)?","body":"<p>I'm at the investigative stage for Workflow Service and WPF.</p>\n\n<p>Having State Machine WF Service hosted in IIS and one or more WPF clients talking to the WF Service sounds reasonable choice so far.</p>\n\n<p>However, although days of reading and research it isn't clear to me what would be the best strategy for tracking the transfer between states from WPF app.</p>\n\n<p>There're numerous samples of tracking participants but most of them are based on One process scenario. </p>\n\n<p>So I am thinking of a structure as below.</p>\n\n<ol>\n<li>A server-side WCF operation that any client calls to register its client-side endpoint</li>\n<li>A custom tracking participant that goes through all registered client-side endpoints and sends TrackingRecord at it's Track() method.</li>\n</ol>\n\n<p>Advantage of this approach is that it allows real time update of the states without extra layers like ETW. Another advantage is that it allows decoupling of the logic (or maybe model layer) from the presentation layer.</p>\n\n<p>Can anyone share the opinion over the above structure?\nI would also welcome any suggestions for achieving the goal.</p>\n\n<hr>\n\n<p>[EDIT]\nTo make my idea above more detailed and clear, below steps would be a typical usage.</p>\n\n<p>1) (WPF client) contains and opens a WCF endpoint for receiving TrackRecords.</p>\n\n<p>2) (WF Service) opens a WCF operation (or a simple WF instance with a Receive message) that registers client-side address to an internal store.</p>\n\n<p>3) (WF Service) a custom tracking participant is created and added that will send TrackingRecord to the registered clients' endpoints.</p>\n\n<p>4) (client) connects to the above service and hands out client-side endpoint mentioned at step 1 and consequently receives TrackingRecords.</p>\n"},{"tags":["c#",".net","naudio"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13266904,"title":"NAudio WaveOut Device ID","body":"<p>I need select waveout device, to play sound. But I cant do that. </p>\n\n<pre><code>void Initialize()\n{\n_WaveOut = new WaveOut();\nvar reader = new WaveFileReader(FileName);\n_WaveOut.Init(new WaveChannel32(reader));\n}\n</code></pre>\n\n<p>This function starts, then the form start. After this on my form, I select waveout device with combobox. Combobox is filles with this code:</p>\n\n<pre><code>for (int i = 0; i &lt; WaveOut.DeviceCount; i++)\n{\n     WaveOutCapabilities WOC = WaveOut.GetCapabilities(i);\n     comboBox2.Items.Add(WOC.ProductName);\n\n}\n</code></pre>\n\n<p>After this, I select my device.</p>\n\n<pre><code>int WaveOutDeviceId = comboBox2.SelectedIndex;\n</code></pre>\n\n<p>And start Play function:</p>\n\n<pre><code>void Play()\n{\n_WaveOut.DeviceNumber = WaveOutDeviceId;\n_WaveOut.Play();\n}\n</code></pre>\n\n<p>But my sound always play on default device (With number = 0). If I do this for microphone, this code works correctly.</p>\n"},{"tags":["c#","asp.net","json"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":40,"score":-1,"question_id":13271158,"title":"Way to Deserialize JSON from HttpWebResponse","body":"<p>I'm trying to figure out the best way to parse incoming JSON server-side in .NET 3.5.\nI am receiving \"title\" from HttpWebResponse in JSON Formate. so i have to retrieve each title and store in the database. so please provide the code for retrieving each title.  </p>\n\n<pre><code>public class MyObject\n{\n    public ArrayList list { get; set; }\n}\n\n    var request = WebRequest.Create(\"https://api.dailymotion.com/videos?fields=description,thumbnail_medium_url%2Ctitle&amp;search=Good+Morning\");\n    using (var twitpicResponse = (HttpWebResponse)request.GetResponse())\n    {\n        using (var reader = new StreamReader(twitpicResponse.GetResponseStream()))\n        {\n            JavaScriptSerializer js = new JavaScriptSerializer();\n            string objText = reader.ReadToEnd();\n            MyObject myojb = (MyObject)js.Deserialize(objText, typeof(MyObject));\n        }\n    }\n</code></pre>\n\n<p>I am receiving Title in the myojb but how to retrieve Each Title from myojb.</p>\n"},{"tags":["c#","asp.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13271385,"title":"Stop the response from writing a file when there is an access denied error","body":"<p>I have the following code</p>\n\n<pre><code>try\n{        \n    GetFileAndDisplay() // Gets the file from the server and writes the file in a Response stream\n}\ncatch (UnauthorizedAccessException ex)\n{\n    Page.ClientScript.RegisterStartupScript(this.GetType(), \"Msg\", \"&lt;script type='text/javascript'&gt;alert('Error')&lt;/script&gt;\");\n    Response.Clear();                \n    Response.ContentType = \"\";               \n    Response.End();                \n}\n</code></pre>\n\n<p>The file still gets downloaded for the client, albeit a corrupted file but is there a way to stop the file from downloading.</p>\n"},{"tags":["c#","encoding","converter","windows-media-encoder"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13254151,"title":"C# WMEncoder Error C00D002E","body":"<p>I wrote a Windows Service Code to convert AVI to WMV file.\nI'm using XviD, and Windows Media 9, in a Windows Vista.\nThe service starts converting, and stops before completing the job, with a WMENC_ENCODER_STOPPED status, but the file was not fully converted. And the resulting file stays locked to this application forever, until I stop the service. And when I do so, that resulting file is automatically deleted.\nCan anyone, please, help? It is important !!</p>\n\n<p>EDIT: This program works constantly, executing conversion tasks. If a file fails to convert as described above, and I use the function GC.WaitForPendingFinalizers(), I still have the locking problem. But the service goes on, and pick another task. Succeeding or failing this new task, when I use GC.WaitForPendingFinalizers(), the first one is unlocked, and automatically deleted.</p>\n\n<pre><code>            public WMENC_ENCODER_STATE EncoderStatus\n    {\n        get { return _encoderStatus; }\n        set { _encoderStatus = value; }\n    }\n\n    IWMEncFile2 File;\n    IWMEncAudioSource[] SrcAud;\n    IWMEncVideoSource2[] SrcVid;\n    IWMEncSourceGroup2[] SrcGrp;\n    WMEncoder glbEncoder = new WMEncoder();\n    WMEncProfile2[] Pro = null;\n    IWMEncSourceGroupCollection SrcGrpColl = null;\n\n    public WMVEnconder(ConvertGroup[] sourceGroup, string targetFile, string profilefile)\n    {\n        glbEncoder.OnStateChange += new _IWMEncoderEvents_OnStateChangeEventHandler(Encoder_OnStateChange);\n        glbEncoder.OnError +=new _IWMEncoderEvents_OnErrorEventHandler(Encoder_OnError);\n\n        // Creates source group.\n        SrcGrpColl = glbEncoder.SourceGroupCollection;\n\n        int[] intProVBRModeAudio = new int[sourceGroup.Length];\n        int[] intProVBRModeVideo = new int[sourceGroup.Length];\n        Int32[] intProContentType = new int[sourceGroup.Length];\n        Pro = new WMEncProfile2[sourceGroup.Length];\n        for (int i = 0; i &lt; Pro.Length; i++)\n        {\n            Pro[i] = new WMEncProfile2();\n            Pro[i].LoadFromMemory(profilefile);\n            intProContentType[i] = Pro[i].ContentType;\n            intProVBRModeAudio[i] = (int)Pro[i].get_VBRMode(WMENC_SOURCE_TYPE.WMENC_AUDIO, 0);\n            intProVBRModeVideo[i] = (int)Pro[i].get_VBRMode(WMENC_SOURCE_TYPE.WMENC_VIDEO, 0);\n        }\n\n        SrcGrp = new IWMEncSourceGroup2[sourceGroup.Length];\n        for (int i = 0; i &lt; SrcGrp.Length; i++)\n            SrcGrp[i] = (IWMEncSourceGroup2)SrcGrpColl.Add(i.ToString());\n\n        SrcAud = new IWMEncAudioSource[sourceGroup.Length];\n        SrcVid = new IWMEncVideoSource2[sourceGroup.Length];\n\n        for (int i = 0; i &lt; sourceGroup.Length; i++)\n        {\n            if (intProContentType[i] == 1)\n            {\n                SrcAud[i] = (WMEncoderLib.IWMEncAudioSource)SrcGrp[i].AddSource(WMENC_SOURCE_TYPE.WMENC_AUDIO);\n                SrcAud[i].SetInput(sourceGroup[i].AudioFile, \"\", \"\");\n\n                SrcAud[i].MarkIn = sourceGroup[i].AudioMarkin;\n                SrcAud[i].MarkOut = sourceGroup[i].AudioMarkout;\n            }\n            else if (intProContentType[i] == 16)\n            {\n                SrcVid[i] = (WMEncoderLib.IWMEncVideoSource2)SrcGrp[i].AddSource(WMENC_SOURCE_TYPE.WMENC_VIDEO);\n                SrcVid[i].SetInput(sourceGroup[i].VideoFile, \"\", \"\");\n\n                SrcVid[i].MarkIn = sourceGroup[i].VideoMarkin;\n                SrcVid[i].MarkOut = sourceGroup[i].VideoMarkout;\n            }\n            else if (intProContentType[i] == 17)\n            {\n                SrcAud[i] = (WMEncoderLib.IWMEncAudioSource)SrcGrp[i].AddSource(WMENC_SOURCE_TYPE.WMENC_AUDIO);\n                SrcAud[i].SetInput(sourceGroup[i].AudioFile, \"\", \"\");\n\n                SrcVid[i] = (WMEncoderLib.IWMEncVideoSource2)SrcGrp[i].AddSource(WMENC_SOURCE_TYPE.WMENC_VIDEO);\n                SrcVid[i].SetInput(sourceGroup[i].VideoFile, \"\", \"\");\n\n                SrcAud[i].MarkIn = sourceGroup[i].AudioMarkin;\n                SrcAud[i].MarkOut = sourceGroup[i].AudioMarkout;\n                SrcVid[i].MarkIn = sourceGroup[i].VideoMarkin;\n                SrcVid[i].MarkOut = sourceGroup[i].VideoMarkout;\n            }\n            else\n                throw new Exception(\"erro - não suporta este tipo de profile\");\n\n            SrcGrp[i].set_Profile(Pro[i]);\n\n            if (i + 1 &lt; sourceGroup.Length)\n                SrcGrp[i].SetAutoRollover(-1, (i + 1).ToString());\n        }\n\n        File = (IWMEncFile2)glbEncoder.File;\n        File.LocalFileName = targetFile;\n\n        glbEncoder.PrepareToEncode(true);\n    }\n    /// &lt;summary&gt;\n    /// Inicia os processos do codificador.\n    /// &lt;/summary&gt;\n    public void Start()\n    {\n        glbEncoder.Start();\n    }\n    /// &lt;summary&gt;\n    /// Pára os processos do codificador.\n    /// &lt;/summary&gt;\n    public void Stop()\n    {\n        glbEncoder.Stop();\n    }\n    /// &lt;summary&gt;\n    /// Elimina as configurações atuais.\n    /// &lt;/summary&gt;\n    public void Reset()\n    {\n        glbEncoder.Reset();\n    }\n    /// &lt;summary&gt;\n    /// Evento deflagrado pela mudança no estado do codificador.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"enumState\"&gt;Enumerador indicador do estado do codificador.&lt;/param&gt;\n    private void Encoder_OnStateChange(WMEncoderLib.WMENC_ENCODER_STATE enumState)\n    {\n        _encoderStatus = enumState;\n        string strRunState = \"\";\n        switch (enumState)\n        {\n            case WMENC_ENCODER_STATE.WMENC_ENCODER_STARTING :\n                strRunState = \"Encoder Starting\";\n                break;\n            case WMENC_ENCODER_STATE.WMENC_ENCODER_RUNNING:\n                strRunState = \"Encoder Running\";\n                break;\n            case WMENC_ENCODER_STATE.WMENC_ENCODER_END_PREPROCESS:\n                strRunState = \"Encoder End Preprocess\";\n                break;\n            case WMENC_ENCODER_STATE.WMENC_ENCODER_PAUSING:\n                strRunState = \"Encoder Pausing\";\n                break;\n            case WMENC_ENCODER_STATE.WMENC_ENCODER_PAUSED:\n                strRunState = \"Encoder Paused\";\n                break;\n            case WMENC_ENCODER_STATE.WMENC_ENCODER_STOPPING:\n                strRunState = \"Encoder Stopping\";\n                break;\n            case WMENC_ENCODER_STATE.WMENC_ENCODER_STOPPED:\n                strRunState = \"Encoder Stopped\";\n                break;\n        }\n        _strEncoderStatus = strRunState;\n    }\n    /// &lt;summary&gt;\n    /// Evento deflagrado pela ocorrência de um erro durante o processo de codificação.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"hr\"&gt;Valor numérico do erro que ocorreu.&lt;/param&gt;\n    private void Encoder_OnError(int hr)\n    {\n        string errorReceived = \"\";\n\n        switch (hr)\n        {\n            case -1074600792:\n                errorReceived = \"The starting time must be greater than zero and less than the ending time.\";\n                break;\n            case -1074600793:\n                errorReceived = \"The ending time must be greater than the starting time and less than the file duration.\";\n                break;\n            case -1074600804:\n                errorReceived = \"The video capture device is in use and cannot be opened.\";\n                break;\n            case -1074600808:\n                errorReceived = \"The video capture driver returned an unrecoverable error.\";\n                break;\n            case -1074600809:\n                errorReceived = \"The video capture device did not start.\";\n                break;\n            case -1074600813:\n                errorReceived = \"The video capture window was not created.\";\n                break;\n            case -1074600820:\n                errorReceived = \"The specified operation is not allowed when the file is being archived.\";\n                break;\n            case -1074600825:\n                errorReceived = \"The archive file name is not properly specified.\";\n                break;\n            case -1074600831:\n                errorReceived = \"The specified operation is not allowed when the encoder engine is not running.\";\n                break;\n            case -1074600833:\n                errorReceived = \"Inverse telecine cannot be specified when the frame rate does not equal 30 frames per second.\";\n                break;\n            case -1074600834:\n                errorReceived = \"Internal problems are preventing the preview or postview.\";\n                break;\n            case -1074600835:\n                errorReceived = \"One or more required codecs cannot be found.\";\n                break;\n            case -1074600840:\n                errorReceived = \"The display size or color setting has changed since the encoding session was defined.\";\n                break;\n        }\n\n        try\n        {\n            if (Directory.Exists(@\"C:\\MediaDNA_V2\\Data\\Conversion\\Exception\"))\n            {\n                MediaDNAException mdnaException = new MediaDNAException(Modulo.CONVERSION, 0, \"C_110018\", TipoErro.INFORMACAO, new Exception(errorReceived),\n                    ErrorMessageConstants.C_110018, new object[] { hr.ToString(\"X\") });\n                ExceptionManager.RegisterException(mdnaException, @\"C:\\MediaDNA_V2\\Data\\Conversion\\Exception\");\n            }\n        }\n        catch { }\n    }\n\n    #region IDisposable Members\n    /// &lt;summary&gt; Release everything. &lt;/summary&gt;\n    public void Dispose()\n    {\n        glbEncoder.Stop();\n        glbEncoder.Reset();\n        GC.SuppressFinalize(this);\n        CloseInterfaces();\n    }\n    #endregion\n\n    /// &lt;summary&gt;\n    /// Fecha as interfaces utilizadas pelo codificador.\n    /// Obs: O processador precisa estar \"STOPPED\" para executar este processo.\n    /// &lt;/summary&gt;\n    private void CloseInterfaces()\n    {\n        if (glbEncoder != null)\n        {\n            if (File != null)\n                Marshal.FinalReleaseComObject(File);\n            if (Pro != null)\n            {\n                for (int i = 0; i &lt; Pro.Length; i++)\n                    Marshal.FinalReleaseComObject(Pro[i]);\n\n                Pro = null;\n            }\n            if (SrcVid != null)\n            {\n                for (int i = 0; i &lt; SrcVid.Length; i++)\n                    Marshal.FinalReleaseComObject(SrcVid[i]);\n\n                SrcVid = null;\n            }\n            if (SrcAud != null)\n            {\n                for (int i = 0; i &lt; SrcAud.Length; i++)\n                    Marshal.FinalReleaseComObject(SrcAud[i]);\n\n                SrcAud = null;\n            }\n            if (SrcGrpColl != null)\n                Marshal.FinalReleaseComObject(SrcGrpColl);\n            if (SrcGrpColl != null)\n                Marshal.FinalReleaseComObject(SrcGrpColl);\n            if (glbEncoder != null)\n                Marshal.FinalReleaseComObject(glbEncoder);\n            GC.Collect();\n            GC.WaitForPendingFinalizers();\n            GC.Collect();\n        }\n    }\n</code></pre>\n"},{"tags":["c#","wpf","xaml","data-binding"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13271689,"title":"WPF combobox ItemTemplate does not apply","body":"<p>I have a combobox, which is bound to a dictionary of </p>\n\n<pre><code>&lt;int, MyObject&gt;\n</code></pre>\n\n<p>by the following code:</p>\n\n<pre><code>this.comboBox.ItemsSource= dictionary;\n</code></pre>\n\n<p>MyObject has some public properties, such as Name (string) and Selected (boolean). </p>\n\n<p>In my Xaml I have an ItemTemplate on comboBox:</p>\n\n<pre><code>&lt;ComboBox.ItemTemplate&gt;\n    &lt;DataTemplate&gt;\n        &lt;TextBlock Text=\"{Binding Path=Key, Mode=OneWay}\"/&gt;\n    &lt;/DataTemplate&gt;\n&lt;/ComboBox.ItemTemplate&gt;\n</code></pre>\n\n<p>When I run the app, I get the combobox filled with [1, MyObject] values. </p>\n\n<p>What I eventually want to do is have a checkbox and a textblock in the ItemTemplate, which will be bound to MyObject.Selected and MyObject.Name. At the moment, I can't even get the datatemplate to display the dictionaty Key value.</p>\n\n<p>Any ideas why the itemtemplate is being ignored? I've tried the full temeplate (stack planel containing a combobox and textblock), that showed the same values at runtime.</p>\n\n<p>cheers.</p>\n"},{"tags":["c#","windows","visual-studio-2010","visual-studio","internet-explorer"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13271684,"title":"Create a custom security manager (IInternetSecurityManager)","body":"<p>I need to create a custom security manager (c#) with IInternetSecurityManager to enable all the security options (especially i need to enable cookies) in the WebBrowser Control.\nI need some sample code. </p>\n\n<p>thanks to all,\nRiccardo.</p>\n"},{"tags":["c#","epub","watermark"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13271615,"title":"How do I watermark an existing .epub file?","body":"<p>May I know which strategy I've to follow in order to watermark an existing epub file? Any suggestion for existing code or libraries?</p>\n\n<p>In particular i'd like to insert the watermark in ONE page of the document.</p>\n"},{"tags":["c#",".net"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":23,"score":1,"question_id":13271673,"title":"install voice for C# SpeechSynthesizer class","body":"<p>How can I add voice for <code>SpeechSynthesizer</code> to use for \"text to speech\" in C#</p>\n"},{"tags":["c#","unity",".net-assembly","utf"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":13254864,"title":"Spanish Characters in C#","body":"<p>I am currently working on a Spanish translation program that uses HtmlDocument to access the Google translate website. I am programming in Assembly C# in Unity. Shown below is my current code for accessing Google:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing UnityEngine;\nusing System.Collections;\nusing System.Net;\nusing HtmlAgilityPack;\n\n\npublic class Dictionary{\n    string[] formatParams;\n    HtmlDocument doc;\n    string returnString;\n    char[] letters;\n    public Dictionary(){\n        formatParams = new string[2];\n        doc = new HtmlDocument();\n        returnString = \"\";\n    }\n    public string Translate(String input, String languagePair, Encoding encoding)\n    {\n        formatParams[0]= input;\n        formatParams[1]= languagePair;\n        string url = String.Format(\"http://www.google.com/translate_t?hl=en&amp;ie=UTF8&amp;text={0}&amp;langpair={1}\", formatParams);\n\n        string result = String.Empty;\n\n        using (WebClient webClient = new WebClient())\n        {\n            webClient.Encoding = encoding;\n            result = webClient.DownloadString(url);\n        }       \n        doc.LoadHtml(result);\n        input = alter (input);\n        return doc.DocumentNode.SelectSingleNode(\"//span[@title='\"+input+\"']\").InnerText;\n    }\n    // Use this for initialization\n    void Start () {\n\n    }\n    string alter(string inputString){\n        returnString = \"\";\n        letters = inputString.ToCharArray();\n        for(int i=0; i&lt;inputString.Length;i++){\n            if(letters[i]=='\\''){\n                returnString = returnString + \"&amp;#39;\";  \n            }else{\n                returnString = returnString + letters[i];   \n            }\n        }\n        return returnString;\n    }\n}\n</code></pre>\n\n<p>The code is accessed by:</p>\n\n<pre><code>    search = new Dictionary();\n    input = \" \";\n    temp = \" \";\n    returnString = \"\";\n    code = Encoding.UTF8;\n\n    search.Translate(input,\"en|es\",code);\n</code></pre>\n\n<p>This code does work successfully, if you put \"Hello\" as input, it will return \"Hola\". However, if you set input as \"How are you?\" it will return \"Cmo ests\". I have done research and have discovered that using UTF8 will not display special characters, which I need for Spanish(and other languages). I have read that using UTF16 will fix this error, however, when I write:</p>\n\n<pre><code>code = Encoding.UTF16;\n</code></pre>\n\n<p>Another error pops up saying :</p>\n\n<pre><code>Assets/GUIScript.cs(26,33): error CS0117: `System.Text.Encoding' does not contain a definition for `UTF16'\n</code></pre>\n\n<p>If anyone knows the code to properly implement UTF16 or to fix my issue with special character, any help would be greatly appreciated.</p>\n"},{"tags":["c#","jquery","validation",".net-3.5","asp.net-webforms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13248154,"title":"jQuery Validation with ASP.NET C# Web Forms","body":"<p>I'm having a bit of an awkward problem with jquery validation (which is brilliant) and asp.net web forms. I presume its an issue with how the forms are used in this framework but anyway here's the issue.</p>\n\n<ol>\n<li>I have a page which has a number of fields for an employee to fill out, when he/she submits/saves the record (asp.net button control) the validation rules trigger and display relative errors if present (seems to work, rules need work but that irrelevant for the minute).</li>\n<li>The validations trigger correctly and list at the bottom of the screen, however if i click anywhere on the screen the jQuery seems to fire again and displays only the first error (same with any sort of key press/minimization of the screen). When that error is corrected the next in the list appears and so on...</li>\n</ol>\n\n<p><strong>Note:</strong></p>\n\n<p>My form is in the master page which has a content placeholder within it and the .net version is 3.5 (unfortunately limited by the servers I'm working on).</p>\n\n<p>If anybody could help, that would be great :D.</p>\n\n<pre><code>    $(document).ready(function () {\n        $('.txt')\n        .focus(function () { \n            $('.txt').removeClass('focused');\n            $(this).addClass('focused'); \n        })\n        .blur(function () { \n            $(this).removeClass('focused'); \n        });\n\n\n        //Fire validation events\n        $(\"#aspnetForm\").validate({\n            //Setting validations rules like, Required, Minimum or Maximum Length, Data Type etc.\n            rules:\n            {\n                //Set name of tag to validate: Name = UniqueID\n                &lt;%= txtPointCode.UniqueID %&gt; : { required: true, minlength: 5, maxlength: 10 },\n                &lt;%= txtPointName.UniqueID %&gt; : { required: true, minlength: 5, maxlength: 10 },\n                &lt;%= txtPointLocalName.UniqueID %&gt; : { required: true, minlength: 5, maxlength: 10 },\n                &lt;%= txtPortCode.UniqueID %&gt; : { required: true, minlength: 5, maxlength: 10 },\n                &lt;%= txtCountryCode.UniqueID %&gt; : { required: true, minlength: 5, maxlength: 10 },\n                &lt;%= txtCountryName.UniqueID %&gt; : { required: true, minlength: 5, maxlength: 10 },\n                &lt;%= txtAreaName.UniqueID %&gt; : { required: true, minlength: 5, maxlength: 10 },\n                &lt;%= txtRegionName.UniqueID %&gt; : { required: true, minlength: 5, maxlength: 10 },\n                &lt;%= txtContinentName.UniqueID %&gt; : { required: true, minlength: 5, maxlength: 10 }\n            },\n            //Contextual error messages for each selected field\n            messages:\n            {\n                &lt;%= txtPointCode.UniqueID %&gt; : \"This field cannot be empty, please enter between 5 - 10 characters.\",\n                &lt;%= txtPointName.UniqueID %&gt; : \"This field cannot be empty, please enter between 5 - 10 characters.\",\n                &lt;%= txtPointLocalName.UniqueID %&gt; : \"This field cannot be empty, please enter between 5 - 10 characters.\",\n                &lt;%= txtPortCode.UniqueID %&gt; : \"This field cannot be empty, please enter between 5 - 10 characters.\",\n                &lt;%= txtCountryCode.UniqueID %&gt; : \"This field cannot be empty, please enter between 5 - 10 characters.\",\n                &lt;%= txtCountryName.UniqueID %&gt; : \"This field cannot be empty, please enter between 5 - 10 characters.\",\n                &lt;%= txtAreaName.UniqueID %&gt; : \"This field cannot be empty, please enter between 5 - 10 characters.\",\n                &lt;%= txtRegionName.UniqueID %&gt; : \"This field cannot be empty, please enter between 5 - 10 characters.\",\n                &lt;%= txtContinentName.UniqueID %&gt; : \"This field cannot be empty, please enter between 5 - 10 characters.\"\n            },\n\n            //A custom message display handler. Gets the map of errors as the first argument and and array of errors as the second, \n            //called in the context of the validator object.\n            showErrors: function (errorMap, errorList)\n            {\n                var messages = \"\";\n                var errorCount = 0;\n\n                //Error builder\n                $.each(errorList, function (index, value) {\n                    var id = $(value.element).attr('id');\n                    var elementName = $(value.element).attr('name').split('txt'); //Strip out UniqueID obfuscation\n\n                    messages += \"&lt;span&gt;\" + (index + 1) + \". | &lt;a noref title=\\\"Click to view field\\\" onClick=\\\"setFocus('\" + id + \"');\\\"&gt;[\" + elementName[1] + \"]&lt;/a&gt; | \" + value.message + \"&lt;/span&gt;&lt;br/&gt;\";\n                    errorCount++;\n                });\n\n                messages = \"&lt;div class='errorWrapper'&gt;&lt;hr&gt;&lt;h1&gt;Please correct the following \" + errorCount + \" errors:&lt;/h1&gt;&lt;br /&gt;&lt;br /&gt;\" + messages + \"&lt;/div&gt;\";\n\n                //Display error summary with slide animation\n                $('#summary-validation').html(messages);\n                $('#summary-validation').show(\"fast\");\n            },\n\n            //If all validations are successfully validate then execute submitHandler function\n            submitHandler: function ()\n            {\n                $('#summary-validation').empty();\n                //alert(\"All fields are valid!\");\n                $(\"#aspnetForm\").submit();\n            },\n            onkeyup: false, //Stops validation refresh on occurances of certain key presses\n            onfocusout: false //Stops validation refresh when element loses focus\n        });\n        //-------------------------------------------------------------------------------\n    });\n    //If validation errors are occured in any field, it will display field name with link, clicking on link it will set focus of perticular field.            \n    function setFocus(ele)\n    {\n        document.getElementById(ele).focus();\n        //$(ele).focus();\n    }\n</code></pre>\n"},{"tags":["c#","documentation","xsd","annotations","element"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13271347,"title":"Xsd documentation value","body":"<p>how can I create xsd documentation programatically?\nExample:</p>\n\n<pre><code>&lt;xs:annotation&gt;\n&lt;xs:documentation&gt;Documentation&lt;/xs:documentation&gt;\n&lt;/xs:annotation&gt;\n</code></pre>\n\n<p>I used:</p>\n\n<pre><code> XmlSchemaElement element = new XmlSchemaElement();\n    XmlSchemaAnnotation annotation = new XmlSchemaAnnotation();\n    XmlSchemaDocumentation doc = new XmlSchemaDocumentation();\n\n    //doc.Value = \"Documentation\"; ??\n    annotation.Items.Add(doc);\n    element.Annotation = annotation;\n</code></pre>\n\n<p>but how do I set documentation value? There is no such property in XmlSchemaDocumentation type. Thanks!</p>\n"},{"tags":["c#",".net","visual-studio-2010","unit-testing"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":534,"score":1,"question_id":8921064,"title":"Unit test project not building from build server","body":"<p>My VS2010 solution has a test project in it.  The unit tests themselves reference the following namespace:</p>\n\n<pre><code>using Microsoft.VisualStudio.TestTools.UnitTesting;\n</code></pre>\n\n<p>which is accessed via the following assembly on my PC:</p>\n\n<pre><code>Assembly Microsoft.VisualStudio.QualityTools.UnitTestFramework\n    C:\\Program Files (x86)\\Microsoft Visual Studio 10.0\\Common7\\IDE\\\n    PublicAssemblies\\Microsoft.VisualStudio.QualityTools.UnitTestFramework.dll\n</code></pre>\n\n<p>When I build the solution on my PC I have no issues; the tests will build and run okay.</p>\n\n<p>We have an intranet page which we can use to kick off builds on a build server.  When I build via this page, the build fails with the following errors:</p>\n\n<pre><code>Generator.cs(3,17): error CS0234: The type or namespace name 'VisualStudio' \ndoes not exist in the namespace 'Microsoft' (are you missing an assembly\nreference?)\n</code></pre>\n\n<p>The obvious problem would be that the <code>Microsoft.VisualStudio.QualityTools.UnitTestFramework.dll</code> mentioned above is not present on the build server.  I thought this was would be installed with VS2010, and since the projects in my solution build .NET 4.0 targets, I would expect this to be installed on the build server.</p>\n\n<p>What is the easiest way to resolve this?  The build server is out of my jurisdiction and I don't particular want to log a job to get new libraries installed on to it.</p>\n"},{"tags":["c#","tabcontrol"],"answer_count":13,"favorite_count":1,"up_vote_count":14,"down_vote_count":1,"view_count":25685,"score":13,"question_id":418006,"title":"How can I disable a tab inside a TabControl?","body":"<p>Is there any way to disable a tab in a tabcontrol?</p>\n\n<p>I am using C#.</p>\n"},{"tags":["c#"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":63,"score":-1,"question_id":13271191,"title":"How to create game highscores with names?","body":"<p>I have a simple game and I want to save highscores with names, then on another form show it, but in descending order of points.\nI want to do it with txt file, and saving is ok, I just save like: Adam,200,John,100 etc. Showing them is also not problem but how to sort them? So how can I connect the scores with the names?</p>\n"},{"tags":["c#","database","razor","webmatrix"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":91,"score":1,"question_id":10286353,"title":"Need Help to solve and understand this error: Exception Details: System.InvalidOperationException: 2","body":"<p>I got this error:</p>\n\n<pre><code>Exception Details: System.InvalidOperationException: 2 : String truncation: max=0, len=1, value='3'.\n</code></pre>\n\n<p>From this set of code:</p>\n\n<pre><code>var reqcategory=Request[\"category\"];\n        foreach (var cat in reqcategory)\n        {\n        var sql5 = \"SELECT Type.PreReq1, Type.PreReq2, (CASE WHEN (Type.PreReq1 IS NOT   NULL) AND (PermitApp1.RPClass IS NULL) AND (PermitApp1.RPCategory IS NULL) THEN 1 ELSE 0 END) AS missing1, (CASE WHEN (Type.PreReq2 IS NOT NULL) AND (PermitApp2.RPClass IS NULL)AND (PermitApp2.RPCategory IS NULL) THEN 1 ELSE 0 END) AS missing2 FROM Type LEFT JOIN PermitApp AS PermitApp1 ON (Type.PreReq1=PermitApp1.RPClass) OR (Type.PreReq1=PermitApp1.RPCategory) AND ( PermitApp1.CDSID = @0 ) AND (PermitApp1.MDecision='1') LEFT JOIN PermitApp AS PermitApp2 ON (Type.PreReq2=PermitApp2.RPClass) OR (Type.PreReq2=PermitApp2.RPCategory) AND ( PermitApp2.CDSID = @1 ) AND (PermitApp2.MDecision='1') WHERE Type.PType = @2\";\n        var result = db.QuerySingle(sql5, myCDSID, username, cat);\n        var miss1 = result.missing1;\n        var miss2 = result.missing2;\n\n\n        if(miss1 == '1' || miss2 == '1'){\n            ModelState.AddError(\"missing\", \"You have not met the Pre-Requisites for \"+ cat +\" yet.\");\n            } else if (miss1 == '0' &amp;&amp; miss2 == '0'){\n\n        Session[\"license\"] = Request[\"licence\"];\n        Session[\"from\"] = Request[\"from\"];\n        Session[\"to\"] = Request[\"to\"];\n        Session[\"group\"] = Request[\"group\"];\n        Session[\"class1\"] = Request[\"class1\"];\n        Session[\"category1\"] = Request[\"category1\"];\n        Session[\"class\"] = Request[\"class\"];\n        Session[\"category\"] = Request[\"category\"];\n        Response.Redirect(\"~/Questionnaire\");\n        }\n        }\n</code></pre>\n\n<p>the highlighted line was :</p>\n\n<pre><code>var result = db.QuerySingle(sql5, myCDSID, username, cat);\n</code></pre>\n\n<p>I don't understand what was mentioned on the error page and i could not find someone in the same case as my. Thanks</p>\n"},{"tags":["c#","com","vfp"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12904209,"title":"COM Integration","body":"<p>I have a COM object developed in C# which will be consumed in VFP. The object can be loaded by the vfp project on the dev system, by copying the c# dll into the vfp project's main directory, and registering it. I am running the vfp project installed rather than in the vfp environment. In other words, vfp is not open on my dev system, but vs2010 is.. However, the dll project obviously is not being run.</p>\n\n<p>When I move to the test machine, which has neither vfp nor vs, drop in the dll, register it, and try running, nothing happens. Unfortunately, no errors are generated in vfp, and I cannot make changes to the vfp code.</p>\n\n<p>Is there some trick that I need to do before a COM object will run on a system, or some type of registration that VS may have done with the dll on the dev system? </p>\n\n<p>Thank you for any assistance. It is greatly appreciated.</p>\n"},{"tags":["c#","linq"],"answer_count":6,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":1190,"score":6,"question_id":7809745,"title":"Linq code to select one item","body":"<p>I find myself writing a lot of code like this to select one item that matches </p>\n\n<pre><code>var item = (from x in Items where x.Id == 123 select x).First();\n</code></pre>\n\n<p>Is there a cleaner way of doing it or is this as concise as I'm going to get?</p>\n\n<p>EDIT: Should have said \"Cleaner way using linq syntax\". I was already aware of the lambda syntax and it's starting to look like this is actually the only way. I did get some useful info though, so thanks to everyone who replied.</p>\n"},{"tags":["c#","asp.net-mvc-3","projects-and-solutions"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":43,"score":-1,"question_id":13271403,"title":"How to access other projects in one solution","body":"<p>I have one empty solution Store with 3 projects Store.Domain, Store.UnitTests, Store.WebUI</p>\n\n<p>In domain I have my Data Model and I like to access through Store.WebUI. I try using Store.Domain however I got an error type or namespace could not be found are you missing using directive or an assembly reference?</p>\n"},{"tags":["c#","jquery","asp.net","ajax"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":196,"score":0,"question_id":9426534,"title":"Inserting and selecting data using Jquery","body":"<p>I am working with visual studio 2010,4.0 frame work\nmy pages are like the following</p>\n\n<p>default.aspx contain a \ntextbox\nbutton</p>\n\n<p>on the click of button the data should insert into the sql database without the page being posted i.e. using jquery.</p>\n\n<p>How can it be done?</p>\n"},{"tags":["c#","character-encoding","vfp","dbase"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13026489,"title":"How do i read a dbase file and apply different decoding?","body":"<p>I have a dbf file endcoded as 866 codepage (DOS)</p>\n\n<p>Using the code below, I'm trying to read it.\nProblem is that strings I get are formed as if the file was in code page 1252.\nI've checked other questions on SO and other forums with no luck so far.\nLooking for ideas on hot to read it propperly.</p>\n\n<pre><code>var ConnectionString = @\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\\PathtoFile\\;Extended Properties=\"\"dBase 5.0\"\"\";\nvar  dBaseConnection = new System.Data.OleDb.OleDbConnection(ConnectionString );\n\ndBaseConnection.Open();\n\nvar dBaseCommand = new System.Data.OleDb.OleDbCommand(\"SELECT * FROM FileName\",dBaseConnection);\nvar dBaseDataReader =  dBaseCommand.ExecuteReader(CommandBehavior.SequentialAccess);\n\n\nwhile( dBaseDataReader.Read()){\n\nEncoding.GetEncoding(866).GetString(Encoding.GetEncoding(1252).GetBytes(dBaseDataReader.GetString(2)).Dump();  // Does not help \n}\n</code></pre>\n"},{"tags":["c#",".net","sorting","string-comparison","bug"],"answer_count":1,"favorite_count":8,"up_vote_count":21,"down_vote_count":0,"view_count":248,"score":21,"question_id":13254153,"title":"Bug in the string comparing of the .NET Framework","body":"<p>It's a requirement for any <a href=\"http://en.wikipedia.org/wiki/Comparison_sort\" rel=\"nofollow\">comparison sort</a> to work that the underlying order operator is <a href=\"http://en.wikipedia.org/wiki/Partially_ordered_set\" rel=\"nofollow\"><em>transitive</em> and <em>antisymmetric</em></a>.</p>\n\n<p>In .NET, that's not true for some strings:</p>\n\n<pre><code>static void CompareBug()\n{\n  string x = \"\\u002D\\u30A2\";  // or just \"-ア\" if charset allows\n  string y = \"\\u3042\";        // or just \"あ\" if charset allows\n\n  Console.WriteLine(x.CompareTo(y));  // positive one\n  Console.WriteLine(y.CompareTo(x));  // positive one\n  Console.WriteLine(StringComparer.InvariantCulture.Compare(x, y));  // positive one\n  Console.WriteLine(StringComparer.InvariantCulture.Compare(y, x));  // positive one\n\n  var ja = StringComparer.Create(new CultureInfo(\"ja-JP\", false), false);\n  Console.WriteLine(ja.Compare(x, y));  // positive one\n  Console.WriteLine(ja.Compare(y, x));  // positive one\n}\n</code></pre>\n\n<p>You see that <code>x</code> is strictly greater than <code>y</code>, and <code>y</code> is strictly greater than <code>x</code>.</p>\n\n<p>Because <code>x.CompareTo(x)</code> and so on all give zero (<code>0</code>), it is clear that this is not an order. Not surprisingly, I get unpredictable results when I <code>Sort</code> arrays or lists containing strings like <code>x</code> and <code>y</code>. Though I haven't tested this, I'm sure <code>SortedDictionary&lt;string, WhatEver&gt;</code> will have problems keeping itself in sorted order and/or locating items if strings like <code>x</code> and <code>y</code> are used for keys.</p>\n\n<p><strong>Is this bug well-known?</strong> What versions of the framework are affected (I'm trying this with .NET 4.0)?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Here's an example where the sign is negative either way:</p>\n\n<pre><code>x = \"\\u4E00\\u30A0\";         // equiv: \"一゠\"\ny = \"\\u4E00\\u002D\\u0041\";   // equiv: \"一-A\"\n</code></pre>\n"},{"tags":["c#","linq","entity-framework","c#-4.0","linq-to-sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13269559,"title":"How to Group By multiple records according some criteria","body":"<p>please consider this scenario:</p>\n\n<p>I have data like this :</p>\n\n<pre><code> Id          Group            Value\n -----------------------------------\n 1            1                100\n 2            1                120\n 3            1                100\n 4            2                90\n 5            2                105\n 6            3                300\n 7            4                123\n 8            4                110\n 9            5                100\n 10           5                110\n</code></pre>\n\n<p>I want to do <code>GroupBy</code> on this data as <code>1,2,3</code> place in one group and <code>4,5</code> place in another group. How I can do this with <code>LINQ</code>?</p>\n\n<p>thanks</p>\n\n<hr>\n\n<p><strong>Edit 1)</strong></p>\n\n<p>I want to place <code>1,2,3</code> in one group and <code>4,5</code> in another group and perform <code>Count</code> aggregation on them and I get <strong>6</strong> for first group and <strong>4</strong> for secnd group</p>\n"},{"tags":["c#",".net","shopify","hmac","sha256"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13254907,"title":"How can I create a matching HMAC value to verify a Shopify WebHook in .NET?","body":"<p>I have set up an endpoint to receive webhook requests from Shopify.</p>\n\n<p>The requests from Shopify include an HMAC header that is created from a shared secret key and the body of the request.</p>\n\n<p>I need to calculate the HMAC on my server and match it to the value in the request header to ensure that the request is authentic.</p>\n\n<p>I can't seem to create the appropriate mechanism in .NET to create a matching HMAC value.</p>\n\n<p>My algorithm at this point is as follows:</p>\n\n<pre><code>public static string CreateHash(string data)\n    {\n        string sharedSecretKey = \"MY_KEY\";\n\n        byte[] keyBytes = Encoding.UTF8.GetBytes(sharedSecretKey);\n        byte[] dataBytes = Encoding.UTF8.GetBytes(data);\n\n        //use the SHA256Managed Class to compute the hash\n        System.Security.Cryptography.HMACSHA256 hmac = new HMACSHA256(keyBytes);\n        byte[] hmacBytes = hmac.ComputeHash(dataBytes);\n\n        //retun as base64 string. Compared with the signature passed in the header of the post request from Shopify. If they match, the call is verified.\n        return System.Convert.ToBase64String(hmacBytes);\n    }\n</code></pre>\n\n<p>The Shopify docs for verifying their webhooks can be found <a href=\"http://wiki.shopify.com/Verifying_Webhooks\" rel=\"nofollow\">HERE</a> but only PHP and Ruby samples are included.</p>\n\n<p>Can anyone see what I might be doing wrong? Should I be just passing the entire JSON request body as a string into this method?</p>\n"},{"tags":["c#","wpf","visual-studio-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":9092494,"title":"When I draw a button, it snaps back to the middle of the screen?","body":"<p>I'm very new to WPF. I was trying to add a button to a tab item (of a tab control I had already dragged in) in Visual C# 2010 Express. Upon doing this, the button repeatedly snapped to the center of the screen when I tried to drag-and-drop reposition it. Why is this happening, and how can I move the button? I haven't written any code, and the only properties of the button that I've changed are the size, content, and name.</p>\n"},{"tags":["c#",".net","matlab","process","filesystemwatcher"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":845,"score":1,"question_id":1115028,"title":"How to use command line Matlab from .NET without linking?","body":"<p>I finally discovered a way to use command line Matlab from .NET without linking:</p>\n\n<ol>\n<li><p>Write variables from .NET to a MAT file using David A. Zier's \"csmatio\" dll.</p></li>\n<li><p>Read the file from Matlab, process it and save the results to a MAT file:</p>\n\n<pre><code>var process = new Process()\n{\n    StartInfo = new ProcessStartInfo()\n    {\n        FileName = MatlabExecutableFileName,\n        Arguments = \"-nodisplay \" + \n           \"-nojvm \" +\n           \" -r \\\"somecommands; \" + \n           \"save FILENAME OUTPUTVARIABLES; \" +\n           \"exit;\\\"\"\n    }\n};\nprocess.Start();\n</code></pre></li>\n<li><p><strong>The worst part:</strong> Wait until the process finishes. </p>\n\n<p>The naive approach:</p>\n\n<pre><code>process.WaitForExit();\n</code></pre>\n\n<p>Doesn't work because matlab spawns the main application in a new thread</p>\n\n<p>Watching for the output file for changes is tricky:</p>\n\n<pre><code>new FileSystemWatcher(MatlabPath, fileName)\n    .WaitForChanged(WatcherChangeTypes.All)\n</code></pre>\n\n<p>Was not working because of a bug on this class.</p>\n\n<p>The currently working code is longer:</p>\n\n<pre><code>using (var watcher = new FileSystemWatcher(MatlabPath, fileName))\n{\n    var wait = new EventWaitHandle(false, EventResetMode.AutoReset);\n    watcher.EnableRaisingEvents = true;\n    watcher.Changed += delegate(object sender, FileSystemEventArgs e)\n    {\n       wait.Set();\n    };\n    foreach(var i in Enumerable.Range(0, 2))\n    {\n        if (!wait.WaitOne(MillissecondsTimeout))\n        {\n            throw new TimeoutException();\n        }\n    }\n    Thread.Sleep(1000);\n}\n</code></pre>\n\n<p>But I am concerned about the last line of code. The code block above was written with the intent of avoiding it, but I don't know what else to do. This amount of time will be too much on some computers and too little on others.</p></li>\n</ol>\n\n<p><strong>SOLUTION</strong></p>\n\n<pre><code>var previousProcesses = Process\n    .GetProcessesByName(\"Matlab\")\n    .Select(a =&gt; a.Id)\n    .ToArray();\nprocess.Start();\nprocess.WaitForExit();\nvar currentProcess = Process\n    .GetProcessesByName(\"Matlab\")\n    .Where(a =&gt; !previousProcesses.Contains(a.Id))\n    .First();\ncurrentProcess.WaitForExit();\n</code></pre>\n"},{"tags":["c#","path"],"answer_count":1,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":51,"score":6,"question_id":13266756,"title":"Absolute to Relative path","body":"<p>I'm getting a file from an OpenFileDialog which returns a string with the absolute path to the selected file. Now I want that path as a relative path to a given path (in this case the path to my application).</p>\n\n<p>So let's say I get a path to the file:\n<code>c:\\myDock\\programming\\myProject\\Properties\\AssemblyInfo.cs</code></p>\n\n<p>and my application is located in</p>\n\n<p><code>c:\\myDock\\programming\\otherProject\\bin\\Debug\\program.exe</code></p>\n\n<p>then I want the result: </p>\n\n<p><code>..\\..\\..\\myProject\\Properties\\AssemblyInfo.cs</code></p>\n"},{"tags":["c#","visual-studio-2010","dll","release-management"],"answer_count":3,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":2329,"score":8,"question_id":5491253,"title":"Visual Studio 2010 Compiling with the Debug or Release version of third party library depending on if my project is being compiled Build or Release?","body":"<p>I've downloaded a number of 3rd party libraries (dlls) now for Visual Studio 2010/C# and I've noticed that in their distributions \\bin directory they usually have two versions Debug and Release.</p>\n\n<p>Is there a way to add these libraries as references to the project, but use the Release build (when I'm building a release), and use the Debug build (when I'm debugging)?</p>\n"},{"tags":["c#",".net","compact-framework","windows-ce"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":526,"score":1,"question_id":7252606,"title":"Changing TimeZone does not reflect change in Time in .NET Compact Framework","body":"<p>I am working on .Net Compact Frmework(CF) application. I this application the requirement is that I should be able to change the TimeZone. However, when I changed the TimeZone the current time does not changed to that particular TimeZone. From, web I came to know that DateTime.Now can not work in this case.</p>\n\n<p>I am using following Win API:</p>\n\n<ol>\n<li><code>SetTimeZoneInformation(...)</code> - To set the time zone at Runtime.</li>\n<li><code>GetLocalTime(...)</code> - To get the Local time w.r.t current time\nzone.</li>\n</ol>\n\n<p>Can anybody tell me what might be wrong?</p>\n"},{"tags":["c#","xaml","webbrowser-control","windows-phone-8"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13271246,"title":"Windows Phone WebBrowser Control can't display page","body":"<p>I have a Windows Phone 8, C#/XAML project, running on emulator. My XAML file has a phone:WebBrowser control. I've been trying to displaying a website like www.google.com, but I always get:</p>\n\n<p>\"We're having trouble display this page\"\n We're having trouble with the page you're trying to reach and can't open it right now.</p>\n\n<p>My XAML code:</p>\n\n<pre><code>&lt;Grid x:Name=\"ContentPanel\" Grid.Row=\"1\" Margin=\"12,0,12,0\"&gt;\n        &lt;phone:WebBrowser x:Name=\"webBrowser\" Height=\"319\" Width=\"684\" HorizontalAlignment=\"Left\" Margin=\"10,-10,0,0\" VerticalAlignment=\"Top\" Source=\"https://www.google.com\" /&gt;\n    &lt;/Grid&gt;\n</code></pre>\n\n<p>I tried the link on Chrome or IE, and loads fine. \nDo you know what's wrong? \nThanks.</p>\n"},{"tags":["c#","asp.net",".net","mvc"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":56,"score":3,"question_id":13271067,"title":"Difference between Display(Name) and DisplayName","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/5243665/displayname-attribute-vs-display-attribute\">displayname attribute vs display attribute</a>  </p>\n</blockquote>\n\n\n\n<p>Is there any difference between <code>Display(Name=\"MyName\")</code> and  <code>DisplayName(\"MyName\")</code> or is it only a feature of ASP.NET MVC ? \nI'm talking about the namespace <b>System.ComponentModel.DataAnnotations</b>.</p>\n"},{"tags":["c#","configuration","visual-studio-2012","projects","solution"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13270926,"title":"Visual Studio Solution: Get projects related to a build configuration","body":"<p>For a post-build step on our build server I want to get all projects inside a C# Visual Studio 2012 solution related to a specific configuration.<br>\nHere is a sample sln file: <a href=\"http://pastebin.com/Hya1s9E7\" rel=\"nofollow\">pastebin</a><br>\nThis file has two projects: TestApplication1 and TestApplication2 with two configurations: App1 and App2. App1 will only build TestApplication1 and App2 only TestApplication2.<br>\nNow when I say \"display all projects for configuration App1 I\", want to get TestApplication1 back.<br> The problem is that I cant see any entry that specify which project should be build under which configuration. The sln file looks like that every project is related to every configuration.<br>\nHow can I solve this?</p>\n"},{"tags":["c#",".net","expression"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":48,"score":5,"question_id":13270230,"title":"How to convert a string into a BinaryExpression object?","body":"<p>Say we have strings like:</p>\n\n<pre><code>string s1 = \"a &lt; 5\";\nstring s2 = \"b &gt;= 7\";\nstring s3 = \"c &lt;= 8\";\n...\n</code></pre>\n\n<p>I want to convert such strings into BinaryExpression objects similar to what we get by using:</p>\n\n<pre><code>  BinaryExpression b1 = Expression.MakeBinary( ExpressionType.LessThan, Expression.Parameter( typeof( int ), \"a\" ), Expression.Constant( 5, typeof( int ) ) );\n  BinaryExpression b2 = Expression.MakeBinary( ExpressionType.GreaterThanOrEqual, Expression.Parameter( typeof( int ), \"b\" ), Expression.Constant( 7, typeof( int ) ) );\n  BinaryExpression b3 = Expression.MakeBinary( ExpressionType.LessThanOrEqual, Expression.Parameter( typeof( int ), \"c\" ), Expression.Constant( 8, typeof( int ) ) );\n</code></pre>\n\n<p>I have created the method below:</p>\n\n<pre><code>BinaryExpression ConvertStringToBinaryExpression( string exp )\n{\n  string[] s = exp.Split( ' ' );\n  string param = s[ 0 ];\n  string comparison = s[ 1 ];\n  int constant = int.Parse( s[ 2 ] );\n  if ( comparison == \"&lt;\" )\n    return Expression.MakeBinary( ExpressionType.LessThan, Expression.Parameter( typeof ( int ), param ), Expression.Constant( constant, typeof ( int ) ) );\n  else if ( comparison == \"&lt;=\" )\n    return Expression.MakeBinary( ExpressionType.LessThanOrEqual, Expression.Parameter( typeof ( int ), param ), Expression.Constant( constant, typeof ( int ) ) );\n  else if ( comparison == \"&gt;\" )\n    return Expression.MakeBinary( ExpressionType.GreaterThan, Expression.Parameter( typeof ( int ), param ), Expression.Constant( constant, typeof ( int ) ) );\n  else if ( comparison == \"&gt;=\" )\n    return Expression.MakeBinary( ExpressionType.GreaterThanOrEqual, Expression.Parameter( typeof ( int ), param ), Expression.Constant( constant, typeof ( int ) ) );\n  else\n    throw new ArgumentException( \"Invalid expression.\", \"exp\" );\n}\n</code></pre>\n\n<p>However, the above method does not work properly if, for example, we have strings like:</p>\n\n<pre><code>string s4 = \"a&lt; 5\"  // no space between 'a' and '&lt;'\nstring s5 = \"b&gt;=9\"  // no space at all\nstring s6 = \"c &lt;=7\"  // no space betwen '&lt;=' and '7'\n</code></pre>\n\n<p>What is the easiest way to make it more robust and reliable?</p>\n"},{"tags":["c#","monotouch","one-to-many","relationships","coolstorage"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13270964,"title":"Mapping issue using CoolStorage in Monotouch","body":"<p>I'm trying out Vici CoolStorage with Monotouch and seem to be having an issue with relationships. Using the following I am trying to populate a database with a single Survey and then generate a list of 5 questions using a for loop.</p>\n\n<p>When I run it there seems to be an issue mapping the Questions to the Survey in the database so if anyone could give me an idea of what I've missed it would be much appreciated! The error given is \"Vici.CoolStorage.CSException: Relation Survey could not be read\".</p>\n\n<h2>Classes</h2>\n\n<pre><code>[MapTo(\"Survey\")]\npublic class Survey : CSObject&lt;Survey, int&gt;\n{\n    public int SurveyId { get { return (int)GetField (\"SurveyId\"); } }\n    public string Title { get { return (string)GetField (\"Title\"); } set { SetField (\"Title\", value); } }\n    public DateTime DateCreated { get { return (DateTime)GetField (\"DateCreated\"); } set { SetField (\"DateCreated\", value); } }\n    public bool IsCurrent { get { return (bool)GetField (\"IsCurrent\"); } set { SetField (\"IsCurrent\", value); } }\n\n    [OneToMany(LocalKey=\"SurveyId\", ForeignKey=\"QuestionId\")]\n    public CSList&lt;Question&gt; Questions { get { return (CSList&lt;Question&gt;)GetField(\"Questions\"); } }\n\n}\n\n[MapTo(\"Question\")]\npublic class Question : CSObject&lt;Question, int&gt;\n{\n    public int QuestionId { get { return (int)GetField (\"QuestionId\"); } }\n    public string Text { get { return (string)GetField (\"Text\"); } set { SetField (\"Text\", value); } }\n    public int SurveyId { get { return (int)GetField (\"SurveyId\"); } }\n\n    [ManyToOne(LocalKey=\"QuestionId\", ForeignKey=\"SurveyId\")]\n    public Survey Survey { get { return (Survey)GetField (\"Survey\"); } set { SetField (\"Survey\", value); } }\n}\n</code></pre>\n\n<h2>Database Tables</h2>\n\n<pre><code>CSDatabase.ExecuteNonQuery (@\"CREATE TABLE Survey (SurveyId INTEGER PRIMARY KEY AUTOINCREMENT, Title TEXT(100) NOT NULL, DateCreated TEXT(50) NOT NULL, IsCurrent INTEGER)\");\nCSDatabase.ExecuteNonQuery (@\"CREATE TABLE Question (QuestionId INTEGER PRIMARY KEY AUTOINCREMENT, Text TEXT(100) NOT NULL, SurveyId INTEGER REFERENCES Survey(SurveyId))\");\n</code></pre>\n\n<h2>Loop</h2>\n\n<pre><code>for (int i = 1; i &lt;= 10; i++) \n{\n            Question q = Question.New ();\n            q.Text = String.Format (\"Question {0}\", i);\n            survey.Questions.Add (q);\n}\nsurvey.Save();\n</code></pre>\n"},{"tags":["c#","ravendb"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13271106,"title":"WhereGreaterThan returns no results in LuceneQuery (RavenDB)","body":"<p>I'm having an issue querying for values that are greater than a certain value with lucene.  My data is dynamic, so Linq is not an option.</p>\n\n<p>The problem, in short, is when I query with WhereGreaterThan I get zero results even though my Asset.Data has a price greater than a value.  This applies to WhereGreaterThanOrEquals, WhereLessThan, and WhereLessThanOrEquals as well.</p>\n\n<pre><code>public class AssetDataSearch : AbstractIndexCreationTask&lt;Asset&gt;\n{\n    public AssetDataSearch()\n    {\n        Map = (docs) =&gt; \n            from d in docs\n            select new\n            {\n                DataType = d.DataType,\n                _ = d.SearchableParameters.Select(s =&gt; CreateField(s.Key, s.Value))\n            };\n    }\n}\n\npublic class Test\n{\n    public void TestMethod()\n    {\n        var assets = new []\n        {\n            new Asset()\n            {\n                ID = Guid.NewGuid().ToString(),\n                Data = new ListingData()\n                {\n                    Beds = 5,\n                    Baths = 5,\n                    ListingType = ListingTypeEnum.Condo,\n                    Price = 100\n                }\n            },\n            new Asset()\n            {\n                ID = Guid.NewGuid().ToString(),\n                Data = new ListingData()\n                {\n                    LotSize = 55,\n                    SqFeet = 89,\n                    YearBuilt = 1965,\n                    Price = 200\n                }\n            },\n        };\n        RavenHelper.InitTestingStore();\n        using (var session = RavenDB.RavenUtility.OpenSession())\n        {\n            foreach(var a in assets)\n                session.Store(a);\n            session.SaveChanges();\n            var assetsInDb = session.Advanced.LuceneQuery&lt;Asset&gt;().WaitForNonStaleResults().ToArray();\n            var n = session.Advanced.LuceneQuery&lt;Asset, AssetDataSearch&gt;().WhereEquals(\"Price\", 100).ToArray(); // returns expected results\n            var gt = session.Advanced.LuceneQuery&lt;Asset, AssetDataSearch&gt;().WhereGreaterThan(\"Price\", 60).ToArray(); // returns nothing\n            var lt = session.Advanced.LuceneQuery&lt;Asset, AssetDataSearch&gt;().WhereLessThan(\"Price\", 60).ToArray();  // returns nothing\n        }\n     }\n }\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"},{"tags":["c#","datagrid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":463,"score":0,"question_id":2728330,"title":"How to adjust row height in datagrid at runtime in C# .net?","body":"<p>How to adjust row height in datagrid at runtime in C# .net?</p>\n"},{"tags":["c#","wpf","com","port"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13270754,"title":"Error while receiving data from serial port","body":"<p>I have application with several windows (actually its two almost same windows with some functions). One of that function is reading data from COM port (read weight from weighting machine). Problem is that, it works perfect on first window, but when im closing it and opening another window, then clicking same function (lets call it calculate weight), im getting this error message:\nAccess to the port 'COM1' is denied.</p>\n\n<p>Code:</p>\n\n<pre><code>   private void calculateWeight_Click(object sender, RoutedEventArgs e)\n{\n    sp = new SerialPort(\"COM1\", 9600, Parity.None, 8, StopBits.One);\n    tekst = string.Empty;\n    sp.Open();\n    sp.WriteLine(((char)5).ToString());\n    sp.WriteLine(((char)17).ToString());\n    sp.DataReceived += new SerialDataReceivedEventHandler(sp_DataReceived);\n}\nprivate delegate void UpdateUi(string s);\nvoid sp_DataReceived(object sender, SerialDataReceivedEventArgs e)\n{\n    tekst += sp.ReadExisting();\n    if (tekst.Contains('S') &amp;&amp; tekst.Length &gt; 14)\n        Dispatcher.Invoke(DispatcherPriority.Send, new UpdateUi(czytajWage), tekst);\n}\nstring tekst = string.Empty;\n\nvoid czytajWage(string s)\n{\n    string w = \"\";\n    for (int i = 5; i &lt; 14; i++)\n    {\n        w += s[i];\n    }\n    MessageBox.Show(w);\n    w = \"\";\n    tekst = \"\";\n\n    sp.DataReceived -= sp_DataReceived;\n}\n</code></pre>\n\n<p>Anyone can help? ;)</p>\n"},{"tags":["c#","visual-studio-2010","unit-testing"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":48,"score":4,"question_id":13270860,"title":"visual studio 2010 c# unit tests","body":"<p>Trying to create unit tests for my methods and can't seem to get the configuration right.\nI go New Test -> Unit Test Wizard -> Pick my method -> fill in test method values but I always get Assert.Inconclusive failed. Verify the correctness of this test method.</p>\n\n<p>Here is a sample method:</p>\n\n<pre><code>namespace ConsoleApplication\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n        }\n\n        public int Mult(int a, int b)\n        {\n            return a * b;\n        }\n    }\n}\n</code></pre>\n\n<p>and the test method:</p>\n\n<pre><code>[TestMethod()]\n        public void MultTest()\n        {\n            Program target = new Program(); // TODO: Initialize to an appropriate value\n            int a = 4; // TODO: Initialize to an appropriate value\n            int b = 5; // TODO: Initialize to an appropriate value\n            int expected = 20; // TODO: Initialize to an appropriate value\n            int actual;\n            actual = target.Mult(a, b);\n            Assert.AreEqual(expected, actual);\n            Assert.Inconclusive(\"Verify the correctness of this test method.\");\n        }\n</code></pre>\n\n<p>Seems straight forward enough, but am I missing something trivial?</p>\n"},{"tags":["c#","enums","contains"],"answer_count":9,"favorite_count":1,"up_vote_count":13,"down_vote_count":0,"view_count":263,"score":13,"question_id":13248869,"title":"C# enum contains value","body":"<p>I have an enum</p>\n\n<pre><code>enum myEnum2 { ab, st, top, under, below}\n</code></pre>\n\n<p>I would like to write a function to test if a given value is included in myEnum</p>\n\n<p>something like that:</p>\n\n<pre><code>private bool EnumContainValue(Enum myEnum, string myValue)\n{\n     return Enum.GetValues(typeof(myEnum))\n                .ToString().ToUpper().Contains(myValue.ToUpper()); \n}\n</code></pre>\n\n<p>But it doesn't work because myEnum parameter is not recognized.</p>\n"},{"tags":["c#","performance"],"answer_count":6,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":1395,"score":4,"question_id":2443164,"title":"Does variable name length matter for performance C#?","body":"<p>I've been wondering if using long descriptive variable names in WinForms C# matters for performance? I'm asking this question since in AutoIt v3 (interpreted language) it was brought up that having variables with short names like <code>aa</code> instead of <code>veryLongVariableName</code> is much much faster (when program is bigger then 5 liner). I'm wondering if it's the same in C#?</p>\n"},{"tags":["c#","windows-phone-7","dll"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13270025,"title":"Could not add reference to dll file","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12520212/exception-from-hresult-0x80131047\">Exception from HRESULT: 0x80131047</a>  </p>\n</blockquote>\n\n\n\n<p>I'm trying to add reference .dll file to my WP7 application. Getting an error</p>\n\n<blockquote>\n  <p>The given assembly name or codebase was invalid. Exception from\n  HRESULT:0x80131047</p>\n</blockquote>\n"},{"tags":["c#","javascript",".net","asp.net","json"],"answer_count":2,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":1484,"score":0,"question_id":7559676,"title":"How to correctly deserialize a JSON string into the class that contains a nested List of another class","body":"<p>I have the following object graph and I'm using Jquery's $.Ajax() to send this identical \"View\" object in JSON (stringified) from the browser to a Page Method on ASP.Net. The JAvascript deserialization works for all of the strings and int's in the View class but My <code>List&lt;DataItem&gt;</code> is empty. </p>\n\n<p>What I tried: Using chrome dev tools, I took the stringified JSON, created a unit test and used both the <code>DataContractJsonSerializer</code> and the <code>JavaScriptSerializer</code>. The <code>DataContractJsonSerializer</code> object deserialized my object graph correctly but the <code>JavaScriptSerializer</code> dumped my List. How can I get the correct deserialization on my page method ?</p>\n\n<pre><code>public class View\n{\n    public string Text { get; set; }\n    public string AnotherText { get; set; }\n    public Int SomeInt { get; set; }\n    public List&lt;DataItem&gt; { get; set; }\n}\n\npublic class DataItem\n{\n    public Person person {get;set}\n}\n\npublic class Person\n{\n    public int Age {get;set}\n}\n\n   var dataa = {mqvm: mqvmJSON };\n    $.ajax({\n        type: \"POST\",\n        dataType: \"json\",\n        contentType: \"application/json; charset=utf-8\",\n        data: JSON.stringify( dataa ),\n        url: \"GoHere.aspx/WebMethodName\",\n        success: function(data) {\n            alert(data.d);\n        },\n        error: function(jqXHR, textStatus, errorThrown) {\n            alert(jqXHR.responseText + ' ' + errorThrown);\n        }\n    });\n</code></pre>\n\n<p>Instead of this (the view obj as a param).</p>\n\n<pre><code>    [ScriptMethod(ResponseFormat = ResponseFormat.Json)]\n    [WebMethod]\n    public static string CreateResponseReview(View mqvm)\n    { \n        return \"Success\";\n    }\n</code></pre>\n\n<p>how can I get this? (the string param)</p>\n\n<pre><code>    [ScriptMethod(ResponseFormat = ResponseFormat.Json)]\n    [WebMethod]\n    public static string CreateResponseReview(string mqvm)\n    { \n        //do manual JSON deserialization here.\n\n        return \"Success\";\n    }\n</code></pre>\n\n<p>My JSON looks like this.</p>\n\n<pre><code>    {\n    \"Text\": \"6\",\n    \"AnotherText\":\"wow\"\n    \"SomeInt\": 5,\n    \"DataItem\":[\n        {\n            \"person\":{\n                \"Age\":23\n            }\n        },\n        {\n            \"person\":{\n                \"Age\":42\n            }\n        }\n    ]\n}\n</code></pre>\n"},{"tags":["c#","asp.net","twitter","twitter-api","asp.net-webforms"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13269985,"title":"Twitter API get user feed","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3800850/how-to-read-twitter-feeds\">How to read Twitter feeds</a>  </p>\n</blockquote>\n\n\n\n<p>I am looking for some samples to get the twitter feed (public feed) for an user in C#, ASP.NET. Whatever samples I found are using OAuth etc, but I am not able to find any sample which provides just feed without any authentication. </p>\n\n<p>Any sample is highly appricated. </p>\n\n<p>PS: I don't want to use the twitter widgets</p>\n"},{"tags":["c#"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":13270060,"title":"Is there a way I can find out if a string in C# does not contain the numbers & characters 0-9 and A-Z?","body":"<p>I have seen some kind of regular expression tests but how can I check if a string does not contain any of the 0-9 numbers or A-Z characters?</p>\n"},{"tags":["c#",".net","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13253315,"title":"Entity Framework does not generate association property","body":"<p>So.</p>\n\n<p>I'm having trouble fixing this little problem.</p>\n\n<p>I have several classes, and it's all nice and good. Right up until now. I have now added another class (MatchResult), and it works. \n<img src=\"http://i.stack.imgur.com/QYrFi.png\" alt=\"Before\"></p>\n\n<p>But when I try to make the correct association: </p>\n\n<p><img src=\"http://i.stack.imgur.com/ojGaq.png\" alt=\"enter image description here\"></p>\n\n<p>It fails with a runtime exception.</p>\n\n<p>Error:</p>\n\n<blockquote>\n  <p>Schema specified is not valid. Errors: </p>\n  \n  <p>The relationship 'DbModel.FK_ProductPrice' was not loaded\n  because the type 'DbModel.Product' is not available.</p>\n  \n  <p>The following information may be useful in resolving the previous\n  error:</p>\n  \n  <p>The required property 'MatchResults' does not exist on the type\n  'PriceMonitor.Model.Product'.</p>\n  \n  <p>The relationship 'DbModel.FK_WebshopProduct' was not loaded\n  because the type 'DbModel.Product' is not available.</p>\n  \n  <p>The following information may be useful in resolving the previous\n  error:</p>\n  \n  <p>The required property 'MatchResults' does not exist on the type\n  'PriceMonitor.Model.Product'.</p>\n</blockquote>\n\n<p>It seems - for some reason - that EF does not create the MatchResults property on the Product class.</p>\n\n<p>This approach has worked on every single class I've ever made using EF. Up until now.</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":7,"view_count":67,"score":-4,"question_id":13270739,"title":"How can you set a default checkbox value C#?","body":"<p>How can you set a default checkbox value? Yes i'm new at all this. But I'm learning well. </p>\n"},{"tags":["c#","php","md5sum"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":85,"score":0,"question_id":13200767,"title":"c# hash and php MD5 file/folder hash not the same","body":"<p>I have to MD5 hash files/folders on both a client(C#) and a server(PHP) file structure. (Server land is PHP and client land is c#.) The problem is while they work they do not match. Any ideas would be greatly appreciated</p>\n\n<p>Here are my two algorithms</p>\n\n<p>C#</p>\n\n<pre><code>using System;\nusing System.IO;\nusing System.Security.Cryptography;\nusing System.Text;\n\nnamespace nofolder\n{\n    public class classHasher\n    {\n        /**********\n         *  recursive folder MD5 hash of a dir\n         */\n        MD5 hashAlgo = null;\n        StringBuilder sb;\n        public classHasher()\n        {\n            hashAlgo = new MD5CryptoServiceProvider();\n        }\n        public string getHash(String path)\n        {\n            // get the file attributes for file or directory\n            if (File.Exists(path)) return getHashOverFile(path);\n            if (Directory.Exists(path)) return getHashOverFolder(path);\n            return \"\";\n        }\n        public string getHashOverFolder(String path)\n        {\n            sb = new StringBuilder();\n            getFolderContents(path);\n            return sb.ToString().GetHashCode().ToString();\n        }\n        public string getHashOverFile(String filename)\n        {\n            sb = new StringBuilder();\n            getFileHash(filename);\n            return sb.ToString().GetHashCode().ToString();\n        }\n        private void getFolderContents(string fold)\n        {\n            foreach (var d in Directory.GetDirectories(fold))\n            {\n                getFolderContents(d);\n            }\n            foreach (var f in Directory.GetFiles(fold))\n            {\n                getFileHash(f);\n            }\n        }\n        private void getFileHash(String f)\n        {\n            using (FileStream file = new FileStream(f, FileMode.Open, FileAccess.Read))\n            {\n                byte[] retVal = hashAlgo.ComputeHash(file);\n                file.Close();\n                foreach (var y in retVal)\n                {\n                    sb.Append(y.ToString());\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>PHP</p>\n\n<pre><code>function include__md5_dir($dir){\n    /**********\n    *   recursive folder MD5 hash of a dir\n    */\n    if (!is_dir($dir)){\n        return  md5_file($dir);\n    }\n\n    $filemd5s = array();\n    $d = dir($dir);\n\n    while (false !== ($entry = $d-&gt;read())){\n        if ($entry != '.' &amp;&amp; $entry != '..'){\n             if (is_dir($dir.'/'.$entry)){\n                 $filemd5s[] = include__md5_dir($dir.'/'.$entry);\n             }\n             else{\n                 $filemd5s[] = md5_file($dir.'/'.$entry);\n             }\n         }\n    }\n    $d-&gt;close();\n    return md5(implode('', $filemd5s));\n}\n</code></pre>\n\n<p><strong>EDIT.</strong></p>\n\n<p>I have decided <em>the c# must change</em>. <strong>the PHP is fine as it is</strong>. The first code that works 100% gets the bounty</p>\n"},{"tags":["c#","asp.net","aspect-ratio"],"answer_count":5,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":536,"score":3,"question_id":10070296,"title":"C# : How to calculate aspect ratio","body":"<p>I am relatively new to programming. I need to calculate the aspect ratio(16:9 or 4:3) from a given dimension say axb. How can I achieve this using C#. Any help would be deeply appreciated.</p>\n\n<pre><code>public string AspectRatio(int x, int y)\n{\n //code am looking for\n return ratio\n}\n</code></pre>\n\n<p>Thanks.</p>\n"},{"tags":["c#",".net","windows","vb.net","networking"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":8560,"score":2,"question_id":5570004,"title":"How to change LAN Settings (proxy configuration) programmatically","body":"<p>I am writing a program to automatically switch my proxy address based on the network I am connected to.</p>\n\n<p>I have so far got everything to work except the part that I have highlighted below.  </p>\n\n<p><img src=\"http://imgur.com/FZFS8.png\" alt=\"LAN Settings Dialog\"></p>\n\n<p>Is there any way to change the automatic configuration script and the automatically detect settings in code?</p>\n\n<p>The solution can be either P/Invoke registry editing. I just need something that works.</p>\n"},{"tags":["c#","java","dll","jni"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":586,"score":3,"question_id":10977200,"title":"Calling C# dll from Java","body":"<p>I am a Java developer. But, for some reason I have to take the help of C# to accomplish my task. I have below mentioned C# code which is used to create a DLL. That DLL has to be used in my Java program to do the needful.</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing Microsoft.Office.Interop.Word;\n\nnamespace Yrl.Tracingtool\n{\npublic class DocxUtil\n{\n    public Application Jump(string fileName)\n    {\n\n        object fileNameAsObject = (object)fileName;\n        Application wordApplication;\n        try\n        {\n            wordApplication = new Application();\n            object readnly = false;\n            object missing = System.Reflection.Missing.Value;\n            wordApplication.Documents.Open(ref fileNameAsObject, ref missing, ref readnly, ref missing,\n                                            ref missing, ref missing, ref missing, ref missing,\n                                            ref missing, ref missing, ref missing, ref missing,\n                                            ref missing, ref missing, ref missing, ref missing);\n            object what = Microsoft.Office.Interop.Word.WdGoToItem.wdGoToPage;\n            object which = Microsoft.Office.Interop.Word.WdGoToDirection.wdGoToFirst;\n            object count = 3;\n\n            wordApplication.Selection.GoTo(ref what, ref which, ref count, ref missing);\n\n            return wordApplication;\n        }\n        catch (Exception ex)\n        {\n            //LogEntry log = new LogEntry();\n            //log.Categories.Add(\"Trace\");\n            //log.Message = ex.ToString();\n            //Logger.Write(log, \"Trace\");\n            throw new System.IO.FileLoadException(\"File cannot be opened\");\n        }\n        finally\n        {\n            wordApplication = null;\n        }\n    }\n}\n}\n</code></pre>\n\n<p>I have checked this forum and other forums too, but most of them talk about using a C++ or C DLL file in a JNI call. If anyone is having knowledge of calling C# DLL from Java please let me know.</p>\n"},{"tags":["c#","regex"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":3,"view_count":45,"score":0,"question_id":13269993,"title":"Regular expression to validate numbers separated by commas or dashes","body":"<p>It should validate something like this</p>\n\n<pre><code>12,14,15,18-20,23,50-130\n</code></pre>\n\n<p>I think of this:</p>\n\n<pre><code>^(?:\\\\d[,] | \\\\d[-])$ // or ^(?:\\\\d[,] | \\\\d[-] *)$ ??\n</code></pre>\n\n<p><strong>EDIT</strong>\nIt should work for</p>\n\n<pre><code>12,  15\n11,13, 14,18, 51-52\n</code></pre>\n\n<p>It should't work for</p>\n\n<pre><code>w,12\n12,15d\n14,,18\n14--20\n12,12-\n-12,13\n,12\n12,\n13-,\n-,13\n</code></pre>\n"},{"tags":["c#","asp.net","linq","orm","informix"],"answer_count":6,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":344,"score":2,"question_id":9043819,"title":"Confusion about selecting the suitable ORM?","body":"<p>I use <code>asp.net with informix</code> database.</p>\n\n<p>I use a set of written classes to handle the connections, the CRUD operations, transactions, etc....</p>\n\n<p>Now, I feel these classes are not the best choice, less performance,take a lot of time and have many drawbacks.</p>\n\n<hr>\n\n<p>I want to use an <code>ORM</code>, but I don't know how to choose the one which suits my web applications<code>(asp.net,Informix)</code>.</p>\n\n<p>Please help to select the convenient <code>ORM</code>.</p>\n\n<p>I'm confused among nhibernate , Entity framework , LinQ To SQl , and the open Access (Telerik Component)</p>\n\n<p>Note : i will use Visual studio 2012 so i want the recent comparison. </p>\n"},{"tags":["c#",".net","drivers","umdf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":11924740,"title":"UMDF Development in .NET","body":"<p>Does anyone know if the current state of Microsoft's UMDF allows for driver development in .NET?</p>\n"},{"tags":["c#","c++","windows","64bit","umdf"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":352,"score":1,"question_id":5265773,"title":"UMDF driver for loopback joystick device","body":"<p>I'm trying to write a UMDF device driver for a loopback (virtual) joystick device in Windows, similar to the <code>uinput</code> device in Linux.</p>\n\n<p>I'm familiar with C++, C (on Linux) and C#, and the application I'm writing this for, <a href=\"http://digitalsquid.co.uk/droidpad/\" rel=\"nofollow\" title=\"DroidPad\">DroidPad</a>, is written in C#. I've already downloaded the WDK and looked at several examples.</p>\n\n<p>I decided to try the UMDF framework as I believe that user-mode drivers don't need to be signed in 64-bit windows 7; this is the problem with the joystick driver currently used by DroidPad, <a href=\"http://ppjoy.blogspot.com/\" rel=\"nofollow\" title=\"PPJoy\">PPJoy</a>.</p>\n\n<p>Any help would be greatly appreciated as to developing a UMDF driver for a virtual input device, as well as sending data to the driver from a C# application. Does anyone know of any similar UMDF driver (something similar to <code>uinput</code>)? I also read somewhere that the UMDF framework can be used from C#, how manageable would this be?</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","linq","linq-to-xml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13270546,"title":"How to query a XML with namespaces in the name?","body":"<p>I'm working with a XML like this:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;ListOfLore&gt;\n      &lt;q1:Lore xmlns:q1=\"http://www.rold.com/Data.xsd\"&gt;                \n        &lt;q1:LoreNumber&gt;15642&lt;/q1:LoreNumber&gt;        \n      &lt;/q1:Lore&gt;\n      &lt;q1:Lore xmlns:q1=\"http://www.rold.com/Data.xsd\"&gt;\n        &lt;q1:LoreNumber&gt;15644&lt;/q1:LoreNumber&gt;        \n      &lt;/q1:Lore&gt;\n&lt;/ListOfLore&gt;\n</code></pre>\n\n<p>I'm doing this and I'm getting nothing</p>\n\n<pre><code>var lores = (from ListOfLore in pjs.Descendants(\"ListOfLore\")\n                              from Lore in ListOfLore.Descendants()\n                              where Lore.Name.LocalName == (\"Lore\") \n                              select Lore);\n</code></pre>\n\n<p>I want to get all of <code>Lore</code> items from the <code>ListOfLore</code></p>\n"},{"tags":["c#","listbox","dataset"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13252351,"title":"ListBox populated with DataSet doesn't update","body":"<p>Second Version</p>\n\n<p>I'm populating a <code>ListBox</code> using the following code </p>\n\n<pre><code>private BindingSource sri = new BindingSource();\n\npublic void sola()\n{\n    sri.DataSource = llenar.Tables[\"tipoender\"];\n    listBox1.DataSource = sri;\n    listBox1.ValueMember = \"end_tipoendereco\";\n    listBox1.DisplayMember = \"tpl_descricao\";\n}\n</code></pre>\n\n<p>I use this to DELETE (updating with the value 2 a determined column), when the column ID_tipoauditoria value =2 the record is not loaded . This code is working </p>\n\n<pre><code>DataSet grava = new DataSet();\nSqlDataAdapter da4 = new SqlDataAdapter();\nSqlCommandBuilder constru8 = new SqlCommandBuilder(da4);\nSqlParameter codi = new SqlParameter(\"@emp\", SqlDbType.Int);\ncodi.Value = codem;\nSqlCommand llena10 = new SqlCommand(\"dmlpjende\", conec1);\nllena10.Parameters.Add(codi);\nllena10.CommandType = CommandType.StoredProcedure;\nda4.SelectCommand = llena10;\nda4.Fill(grava, \"endere\");\nDataRow dr2 = grava.Tables[\"endere\"].Rows[ni];\n// listBox1.BackColor = Color.Red;\ndr2.BeginEdit();\ndr2[\"id_tipoauditoria\"] = 2;\ndr2.EndEdit();\nda4.Update(grava.Tables[\"endere\"]);\n</code></pre>\n\n<p>What is the best method to refresh the <code>ListBox</code>? I have tried resetting the binding with no-success. I only need to refresh the dataset or the listbox.</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13270181,"title":"How end edit of a cell, changing its content when it's clicked?","body":"<p>I have changed a <code>DataGridViewCheckBoxCell</code> to contain a string at the right of the CheckBox that reflects the CheckBox value. When it's <code>true</code>, the string is \"Value1\"; when it's <code>false</code> the string should change to \"Value2\".</p>\n\n<p>The string value is changing only after the <code>DataGridViewCheckBoxCell</code> loses focus. I want the string value to change right after the CheckBox value changes. How can I do that?</p>\n\n<p>For reference, this is my personalized <code>DataGridViewCheckBoxCell</code> class:</p>\n\n<pre><code>public class MyDGVCheckBoxCell : DataGridViewCheckBoxCell\n{\n    public static string TRUE_VALUE = \"Excitada\";\n    public static string FALSE_VALUE = \"Monitorada\";\n\n    public MyDGVCheckBoxCell(bool isExcitada)\n    {\n        FalseValue = FALSE_VALUE;\n        TrueValue = TRUE_VALUE;\n        Value = isExcitada ? TRUE_VALUE : FALSE_VALUE;\n    }\n\n    protected override void Paint(Graphics graphics, Rectangle clipBounds, Rectangle cellBounds, int rowIndex, DataGridViewElementStates elementState, object value, object formattedValue, string errorText, DataGridViewCellStyle cellStyle, DataGridViewAdvancedBorderStyle advancedBorderStyle, DataGridViewPaintParts paintParts)\n    {\n        base.Paint(graphics, clipBounds, cellBounds, rowIndex, elementState, value, formattedValue, errorText, cellStyle, advancedBorderStyle, paintParts);\n\n        Rectangle contentBounds = this.GetContentBounds(rowIndex);\n\n        Point stringLocation = new Point();\n\n        stringLocation.Y = cellBounds.Y + 4;\n        stringLocation.X = cellBounds.X + contentBounds.Right + 1;\n\n        graphics.DrawString(this.Value.ToString(), Control.DefaultFont, System.Drawing.Brushes.Black, stringLocation);\n    }\n}\n</code></pre>\n"},{"tags":["c#","silverlight","debugging","xaml","visual-studio-2012"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":13100124,"title":"Can not add XAML breakpoint in Silverlight 5 project using Visual Studio 2012 RTM","body":"<p>So the problem is when i try to setup breakpoint on line with Binding markup extension I get error telling me that it's unable to set breakpoint in this location.</p>\n"},{"tags":["c#","datetime"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":59,"score":0,"question_id":13270429,"title":"Converting string to DateTime with offset","body":"<p>This is the string: <code>2007-08-31T06:59:40+02:00</code>\n<br>How do I convert it to <code>DateTime</code>?</p>\n"},{"tags":["c#","audio"],"answer_count":5,"favorite_count":17,"up_vote_count":23,"down_vote_count":0,"view_count":9157,"score":23,"question_id":1215326,"title":"Open source C# code to present wave form?","body":"<p>I just wanted to make a quick check,does any of you know of an open source c# code to present wave form (graphically) from a byte array? </p>\n\n<p>Thank you!</p>\n"},{"tags":["c#","rest","asp.net-web-api","good-design"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":85,"score":6,"question_id":13256258,"title":"REST Standards - Should output models always match input models?","body":"<p>So I have the requirement that part of the output models must include UI important information. This information is essentially text translations and suggested formats for dates, prices, lengths.</p>\n\n<p>So an example of an output model could be:</p>\n\n<pre><code>{\n  statuses : {\n    enumValue1 : \"Display This Text\",\n    enumValue2 : \"Display This Text2\",\n  },\n  thePrice : {\n    value : 3.50,\n    formattedValue : \"$3.50\"\n  },\n  length : {\n    meters 3,\n    formattedValue : \"3 ft.\"\n  },\n  iAmAPropertyOnlyInGet : 42\n}\n</code></pre>\n\n<p>Now if I have this as my output model, is it \"ok\" to have a completely different input model?</p>\n\n<pre><code>{\n  status : {\n    enumValue1,\n    enumValue2,\n  },\n  thePrice : 3.50,\n  lengthInMeters : 3  \n}\n</code></pre>\n"},{"tags":["c#","wpf","mvvm","mvvm-light"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":72,"score":1,"question_id":13213221,"title":"How a ViewModel communicates with its own View","body":"<p>I am developing a WPF MVVM Light application, I want to display some message boxes/dialog boxes or there are some other scenarios where I want my View model to communicate with its view or raise some event on its respective view.</p>\n\n<p>How could I achieve that?</p>\n"},{"tags":["c#","wkhtmltopdf"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":12525322,"title":"How to use wkHtmltoPdf to generate PDf files from statcic html files in C#","body":"<p>Can Any 1 suggest me how to use wkhtmltopdf in C# Console application to generate PDF files from static html files ??</p>\n\n<p>wkhtmltopdf  -  <a href=\"http://code.google.com/p/wkhtmltopdf/\" rel=\"nofollow\">http://code.google.com/p/wkhtmltopdf/</a></p>\n\n<p>I have tried downloading the ibwkhtmltox-0.11.0_rc1 Windows Static Library (i368) \nbut cant include its dll into my c# console app.</p>\n\n<p>Any code samples will be help full</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","java","asp.net","java-ee","soa"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":959,"score":2,"question_id":3879140,"title":"Channels for Java, J2EE, C#, asp.net and SOA","body":"<p>What are the Freenode irc channels for Java, J2EE, C#, asp.net and SOA?\nThanks in advance..:)</p>\n"},{"tags":["c#","sharepoint","httpwebrequest"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":72,"score":1,"question_id":13232543,"title":"check if folder exists c# webrequest","body":"<p>I'm using this to create a folder in an existing sharepoint location. Is there a way to check if a folder exists before creation instead of using try/catch to figure out of this method fails and then assume the folder exists?\nI've checked the webrequest methods, but there is no such this as a check.</p>\n\n<pre><code>try\n{\n    HttpWebRequest request = (System.Net.HttpWebRequest)HttpWebRequest.Create(\"https://site.sharepoint.com/files/\"+foldername);\n    request.Credentials = CredentialCache.DefaultCredentials;\n    request.UserAgent = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.0.3705;)\";\n    request.Method = \"MKCOL\";\n    HttpWebResponse response = (System.Net.HttpWebResponse)request.GetResponse();\n    response.Close();\n}\ncatch (Exception ex) \n{ \n    //if this piece fails the folder exists already \n} \n</code></pre>\n"},{"tags":["c#","xml","garbage-collection","codesynthesis"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13270244,"title":"Can garbage collection after writing XML files larger than 100MB cause an application to freeze?","body":"<p>So, I wrote a WPF application that takes in all sorts of data from a database, then using Code Synethesis it writes XML files based off of the data. The problem is, sometimes after it finishes writing, the application just seems to hang there, with the Windows Cursors.Wait icon and if I click in the application it freezes up completely and I have to Close Process on the application from Task Manager.</p>\n\n<p>Looking at a completed XML document (*.xml), its about 100MB to 200MB (including tags and everything), depending on the type of data. Is it possible that the garbage collection is the reason why the application seems to be busy for so long? Sometimes it sits for +30mins and it'll eventually resolve, but no idea why.</p>\n"},{"tags":["c#",".net","drawing","system.drawing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13269145,"title":"Get System.Drawing.Font width?","body":"<p>I'm using .Net tools to do some 2D drawing. <code>System.Drawing.Font</code> uses a <code>GetHeight()</code> that returns the height in pixels. I'm missing a <code>GetWidth()</code> to retrieve the width! What should I use?</p>\n"},{"tags":["c#","asp.net","visual-studio","gridview"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1355,"score":1,"question_id":8264670,"title":"ASP.NET Configure update button in GridView","body":"<p>I am using C# ASP.NET on VS2005. </p>\n\n<p>I have a gridview table but it does not have a selection for <em>Enable Editing</em> when I right click on the <em>Smart Tab</em>. </p>\n\n<p>Thus I manually added the edit button with the following code:</p>\n\n<p><code>AutoGenerateEditButton=\"True\"</code></p>\n\n<p>The edit button has successfully appeared on my gridview like this:\n<img src=\"http://i.stack.imgur.com/0ADAI.png\" alt=\"enter image description here\"></p>\n\n<p>When I click on the <em>Edit</em> button, the page is refreshed and the row is now editable:\n<img src=\"http://i.stack.imgur.com/ATTG9.png\" alt=\"enter image description here\"></p>\n\n<p>However, when I pressed on the update button, I was brought to the error:</p>\n\n<p><code>Updating is not supported by data source 'SqlDataSource1' unless UpdateCommand is specified.</code></p>\n\n<p><img src=\"http://i.stack.imgur.com/W97K0.png\" alt=\"enter image description here\">\n<a href=\"http://i.stack.imgur.com/W97K0.png\" rel=\"nofollow\">http://i.stack.imgur.com/W97K0.png</a></p>\n\n<p>I have no clue on how I can input or configure the <code>UpdateCommand</code> because I don't see any background code for the <code>Update</code> button.</p>\n\n<p>Need help from experienced. Thank you in advance.</p>\n\n<hr>\n\n<p>Edited: Added INSERT query in <code>SqlDataSource1</code>, however I still met the same error when I press the <code>Update</code> button.</p>\n"},{"tags":["c#","asp.net","nfc","mifare"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":8,"view_count":37,"score":-7,"question_id":13270298,"title":"Nfc mifare 1k card operation c#","body":"<p>i want a complete help for Nfc mifare 1k card operation.\ni want to read/write program (c#).</p>\n\n<p>Am using a mifare 1k card and NFC card reader.</p>\n\n<p>i want c# code for reading data and want to write data. as am a .net devplper, it is not easy to understand the hexa demical data and itz internal commands</p>\n"},{"tags":["c#","asp.net","gridview"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":33,"score":0,"question_id":13270152,"title":"Pagination for Grid View","body":"<p>I am using a Grid View of asp.net 4.0. I want to use pagination.\nI am Handling Pagination with  SQL query. I am getting only the number of records, i want to show in my grid. I want to set the total number of records to my grid, so that my grid displays page numbers (eg. 1 2 3 ....8) according to my total number of records. My grid should tell me what is the current page number which is been viewed.\nI am unable to set Page numbers according to my total record count.\nPlease Help me on this.\nThanks in Advance.</p>\n"},{"tags":["c#",".net","wpf","serialization","application-settings"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":492,"score":2,"question_id":6309026,"title":"ApplicationSettingsBase writes empty tag for custom collection","body":"<p>I have been fighting with this off and on for several days now.  I need to store a collection of custom objects as part of the user's settings.  Based on lots of google work it seems that building a preferences class off of <code>ApplicationSettingsBase</code> is an appropriate way to do so.  The problem I run into is as soon as I try to store a collection of a custom type no data gets saved for that property.  If I keep to collections of base types, such as string, things work.  I have a separate proof of concept project I have been working with for the past day to isolate down to just this issue.</p>\n\n<p>This project consists of a WPF window with a listbox and two buttons, “+” and “-“.  I have a Prefs class with three properties defining different types of collections.  In my window code I bind the listbox to one of these lists and the buttons either add or remove an item to/from the list.  Closing the window should save the contents of the list to the users.config file for the current user.  Reopening it should display the saved contents of the list.</p>\n\n<p>If I use List1 (<code>ObservableCollection&lt;string&gt;</code>) and click the + button a few times then close the window the data is correctly saved to user.config.  However if I change and use List2(<code>ObservableCollection&lt;Foo&gt;</code>) or List3(<code>FooCollection</code>) I just end up with an empty value tag.  I have tried to implement <code>ISerializable</code> and <code>IXmlSerializable</code> in attempts to get this working with no change in behavior.  In fact running in debug mode with break points shows that the collection contains data when the save method is called but the serialization interface methods are never being called.</p>\n\n<p>What am I missing?  </p>\n\n<p>UPDATE: I have changed my approach and written the data off to another file alongside of user.config for the time being so that I can make some progress on other portions of the app.  But I would still like to know why application settings base was failing to record my collection data.</p>\n\n<p>Here is all of the relevent code, if someone thinks an ommitted section is important I will add it back into the post.</p>\n\n<p>user.config after adding a couple of elements to each list property</p>\n\n<pre><code>&lt;setting name=\"List1\" serializeAs=\"Xml\"&gt;\n    &lt;value&gt;\n        &lt;ArrayOfString xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n            xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"&gt;\n            &lt;string&gt;0&lt;/string&gt;\n            &lt;string&gt;1&lt;/string&gt;\n            &lt;string&gt;2&lt;/string&gt;\n        &lt;/ArrayOfString&gt;\n    &lt;/value&gt;\n&lt;/setting&gt;\n&lt;setting name=\"List2\" serializeAs=\"Xml\"&gt;\n    &lt;value /&gt;\n&lt;/setting&gt;\n&lt;setting name=\"List3\" serializeAs=\"Xml\"&gt;\n    &lt;value /&gt;\n&lt;/setting&gt;\n</code></pre>\n\n<p>Window XAML</p>\n\n<pre><code>&lt;Grid&gt;\n    &lt;Grid.ColumnDefinitions&gt;\n        &lt;ColumnDefinition&gt;&lt;/ColumnDefinition&gt;\n        &lt;ColumnDefinition Width=\"Auto\"&gt;&lt;/ColumnDefinition&gt;\n    &lt;/Grid.ColumnDefinitions&gt;\n    &lt;ListBox Name=\"l1\" Grid.Column=\"0\" Grid.Row=\"0\" ItemsSource=\"{Binding}\"&gt;&lt;/ListBox&gt;\n    &lt;StackPanel Grid.Column=\"1\" Grid.Row=\"0\"&gt;\n        &lt;Button Name=\"bP\" Margin=\"5\" Padding=\"5\" Click=\"bP_Click\"&gt;+&lt;/Button&gt;\n        &lt;Button Name=\"bM\" Margin=\"5\" Padding=\"5\" Click=\"bM_Click\"&gt;-&lt;/Button&gt;\n    &lt;/StackPanel&gt;\n\n&lt;/Grid&gt;\n</code></pre>\n\n<p>Code Behind for Window</p>\n\n<pre><code>public partial class Window1 : Window\n{\n    Prefs Prefs = new Prefs();\n\n    public Window1()\n    {\n        InitializeComponent();\n\n        //l1.DataContext = Prefs.List1;\n        //l1.DataContext = Prefs.List2;\n        l1.DataContext = Prefs.List3;\n    }\n\n    private void Window_Closed(object sender, EventArgs e)\n    {\n        Prefs.Save();\n    }\n\n    private void bP_Click(object sender, RoutedEventArgs e)\n    {\n        //Prefs.List1.Add(Prefs.List1.Count.ToString());\n        //Prefs.List2.Add(new Foo(Prefs.List2.Count.ToString()));\n        Prefs.List3.Add(new Foo(Prefs.List3.Count.ToString()));\n    }\n\n    private void bM_Click(object sender, RoutedEventArgs e)\n    {\n        //Prefs.List1.RemoveAt(Prefs.List1.Count - 1);\n        //Prefs.List2.RemoveAt(Prefs.List2.Count - 1);\n        Prefs.List3.RemoveAt(Prefs.List3.Count - 1);\n    }\n}\n</code></pre>\n\n<p>Prefs class</p>\n\n<pre><code>class Prefs : ApplicationSettingsBase\n{\n    [UserScopedSettingAttribute()]\n    [DefaultSettingValueAttribute(null)]\n    public System.Collections.ObjectModel.ObservableCollection&lt;string&gt; List1\n    {\n        get\n        {\n            System.Collections.ObjectModel.ObservableCollection&lt;string&gt; Value = this[\"List1\"] as System.Collections.ObjectModel.ObservableCollection&lt;string&gt;;\n            if (Value == null)\n            {\n                Value = new System.Collections.ObjectModel.ObservableCollection&lt;string&gt;();\n                this[\"List1\"] = Value;\n            }\n            return Value;\n        }\n    }\n\n    [UserScopedSettingAttribute()]\n    [DefaultSettingValueAttribute(null)]\n    public System.Collections.ObjectModel.ObservableCollection&lt;Foo&gt; List2\n    {\n        get\n        {\n            System.Collections.ObjectModel.ObservableCollection&lt;Foo&gt; Value = this[\"List2\"] as System.Collections.ObjectModel.ObservableCollection&lt;Foo&gt;;\n            if (Value == null)\n            {\n                Value = new System.Collections.ObjectModel.ObservableCollection&lt;Foo&gt;();\n                this[\"List2\"] = Value;\n            }\n            return Value;\n        }\n    }\n\n    [UserScopedSettingAttribute()]\n    [DefaultSettingValueAttribute(null)]\n    public FooCollection List3\n    {\n        get\n        {\n            FooCollection Value = this[\"List3\"] as FooCollection;\n            if (Value == null)\n            {\n                Value = new FooCollection();\n                this[\"List3\"] = Value;\n            }\n            return Value;\n        }\n    }\n}\n</code></pre>\n\n<p>Foo Class</p>\n\n<pre><code>[Serializable()]\nclass Foo : System.ComponentModel.INotifyPropertyChanged, ISerializable, IXmlSerializable\n{\n    private string _Name;\n    private const string PropName_Name = \"Name\";\n    public string Name\n    {\n        get { return this._Name; }\n        set\n        {\n            if (value != this._Name)\n            {\n                this._Name = value;\n                RaisePropertyChanged(Foo.PropName_Name);\n            }\n        }\n    }\n    public override string ToString()\n    {\n        return Name;\n    }\n\n    public Foo() { }\n    public Foo(string name)\n    {\n        this._Name = name;\n    }\n\n    #region INotifyPropertyChanged Members\n/***Omitted for space***/\n    #endregion\n\n    #region ISerializable Members\n    public Foo(SerializationInfo info, StreamingContext context)\n    {\n        this._Name = (string)info.GetValue(Foo.PropName_Name, typeof(string));\n    }\n    public void GetObjectData(SerializationInfo info, StreamingContext context)\n    {\n        info.AddValue(Foo.PropName_Name, this._Name);\n    }\n    #endregion\n\n    #region IXmlSerializable Members\n    public System.Xml.Schema.XmlSchema GetSchema()\n    {\n        return null;\n    }\n\n    public void ReadXml(System.Xml.XmlReader reader)\n    {\n        reader.MoveToContent();\n        _Name = reader.GetAttribute(Foo.PropName_Name);\n        bool Empty = reader.IsEmptyElement;\n        reader.ReadStartElement();\n        if (!Empty)\n        {\n            reader.ReadEndElement();\n        }\n    }\n\n    public void WriteXml(System.Xml.XmlWriter writer)\n    {\n        writer.WriteAttributeString(Foo.PropName_Name, _Name);\n    }\n    #endregion\n}\n</code></pre>\n\n<p>and FooCollection class</p>\n\n<pre><code>[Serializable()]\nclass FooCollection : ICollection&lt;Foo&gt;, System.ComponentModel.INotifyPropertyChanged, INotifyCollectionChanged, ISerializable, IXmlSerializable\n{\n    List&lt;Foo&gt; Items;\n    private const string PropName_Items = \"Items\";\n\n    public FooCollection()\n    {\n        Items = new List&lt;Foo&gt;();\n    }\n\n    public Foo this[int index]\n    {\n/***Omitted for space***/\n    }\n\n    #region ICollection&lt;Foo&gt; Members\n/***Omitted for space***/\n    #endregion\n\n    public void RemoveAt(int index)\n    {\n/***Omitted for space***/\n    }\n\n    #region IEnumerable Members\n/***Omitted for space***/\n    #endregion\n\n    #region INotifyCollectionChanged Members\n/***Omitted for space***/\n    #endregion\n\n    #region INotifyPropertyChanged Members\n/***Omitted for space***/\n    #endregion\n\n    #region ISerializable Members\n    public FooCollection(SerializationInfo info, StreamingContext context)\n    {\n        this.Items = (List&lt;Foo&gt;)info.GetValue(FooCollection.PropName_Items, typeof(List&lt;Foo&gt;));\n    }\n    public void GetObjectData(SerializationInfo info, StreamingContext context)\n    {\n        info.AddValue(FooCollection.PropName_Items, this.Items);\n    }\n    #endregion\n\n    #region IXmlSerializable Members\n    public System.Xml.Schema.XmlSchema GetSchema()\n    {\n        return null;\n    }\n\n    public void ReadXml(System.Xml.XmlReader reader)\n    {\n        XmlSerializer FooSerializer = new XmlSerializer(typeof(Foo));\n\n        reader.MoveToContent();\n        bool Empty = reader.IsEmptyElement;\n        reader.ReadStartElement();\n        if (!Empty)\n        {\n            if (reader.IsStartElement(FooCollection.PropName_Items))\n            {\n                reader.ReadStartElement();\n\n                while (reader.IsStartElement(\"Foo\"))\n                {\n                    this.Items.Add((Foo)FooSerializer.Deserialize(reader));\n                }\n\n                reader.ReadEndElement();\n            }\n\n            reader.ReadEndElement();\n        }\n    }\n\n    public void WriteXml(System.Xml.XmlWriter writer)\n    {\n        XmlSerializer FooSerializer = new XmlSerializer(typeof(Foo));\n\n        writer.WriteStartElement(FooCollection.PropName_Items);\n\n        foreach (Foo Item in Items)\n        {\n            writer.WriteStartElement(\"Foo\");\n            FooSerializer.Serialize(writer, Item);\n            writer.WriteEndElement();//\"Foo\"\n        }\n\n        writer.WriteEndElement(); //FooCollection.PropName_Items\n    }\n    #endregion\n}\n</code></pre>\n"},{"tags":["c#","facebook","windows-phone-7","share"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":376,"score":2,"question_id":8374585,"title":"WP 7.5 ShareLinkTask doesn't add miniature in facebook","body":"<p>My users are complaining that when they share a link to an image (directly) on facebook they don't get miniature next to it... is there something I'm doing wrong (I'm using WP 7.5 ShareLinkTask class, code below)? Or is the only way to re-implement or use other FB library?</p>\n\n<pre><code>        ShareLinkTask t = new ShareLinkTask();\n        t.LinkUri = new Uri(model.ImageUrl);\n        t.Title = model.Name;\n        t.Show();\n</code></pre>\n\n<h2>-------------------------------------</h2>\n\n<p><strong>This is what I mean:</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/X50lP.png\" alt=\"This is what I mean\"></p>\n"},{"tags":["c#","java","asp.net","pdf","itextsharp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13268218,"title":"Replace existing existing pdf form field with new form field at the same palce","body":"<p>I need to replace a check box in existing pdf with new check box using ItextSharp.</p>\n\n<p>While reading the Pdf how do I know the location of form field which I am reading.</p>\n\n<p>rectangle measures and page information (If the form field I am reading now is in page number 6). </p>\n\n<p>Precisely what I want to know is how to know existing form field location while reading?\nCan anyone provide some sample code on finding location and page.</p>\n\n<p>Why am I trying to replace existing pdf? you can find the reason here.. </p>\n\n<p><a href=\"http://stackoverflow.com/questions/13265592/unable-to-print-check-boxes-in-pdf\">Unable to print Check Boxes in pdf</a></p>\n\n<p>Thanks</p>\n"},{"tags":["c#","asp.net","telerik","rad-controls","radcombobox"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13264747,"title":"How to bind Radcombobox items client side with database values?","body":"<p>I am using oracle as my back end. how to bind radcombobox with database(oracle) table values form client side.\nas follows if i have emp table then columns are emp id and name so i has to bind emp id and name to rad combo box form client side.</p>\n"},{"tags":["c#","asp.net","web-services","bytearray","jsonarray"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13268249,"title":"How to convert this json array into list","body":"<p>My json Array:</p>\n\n<pre><code> {\"lstResult\":[{\"food_photo\":[255,216,255,224,0,16,74,70,73,70,0,1........3,5],\"food\":\"12\",\"qty_uom\":\"Pcs\",\"unit\":null}]}\n</code></pre>\n\n<p>my C# class:</p>\n\n<pre><code> public class lstresult\n    {\n    public photo[] lstResult{get;set;}\n    }\n\npublic class photo\n{\npublic byte[] food_photo{get;set;}\n}\npublic class Food\n{\n    public photo[] food_photo { get; set; }\n    public int food_qty { get; set; }\n    public string qty_uom { get; set; }\n    public string unitcost { get; set; }\n}\n</code></pre>\n\n<p>My question: </p>\n\n<blockquote>\n  <p>my json string contain a \"food_photo\" key how to convert this byte array into\n  image? or convert into list in asp.net\n  Thanks in advance</p>\n</blockquote>\n"},{"tags":["c#","gps","coordinates","latitude-longitude"],"answer_count":4,"favorite_count":3,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13269558,"title":"Find closest city to given location","body":"<p>I am trying to find the closest city to given location. I have stored location of some cities that I want to work with. And I have my location, but I dont know how to find the closest city to my location ?</p>\n\n<pre><code>Cities\nNew York - Lat 40.714353; Long -74.005973\nWashington - Lat 38.895112; Long -77.036366\n....more cities\n\nMy location\nPhiladephia - Lat 39.952335; Long -75.163789\n</code></pre>\n\n<p>So how should I compare the coords to find the closest city ? I am doing program in C# but just knowing the solution of algorythm is enaught for me :)\nThanks for any help</p>\n"},{"tags":["c#","asp.net-mvc","asp.net-membership","viewdata"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13269786,"title":"Storing Additional Information About a Logged In ASP.NET MVC User","body":"<p>I need to store an ID against a user that will be used in EVERY action that is carried out on my web application. I had hoped to use a customized authorization <code>ActionFilterAttribute</code> (on an entire controller) to populate the <code>ViewData</code> with this additional info, but it turns out that a whole STACK of stuff runs before these <code>ActionFilterAttributes</code> do e.g. ModelBinding, Controller construction</p>\n\n<p>I thought perhaps there may be a way to extend the <code>HttpContext.User.Identity</code> to store additional data but have no idea even where to start.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["c#",".net","winforms","image-processing"],"answer_count":0,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":26,"score":2,"question_id":13270031,"title":"Looking for high-level Instagram/Microsoft Word like image processing library","body":"<p>Currently, I am looking for a (commercial or free) .NET/C# image processing library for a WinForms project to apply customizable effects like Instagram or Microsoft Office Word does, e.g.:</p>\n\n<p><img src=\"http://i.stack.imgur.com/tg7VY.png\" alt=\"enter image description here\"></p>\n\n<p>I found plenty of image libraries like:</p>\n\n<ul>\n<li><a href=\"http://www.imagemagick.org/script/index.php\" rel=\"nofollow\">ImageMagick</a></li>\n<li><a href=\"http://www.leadtools.com/\" rel=\"nofollow\">Lead Tools</a></li>\n<li><a href=\"http://freeimage.sourceforge.net/\" rel=\"nofollow\">Free Image</a></li>\n<li><a href=\"https://www.atalasoft.com/products/dotimage-sdk-1\" rel=\"nofollow\">DotImage</a></li>\n<li>...</li>\n</ul>\n\n<p>Unfortunately, all these libraries seem to provide a rather low-level way of manipulating images. When it comes to high-level effects like borders, rotation, vintage filters like Instagram, etc., I found zero libraries.</p>\n\n<p>(Ironically, for JavaScript, <a href=\"http://stackoverflow.com/questions/8192317/create-instagram-esque-filters-with-javascript\">there are quite a few libraries out there</a>)</p>\n\n<p>Maybe there is no market for such a library, still I would love to have this function in my application without doing everything on my own.</p>\n\n<p><strong>Therefore my question is:</strong></p>\n\n<p>Is there a .NET library available to have a customizable and extendable way of applying various high-level filters to images?</p>\n"},{"tags":["c#",".net","visual-studio-2010","silverlight",".net-4.5"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13229923,"title":"NullReferenceException on Fresh Silverlight Project - Designer","body":"<p>I just created a new Silverlight project along side an existing web project. (Visual Studio 2010)</p>\n\n<p>The designer window is now showing \"An unhandled exception has occured\". </p>\n\n<p><strong>Note: The project has no additional code added, it has only the default code.</strong></p>\n\n<p><em>Part of the stacktrace is below.</em></p>\n\n<p>System.NullReferenceException</p>\n\n<p>Object reference not set to an instance of an object.\n     at   </p>\n\n<p>Microsoft.Windows.Design.Platform.SilverlightMetadataContext.SilverlightXamlExtensionImplementations.d__8.MoveNext()</p>\n\n<p>at MS.Internal.Design.Metadata.ReflectionProjectNode.BuildSubsumption()</p>\n\n<p>at MS.Internal.Design.Metadata.ReflectionProjectNode.SubsumingNamespace(Identifier identifier)</p>\n"},{"tags":["c#","xml-parsing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":219,"score":0,"question_id":11241977,"title":"XML Clean up (remove invalid characters from attribute value)","body":"<p>How can i remove none valid chars from xml but keep standard\nfor example i want remove all &lt; and \" from attribute value inner strings</p>\n\n<pre><code>&lt;log&gt;\n  &lt;data id=\"1\" name=\"No Error\"  value=\"0\" /&gt;\n  &lt;data id=\"2\" name=\"Error \"1\" between text\" value=\"0\" /&gt;\n  &lt;data id=\"3\" name=\"Error &lt;2&gt; between text\"  value=\"0\"  /&gt;\n&lt;/log&gt;\n</code></pre>\n\n<p>How can i daynamicly remove quotes surrounds \"1\"\nand &lt;> surrounds 2</p>\n\n<p>that final out put shuld be</p>\n\n<pre><code>&lt;log&gt;\n  &lt;data id=\"1\" name=\"No Error\"  value=\"0\"  /&gt;\n  &lt;data id=\"2\" name=\"Error 1 between text\" value=\"0\" /&gt;\n  &lt;data id=\"3\" name=\"Error 2 between text\"  value=\"0\"  /&gt;\n&lt;/log&gt;\n</code></pre>\n\n<p>Thanks for the suppot</p>\n\n<p>I was thinking of the following solution:</p>\n\n<ol>\n<li>Read the file as text</li>\n<li>Modify any string that starts with <code>&lt;Name=&gt;</code> and ends with\n<code>&lt;value=&gt;</code></li>\n<li>remove all <code>\",&lt;,&gt;</code> </li>\n<li>add <code>\"</code> after <code>&lt;name=&gt;</code> and add <code>\"</code> before <code>&lt;value=&gt;</code></li>\n</ol>\n\n<p>if this is correct, how can i do this with C#, the replace method will not work.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","xna"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":42,"score":1,"question_id":13259841,"title":"Button press calls method multiple times","body":"<p>i'm working on a XNA game and i've encountered a problem. Whenever i press a key in the game, the method that is triggered by the key press is called multiple times. For example, when the user presses the attack button (space) the character attacks like 10 times within one  key press. I want the key press to trigger the method just one time. Even if the user holds down a key i want some methods to be called only once. For now i've solved it by writing a thread.sleep after each button press, but that seems VERY unefficient. I hope my problem i understandable. Thanks in advance!</p>\n"},{"tags":["c#","xml","excel","ms-access"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13269987,"title":"I need to flatten this XML data, so i can import it to Excel","body":"<p>I've been trying for days to get this data into Excel or Access, but i have little experience with XML / XSD. I dont know what is the best approach when it comes to importing data into Excel/Access. Excel doesn't support nested elements afaik. Access dont seem to bother with the linking of nested data. Sooo i might end up flattening the structure my self for Excel, which in either case would be the program i need for final analysis.</p>\n\n<p>I would like it flat or even csv format, but my concern is the size of the file. I have a subset of the data now an this xml file is already 11Meg and its a few precent of the total data.</p>\n\n<p>This is my XML file, a subset.</p>\n\n<pre><code>    &lt;Root&gt;\n    &lt;Delivery&gt;\n    &lt;Database&gt;xxxxxxx&lt;/Database&gt;\n    &lt;Path&gt;SomeUNCPath&lt;/Path&gt;\n&lt;Vessel&gt;\n&lt;SysFolder&gt;internalfolder&lt;/Sysfolder&gt;\n&lt;MoreData&gt;1&lt;/MoreData&gt;\n&lt;EvenMoreData&gt;2&lt;/EvenMoreData&gt;\n&lt;Depths&gt;\n&lt;NumberOfItems&gt;2&lt;/NumberOfItems&gt;\n&lt;Depth&gt; \n&lt;MoreData&gt;1&lt;/MoreData&gt;\n&lt;EvenMoreData&gt;2&lt;/EvenMoreData&gt;\n&lt;/Depth&gt;\n&lt;Depth&gt;\n...\n&lt;/Depth&gt;\n&lt;Vessel&gt;\n&lt;SysFolder&gt;Anotherinternalfolder&lt;/Sysfolder&gt;\n&lt;MoreData&gt;1&lt;/MoreData&gt;\n&lt;EvenMoreData&gt;2&lt;/EvenMoreData&gt;\n&lt;Depths&gt;\n&lt;NumberOfItems&gt;2&lt;/NumberOfItems&gt;\n&lt;Depth&gt; \n&lt;MoreData&gt;1&lt;/MoreData&gt;\n&lt;EvenMoreData&gt;2&lt;/EvenMoreData&gt;\n&lt;/Depth&gt;\n&lt;Depth&gt;\n...\n&lt;/Depth&gt;\n&lt;EngineRoot&gt;\n&lt;SysFolder&gt;internalfolder&lt;/Sysfolder&gt;\n&lt;NumberOfEngines&gt;5&lt;/NumberOfEngines&gt;\n&lt;Engine&gt;5 Elements of this with data&lt;/Engine&gt;\n&lt;/EngineRoot&gt;\n&lt;EngineRoot&gt;\n&lt;SysFolder&gt;Anotherinternalfolder&lt;/Sysfolder&gt;\n&lt;NumberOfEngines&gt;5&lt;/NumberOfEngines&gt;\n&lt;Engine&gt;5 Elements of this with data&lt;/Engine&gt;\n&lt;/EngineRoot&gt;\n</code></pre>\n"},{"tags":["c#","text-to-speech","speech-synthesis"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":448,"score":2,"question_id":10304913,"title":"Speech Synthesizer \"Input string was not in a correct format\"","body":"<p>Here is my code:</p>\n\n<pre><code>string _message = \"Hello world.\";\nSpeechSynthesizer _synth = new SpeechSynthesizer();\nPrompt _prompt = new Prompt(_message);\n_synth.Speak(_prompt);\n</code></pre>\n\n<p>I can not for the life of me figure out what exactly is causing this error:</p>\n\n<p>\"Input string was not in a correct format.\"</p>\n\n<p>The line that causes this error is when I call <code>_synth.Speak(_prompt);</code>\n<br/>\nEDIT: I have tried this code on my desktop computer and it works fine so something is wrong with my install on my laptop. Still I'm not too sure how to fix this...<br/></p>\n\n<p>EDIT:</p>\n\n<p>The stacktrace:</p>\n\n<pre><code>System.FormatException: Input string was not in a correct format.\n   at System.Number.StringToNumber(String str, NumberStyles options, NumberBuffe\nr&amp; number, NumberFormatInfo info, Boolean parseDecimal)\n   at System.Number.ParseInt32(String s, NumberStyles style, NumberFormatInfo in\nfo)\n   at System.Speech.Internal.SapiAttributeParser.GetCultureInfoFromLanguageStrin\ng(String valueString)\n   at System.Speech.Synthesis.VoiceInfo..ctor(VoiceObjectToken token)\n   at System.Speech.Internal.Synthesis.VoiceSynthesis.BuildInstalledVoices(Voice\nSynthesis voiceSynthesizer)\n   at System.Speech.Internal.Synthesis.VoiceSynthesis..ctor(WeakReference speech\nSynthesizer)\n   at System.Speech.Synthesis.SpeechSynthesizer.get_VoiceSynthesizer()\n   at System.Speech.Synthesis.SpeechSynthesizer.Speak(Prompt prompt)\n   at TTSTesting.Program.Speak(String _message) in C:\\Users\\ctanaka\\Desktop\\TTST\nesting\\TTSTesting\\Program.cs:line 22\n</code></pre>\n"},{"tags":["c#","multithreading","waithandle"],"answer_count":4,"favorite_count":8,"up_vote_count":15,"down_vote_count":0,"view_count":5590,"score":15,"question_id":2702545,"title":"Workaround for the WaitHandle.WaitAll 64 handle limit?","body":"<p>My application spawns loads of different small worker threads via <code>ThreadPool.QueueUserWorkItem</code> which I keep track of via multiple <code>ManualResetEvent</code> instances. I use the <code>WaitHandle.WaitAll</code> method to block my application from closing until these threads have completed.</p>\n\n<p>I have never had any issues before, however, as my application is coming under more load i.e. more threads being created, I am now beginning to get this exception:</p>\n\n<p><code>WaitHandles must be less than or equal to 64 - missing documentation</code></p>\n\n<p>What is the best alternative solution to this?</p>\n\n<p><b> Code Snippet </b></p>\n\n<pre><code>List&lt;AutoResetEvent&gt; events = new List&lt;AutoResetEvent&gt;();\n\n// multiple instances of...\nvar evt = new AutoResetEvent(false);\nevents.Add(evt);\nThreadPool.QueueUserWorkItem(delegate\n{\n    // do work\n    evt.Set();\n});\n\n...\nWaitHandle.WaitAll(events.ToArray());\n</code></pre>\n\n<p><b> Workaround </b></p>\n\n<pre><code>int threadCount = 0;\nManualResetEvent finished = new ManualResetEvent(false);\n\n...\nInterlocked.Increment(ref threadCount);\nThreadPool.QueueUserWorkItem(delegate\n{\n    try\n    {\n         // do work\n    }\n    finally\n    {\n        if (Interlocked.Decrement(ref threadCount) == 0)\n        {\n             finished.Set();\n        }\n    }\n});\n\n...\nfinished.WaitOne();\n</code></pre>\n"},{"tags":["c#","dynamic-html"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13230044,"title":"dynamically change the html table tag width which is in string","body":"<p>I am doing a CLR procedure of sending mail, I have composed the html into my string , After binding some dynamic values I have been able to send mail.</p>\n\n<p>But Now the issue is , I am getting a string which containing the HTML, So I want to find the first <code>&lt;table&gt;</code> and then change its width. it.[Due to large width the template is disturbing]. This  is the body of the email.</p>\n\n<pre><code> string StrHtml =\" &lt;table cellspacing='1' cellpadding='10' border='0'\nstyle='width:880px'&gt;&lt;/table&gt;\"\n</code></pre>\n\n<p>I want to change the <code>style='width:880px' to style='width:550px'</code></p>\n\n<p>I am doing this code only in class library. what is the best way to do this?</p>\n\n<p>My Code is :</p>\n\n<pre><code>string ImgPath = string.Empty;\nImgPath = Convert.ToString(ds.Tables[0].Rows[i][\"GroupMessage\"]);\nstring pattern = string.Empty;\npattern = System.Text.RegularExpressions.Regex.(ImgPath, \"(&lt;table.*?&gt;.*&lt;/table&gt;\", System.Text.RegularExpressions.RegexOptions.IgnoreCase).Groups[1].Value;  \n\nMailMessage message = new MailMessage();\nmessage.AlternateViews.Add(htmlMail);\nmessage.Body = ImgPath ; //\nmessage.IsBodyHtml = true;\n//Other mail sending code here.....\n</code></pre>\n"},{"tags":["c#","winforms","random","numbers"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13269757,"title":"Generating a number with 7 digits with the ability to have zeros at the front","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4325267/c-sharp-convert-int-to-string-with-padding-zeros\">C# convert int to string with padding zeros?</a>  </p>\n</blockquote>\n\n\n\n<p>I am trying to generate a random number however in the ranges I have included \"0000000, 9999999\" I want it to show these zeros when a number is generated for example the following outputs would be:</p>\n\n<p>\"00037544\"\n\"01659369\" \n\"75484957\"\n\"00000001\"</p>\n\n<p>I am using the:</p>\n\n<pre><code>    int num = rnd.Next(0000000, 9999999);\n</code></pre>\n\n<p>The problem with that is sometimes it will generate:</p>\n\n<p>\"1648\"\n\"947596\"\n\"18500\" etc</p>\n\n<p>Is there something that im missing? </p>\n\n<p>Thanks for looking</p>\n"},{"tags":["c#",".net","mp3"],"answer_count":6,"favorite_count":4,"up_vote_count":7,"down_vote_count":0,"view_count":5458,"score":7,"question_id":1214040,"title":"How to get the length of a MP3 in C#","body":"<p>Yes this is an exact duplicate of <a href=\"http://stackoverflow.com/questions/1007547/finding-mp3-length-in-c\">this question</a>, but the link given and accepted as answer is not working for me. It is returning incorrect values (a 2 minutes mp3 will be listed as 1'30, 3 minutes as 2'20) with no obvious pattern.</p>\n\n<p>So here it is again: how can I get the length of a MP3 using C# ? </p>\n\n<p><em>or</em></p>\n\n<p>What am I doing wrong with the <a href=\"http://www.devhood.com/tutorials/tutorial%5Fdetails.aspx?tutorial%5Fid=79\">MP3Header class</a>:</p>\n\n<pre><code>MP3Header mp3hdr = new MP3Header();\nbool boolIsMP3 = mp3hdr.ReadMP3Information(\"1.mp3\");\nif(boolIsMP3)\n  Response.Write(mp3hdr.intLength);\n</code></pre>\n"},{"tags":["c#",".net","mp3"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":605,"score":3,"question_id":4499470,"title":"Is there a C# library that allows you to query mp3 duration and bitrate","body":"<p>I'm looking for an open source library (BSD/MIT style license) that allows me to extract the bitrate and duration of a MP3 audio file in dot net. </p>\n\n<p>Any takers?</p>\n"},{"tags":["c#",".net","directx","mp3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":266,"score":2,"question_id":11127092,"title":"How to retrieve the correct Duration of an mp3 audio file in C#/.NET/DirectX?","body":"<p>I am writing a media presentation program, and I am nearly complete, but for some reason I am getting incorrect durations of mp3 files. I use the Microsoft.DirectX.AudioVideoPlayback.Audio class to play audio files, and it works well for wav files. From google search, I can tell that it seems to be a problem when the mp3s are encoded using a variable bit rate, however I need my program to report accurately regardless of the bit rate settings of the media. Here is the code:</p>\n\n<pre><code>Media_Audio aud = (Media_Audio)item.MediaFile;\nTimeSpan total = aud.EndTime - aud.StartTime;\nif (aud.EndTime.TotalSeconds == 0)\n{\n    total = TimeSpan.FromSeconds(aud.Player.Duration)-aud.StartTime;\n}\nTimeSpan now = TimeSpan.FromSeconds(aud.Player.CurrentPosition) - aud.StartTime;\nstring nows = now.Hours.ToString() + \":\" + now.Minutes.ToString() + \":\" + now.Seconds.ToString();\nstring tots = total.Hours.ToString() + \":\" + total.Minutes.ToString() + \":\" + total.Seconds.ToString();\nitem.currentPosition.Text = nows + \"/\" + tots;\n</code></pre>\n\n<p>The key line being:</p>\n\n<pre><code>total = TimeSpan.FromSeconds(aud.Player.Duration)-aud.StartTime;\n</code></pre>\n\n<p>aud.Player is an instance of Microsoft.DirectX.AudioVideoPlayback.Audio.</p>\n\n<p>For a song that is, in fact, 5:49 seconds long, it reports 39:13 as the duration. The same length as Windows Explorer and VLC Player. Also, have the K-Lite Mega Codec pack installed. so it could be interfering. I am aware of this question: <a href=\"http://stackoverflow.com/questions/383164/how-to-retrieve-duration-of-mp3-in-net\">How to retrieve duration of MP3 in .NET?</a>\nHowever, at this stage in my program I do not have the time to switch from my current method of playing audio files to a new one, so do I have any other options to determine the duration using DirectX only? Or Will I have to resort to BASS.NET or TagLib Sharp? (And does meta-data even contain accurate information for VBR-encoded mp3s?)</p>\n"},{"tags":["c#","wpf","listbox"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":267,"score":1,"question_id":11363203,"title":"How to get a dynamic ListBox ItemTemplate to stretch horizontally the full width of the ListBox?","body":"<p>I have a normal listbox with a custom template to show the items. What I cannot manage is to stretch the template horizontally over the full widtg of the list box.</p>\n\n<p>My problem is, that all of the elements in the main window are put dynamically, and they resize along with the window size changed method. I've searched through the net and the idea was to put HorizontalAligment=\"Stretch\". This I tried, everywhere possible, with no significant success.</p>\n\n<p>my xaml code goes like this:</p>\n\n<pre><code>&lt;UserControl x:Class=\"LiveGames.Dealer.UsersList\"\n         xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n         xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n         xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" \n         xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\" \n         mc:Ignorable=\"d\" \n         Background=\"Transparent\"&gt;\n&lt;Border CornerRadius=\"10\" BorderBrush=\"White\" BorderThickness=\"2\" &gt;\n     &lt;Grid&gt;\n        &lt;Grid.Resources&gt;\n            &lt;DataTemplate x:Key=\"PlayerTemplate\"&gt;\n                &lt;WrapPanel&gt;\n                    &lt;Border CornerRadius=\"10\" BorderBrush=\"White\" BorderThickness=\"2\" &gt;\n                        &lt;Border.Background&gt;\n                            &lt;LinearGradientBrush StartPoint=\"0.5,0\" EndPoint=\"0.5,1\"&gt;\n                                &lt;GradientStop Offset=\"0.0\" x:Name=\"gradientOne_Name\" Color=\"Red\" /&gt;\n                                &lt;GradientStop Offset=\"1.0\" x:Name=\"gradientTwo_Name\" Color=\"DarkRed\" /&gt;\n                            &lt;/LinearGradientBrush&gt;\n                        &lt;/Border.Background&gt;\n                        &lt;Grid &gt;\n                            &lt;Grid.ColumnDefinitions x:Uid=\"5\"&gt;\n                                &lt;ColumnDefinition  Width=\"*\"/&gt;\n                            &lt;/Grid.ColumnDefinitions&gt;\n                            &lt;Grid.RowDefinitions&gt;\n                                &lt;RowDefinition Name=\"RowH\" Height=\"50\"/&gt;\n                            &lt;/Grid.RowDefinitions&gt;\n\n                            &lt;!--  &lt;TextBlock VerticalAlignment=\"Center\" Margin=\"5\" Grid.Column=\"0\" Grid.Row=\"1\" Text=\"Player: \" FontSize=\"18\" /&gt;--&gt;\n                            &lt;TextBlock VerticalAlignment=\"Center\" Margin=\"5\" Grid.Column=\"0\" Text=\"{Binding Path=ID}\" FontSize=\"22\" FontWeight=\"Bold\"/&gt;\n                        &lt;/Grid&gt;\n                    &lt;/Border&gt;\n                &lt;/WrapPanel&gt;\n            &lt;/DataTemplate&gt;\n        &lt;/Grid.Resources&gt;\n        &lt;Canvas&gt;\n            &lt;ListBox Name=\"userList\" Background=\"Transparent\" BorderBrush=\"Transparent\" BorderThickness=\"0\" ItemsSource=\"{Binding}\"  ItemTemplate=\"{StaticResource PlayerTemplate}\" HorizontalContentAlignment=\"Stretch\"&gt;\n                &lt;ListBox.ItemContainerStyle&gt;\n                    &lt;Style TargetType=\"ListBoxItem\" &gt;\n                        &lt;Setter Property=\"HorizontalContentAlignment\" Value=\"Stretch\"/&gt;\n                    &lt;/Style&gt;\n                &lt;/ListBox.ItemContainerStyle&gt;\n            &lt;/ListBox&gt;\n        &lt;/Canvas&gt;\n    &lt;/Grid&gt;\n&lt;/Border&gt;\n</code></pre>\n\n<p></p>\n\n<p>Does anybody have any idea how to do this, maybe even in the code behind?</p>\n\n<p>M</p>\n"},{"tags":["c#","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13265442,"title":"WPF Listview item highlight by their first character","body":"<p>I have a listview and it binds customer datas from database. I want to be focused by their first character. For example, when I click on to \"B\" from keyboard then, highlight focus must go to customers whose names' first character is \"B\". Do you have any idea? My listview's XAML is below.</p>\n\n<pre><code>&lt;ListView x:Name=\"datalist\" ButtonBase.Click=\"datalist_Click\" ContextMenuOpening=\"datalist_ContextMenuOpening\" MouseDoubleClick=\"datalist_MouseDoubleClick\" SelectionChanged=\"datalist_SelectionChanged\"\nMouseUp=\"datalist_MouseUp\" PreviewMouseUp=\"datalist_PreviewMouseUp\" &gt; \n</code></pre>\n"},{"tags":["c#","asp.net","sql","database","polling"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13269609,"title":"Datatable: Does it retrieve all data at once or when it is needed","body":"<p>We have a performance problem in production, we are trying to solve. During our attempt to solve it, we have our eyes on the datatable. </p>\n\n<p><strong>Our flow</strong>:</p>\n\n<ol>\n<li>We run a select query on the database</li>\n<li>Put the data into a <code>DataTable</code></li>\n<li>We write out all the data into a <code>StringBuilder</code> with a separator</li>\n<li>The <code>StringBuilder</code> writes all text into the <code>Response.Write</code>, which builds a CSV file</li>\n</ol>\n\n<p>The problem is in production, our client says the operation times out. We can't reproduce the timeout in development, which might be because of the amounts of data in production.</p>\n\n<p><strong>Step 1</strong>:</p>\n\n<p>We've run a profiler on the select query, and that runs really fast.</p>\n\n<p><strong>Step 2</strong>:</p>\n\n<p>We have the following code:</p>\n\n<pre><code>SqlDataReader reader = searchQuery.ExecuteReader();\nreturnTable.Load(reader);\n</code></pre>\n\n<p><strong>Step 3</strong>:</p>\n\n<p>We iterate the <code>returnTable</code> like this:</p>\n\n<pre><code>foreach (DataRow order in orders.Rows)\n{\n      trackingNumber = order[\"TrackingNumber\"] != null ? order[\"TrackingNumber\"].ToString() : errString;\n      created = order[\"Created\"] != null ? ((DateTime)order[\"Created\"]).ToString() : errString;\n      // rest of the fields\n}\n</code></pre>\n\n<p><strong>Step 4:</strong></p>\n\n<pre><code>HttpContext.Current.Response.Write(bld.ToString());\n</code></pre>\n\n<p>Now, when we have run step 2, what happens? Is the <code>DataTable</code> fully loaded? </p>\n\n<p>I could see a problem if we poll the database in each and every row in step 3, as that could slow our process. But if it loads it all at once, I can't see how this could be a problem.</p>\n\n<p>So basically: does the <code>DataTable</code> load everything at once, or does it use lazy loading?</p>\n"},{"tags":["c#","rtf"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13269532,"title":"How to find RTF table cell color from the color table","body":"<p>I want read table contents from a RTF file along with table cell color information. In my RTF file, the color table defined as ,</p>\n\n<pre><code>{\\colortbl;\n\\red0\\green0\\blue0;\n\\red0\\green0\\blue255;\n\\red0\\green255\\blue255;\n\\red0\\green255\\blue0;\n\\red255\\green0\\blue255;\n\\red255\\green0\\blue0;\n\\red255\\green255\\blue0;\n\\red255\\green255\\blue255;\n\\red0\\green0\\blue128;\n\\red0\\green128\\blue0;\n\\red128\\green0\\blue128;\n\\red128\\green0\\blue0;\n\\red128\\green128\\blue0;\n\\red128\\green128\\blue128;\n\\red192\\green192\\blue192;\n}\n</code></pre>\n\n<p>and I have the RTF for table header row as ,</p>\n\n<pre><code>\\trowd \\trql\\trgaph90\\trleft-90\\trautofit1\n\\clvertalt\n\\clbrdrl\\brdrs\\brdrw15\\brdrcf1\n\\clbrdrt\\brdrs\\brdrw15\\brdrcf1\n\\clbrdrr\\brdrs\\brdrw15\\brdrcf1\n\\clbrdrb\\brdrs\\brdrw15\\brdrcf1\n\\clcfpat7\\clcbpat8\\clshdng2000\n\\cellx1440\n\\clvertalt\n\\clbrdrl\\brdrs\\brdrw15\\brdrcf1\n\\clbrdrt\\brdrs\\brdrw15\\brdrcf1\n\\clbrdrr\\brdrs\\brdrw15\\brdrcf1\n\\clbrdrb\\brdrs\\brdrw15\\brdrcf1\n\\clcfpat7\\clcbpat8\\clshdng2000\n\\cellx2970\n\\pard\n\\intbl \\widctlpar\\keep\\hyphpar0\n\\li0\\ri0\\fi0\n\\ql{Product Name\\cell\n}{Price\\cell}\\row\n</code></pre>\n\n<p>Table cell background information are given as \"\\clcfpat7\\clcbpat8\\clshdng2000\".</p>\n\n<p>Please help me to find the correct color of the table cell from the color information.</p>\n"},{"tags":["c#","asp.net","epplus"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13269591,"title":"setting cell width with epplus affects the whole column","body":"<p>I'm having a bit of trouble on solving this. Is there a way to set the width of a specific cell from a worksheet using epplus? Because when i use, for example:</p>\n\n<pre><code>ws.Column(1).Width = 40;\n</code></pre>\n\n<p>the whole column gets affected.</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["c#","unit-testing","nunit"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13267723,"title":"NUnit - common assertions after each test","body":"<p>I'm writing service tests with database(without mocks).</p>\n\n<p>I have a new requirement to perform common database \"health\" checks* after each test in our test suits.</p>\n\n<p>The question is: where can I put this kind of tests/checks?</p>\n\n<p>At first I thought about TearDown, but AFAIK it was supposed(designed) to perform cleanup not assertions.\nWould it be ok to put it there? </p>\n\n<p>I'm not doing anything on teardown right now (and that is probably not going to change) - the database is cleaned on SetUp and each and every test is responsible for preparing the environment for itself.</p>\n\n<p>*- the database design is inherited from another company and unfortunately its very poor - we've discovered inconsistencies in data and that's why we need to perform 'health checks' to identify places where they occur</p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":88,"score":0,"question_id":12941028,"title":"Group by multiple values and break down to weekly periods","body":"<p>I'm still learning LINQ and have a task where I need to group Booking objects by four properties and then by weekly intervals depending on the input timerange. </p>\n\n<pre><code>public class Booking\n{\n    public string Group { get; set; }\n    public BookingType Type { get; set; }\n    public BookingStatus Status { get; set; }\n    public decimal Price { get; set; }\n    public bool Notification { get; set; }\n    public DateTime Date { get; set; }\n}\n</code></pre>\n\n<p>Let's say we have the following Bookings:</p>\n\n<pre><code>        IList&lt;Booking&gt; Bookings = new List&lt;Booking&gt;\n        {\n            new Booking{Group = \"Group1\", Type = BookingType.Online, Status = BookingStatus.New, Price = 150, Date = new DateTime(2012,06,01)},\n            new Booking{Group = \"Group1\", Type = BookingType.Online, Status = BookingStatus.New, Price = 100, Date = new DateTime(2012,06,02)},\n            new Booking{Group = \"Group1\", Type = BookingType.Online, Status = BookingStatus.New, Price = 200, Date = new DateTime(2012,06,03)},\n\n            new Booking{Group = \"Group2\", Type = BookingType.Phone, Status = BookingStatus.Accepted, Price = 80, Date = new DateTime(2012,06,10)},\n            new Booking{Group = \"Group2\", Type = BookingType.Phone, Status = BookingStatus.Accepted, Price = 110, Date = new DateTime(2012,06,12)},\n\n            new Booking{Group = \"Group3\", Type = BookingType.Store, Status = BookingStatus.Accepted, Price = 225, Date = new DateTime(2012,06,20)},\n\n            new Booking{Group = \"Group3\", Type = BookingType.Store, Status = BookingStatus.Invoiced, Price = 300, Date = new DateTime(2012,06,21)},\n            new Booking{Group = \"Group3\", Type = BookingType.Store, Status = BookingStatus.Invoiced, Price = 140, Date = new DateTime(2012,06,22)},\n        };\n</code></pre>\n\n<p>That would result in the following lines on the final printout:</p>\n\n<pre><code>                                        Week 22     Week 23     Week 24     Week 25     Week 26\n                                        May28-Jun3  Jun4-10     Jun11-17    Jun18-24    Jun25-Jul1\n            Group   Type    Status      Cnt. Price  Cnt. Price  Cnt. Price  Cnt. Price  Cnt. Price\n            ----------------------------------------------------------------------------------------------\n            Group1  Online  New         3   450     0   0       0   0       0   0       0   0\n            Group2  Phone   Accepted    0   0       1   80      1   110     0   0       0   0\n            Group3  Store   Accepted    0   0       0   0       0   0       1   225     0   0       \n            Group3  Store   Invoiced    0   0       0   0       0   0       2   440     0   0           \n</code></pre>\n\n<p>I have created 2 additional classes to represent a line with the possibility to include any number of weeks:</p>\n\n<pre><code> public class GroupedLine\n{\n    public string Group { get; set; }\n    public BookingType Type { get; set; }\n    public BookingStatus Status { get; set; }\n    public List&lt;WeeklyStat&gt; WeeklyStats { get; set; } \n}\n\npublic class WeeklyStat\n{\n    public DateTime WeekStart { get; set; }\n    public decimal Sum { get; set; }\n    public int Count { get; set; }\n}\n</code></pre>\n\n<p>If I have the following time period:</p>\n\n<pre><code>        var DateFrom = new DateTime(2012, 05, 28);\n        var DateTo = new DateTime(2012, 7, 01);\n</code></pre>\n\n<p>Firstly, I need to identify what weeks are necessary in the statistics: in this case week 22-26. </p>\n\n<p>For that I have the following code: </p>\n\n<pre><code>        var DateFrom = new DateTime(2012, 05, 28);\n        var DateTo = new DateTime(2012, 7, 01);\n\n        var firstWeek = GetFirstDateOfWeek(DateFrom, DayOfWeek.Monday);\n        IList&lt;DateTime&gt; weeks = new List&lt;DateTime&gt; { firstWeek };\n\n        while(weeks.OrderByDescending(w =&gt; w).FirstOrDefault().AddDays(7) &lt;= DateTo)\n        {\n            weeks.Add(weeks.OrderByDescending(w =&gt; w).FirstOrDefault().AddDays(7));\n        }\n</code></pre>\n\n<p>And now, I'd need some LINQ magic to do the grouping both by the 4 properties and the aggregation (count of bookings and sum of prices) for the weeks.</p>\n\n<p>I can attach code sample of the LINQ I got so far tomorrow, as I don't have access to it now.\nSorry for the long post, hope it's clear what I mean.</p>\n\n<p>Edit: 2012-11-07\nI have to modify the question a bit, so that the grouped weeks only include those weeks, that actually have data. \nUpdated example output:</p>\n\n<pre><code>                                        May28-Jun3  Jun4-10     Jun18-24    \n            Group   Type    Status      Cnt. Price  Cnt. Price  Cnt. Price  \n            ---------------------------------------------------------------\n            Group1  Online  New         3   450     0   0       0   0       \n            Group2  Phone   Accepted    0   0       1   80      0   0       \n            Group3  Store   Accepted    0   0       0   0       1   225             \n            Group3  Store   Invoiced    0   0       0   0       2   440         \n</code></pre>\n\n<p>In this case there were no Bookings in period Jun 11-17 and Jun25-Jul1 so they are omitted from the results.</p>\n"},{"tags":["c#",".net"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13265833,"title":"How to move from directory to directory?","body":"<p>I am using <code>Directory.GetCurrentDirectory()</code> function. After I get current directory path I need to move two directories up and to get the path of this derictory to the path variable.</p>\n\n<p>Any idea how I can do that?</p>\n"},{"tags":["c#","wpf","growl"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":1268,"score":3,"question_id":4643272,"title":"What \"growl\" type notification windows are available for WPF (windows that appear and fade after X seconds)?","body":"<p>I wanted to know if there are any good \"growl\" type notification windows available as open source or guided tutorials for WPF applications.  I'm looking for a window that can appear when users save for example, notifying them that the save was successful and then disappears after X seconds (with a fade out) without the user needing to take the explicit action to close the notification window.  This way for messages/notifications that require no confirmation, like the example, the user would not have to click \"OK\" to make the messagebox or dialog close.</p>\n"},{"tags":["c#","multithreading"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13268673,"title":"C# threading, thread not persistant","body":"<p>Morning all,</p>\n\n<p>Using C# .NET 4.0 and Visual Studio 2012 Express.</p>\n\n<p>I have a program that runs some SQL stored procedures, then opens and Access database and auto generates the reports then emails them.</p>\n\n<p>I have it set on a date so it runs as soon as midnight comes.</p>\n\n<p>The following is a code sample.</p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n{\n    Thread myUltiThread = new Thread(GetCurrentDate);\n    myUltiThread.Start();\n}\n\nprivate void GetCurrentDate()\n{\n    string myDate = \"\";\n    myDate = DateTime.Today.Day.ToString();\n\n    if(myDate == \"7\" &amp;&amp; myDateToggle == false)\n    {\n        Task t = new Task(() =&gt; RunMonthBackUp());\n        t.Start();\n    }\n\n    if (myDate == \"8\" &amp;&amp; myDateToggle == true)\n    {\n        myDateToggle = false;\n    }\n}\n</code></pre>\n\n<p>So as you can see once the button is pressed my program then starts the thread, which uses the getdate method, this method checks if the date is correct.</p>\n\n<p>if it is then it starts a task that runs the whole process.</p>\n\n<p>My problem is that this is not happening, I believe its because the method is only running once. I have a feeling this is due to my lack of understanding working with threads (only ever deal with tasks usually).</p>\n\n<p>Could someone point out to me where I am going wrong and how to get this set up properly?</p>\n\n<p>Many thanks guys</p>\n"},{"tags":["c#","thread-safety","volatile"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":29,"score":3,"question_id":13269563,"title":"How to make Utility Methods for Thread","body":"<p>I want to make a re-usable piece of code that Threads can call to sleep until a certain time has been reached or they are told to cancel. The Cancel variable would be a volatile Boolean on the object that has the Thread.</p>\n\n<p>My approach was this:</p>\n\n<pre><code>public class ThreadUtil\n{\n    public static void SleepTillOrDone(DateTime till, ref bool done)\n    {\n        while ((!done) &amp;&amp; (DateTime.Now &lt; till))\n        {\n            var diff = till - DateTime.Now;\n            Thread.Sleep(diff.TotalMilliseconds &gt;= 100 ? 100 : 10);\n        }\n    }\n}\n</code></pre>\n\n<p>However, this gives a warning of \"a reference to a volatile field will not be treated as volatile\". After reading around a bit I understand what the warning means, but how would one write such a method that would be safe to use without the volatile keyword? Or is there a different &amp; completely better approach?</p>\n"},{"tags":["c#","exception","visual-studio-2012"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13269215,"title":"Is there a way I can send a stack trace to the console in C# with VS2012","body":"<p>I have C# code that's giving an exception. I have the code within a try - catch and I can see the exception but I am having a problem viewing it in VS2012. Is there a way I can send a stack trace to the console so I can look without having to right click on properties of the exception? </p>\n\n<p>Even better does anyone have any code they use to log out more detailed information to the console?</p>\n"},{"tags":["c#",".net","code-contracts"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":162,"score":4,"question_id":9316847,"title":"Using Code Contracts to specify a return value may be null","body":"<p>Is there a way of explicitly specifying that a return value <em>can</em> be null using Code Contracts?</p>\n\n<p>My worry is that methods without a <code>Contract.Ensures(Contract.Result&lt;object&gt;() != null)</code> may be incorrectly 'fixed' in the future to include the post-condition, even though the original intention may have been to allow null results.</p>\n"},{"tags":["c#","sql","xml","nodelist","xmlnodelist"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13269221,"title":"Reading XML file via XML nodes","body":"<p>I have this XML document I am trying to read in and insert into a data base. There will only ever be one GamePlay node however GamePlayStep may repeat so I have created a node list for this. For some reason GamePlayStep isn't receiving data. Here is the XML file: </p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;GameData&gt;\n  &lt;GamePlay&gt;\n    &lt;type&gt;add&lt;/type&gt;\n    &lt;GamePlayID&gt;1&lt;/GamePlayID&gt;\n    &lt;ParticipantID&gt;1&lt;/ParticipantID&gt;\n    &lt;GameID&gt;1&lt;/GameID&gt;\n    &lt;GameDifficultyID&gt;1&lt;/GameDifficultyID&gt;\n    &lt;Start&gt;2012-08-06T12:19:33.154Z&lt;/Start&gt;\n    &lt;End&gt;2012-08-06T12:30:33.154Z&lt;/End&gt;\n    &lt;Success&gt;False&lt;/Success&gt;\n  &lt;/GamePlay&gt;\n  &lt;GamePlayStep&gt;\n    &lt;GamePlayStepID&gt;1&lt;/GamePlayStepID&gt;\n    &lt;Start&gt;2012-08-06T12:19:33.154Z&lt;/Start&gt;\n    &lt;End&gt;2012-08-06T12:30:33.154Z&lt;/End&gt;\n    &lt;SortOrder&gt;1&lt;/SortOrder&gt;\n    &lt;Score&gt;1&lt;/Score&gt;\n    &lt;hintUsed&gt;True&lt;/hintUsed&gt;\n    &lt;GamePause&gt;\n      &lt;GamePauseID&gt;1&lt;/GamePauseID&gt;\n      &lt;Start&gt;2012-08-06T12:19:33.154Z&lt;/Start&gt;\n      &lt;End&gt;2012-08-06T12:30:33.154Z&lt;/End&gt;\n      &lt;Order&gt;1&lt;/Order&gt;\n      &lt;Duration&gt;05:01&lt;/Duration&gt;\n    &lt;/GamePause&gt;\n  &lt;/GamePlayStep&gt;\n&lt;/GameData&gt;\n</code></pre>\n\n<p>Here is my code:</p>\n\n<pre><code>public static void start()\n        {\n            string[] filePaths = Directory.GetFiles(System.Configuration.ConfigurationManager.ConnectionStrings[\"filePath\"].ConnectionString);\n            List&lt;GamePlay&gt; gameObj = new List&lt;GamePlay&gt;();\n            List&lt;GamePlayStep&gt; gameStepObj = new List&lt;GamePlayStep&gt;();\n            foreach (string value in filePaths)\n            {\n                XmlDocument xd = new XmlDocument();\n                XmlNodeList GameSteps;\n                xd.Load(value);\n                XmlNode documentNode = xd.SelectSingleNode(\"/GameData/GamePlay\");\n                GameSteps = xd.SelectNodes(\"/GameData/GamePlay/GamePlayStep\");\n\n                GamePlay newGamePlay = new GamePlay();\n                newGamePlay.setType(Convert.ToString(documentNode.SelectSingleNode(\"type\").InnerText));\n                newGamePlay.setGamePlayID(Convert.ToInt32(documentNode.SelectSingleNode(\"GamePlayID\").InnerText));\n                newGamePlay.setParticipantID(Convert.ToInt32(documentNode.SelectSingleNode(\"ParticipantID\").InnerText));\n                newGamePlay.setGameDifficultyID(Convert.ToInt32(documentNode.SelectSingleNode(\"GameDifficultyID\").InnerText));\n                newGamePlay.setGameID(Convert.ToInt32(documentNode.SelectSingleNode(\"GameID\").InnerText));\n                newGamePlay.setStartDateTime(Convert.ToDateTime(documentNode.SelectSingleNode(\"Start\").InnerText));\n                newGamePlay.setEndDateTime(Convert.ToDateTime(documentNode.SelectSingleNode(\"End\").InnerText));\n                newGamePlay.setSuccess(Convert.ToBoolean(documentNode.SelectSingleNode(\"Success\").InnerText));\n                newGamePlay.setFile(value);\n                newGamePlay.addNewGamePlay();\n\n                foreach (XmlNode documentNode2 in GameSteps)\n                {\n\n                    GamePlayStep newGamePlayStep = new GamePlayStep();\n                    newGamePlayStep.setGamePlayStepID(Convert.ToInt32(documentNode2.SelectSingleNode(\"GamePlayStepID\").InnerText));\n                    newGamePlayStep.setGamePlayID(newGamePlay.getGamePlayID());\n                    newGamePlayStep.setStartDateTime(Convert.ToDateTime(documentNode2.SelectSingleNode(\"Start\").InnerText));\n                    newGamePlayStep.setEndDateTime(Convert.ToDateTime(documentNode2.SelectSingleNode(\"End\").InnerText));\n                    newGamePlayStep.setOrderPlayed(Convert.ToInt32(documentNode2.SelectSingleNode(\"SortOrder\").InnerText));\n                    newGamePlayStep.setScore(Convert.ToInt32(documentNode2.SelectSingleNode(\"Score\").InnerText));\n                    newGamePlayStep.setHintUsed(Convert.ToBoolean(documentNode2.SelectSingleNode(\"hintUsed\").InnerText));\n                    newGamePlayStep.addNewGamePlayStep();\n\n\n                }\n\n            }\n        }\n</code></pre>\n\n<p>The GamePlay is filling the variables properly and inserting into the database however the GamePlaySteps in the NodeList are not. Does anyone see the problem or how I can improve this?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","entity-framework","generics","types"],"answer_count":2,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":53,"score":5,"question_id":13269002,"title":"Getting List of Objects by a type given by a string","body":"<p>I get objects by</p>\n\n<pre><code>IEnumerable&lt;ObjectStateEntry&gt; om = context.ObjectStateManager.GetObjectStateEntries(System.Data.EntityState.Modified);        \n</code></pre>\n\n<p>How can I get a <code>List</code> of the objects with a type given by a string?</p>\n\n<pre><code>Type typ = Type.GetType(\"mytype\");\nvar om2 = om.Select(s =&gt; s.Entity).OfType&lt;typ&gt;(); // does not work\n</code></pre>\n"},{"tags":["c#","unit-testing","mocking","moq","stub"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":26,"score":2,"question_id":13267799,"title":"What to use mock parameter or instance parameter in test method?","body":"<p>What is the best practice to pass object parameter in the test method?\nWhat to use in this case?(Mocks, Stubs or create instance of object and fill it)</p>\n\n<p>For example:</p>\n\n<pre><code>[Test]\npublic void LoadContentsFor_ValidUser_ReturnsEmptyList()\n{\n    var user = new User {Id = 1, FirstName = \"Test\"};\n    var contents = this.contentPresentationService.LoadContentsFor(user);\n    Assert.IsTrue(contents.Count == 0);\n}\n</code></pre>\n\n<p>Or using mocks:</p>\n\n<pre><code>[Test]\npublic void LoadContentsFor_ValidUser_ReturnsEmptyList()\n{\n    var user = new Mock&lt;User&gt;();\n    user.Setup(x =&gt; x.Id).Returns(1);\n    user.Setup(x =&gt; x.FirstName).Returns(\"Test\");\n    var contents = this.contentPresentationService.LoadContentsFor(user.Object);\n    Assert.IsTrue(contents.Count == 0);\n}\n</code></pre>\n"},{"tags":["c#","asp.net-mvc-3","viewmodel","asp.net-mvc-viewmodel"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13252720,"title":"MVC 3 viewmodel properties","body":"<p>I have a question regarding organization of properties in viewModel. As far as I understand the viewmodel should be as simple as possible, and the main thing that it should do is bind data to view.</p>\n\n<p>The question is how to distinguish properties in viewmodel from BL model.\nI mean for example I have a BL model like : </p>\n\n<pre><code>   public class UserDetailsModel\n    { \n        public string UserName {get;set;}\n        public string SomeInfo{get;set;}\n        public string AnotherInfo{get;set;}\n        public string Anything{get;set;}\n        public string Something {get;set;}\n        ...\n\n     }\n</code></pre>\n\n<p>then I have another BL model say:</p>\n\n<pre><code> public class UserInfoModel\n        { \n            public string Info1{get;set;}\n            public string Info2{get;set;}\n            public string Info3{get;set;}\n            public string Info4{get;set;}\n            public string Info5 {get;set;}\n            ...\n\n         }\n</code></pre>\n\n<p>Now the question is what is the best practices to Create ViewModel that should have data of both BL models. </p>\n\n<p>1) Duplicate the properties from 2 models , and use Default Model binding to transfer data from view to controller , then create BL models from ViewModels and via repository update data ? In this case we have code duplication ... </p>\n\n<p>2) ViewModel should look something like: </p>\n\n<pre><code> public class UsersIdentificationViewModel \n        {\n            public UsersIdentificationViewModel()\n            {\n                UserInfoModel = new UserInfoModel();\n            }\n\n            public UserInfoModel UsersInfo { get; set; }\n\n            public UserDetailsModel UserDetails { get; set; }   \n\n        }\n</code></pre>\n\n<p>The default binding will not work in this case (Correct me if I am mistaking) and I should write custom Model binder or something like this... What approach is better for unit testing , or maybe there is another approach ?</p>\n"},{"tags":["c#","xml","for-loop","attributes","switch-statement"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":72,"score":-3,"question_id":13269637,"title":"how to use for loop instead of switch?","body":"<p>here is a code of xml attributes reader, I need to read the attributes through for loop or through something if there is anything convenient for representing the loop value of attributes to another script. Now it uses switch and i cant use it as public variable to pass the value for another script. Is there a way to do it properly? Please help me in this matter, any help would be appreciated. </p>\n\n<pre><code>using UnityEngine;\nusing System.IO;\nusing System.Xml;\nusing System.Text; \n\npublic class XMLStringReader : MonoBehaviour\n{\n public string attrVal;\n    XmlDocument root;\n\n    void Start ()\n    {\n\n XmlReader reader = new XmlTextReader(\"D://Dram/verer.xml\");\n\n         reader.MoveToContent();\n        if (reader.Name != null) \n        {\n            while (reader.Read()) \n            {\n                if(reader.NodeType == XmlNodeType.Element) \n                { \n                    // check if the element has any attributes\n                    if (reader.HasAttributes)\n                    {\n                        // move to the first attribute\n                        reader.MoveToFirstAttribute();\n\n                        for(int i = 0; i &lt; reader.AttributeCount; i++) \n                        { \n                            // read the current attribute\n                          reader.MoveToAttribute(i);\n\n\n\n                            switch (reader.Name) \n                            {                                \n                                case \"UIName\":\n                                print(\"UIName : \" + reader.Value);\n\n\n                                    break;\n                                default: // ignore\n                                    break;\n                            }\n\n                        } \n                        // move back to the element node that contains\n                        // the attributes we just traversed\n                        reader.MoveToElement();\n                    }\n                }\n            }\n        }\n\n    }\n\n}\n</code></pre>\n"},{"tags":["c#","asp.net",".net","ado.net"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":13268287,"title":"Transactions in .net using c#","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/224689/transactions-in-net\">Transactions in .net</a>  </p>\n</blockquote>\n\n\n\n<p>I just wanted to know about Transaction in .net using c# language. I have gone through different articles on the net. However, I came to know about transaction theoretically but I wanted to know the exact use of it in real time. For example when exactly should I use transactions in real time. Let's suppose, I am writing code where I am doing some action on the click event of a link. Lets say, I am hitting the SQL connection to get some values. Should I use transaction there? If I am writing simple code, where I fetch values without using sql connection, should I use transactions there? What are the pros and cons of using Transactions. Getting theoritical knowledge is different, but I want to know the exact use of it. When to use when not to use. Can transactions be used in simple code? Any responses or links for even basic stuff about transactions are welcome.</p>\n"},{"tags":["c#",".net","encryption"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1280,"score":1,"question_id":4756046,"title":"How secure is ProtectedData.Protect (DPAPI)?","body":"<p>Suppose someone gets access all of my hard disk, I guess the weak spot would be my windows password. Without knowing/being able to retrieve that, the data should be pretty much safe, shouldn't it?</p>\n\n<p>I'm asking specifically because of the <a href=\"http://en.wikipedia.org/wiki/Encrypting_File_System#Decrypting_files_using_the_local_Administrator_account\" rel=\"nofollow\">EFS entry</a> in wikipedia which states that</p>\n\n<blockquote>\n  <p>In Windows 2000, the local administrator is the default Data Recovery Agent, capable of decrypting all files encrypted with EFS by any local user.</p>\n</blockquote>\n\n<p>and EFS happens to use DPAPI. So does the same apply to my own data protected using this:</p>\n\n<pre><code>ProtectedData.Protect(plain, null, DataProtectionScope.CurrentUser);\n</code></pre>\n\n<p>And if that is indeed the case, how could I prevent it?</p>\n\n<p><strong>[Edit]</strong> N.B. I'm trying to store credentials for a winforms app so that the user does not have to enter their password every time they login. In other words, if someone is able to login as that user (i.e. know the user password), then they might as well be able read the encrypted data.</p>\n\n<p>Which - not coming from a windows background - now makes me wonder - can't the local admin login as any local user anyway? In that case I shouldn't be concerned about the admin being able to retrieve passwords anyway...</p>\n\n<p><strong>[Edit2]</strong> As google reveals, it looks like an Administrator <strong>cannot</strong> just login as any user without resetting/changing their password first. So my question still seems relevant...</p>\n"},{"tags":["c#",".net","static","webclient","void"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13268529,"title":"C# How to transfer reference void within main void","body":"<p>This is likely to be a(nother) noob question, but I'm not sure how to do this.</p>\n\n<p>I have piece of code within a private method which refers to a static method.</p>\n\n<pre><code>using (WebClient wc = new WebClient())\n{\n    wc.DownloadStringCompleted += new DownloadStringCompletedEventHandler(wc_DownloadStringCompleted);\n    wc.DownloadStringAsync(new Uri(requestUri));\n}\n</code></pre>\n\n<p>The static method it refers to:</p>\n\n<pre><code>static void wc_DownloadStringCompleted(object sender, DownloadStringCompletedEventArgs e)\n{\n\n    var xmlElm = XElement.Parse(e.Result);\n\n    var status = (from elm in xmlElm.Descendants()\n                  where elm.Name == \"status\"\n                  select elm).FirstOrDefault();\n    if (status.Value.ToLower() == \"ok\")\n    {\n        var res = (from elm in xmlElm.Descendants()\n                   where elm.Name == \"formatted_address\"\n                   select elm).FirstOrDefault();\n        formatted = res.Value;\n\n    }          \n}\n</code></pre>\n\n<p>Now I need the content of the static method to replace the content of the WebClient. \nLike:</p>\n\n<pre><code>using (WebClient wc = new WebClient())\n{\n    var xmlElm = XElement.Parse(e.Result);\n\n    var status = (from elm in xmlElm.Descendants()\n                  where elm.Name == \"status\"\n                  select elm).FirstOrDefault();\n    if (status.Value.ToLower() == \"ok\")\n    {\n        var res = (from elm in xmlElm.Descendants()\n                   where elm.Name == \"formatted_address\"\n                   select elm).FirstOrDefault();\n        formatted = res.Value;\n\n    }\n}\n</code></pre>\n\n<p>Since I'm not sure where \"e\" originates from, I do not know how to get it working.</p>\n"},{"tags":["c#","oracle","nhibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":31,"score":4,"question_id":13269126,"title":"C# & NHibernate \"Could not compile the mapping document\" on windows service","body":"<p>this is my first question on this page, so first of all sorry for any newbie mistakes and my bad english.</p>\n\n<p>I wouldn't be asking on a page like this if I didn't ran out of ideas on how to solve my problem, so I hope I get it to work with your help since it's my last chance.</p>\n\n<p>I created a program in C# using NHibernate to connect it to my Oracle database (wich is working perfectly), and now I've been told to create a similar program, but now in a Windows Service instead of a .exe.</p>\n\n<p>The problem is that I have all the settings done to make NHibernate work like in the .exe program, and if i debug the program it all works fine, but as soon as I install the service and run it, stops working.</p>\n\n<p>I'm not doing anyhing in the program, just testing the NHibernate connection.</p>\n\n<p>The exception:</p>\n\n<pre><code>Could not compile the mapping document: Mapping\\CSB_Mensaje.hbm.xml\nSystem.IO.DirectoryNotFoundException: No se puede encontrar una parte de la ruta de acceso 'C:\\Windows\\system32\\Mapping\\CSB_Mensaje.hbm.xml'.\n   en System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)\n   en System.IO.FileStream.Init(String path, FileMode mode, FileAccess access, Int32 rights, Boolean useRights, FileShare share, Int32 bufferSize, FileOptions options, SECURITY_ATTRIBUTES secAttrs, String msgPath, Boolean bFromProxy, Boolean useLongPath)\n   en System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize)\n   en System.Xml.XmlDownloadManager.GetStream(Uri uri, ICredentials credentials, IWebProxy proxy, RequestCachePolicy cachePolicy)\n   en System.Xml.XmlUrlResolver.GetEntity(Uri absoluteUri, String role, Type ofObjectToReturn)\n   en System.Xml.XmlTextReaderImpl.OpenUrlDelegate(Object xmlResolver)\n   en System.Threading.CompressedStack.runTryCode(Object userData)\n   en System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(TryCode code, CleanupCode backoutCode, Object userData)\n   en System.Threading.CompressedStack.Run(CompressedStack compressedStack, ContextCallback callback, Object state)\n   en System.Xml.XmlTextReaderImpl.OpenUrl()\n   en System.Xml.XmlTextReaderImpl.Read()\n   en System.Xml.XmlTextReader.Read()\n   en System.Xml.XmlCharCheckingReader.Read()\n   en System.Xml.XsdValidatingReader.Read()\n   en System.Xml.XmlLoader.Load(XmlDocument doc, XmlReader reader, Boolean preserveWhitespace)\n   en System.Xml.XmlDocument.Load(XmlReader reader)\n   en NHibernate.Cfg.Configuration.LoadMappingDocument(XmlReader hbmReader, String name)\n</code></pre>\n\n<p>The part of the exception on spanish, says it can't find a part of the access path.</p>\n\n<p>This exception is thrown while trying to execute this code:</p>\n\n<pre><code>private static void Init(String BBDD)\n    {\n        Configuration config = new Configuration();\n        config.Configure().SessionFactoryName(BBDD);\n        config.AddFile(\"Mapping\\\\CSB_Mensaje.hbm.xml\");\n        config.AddFile(\"Mapping\\\\CSB_Periodicidad.hbm.xml\");\n        config.AddFile(\"Mapping\\\\CSB_Plantilla.hbm.xml\");\n        config.AddFile(\"Mapping\\\\CSB_Subscripciones.hbm.xml\");\n        config.AddFile(\"Mapping\\\\CSB_Usuario.hbm.xml\");\n        config.AddFile(\"Mapping\\\\CSB_Login.hbm.xml\");\n        config.AddFile(\"Mapping\\\\CSB_Configuration.hbm.xml\");\n        _SessionFactory = config.BuildSessionFactory();\n    }\n</code></pre>\n\n<p>And this is my hibernate.cfg.xml file:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;hibernate-configuration xmlns=\"urn:nhibernate-configuration-2.2\"&gt;\n  &lt;session-factory name=\"Oracle\"&gt;\n    &lt;property name=\"connection.provider\"&gt;\n      NHibernate.Connection.DriverConnectionProvider\n    &lt;/property&gt;\n    &lt;property name=\"dialect\"&gt;\n      NHibernate.Dialect.Oracle10gDialect\n    &lt;/property&gt;\n    &lt;property name=\"connection.driver_class\"&gt;\n      NHibernate.Driver.OracleClientDriver\n    &lt;/property&gt;\n    &lt;property name=\"connection.connection_string\"&gt;\n      User Id=CSB;\n      Password=Hound2012;\n      Data Source=(DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (PROTOCOL = TCP)(HOST = 192.168.1.30)(PORT = 1521)))(CONNECT_DATA = (SID = HL)));\n    &lt;/property&gt;\n    &lt;property name=\"show_sql\"&gt;\n      true\n    &lt;/property&gt;\n  &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>Again, this is my first time asking something here, so I'm sorry for any mistake made. Any help would be greatly apreciated.</p>\n\n<p>Regards,\nKhor</p>\n"},{"tags":["c#","c++","security","windows-services","certificate"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13269574,"title":"Error : \"Impossible to find object or property\", when loading a private certificate in a Windows service running as LocalSystem","body":"<p>I am developing a Windows service middleware that uses security certificates to perform authentication when it wants to initialize a secure communication channel with remote applications.</p>\n\n<p>The Windows service is a .Net 3.5  application that uses (via a C++/CLI layer) the C++ WinCrypt library in order to load certificates. In particular I am calling the CertFindCertificateInStore method when i accessing the store to load the certificate. The CertFindCertificateInStore uses the “My” system store as store by default.</p>\n\n<p>I have registered my private certificate in the “My” system store either for the current user (the user logged onto the machine) either for the local machine, via the MMC console. Be sure that the certificate is good and it includes my private key.</p>\n\n<p>When i run the Windows service as current user (again the user logged onto the machine)  the certificate is correctly loaded,  instead the certificate is not loaded when i run the service as “LocalSystem”. The error  \"Impossible to find object or property\", is then raised when I call the CertFindCertificateInStore. I point up that the “My” store instead continues to be accessible.</p>\n\n<p>(NB: When I open a new session using a different user and I run the same Windows service as user for whom I registered the certificates, the certificate is again correctly loaded)</p>\n\n<p>Then I used either the MMC console either the winhttpcertcfg.exe system tool in order to verify that the “LocalSystem” user has the rights to access my certificate. Afterwards either the MMC console and the winhttpcertcfg.exe tool confirm that THEORETICALLY the user “LocalSystem” has the rights to access the certificate.</p>\n\n<p>Do you have any suggestion to help me to solve this problem?</p>\n\n<p>Thank you in advance for your help,</p>\n\n<p>PS: a similar question has been posted here <a href=\"http://stackoverflow.com/questions/3936065/certificates-cannot-find-the-certificate-and-private-key-for-decryption-error-w\">Certificates: Cannot find the certificate and private key for decryption Error when sign</a></p>\n"},{"tags":["c#",".net","winforms","usercontrols","flowlayoutpanel"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":26,"score":5,"question_id":13265635,"title":"insert Usercontrol in FlowLayoutPanel","body":"<p>I have a <code>FlowLayoutPanel</code> and several <code>UserControl</code>s. Now I want one controll to be always at the bottom of my <code>FlowLayoutPanel</code>. So I want to add my UserControl just above the lowest controll. Is there an easy way to insert user controls in a <code>FlowLayoutPanel</code>?</p>\n\n<p>I'm currently thinking about removing the control at the bottom, and adding the control I want to add and  add the bottom control again. But this I do not think this is really the best way. Is there anyone here who could help me with some information on how to do this ?</p>\n"},{"tags":["c#",".net","asp.net-mvc","razor"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":38,"score":2,"question_id":13268203,"title":"Can we do the DBContext in MVC3 with Razor?","body":"<p>Can I connect to the DB using <code>DBContext</code> in MVC3 by defining the <code>ConnectionString</code> in Web.config?</p>\n\n<p>If possible can anyone provide me some links too?</p>\n"},{"tags":["c#","linq","ienumerable"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13269183,"title":"Search between Two IEnumerable - LINQ","body":"<p>Hi can you guys help me with this, I have try several things.\nI need to search between two IEnumerables, here is the code.</p>\n\n<pre><code>IEnumerable&lt;Project&gt; Projects = new[] { new Project {id = \"1\", lan = \"test1\"},  new Project {id = \"2\", lan = \"test1\"}}\n\nIEnumerable&lt;string&gt; lan = new [] { \"test1\", \"test2\"};\nIEnumerable&lt;string&gt; indexFiltered = ?;\n</code></pre>\n\n<p>I need to do a linq query that return the Project.id thats have any Project.lan in lan.</p>\n\n<p>Any idea?</p>\n"},{"tags":["c#","sql","winforms","telerik"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13182654,"title":"From DataTable to DataGridView including image path","body":"<p>I am building a small application. This application stores customer information and customer pictures.\nHere I have a problem where I want to show data from datatable to datagridview with pictures. My application does not store the image in a database, but stored in a folder. </p>\n\n<p>So in my database just store image path. But not full path, only the name of the folder or file. I use combine path on each name. It is easier to manage folders if the root directory has been changed compared to if I keep the full path.</p>\n\n<p>For example, if I want to display the image in picture box, I'll do this.</p>\n\n<pre><code>//consider the record has been selected from table\n\nclassDirectory cd = new classDirectory();\n\n// it will check current directory combine application name folder and branch name folder.\n\nstring branchFolderPath = cd.getBranchFolderPath(branchName); \n\nstring branchPanelPath = cd.getPanelFolderPath(branchFolderPath,panelName);\n\nstring customerPath = cd.getCustomerFolderPath(branchPanelPath,customerID + \" - \" + customerName);\n\nstring customerImage = path.Combine(customerPath,customerPicPath);\n\npicCustomer.Image = new Bitmap(customerImage);\n</code></pre>\n\n<p>After combine, it will return string <strong>\"C:\\Users\\My Name\\Documents\\My Application Name\\Branch Name\\Panel Name\\1235 - HIDAYAH\\Pictures\\HIDAYAH - Picture.jpg\"</strong></p>\n\n<p>So I can see the pictures.</p>\n\n<p>But, I do not know how to display the data in grid view.</p>\n\n<p>So only so far I've just made.</p>\n\n<pre><code>Customer.classDataBinding cdb = new Customer.classDataBinding();\n\nDataTable dataCustomer = cdb._listOfCustomer();\n\ndgvCustomer.DataSource = dataCustomer;\n\nthis.dgvCustomer.Columns[\"Customer Image\"].Width = 120; //For a while, this code return the string only.\nthis.dgvCustomer.Columns[\"Customer ID\"].Width = 120;\nthis.dgvCustomer.Columns[\"Name\"].Width = 120;\nthis.dgvCustomer.Columns[\"Branch\"].Width = 120;\nthis.dgvCustomer.Columns[\"Panel\"].Width = 120;\n</code></pre>\n\n<p>Code in <strong>cdb._listOfCustomer()</strong></p>\n\n<pre><code>  public DataTable _listOfCustomer()\n    {\n        cs.testConnection();\n\n        DataTable dtCustomer = new DataTable();\n\n        using (SqlConnection conn = new SqlConnection(cs.connString))\n        {\n            string query = \"SELECT tbl_customer.customerPicPath as [Customer Image], tbl_customer.customerID as [Customer ID],tbl_customer.customerName as Name, tbl_branch.branchName as Branch, tbl_panel.panelName as Panel FROM (tbl_branch INNER JOIN tbl_panel ON tbl_branch.branchID = tbl_panel.branchID) INNER JOIN tbl_customer ON tbl_panel.panelID = tbl_customer.panelID;\";\n\n            using (SqlDataAdapter adap = new SqlDataAdapter(query, conn))\n            {\n                adap.Fill(dtCustomer);\n\n            }\n        }\n\n        return dtCustomer;\n</code></pre>\n\n<p>Any suggestion? Hope someone can help me to resolve this problem. Thanks a lot!</p>\n"},{"tags":["c#","string"],"answer_count":11,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":77,"score":-1,"question_id":13263452,"title":"How to remove characters in a string?","body":"<p>How to remove the some characters in a string ..</p>\n\n<pre><code>string s=\"testpage\\information.xml\"\n</code></pre>\n\n<p>I need only information.xml how to do that?</p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13268564,"title":"Winform datagridview not refreshing","body":"<p>I've created a datagridview from the tools and chosed the datasource from db. By using dataset of a table I am displaying data in the datagridview. But When I add new data to the database my gridview still looks the same its not refreshing with the new data :( kindly assist. Thanks in advance</p>\n"},{"tags":["c#","xaml","windows-8","winrt","winrt-xaml"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":1,"view_count":2551,"score":1,"question_id":10359197,"title":"Windows 8 GridView - disabling item tap visualization","body":"<p>Is it possible to remove the tap effect on an item inside a gridview?</p>\n"},{"tags":["c#","xml","xslt","xhtml","doctype"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13268073,"title":"How to add DOCTYPE to HTML using XSLT and C#","body":"<p>I am using XSLT in conjunction with C# to transform my xml document into HTML. I need the DOCTYPE to be in the HTML document. But somehow I can't seem to get it to appear. Please help...</p>\n\n<p>My xsl includes the following.</p>\n\n<pre><code>    &lt;?xml version=\"1.0\"?&gt;\n    &lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n    &lt;xsl:output method=\"xml\" encoding=\"utf-8\" doctype-public=\"-//W3C//DTD XHTML 1.0 Strict//EN\" doctype-system=\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\" indent=\"yes\"/&gt;\n</code></pre>\n\n<p>My C# code looks like this :</p>\n\n<pre><code>            try\n            {\n                XPathDocument myXPathDoc = new XPathDocument(myPath);\n\n                XslTransform myXslTrans = new XslTransform();\n\n                myXslTrans.Load(ConfigurationManager.AppSettings[\"XsltFilePath\"] == null ? \"MyTransform.xsl\" : ConfigurationManager.AppSettings[\"XsltFilePath\"]);\n\n                String htmlFile = Path.Combine(myFolder, myName, \"index.html\");\n\n                XmlTextWriter myWriter = new XmlTextWriter(htmlFile, null);\n\n                myXslTrans.Transform(myXPathDoc, null, myWriter);\n\n                myWriter.Close();\n            }\n            catch (Exception e)\n            {\n                System.Console.WriteLine(e.Message + \"\\n\" + e.StackTrace);\n            }\n</code></pre>\n\n<p>Any ideas what I am doing wrong? I am using .NET 4.0. Thanks in advance.</p>\n"},{"tags":["c#","vb.net","string"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13262629,"title":"remove spaces and empty line in the end of a string vb.net","body":"<p>in vb.net i have a string that looks like this</p>\n\n<pre><code>\"text text text                           \n                             \"\n</code></pre>\n\n<p>so in the end of it there are spaces and a new empty line</p>\n\n<p>How can make this look like </p>\n\n<pre><code>\"text text text\"\n</code></pre>\n"},{"tags":["c#",".net","delegates","event-handling","event-bubbling"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13268251,"title":"How to bubble an event up multiple levels?","body":"<p>I'm struggling to bubble an event correctly.</p>\n\n<p>I have a master page with a user control, and a page that is a child of the master page.</p>\n\n<p>The user control and the page share common data, so when the user control updates, it updates the apage and vice versa.</p>\n\n<p>The user control exposed an event to the master page. This is the format I use.</p>\n\n<p>outside of class:</p>\n\n<pre><code>public delegate void OfferBookmarkRemoved(int OfferID);\n</code></pre>\n\n<p>inside class:</p>\n\n<pre><code>public event OfferBookmarkRemoved OfferBookmarkRemoved;\n\nprotected void LV_Bookmarks_ItemCommand(object source, ListViewCommandEventArgs e)\n{\n    if (e.CommandName == \"RemoveOffer\")\n    {\n        var offerId = (int)e.CommandArgument;\n\n        OnOfferBookmarkRemoved(offerId);\n    }\n\n}\n\nvoid OnOfferBookmarkRemoved(int offerId)\n{\n    offerId.ThrowDefault(\"offerId\");\n\n    if (OfferBookmarkRemoved != null)\n    {\n        OfferBookmarkRemoved(offerId);\n    }\n}\n</code></pre>\n\n<p>Now this can be used in the master page ok. I don't do anything in the master page and want to expose the event so that the aspx page can use it, like this:</p>\n\n<pre><code>Master.OfferBookmarkRemoved += OnBookmarkRemoved;\n\nvoid OnBookmarkRemoved(int offerId)\n{\n    offerId.ThrowDefault(\"offerId\");\n\n    OfferList1.UpdateBookmark(offerId);\n}\n</code></pre>\n\n<p>So the missing bit is to listen for the event in the master and make it available to the page.</p>\n\n<p>Can anyone help?</p>\n"},{"tags":["c#",".net","xml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13268851,"title":"Merge missing XML records based on Empty XML example","body":"<p>I have an XML template file and a previously saved XML database record:</p>\n\n<ul>\n<li>XML file - contains all the current fields I want for an object - This may change over time with items added</li>\n<li>XML database record - this is the saved XML.  It may be different from the XML in point one because the \"template\" xml may have been updated to contain more fields, etc.</li>\n</ul>\n\n<p>An example will clear this up..</p>\n\n<p>I have a \"template\" xml that looks like this:</p>\n\n<pre>\n&lt;dvd displayText=\"\"&gt;\n  &lt;field id=\"txtTitle\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"100\" label=\"DVD Title\" /&gt;\n  &lt;field id=\"txtDescription\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"50\" label=\"Your Description\" /&gt;\n&lt;/dvd&gt;\n</pre>\n\n<p>This tells the UI to collect a Title and Description when creating a new record.  This works perfectly.</p>\n\n<p>So when I create a new DVD record it will display these 2 fields to the user and collect the \"Title\" and \"Description\" values and save the value into an XML field in a SQL Server table.</p>\n\n<p>But what I want to do now is add a new \"field\" definition to the template xml.  I've done this.. for the purposes of this example, lets have a \"PurchasedDate\" field definition added to the template XML.</p>\n\n<pre>\n&lt;dvd displayText=\"\"&gt;\n  &lt;field id=\"txtTitle\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"100\" label=\"DVD Title\" /&gt;\n  &lt;field id=\"txtDescription\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"50\" label=\"Your Description\" /&gt;\n  &lt;field id=\"txtPurchaseDate\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"50\" label=\"Purchase Date\" /&gt;\n&lt;/dvd&gt;\n\n</pre>\n\n<p>If I'm creating a new DVD record, I get prompted for the 3 values; Title, Description, Purchased Date, because that's whats in the template XML..  But if I'm recalling a previously saved DVD record, it doesn't have the new \"Purchased Date\" field in the XML..</p>\n\n<pre>\n&lt;dvd displayText=\"My DVD\"&gt;\n  &lt;field id=\"txtTitle\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"100\" label=\"DVD Title\"&gt;My Movie DVD&lt;/field&gt;\n  &lt;field id=\"txtDescription\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"50\" label=\"Your Description\"&gt;This movie is awesome&lt;/field&gt;\n&lt;/dvd&gt;\n</pre>\n\n<p>So what I want to do is take the XML saved in the database (shown above), compare or merge any missing \"field\" definitions from the template XML file.. and end up with this below:</p>\n\n<pre>\n&lt;dvd displayText=\"My DVD\"&gt;\n  &lt;field id=\"txtTitle\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"100\" label=\"DVD Title\"&gt;My Movie DVD&lt;/field&gt;\n  &lt;field id=\"txtDescription\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"50\" label=\"Your Description\"&gt;This movie is awesome&lt;/field&gt;\n  &lt;field id=\"txtPurchaseDate\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"50\" label=\"Purchase Date\" /&gt;\n&lt;/dvd&gt;\n</pre>\n\n<p>I'm using Linq to get the value from the existing record from the database if one exists.\nand I'm currently doing a XmlDocument.LoadXml(xmlstring) or XmlDocument.Load(filename) depending on whether its new or existing record.</p>\n\n<p>I'd then like to take the XmlDocument and merge the template into this to produce the above XML output for displaying on screen.</p>\n\n<p>If there is a better way than using XmlDocuments, can you please let me know..  I'll happily go and research it and then use it..</p>\n\n<p>I'm using C#...</p>\n\n<p>Many thanks..</p>\n"},{"tags":["c#","entity-framework","entity-framework-4","ef-code-first"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13268665,"title":"Modify Many-to-Many table Created By EF5 Code First","body":"<p>I have 2 classes and the one is a collection property of the other like below.</p>\n\n<pre><code>public class NotificationMessage\n{\n    public int ID { get; set; }\n    public string Message { get; set; }\n    public virtual ICollection&lt;Device&gt; Devices { get; set; }\n}\n\npublic class Device\n{\n    public int ID  { get; set; }\n    public string Token  { get; set; }\n    public virtual ICollection&lt;NotificationMessage&gt; NotificationMessages { get; set; }\n}\n\npublic class NotificationMessageDevice\n{\n    [Column(Order = 0), Key, ForeignKey(\"NotificationMessage\")]\n    public int NotificationMessageID { get; set; }\n\n    [Column(Order = 1), Key, ForeignKey(\"Device\")]\n    public int DeviceID { get; set; }\n\n\n    public virtual Device Device { get; set; }\n    public virtual NotificationMessage NotificationMessage { get; set; }\n}\n</code></pre>\n\n<p>When you create a relationship like above, the entity flamework is enough clever to create many to many relationship on Database by creating NotificationMessageDevices.</p>\n\n<p>The problem rises in here. Now I want to add CreateDate to the table 'NotificationMessageDevices' . What I have done is that I have created a new class called 'NotificationMessageDevice' in the way entity framework would create the table \"NotificationMessageDevices\" in existing database. I added new properties and called Update-Verbose. The very first exception was about missing ID property it wanted me to add public int ID {get;set;} however when I add this up it realizes the ID property is index property so that I need to remove all the data in that table. </p>\n\n<p>What is the workaround of this case on Entity Framework without data loss :) </p>\n"},{"tags":["c#","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":79,"score":2,"question_id":13257709,"title":"Comparing collections and counting duplicates using LINQ and C#","body":"<p>I have two similar objects in my system.</p>\n\n<ul>\n<li>LeadImportViewModel</li>\n<li>LeadGridViewModel</li>\n</ul>\n\n<p>I need to populate the <code>QtyDuplicates</code> field in my <code>LeadImportViewModel</code> collection, which should show the quantity of corresponding records in the LeadGridViewModel collection where the  <code>CompanyNameStripped</code> value is identical.</p>\n\n<pre><code>public class LeadImportViewModel\n{\n    public int Id { get; set; }\n    public string CompanyName { get; set; }\n    public string CompanyNameStripped { get; set; }\n    public int QtyDuplicates{ get; set; }\n}\n\npublic class LeadGridViewModel\n{\n    public int LeadId { get; set; }\n    public string CompanyName { get; set; }\n    public string CompanyNameStripped { get; set; }\n}\n</code></pre>\n\n<p>The collection is created as follows:</p>\n\n<pre><code>var coll = (from t1 in db.Leads_Staging\n                    select new LeadImportViewModel\n                        {\n                            Id = t1.Id,\n                            CompanyName = t1.CompanyName,\n                            CompanyNameStripped = t1.CompanyNameStripped,\n\n                        });\n</code></pre>\n\n<p>What would be the most efficient way to do this using LINQ/C#?</p>\n"},{"tags":["c#","c#-4.0"],"answer_count":5,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13256892,"title":"Return an object","body":"<p>I'm suddenly stuck. I defined an object:</p>\n\n<pre><code>public class AddResult\n{\n   public AddResult(string id, bool success)\n   {\n      this.ID = id;\n      this.Success = success;\n   }\n\n   public string ID { get; set; } \n   public bool Success { get; set; } \n   public string ErrorMessage { get; set; } \n}\n</code></pre>\n\n<p>I want to return this object in another method.</p>\n\n<pre><code>public AddResult Load(string userName, string password)\n{\n    // validate\n    if(userName = \"\")\n      {\n           AddResult.ErrorMessage = \"wrong\";\n           AddResult.ID = \"\";\n      }\n    // want to return object AddResult\n }\n</code></pre>\n\n<p>The intellisense is not working for AddResult.ID etc, I know something is wrong but need your advice.</p>\n"},{"tags":["c#","design","interface","patterns","oo"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13269222,"title":"C# Interface too rigid","body":"<p>I'm working with some legacy code and have this existing interface:</p>\n\n<pre><code>public interface IProcess\n{\n    IDTO Process(IDTO request);\n}\n</code></pre>\n\n<p>There is then a factory with a huge switch statement returning objects (17 of them) that implement the interface.  The created objects then call process like:</p>\n\n<pre><code>return xProcess.Process(requestDTO);\n</code></pre>\n\n<p>My problem is that I now need to change a few of these to pass in a second parameter like:</p>\n\n<pre><code>xProcess.Process(requestDTO, Id);\n</code></pre>\n\n<p>I'm looking for an elegant way to achieve this.</p>\n\n<p>I have tried making the interface an abstract class like:</p>\n\n<pre><code>public abstract class IProcess\n{\n\n    public virtual IDTO Process(IDTO request)\n    {\n       return null;\n    }\n\n    public virtual IDTO Process(IDTO request, int Id)\n    {\n        return null;\n    }\n}\n</code></pre>\n\n<p>This allows me to override the Process method in the created classes but I have a problem that IProcess is inherited by another interface, which is now obviously broken.</p>\n\n<p>The legacy platform is huge and the test coverage is not great so I'm looking for a nice elegant solution with the minimum impact to the rest of the code base.  Perhaps, there is a pattern I'm overlooking?</p>\n\n<p>Can anyone help please?  (examples would be great)</p>\n\n<p>Thanks</p>\n\n<p>David</p>\n"},{"tags":["c#","asp.net","table","dynamic"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3043,"score":0,"question_id":4689611,"title":"Populating dynamic table in asp.net?","body":"<p>I would really appriciate your help on this. This is my problem:</p>\n\n<p>I have a ArrayList of product objects. Each product has a id, name and a supplier.\nWhen i iterate the arraylist and creates a table to put  this valus into cells i come to the problem that a product can have more than one supplier. If this is the case the id and name are the same but with a different supplier in the arraylist.\nMy code so far takes care of this by creating emtyp cells for id and name and put the other supplier in a new cell. </p>\n\n<p>But, i doesn't look good to create new rows for every supplier. What i want is that if a product has more than one supplier i want all the suppliers in the same cell on the row for the product id.</p>\n\n<pre><code>string id = string.Empty;\nint count = 0;\npublic void CreateResultTable(ArrayList result)\n{\n    TableRow row;\n    TableCell cell;\n\n    if (result != null &amp;&amp; result.Count &gt; 0)\n    {\n        foreach (Item item in result)\n        {\n\n            if (count == 0)\n            {\n                row = new TableRow();\n                id = item.id;\n\n                cell = new TableCell();\n                cell.Text = item.id;\n                row.Cells.Add(cell);\n\n                cell = new TableCell();\n                cell.Text = item.product;\n                row.Cells.Add(cell);\n\n                cell = new TableCell();\n\n                ArrayList levList = item.suppliers;\n                if (levList != null)\n                {\n\n                    string lev = string.Empty;\n                    for (int i = 0; i &lt; levList.Count; i++)\n                    {\n                        lev += levList[i];\n                    }\n                    cell.Text = lev;\n                    row.Cells.Add(cell);\n\n                }\n                else\n                    cell.Text = string.Empty;\n                    row.Cells.Add(cell);\n\n                count++;\n            }\n            else if (id != item.id)\n            {\n\n                row = new TableRow();\n                id = item.id;\n\n                cell = new TableCell();\n                cell.Text = item.id;\n                row.Cells.Add(cell);\n\n                cell = new TableCell();\n                cell.Text = item.product;\n                row.Cells.Add(cell);\n\n                cell = new TableCell();\n\n                ArrayList levList = item.suppliers;\n                if (levList != null)\n                {\n\n                    string lev = string.Empty;\n                    for (int i = 0; i &lt; levList.Count; i++)\n                    {\n                        lev += levList[i];\n                    }\n                    cell.Text = lev;\n\n                }\n                else\n                    cell.Text = string.Empty;\n                row.Cells.Add(cell);\n\n\n            }\n            else\n            {\n                row = new TableRow();\n                cell = new TableCell();\n                cell.Text = string.Empty;\n                row.Cells.Add(cell);\n\n                cell = new TableCell();\n                cell.Text = string.Empty;\n                row.Cells.Add(cell);\n\n                cell = new TableCell();\n                ArrayList levList = item.suppliers;\n                if (levList != null)\n                {\n                    string lev = string.Empty;\n                    for (int i = 0; i &lt; levList.Count; i++)\n                    {\n                        lev += levList[i];\n                    }\n                    cell.Text = lev;\n                    row.Cells.Add(cell);\n                }\n                else\n                    cell.Text = string.Empty;\n                row.Cells.Add(cell);\n            }\n\n            SearchResultLev.Rows.Add(row);\n\n\n\n        }\n\n\n        SearchResultLev.Visible = true;\n        SearchResult.Visible = false;\n        NoSearchResult.Visible = false;\n    }\n\n    else\n    {\n        SearchResultLev.Visible = false;\n        SearchResult.Visible = false;\n        NoSearchResult.Visible = true;\n    }\n\n}\n</code></pre>\n"},{"tags":["c#","image"],"answer_count":4,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":1372,"score":6,"question_id":3643750,"title":".NET Image Libraries","body":"<p>What are some good image libraries for C#? Mainly for things such as painting in layers. Or maybe a resource that can describe similar tasks?</p>\n"},{"tags":["c#","xaml","animation","storyboard"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13252023,"title":"BeginTime not working correctly when set programmatically in WinRT / c#","body":"<p>I'm animating something in my Windows 8 app from code behind. I have a collection of animation objects, each containing a <code>DoubleAnimation</code>. I call a method which iterates over this collection, creates new <code>Storyboard</code> objects for each one and begins them. Regardless of whether I set <code>BeginTime</code> on the storyboard,  <code>DoubleAnimation</code> or both, they all start and run at the same time. </p>\n\n<p>How do I delay an animation by a set number of milliseconds? </p>\n\n<pre><code>  foreach (AnimationObject a in queue)\n  {\n      Storyboard sb = new Storyboard();\n      sb.Duration = a.DoubleAnimation.Duration;\n      sb.BeginTime = a.DoubleAnimation.BeginTime;\n      sb.Children.Add(a.DoubleAnimation);\n      Storyboard.SetTarget(a.DoubleAnimation, a.Target);\n      Storyboard.SetTargetProperty(a.animation, a.TargetProperty);\n      sb.Begin();\n  }\n</code></pre>\n\n<p>I wrote a queue instead which uses <code>await Task.Delay(a.BeginTime)</code> and this works, so I know I'm setting BeginTime correctly. However the Task Delay approach doesn't seem very efficient</p>\n"},{"tags":["c#","asp.net-mvc-3","entity-framework","stored-procedures"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":160,"score":4,"question_id":12707682,"title":"How to map a stored procedure using DBContext in ASP.NET MVC 3 Entity Framework","body":"<p>I do mapping here for tables.. How to map stored procedures here?</p>\n\n<pre><code>public class AppDBContext : DbContext\n{\n    public DbSet&lt;UserAccount&gt; UserAccount { get; set; }\n    public DbSet&lt;GetUserAccounts&gt; GetGetUserAccounts { get; set; }\n\n    protected override void OnModelCreating(DbModelBuilder modelBuilder)\n    {\n        modelBuilder.Entity&lt;UserAccount&gt;().ToTable(\"UserAccount\");\n        modelBuilder.Entity&lt;Customer&gt;().ToTable(\"Customer\");\n\n        base.OnModelCreating(modelBuilder);\n    }\n}\n</code></pre>\n"},{"tags":["c#","httpwebresponse"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13267979,"title":"HTTPWebResponse using application/x-www-form-urlencoded","body":"<p>So I sent an HTTPWebRequest using application/x-www-form-urlencoded as my content type. I assume that this means the reponse will be returned in a similar type? (EDIT: Have now been told this isn't the case)</p>\n\n<p>My question is this. How do I access the different key/value pairs returned in the response. My code so far looks like this. I can of course read the string but surely there is a better way to access the data other than ripping the string apart. </p>\n\n<pre><code>    HttpWebResponse response = SendPOSTRequest(\"https://site/page?Service=foo\", content.ToString(), \"\", \"\", true);\n\n    string responseCode = response.StatusCode.ToString();\n    string responseStatusDescription = response.StatusDescription;\n\n    StreamReader sr = new StreamReader(response.GetResponseStream());\n\n    string result = sr.ReadToEnd();\n</code></pre>\n\n<p>I tried using XML/linq to read the elements into an XDocument but of course it is not being returned in XML form.</p>\n\n<p>Assume I have 3 or 4 different pieces of information in there how could I read them out? </p>\n\n<p>EDIT: I have just checked and the data is being returned as text/plain. How can this be processed easily?</p>\n\n<p>EDIT: The response string once retrieved via a streamreader is:</p>\n\n<pre><code>VPSProtocol=2.23\nStatus=OK\nStatusDetail=Server transaction registered successfully.\nVPSTxId={FDC93F3D-FC64-400D-875F-0B7E855AD81F}\nSecurityKey=*****\nNextURL=https://foo.com/PaymentPage.asp?TransactionID={875F-0B7E855AD81F}\n</code></pre>\n\n<p>EDIT: It seems this piece of code gets me part way there. I am able to break the response up into a List and address it line by line. It still isnt a perfect solution though. </p>\n\n<pre><code>            StreamReader sr = new StreamReader(response.GetResponseStream());\n\n            List&lt;string&gt; str = new List&lt;string&gt;;\n\n            while (sr.Peek() &gt;= 0)\n            {\n                str.Add(sr.ReadLine().ToString());\n            }\n</code></pre>\n"},{"tags":["c#",".net","wpf","xaml"],"answer_count":7,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":731,"score":2,"question_id":7093861,"title":"Filter items of a ListBox based on the text of a TextBox using only XAML in WPF","body":"<p>I currently have a ListBox binded to a collection of items. As the collection is big we want to filter the items being shown based on the text entered on a TextBox. </p>\n\n<p>What I'm asking is if this is possible to implement using only XAML, I don't want to modify the collection of items, I would like to modify the Visibility of each of the items based on the filter.</p>\n\n<p>Hope its clear,</p>\n\n<p>thanks!</p>\n"},{"tags":["c#","winforms","listbox","calling"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13268664,"title":"Sending information to listbox from a class to a Form","body":"<p>I am trying to send information to a listbox to a Form from a class. Sounds simple enough. However it just won't show anything after the method has run.</p>\n\n<p>This is my Class and Method 'Testclass' that is being called from form one</p>\n\n<pre><code>    public void testclass()\n    {\n        Form1 m = new Form1();\n        int tostng = \"36183464\";\n        m.listBox1.Items.Add(tostng).ToString();\n    }\n</code></pre>\n\n<p>in Form1 I have a listbox which has had it's modifiers set to \"Public\" so not errors pop up. It will run but nothing will be entered into the listbox. This code works when everything is all in Form1. </p>\n\n<p>Thank you for looking.</p>\n"},{"tags":["c#",".net","svn","version-control","project-management"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":56,"score":3,"question_id":13268532,"title":"Share a file for C# project at home and at office","body":"<p>I have formed a number of source code files as my library. For example, I wrote <em>LinqExtension.cs</em> providing <em>Median()</em> function.</p>\n\n<p>Now I'm working on a project which needs LinqExtension.cs. As usually, I link the file to the project. As introduced <a href=\"http://greenicicleblog.com/2010/12/01/link-whole-directories-into-visual-studio-projects/\" rel=\"nofollow\">here</a>. The reason that I link files rather than copying them is to keep the files at a single location. If I modify a file, all dependent projects get affected. </p>\n\n<p>I also add the project to Subversion and upload to and download from Google Code. The linked file is not under version control.</p>\n\n<p>I work on the project at home as well as at office. I hate copying the linked file to my office, which makes the file not single. </p>\n\n<p>I figure out a solution that add <code>&lt;Compile Include=\"http://www.example.com/LinqExtension.cs\"/&gt;</code> to csproj file so that the file only exists on the Internet. Once I upload a new verison of the file, all dependent projects get affected.  Unfortunately the solution doesn't work.</p>\n\n<p>Any other suggesions or better practice?</p>\n"},{"tags":["c#","xaml","windows-8"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13158310,"title":"Rotating an analog dial toward the mouse/pointer in Windows 8 / XAML","body":"<p>I've implemented an Analog dial in Windows 8 XAML, and it almost works </p>\n\n<p>However, when turning the dial it shakes like crazy. it seems to rotate almost 90 degrees clockwise and anticlockwise while being moved. I've implemented it using <code>PointerPressed</code>, <code>PointerReleased</code> and <code>PointerMoved</code></p>\n\n<p>My Code</p>\n\n<pre><code>private void dial_PointerPressed(object sender, PointerRoutedEventArgs e)\n{\n    dialPressed = true;    \n}\n\nprivate void dial_PointerReleased(object sender, PointerRoutedEventArgs e)\n{\n    dialPressed = false;\n}\n\nprivate void dial_PointerMoved(object sender, PointerRoutedEventArgs e)\n{\n    if(dialPressed)\n    {\n        Windows.UI.Input.PointerPoint currentLocation = \n              e.GetCurrentPoint(dial); \n\n        Point dialCenter = \n              new Point(dial.ActualHeight / 2, dial.ActualWidth / 2);\n\n        double radians = Math.Atan(\n              (currentLocation.Position.Y - dialCenter.Y) / \n              (currentLocation.Position.X - dialCenter.X));\n\n        RotateTransform r = new RotateTransform();\n        r.Angle = radians * 180 / Math.PI;\n\n        if (currentLocation.Position.X - dialCenter.X &lt; 0)\n        {\n            r.Angle += 180;\n        }\n\n        TransformGroup t = new TransformGroup();\n        t.Children.Add(r);\n        dial.RenderTransform = t;\n\n    }\n}\n</code></pre>\n\n<p>Should I be binding against different events? What's making my dial shaky? </p>\n"},{"tags":["c#","windows-8","microsoft-metro"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":151,"score":2,"question_id":12649247,"title":"HttpClient.GetAsync fails in background task with lock screen access and both TimeTrigger or MaintenanceTrigger","body":"<p>Client.GetAsync appears to fail for me when running in a background task in my Windows 8 Metro app. </p>\n\n<p>I tried using both a TimeTrigger and a MaintenanceTrigger. It appears that there is no exception. When debugging it, it just exits at that line (if I keep pressing step over), even though there is way more to execute as well as a try-catch around it.</p>\n\n<p>This leads me to believe that Windows is cancelling my task. So I listened to the cancelled event with no luck.</p>\n\n<p>I have declared Internet access as a capability, and the task has been properly registered. Furthermore, my app has full lock screen access.</p>\n\n<p>What am I doing wrong?</p>\n\n<p>Here's the code I use to register the background task currently.</p>\n\n<pre><code>if (await ObtainLockScreenAccess())\n{\n    const string name = \"Task\";\n\n    var updaterTasks = BackgroundTaskRegistration.AllTasks.Where(t =&gt; t.Value.Name == name);\n    if (!updaterTasks.Any())\n    {\n\n        var builder = new BackgroundTaskBuilder();\n        builder.Name = name;\n        builder.TaskEntryPoint = \"Stackstabilizer.BackgroundTasks.UpdateBackgroundTask\";\n\n        var trigger = new MaintenanceTrigger(15, false);\n        var condition = new SystemCondition(SystemConditionType.InternetAvailable);\n\n        builder.AddCondition(condition);\n        builder.SetTrigger(trigger);\n\n        var task = builder.Register();\n\n        Debug.WriteLine(\"Task has been registered\");\n\n    }\n}\n</code></pre>\n\n<p><strong>Edit</strong> Here's the background task signature:</p>\n\n<pre><code>namespace Stackstabilizer.BackgroundTasks\n{\n    // You must use a sealed class, and make sure the output is a WINMD. \n    public sealed class UpdateBackgroundTask : IBackgroundTask\n    {\n        public async void Run(IBackgroundTaskInstance taskInstance)\n        {\n\n            var deferral = taskInstance.GetDeferral();\n\n            try { ... } finally { deferral.Complete(); }\n\n        }\n     }\n\n}\n</code></pre>\n\n<p>And here's some details on my declarations.</p>\n\n<p><img src=\"http://i.stack.imgur.com/x6u6E.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","process"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":582,"score":2,"question_id":6857019,"title":"How to start Process hidden?","body":"<p>I start a Console Application via ProcessStartInfo and process.Start(). I want to hide the black window.  Here's my code:</p>\n\n<pre><code>string output = \"\";\n            //Setup the Process with the ProcessStartInfo class\n            ProcessStartInfo startInfo = new ProcessStartInfo();\n            startInfo.FileName = \"C:\\\\WINNT\\\\system32\\\\cmd.exe\";\n            startInfo.UseShellExecute = false;\n\n            startInfo.RedirectStandardOutput = true;\n\n            //Start the process\n           Process proc = Process.Start(startInfo);\n</code></pre>\n"},{"tags":["c#",".net","asynchronous","exception-handling","async-await"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":72,"score":2,"question_id":13267029,"title":"How do I catch in C# an exception from an asynchronous method that is awaited?","body":"<p>I'm basically wondering how I should, in C#, catch exceptions from asynchronous methods that are waited on through the <code>await</code> keyword. Consider for example the following small console program, which most importantly contains a method called <code>AwaitSync</code>. <code>AwaitSync</code> calls <code>TestAsync</code>, which returns a Task that when executed throws an exception. I try to catch the exception in <code>AwaitAsync</code>, <em>but it goes unhandled</em>.</p>\n\n<pre><code>class Program\n{\n    static void Main(string[] args)\n    {\n        AwaitAsync();\n        Console.ReadKey();\n    }\n\n    static async Task AwaitAsync()\n    {\n        try\n        {\n            await TestAsync();\n        }\n        catch (Exception)\n        {\n            Console.WriteLine(\"Exception caught\");\n        }\n    }\n\n    static Task TestAsync()\n    {\n        return Task.Factory.StartNew(() =&gt; { throw new Exception(\"Test\"); });\n    }\n}\n</code></pre>\n\n<p>How am I supposed to go about catching the exception from the Task returned by <code>TestAsync</code>? While this example is a console program, my real life problem is within the context of of ASP.NET MVC / Web API.</p>\n\n<p><strong>EDIT:</strong>\nTurns out the exception is getting caught, for technical reasons I just didn't notice the 'Exception caught' message before the terminal closed. In any case, Jon Skeet's answer was very valuable to my understanding of <code>await</code> and exception handling.</p>\n"},{"tags":["c#","search","google","results"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1614,"score":1,"question_id":6538847,"title":"google search result html code c#","body":"<p>I have to create an app which will -- for a given term -- download links of first 10 results from the google search page, however there is a problem,</p>\n\n<p>If I download the source code with the webClient, instead of html-- I get JS code. </p>\n\n<p>I get same result if I take a look at source code in Google chrome (ctrl+u) BUT if I try to inspect that element with built in developer tools I can see real html code</p>\n\n<p>Anyone know how can I download real html code so I can extract links?</p>\n"},{"tags":["c#","asp.net-mvc","unit-testing","nunit","moq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":207,"score":0,"question_id":10401409,"title":"using moq to populate httpcontext.request","body":"<p>I am using the <a href=\"http://www.hanselman.com/blog/ASPNETMVCSessionAtMix08TDDAndMvcMockHelpers.aspx\" rel=\"nofollow\">hanselman tutorial</a> to use Moq to create unit tests for methods that take httpcontext as input parameter. </p>\n\n<pre><code>public static class MvcMockHelpers\n{\n\n    public static HttpContextBase FakeHttpContext()\n    {\n        var context = new Mock&lt;HttpContextBase&gt;();\n        var request = new Mock&lt;HttpRequestBase&gt;();\n        var response = new Mock&lt;HttpResponseBase&gt;();\n        var session = new Mock&lt;HttpSessionStateBase&gt;();\n        var server = new Mock&lt;HttpServerUtilityBase&gt;();\n\n        context.Setup(ctx =&gt; ctx.Request).Returns(request.Object);\n        context.Setup(ctx =&gt; ctx.Response).Returns(response.Object);\n        context.Setup(ctx =&gt; ctx.Session).Returns(session.Object);\n        context.Setup(ctx =&gt; ctx.Server).Returns(server.Object);\n\n        return context.Object;\n    }\n\n    public static HttpContextBase FakeHttpContext(string url)\n    {\n        var context = FakeHttpContext();\n        context.Request.SetupRequestUrl(url);  &lt;---- error here\n        return context;\n    } \n\n\n\n}\n</code></pre>\n\n<p>I am getting the following error on <strong>context.Request.SetupRequestUrl(url);</strong></p>\n\n<p><em>Error  1   'System.Web.HttpRequestBase' does not contain a definition for 'SetupRequestUrl' and no extension method 'SetupRequestUrl' accepting a first argument of type 'System.Web.HttpRequestBase' could be found (are you missing a using directive or an assembly reference?)</em></p>\n\n<p>Please help. </p>\n\n<p>I am trying to find a very simple easy to follow tutorial on setting up httpcontext request object and pass into method with context input parameter and be able to create unit test but all the examples in google either do not work or are complicated. please help.</p>\n"},{"tags":["c#","list","ellipse"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13260056,"title":"How to ensure you clicked on an ellipse object from a list?","body":"<p>I have a list with ellipse objects with the parameters (Point Begin, Point End, Color c). Now I want to ensure when I click somewhere if I did hit an ellipse. </p>\n\n<p>I also do this with rectangles which already works and looks something like this:</p>\n\n<pre><code> case 3: // Rectanglefill\n        return p.X &gt;= Begin.X &amp;&amp; p.X &lt;= End.X &amp;&amp; p.Y &gt;= Begin.Y &amp;&amp; p.Y &lt;= End.Y;\n</code></pre>\n\n<p>In this method I only want to return the bool True if I have a hit and False if the mouse click didn't hit something. </p>\n\n<p>Now for the ellipse I already have this:</p>\n\n<pre><code>case 4: // Ellipsfill\n/*  int radiusx = Math.Abs(End.X - Begin.X) / 2;\n    int radiusy = Math.Abs(End.Y - Begin.Y) / 2;\n    int midpointx = (Begin.X + End.X) / 2;\n    int midpointy = (Begin.Y + End.Y) / 2;\n\nreturn ((Math.Pow((p.X -midpointx) / radiusx, 2) + Math.Pow((p.Y - midpointy) / radiusy, 2)) &gt; 1);\n</code></pre>\n\n<p>But this doesn't work.</p>\n"},{"tags":["c#",".net","hl7","object-model"],"answer_count":5,"favorite_count":10,"up_vote_count":12,"down_vote_count":0,"view_count":6196,"score":12,"question_id":777933,"title":"HL7 object model for .NET","body":"<p>Searching for a library or framework that would provide an object model, parsing, validating, etc</p>\n\n<p>The idea would be to be able to spin up a new object of type hl7 v2 or v3. Then perhaps call it message type ORU_R01 or ADT, or ORM.</p>\n\n<p>Wouldn't life be great if we were able to do something like this:</p>\n\n<pre><code>HL7V2 myMessage = new HL7V2();\nmyMessage.Type = V2MsgTypes.ORU_R01;\nmyMessage.TryParse(someHL7_string);\n\nif (myMessage.IsValid)\n{\n  //do some work\n  //maybe access the PID segment\n  if (myMessage.Patient.Names.FamilyName ==\"Johnson\")\n  {\n    //do more work\n  }\n}\n</code></pre>\n"},{"tags":["c#","mysql","escaping"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13268907,"title":"Using literal underscore character in a MySQL query from c#","body":"<p>From my ASP.NET application I want to issue this query to MySQL</p>\n\n<pre><code>SELECT * FROM responses WHERE field_id LIKE '3\\_%'\n</code></pre>\n\n<p>In other words I am looking for records where the second character is the underscore literal character.</p>\n\n<p>The code generated by the model designer looks like this:</p>\n\n<pre><code>    public virtual RiskAnalysis.responsesDataTable GetResponseGroupForAnalysis(int raid, string fieldid) {\n    this.Adapter.SelectCommand = this.CommandCollection[2];\n    this.Adapter.SelectCommand.Parameters[0].Value = ((int)(raid));\n    if ((fieldid == null)) {\n        throw new global::System.ArgumentNullException(\"fieldid\");\n    }\n    else {\n        this.Adapter.SelectCommand.Parameters[1].Value = ((string)(fieldid));\n    }\n    RiskAnalysis.responsesDataTable dataTable = new RiskAnalysis.responsesDataTable();\n    this.Adapter.Fill(dataTable);\n    return dataTable;\n}\n</code></pre>\n\n<p>If I call this function like so:</p>\n\n<pre><code>string filter_string = @\"3\\_%\";    \nResponsesAdapter.GetResponseGroupForAnalysis(10, filter_string);\n</code></pre>\n\n<p>the MySQL log reports the query to look like this:</p>\n\n<pre><code>SELECT     *\nFROM         responses\nWHERE     (ra_id = 10) AND (field_id LIKE '3\\\\_%')\n</code></pre>\n\n<p>In other words the I know I'm missing something blindingly obvious here, but how do I place MySQL's escape backslash in the query without C# (un)helpfully escaping it?</p>\n"},{"tags":["c#","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":2154,"score":5,"question_id":4794355,"title":"WPF 4: Grow/Shrink TextBlock (Font Size) based on available space","body":"<p>I've seen this question asked a lot, however, to the opposite of what I'm looking for.  While other people want a control to size itself based on the size of text, I'm trying to figure out is if there is a way to grow the size of text to the amount of space available.</p>\n\n<p>Take the idea of a digital clock window and you want the numbers stating the time to grow (or shrink) based on the size of the window the clock is in.  If there isn't a way to automatically do this any pointers to a programmatic way I can get this accomplished?</p>\n\n<p>Thanks in advanced.</p>\n"},{"tags":["c#","android","mono"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13267476,"title":"Cannot show waiting message while long operation is running in Mono for Android","body":"<p>I'm trying to show a waiting message via a Toast while a long operation is running. I'm using a BackgroundWorker.\nThis code is inside a ListView_ItemClick event handler:</p>\n\n<pre><code>var bgWait = new BackgroundWorker();\nbgWait.DoWork += bgWait_DoWork;\nbgWait.RunWorkerAsync();\nbgWait.RunWorkerCompleted += bgWait_Completed;\n</code></pre>\n\n<p>The code in bgWait_DoWork event handler is the following:</p>\n\n<pre><code>private void bgWait_DoWork(object sender, DoWorkEventArgs e)\n{\nvar toastWait = Toast.MakeText(this, \"Please wait\", ToastLength.Long);\ntoastWait.SetGravity(GravityFlags.Top &amp; GravityFlags.Center, 0, 0);\ntoastWait.Show();\nTimeConsumingOperation();\ntoastWait.Cancel();\n}\n</code></pre>\n\n<p>When I run in debug mode, it seems that only the first line from bgWait_DoWork is reached - \"var toastWait = Toast.MakeText(this, \"Please wait\", ToastLength.Long);\" - and then it jumps to bgWait_Completed event handler.</p>\n\n<p>Any idea why this is happening?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","parsing","flags"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13268604,"title":"C# Flags parsing","body":"<p>I have wrote enum:</p>\n\n<pre><code>[Flags]\npublic enum BundleOS {\n    Win32 = 0,\n    Win64 = 1,\n    Mac = 2\n}\n</code></pre>\n\n<p>I need parse it from string, and write to string. Sample of string: <code>\"Win32|Win64\"</code>. \nNext code returns invalid result:</p>\n\n<pre><code>BundleOS os;\nBoolean result = TryParse&lt;BundleOS&gt;(\"Win32|Win64\", out os);\n</code></pre>\n\n<p>In <code>result</code> variable I got the <code>false</code> value. But I need <code>true</code>, and <code>os</code> value must to have the <code>BundleOS.Win32|BundleOS.Win64</code> value.</p>\n\n<hr>\n\n<p>If I do such operation:</p>\n\n<pre><code>String x = (BundleOS.Win32|BundleOS.Win64).ToString();\n</code></pre>\n\n<p>I need get such value: <code>\"Win32|Win64\"</code>, but I get <code>\"Win64\"</code>.</p>\n\n<p>Is exists a simple solution of these problems?</p>\n"},{"tags":["c#","asp.net","events"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13268068,"title":"How to fire an event when dropdown inside Repeater changes","body":"<p>I want to do some actions in my database when user change dropdown's selectedIndex.Now I have the following.</p>\n\n<pre><code>&lt;td class=\"shop-item-qty\"&gt;\n&lt;asp:DropDownList ID=\"qtyDropDownList\" OnSelectedIndexChanged=\"changeCount\" AutoPostBack=\"true\"  runat=\"server\"/&gt;\n&lt;asp:HiddenField ID=\"ItemId\" runat=\"server\" Value='&lt;%#Eval(\"GiftVoucher.ID\") %&gt;'/&gt;\n&lt;/td&gt;\n</code></pre>\n\n<p>All I want is to get my hidden fields value in <code>changeCount</code> method. The problem is that I can't directly get hidden fields value, because this code is in <code>Repeater</code> element. How can I achieve that functionality?</p>\n"},{"tags":["c#","mschart"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13268682,"title":"MS Chart, add triangles to an existing chart at specific points","body":"<p>Im wondering if its possible to add colored triangles (pointing up or down) at specific points (x,y) on an existing chart, such that they will update their positions if the chart is scrolled/zoomed.</p>\n\n<p>Ive had a google around but havent stumbled across anything which seems to meet those requirements.</p>\n\n<p>Any pointers would be appreciated.</p>\n"},{"tags":["c#","asp.net","checkbox","repeater"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":13262955,"title":"Repeater control checkbox event not fired","body":"<p>Am having three check box in repeater control. I need the concept like radio button list.When i click the first row first checkbox, other two are checked property is set to false. suppose i check the second one means first and third are unchecked. </p>\n\n<p><strong>My Design code is here :</strong></p>\n\n<pre><code>      &lt;asp:Repeater ID=\"repeaterItems\" runat=\"server\" \n                                                                    onitemdatabound=\"repeaterItems_ItemDataBound\" &gt;\n    &lt;ItemTemplate&gt;\n       &lt;table id=\"mytable\" cellspacing=\"0\" width=\"100%\" align=\"center\"&gt;\n          &lt;tr&gt;\n               &lt;td style=\"width: 18px;\"&gt;\n               &lt;asp:Label ID=\"id\" runat=\"server\" Text='&lt;%#Bind(\"fld_id\")%&gt;'&gt;&lt;/asp:Label&gt;\n               &lt;/td&gt;\n               &lt;td style=\"width: 301px;\"&gt;\n              &lt;asp:Label ID=\"Label1\" runat=\"server\" Text='&lt;%#Bind(\"fld_Question\")%&gt;'&gt;&lt;/asp:Label&gt;\n               &lt;/td&gt;\n               &lt;td style=\"width: 10px;\"&gt;   \n                    &lt;asp:CheckBox ID=\"CheckBox1\" runat=\"server\" AutoPostBack=\"true\" OnCheckedChanged=\"CheckBox1_CheckedChanged\" /&gt;\n               &lt;/td&gt;\n               &lt;td style=\"width: 30px;\"&gt;\n                     &lt;asp:CheckBox ID=\"CheckBox2\" runat=\"server\" AutoPostBack=\"true\" OnCheckedChanged=\"CheckBox2_CheckedChanged\"/&gt;\n               &lt;/td&gt;\n               &lt;td style=\"width: 33px;\"&gt;\n                     &lt;asp:CheckBox ID=\"CheckBox3\" runat=\"server\" AutoPostBack=\"true\" OnCheckedChanged=\"CheckBox3_CheckedChanged\"/&gt;\n               &lt;/td&gt;\n             &lt;/tr&gt;\n           &lt;/table&gt;\n        &lt;/ItemTemplate&gt;\n     &lt;/asp:Repeater&gt;\n</code></pre>\n\n<p><strong>code is :</strong> </p>\n\n<pre><code>protected void CheckBox1_CheckedChanged(object sender, EventArgs e)\n    {\n        CheckBox chk1 = sender as CheckBox;\n        RepeaterItem item = chk1.Parent as RepeaterItem;\n        CheckBox chk2 = item.FindControl(\"CheckBox2\") as CheckBox;\n        chk2.Checked = false;\n    }\n\n    protected void CheckBox2_CheckedChanged(object sender, EventArgs e)\n    {\n\n    }\n\n    protected void CheckBox3_CheckedChanged(object sender, EventArgs e)\n    {\n\n    }\n\n    protected void repeaterItems_ItemCreated1(object sender, RepeaterItemEventArgs e)\n    {\n        RepeaterItem ri = (RepeaterItem)e.Item;\n\n        if (ri.ItemType == ListItemType.Item || ri.ItemType == ListItemType.AlternatingItem)\n        {\n            CheckBox chk = (CheckBox)e.Item.FindControl(\"CheckBox1\");\n            chk.CheckedChanged += new EventHandler(CheckBox1_CheckedChanged);\n        }\n    }\n</code></pre>\n\n<p>CheckBox1_CheckedChanged event not fire. Please help me to fix this error.\nI spent more time to solve this issue but i can't.. </p>\n"},{"tags":["c#",".net","oop","hl7"],"answer_count":4,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":3360,"score":5,"question_id":1999159,"title":"dotnet HL7 integration library","body":"<p>I have a medical health database that a 3rd party needs to connect to.</p>\n\n<p>We need to look at using the HL7 standards.</p>\n\n<p>I am looking for a good library to make using HL7 easier in a dotnet enviroment.</p>\n\n<p>I will need a comprehensive 2.x and 3.x lib that can do most of the heavy lifting.</p>\n\n<p>I want to try and avoid using message parsing and would rather use an object model as much as possible.</p>\n\n<p>I have seen <a href=\"http://nhapi.sourceforge.net/\">http://nhapi.sourceforge.net/</a> but this only seems to go to v2.x and not 3.x.</p>\n\n<p>Has any one used this library adn what was your feelings about this? was it useful adn productive?</p>\n\n<p>Any suggestions are welcome.</p>\n\n<p>Opensource or comercial are both good.</p>\n\n<p>thanks</p>\n"},{"tags":["c#","ado.net",".net-1.1"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13268444,"title":"Get Distinct values of a column in a DataTable","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1199176/how-to-select-distinct-values-from-datatable\">How to select distinct values from datatable?</a>  </p>\n</blockquote>\n\n\n\n<p>I have a datatable with multiple Columns.I want to store a column's distinct values and store it in ArrayList.How to get distinct values?</p>\n\n<p>I am using .net 1.1</p>\n"},{"tags":["c#",".net","winforms","validation","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13262097,"title":"Validate cell's value on a custom datagridviewCell","body":"<p>I have a <code>DataGridView</code> with a custom <code>DataGridViewColumn</code>. The column is hosting a third-party component. I enter edit mode in the cell and modify its value and then I press enter key to validate the value. The problem is that I have to press enter key twice to validate the value. It seems like first enter key is to validate the value in the third-party's editor hosted in the cell, and second one to validate the <code>DataGridView</code>'s cell... So how to validate cell's value with only pressing enter key one time? </p>\n\n<p>Also I have seen strange behaviour, for example, the last <code>DataGridView</code>'s row does not behaves as the rest of the <code>DataGridView</code>'s cells. For last row, if I edit the value of a cell and then press enter key to validate, after validating value, it always remains in the same cell and in edit mode and cell's value gets selected so user can think that cell value is invalid when in fact it isn't. This does not happen with the rest of the rows. They need to press enter key twice to validate and cells do not remain in edit mode after validating.</p>\n"},{"tags":["c#","asp.net-mvc-3","razor"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13267914,"title":"mvc3 Razor foreach loop issues","body":"<p>Hi I have the following code but the if statement within the loop causes the statement to fail, any ideas please?</p>\n\n<pre><code>@{ var count = 1; }\n@foreach (var siteIcon in Model.SiteIconsList)\n{\n    &lt;div class=\"span2\"&gt;\n        &lt;a onclick=\"updateIcon(@siteIcon.ImageId)\" href='#'&gt;\n            &lt;img class=\"iconImage\" src=\"data:Image;base64,@(Html.Raw(Convert.ToBase64String(siteIcon.ImageData)))\" alt=\"\" /&gt;\n        &lt;/a&gt;\n    &lt;/div&gt;\n    if(count==5){\n        &lt;/div&gt;\n         &lt;div class=\"row-fluid\"&gt;\n         count=1;\n    }\n}\n</code></pre>\n"},{"tags":["c#","settings","project"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13266953,"title":"Define my own environment variables in C# project settings","body":"<p>I want to define my own environment variables which are used in the project settings, like $(TARGETPATH) and some predefined variables do.</p>\n\n<p>How can I do this in C#?</p>\n"},{"tags":["c#","pdu","string-decoding"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":21,"score":-2,"question_id":13268026,"title":"Decoding into USSD 7 bit","body":"<p>can anyone decode this into 7 bit USSD code..and tell me exactly how you did it ??</p>\n\n<p>AA986c3602</p>\n\n<p>For eg encoding *600*1# becomes 2A1B0CA68A8D1A</p>\n\n<p>Thanks in advance </p>\n"},{"tags":["c#",".net","visual-studio","ms-word","rtf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13266926,"title":"Print an RTF containing headers and footers on a server","body":"<p>I have been looking for a way of printing an RTF file containing headers and footers to a named printer from a server, and would appreciate any pointers in where I should look next.</p>\n\n<p>I have looked at a couple of ways of handling this:</p>\n\n<p>First I looked into using a ShellExecute \"PrintTo\" call, which works exactly how I want it as long as either Word or OpenOffice is installed to correctly 'render' the RTF. However, the limitation of needing to install either of these applications is undesirable.</p>\n\n<p>The other option I have looked into is using a RichEditBox to load the RTF into and print from there, but header and footer information is then ignored.</p>\n\n<p>Is it possible to open an RTF file on the server, in the same format as it would be opened in Word, using just .net?</p>\n"},{"tags":["c#","arrays","params"],"answer_count":4,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":54,"score":5,"question_id":13268151,"title":"C#: Convert array to use in params with additional parameters","body":"<p>I have a method that takes params. Inside the method another variable shall be added to the output:</p>\n\n<pre><code>private void ParamsTest(params object[] objs)\n{\n  var foo = \"hello\";\n  // Invalid: Interpretes objs as single array parameter:\n  Console.WriteLine(\"{0}, {1}, {2}\", foo, objs);\n}\n</code></pre>\n\n<p>When I call</p>\n\n<pre><code>ParamsTest(\"Hi\", \"Ho\");\n</code></pre>\n\n<p>I would like to see the output.</p>\n\n<pre><code>hello Hi Ho\n</code></pre>\n\n<p>What do I need to do? </p>\n\n<p>I can copy <code>foo</code> and <code>objs</code> into a new array and pass that array to <code>WriteLine</code> but is there a more elegant way to force <code>objs</code> to behave as params again? Kind of <code>objs.ToParams()</code>?</p>\n"},{"tags":["c#","sql-server","entity-framework","extended-properties"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13268446,"title":"Get Extended Property in edmx modeling Db","body":"<p>I have a database modelling by Entity Framework. I need to read the extended properties of each table through the object context associated to my Db. How can i do?</p>\n\n<p>Thank's in advance</p>\n"},{"tags":["c#","html","regex"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13267937,"title":"Regex c# html spider","body":"<p>I'm trying to have my console application return me all of these values in a html webpage:\n<code>&lt;img border=\"0\" alt=\"img.jpg\" title=\"img.jpg\" src=\"/_layouts/images/icjpg.gif\" /&gt;</code></p>\n\n<p>However I'm only interested in the <code>title=\"img.jpg\"</code>.\nI've seen that Regular expressions can be used to filter these, however I don't see how I filter the rest away and only keep <code>title=\"img.jpg\"</code> or the value in the <code>title=\"THIS\"</code></p>\n\n<p>Any help would be appreciated. </p>\n\n<p>I've seen this <a href=\"http://www.mikesdotnetting.com/Article/46/CSharp-Regular-Expressions-Cheat-Sheet\" rel=\"nofollow\">cheatlist for regex</a></p>\n"},{"tags":["c#","matrix"],"answer_count":4,"favorite_count":7,"up_vote_count":19,"down_vote_count":0,"view_count":11295,"score":19,"question_id":2336701,"title":"Recommendation for C# Matrix Library","body":"<p>I need a C# library to deal with matrices. It should implement singular value decomposition, matrix inversion, etc</p>\n\n<p>I've used <a href=\"http://www.codeproject.com/Articles/19032/C-Matrix-Library\" rel=\"nofollow\">CSML</a> before, but this does not implement some of the features i need. </p>\n\n<p>Some of the features are:<br>\nSingular value decomposition<br>\nMatrix inversion<br>\nTrace<br>\nDeterminants  </p>\n\n<p><strong>Suggested Libraries (from answers)</strong></p>\n\n<p>(most of them implement the features stated above)</p>\n\n<ul>\n<li><a href=\"http://numerics.mathdotnet.com/\" rel=\"nofollow\">Math .NET Numerics for .NET, Silverlight and Mono</a> (opensource)</li>\n<li><a href=\"http://www.extremeoptimization.com/\" rel=\"nofollow\">Extreme Optimization Numerical Libraries</a> (commercial, very\ncomplete)</li>\n<li><a href=\"http://ilnumerics.net/%24Home.html\" rel=\"nofollow\">IL Numerics</a> (commercial)</li>\n<li><a href=\"https://rtmath.net/products/finmath/\" rel=\"nofollow\">Deltix's FinMath numerical library</a> (commercial,  uses the Intel®\nMath Kernel Library (MKL) and Intel® Integrated Performance\nPrimitives (IPP))</li>\n<li><a href=\"http://blog.ivank.net/lightweight-matrix-class-in-c-strassen-algorithm-lu-decomposition.html\" rel=\"nofollow\">Lightweight fast matrix class in C#</a> (Strassen algorithm, LU\ndecomposition)</li>\n</ul>\n"},{"tags":["c#",".net","winforms","buttonclick","axwindowsmediaplayer"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13268219,"title":"Accessing windows media player component on a form from another form","body":"<p>I'm making a C# application in which I have 2 forms: Form1 &amp; Form2. Form1 contains a windows media player COM component(axwindowsmediaplayer1), which I'm using to play songs on button click. \nNow, I want to invoke axwindowsmediaplayer1  from button click on Form2. I tried to make a static function(so that I can use it as Form1.function_name), but it gives error since axwindowsmediaplayer1 isn't static. </p>\n\n<p>How I can do this ? Please help. </p>\n"},{"tags":["c#","windows-phone-7","windows-phone-7.1","isolatedstorage"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13268246,"title":"Value does not fall within the expected range, IsolatedStorage","body":"<p>I have a class that I wrote that saves and retrieves any objects to a windows phone isolated storage system. Have a look...</p>\n\n<pre><code>public class DataCache\n{\n    // Method to store an object to phone ************************************\n    public void StoreToPhone(string key, Object objectToStore)\n    {\n        var settings = IsolatedStorageSettings.ApplicationSettings;\n\n        try\n        {\n            if (existsInStorage(key))\n            {\n                settings.Remove(key);\n                settings.Add(key, objectToStore);\n            }\n            else\n            {\n                settings.Add(key, objectToStore);\n            }\n        }\n        catch (Exception e)\n        {\n            MessageBox.Show(\"An error occured while trying to cache data: \" + e.Message);\n        }\n    }\n\n    // Method to retrieve an object ******************************************\n    public Object retrieveFromPhone(string key)\n    {            \n        var settings = IsolatedStorageSettings.ApplicationSettings;            \n        Object retrievedObject = null;\n\n        try\n        {\n            if (existsInStorage(key))\n            {\n                settings.TryGetValue&lt;Object&gt;(key, out retrievedObject);\n            }\n            else\n            {\n                MessageBox.Show(string.Format(\"Cannot find key {0} in isolated storage\", key));\n            }\n        }\n        catch(Exception e)\n        {\n            MessageBox.Show(\"An error occured while trying to retrieve cache object: \"+e.Message);\n        }\n        return retrievedObject;\n    }\n\n    // Helper method to check if there is space on the phone to cache the data\n    private bool IsSpaceAvailable(long spaceReq)\n    {\n        using (IsolatedStorageFile store = IsolatedStorageFile.GetUserStoreForApplication())\n        {\n            long spaceAvail = store.AvailableFreeSpace;\n            if (spaceReq &gt; spaceAvail)\n            {\n                return false;\n            }\n            return true;\n        }\n    }\n\n    // Method to check if key exists in isolated storage *********************\n    public bool existsInStorage(string key)\n    {\n        var settings = IsolatedStorageSettings.ApplicationSettings;\n        bool objectExistsInStorage = settings.Contains(key);\n        return objectExistsInStorage;\n    }\n}\n</code></pre>\n\n<p>When I run my app and try and store some data using my StoreToPhone() method I get the following error:</p>\n\n<blockquote>\n  <p>An error occurred while trying to cache data: Value does not fall within the expected range</p>\n</blockquote>\n\n<p>I don't exactly know what this means.. Is it not expecting this type of object? I'm not sure... I'm passing it a custom class I wrote fyi.</p>\n"},{"tags":["c#","asp.net","iis"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13268386,"title":"Access denied error when publishing web site to server","body":"<p>I've built a website using ASP.NET MVC2 and it runs perfectly run on localhost. However, when I go to <code>Build -&gt; Publish</code> and publish the website to the server, I get a 403 Forbidden error. The files are there, as I can see <code>Site.css</code> if I navigate to it.</p>\n\n<p>I'm not sure if it matters, but here's my entire Web.config file:</p>\n\n<pre><code>&lt;configuration&gt;\n  &lt;connectionStrings&gt;\n    &lt;add name=\"FostConnection\" connectionString=\"server=myserver;database=mydatabase;uid=myuser;password=mypassword;\" providerName=\"System.Data.SqlClient\" /&gt;\n  &lt;/connectionStrings&gt;\n\n  &lt;system.web&gt;\n    &lt;compilation debug=\"true\" targetFramework=\"4.0\"&gt;\n      &lt;assemblies&gt;\n        &lt;add assembly=\"System.Web.Abstractions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" /&gt;\n        &lt;add assembly=\"System.Web.Routing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" /&gt;\n        &lt;add assembly=\"System.Web.Mvc, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" /&gt;\n      &lt;/assemblies&gt;\n    &lt;/compilation&gt;\n\n    &lt;pages&gt;\n      &lt;namespaces&gt;\n        &lt;add namespace=\"System.Web.Mvc\" /&gt;\n        &lt;add namespace=\"System.Web.Mvc.Ajax\" /&gt;\n        &lt;add namespace=\"System.Web.Mvc.Html\" /&gt;\n        &lt;add namespace=\"System.Web.Routing\" /&gt;\n      &lt;/namespaces&gt;\n    &lt;/pages&gt;\n  &lt;/system.web&gt;\n\n  &lt;system.webServer&gt;\n    &lt;validation validateIntegratedModeConfiguration=\"false\"/&gt;\n    &lt;modules runAllManagedModulesForAllRequests=\"true\"/&gt;\n  &lt;/system.webServer&gt;\n\n  &lt;runtime&gt;\n    &lt;assemblyBinding xmlns=\"urn:schemas-microsoft-com:asm.v1\"&gt;\n      &lt;dependentAssembly&gt;\n        &lt;assemblyIdentity name=\"System.Web.Mvc\" publicKeyToken=\"31bf3856ad364e35\" /&gt;\n        &lt;bindingRedirect oldVersion=\"1.0.0.0\" newVersion=\"2.0.0.0\" /&gt;\n      &lt;/dependentAssembly&gt;\n    &lt;/assemblyBinding&gt;\n  &lt;/runtime&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>What would be some common causes for this that I can iron out?</p>\n"},{"tags":["c#",".net","encryption","yahoo-messenger"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":3,"view_count":307,"score":0,"question_id":5565150,"title":"What encryption generates this type of text?","body":"<p>I'm trying to decode a DAT file produced by Yahoo Messenger, which looks similar to the text below which I generated by opening an exe in Notepad:</p>\n\n<pre><code>‹\n‹N€9 tè…ÀtäÿFöt‹FŠ ‹V‹NˆÿFÿNëÿFH‰F3À9Ft9Ft  ö…³   ;Øtsj÷ël;Øt%‹F‹N¶Dÿj Pÿ5@aÐMè5  …À„þÿÿ…Ûuƒ} tÇEø   jEPÿvÿvÿuøÿ5DaÐMÿÐM…Àu,ÿÐM=Y  tjðë…ÛtjöXë&lt;3Àf‹F,ÇF.   ‰Eë‹E‹N…Étÿv2PÿÑëƒ~$ t\n‹N(f‰ƒF(ÿF 3À‰F_[ÉÂ ÌÌÌÌÌƒù\nu&lt;r&lt;Ÿ\n</code></pre>\n\n<p>I have tried few online tools that has various encryption algorithm like Blow-fish, DES, MD5 1-Way and other normal encryption like leet speak, rot-13 etc, but i found the generated text is normal readable but not the original one. I think its AES or RSA or Triple DES. Actually i am working on a utility that will read the Yahoo Messengers archive of the local. But when i open the local , I found a DAT file, with encrypted text as above. </p>\n\n<p><strong>(UPDATE)</strong> </p>\n\n<p>As per venkyduded article \"yahoo uses a simple XOR algorithm to encode the messages (so much for security !!) \". Any good link on XOR rversing.</p>\n\n<p>Any help would be highly appreciated.</p>\n"},{"tags":["c#","debugging","sockets","background","winrt"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":144,"score":1,"question_id":11792361,"title":"Debugging of WinRT's background networking","body":"<p>I've made a project than uses tcp sockets connectivity (own closed protocol), added background connectivity with Network Trigger API, as described <a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=28999\" rel=\"nofollow\">here</a> (starting from page 17) - StreamSocket control channel registration block, and IBackgroundTask class, that should be fired each time socket receives something.</p>\n\n<p>Have tried everything to debug the code in background task, with no use:</p>\n\n<ul>\n<li>closing the visible app with a gesture</li>\n<li>lock the screen</li>\n<li>tried to load some other heavy application, to make windows suspend my app </li>\n</ul>\n\n<p>All these have not helped me to make background task run (and debug) during socket message. What am I doing wrong? Should I have to get the separate suspendable device, like a WinRT tablet, to get this working?</p>\n"},{"tags":["c#",".net","azure","windows-azure-storage","azure-storage-tables"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13256059,"title":"Azure october 2012 sdk - how to delete a table entity without retrieving it first?","body":"<p>In the previous version we could do this to delete an entity without knowing whether it exists.</p>\n\n<pre><code>svc = new TestContext();\nitem = new TestEntity(\"item2pk\", \"item2rk\");\nsvc.AttachTo(\"TestTable\", item, \"*\");\nsvc.DeleteObject(item);\nsvc.SaveChanges();\n</code></pre>\n\n<p><a href=\"http://blog.smarx.com/posts/deleting-entities-from-windows-azure-without-querying-first\" rel=\"nofollow\">(source)</a></p>\n\n<p>The new TableOperations doesn't have this syntax. Do I have to use this old method or is there a way? I'd like to be consistent because now all my code use the new classes for version 2.</p>\n\n<p>edit: the title was misleading</p>\n"},{"tags":["c#","assemblies","globalization"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":69,"score":4,"question_id":13201717,"title":"Finding Globalized Resource files when remotely loading an assembly","body":"<p>Our code uses a \"Plugin\" model, that remotely loads dll's conforming to a predefined structure <code>IPluginModel</code> that is defined in the main program.  The main program itself has several localized forms where the text and placement of the labels in the UI are all changed based on the different localization <code>Thread.CurrentThread.CurrentUICulture</code>.</p>\n\n<p>One thing that we noticed is that any forms or reports from the remotely loaded dll's will never be properly localized.  It does not seem to matter where the localization dll's containing the different resources for the plugin are located, either next to the main form, next to the plugin dll, or anywhere else.  How would one cause the Assembly to correctly locate its localized resources when the assembly itself is loaded during RunTime of the main program?</p>\n\n<p>I do have code that rather resembles the method used <a href=\"http://stackoverflow.com/questions/3125153/dynamically-loading-a-resource-and-reading-the-correct-value-for-the-currentuicu\">Here</a>, but dont want to have to manually implement the resx against the form itself if at all possible.  The code I have is located directly inside the plugin itself and is called whenever the CurrentUICulture is NOT \"en-US\".</p>\n\n<p>Ideally speaking, what Im looking for is a way to load the <code>pluginName.resources.dll</code> which is directly associated with the plugin I just loaded.  I do see the different folders in my main projects bin folder, the es folder contains a <code>main.resources.dll</code>, but simply placing the plugin dll's in that folder did not seem to work last time I tried it, although in theory that could have changed...or I may have done it wrong at the time...</p>\n\n<p><strong>Loading the assembly [code snippet]</strong></p>\n\n<pre><code>    private void LoadPlugin(string filePath)\n    {\n        bool isValidPlugin = false;\n        Assembly asm = null;\n        try\n        {\n            asm = Assembly.LoadFrom(Path.Combine(Environment.CurrentDirectory, filePath));\n                //Do some type checking to make certain this is in fact one of OUR plugins\n            var p = (IFTLPlugin)Activator.CreateInstance(types[x]);\n                _plugins.Add(p.Prefix, p);\n            }\n        }\n</code></pre>\n"},{"tags":["c#","asp.net","c#-4.0","asynchronous"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13266277,"title":"How do I call async methods in asp.net C# 4.0?","body":"<p>I'm aware that with .net 4.5 there is the await, async keywords that allows for easy calling of async methods. I 'm currently studying how to make async calls in C# 4.0. An example I want to is to make an async call where the datagrid is being databind. </p>\n\n<p>If you could provide me some links I would really appreciate it.</p>\n"},{"tags":["c#","oauth-2.0","dotnetopenauth","vkontakte"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13268201,"title":"Starting with DotNetOpenAuth","body":"<p>I'm working <strong>application for mobile devices</strong> with autorization in social network, that uses <strong>OAuth 2.0</strong> protocol (vk.com). Looks like DotNetOpenAuth is good tool for this task, but I'm a little confused where to start. Is there any tutorial about how to set up DotNetOpenAuth? I need only autorize and do few simple requests like: getting photo, name, etc. Or, may be there is another tool I can use?</p>\n"},{"tags":["c#","backgroundworker","oledbconnection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13247816,"title":"Cannot open OleDbConnection in BackgroundWorker","body":"<p>When trying to read data from mdb using backgroundworker I get an error </p>\n\n<blockquote>\n  <p>The program '[3768] BackgroundWorkerExample.vshost.exe: Managed' has exited with code 0 (0x0).</p>\n</blockquote>\n\n<p>without any other information or exception and I'm not able to catch it. Here is my code, without BGW it works fine. Do I miss something?</p>\n\n<pre><code>namespace BackgroundWorkerExample\n{\npublic class TestClass\n{\n    BackgroundWorker _Worker;\n\n    public TestClass()\n    {\n        InitializeWorker();\n    }\n\n    public void InitializeWorker()\n    {\n        _Worker = new BackgroundWorker();\n\n        _Worker.DoWork += new DoWorkEventHandler(WorkerDoWork);\n        _Worker.RunWorkerCompleted += new RunWorkerCompletedEventHandler(WorkerRunWorkerCompleted);\n    }\n\n    private void WorkerRunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)\n    {\n        Console.WriteLine(\"Work completed!\");\n    }\n\n    private void WorkerDoWork(object sender, DoWorkEventArgs e)\n    {\n        DataTable data = GetDataTable();\n        PrintResults(data);\n    }\n\n    public void Run()\n    {\n        _Worker.RunWorkerAsync();\n    }\n\n    public DataTable GetDataTable()\n    {\n        string connectionString = @\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\\students.mdb;\";\n\n        try\n        {\n            using (OleDbConnection con = new OleDbConnection(connectionString))\n            {\n                try\n                {\n                    con.Open(); // crashes here!\n\n                    DataTable res = new DataTable();\n\n                    string query = \"SELECT * FROM students\";\n\n                    OleDbDataAdapter adapter = new OleDbDataAdapter(query, con);\n                    adapter.Fill(res);\n\n                    return res;\n                }\n                catch (Exception ex)\n                {\n                    Console.WriteLine(ex.Message);\n                    return null;\n                }\n            }\n        }\n        catch (Exception e)\n        {\n            // never reaches this part\n            return null;\n        }\n    }\n\n    public void PrintResults(DataTable data)\n    {\n        foreach (DataRow row in data.Rows)\n        {\n            for (int i = 0; i &lt; 5; i++)\n            {\n                Console.Write(row[i] + \"   \");\n            }\n            Console.WriteLine();\n        }\n    }\n}\n}\n</code></pre>\n"},{"tags":["c#","xaml","windows-8","microsoft-metro","winrt"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13265015,"title":"Stretch WrapGrid item width","body":"<p>I am using a <code>WrapGrid</code> as <code>itemscontrol</code> in a <code>ListView</code> to present items horizontally with following XAML code (WinRT)</p>\n\n<pre><code>&lt;ItemsPanelTemplate &gt;\n    &lt;WrapGrid x:Name=\"ContentGrid\" MinWidth=\"200\" MinHeight=\"0\" VerticalAlignment=\"Top\"   HorizontalAlignment=\"Center\"   Orientation=\"Horizontal\" Margin=\"0,0,0,5\" &gt;                                     \n    &lt;/WrapGrid&gt;\n&lt;/ItemsPanelTemplate&gt;\n</code></pre>\n\n<p>Now how can i <strong>stretch items horizontally</strong> when the width is more than <code>MinWidth</code> and No More items can be added Horizontally. (All the items are aligned to center and there are lots of space in both sides horizontally)</p>\n\n<pre><code>&lt;DataTemplate x:Key=\"CustomChildItemTemplete\"&gt;\n   &lt;Grid Background=\"Red\"&gt;\n   &lt;/Grid&gt;\n&lt;/DataTemplate &gt;\n</code></pre>\n\n<p><strong>More Details:</strong>  When the <code>listview</code> width is Around 800 (approx) it is showing 4 items horizontal (as minimum item width is 200) but if the width is 900 (4 items visible) and blank space (50 px) is in Right and Left of the <code>itemscontrol</code>, how can i remove this blank space by increasing the item width (simply item width must be 225 when <code>listview</code> width is 900)</p>\n"},{"tags":["c#",".net","xmltextwriter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13264853,"title":"xmlTextWriter does not save the XML file to bin folder","body":"<p>I am trying to create an XML file for storing some info from  a class. I gave the path as a const set to <code>Info.xml</code>. but the <code>XMLTextWriter</code> is not saving the XML file to bin(debug/release) folder, rather it is saving it to MyDocuments folder. When i tried to check if the file exists with <code>File.Exists(path)</code>, its returning false. Could somebody please guide me here.</p>\n\n<p>My code looks as below...</p>\n\n<pre><code>string BookName = \"Book1\" \nstring AuthorName= \"Author1\" \nXmlTextWriter writer = new XmlTextWriter(\"Info.xml\", Encoding.UTF8);    writer.WriteStartDocument(); \nwriter.WriteStartElement(\"Title\"); \nwriter.WriteString(BookName); \nwriter.WriteStartElement(\"Author\"); \nwriter.WriteString(AuthorName); \nwriter.WriteEndElement(); \nwriter.WriteEndElement(); \nwriter.WriteEndDocument(); \nwriter.Close();\n</code></pre>\n"},{"tags":["c#","xml-serialization"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":13251548,"title":"XML deserializing null properties to zero and false","body":"<p>I am passing an xml doc with some attributes missing to a deserilaliser. I need the missing values to be null in the resulting object but currently ints deserialise to zero and bools to false.</p>\n\n<p>The example below shows a doc with vals deserialising correctly but the doc without vals returning the zeros and nulls. </p>\n\n<p>How do force the deserialiser not to treat missing attributes like this.</p>\n\n<pre><code>using System;\nusing System.IO;\nusing System.Xml;\nusing System.Xml.Serialization;\n\nnamespace SOQuestion\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n\n            var resultWithVals = getObject(docWithVals());\n            var resultWithoutVals = getObject(docWithoutVals());\n\n            Console.WriteLine(\"WITH VALS\");\n            Console.WriteLine(resultWithVals.someBool);\n            Console.WriteLine(resultWithVals.someFloat);\n            Console.WriteLine(resultWithVals.someInt);\n            Console.WriteLine(resultWithVals.someString);\n\n\n            Console.WriteLine(\"WITHOUT VALS\"); // nulls are returned here as zero and false\n            Console.WriteLine(resultWithoutVals.someBool);\n            Console.WriteLine(resultWithoutVals.someFloat);\n            Console.WriteLine(resultWithoutVals.someInt);\n            Console.WriteLine(resultWithoutVals.someString);\n\n            Console.ReadLine();\n\n\n        }\n\n        public static XmlDocument docWithVals()\n        {\n            var doc = new XmlDocument();\n            var el = (XmlElement)doc.AppendChild(doc.CreateElement(\"Result\"));\n            el.SetAttribute(\"someString\", \"Hello World\");\n            el.SetAttribute(\"someBool\", \"true\");\n            el.SetAttribute(\"someInt\", \"1\");\n            el.SetAttribute(\"someFloat\", \"1.1\");\n            return doc;\n\n        }\n\n        public static XmlDocument docWithoutVals()\n        {\n            var doc = new XmlDocument();\n            var el = (XmlElement)doc.AppendChild(doc.CreateElement(\"Result\"));\n            el.SetAttribute(\"someString\", \"Hello World\");\n            return doc;\n\n        }\n\n\n        public static Result getObject(XmlDocument doc)\n        {\n\n                var mySerializer = new XmlSerializer(new Result().GetType());\n                var myStream = new MemoryStream();\n                doc.Save(myStream);\n                myStream.Position = 0;\n                var r = mySerializer.Deserialize(myStream);\n                return (Result)r;\n         }\n\n    }\n\n    [Serializable]\n    public class Result\n    {\n        [XmlAttribute]\n        public string someString { get; set; }\n        [XmlAttribute]\n        public bool someBool { get; set; }\n        [XmlAttribute]\n        public int someInt { get; set; }\n        [XmlAttribute]\n        public float someFloat { get; set; }\n\n    }\n\n}\n</code></pre>\n"},{"tags":["c#","templates","listbox","windows-8","listboxitem"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13268103,"title":"Windows store apps - how to use a custom template to a ListBoxItem in C#?","body":"<p>here's an example of my ListBoxItem in a ListBox with a custom template:</p>\n\n<pre><code>&lt;ListBox Margin=\"0,140,0,0\" x:Name=\"ListBox_Main\" VerticalAlignment=\"Top\" Foreground=\"Black\" SelectionChanged=\"ListBox_Main_SelectionChanged\" FontFamily=\"Segoe UI\" Grid.RowSpan=\"2\" FontSize=\"26.667\"&gt;\n            &lt;ListBox.Resources&gt;\n                &lt;Style x:Key=\"CustomStyle_ListBox\" TargetType=\"ListBox\"&gt;\n                    &lt;Setter Property=\"Foreground\" Value=\"{StaticResource ListBoxForegroundThemeBrush}\"/&gt;\n                    &lt;Setter Property=\"Background\" Value=\"{StaticResource ListBoxBackgroundThemeBrush}\"/&gt;\n                    &lt;Setter Property=\"BorderBrush\" Value=\"{StaticResource ListBoxBorderThemeBrush}\"/&gt;\n                    &lt;Setter Property=\"BorderThickness\" Value=\"{StaticResource ListBoxBorderThemeThickness}\"/&gt;\n                    &lt;Setter Property=\"ScrollViewer.HorizontalScrollBarVisibility\" Value=\"Disabled\"/&gt;\n                    &lt;Setter Property=\"ScrollViewer.VerticalScrollBarVisibility\" Value=\"Auto\"/&gt;\n                    &lt;Setter Property=\"ScrollViewer.HorizontalScrollMode\" Value=\"Disabled\"/&gt;\n                    &lt;Setter Property=\"ScrollViewer.IsHorizontalRailEnabled\" Value=\"True\"/&gt;\n                    &lt;Setter Property=\"ScrollViewer.VerticalScrollMode\" Value=\"Enabled\"/&gt;\n                    &lt;Setter Property=\"ScrollViewer.IsVerticalRailEnabled\" Value=\"True\"/&gt;\n                    &lt;Setter Property=\"ScrollViewer.ZoomMode\" Value=\"Disabled\"/&gt;\n                    &lt;Setter Property=\"ScrollViewer.IsDeferredScrollingEnabled\" Value=\"False\"/&gt;\n                    &lt;Setter Property=\"ScrollViewer.BringIntoViewOnFocusChange\" Value=\"True\"/&gt;\n                    &lt;Setter Property=\"IsTabStop\" Value=\"False\"/&gt;\n                    &lt;Setter Property=\"TabNavigation\" Value=\"Once\"/&gt;\n                    &lt;Setter Property=\"FontFamily\" Value=\"{StaticResource ContentControlThemeFontFamily}\"/&gt;\n                    &lt;Setter Property=\"FontSize\" Value=\"{StaticResource ControlContentThemeFontSize}\"/&gt;\n                    &lt;Setter Property=\"ItemsPanel\"&gt;\n                        &lt;Setter.Value&gt;\n                            &lt;ItemsPanelTemplate&gt;\n                                &lt;VirtualizingStackPanel/&gt;\n                            &lt;/ItemsPanelTemplate&gt;\n                        &lt;/Setter.Value&gt;\n                    &lt;/Setter&gt;\n                    &lt;Setter Property=\"Template\"&gt;\n                        &lt;Setter.Value&gt;\n                            &lt;ControlTemplate TargetType=\"ListBox\"&gt;\n                                &lt;Border x:Name=\"LayoutRoot\" BorderBrush=\"{TemplateBinding BorderBrush}\" BorderThickness=\"{TemplateBinding BorderThickness}\" Background=\"{TemplateBinding Background}\"&gt;\n                                    &lt;VisualStateManager.VisualStateGroups&gt;\n                                        &lt;VisualStateGroup x:Name=\"CommonStates\"&gt;\n                                            &lt;VisualState x:Name=\"Normal\"/&gt;\n                                            &lt;VisualState x:Name=\"Disabled\"&gt;\n                                                &lt;Storyboard&gt;\n                                                    &lt;ObjectAnimationUsingKeyFrames Storyboard.TargetProperty=\"Background\" Storyboard.TargetName=\"LayoutRoot\"&gt;\n                                                        &lt;DiscreteObjectKeyFrame KeyTime=\"0\" Value=\"Transparent\"/&gt;\n                                                    &lt;/ObjectAnimationUsingKeyFrames&gt;\n                                                    &lt;ObjectAnimationUsingKeyFrames Storyboard.TargetProperty=\"BorderBrush\" Storyboard.TargetName=\"LayoutRoot\"&gt;\n                                                        &lt;DiscreteObjectKeyFrame KeyTime=\"0\" Value=\"{StaticResource ListBoxDisabledForegroundThemeBrush}\"/&gt;\n                                                    &lt;/ObjectAnimationUsingKeyFrames&gt;\n                                                &lt;/Storyboard&gt;\n                                            &lt;/VisualState&gt;\n                                        &lt;/VisualStateGroup&gt;\n                                        &lt;VisualStateGroup x:Name=\"FocusStates\"&gt;\n                                            &lt;VisualState x:Name=\"Focused\"&gt;\n                                                &lt;Storyboard&gt;\n                                                    &lt;ObjectAnimationUsingKeyFrames Storyboard.TargetProperty=\"Background\" Storyboard.TargetName=\"LayoutRoot\"&gt;\n                                                        &lt;DiscreteObjectKeyFrame KeyTime=\"0\" Value=\"{StaticResource ListBoxFocusBackgroundThemeBrush}\"/&gt;\n                                                    &lt;/ObjectAnimationUsingKeyFrames&gt;\n                                                &lt;/Storyboard&gt;\n                                            &lt;/VisualState&gt;\n                                            &lt;VisualState x:Name=\"Unfocused\"&gt;\n                                                &lt;Storyboard&gt;\n                                                    &lt;ObjectAnimationUsingKeyFrames Storyboard.TargetProperty=\"Background\" Storyboard.TargetName=\"LayoutRoot\"&gt;\n                                                        &lt;DiscreteObjectKeyFrame KeyTime=\"0\" Value=\"#FFFFFFFF\"/&gt;\n                                                    &lt;/ObjectAnimationUsingKeyFrames&gt;\n                                                &lt;/Storyboard&gt;\n                                            &lt;/VisualState&gt;\n                                        &lt;/VisualStateGroup&gt;\n                                    &lt;/VisualStateManager.VisualStateGroups&gt;\n                                    &lt;ScrollViewer x:Name=\"ScrollViewer\" BringIntoViewOnFocusChange=\"{TemplateBinding ScrollViewer.BringIntoViewOnFocusChange}\" HorizontalScrollMode=\"{TemplateBinding ScrollViewer.HorizontalScrollMode}\" HorizontalScrollBarVisibility=\"{TemplateBinding ScrollViewer.HorizontalScrollBarVisibility}\" IsHorizontalRailEnabled=\"{TemplateBinding ScrollViewer.IsHorizontalRailEnabled}\" IsVerticalRailEnabled=\"{TemplateBinding ScrollViewer.IsVerticalRailEnabled}\" IsDeferredScrollingEnabled=\"{TemplateBinding ScrollViewer.IsDeferredScrollingEnabled}\" Padding=\"{TemplateBinding Padding}\" TabNavigation=\"{TemplateBinding TabNavigation}\" VerticalScrollBarVisibility=\"{TemplateBinding ScrollViewer.VerticalScrollBarVisibility}\" VerticalScrollMode=\"{TemplateBinding ScrollViewer.VerticalScrollMode}\" ZoomMode=\"{TemplateBinding ScrollViewer.ZoomMode}\"&gt;\n                                        &lt;ItemsPresenter/&gt;\n                                    &lt;/ScrollViewer&gt;\n                                &lt;/Border&gt;\n                            &lt;/ControlTemplate&gt;\n                        &lt;/Setter.Value&gt;\n                    &lt;/Setter&gt;\n                &lt;/Style&gt;\n            &lt;/ListBox.Resources&gt;\n            &lt;ListBox.Style&gt;\n                &lt;StaticResource ResourceKey=\"CustomStyle_ListBox\"/&gt;\n            &lt;/ListBox.Style&gt;\n                &lt;ListBox.ItemsPanel&gt;\n                &lt;ItemsPanelTemplate&gt;\n                    &lt;StackPanel Orientation=\"Vertical\" /&gt;                                     \n                &lt;/ItemsPanelTemplate&gt;\n            &lt;/ListBox.ItemsPanel&gt;\n        &lt;ListBox.ItemContainerStyle&gt;\n            &lt;Style TargetType=\"ListBoxItem\"&gt;\n                &lt;Setter Property=\"Padding\" Value=\"120 10 120 10 \" /&gt;\n            &lt;/Style&gt;\n        &lt;/ListBox.ItemContainerStyle&gt;\n            &lt;ListBoxItem Background=\"#19000000\" Template=\"{StaticResource CustomStyle_ListBoxItem}\" Content=\"Item 1\"/&gt;\n            &lt;ListBoxItem Background=\"#19000000\" Template=\"{StaticResource CustomStyle_ListBoxItem}\" Content=\"Item 2\"/&gt;\n            &lt;ListBoxItem Background=\"#19000000\" Template=\"{StaticResource CustomStyle_ListBoxItem}\" Content=\"Item 3\"/&gt;\n            &lt;ListBoxItem Background=\"#19000000\" Template=\"{StaticResource CustomStyle_ListBoxItem}\" Content=\"Item 4\"/&gt;\n        &lt;/ListBox&gt;\n</code></pre>\n\n<p>and now I wanna add another ListBoxItem in C#:</p>\n\n<pre><code>ListBoxItem item = new ListBoxItem();\nitem.Content = \"item 5\";\nListBox_Main.add(item); //credit goes to Danilo Vulović\n</code></pre>\n\n<p>now I want to use the {StaticResource CustomStyle_ListBoxItem} which is a template used by my ListBoxItems in XAML, how can I do this in C#?</p>\n"},{"tags":["c#","dynamics-crm-2011"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13235030,"title":"How to get result of rollup query for a custom entity","body":"<p>When trying to get the records I get this error</p>\n\n<pre><code>The 'Rollup' method does not support entities of type 'new_X'.\n</code></pre>\n\n<p>This is my code</p>\n\n<pre><code>RollupRequest req = new RollupRequest();\nQueryExpression qe = new QueryExpression();\nqe.EntityName = \"new_x\";\nqe.ColumnSet = new ColumnSet(true);\nreq.Query = qe;\nreq.Target = new EntityReference(\"new_newpost\", new Guid(\"xxxxxxxxxxxxxxxxxxxxxxxxxxxxx\"));\nreq.RollupType = RollupType.Related;\nRollupResponse resp = (RollupResponse)xrm.Execute(req);\n</code></pre>\n\n<p>How can I get the results of rollup query</p>\n\n<p>Thanks in advance</p>\n\n<hr>\n\n<p>For custom entities you can do the fallowing</p>\n\n<pre><code>var rollupQuery = xrm.GoalRollupQuerySet.Where(c =&gt; c.Id == x.new_RecordstoRun.Id).First();\nvar result = xrm.RetrieveMultiple(new FetchExpression(rollupQuery.FetchXml));\n</code></pre>\n\n<p>But - How can I add a 'Skip' or 'Take' Linq to this?</p>\n"},{"tags":["c#","clickonce"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13267784,"title":"Local installed location of the clickonce application","body":"<p>I need to know where the clickonce application got installed. Is there a way to find this through C#?</p>\n"},{"tags":["c#","asp.net-mvc-3","unit-testing","moq","mspec"],"answer_count":3,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":789,"score":3,"question_id":7596426,"title":"How to test HTTP status code set by an ASP.NET MVC action with MSpec","body":"<p>I have the following controller:</p>\n\n<pre><code>public sealed class SomeController : Controller\n{\n    public ActionResult PageNotFound()\n    {\n        Response.StatusCode = 404;\n\n        return View(\"404\");\n    }\n}\n</code></pre>\n\n<p>I have created an MSpec specification:</p>\n\n<pre><code>[Subject(typeof (SomeController))]\npublic class when_invalid_page_is_requested : SomeControllerSpec\n{\n    Because of = () =&gt; result = Controller.PageNotFound();\n\n    It should_set_status_code_to_404 = \n        () =&gt; Controller.Response.StatusCode.ShouldEqual(404);\n}\n\npublic abstract class SomeControllerSpec\n{\n    protected static HomeController Controller;\n\n    Establish context = () =&gt; { Controller = new SomeController(); };\n}\n</code></pre>\n\n<p>But because of how I instantiate the controller, HttpContext is null.\nWhat would be the best way to test status code set by the <code>PageNotFound</code> action?</p>\n\n<p><strong>EDIT: Posted an answer below</strong></p>\n"},{"tags":["c#","wpf","string","listbox","listboxitem"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13267657,"title":"adding a ListBoxItem in a ListBox in C#?","body":"<p>I know that:</p>\n\n<pre><code>String test = \"test\";\nListBox.Items.Add(test);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>String test = \"test\";\nint index = 1;\nListBox.Items.Insert(index, String);\n</code></pre>\n\n<p>adds the String in a ListBox, but I want to insert ListBoxItem, how to?\npreviously I learn that</p>\n\n<pre><code>var contentToString = (String)ListBoxItem.Content;\n</code></pre>\n\n<p>simply converts ListBoxItem to String, but I couldn't do the opposite to convert String to ListBoxItem</p>\n"},{"tags":["c#","linq-to-sql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13268016,"title":"Linq to sql: Multiple counts","body":"<p>How can I get multiple counts using linq to sql from multiple tables? For example, I have following tables:</p>\n\n<h3>Customer</h3>\n\n<pre><code>ID, Name \n1, AAA \n2, BBB \n3, CCC \n4, DDD \n</code></pre>\n\n<h3>Department</h3>\n\n<pre><code>ID,CustomerID, Name \n1,   1,        XXX \n2,   1,        YYY \n3,   1,        ZZ1 \n4,   2,        ZZ2 \n5,   2,        ZZ3 \n6,   3,        UUU \n</code></pre>\n\n<h3>Office</h3>\n\n<pre><code>ID,DeptartmentID, Name \n1,  1,           Office1 \n2,  2,           Office2 \n3,  2,           Office3 \n4,  2,           Office4 \n5,  3,           Office5 \n6,  6,           Office6 \n\n\n\npublic class RecordCounts\n{\n   public int DepartmentCounts {get; set;}\n   public int OfficeCounts {get; set;}\n}\n</code></pre>\n\n<p>Can someone help me how to get counts for departments and levels where Customer.ID=something?</p>\n"},{"tags":["c#","internet-explorer","webbrowser-control","session-cookies","xbap"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":9,"score":1,"question_id":13267989,"title":"WebBrowser Control inside XBAP application: allow cookies","body":"<p>I have a WebBrowser control (System.Windows.Forms.WebBrowser + WindowsFormsHost) inside XBAP application. The problem is that when I \"Navigate()\" to website that requires cookies and I put my credentials, WebBrowser does not set the \"session\" number parameter in the \"Cookie\" property of the GET (HTTP) method and the login fails. I suspect that the WebBrowser does not accept cookies (or session cookies?). I tried to use IInternetSecurityManager in this way:</p>\n\n<pre><code>    public static bool TryAllowCookies(Uri uri)\n    {\n        IInternetSecurityManager securityManager = (IInternetSecurityManager)new InternetSecurityManager();\n        int policy = 0;\n        Guid context = Guid.Empty;\n\n        int hr = securityManager.ProcessUrlAction(uri.ToString(),\n                                     URLACTION_COOKIES_SESSION | URLACTION_COOKIES_ENABLED | URLACTION_COOKIES |\n                     URLACTION_COOKIES_SESSION_THIRD_PARTY | URLACTION_COOKIES_THIRD_PARTY,\n                     ref policy,\n                     Marshal.SizeOf(policy),\n                     ref context,\n                     Marshal.SizeOf(context),\n                     PUAF_DEFAULT, 0);\n\n                     return (hr == 0) &amp;&amp; policy == URLPOLICY_ALLOW;\n    }\n</code></pre>\n\n<p>ProcessUrlAction returs always True, but does not work.</p>\n\n<p>I found no complete example of how to use IInternetSecurityManager with WebBrowser control. \nThe same control instead in a windows form application works perfectly.</p>\n\n<p>thank you,\nRiccardo</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":8,"favorite_count":8,"up_vote_count":17,"down_vote_count":0,"view_count":11784,"score":17,"question_id":388937,"title":"Determine Label Size based upon amount of text and font size in Winforms/C#","body":"<p>I'd like to know if there's a better approach to this problem. I want to resize a label (vertically) to accomodate certain amount of text. My label has a fixed width (about 60 chars wide before it must wrap), about 495 pixels. The font is also a fixed size (12points afaik), but the text is not. </p>\n\n<p>What I want to do is increase the Label Height when there's a \"NewLine\" or the text must wrap; the idea is that the text is fully visible in the label. The AutoSize doesn't work because it will grow in width, not in height. </p>\n\n<p>Of course I could count the number of NewLines and add:  Newlines * LineHeight, and then -given that I manage to put 60 chars per line, just divide the number of chars and add as many LineHeight pixels as needed.</p>\n\n<p>I was wondering if there was a more professional way to do it. Is my approach too \"lame\" ?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","datagridview","sql-server-ce"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13267890,"title":"Update SQL Server CE table from SqlCeDataAdapter","body":"<p>I select data from SQL Server CE table and I want to store changed data (new rows, editings and deleting) back to SDF file:</p>\n\n<pre><code>public partial class MainForm : Form\n    {\n        private string connStr = \"DataSource = Database.sdf\";\n        private SqlCeConnection conn;\n        private SqlCeDataAdapter adapter;\n        private DataSet dataSet;\n\n        public MainForm()\n        {\n            InitializeComponent();\n            conn = new SqlCeConnection(connStr);\n            conn.Open();\n            if (conn.State == ConnectionState.Open)\n                DBStatusText.Text = \"Соединено с \" + conn.Database +\" (SQL Server CE \" + conn.ServerVersion + \")\";\n            SqlCeCommand comm = conn.CreateCommand();\n            comm.CommandText = \"SELECT TeamNum, TeamName FROM [Teams]\";\n            adapter = new SqlCeDataAdapter();\n            dataSet = new DataSet();\n            adapter.SelectCommand = comm;\n            adapter.Fill(dataSet);\n            dataGridView1.DataSource = dataSet.Tables[0];\n        }\n\n        ~MainForm()\n        {\n            adapter.Update(dataSet);\n            conn.Close();\n            conn.Dispose();\n            conn = null;\n        }\n    }\n</code></pre>\n\n<p>But I'm failed with this. Path to SDF file is correct. What I do wrong? Thanks.</p>\n"},{"tags":["c#",".net"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":265,"score":1,"question_id":11580128,"title":"How to convert SID to String in .net","body":"<p>I would like to convert the SID's System.Byte[] type to a String.</p>\n\n<p>My code:</p>\n\n<pre><code>string path = \"LDAP://DC=abc,DC=contoso,DC=com\";\nDirectoryEntry entry = new DirectoryEntry(path);\nDirectorySearcher mySearcher = new DirectorySearcher(entry);\n\nmySearcher.Filter = \"(&amp;(objectClass=user)(samaccountname=user1))\";\nresults = mySearcher.FindAll();\nforeach (SearchResult searchResult in results)\n{\n    Console.WriteLine(searchResult.Properties[\"ObjectSID\"][0].ToString());\n}\n</code></pre>\n\n<p>I tried with this but it gets the values from the domain I'm currently logged in, and i need from a given domain.</p>\n\n<pre><code>System.Security.Principal.NTAccount(user1)\n    .Translate([System.Security.Principal.SecurityIdentifier]).value\n</code></pre>\n"},{"tags":["c#","asp.net","application","webforms","application-state"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13261114,"title":"The application variable in ASP.net(c#).","body":"<p>I have a problem with the application state in Asp.net. I need a list of Strings that i would use in different forms in the same application. Here I add the list:    </p>\n\n<pre><code>Application.Add(\"users\", new List&lt;String&gt;());\n</code></pre>\n\n<p>In a new form I try to add a string to the list, but I get NullReferenceException in the second line of the code below.</p>\n\n<pre><code> List&lt;String&gt; ls=(List&lt;String&gt;) Application.Get(\"users\");\n            ls.Add(TextBox4.Text);\n</code></pre>\n"},{"tags":["c#","wpf","windows","controlpanel","windows-search"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13264646,"title":"Access windows control panel items (applets) via c# code","body":"<p>I am new to this and i have a small task. I want to access the control panel items, perform search and display their name, description and task lists etc what ever I can access in my window. Something similar to what windows explorer search does.</p>\n\n<p>This is what I have done till now. I followed the approach <a href=\"http://www.codeproject.com/Articles/6105/Enumerate-and-Host-Control-Panel-Applets-using-C\" rel=\"nofollow\">here</a> and I am able to access the cpl files in System folder. But they are not all the cpl files. And hence my result ends up being a subset of the desired result set.</p>\n\n<p>Also by accessing the cpl files I do not get the task list and other details which are valuable in my search operation.</p>\n\n<p>What else should I try? Can someone guide me?</p>\n\n<p>Thank you in advance.</p>\n"},{"tags":["c#","java","web-applications","project"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":49,"score":-2,"question_id":13267853,"title":"Need Final Year project idea?","body":"<p>I'm searching project idea for my final year project does any one have good idea??</p>\n\n<p>I have idea to build IDE(like eclipse) for mobile is it good for my project. i have no idea about how to do it or how to implement. can anybody help me.. \n  I'm good with java ,C# and web developing.</p>\n\n<p>Thanks in advanced. :)</p>\n"},{"tags":["c#","asp.net","wkhtmltopdf","html-to-pdf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13267838,"title":"Pechkin HTML to PDF that includes a link to a PNG from an SSL URL","body":"<p>I'm trying to convert an HTML string to PDF using Pechkin Synchronised (WkHtmlToPDF). Everything works perfectly apart from one (deal breaking) part. </p>\n\n<p>As part of the HTML string I have an Image tag that references a dynamically generated PNG file over SSL (See below for code). It simply appears as a blank box in the output pdf. </p>\n\n<p>I've checked the docs and turned on every option I can think of and have seen references to WkHtmlToPDF being able to support PNG format and pull data from SSL'd sources. </p>\n\n<pre><code>byte[] pdf = new Pechkin.Synchronized.SynchronizedPechkin(\nnew Pechkin.GlobalConfig()).Convert(\n    new Pechkin.ObjectConfig()\n   .SetLoadImages(true)\n   .SetPrintBackground(true)\n   .SetScreenMediaType(true)\n   .SetCreateExternalLinks(true), html);\n\nusing (FileStream file = System.IO.File.Create(@\"C:\\TEMP\\Output.pdf\"))\n{\n    file.Write(pdf, 0, pdf.Length);\n}\n</code></pre>\n\n<p>Relevant HTML that references the \"missing\" image</p>\n\n<pre><code>&lt;img width=\"385\" src=\"https://www.somehost.com/path/endpoint?type=somedata&amp;amp;height=140&amp;amp;width=2&amp;amp;data=000000000000000000\"&gt;\n</code></pre>\n\n<p>Also tried converting the &amp;'s to just &amp;'s to see if that helps like so but sadly it didnt:</p>\n\n<pre><code>&lt;img width=\"385\" src=\"https://www.somehost.com/path/endpoint?type=somedata&amp;height=140&amp;width=2&amp;data=000000000000000000\"&gt;\n</code></pre>\n\n<p>When I hit the link directly through the browser and inspect fiddler reports Content Length 1136, Content Type as image/png and the headers also mention WebSphere and Servlets</p>\n"},{"tags":["c#","asp.net-mvc-4"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":22,"score":2,"question_id":13267747,"title":"HTML.TextBoxFor disabled not passing value","body":"<p>I have the following bit in my view :</p>\n\n<pre><code>@Html.TextBoxFor(model =&gt; model.PersonnelId, new { disabled = \"disabled\" })\n</code></pre>\n\n<p>In my controller I have this :</p>\n\n<pre><code>if (ModelState.IsValid)\n{\n    PersonnelFacade.SavePerson(person);\n    return RedirectToAction(\"Index\");\n}\n</code></pre>\n\n<p>Now when I check the person.PersonnelId it is empty.\nWhen I remove the {disabled = \"disabled\" } it works fine but then I can change the PersonnelId which is not what I want to do.</p>\n\n<p>What am I doing wrong?</p>\n"},{"tags":["c#","list","generics"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13266579,"title":"How to remove items from a generic list after N minutes?","body":"<p>I have a list as below:</p>\n\n<pre><code>private List&lt;DateTime&gt; _result = new List&lt;DateTime();\n</code></pre>\n\n<p>and I add values to it like</p>\n\n<pre><code>_result.Add(DateTime.Now);\n</code></pre>\n\n<p>The requirement is that each item which is added should be removed from the list within 5 minutes deadline.</p>\n\n<p>I was thinking I could create a Timer which checks my list every e.g. 1 minute and find old items and remove them but I hoped there could be an easier way?</p>\n\n<p>How to implement it?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","int","string.format"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":57,"score":2,"question_id":13267055,"title":"How can I convert formatted string to int (if I know format) in C#?","body":"<p>I have formatted string, for example <code>123 456 000$</code> and I know format of this string <code>{0:### ### ##0}$</code>. I'd like to get <code>int value = 123456000;</code> from this string in C# with using known format.</p>\n\n<p>How I can do that? </p>\n"},{"tags":["c#","itextsharp"],"answer_count":2,"favorite_count":1,"up_vote_count":9,"down_vote_count":0,"view_count":9878,"score":9,"question_id":2370427,"title":"itextsharp set a document horizontal page a4","body":"<p>how can i set a document in a4 horizontal format in itextsharp?</p>\n\n<p>thanks</p>\n"},{"tags":["c#","pdf","axacropdf"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":5,"score":1,"question_id":13267708,"title":"The highlight controls of axAcroPDF are disabled","body":"<p>I am try to use axAcroPDF COM to display PDF file on my form , select text and highlight them.\nThe PDF page can be rendered correctly. And I have noticed there are some buttons stay at right of the form , but they are all gray ,so I can not click these buttons to make the selected content highlight.</p>\n\n<p>I have tested , to load the same PDF file with Adobe Reader, I can use all the function normally.\nI also tryed to use setCurrentHighLight() but is not work.</p>\n\n<p>Please help me to solve this problem , Thanks a lot.</p>\n"},{"tags":["c#","winforms","listbox"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":529,"score":1,"question_id":7672776,"title":"C#, winform - List box selection using up and down arrow key?","body":"<p>I have list box, I am able to select the entries (Single select mode - one at a time) using keyboard and mouse, but when i use up and down arrow keys, its not selecting the list. But able to scroll the list with an underline below each entity the arrow key is related. Thanks </p>\n"},{"tags":["c#","syntax","extension-methods"],"answer_count":0,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":98,"score":4,"question_id":13267572,"title":"Is there a reason why extension methods can't be invoked directly on \"this\"?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3906170/why-can-you-not-invoke-extension-methods-directly\">Why can you not invoke extension methods directly?</a>  </p>\n</blockquote>\n\n\n\n<p>Lets assume the following code:</p>\n\n<pre><code> public static class MyExtensions\n{\n    public static void SayHello(this Foo self)\n    {}\n}\n\npublic class Foo\n{\n    this.SayHello(); //this works\n    SayHello(); //this does not compile\n}\n</code></pre>\n\n<p>I'm just interested in the reasoning behind this, why can't extension methods be invoked on an implicit <code>this</code> ?</p>\n\n<p><code>this.SayHello()</code> and <code>SayHello</code> means the same thing when applied to instance methods.\nSo why use different behavior when calling extension methods?</p>\n"},{"tags":["c#",".net","multithreading","timer"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":62,"score":-2,"question_id":13153245,"title":"How to excecute method after a delay in threading .timer?","body":"<p>I have a class that created a <strong>threading .timer</strong>.</p>\n\n<pre><code>  System.Threading.Timer timer;\n  TimerCallback cb = new TimerCallback(ProcessTimerEvent);\n    timer = new Timer(cb, reset, 1000, Convert.ToInt64(this.Interval.TotalSeconds));\n}\n\nprivate void ProcessTimerEvent(object obj)\n{\n    if (Tick != null)\n        Tick(this, EventArgs.Empty);\n}\n</code></pre>\n\n<p>I want dispose Timer inside of this and then timer work.</p>\n\n<p>in my TickEvent i excecute a method but don't complate this.</p>\n\n<pre><code> void MyTimer_Tick(object sender, EventArgs e)\n{\n if(value)\n   MyFunction();\n}\n</code></pre>\n\n<p>Timer must be taken to stop until MyFunction complete.</p>\n"},{"tags":["c#","asp.net-mvc-4","fluentvalidation"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13267676,"title":"fluentvalidation does not show error or update Modelstate","body":"<p>This is my code I have setup with the latest fluent validation library.</p>\n\n<pre><code>public class ReleaseViewModelValidator : AbstractValidator&lt;ReleaseViewModel&gt; \n{ \npublic ReleaseViewModelValidator() {\n RuleFor(r =&gt; r.Name).NotEmpty().Length(1, 30).WithMessage(\"Name must not be longer than 30 chars.\"); \n  } \n}\n[FluentValidation.Attributes.Validator(typeof(ReleaseViewModel))]\n public class ReleaseViewModel { public int ReleaseId { get; set; }\n[Remote(\"ReleaseExists\", \"Release\", ErrorMessage = \"This name already exists.\")]\npublic string Name { get; set; } \npublic DateTime CreatedAt { get; set; } }\n\n GlOBAL.ASAX: FluentValidationModelValidatorProvider.Configure();\n\n VIEW: model ILMD.Web.Models.ReleaseViewModel @* Remote Validation*@ &lt;script src=\"@Url.Content(\"~/Scripts/jquery.validate.unobtrusive.min.js\")\" type=\"text/javascript\"&gt;&lt;/script&gt;\n @using (Html.BeginForm(\"Create\", \"Release\")) \n {\n &lt;p class=\"editor-label\"&gt;@Html.LabelFor(model =&gt; model.Name)&lt;/p&gt; \n &lt;p class=\"editor-field\"&gt;@Html.EditorFor(model =&gt; model.Name)&lt;/p&gt; \n &lt;p class=\"editor-field\"&gt;@Html.ValidationMessageFor(model =&gt; model.Name)&lt;/p&gt; \n }\n</code></pre>\n\n<hr>\n\n<p>All my unit tests for the ReleaseViewModelValidator show green light. Fine.</p>\n\n<p>But less cool is that entering some live data like 31 chars or entering nothing I do not see any client side error message.</p>\n\n<p>Do I still have to include something in my partial view? The ModelState is also not correct its always true.  </p>\n"},{"tags":["c#",".net","date","strtotime"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":43,"score":-1,"question_id":13267618,"title":"strtotime for C# (.NET)","body":"<p>Do you know of a strtotime equivalent in C#(.NET) even for other languages than English (i.e. Slovak version of 25th January is 25 Január).</p>\n"},{"tags":["c#","asp.net","mobile","sms"],"answer_count":18,"favorite_count":10,"up_vote_count":19,"down_vote_count":1,"view_count":4399,"score":18,"question_id":548911,"title":"Sending SMS","body":"<p>I want to send SMS from my Web application in C#. </p>\n\n<p>Can anyone guide me as to how this can be done ?</p>\n"},{"tags":["c#","asp.net","error-handling","unhandled-exception"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13229914,"title":"Exception without YSOD","body":"<p>So I set up my Global.asax file to email me when an unhanded exception occurred. I get an email with exceptions that don't appear to the user, and the code appears to be working just fine at the client end and the page loads and does what is expected.</p>\n\n<p>I have this code in the aspx file, which shows a checkbox based on a role or a customer number started with specific characters...</p>\n\n<pre><code>&lt;%  if (Roles.IsUserInRole(\"Admin\") ||\n                   txtAccountNo.Text.Substring(0, 2) == \"UK\" ||\n                   txtAccountNo.Text.Substring(0, 2) == \"FR\" ||\n                   txtAccountNo.Text.Substring(0, 2) == \"IT\" ||\n                   txtAccountNo.Text.Substring(0, 2) == \"DK\" ||\n                   txtAccountNo.Text.Substring(0, 2) == \"SE\")\n               { %&gt;\n            &lt;label for=\"chkExpressDelivery\"&gt;&lt;asp:Literal ID=\"Literal14\" runat=\"server\" Text=\"&lt;%$ Resources:LocalizedText, fieldLabel_ExpressDelivery %&gt;\"&gt;&lt;/asp:Literal&gt;&lt;span class=\"small\"&gt;&lt;/span&gt;&lt;/label&gt;\n            &lt;asp:CheckBox ID=\"chkExpressDelivery\" runat=\"server\" Width=\"50px\" CssClass=\"_checkbox _normalcheckbox\" Text=\"&amp;nbsp;\" /&gt;\n            &lt;%} %&gt;\n</code></pre>\n\n<p>now txtAccountNo is populated from a user profile property in the Page_Load event in the aspx.cs file.</p>\n\n<p>the error message i receive in the email (which the client never sees) is </p>\n\n<blockquote>\n  <p>Index and length must refer to a location within the string. Parameter name: length</p>\n</blockquote>\n\n<p>I understand the error message - that it's saying the txtAccountNo.Text is basically empty when that code runs, but what i dont understand is, the client never sees this error and the page behaves as i want it to.</p>\n\n<p>BUT, if i turn on custom error messages in the web.config file, the client is directed to the custom error page, but without it, no error as far as the client is concerned. </p>\n\n<p>So how can i correct this error so i can turn on my custom error pages?</p>\n\n<p>I hope this makes sense! Let me know if you need any more info.</p>\n\n<p>Thanks</p>\n\n<p>Stuart</p>\n\n<p>this code now works...</p>\n\n<pre><code>&lt;%  if (txtAccountNo.Text.Length &gt; 0 &amp;&amp; (Roles.IsUserInRole(\"Admin\") ||\n               txtAccountNo.Text.Substring(0, 2) == \"UK\" ||\n               txtAccountNo.Text.Substring(0, 2) == \"FR\" ||\n               txtAccountNo.Text.Substring(0, 2) == \"IT\" ||\n               txtAccountNo.Text.Substring(0, 2) == \"DK\" ||\n               txtAccountNo.Text.Substring(0, 2) == \"SE\"))\n           { %&gt;\n        &lt;label for=\"chkExpressDelivery\"&gt;&lt;asp:Literal ID=\"Literal14\" runat=\"server\" Text=\"&lt;%$ Resources:LocalizedText, fieldLabel_ExpressDelivery %&gt;\"&gt;&lt;/asp:Literal&gt;&lt;span class=\"small\"&gt;&lt;/span&gt;&lt;/label&gt;\n        &lt;asp:CheckBox ID=\"chkExpressDelivery\" runat=\"server\" Width=\"50px\" CssClass=\"_checkbox _normalcheckbox\" Text=\"&amp;nbsp;\" /&gt;\n        &lt;%} %&gt;\n</code></pre>\n"},{"tags":["c#","asp.net","sms"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":7538,"score":2,"question_id":793323,"title":"Looking for a free SMS gateway that works with C#","body":"<p>I have developed a Website in ASP.NET 2.0 I want to send an SMS to every person who  registers to my site. I want to do it in C# code, is there any service[webservice] which I can use and send free SMS to any mobile.</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["c#","asp.net","linq","linq-to-sql"],"answer_count":2,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13266681,"title":"Is it possible to return IQueryable<SomeClass> to a IQueryable<T> method?","body":"<p>In QueryableEntities method below,\n<code>IEnumerable&lt;Competition&gt;.AsQueryable()</code> will return <code>IQueryable&lt;Competition&gt;</code> which am not able to return because it is expecting <code>IQueryable&lt;T&gt;</code></p>\n\n<p>I can write only one method to return <code>IQueryable&lt;Competition&gt;</code> and <code>IQueryable&lt;Submission&gt;</code> </p>\n\n<p>If anyone knows how to do it please let me know, thanks</p>\n\n<pre><code>public partial class WinBoutsDataContext&lt;T&gt; : System.Data.Linq.DataContext where T : class\n{\n    public IQueryable&lt;T&gt; QueryableEntities\n    {\n        get\n        {\n            if (typeof(T).Equals(typeof(Model.Competition)))\n            {\n                return this.ConvertToCompetitionList(\n                      this.GetTable&lt;Storage.Competition&gt;()).AsQueryable();\n            }\n             else if(typeof(T).Equals(typeof(Model.Submission)))\n            {\n                return this.ConvertToSubmissionList(\n                       this.GetTable&lt;Storage.CompetitionEntry&gt;()).AsQueryable();\n            }\n        }\n    }\n\n    public DataAccess.Model.Competition ConvertToCompetition(DataAccess.Storage.Competition comp)\n    {\n\n        DataAccess.Model.Competition modelComp = new DataAccess.Model.Competition \n        { \n            CompetitionID = comp.CompetitionID, \n            Active = comp.Active, \n            CompetitionStatusID = \n            comp.CompetitionStatusID, \n            Duration = comp.Duration, \n            EndDate = comp.EndDate, \n            Entrants = comp.Entrants, \n            Featured = comp.Featured, \n            Image = comp.Image, \n            IsOvertime = comp.IsOvertime, \n            MaxEntrants = comp.MaxEntrants, \n            Notes = comp.Notes, \n            OvertimeDuration = comp.OvertimeDuration, \n            OvertimeEnd = comp.OvertimeEnd, \n            OvertimeStart = comp.OvertimeStart, \n            ParentCompetitionID = comp.ParentCompetitionID, \n            Prize = comp.Prize, StartDate = comp.StartDate, \n            SuggestedBy = comp.SuggestedBy, \n            Summary = comp.Summary, \n            Title = comp.Title \n        };\n\n        return modelComp;\n    }\n\n    public IEnumerable&lt;DataAccess.Model.Competition&gt; ConvertToCompetitionList(IEnumerable&lt;DataAccess.Storage.Competition&gt; compList)\n    {\n        List&lt;DataAccess.Model.Competition&gt; compModelList = new List&lt;DataAccess.Model.Competition&gt;();\n\n        foreach (DataAccess.Storage.Competition comp in compList)\n        {\n            compModelList.Add(ConvertToCompetition(comp));\n        }\n\n        return compModelList;\n    }\n}\n</code></pre>\n"},{"tags":["c#"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":212,"score":0,"question_id":3980341,"title":"Validate and sort a variety of serial numbers with different formats?","body":"<p>I am faced with the following issue.  I need to capture a range of serial numbers in c# to be stored in a database.  If these serial numbers are just numbers, it is fine, but I have ran into serial numbers which are alpha-numeric such as:</p>\n\n<p>56AAA71064D6 and 56AAA7105A25</p>\n\n<p>How can I accommodate the different possibilities that serial number ranges may be in?</p>\n\n<p>Assuming that all serial numbers have some order, how can I parse the sequential part of it?</p>\n\n<p>The database takes the serial numbers as strings already.</p>\n"},{"tags":["c#",".net","wpf","xaml","mvvm"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13266624,"title":"How to retrieve a control's container when clicked","body":"<p>I've got a <code>TreeView</code> which contains a number of <code>TreeViewItems</code>.  Each <code>TreeViewItem</code> contains a horizontally-oriented <code>StackPanel</code> which in turn contains an image and a label.</p>\n\n<p>When the user clicks on the TreeViewItem, I would like to get a reference for that <code>TreeViewItem</code>.  Instead, the source is returning as either label or image, depending on which part of the <code>TreeViewItem</code> the user clicks on.</p>\n\n<p>I cannot use the selectedItemChanged event, as this is strictly an operation which must occur every time a TreeViewItem is clicked.</p>\n\n<p>Here is my XAML:</p>\n\n<pre><code>&lt;TreeView DockPanel.Dock=\"Left\" \n          Name=\"tvSchema\" \n          AllowDrop=\"True\"\n          TreeViewItem.PreviewMouseLeftButtonDown=\"tvSchema_PreviewMouseLeftButtonDown\"&gt;\n&lt;/TreeView&gt;\n</code></pre>\n\n<p>And here is the code which attempts to retrieve the selected TreeViewItem when the user clicks on one:</p>\n\n<pre><code>private void tvSchema_PreviewMouseLeftButtonDown(object sender, MouseButtonEventArgs e)\n{\n     object x = e.OriginalSource; //Returns TextBlock\n     object y = e.Source; //Returns Label\n     object z = sender; //Returns TreeView\n}\n</code></pre>\n\n<p>What can be done to get the actual TreeViewItem?</p>\n"},{"tags":["c#","asp.net","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13266766,"title":"How can i skip extra rows in excel while importing it into database using SqlBulkCopy?","body":"<p>I am importing ExcelSheet into SQL server database, the problem I have is that the ExcelSheet has around 25 columns while the database table has 15 rows. I need to skip the extra unwanted rows in excel, e.g:</p>\n\n<pre><code>using (SqlBulkCopy bulkCopy = new SqlBulkCopy(sqlConnectionString))\n{                  \n   bulkCopy.ColumnMappings.Add(\"PP NO\", \"passportnumber\");\n   bulkCopy.ColumnMappings.Add(\"COVER NO\", \"covernumber\");\n   bulkCopy.ColumnMappings.Add(\"NAME\", \"paxname\");\n   .....\n}\n</code></pre>\n\n<p>The error I am getting is \n<code>The given ColumnMapping does not match up with any column in the source or destination.</code></p>\n"},{"tags":["c#","asp.net"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":1458,"score":1,"question_id":7855948,"title":"How to call a class in the App_Code folder from code behind?","body":"<p>I created a class in ASP.NET C# which is located in the App_Code folder. Now I want to call this class from my code behind from one of my .aspx pages. How can I do this?</p>\n\n<p>Any help will be appreciate it.</p>\n"},{"tags":["c#","windows-8","xmpp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13267456,"title":"Is there any free XMPP library which Supports WinRT?","body":"<p>Could anyone say me the XMPP library that supports WinRT, I've tried Jabber-Net, agsXMPP, those are not working. . .</p>\n"},{"tags":["c#","jquery","asp.net-mvc","form-validation"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13267455,"title":"Retaining form state for elements introduced by jQuery","body":"<p>I have a view which has a table with one editable row. A new editable row can be added using jQuery by clicking an image.</p>\n\n<pre><code>&lt;table width=\"100%\" class=\"rateTable\" id=\"rateTbl\"&gt;\n    &lt;tr&gt;\n        &lt;th&gt;\n            Low Range\n        &lt;/th&gt;\n        &lt;th&gt;\n            High Range\n        &lt;/th&gt;\n        &lt;th&gt;\n            Rate\n        &lt;/th&gt;            \n        &lt;th&gt;\n        &lt;/th&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n        &lt;td&gt;\n            @Html.TextBox(\"LowRange0\")\n        &lt;/td&gt;\n        &lt;td&gt;\n            @Html.TextBox(\"HighRange0\")\n        &lt;/td&gt;\n        &lt;td&gt;\n            @Html.TextBox(\"Rate0\")\n        &lt;/td&gt;\n        &lt;td&gt;                \n            &lt;input type=\"image\" alt=\"new band\" src=@Url.Content(\"~/Content/images/add.gif\") id=\"addBand\" /&gt;\n        &lt;/td&gt;\n    &lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>Following is the jQuery script which adds a new row.</p>\n\n<pre><code>$(\"#addBand\").click(function () {        \n    AddRow(highRange);        \n});\n\nvar AddRow = function (highRange) {\n    var tr = $(\"#rateTbl tr:last\").clone(true, true);\n\n    $(tr).find(\"input, select\")\n    .attr(\"name\", function () {\n        var parts = this.id.match(/(\\D+)(\\d+)$/);\n        if (parts != null) {\n            return parts[1] + ++parts[2];\n        }\n    })\n    .attr(\"id\", function () {\n        var parts = this.id.match(/(\\D+)(\\d+)$/);\n        if (parts != null) {\n            return parts[1] + ++parts[2];\n        }\n    });\n\n    $(\"#rateTbl tr:last\").after(tr);\n}\n</code></pre>\n\n<p>The trouble is upon form submit and subsequent validation failure, the form state does not retain the newly added row thereby losing the input values. I need to make sure that the new row added using jQuery be retained in case of validation failure.</p>\n"},{"tags":["c#","active-directory","sid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13267425,"title":"How do i get the SID-History value using c# from active directory","body":"<p>I have a problem i've been struggling with.\nI am trying to get the sidhistory property from an AD searchresult.\nIs there anyone that can shed some light, or point me in the right direction on how to get the sidhistory property value?</p>\n\n<p>This is an example of what i do ....i iterate through the properties, but there is not sidhistory property when i debug the code.</p>\n\n<pre><code>using (DirectoryEntry directoryEntryUser = new DirectoryEntry(searchResult.Path))\n{\n    foreach (string propertyName in directoryEntryUser.Properties.PropertyNames)\n    {\n            PropertyValueCollection propertyValues = \n            directoryEntryUser.Properties[propertyName];\n            // And the rest of the code goes here\n            // to get the values.\n            // Sid-History or any variation never displays here \n            // as a property name\n            // however objectsid does display\n    }\n}\n</code></pre>\n"},{"tags":["c#","regex"],"answer_count":7,"favorite_count":19,"up_vote_count":40,"down_vote_count":0,"view_count":89460,"score":40,"question_id":273141,"title":"Regex for numbers only","body":"<p>I haven't used regular expressions at all, so I'm having difficulty troubleshooting. I want the regex to match only when the contained string is all numbers; but with the two examples below it is matching a string that contains all numbers plus an equals sign like \"1234=4321\". I'm sure there's a way to change this behavior, but as I said, I've never really done much with regular expressions.</p>\n\n<pre><code>        string compare = \"1234=4321\";\n        Regex regex = new Regex(@\"[\\d]\");\n\n        if (regex.IsMatch(compare))\n        { \n            //true\n        }\n\n        regex = new Regex(\"[0-9]\");\n\n        if (regex.IsMatch(compare))\n        { \n            //true\n        }\n</code></pre>\n\n<p>In case it matters, I'm using C# and .NET2.0.</p>\n"},{"tags":["c#","asp.net","events","gridview","checkbox"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":13267301,"title":"allow only one checkbox to be checked - asp.net c#","body":"<p>I have a gridview where i have added checkboxes programmatically.\ni do as following when creating checkboxes inside a foreach loop, so that they trigger an event when checked,</p>\n\n<pre><code>            cbGV = new CheckBox();\n            cbGV.ID = \"cbGV\";\n            cbGV.AutoPostBack = true;\n            cbGV.CheckedChanged += new EventHandler(this.cbGV_CheckedChanged);\n</code></pre>\n\n<p>So basically when i want the event to be triggered, i have the following below,</p>\n\n<pre><code>    protected void cbGV_CheckedChanged(object sender, EventArgs e)\n    {\n        //gets the current checked checkbox.\n        CheckBox activeCheckBox = sender as CheckBox;\n\n        foreach (GridViewRow gvr in GridView1.Rows)\n        {\n            //this code is for finding the checkboxes in the gridview.\n\n            CheckBox checkBox = ((CheckBox)gvr.FindControl(\"cbGV\"));\n\n            //so basically, right here i'm confused on how i should compare the if/else logic, how i should compare and disable every other checkbox if the current checkbox is checked. Any ideas gues?\n\n        }\n</code></pre>\n\n<p>thanks for your answer in advance.</p>\n"},{"tags":["c#","asp.net","itextsharp"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13245208,"title":"How to create pdfformfields using iTextSharp?","body":"<p>I am using iTextSharp and CSharp for creating the pdf.I need to add formfields like checkbox,radiobutton and dropdown which canot be edited.</p>\n\n<p>I used this..</p>\n\n<pre><code>            FileStream pdffile = new FileStream(path + \"/Pdf/tes.pdf\",FileMode.Create);\n            PdfWriter writer = PdfWriter.GetInstance(doc, pdffile);\n            doc.Open(); \n            Rectangle rect = new Rectangle(100, 100, 100, 100);\n            RadioCheckField checkbox = new RadioCheckField(writer, rect, \"bhjabsdf\", \"on\");\n            checkbox.CheckType = RadioCheckField.TYPE_CHECK;\n            PdfFormField field = checkbox.CheckField;\n            writer.AddAnnotation(field);\n            doc.Close();\n</code></pre>\n\n<p>But it's not working.I also read about PdfStamper.But i am creating a new pdf,not changing the exsisting one.So i don't know whether i can use pdfstamper?</p>\n\n<p>Thanks..</p>\n\n<p>Edit:</p>\n\n<pre><code>private void CreateRadioButton(PdfWriter writer, PdfContentByte cb,Font font)\n    {\n        Rectangle rect;\n        PdfFormField field;\n        PdfFormField radiogroup = PdfFormField.CreateRadioButton(writer, true);\n        radiogroup.FieldName = \"language\";\n        RadioCheckField radio;\n        int x = 20;\n        for (int i = 0; i &lt; Petrol.Length; i++)\n        {\n            rect = new Rectangle(440 + i * x, 692, 450 + i * x, 682);\n            radio = new RadioCheckField(writer, rect, null, LANGUAGES[i]);\n            radio.BorderColor = GrayColor.GRAYBLACK;\n            radio.BackgroundColor = BaseColor.WHITE;\n            radio.CheckType = RadioCheckField.TYPE_CIRCLE; \n\n            if (Petrol[i] == \"F\")\n                radio.Checked = true;\n            field = radio.RadioField;\n</code></pre>\n\n<p>//Here i am setting readonly..</p>\n\n<pre><code>            field.SetFieldFlags(PdfFormField.FF_READ_ONLY);\n            radiogroup.AddKid(field);                \n            ColumnText.ShowTextAligned(cb, Element.ALIGN_LEFT,\n              new Phrase(Petrol[i], font), 451 + i * x, 684, 0);\n            if (i &gt;= 1) x = 25;\n        }\n        writer.AddAnnotation(radiogroup);\n    }\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":25,"score":2,"question_id":13267087,"title":"How to join and select table data in mvc C#?","body":"<p>In my project I have services.\nSo in side the service I want to join tables and want to select more than one table data.</p>\n\n<p>So I write this cording.</p>\n\n<pre><code>var query1 = from opv in _opvRepository.Table\n                         join o in _orderRepository.Table on opv.OrderId equals o.Id\n                         join g in _graduandRepository.Table on opv.graduand_id equals g.graduand_id\n                         join pv in _productVariantRepository.Table on opv.ProductVariantId equals pv.Id\n                         join p in _productRepository.Table on pv.ProductId equals p.Id\n                         where (opv.ceremony_id == ceremony_id) &amp;&amp;\n                         (!o.Deleted) &amp;&amp; (opv.IsHireItem == true)  &amp;&amp;\n                         (!p.Deleted) &amp;&amp;\n                         (!pv.Deleted) &amp;&amp; (opv.ceremony_id == ceremony_id)\n                         select opv,g;\n</code></pre>\n\n<p>But there is error and I can't select <code>opv and g.</code> if I write   <code>select opv;</code>it is ok. but i want to select both table.\nHow can i do it??</p>\n"},{"tags":["c#"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":3,"view_count":977,"score":-2,"question_id":2606206,"title":"Sending SMS using free gateway","body":"<p>I just wanted to develop one web application which allows users to send an SMS to any mobile free of charge . I searched on the net and found many codes and articles and through those articles i came to know that for that kind of application, i required either of the\nfollowing things:</p>\n\n<ol>\n<li>Web service (Third party web services that are free but not working or not delivering the sms)</li>\n<li>GSM Modem ( I don't have any idea about this)</li>\n<li>SMS Gateway ( I don't have any idea about plz suggest me a idea</li>\n</ol>\n"},{"tags":["c#","asp.net-mvc","appfabric"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":34,"score":2,"question_id":13260517,"title":"Caching MVC views in AppFabric manually","body":"<p>I am trying to recreate most of the functionality of the OutputCache action filter in MVC 4 by caching view result objects myself. The reason I don't want to use the OutputCache action filter is because I can't use it with AppFabric and partial views; partial views are always stored in MemoryCache and I want the cached objects to be used across a server farm.</p>\n\n<p>The first problem I have is </p>\n\n<pre><code>{\"Type 'System.Web.Mvc.TempDataDictionary' cannot be serialized. \nConsider marking it with the DataContractAttribute attribute, and marking all of \nits members you want serialized with the DataMemberAttribute attribute.  \nIf the type is a collection, consider marking it with the \nCollectionDataContractAttribute.  See the Microsoft .NET Framework documentation for  \nother supported types.\"}\n</code></pre>\n\n<p>This makes me wonder if I should cache something else to return what is essentially the view at the end. Does anyone have an idea of what I should cache instead to recreate the view or a different approach for caching partial views over a server farm? I do not want to use third party plugins for this.</p>\n\n<p>Thanks</p>\n\n<p>Update: I started caching the string representation of the partial view like so:</p>\n\n<pre><code>using (StringWriter sw = new StringWriter())\n        {\n            ViewEngineResult viewResult = ViewEngines.Engines.FindPartialView(ControllerContext, \"ViewName\");\n            ViewContext viewContext = new ViewContext(ControllerContext, viewResult.View, ViewData, TempData, sw);\n            viewResult.View.Render(viewContext, sw);\n            view = sw.GetStringBuilder().ToString();\n        }\n</code></pre>\n\n<p>This has made it easy to just retrieve the string in cache and return it as content in the action. I'm still looking for other suggestions or a better way to do this.</p>\n"},{"tags":["c#","asp.net-mvc","entity-framework","automapper"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13266570,"title":"Automapper - Returning right value but not mapping","body":"<p>In my MVC webapplication I got the following automapper code:</p>\n\n<p><strong>The configure:</strong></p>\n\n<pre><code> public static void Configure()\n        {\n            Mapper.CreateMap&lt;string, List&lt;Ruimte&gt;&gt;().ConvertUsing&lt;StringCombinatieRuimtesConverter&gt;();\n        }\n</code></pre>\n\n<p><strong>The custom converter:</strong></p>\n\n<pre><code>public class StringCombinatieRuimtesConverter : ITypeConverter&lt;string, List&lt;Ruimte&gt;&gt;\n    {\n        #region Implementation of ITypeConverter&lt;in string,out List&lt;Ruimte&gt;&gt;\n\n        public List&lt;Ruimte&gt; Convert(ResolutionContext context)\n        {\n            if (context.SourceValue == null)\n            {\n                return new List&lt;Ruimte&gt;();\n            }\n\n            return context.SourceValue.ToString().Split(',').Select(r =&gt; new Ruimte { Id = int.Parse(r) }).ToList();\n        }\n\n        #endregion\n    }\n</code></pre>\n\n<p><strong>And I call it with the following code:</strong></p>\n\n<pre><code>            var ruimteList = new List&lt;Ruimte&gt;();\n\n            // Update the CombinatieVan\n            Mapper.Map(command.CombinatieRuimteVan, ruimteList);\n</code></pre>\n\n<p>If I debug the command.CombinatieRuimteVan is: 2,3,4,6. This is fine.\nNow if I debug the converter it does return 4 objects of the class \"Ruimte\" with as Id the numbers stated before. But after the Mapper.Map method is done the \"ruimteList\" is still an empty list.</p>\n\n<p>Does anyone know what is going wrong here? The automapper works fine on another spot in my application where I automap a whole entity containing the \"CombinatieRuimteVan\" set. But when I sololy convert the string to the list it doesn't seem to work.</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13266916,"title":"How to pause a Threading.timer to complete a function","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/684200/synchronizing-a-timer-to-prevent-overlap\">Synchronizing a timer to prevent overlap</a>  </p>\n</blockquote>\n\n\n\n<p>I have a <code>Threading.Timer</code> in my class.</p>\n\n<pre><code> System.Threading.Timer timer;\n TimerCallback cb = new TimerCallback(ProcessTimerEvent);\n timer = new Timer(cb, reset, 1000, Convert.ToInt64(this.Interval.TotalSeconds));\n</code></pre>\n\n<p>and defined a callback for it.</p>\n\n<pre><code>private void ProcessTimerEvent(object obj)\n{\n  if(value)\n    MyFunction();\n}\n</code></pre>\n\n<p>When run it, re-running callback before <code>myfunction</code> to complete.</p>\n\n<p>How to pause <code>Threading.Timer</code> to complete <code>myfunction</code>?</p>\n"},{"tags":["c#","asp.net","vb.net"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":2170,"score":3,"question_id":2465681,"title":"How to encode a DateTime in a QueryString and read it in the asp:QueryStringParameter","body":"<p>How to encode a <code>DateTime</code> in a <code>QueryString</code> and read it in the <code>asp:QueryStringParameter</code>?</p>\n\n<p>out: \n(it's a <code>asp:HyperLink NavigateUrl</code>)</p>\n\n<pre><code>String.Format(\"~/Reports/Logs/Option_History.aspx?OptionID={0}&amp;time={1}\", _\n              id, _\n              time)\n</code></pre>\n\n<p>in:</p>\n\n<pre><code>&lt;asp:QueryStringParameter Name=\"time\" \n                          QueryStringField=\"Time\" \n                          Type=\"DateTime\" \n                          ConvertEmptyStringToNull=\"true\" /&gt;\n</code></pre>\n"},{"tags":["c#","windows-8","winrt-xaml"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13266995,"title":"Random Color Generation in particular range","body":"<p>I need to generate a random color for each item in my <code>gridview</code>. My requirement is that I must generate these colors between, for example, one shade of blue and another shade of blue. i.e. all colors must be within that range. I have a start color and an end color and I have a random object to generate bytes. How do I ensure that the colors generated stay within the given range? I need to write this in <code>C#</code> for <code>Windows 8</code>. The only color generation option it shows me in <code>Windows.UI.Color</code> is the <code>FromArgb</code> method. Any ideas on how I could achieve that?</p>\n"},{"tags":["c#","asp.net","wcf","restful-authentication","basichttpbinding"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13266932,"title":"The HTTP request is unauthorized with client authentication scheme 'Anonymous'?","body":"<p>While trying to invoke a RESTful service(i have used UserNameAuthenticator from this sample for RESTful service <a href=\"http://stackoverflow.com/questions/4715752/adding-basic-http-auth-to-a-wcf-rest-service\">Adding basic HTTP auth to a WCF REST service</a>) from my web client application am getting an error like   </p>\n\n<pre><code>The HTTP request is unauthorized with client authentication scheme 'Anonymous'. The authentication header received from the server was 'Basic Realm'.\n</code></pre>\n\n<p>Client CS code</p>\n\n<pre><code>BasicHttpBinding binding = new BasicHttpBinding();\nbinding.SendTimeout = TimeSpan.FromSeconds(25);\nbinding.Security.Transport.ClientCredentialType =\nHttpClientCredentialType.Basic;\nEndpointAddress address = new  EndpointAddress(\"http://localhost:12229/RestServiceImpl.svc\");\nChannelFactory&lt;RestService.IRestServiceImpl&gt; factory =\nnew ChannelFactory&lt;RestService.IRestServiceImpl&gt;(binding, address);\nRestService.IRestServiceImpl channel = factory.CreateChannel();\nchannel.GetStudent();\n</code></pre>\n\n<p>Client Web.config</p>\n\n<pre><code>&lt;system.serviceModel&gt;\n    &lt;services&gt;\n      &lt;service name=\"RestService.RestServiceImpl\"&gt;\n        &lt;endpoint address=\"http://localhost:12229/RestServiceImpl.svc\"\n          binding=\"basicHttpBinding\" bindingConfiguration=\"BasicHttpBinding_ExternalSystemsService_v1Interface\"\n          contract=\"RestService.IRestServiceImpl\"\n          name=\"ExternalSystemsService_v1Port\" /&gt;\n      &lt;/service&gt;\n    &lt;/services&gt;\n    &lt;bindings&gt;\n      &lt;basicHttpBinding&gt;\n        &lt;binding name=\"BasicHttpBinding_ExternalSystemsService_v1Interface\"\n                         closeTimeout=\"00:01:00\" openTimeout=\"00:01:00\" receiveTimeout=\"00:10:00\"\n                         sendTimeout=\"00:01:00\" allowCookies=\"false\" bypassProxyOnLocal=\"false\"\n                         hostNameComparisonMode=\"StrongWildcard\" maxBufferSize=\"65536\"\n                         maxBufferPoolSize=\"524288\" maxReceivedMessageSize=\"65536\"\n                         messageEncoding=\"Text\" textEncoding=\"utf-8\" transferMode=\"Buffered\"\n                         useDefaultWebProxy=\"true\"&gt;\n          &lt;readerQuotas maxDepth=\"32\" maxStringContentLength=\"8192\" maxArrayLength=\"16384\"\n              maxBytesPerRead=\"4096\" maxNameTableCharCount=\"16384\" /&gt;\n          &lt;security mode=\"TransportCredentialOnly\"&gt;\n            &lt;transport clientCredentialType=\"None\" proxyCredentialType=\"None\"\n                realm=\"\" /&gt;\n            &lt;message clientCredentialType=\"UserName\" algorithmSuite=\"Default\" /&gt;\n          &lt;/security&gt;\n        &lt;/binding&gt;\n      &lt;/basicHttpBinding&gt;\n    &lt;/bindings&gt;\n  &lt;/system.serviceModel&gt;\n</code></pre>\n\n<p>and RESTful service Web.config</p>\n\n<pre><code> &lt;system.serviceModel&gt;\n    &lt;bindings&gt;\n      &lt;basicHttpBinding&gt;\n        &lt;binding name=\"webHttpTransportSecurity\"&gt;\n          &lt;security mode=\"TransportCredentialOnly\"&gt;\n            &lt;transport clientCredentialType=\"None\" proxyCredentialType=\"None\" realm=\"\" /&gt;\n            &lt;message clientCredentialType=\"UserName\" algorithmSuite=\"Default\" /&gt;\n          &lt;/security&gt;\n          &lt;/binding&gt;\n      &lt;/basicHttpBinding&gt;\n    &lt;/bindings&gt;\n    &lt;services&gt;\n      &lt;service name=\"RestService.RestServiceImpl\"&gt;\n        &lt;endpoint name=\"ExternalSystemsService_v1Port\" address=\"\" binding=\"basicHttpBinding\" bindingConfiguration=\"BasicHttpBinding_ExternalSystemsService_v1Interface\" contract=\"RestService.IRestServiceImpl\"&gt;&lt;/endpoint&gt;\n      &lt;/service&gt;\n    &lt;/services&gt;\n    &lt;behaviors&gt;\n      &lt;endpointBehaviors&gt;\n        &lt;behavior&gt;\n          &lt;webHttp /&gt;\n        &lt;/behavior&gt;\n      &lt;/endpointBehaviors&gt;\n      &lt;serviceBehaviors&gt;\n        &lt;behavior name=\"SecureRESTSvcTestBehavior\"&gt;\n&lt;serviceMetadata httpGetEnabled=\"true\" httpsGetEnabled=\"false\" /&gt;\n          &lt;serviceDebug includeExceptionDetailInFaults=\"true\" /&gt;\n          &lt;serviceCredentials&gt;\n            &lt;userNameAuthentication userNamePasswordValidationMode=\"Custom\" customUserNamePasswordValidatorType=\"RESTfulSecuritySH.CustomUserNameValidator, RESTfulSecuritySH\" /&gt;\n          &lt;/serviceCredentials&gt;\n        &lt;/behavior&gt;\n      &lt;/serviceBehaviors&gt;\n    &lt;/behaviors&gt;\n    &lt;serviceHostingEnvironment multipleSiteBindingsEnabled=\"true\" /&gt;\n  &lt;/system.serviceModel&gt;\n</code></pre>\n\n<p>Any suggestion?</p>\n"},{"tags":["c#",".net","xml","comments"],"answer_count":6,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":2964,"score":5,"question_id":2875674,"title":"How to ignore comments when reading a XML file into a XmlDocument?","body":"<blockquote>\n  <p>Possible duplicate: <a href=\"http://stackoverflow.com/questions/1874132/how-to-remove-all-comment-tags-from-xmldocument\">How to remove all comment tags from XmlDocument</a></p>\n</blockquote>\n\n<p>Hello, I am trying to read a XML document with C#, I am doing it this way:</p>\n\n<pre><code>XmlDocument myData = new XmlDocument();\nmyData.Load(\"datafile.xml\");\n</code></pre>\n\n<p>anyway, I sometimes get comments when reading XmlNode.ChildNodes.</p>\n\n<p>For the benefit of who's experiencing the same requirement, here's how I did it at the end:</p>\n\n<pre><code>/** Validate a file, return a XmlDocument, exclude comments */\nprivate XmlDocument LoadAndValidate( String fileName )\n{\n    // Create XML reader settings\n    XmlReaderSettings settings = new XmlReaderSettings();\n    settings.IgnoreComments = true;                         // Exclude comments\n    settings.ProhibitDtd = false;                           \n    settings.ValidationType = ValidationType.DTD;           // Validation\n\n    // Create reader based on settings\n    XmlReader reader = XmlReader.Create(fileName, settings);\n\n    try {\n        // Will throw exception if document is invalid\n        XmlDocument document = new XmlDocument();\n        document.Load(reader);\n        return document;\n    } catch (XmlSchemaException) {\n        return null;\n    }\n}\n</code></pre>\n\n<p>Thank you<br />\nTommaso</p>\n"},{"tags":["c#","linq","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":79,"score":2,"question_id":13266580,"title":"Complex Linq c# query","body":"<p>I tried this in LinqPad</p>\n\n<p>I have the following data and linq query which should return only 1 record and 2 images but returns 2 records and 4 images. </p>\n\n<p>I know i have something wrong but don't know what. I am looking for the users details + car details + images fro user: 0b3c2ba5-1538-4557-a6c0-7de701fd83e7 </p>\n\n<p>It has something to do with the bids as when I delete one of he bids for user (0b3c2ba5-1538-4557-a6c0-7de701fd83e7 ) i then get 1 record and 2 images</p>\n\n<p><strong>TABLES<br>\n------</strong> </p>\n\n<h2>TABLE bids</h2>\n\n<pre><code>id      cardid  bidamount   dateplaced          usedid  \n\n43  83  625 2012-11-05 16:12:51.600 a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc  \n44  86  575 2012-11-05 16:15:02.257 a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc  \n45  83  650 2012-11-05 16:15:07.283 a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc  \n46  86  600 2012-11-05 17:45:04.140 a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc  \n47  86  625 2012-11-05 17:45:08.867 a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc  \n49  83  750 2012-11-07 13:40:37.590 0b3c2ba5-1538-4557-a6c0-7de701fd83e7  \n52  83  850 2012-11-08 13:40:37.590 0b3c2ba5-1538-4557-a6c0-7de701fd83e7 \n</code></pre>\n\n<h2>TABLE userdetails</h2>\n\n<pre><code>userid                                  city    state  \n0b3c2ba5-1538-4557-a6c0-7de701fd83e7    Sydney  NSW  \n</code></pre>\n\n<h2>TABLE cars</h2>\n\n<pre><code>id  name     descr   listingOption priceStarting priceReserve  \n83  Valiant  Old Car     2              1000         1500  \n86  Volvo    Safe Car    3              3000         4500 \n</code></pre>\n\n<h2>TABLE auction_images</h2>\n\n<pre><code>id         image                                              belongs_to  \n71  images/a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc/alpaca.JPG  83  \n72  images/a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc/a_bag.jpg   83  \n75  images/a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc/alpaca.JPG  86  \n76  images/a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc/a_bag.jpg   86  \n</code></pre>\n\n<p><strong>QUERY\n-----</strong></p>\n\n<pre><code> var query = (from c in cars\n                         from ud in users_details\n                         from bd in bids\n                         orderby c.listingOption descending\n                         where a.userID == ud.userid\n                        &amp;&amp; c.id == bd.carID\n                        &amp;&amp; c.enabled == true\n                        &amp;&amp; bd.userID == new Guid(\"0b3c2ba5-1538-4557-a6c0-7de701fd83e7\")\n                         let images = from ai in auction_images\n                                      where ai.belongs_to == c.id\n                                      select ai\n\n                         let bid = (from b in bids\n                                    orderby b.id descending\n                                    where b.carID == c.id\n                                    select b.bidamount).FirstOrDefault()\n                         select\n                         new\n                         {\n                             images,\n                             bidamount = (bid != null ? bid : 0),\n                             ud.city,\n                             ud.state,\n                             c.name,\n                             c.descr,\n                             c.id,\n                             c.listingOption,\n                             c.priceStarting,\n                             c.priceReserve,\n                             bd.userID\n                         }\n                         );\n\nquery.Distinct().Dump();\n</code></pre>\n"},{"tags":["c#","sms","sms-gateway"],"answer_count":3,"favorite_count":6,"up_vote_count":5,"down_vote_count":0,"view_count":1249,"score":5,"question_id":3524742,"title":"SMS Gateway for Windows + C#","body":"<p>I am a little confused with SMS and how to send them. I been searching around and I see you can purchase sms texts. I seen some where you get 10k text msgs for $490 but I find this very expensive and I am wonder if there is a better way that would be well free.</p>\n\n<p>I know many sites use have SMS reminders such as google calendar. I am sure google hosts there own server or something. </p>\n\n<p>I also know of alot smaller sites that charge $3/month for their service and one of the features in their service is to send you sms alerts. I highly doubt that they are paying 4cents at text and allow unlimited reminders.</p>\n\n<p>So is there a gateway that I can host myself that is free? Preferably something that works on windows machines.</p>\n\n<p>Or do these sites use like email to sms or something like that and thats how they get it for free?</p>\n\n<p>I am trying to figure out how to make it free on my end to send. I find it kinda stupid that services have to pay to send these messages. I would have figured it would be like email where you can send them for free.</p>\n\n<p>I understand the person receiving the SMS message might have to pay but that depends on their cell phone plan.</p>\n"},{"tags":["c#","winforms","autocomplete"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":203,"score":3,"question_id":12972761,"title":"textbox auto complete (Multi Line)","body":"<p>I am making a auto suggestion / complete textbox in C#, i followed below link, but text box isnt showing the suggestions</p>\n\n<p><a href=\"http://stackoverflow.com/questions/5648476/how-to-create-autosuggest-textbox-in-windows-forms\">How to create autosuggest textbox in windows forms?</a></p>\n\n<pre><code>//-------- Get all distinct description -----------------------------\nOleDbCommand command = new OleDbCommand(Queries.qry16, Connection);\nOleDbDataReader reader = command.ExecuteReader();\n\n//--------- Storing ------------------------------------\nwhile (reader.Read())\n{\n    namesCollection.Add(reader.GetValue(0).ToString());\n}\n\n//----------- Close after use ---------------------------------------\nreader.Close();\n\n//----------- Set the auto suggestion in description box ------------\ndescriptionBox.AutoCompleteMode = AutoCompleteMode.Suggest;\ndescriptionBox.AutoCompleteSource = AutoCompleteSource.CustomSource;\ndescriptionBox.AutoCompleteCustomSource = namesCollection;\n</code></pre>\n\n<p>Here is my code , it is in load function of winform. And the nameCollection initializtion is in constructor... kindly please help to make it working.</p>\n\n<p>I am editing my post rather then creating new... I have tried the my own code in single line textbox and it worked. Now i want the same in multi line... For research i googled more then 2 days trying different codes (one with intelli sense) but it didnt worked as auto suggestion available in textbox. Can any one give me suggestion to code the whole procedure to multi line.. Thank you.</p>\n"},{"tags":["c#",".net","pre-buildevent","app-globalresources"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13267077,"title":"Copy resx files to App_GlobalResources","body":"<p>I have two projects, first is MyPackag.Language project that holds all my resx files and some supporting classes. My other project is a web project that holds a Reference to MyPackage.Language project. When I build my web project I use the following Pre-Build event on my MyPackage.Language project:</p>\n\n<pre><code>mkdir \"$(ProjectDir)..\\..\\WebProj\\App_GlobalResources\\\" \ncopy \"$(ProjectDir)Resources\\*.resx\" \"$(ProjectDir)..\\..\\WebProj\\App_GlobalResources\\\"\n</code></pre>\n\n<p>All the resx files are copied into the App_GlobalResources folder in the web.\nMy problem: The web project cant find the resources files using:</p>\n\n<pre><code>&lt;asp:Label runat=\"server\" Text=\"&lt;%$ Resources: MyResourceFile, KeyName%&gt;\"&gt;&lt;/asp:Label&gt;\n</code></pre>\n\n<p>All the files are copied correctly and if i manuelly copy them before into VS2010 to the web project everything works as intended.</p>\n"},{"tags":["c#","xml","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":43,"score":0,"question_id":13266841,"title":"C# LINQ to XML: number of elements, that have two same attributes?","body":"<p>I have something like this:</p>\n\n<pre><code>&lt;Books&gt;\n    &lt;Book&gt;\n        &lt;Number&gt;\n        &lt;Title&gt;\n        &lt;Author&gt;\n        &lt;NumberOfCopies&gt;\n    &lt;/Book&gt;\n&lt;/Books&gt;\n</code></pre>\n\n<p>The <code>NumberOfCopies</code> element means how many same copies the library has of the same book. (Same books=same author, same title). The <code>Number</code> element is different for each book, it is for storing them in the library.</p>\n\n<p>When I add a new book, I would like to find out how many copies the library has.(int number) How to do this?</p>\n\n<pre><code>XDocument doc = XDocument.Load(\"books.xml\");\nvar q = from x in doc.Descendants(\"Books\")\n        where x.Element(\"Author\").Value == newBook.Author\n              &amp;&amp; x.Element(\"Title\").Value == newBook.Title\n        select x;\n\nint number = (int)q;\n</code></pre>\n\n<p>This doesn't work. What am I doing wrong?</p>\n"},{"tags":["c#",".net","aop"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":220,"score":0,"question_id":4760055,"title":"Dynamically building method/property bodies","body":"<p>So I've got this boilerplate code that I want to apply to a bunch of properties of certain classes, that is essentially identical for each one. Rather than have to type this same code out again and again for all of these properties, I was wondering if there was any way I could dynamically build these property methods either post-compile or at runtime, by assigning a C# attribute to the property that includes the slight difference for each method (a string) and then finding these properties by reflection.</p>\n\n<p>I'm aware of PostSharp, but I'm looking for something free or open source.</p>\n\n<p>For example, instead of having to do this:</p>\n\n<pre><code>public string Name {\n    get { return _member.GetValue( \"othername\" ); }\n    set { _member.SetValue( \"othername\", value ); }\n}\n</code></pre>\n\n<p>...for each property I have, I just want to say this:</p>\n\n<pre><code>[MapTo( \"othername\" )]\npublic string Name { get; set; }\n</code></pre>\n\n<p>Any thoughts?</p>\n"},{"tags":["c#","data-binding","collections"],"answer_count":3,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13265892,"title":"data binding of collections","body":"<p>I just want to bind one collection to another one:\nLets say there is a </p>\n\n<pre><code>List&lt;string&gt; original = new List&lt;string&gt;();\n</code></pre>\n\n<p>and there is a</p>\n\n<pre><code>List&lt;string&gt; extended = \n           new List&lt;string&gt;(from curItem in originals select curItem + \"_extension\");\n</code></pre>\n\n<p>So the items of the extended are just the same than the original's but with an \"_extension\" at the end.</p>\n\n<p>What I want is to bind the extended to the original, so that if the original becomes changed, the extended also changes.</p>\n\n<p>I know I could use events and recreate the extended every time. \nBut I think this is not efficient.</p>\n\n<p>Edit:\nLets say: original is large and it is too exhausting to recreate the single elements of the extended and its also exhausting to create a single element at all.\nSo I want to have two lists (or collections) where on observes the other one and adds or removes the changes, like the data binding in Wpf, but adding an extension.</p>\n"},{"tags":["c#","asp.net","web-applications"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13262804,"title":"Upload from server db and open file on client machine","body":"<p>How to organize a file downloading from server database and open it on the client machine?</p>\n\n<p>my code works only when the page is opened on the server:</p>\n\n<pre><code>        OracleCommand oracleCom = new OracleCommand();\n        oracleCom.Connection = oraConnect;\n        oracleCom.CommandText = \"Select m_content, f_extension From \" + Session[\"tableNameIns\"] +\n                                            \" where i_id = \" + rowData;\n        OracleDataAdapter adapter = new OracleDataAdapter();\n        DataTable tableD = new DataTable();\n        tableD.Locale = System.Globalization.CultureInfo.InvariantCulture;\n        adapter.SelectCommand = oracleCom;\n        adapter.Fill(tableD);\n\n        string FileName = Path.GetTempPath();\n        FileName += \"tempfile\" + tableD.Rows[0][1];\n\n        byte[] file = new byte[0];\n        file = (byte[])tableD.Rows[0][0];\n        FileStream fs = new FileStream(FileName, FileMode.OpenOrCreate, FileAccess.Write);\n        fs.Write(file, 0, file.GetUpperBound(0) + 1);\n        fs.Close();\n        System.Diagnostics.Process.Start(FileName);\n</code></pre>\n"},{"tags":["c#","winforms","serialization","designer","initializecomponent"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":263,"score":1,"question_id":10272123,"title":"How can I customize the code generation of InitializeComponent? More specifically, how can I post-process all of the generated code?","body":"<p>I'm trying to customize the Windows Forms Designer's code generation for <code>InitializeComponent</code>. The MSDN article <a href=\"http://msdn.microsoft.com/en-us/library/ms973818.aspx\" rel=\"nofollow\" title=\"MSDN article: 'Customizing Code Generation in the .NET Framework Visual Designers'\">\"Customizing Code Generation in the .NET Framework Visual Designers\"</a> contains a section <a href=\"http://msdn.microsoft.com/en-us/library/ms973818.aspx#custcodegen_topic8\" rel=\"nofollow\" title=\"MSDN article: 'Customizing Code Generation in the .NET Framework Visual Designers', section 'Controlling Code Generation'\">\"Controlling Code Generation\"</a> that explains the basics of how this can be done.</p>\n\n<p>I've closely followed an example in the above article:</p>\n\n<pre><code>//using System.ComponentModel.Design.Serialization;\n\nclass SomeFormSerializer : CodeDomSerializer\n{\n    public override object Serialize(IDesignerSerializationManager manager,\n                                     object value)\n    {\n        // first, let the default serializer do its work:\n        var baseSerializer = (CodeDomSerializer)manager.GetSerializer(\n                             typeof(Form).BaseType, typeof(CodeDomSerializer));\n        object codeObject = baseSerializer.Serialize(manager, value);\n\n        // then, modify the generated CodeDOM -- add a comment as the 1st line:\n        if (codeObject is CodeStatementCollection)\n        {\n            var statements = (CodeStatementCollection)codeObject;\n            statements.Insert(0, new CodeCommentStatement(\"CODEDOM WAS HERE\"));\n        }\n\n        // finally, return the modified CodeDOM:\n        return codeObject;\n    }\n}\n</code></pre>\n\n<p>Now I hook this up to my form <code>SomeForm</code>:</p>\n\n<pre><code>[DesignerSerializer(typeof(SomeFormSerializer), typeof(CodeDomSerializer))]\nclass SomeForm : Form { … }\n</code></pre>\n\n<p>The Forms Designer might then generate the following <code>InitializeComponent</code> code:</p>\n\n<pre><code>private void InitializeComponent()\n{\n    … /* (general setup code, such as a call to `this.SuspendLayout`) */ \n\n    // \n    // someButton\n    // \n    … /* (someButton's properties are set) */\n\n    // CODEDOM WAS HERE!\n    // \n    // SomeForm\n    // \n    … /* (form's properties are set) */\n\n    … /* (general setup code, such as a call to `this.ResumeLayout`) */ \n}\n</code></pre>\n\n<p>Note that the comment <code>// CODEDOM WAS HERE</code> was not added as the very first line in <code>InitializeComponent</code>, but only as the first line of the code block that deals with the properties of the form object itself.</p>\n\n<p>What would I have to do if I wanted to be able to modify the generated CodeDOM of the whole method, and not just of the part that deals with a specific object? </p>\n\n<blockquote>\n  <p><strong>Background: Why do I want to do this?</strong> In Windows Forms, if one wants flexible value conversion during data binding, one usually has to resort to subscribing to the <code>Format</code> and <code>Parse</code> events of some particular <code>Binding</code> object. So I'm creating a specialized <code>Binding</code> subclass (let's call it <code>ConvertingBinding</code>) that simplifies this process a bit.</p>\n  \n  <p>Now, the issue is that when data bindings are set up in the Windows Forms Designer, the generated code creates instances of <code>Binding</code>; however, I would want the designer to instantiate my specialized subclass instead. My current approach is to let the designer create a CodeDOM tree first, then walk that tree and replace all instantiations of <code>Binding</code> by instantiations of <code>ConvertingBinding</code>.</p>\n</blockquote>\n"},{"tags":["c#","visual-studio-2010",".net-4.0"],"answer_count":4,"favorite_count":0,"up_vote_count":6,"down_vote_count":1,"view_count":79,"score":5,"question_id":13266397,"title":"What is the most optimal method of checking if a string is empty?","body":"<p>To check whether a string is empty I use</p>\n\n<pre><code>var test = string.Empty; \nif (test.Length == 0) Console.WriteLine(\"String is empty!\");\nif (!(test.Any())) Console.WriteLine(\"String is empty!\");\nif (test.Count() == 0) Console.WriteLine(\"String is empty!\");\nif (String.IsNullOrWhiteSpace(test)) Console.WriteLine(\"String is empty!\");\n</code></pre>\n\n<ol>\n<li><p>All the above statements produces the same output. What is the optimal method that I should use?</p>\n\n<pre><code>var s = Convert.ToString(test);    \ns = test.ToString(CultureInfo.InvariantCulture);\n</code></pre></li>\n<li><p>Again, both statements does the same thing. What is the best method to use?</p></li>\n</ol>\n\n<p>I tried debugging and how to benchmark the performance of a C# statement?</p>\n"},{"tags":["c#","xml","asp.net-mvc"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13262279,"title":"Populate KeyValue Model from XML File in .Net MVC","body":"<p>I have a database model with several KeyValue entities where values will not change often.  Rather than storing this data in a database, I am hoping to store in a code file or xml file.  I was wondering how I can get a list of these KeyValues through my application.  I was thinking an XML file in app_data folder would be ideal, but I don't know who to consume such a file through a model class.  Maybe there is a better alternative?</p>\n"},{"tags":["c#","xml","file"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13266496,"title":"Easily write a whole class instance to XML File and read back in","body":"<p>I have a main class called <code>theGarage</code>, which contains instances of  our customer, supplier, and jobs classes.</p>\n\n<p>I want to save the program data to an XML file, I have used the code below (just a snippet, I have matching code for the other classes). I am wondering if there is an easier way for me to do this, like write the whole theGarage class to an XML file and read it in without having to write all this code like I have below. </p>\n\n<pre><code>   public void saveToFile()\n    {\n        using (XmlWriter writer = XmlWriter.Create(\"theGarage.xml\"))\n        {\n            writer.WriteStartDocument();\n\n            ///\n            writer.WriteStartElement(\"theGarage\");\n            writer.WriteStartElement(\"Customers\");\n\n            foreach (Customer Customer in Program.theGarage.Customers)\n            {\n                writer.WriteStartElement(\"Customer\");\n                writer.WriteElementString(\"FirstName\", Customer.FirstName);\n                writer.WriteElementString(\"LastName\", Customer.LastName);\n                writer.WriteElementString(\"Address1\", Customer.Address1);\n                writer.WriteElementString(\"Address2\", Customer.Address2);\n                writer.WriteElementString(\"Town\", Customer.Town);\n                writer.WriteElementString(\"County\", Customer.County);\n                writer.WriteElementString(\"PostCode\", Customer.Postcode);\n                writer.WriteElementString(\"TelephoneHome\", Customer.TelephoneHome);\n                writer.WriteElementString(\"TelephoneMob\", Customer.TelephoneMob);\n\n                //begin vehicle list\n                writer.WriteStartElement(\"Vehicles\");\n\n                foreach (Vehicle Vehicle in Customer.Cars)\n                {\n                    writer.WriteStartElement(\"Vehicle\");\n                    writer.WriteElementString(\"Make\", Vehicle.Make);\n                    writer.WriteElementString(\"Model\", Vehicle.Model);\n                    writer.WriteElementString(\"Colour\", Vehicle.Colour);\n                    writer.WriteElementString(\"EngineSize\", Vehicle.EngineSize);\n                    writer.WriteElementString(\"Registration\", Vehicle.Registration);\n                    writer.WriteElementString(\"Year\", Vehicle.YearOfFirstReg);\n                    writer.WriteEndElement();\n                }\n                writer.WriteEndElement();\n                writer.WriteEndElement();\n            }\n        }\n    }\n</code></pre>\n"},{"tags":["c#",".net","rest","asp.net-web-api"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":73,"score":3,"question_id":13223470,"title":"Backward compatibility in a RESTful API","body":"<p>I am currently designing an RESTful API implemented using the ASP.NET Web API.<br>\nOne very important point is backward compatibility.<br>\nI would like to keep the actual API code free of any thoughts about backward compatibility, to ensure clean and up-to-date design.<br>\nI thought about solving this by having a layer of version translators.<br>\nEach of these translators knows how to transform the requests and responses of one specific version (vPrevious) into those of another specific version (vCurrent).<br>\nThese translators could easily be stacked to ensure backward compatibility with an arbitrary number of old versions.<br>\nEach of these translators would be responsible for doing all kinds of stuff, like setting default values for new properties or even performing an array of different operations.</p>\n\n<p>I thought about implementing a <code>DelegatingHandler</code> that examines the version number of the API the client wants to use and based on that knows which translators to use.<br>\nHowever, I fail to see how I would actually go about implementing this.\nAs I see it, each translator actually needs to be a full blown ASP.NET Web API of its own, along with a routing table and controllers. That actually would be acceptable, but how would that translator controller route the data to the next one in the chain?</p>\n"},{"tags":["c#","unit-testing","enterprise-library"],"answer_count":6,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":15309,"score":4,"question_id":4030436,"title":"Activation error occured while trying to get instance of type Database, key \"\" <-- blank","body":"<p>I'm trying out the Enterprise Library 5.0 and was doing some unit-tests on my BL, do I need to have a app.config on the DL or on the Test project?</p>\n\n<p>note: I already have the configuration settings on my web.config on my web project.</p>\n\n<p><strong>how I use the DAAB:</strong></p>\n\n<pre><code>private static Database db = DatabaseFactory.CreateDatabase();\n\ndb.ExecuteNonQuery(\"spInsertSalesman\", salesman.Fullname);\n</code></pre>\n\n<p><strong>my app.config on DL:</strong></p>\n\n<pre><code>&lt;configuration&gt;\n    &lt;configSections&gt;\n        &lt;section name=\"dataConfiguration\" type=\"Microsoft.Practices.EnterpriseLibrary.Data.Configuration.DatabaseSettings, Microsoft.Practices.EnterpriseLibrary.Data, Version=5.0.414.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" requirePermission=\"false\" /&gt;\n    &lt;/configSections&gt;\n    &lt;dataConfiguration defaultDatabase=\"DBTEST\" /&gt;\n    &lt;connectionStrings&gt;\n        &lt;add name=\"DBTEST\" connectionString=\"Data Source=[dbsource];Initial Catalog=[dbname];User Id=sa;Password=password;\"\n            providerName=\"System.Data.SqlClient\" /&gt;\n    &lt;/connectionStrings&gt;\n&lt;/configuration&gt;\n</code></pre>\n"},{"tags":["c#","visual-studio-2010","passwords"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13265694,"title":"Login Page C# (Inconsistency)","body":"<p>I am doing a login page that makes use of controller and login form. When i enter a invalid username i am not able to login. But when i just enter my username and a wrong password.. i am allowed to login. What is wrong with my codes?</p>\n\n<p><strong>User Controller Codes</strong></p>\n\n<pre><code> using System;\n using System.Collections.Generic;\n using System.Linq;\n using System.Text;\n using System.Data;\n using System.Data.OleDb;\n using System.Data.SqlClient;\n using System.Windows.Forms;\n using System.Security.Cryptography;\n using System.IO;\n\n namespace Privacy_Biometric_Defender\n{\nclass UserController{\n    User[] user;\n    User searchUser;\n    DataRowCollection rows;\n    DataSet uds;\n    OleDbDataAdapter dbAdapter;\n    DataTable userTable;\n\n    //A kind of gobal var to share in project\n    public static string uNameExist;\n    public static string passwordExist;\n    public static string roleExist;\n\n    public UserController(){\n\n    // Set up Connection String\n    OleDbConnection dbConn = new OleDbConnection(\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=PrivacyDefenderDatabase.mdb\");\n\n    // Setup SQL select statement\n    string sqlStatement = \"Select * from [User]\";\n\n    // Setup DBAdapter (Scientist Table)\n\n    dbAdapter = new OleDbDataAdapter(sqlStatement, dbConn);\n    OleDbCommandBuilder OrderDetailsCmdBuilder = new OleDbCommandBuilder(dbAdapter);\n\n    // Create a Data Set to hold data from DB\n    uds = new DataSet();\n\n    // fill ds with data from DB\n    dbAdapter.Fill(uds);\n\n    // get contacts table\n    DataTable userTab = uds.Tables[0];\n\n    // get all rows\n    rows = userTab.Rows;\n    }\n\n    public User[] GetAllUsers()\n    {\n        DataRow row;\n\n        user = new User[rows.Count];\n\n        for (int i = 0; i &lt; rows.Count; ++i)\n        {\n            row = rows[i];\n            user[i] = new User();\n            user[i].SetId((Int32)row[\"ID\"]);\n            user[i].SetEmployeeID((string)row[\"EmployeeID\"]);\n            user[i].SetUsername((string)row[\"Username\"]);\n            user[i].SetFName((string)row[\"FName\"]);\n            user[i].SetLName((string)row[\"LName\"]);\n            user[i].SetPassword((string)row[\"Password\"]);\n            user[i].SetEmail((string)row[\"Email\"]);\n            user[i].SetContact((Int32)row[\"Contact\"]);\n            user[i].SetRole((string)row[\"Roles\"]);\n        }\n        return user;\n    }\n\n    public User SearchUser(string uname)\n    {\n        searchUser = new User();\n\n        //get all rows from DB\n        GetAllUsers();\n        for (int i = 0; i &lt; rows.Count; ++i)\n        {\n            if (user[i].GetUsername() == uname)\n            {\n                searchUser.SetId(user[i].GetId());\n                searchUser.SetEmployeeID(user[i].GetEmployeeID());\n                searchUser.SetUsername(user[i].GetUsername());\n                searchUser.SetFName(user[i].GetFName());\n                searchUser.SetLName(user[i].GetLName());\n                searchUser.SetPassword(user[i].GetPassword());\n                searchUser.SetEmail(user[i].GetEmail());\n                searchUser.SetContact(user[i].GetContact());\n                searchUser.SetRole(user[i].GetRole());\n            }\n        }\n        return searchUser;\n    }\n\n    public User SearchUserName(string userName)\n    {\n    User searchUserName = new User();\n\n    //get all rows from DB\n    GetAllUsers();\n    for (int i = 0; i &lt; rows.Count; ++i)\n    {\n        //Get UserName to store in this container\n        string checkUname = user[i].GetUsername();\n        if (checkUname == userName)\n        {\n            uNameExist = \"Exists\";\n            roleExist = user[i].GetRole();\n        }\n    }\n    return searchUserName;\n    }\n\n    // Search password for Login function\n    public User SearchPassword(string password)\n    {\n    User searchPassword = new User();\n\n    //get all rows from DB\n    GetAllUsers();\n    for (int i = 0; i &lt; rows.Count; ++i)\n    {\n        //Get password to store in this container\n\n        string checkPassword = user[i].GetPassword();\n        if (checkPassword == password)\n        {\n            passwordExist = \"Exists\";\n        }\n    }\n    return searchPassword;\n}\n    public static string GetSHA512(string text)\n    {\n        UnicodeEncoding UE = new UnicodeEncoding();\n        byte[] hashValue;\n        byte[] message = UE.GetBytes(text);\n\n        SHA512Managed hashString = new SHA512Managed();\n        string hex = \"\";\n\n        hashValue = hashString.ComputeHash(message);\n        foreach (byte x in hashValue)\n        {\n            hex += String.Format(\"{0:x2}\", x);\n        }\n        return hex;\n    }\n\n\n}\n\n}\n</code></pre>\n\n<p><strong>Login Page: Form</strong></p>\n\n<pre><code>    private void LoginButton_Click(object sender, EventArgs e)\n    {\n        string userName = this.LoginUsernameTextBox.Text;\n        UserController cont1 = new UserController();\n        User SearchUserName = new User();\n        // Passing textbox input to Controller\n        fixedUName = LoginUsernameTextBox.Text;\n        SearchUserName = cont1.SearchUserName(userName);\n\n        string passwd = this.LoginPasswordTextBox.Text;\n        UserController cont2 = new UserController();\n        User SearchPassword = new User();\n        // Passing textbox input to Controller\n        SearchPassword = cont2.SearchPassword(passwd);\n\n        // Collect information from Controller\n        string checkUnameExist = UserController.uNameExist;\n        string checkPasswordExist = UserController.passwordExist;\n        string checkRoleExist = UserController.roleExist;\n\n        if (checkPasswordExist == \"Exists\" &amp;&amp; checkUnameExist == \"Exists\")\n        { \n            MessageBox.Show(\"Login Successfully\");\n        }\n        else\n        {\n            MessageBox.Show(\"Login Unsuccessfully!\");\n        }   \n    }\n</code></pre>\n"},{"tags":["c#","windows-8","microsoft-metro"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13266475,"title":"Missing larger/smaller option for Windows Live Tile","body":"<p>I am referring to <a href=\"http://code.msdn.microsoft.com/windowsapps/app-tiles-and-badges-sample-5fc49148\" rel=\"nofollow\">App tiles and badges sample</a></p>\n\n<p>By running the sample, and right click on the icon, I realize I can have larger/smaller option.</p>\n\n<p><img src=\"http://i.stack.imgur.com/fYc6g.png\" alt=\"enter image description here\"></p>\n\n<p>However, for my own project, I cannot find such option.</p>\n\n<p><img src=\"http://i.stack.imgur.com/5cWYJ.png\" alt=\"App tiles and badges sample\"></p>\n\n<p>I go through all settings in the project sample but unable to figure out differences. I would like to have my project having larger/smaller option. Is there anything I had missed out?</p>\n"},{"tags":["c#","datetime"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":86,"score":3,"question_id":13264038,"title":"C# Month and Day Occurrence in between the dates","body":"<p>I've a Month and day list and i need to search each month and day in this list in between the given dates. Can any one suggest me to do best way to get desired output.</p>\n\n<p>Eg:   </p>\n\n<blockquote>\n  <p>Month day list -> 01/11, 03/15, 05/25, 09/01</p>\n  \n  <p>Between dates -> 01/01/2012 to 07/01/13</p>\n</blockquote>\n\n<p>Expected result: </p>\n\n<blockquote>\n  <p>01/11/2012, 01/11/2013</p>\n  \n  <p>03/15/2012, 03/15/2013</p>\n  \n  <p>05/25/2012, 05/25/2013</p>\n  \n  <p>09/01/2012</p>\n</blockquote>\n\n<p>I tried like this but it gives memory exception and time and memory complexity increases if from date and to date having number of years gap, is there any quick solution to get it?</p>\n\n<pre><code>DateTime[] dateDates = new DateTime[dateTypeList.Rows.Count];\n//convert strings to datetimes:\nfor (int i = 0; i &lt; dateTypeList.Rows.Count; i++)\n{\n    dateDates[i] = Convert.ToDateTime(Convert.ToDateTime(string.Format(\"{0}/{1}\", Convert.ToInt32(dateTypeList.Rows[i][\"Month\"]), Convert.ToInt32(dateTypeList.Rows[i][\"Day\"]))));\n}\n\n//define start and end time:\nDateTime dateStart = new DateTime(2012, 1, 1);\nDateTime dateEnd = new DateTime(2013, 7, 1);\n\nList&lt;DateTime&gt; results = new List&lt;DateTime&gt;();\n//loop days between start and end time:\nfor (DateTime a = dateStart; a &lt;= dateEnd; a.AddDays(1))\n{\n    for (int i = 0; i &lt; dateDates.Length; i++)\n    {\n        if (dateDates[i] == a)\n        {\n            results.Add(a);\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","sms","way2sms"],"answer_count":7,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":7032,"score":0,"question_id":1590353,"title":"sending sms through way2sms help needed","body":"<p>I am building a desktop app in Visual C# 2.0 that can send sms through way2sms.com. anyone of you ve tried such thing...? please help.</p>\n"},{"tags":["c#","wpf","datagrid","colors"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13251789,"title":"WPF datagrid change color when text change","body":"<p>I want to change the color of the cell in a datagrid when the user changes the text or content of that cell.</p>\n\n<p>I am using WPF an C#.</p>\n\n<p>I have a simple datagrid: </p>\n\n<pre><code>&lt;DataGrid x:Name=\"dataGrid1\" Grid.RowSpan=\"2\" Margin=\"5\" ItemsSource=\"{Binding Source=Horreos}\" KeyDown=\"dataGrid1_KeyDown\" SelectedCellsChanged=\"dataGrid1_SelectedCellsChanged\"&gt; &lt;DataGrid.Columns &gt; &lt;/DataGrid.Columns&gt; &lt;/DataGrid&gt; \n</code></pre>\n\n<p>This events: keydown and selectedcellschange are tests for change my color cell. In the .cs I tried changing the cel.... but I failed.</p>\n\n<p><strong>I need an event that is released when the content changes</strong></p>\n"},{"tags":["c#","asp.net","iis","web-applications"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":137,"score":0,"question_id":13162545,"title":"Handler \"ExtensionlessUrlHandler-Integrated-4.0\" has a bad module \"ManagedPipelineHandler\" in its module list","body":"<p>To be honest, I've tried to turn a dirty trick on IIS and just when I thought that I was going to get away with it, I realized my workaround doesn't work. Here's what I've tried to do:</p>\n\n<p>1) I have ASP.NET application which has <strong>Preloader</strong> class that inherits <strong>IProcessHostPreloadClient</strong> and does all the heavy initialization in <em>Preload</em> method implementation (application is complex and it's a part of an enormous system, so it requires approximately 2 minutes to establish connections to all necessary services and pre-instantiate some Unity registrations).</p>\n\n<p>2) I have a lot of work that needs to be done on application shutdown (unsubscribing, disconnecting, disposing,...), and I guess the best place to do it is in *Application_End* method located in <strong>Global.asax</strong>.</p>\n\n<p>3) Everything works just fine when I have user activity (first request after the Application Pool that contains aforementioned web application is started will cause *Application_Start* to be called and afterwards *Application_End* is called on Application Pool stop or recycle), but problems occur when there is no user activity and application tries to restart itself after being active for 48 hours (configured requirement). Since there was no requests, application officially didn't get started. Ergo, it can't be gracefully stopped since *Application_End* won't be called.</p>\n\n<p>4) Now comes the messy part... I've tried to make a GET request from code at the end of the <em>Preload</em> method, and it worked. But this solution seemed bad to me, even though it worked. So, I've tried a lot of things, and the last thing I tried was this:</p>\n\n<pre><code>SimpleWorkerRequest swr = new SimpleWorkerRequest(string.Empty, string.Empty, tw);\nHttpRuntime.ProcessRequest(swr);\n</code></pre>\n\n<p>... and that has done it's purpose. *Application_Start* was called, (I've checked response, it was containing login page that was supposed to be displayed in initial request) and on Application Pool shutdown application ended gracefully by doing necessary work in *Application_End*.</p>\n\n<p><strong>BUT</strong></p>\n\n<p>After the application was started (preloaded and initiated) in this manner, this is what happened when I wanted to reach application via Web browser:</p>\n\n<blockquote>\n  <p>HTTP Error 500.21 - Internal Server Error\n  Handler \"ExtensionlessUrlHandler-Integrated-4.0\" has a bad module \"ManagedPipelineHandler\" in its module list</p>\n</blockquote>\n\n<p>I am unable to figure this out. Can anybody tell me why this happens and how to fix it?</p>\n\n<p>If I don't figure this out, I will go back to first solution (sending GET request from code) but this problem will bug me since I don't even have an idea what's wrong.</p>\n"},{"tags":["c#","web-services","header","service-reference","c#-4.5"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13266468,"title":"Add Header to the Simple Web Service Request","body":"<p>I have a Console application, I add a Web reference simply by write click and use \"Add Service Reference\", then my .Config file changed to:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;configuration&gt;\n    &lt;system.serviceModel&gt;\n        &lt;bindings&gt;\n            &lt;basicHttpBinding&gt;\n                &lt;binding name=\"FServiceSoapBinding\" /&gt;\n            &lt;/basicHttpBinding&gt;\n        &lt;/bindings&gt;\n        &lt;client&gt;\n            &lt;endpoint address=\"http://ServiceAdd/FService\" binding=\"basicHttpBinding\"\n                bindingConfiguration=\"FServiceSoapBinding\" contract=\"MyReference.MService_\"\n                name=\"FServicePort\" /&gt;\n        &lt;/client&gt;\n    &lt;/system.serviceModel&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>So, every thing is fine and it seems I can use the service successfully, but the service documentation said I need set username and password on the header of the requests, and this is the example of the documentation:</p>\n\n<pre><code>&lt;soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"\nxmlns:web=\"http://namespace.com/\"&gt;\n  &lt;soapenv:Header&gt;\n    &lt;Account&gt;\n      &lt;username&gt;user&lt;/username&gt;\n      &lt;password&gt;password&lt;/password&gt;\n    &lt;/Account&gt;\n  &lt;/soapenv:Header&gt;\n  &lt;soapenv:Body&gt;\n    &lt;web:oneofservicemethods&gt;\n      &lt;items&gt;\n        &lt;item&gt;...&lt;/item&gt;\n      &lt;/items&gt;\n    &lt;/web:oneofservicemethods&gt;\n  &lt;/soapenv:Body&gt;\n&lt;/soapenv:Envelope&gt;\n</code></pre>\n\n<p>So How can I add username and password to the header? any suggestion?</p>\n"},{"tags":["c#",".net","wpf","winapi"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2951,"score":0,"question_id":1776382,"title":"How do I remove the icon and title from a WPF Window but display it in the taskbar?","body":"<p>I'm trying to create a WPF window, which has no icon and no title displayed in the titlebar.</p>\n\n<p>I already found some examples how the icon can be removed (for example <a href=\"http://www.danrigsby.com/blog/index.php/2008/05/26/remove-icon-from-wpf-window/\" rel=\"nofollow\">here</a>), but all these solutions work if I'm debugging the application in Visual Studio but they don't work when I'm just running the executable.</p>\n\n<p>I would also like the title not to be shown. Of course I could leave the title blank, but I would like the title to be disyplayed in the taskbar (similiar to what Windows Explorer does in Vista/7)</p>\n"},{"tags":["c#","windows-7","wifi"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13266704,"title":"View information on stored wifi profiles and keys","body":"<p>How can I get a list of stored wifi profiles, and their keys?</p>\n"},{"tags":["c#","pdf-generation","blur"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13266687,"title":"Transform a nice pdf into a blurry pdf in c#","body":"<p>I have a pdf file and I want to modify or create a similar pdf but blurry, foggy or ugly. It is possible to do this in c#? I have no idea how can do this so any indication will be welcomed:).</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","windows-8","winrt","oauth-2.0","windows-store-apps"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":13140663,"title":"WinRT - OAuth2 get access token","body":"<p>I am trying to create a Windows Store app which needs an authentication through OAuth2.</p>\n\n<p>Prefered way should be WebAuthenticationBroker:</p>\n\n<pre><code>const string url = @\"https://my.server.srv/mobile-auth/index.pl?\"\n                          + \"client_id=CLIENTID\"\n                           + \"&amp;redirect_uri=https%3A%2F%2Fmy.server.srv\n                           + \"&amp;response_type=code\"\n\nUri startUri = new Uri(url);\nUri endUri = new Uri(\"https://my.server.srv\");\n\nWebAuthenticationResult webAuthenticationResult = await WebAuthenticationBroker.AuthenticateAsync(WebAuthenticationOptions.None, startUri, endUri);\nif (webAuthenticationResult.ResponseStatus == WebAuthenticationStatus.Success)\n{\n    string token = webAuthenticationResult.ResponseData;\n}\n</code></pre>\n\n<p>but the token is empty. There should be the server response, which is</p>\n\n<pre><code>code=a-secret-code&amp;expires_in=600&amp;token_type=bearer\n</code></pre>\n\n<p>passed in GET, which is compilant to OAuth2.</p>\n\n<p>Do you know how to get that parameters, please?</p>\n\n<p><strong>EDIT:</strong> SOLVED. It started to work after passing \"https://localhost\" as redirect_uri / endUri.</p>\n"},{"tags":["c#","windows-8","file-access"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13266423,"title":"Windows 8 App and access to file system","body":"<p>I'm at the beginning of my project and I wonder which technology I should use.\nIn my little research I found WinRT API being kind of pleasant and I really like tile grid concept in UI.</p>\n\n<p>The only problem is that my app will generate tons of data - important data - which I have to store somewhere on the local machine. By 'somewhere' I mean use of a different partition than the OS.</p>\n\n<p>So, why not to try this simple code.</p>\n\n<pre><code>await Windows.Storage.PathIO.WriteTextAsync(@\"d:\\tests\\test.txt\", \"Hello World\");\n</code></pre>\n\n<p>Because <code>E_ACCESSDENIED</code>, that's why. Windows 8 slaps me in face screaming \"Access Denied\".</p>\n\n<p>Is there any way I can store my data in a way I like or <code>Win8</code> is too <code>h4x0r</code> proof?</p>\n\n<p>And no, \"Make a desktop application\" is not a correct answer.</p>\n"},{"tags":["c#","asp.net","html"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13266409,"title":"Conditional writing of HTML","body":"<p>I am currently trying to create a statement where if it returns false then a label will display on the page with an error message. I have tried using <code>Response.Write</code> with no results.</p>\n\n<pre><code>if (bannedDomainText.Text.Contains(\".\"))\n    File.AppendAllText(MapPath(FILE_PATH), \"\\r\\n\" + bannedDomainText.Text);\nelse\n    Response.Write(\"&lt;label&gt;This isn't working!&lt;/label&gt;\");\n</code></pre>\n"},{"tags":["c#","data-structures","dictionary","path","trie"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13230439,"title":"Efficient data structure for associating data with filesystem paths?","body":"<p>I need to keep some data in memory about a possibly large number of files and directories (typically up to a few hundreds of thousands). The obvious approach is to use a <code>Dictionary&lt;string, Something&gt;</code> with the path as the key, but there are two problems with this:</p>\n\n<ul>\n<li>many of the files will have a large part of their path in common, so it's probably a waste of memory to store the full path of each file</li>\n<li>I need to be able to quickly access the data about all the descendants of a directory; with a dictionary, the only way to do this is to test each key and check if it starts with the specified path, which is quite inefficient</li>\n</ul>\n\n<p>This problem seems like a good candidate for using a prefix tree (or <a href=\"http://en.wikipedia.org/wiki/Trie\" rel=\"nofollow\">trie</a>), with segments of the path as \"characters\". I tried to implement it, and the performance is not too bad for lookup by prefix (about 4 times faster than a dictionary), but it has two issues:</p>\n\n<ul>\n<li>the memory consumption is not reduced, probably because of the overhead of the list of children for each node</li>\n<li>the construction time is much worse than with a dictionary (about 4 times slower to fill the collection)</li>\n</ul>\n\n<p>I'm sure it must be a very common problem, so perhaps there are well known solutions that I'm not aware of?</p>\n"},{"tags":["c#","asp.net","ldap"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13266563,"title":"Get all the displaynames that matches with the user provided name from ldap in grid in asp.net c#","body":"<p>Am working with ldap. I have a textbox where the user types a name. On click of a button i need to get all names that matches the user name in a grid so that the user can select the name he wants. Is it possible to do so.I havent impleted this part of the code yet. Below is the code till this part. Any suggestions will be of great help.Thank you.</p>\n\n<pre><code>    &lt;div id=\"show\" runat=\"server\"&gt;\n&lt;asp:Label ID=\"lbl1\" runat=\"server\" Text=\"Display Name:\"&gt;&lt;/asp:Label&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;\n&lt;asp:TextBox ID=\"txtdisname\" runat=\"server\" Width=\"202px\" Height=\"25px\"&gt;&lt;/asp:TextBox&gt;\n\n\n        &lt;asp:Label id=\"Label4\" runat=\"server\"&gt;&lt;/asp:Label&gt;\n       &lt;asp:Button ID=\"Button2\" Text=\"Ok\" runat=\"server\" Width=\"50px\"  /&gt; &lt;%--on click should display all the matching names--%&gt;\n\n    &lt;br /&gt;\n&lt;asp:Label ID=\"lbl2\" runat=\"server\" Text=\"Employee ID:\"&gt;&lt;/asp:Label&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;\n&lt;asp:TextBox ID=\"txtempid\" runat=\"server\" Width=\"202px\" Height=\"25px\"&gt;&lt;/asp:TextBox&gt;\n\n\n        &lt;asp:Label id=\"Label5\" runat=\"server\"&gt;&lt;/asp:Label&gt;\n\n    &lt;br /&gt;\n&lt;asp:Label ID=\"lbl3\" runat=\"server\" Text=\"Email Address:\"&gt;&lt;/asp:Label&gt; &amp;nbsp;&amp;nbsp;\n&lt;asp:TextBox ID=\"txtmail\" runat=\"server\" Width=\"201px\" Height=\"25px\"&gt;&lt;/asp:TextBox&gt;\n\n\n        &lt;asp:Label id=\"Label6\" runat=\"server\"&gt;&lt;/asp:Label&gt;\n   &lt;asp:Button ID=\"btn\" Text=\"Ok\" runat=\"server\" Width=\"50px\" \n        onclick=\"btn_Click\"  /&gt;\n&amp;nbsp;\n&lt;/div&gt;\n</code></pre>\n\n<p>HERE IS THE CODE BEHIND</p>\n\n<pre><code>      protected void Button2_Click(object sender, EventArgs e)\n    {\n\n        PrincipalContext ctx = new PrincipalContext(ContextType.Domain, \"DOMAINNAME\");\n        UserPrincipal qbeUser = new UserPrincipal(ctx);\n        UserPrincipal qbeUser1 = new UserPrincipal(ctx);\n        UserPrincipal qbeUser2 = new UserPrincipal(ctx);\n        UserPrincipal qbeUser3 = new UserPrincipal(ctx);\n        UserPrincipal qbeUser4 = new UserPrincipal(ctx);\n        UserPrincipal qbeUser5 = new UserPrincipal(ctx);\n\n        qbeUser.DisplayName = txtdisname.Text;\n        qbeUser1.EmployeeId = txtempid.Text;\n        qbeUser2.EmailAddress = txtmail.Text;\n        qbeUser3.EmailAddress = txt_To.Text;\n        qbeUser4.EmailAddress = txt_From.Text;\n        qbeUser5.EmailAddress = txt_cc.Text;\n\n        PrincipalSearcher srch = new PrincipalSearcher(qbeUser);\n        PrincipalSearcher srch1 = new PrincipalSearcher(qbeUser1);\n        PrincipalSearcher srch2 = new PrincipalSearcher(qbeUser2);\n        PrincipalSearcher srch3 = new PrincipalSearcher(qbeUser3);\n        PrincipalSearcher srch4 = new PrincipalSearcher(qbeUser4);\n        PrincipalSearcher srch5 = new PrincipalSearcher(qbeUser5);\n\n\n\n\n        UserPrincipal found = srch.FindOne() as UserPrincipal;\n        UserPrincipal found1 = srch1.FindOne() as UserPrincipal;\n        UserPrincipal found2 = srch2.FindOne() as UserPrincipal;\n\n\n        if (found == null)\n        {\n            string strfromlabel;\n            strfromlabel = \"Invalid\";\n            Label4.Text = strfromlabel;\n        }\n\n        if( found1 ==null)\n        {\n          string strfromlabel1;\n             strfromlabel1 = \"invalid\";\n             Label5.Text = strfromlabel1; \n        }\n\n        if( found2 ==null)\n        {\n          string strfromlabel2;\n             strfromlabel2 = \"invalid\";\n             Label5.Text = strfromlabel2; \n        }\n\n        UserPrincipal found3 = srch3.FindOne() as UserPrincipal;\n\n         if (found == null || found2 ==null || found1==null)\n         {\n             string strfromlabel1;\n             strfromlabel1 = \"Invalid\";\n             Label1.Text = strfromlabel1;\n         }\n\n        UserPrincipal found4 = srch4.FindOne() as UserPrincipal;\n\n        if (found4 == null)\n        {\n\n            string strfromlabel2;\n            strfromlabel2 = \"Invalid\";\n            Label2.Text = strfromlabel2;\n\n        }\n\n        UserPrincipal found5 = srch5.FindOne() as UserPrincipal;\n        if (found5 == null)\n        {\n            string strfromlabel3;\n            strfromlabel3 = \"Invalid\";\n            Label3.Text = strfromlabel3;\n\n        }\n\n    }\n</code></pre>\n"},{"tags":["c#","multithreading","thread-safety"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":88,"score":5,"question_id":13261300,"title":"Is it okay to \"double check\" before and inside a lock before running the code inside?","body":"<p>On working with thread-safety, I find myself always \"double checking\" before executing code in a lock block and I wondered if I was doing the right thing. Consider the following three ways of doing the same thing:</p>\n\n<p>Example 1:</p>\n\n<pre><code>private static SomeCollection MyCollection;\nprivate static Object locker;\nprivate void DoSomething(string key)\n{\n    if(MyCollection[key] == null)\n    {\n         lock(locker)\n         {\n              MyCollection[key] = DoSomethingExpensive(); \n         }\n    }\n    DoSomethingWithResult(MyCollection[key]);\n}\n</code></pre>\n\n<p>Example 2:</p>\n\n<pre><code>private static SomeCollection MyCollection;\nprivate static Object locker;\nprivate void DoSomething(string key)\n{\n    lock(locker)\n    {\n         if(MyCollection[key] == null)\n         {\n              MyCollection[key] = DoSomethingExpensive(); \n         }\n    }\n    DoSomethingWithResult(MyCollection[key]);\n}\n</code></pre>\n\n<p>Example 3:</p>\n\n<pre><code>private static SomeCollection MyCollection;\nprivate static Object locker;\nprivate void DoSomething(string key)\n{\n    if(MyCollection[key] == null)\n    {\n        lock(locker)\n        {\n             if(MyCollection[key] == null)\n             {\n                  MyCollection[key] = DoSomethingExpensive(); \n             }\n        }\n    }\n    DoSomethingWithResult(MyCollection[key]);\n}\n</code></pre>\n\n<p>I always lean towards Example 3, and here's why I think I'm doing the right thing</p>\n\n<ul>\n<li>Thread 1 enters <code>DoSomething(string)</code></li>\n<li><code>MyCollection[key] == null</code> so Thread 1 obtains a lock, just as Thread 2 enters</li>\n<li><code>MyCollection[key] == null</code> is still true, so Thread 2 waits to obtain the lock</li>\n<li>Thread 1 calculates the value for <code>MyCollection[key]</code> and adds it to the collection</li>\n<li>Thread 1 releases the lock and calls <code>DoSomethingWithResult(MyCollection[key]);</code></li>\n<li>Thread 2 obtains the lock, by which time <code>MyCollection[key] != null</code></li>\n<li>Thread 2 does nothing, releases the lock and continues on its merry way</li>\n</ul>\n\n<p>Example 1 would work, but there is a big risk that Thread 2 could redundantly calculate <code>MyCollection[key]</code>.</p>\n\n<p>Example 2 would work, but every thread would obtain a lock, even if it didn't need to - which could be a (admittedly very small) bottleneck. Why hold up threads if you don't need to?</p>\n\n<p>Am I overthinking this and if so, what is the preferred way of handling these situations?</p>\n"},{"tags":["c#",".net","sql-server","subtract"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13266422,"title":"Mssql Subtract certain percent","body":"<p>Im trying to subtract a certain percent of my price, into a AS columm.</p>\n\n<pre><code>SELECT TOP 2 *, price - (price * (discount/100)) AS discountedPrice FROM products WHERE discount != 0\n</code></pre>\n\n<p>But this seems not to work. What have i done wrong?</p>\n\n<p>I want it like this, let's say price is 500 and discount is 20. Then it'll have to subtract those 20 as percent of the 500.</p>\n\n<p>So 500 - 20%, just in Mssql format.</p>\n"},{"tags":["c#","sql-server","ado.net"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13265981,"title":"Execute SQL Server Stored Procedure with SqlHelper.ExecuteDataSet() and Get Return Value","body":"<p>I have an <code>SQL Server Stored Procedure</code>. This procedure have an output parameter.\nOn my <code>C#.NET</code> Appliaction, I execute this procedure via <code>SqlHelper.ExecuteDataSet()</code> and it returns a query result <code>DataSet</code>.\nHow can I get the output parameter from the stored procedure procedure while using <code>SqlHelper.ExecuteDataSet()</code>.\nSome article said that I need to use <code>SqlHelper.ExecuteNonQuery()</code> but I need the <code>DataSet</code> too.</p>\n\n<p>This is my code:</p>\n\n<pre><code>        public DataSet GetDataPerTable(string spName, string a, string b, out int c)\n        {\n            try\n            {\n                c = 0;\n\n                SqlParameter[] spParameter = new SqlParameter[3];\n\n                spParameter[0] = new SqlParameter(\"@a\", SqlDbType.Char, 4);\n                spParameter[0].Direction = ParameterDirection.Input;\n                spParameter[0].Value = a;\n\n                spParameter[1] = new SqlParameter(\"@b\", SqlDbType.Char, 1);\n                spParameter[1].Direction = ParameterDirection.Input;\n                spParameter[1].Value = b;\n\n                spParameter[2] = new SqlParameter(\"@c\", SqlDbType.Int);\n                spParameter[2].Direction = ParameterDirection.ReturnValue;                \n                c = Convert.ToInt32(spParameter[2].Value);\n\n                return SqlHelper.ExecuteDataset(Configuration.MyConnectionString, CommandType.StoredProcedure, spName, spParameter);\n            }\n            catch (Exception ex)\n            {\n\n                throw ex;\n            }\n        }\n</code></pre>\n\n<p>My <code>c</code> variable always return 0. Any Idea? Thanks in advance :)</p>\n\n<p>My Procedure is about like this:</p>\n\n<pre><code>CREATE PROCEDURE [dbo].SPR_MyProcedure (@a Char(4), @bChar(1), @c Int Output)  \nSELECT * \nFROM MyTable\nSet @c = 1\n</code></pre>\n"},{"tags":["c#","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13266404,"title":"Entity framework: automatic deletion of parent entity","body":"<p>Consider the following model classes:</p>\n\n<pre><code> public class Thing\n{\n    public int Id { get; set; }\n    [Required]\n    public Text Subject { get; set; }\n    [Required]\n    public Text Body { get; set; }\n}\n\npublic class Text\n{\n    public int Id { get; set; }\n    public string Value { get; set; }\n}\n</code></pre>\n\n<p>The model is simple - each Thing must reference to two Text entities. Each Text entry at any point in time should be referenced only by a single entity of any other type (Thing is not the only one).</p>\n\n<p>Is it possible to configure EF5 to automatically delete all referenced Texts when Thing gets deleted (via <code>context.Set&lt;Thing&gt;().Remove</code>), or should it be done with a database trigger?</p>\n"},{"tags":["c#","pdf","pdfsharp"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13263252,"title":"C# PDF Sharp position in document","body":"<p>Hi I am using PDF sharp to print user input onto positions in a template document.</p>\n\n<p>The  data (fields) are collected from user (web page) and written at appropriate positions on the document using drawstring method.</p>\n\n<p>Currently I am finding the Pixel position of each templated field in each page by trial and error .It would be much easier if there is a way to determine pixel position of each field in pdf page.</p>\n\n<p>Any suggestion would be most helpful.</p>\n\n<p>thanks</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13265684,"title":"Change win app labels and text","body":"<p>I remember in <code>VB6</code> i was able to get the handle of a form of a software that's currently running, and change it from outside with some API functions.\nIs it possible to do with c#? how? The problem is that this software is in a different language. I want to change some of it to English.</p>\n"},{"tags":["c#","javascript","asp.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13266120,"title":"TextBox filtering according to RadioButton selection","body":"<p>I've a <code>RadioButtonList</code> and a <code>TextBox</code>. Accordindg to RadioButtonList selection, I want to filtrering textbox.</p>\n\n<pre><code> &lt;asp:RadioButtonList ID=\"RadioButtonList1\"  runat=\"server\"  AutoPostBack=\"True\" OnSelectedIndexChanged=\"RadioButtonList1_SelectedIndexChanged\"&gt;\n      &lt;asp:ListItem Text=\"NUMBER\" Value=\"1\" Selected=\"True\"&gt;&lt;/asp:ListItem&gt;\n      &lt;asp:ListItem Text=\"TEXT\" Value=\"2\"&gt;&lt;/asp:ListItem&gt;\n&lt;/asp:RadioButtonList&gt;\n\n &lt;asp:TextBox ID=\"txtID\" runat=\"server\"&gt;\n</code></pre>\n\n<p>When I click listitem with value <code>1</code>, user can enter number to textbox. value <code>2</code>, number + text.\nalso I want to set the length. Can someone show me how to do this?</p>\n"},{"tags":["c#","asp.net","xml","encryption"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":53,"score":1,"question_id":13265220,"title":"Encrypting of XML File","body":"<p>I want to encrypt an XML File. I took the help of the following code:</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/system.security.cryptography.xml.encryptedxml.aspx\" rel=\"nofollow\"> MSDN Page Link </a></p>\n\n<p>Now the problem is coming when the encrypt function is called. After all the values have been inserted into the xml file, I call the encrypt function. It goes to the switch case 256. But it remains the same.</p>\n\n<pre><code>  XmlElement machmac = doc.CreateElement(\"Mach_MAC\");\n        machmac.InnerText = txtMachMac.Text;\n        root.AppendChild(machmac);\n\n        doc.AppendChild(root);\n        doc.Save(@\"D:\\DEV\\Gener_Lic.xml\");\n        lblmsg.Text = \"Your data is saved\";\n\n        RijndaelManaged key = null;\n\n        try\n        {\n            // Create a new Rijndael key.\n            key = new RijndaelManaged();\n            // Load an XML document.\n            XmlDocument xmlDoc = new XmlDocument();\n\n            xmlDoc.Load(\"D:\\\\DEV\\\\Gener_Lic.xml\");\n\n            // Encrypt the \"Generate_License\" element.\n            Encrypt(xmlDoc, \"Generate_License\", key);\n\n            Console.WriteLine(\"The element was encrypted\");\n\n            Console.WriteLine(xmlDoc.InnerXml);\n\n            //Decrypt(xmlDoc, key);\n\n            //Console.WriteLine(\"The element was decrypted\");\n\n            //Console.WriteLine(xmlDoc.InnerXml);\n\n\n        }\n        catch (Exception exc)\n        {\n            Console.WriteLine(exc.Message);\n        }\n        finally\n        {\n            // Clear the key. if (key != null)\n            {\n                key.Clear();\n            }\n        }\n    }\n\n    catch (Exception ex)\n    {\n        Console.WriteLine(\"error : \" + ex.Message);\n    }\n\n\n}\n</code></pre>\n\n<p>The encryption code is as follows:</p>\n\n<pre><code> public static void Encrypt(XmlDocument Doc, string ElementName, SymmetricAlgorithm Key)\n{\n    // Check the arguments \n\n    if (Doc == null)\n        throw new ArgumentNullException(\"Doc\");\n    if (ElementName == null)\n        throw new ArgumentNullException(\"ElementToEncrypt\");\n    if (Key == null)\n        throw new ArgumentNullException(\"Alg\");\n\n    // Find the specified element in the XmlDocument // object and create a new XmlElemnt object.\n\n    XmlElement elementToEncrypt = Doc.GetElementsByTagName(ElementName)[0] as XmlElement;\n\n    // Throw an XmlException if the element was not found. \n\n    if (elementToEncrypt == null)\n    {\n        throw new XmlException(\"The specified element was not found\");\n\n    }\n\n    // Create a new instance of the EncryptedXml class\n    // and use it to encrypt the XmlElement with the\n    // symmetric key.\n\n    EncryptedXml eXml = new EncryptedXml();\n\n    byte[] encryptedElement = eXml.EncryptData(elementToEncrypt, Key, false);\n\n    // Construct an EncryptedData object and populate\n    // it with the desired encryption information\n\n    EncryptedData edElement = new EncryptedData();\n    edElement.Type = EncryptedXml.XmlEncElementUrl;\n\n    // Create an EncryptionMethod element so that the\n    // receiver knows which algorithm to use for decryption\n    // Determine what kind of algorithm is being used and\n    // supply the appropriate URL to the EncryptionMethod element. \n\n    string encryptionMethod = null;\n\n    if (Key is TripleDES)\n    {\n        encryptionMethod = EncryptedXml.XmlEncTripleDESUrl;\n    }\n    else if (Key is DES)\n    {\n        encryptionMethod = EncryptedXml.XmlEncDESUrl;\n    }\n    if (Key is Rijndael)\n    {\n        switch (Key.KeySize)\n        {\n            case 128:\n                encryptionMethod = EncryptedXml.XmlEncAES128Url;\n                break;\n            case 192:\n                encryptionMethod = EncryptedXml.XmlEncAES192Url;\n                break;\n            case 256:\n                encryptionMethod = EncryptedXml.XmlEncAES256Url;\n                break;\n        }\n    }\n    else\n    {\n        // Throw an exception if the transform is not in the previous categories \n        throw new CryptographicException(\"The specified algorithm is not supported for XML Encryption.\");\n    }\n\n    edElement.EncryptionMethod = new EncryptionMethod(encryptionMethod);\n\n    // Add the encrypted element data to the\n    // EncryptedData object.\n    edElement.CipherData.CipherValue = encryptedElement;\n\n    /// Replace the element from the original XmlDocument\n    // object with the EncryptedData element\n    EncryptedXml.ReplaceElement(elementToEncrypt, edElement, false);\n}\n</code></pre>\n\n<p>Please tell me where am I going wrong.</p>\n"},{"tags":["c#",".net","web-config","membership-provider"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13263450,"title":"altering the type field in sqlmembership provider","body":"<p>Let us  consider the following web.config file </p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;configuration xmlns=\"http://schemas.microsoft.com/.NetConfiguration/v2.0\"&gt;\n  &lt;connectionStrings&gt;\n\n  &lt;/connectionStrings&gt;\n  &lt;system.web&gt;\n    &lt;pages theme=\"PetShop\" styleSheetTheme=\"PetShop\" controlRenderingCompatibilityVersion=\"3.5\" clientIDMode=\"AutoID\"&gt;\n      &lt;controls&gt;\n        &lt;add tagPrefix=\"blt\" namespace=\"BLToolkit.Web.UI\" assembly=\"BLToolkit.4\" /&gt;\n      &lt;/controls&gt;\n    &lt;/pages&gt;\n    &lt;!--\n            Set compilation debug=\"true\" to insert debugging \n            symbols into the compiled page. Because this \n            affects performance, set this value to true only \n            during development.\n        --&gt;\n    &lt;compilation debug=\"true\" targetFramework=\"4.0\"&gt;\n      &lt;assemblies&gt;\n        &lt;add assembly=\"System.Data.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089\" /&gt;\n      &lt;/assemblies&gt;\n    &lt;/compilation&gt;\n    &lt;!--\n            The &lt;authentication&gt; section enables configuration \n            of the security authentication mode used by \n            ASP.NET to identify an incoming user. \n         --&gt;\n    &lt;authentication mode=\"Forms\"&gt;\n      &lt;forms name=\"PetShopAuth\" loginUrl=\"SignIn.aspx\" protection=\"None\" timeout=\"60\" /&gt;\n    &lt;/authentication&gt;\n    &lt;!--\n            The &lt;customErrors&gt; section enables configuration \n            of what to do if/when an unhandled error occurs \n            during the execution of a request. Specifically, \n            it enables developers to configure html error pages \n            to be displayed in place of a error stack trace.\n        --&gt;\n    &lt;customErrors defaultRedirect=\"Error.aspx\" mode=\"RemoteOnly\" /&gt;\n    &lt;sessionState mode=\"Off\" /&gt;\n    &lt;anonymousIdentification enabled=\"true\" /&gt;\n    &lt;profile automaticSaveEnabled=\"false\" defaultProvider=\"ShoppingCartProvider\"&gt;\n      &lt;providers&gt;\n        &lt;add name=\"ShoppingCartProvider\" connectionStringName=\"ProfileDB\" type=\"PetShop.BusinessLogic.ProfileProvider\" applicationName=\".NET Pet Shop 4.0\" /&gt;\n        &lt;add name=\"WishListProvider\" connectionStringName=\"ProfileDB\" type=\"PetShop.BusinessLogic.ProfileProvider\" applicationName=\".NET Pet Shop 4.0\" /&gt;\n        &lt;add name=\"AccountInfoProvider\" connectionStringName=\"ProfileDB\" type=\"PetShop.BusinessLogic.ProfileProvider\" applicationName=\".NET Pet Shop 4.0\" /&gt;\n      &lt;/providers&gt;\n      &lt;properties&gt;\n        &lt;add name=\"ShoppingCart\" type=\"PetShop.BusinessLogic.Cart\" allowAnonymous=\"true\" provider=\"ShoppingCartProvider\" /&gt;\n        &lt;add name=\"WishList\" type=\"PetShop.BusinessLogic.Cart\" allowAnonymous=\"true\" provider=\"WishListProvider\" /&gt;\n        &lt;add name=\"AccountInfo\" type=\"PetShop.ObjectModel.Address\" allowAnonymous=\"false\" provider=\"AccountInfoProvider\" /&gt;\n      &lt;/properties&gt;\n    &lt;/profile&gt;\n    &lt;!-- Membership Provider for SqlServer --&gt;\n    &lt;membership defaultProvider=\"SQLMembershipProvider\"&gt;\n      &lt;providers&gt;\n        &lt;add name=\"SQLMembershipProvider\" type=\"System.Web.Security.SqlMembershipProvider\" connectionStringName=\"MembershipDB\" applicationName=\".NET Pet Shop 4.0\" enablePasswordRetrieval=\"false\" enablePasswordReset=\"true\" requiresQuestionAndAnswer=\"false\" requiresUniqueEmail=\"false\" passwordFormat=\"Hashed\" /&gt;\n      &lt;/providers&gt;\n    &lt;/membership&gt;\n    &lt;caching&gt;\n      &lt;sqlCacheDependency enabled=\"true\" pollTime=\"10000\"&gt;\n        &lt;databases&gt;\n          &lt;add name=\"MSPetShop4\" connectionStringName=\"SQLConnString1\" pollTime=\"10000\" /&gt;\n        &lt;/databases&gt;\n      &lt;/sqlCacheDependency&gt;\n    &lt;/caching&gt;\n  &lt;/system.web&gt;\n  &lt;location path=\"UserProfile.aspx\"&gt;\n    &lt;system.web&gt;\n      &lt;authorization&gt;\n        &lt;deny users=\"?\" /&gt;\n      &lt;/authorization&gt;\n    &lt;/system.web&gt;\n  &lt;/location&gt;\n  &lt;location path=\"CheckOut.aspx\"&gt;\n    &lt;system.web&gt;\n      &lt;authorization&gt;\n        &lt;deny users=\"?\" /&gt;\n      &lt;/authorization&gt;\n    &lt;/system.web&gt;\n  &lt;/location&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>by reading the above config file i need to change the attribute value of type field in membership providers nodes. </p>\n\n<pre><code>    type=\"System.Web.Security.SqlMembershipProvider\" \n</code></pre>\n\n<p>to new value </p>\n\n<p>type=\"sample.SqlMembershipProvider\"</p>\n\n<p>through c#.net lamda expressions</p>\n\n<p>waiting for your responses</p>\n"},{"tags":["c#",".net","winforms","performance","logging"],"answer_count":7,"favorite_count":4,"up_vote_count":1,"down_vote_count":0,"view_count":6018,"score":1,"question_id":5057567,"title":"How to do logging in c#?","body":"<p>I would like to implement logging in my application but would rather not use any outside frameworks like log4net.</p>\n\n<p>So I would like to do something like Dos's echo to file. What is the most effective way to do it?</p>\n\n<p>Is there a way to log unhandled exceptions logged without using an outside framework?</p>\n"},{"tags":["c#","visual-studio","windows-server-2008-r2","system.diagnostics"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":854,"score":1,"question_id":5936719,"title":"Calling dism.exe from System.Diagnostics.Process Fails","body":"<p>For enabling Microsoft-Hyper-V and Microsoft-Hyper-V-Management in Windows 2008 R2 Server(64bit), I'm calling dism.exe as a process. The command I've used is </p>\n\n<blockquote>\n  <p>Dism.exe /online /Get-FeatureInfo\n  /FeatureName:Microsoft-Hyper-V</p>\n  \n  <p>Dism.exe /online /Get-FeatureInfo\n  /FeatureName:Microsoft-Hyper-V-Management-Clients</p>\n</blockquote>\n\n<p>This works fine when I execute this from the command line but it fails when I try to execute it through my code. I've tried the 64bit version of Dism.exe under the C:\\Windows\\SysWoW64 folder but it fails too. Here is the error message I get,</p>\n\n<blockquote>\n  <p>You cannot service a running 64-bit\n  operating system with a 32-bit version\n  of DISM.  Please use the version of\n  DISM that corresponds to your\n  computer's architecture.</p>\n</blockquote>\n\n<p>What am I missing here?</p>\n\n<p>UPDATE: SLaks was right, but the issue turned out to be that MS Visual studio express edition by default targets x86 which I had to manually edit in the .csproj file to AnyCPU to make it work.</p>\n"},{"tags":["c#","casting"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13266305,"title":"Casting data to type of variables stored in object[]","body":"<p>I am trying to emulate the way fortran reads data from text files in C#. In fortran you have something like</p>\n\n<pre><code>        READ(60,2005,ERR=9880,END=8000) A,B,C,D\n  2005  FORMAT(I8,A20,2F10.3)\n</code></pre>\n\n<p>and A, B, C, D are automatically set to the correct type based on the format statement.</p>\n\n<p>I have tried things along the lines of:</p>\n\n<pre><code>    private static void Example(string[] Data, ref object[] Variables)\n    {\n        for (int i = 0; i &lt; Data.Length; i++)\n            Variables[i] = (typeof(Variables[i]))Data;\n    }\n</code></pre>\n\n<p>but can't even get code that will compile.</p>\n\n<p>At the moment I'm assigning to the variables by passing out all the data in an object array, like this</p>\n\n<pre><code>    private static object[] Example(string[] Data)\n    {\n        object[] output = new object[Data.Length - 1];\n\n        for (int i = 0; i &lt; Data.Length; i++)\n        {\n            int dummyInt;\n            if (int.TryParse(Data[i], out dummyInt))\n                output[i] = dummyInt;\n            /// Try to parse other possible data types\n        }\n\n        return output;\n    }\n\n    private static void UseExample()\n    {\n        object[] values = Example(new string[] { \"     356\", \"Some text           \", \"   956.365\", \"564050.201\" });\n        int A = (int)values[0];\n        string B = (string)values[1];\n        double C = (double)values[2];\n        double D = (double)values[3];\n    }\n</code></pre>\n\n<p>This is simplified, but is in essence what I am doing: determining the type of the data, casting to that type and passing all fields out as an object and then casting again when I assign to the variables that hold the data.\nWhich requires knowing what variables will come out and also a lot of extra coding if there are lots of data fields.</p>\n\n<p>I am looking for a way I can pass in all the variables that should be set and set them to the correct value value, but for that I need to be able to cast the data to the type of the appropriate variable.</p>\n\n<p>Can this be done? If it is possible, how can it be done?</p>\n"},{"tags":["c#","wpf","webbrowser"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13265891,"title":"I have issues with the C# WPF WebBrowser class","body":"<p>I have issues with the C# WPF WebBrowser class</p>\n\n<p>I have a C# WPF application which uses a WebBrowser class.  I have overwritten the LoadComplete method as well as several other methods to try to get the html content after the pages is loaded:</p>\n\n<pre><code>    String URL = textBox1.Text;\n\n    URL = URL.Replace(' ', '+');\n\n    webbrowser1 = new WebBrowser();\n\n    webbrowser1.LoadCompleted += new LoadCompletedEventHandler(webbrowser1_LoadCompleted);\n    webbrowser1.Loaded += new RoutedEventHandler(webbrowser1_Loaded);\n    webbrowser1.Navigated += webbrowser1_Navigated;\n\n    grd.Children.Add(webbrowser1);\n\n    int i = 0;\n    webbrowser1.Navigate(new Uri(\"https://www.google.com/#q=\" + URL + ....\n</code></pre>\n\n<p>I have put breakpoints in these methods and I have written code to grap the Inner HTML from the HTMLDocument of the WebBrowser class and I have output the html text to different files for each method.</p>\n\n<p>Then I have run the program.  While the program runs, I watch the actual program to see if the document loads.  The web page that is loading is the results page of a google search query.</p>\n\n<p>Visually, the output is a blank, white page when eaqch method for LoadComplete, Loaded and Navagated is hit while I run through the code.  It is only after the methods have been hit (some a couple of times) and the program is idle does the display show the results page.</p>\n\n<p>The HTML code that is output to files does not represent the google search results page.  Instead, it represents the google home page and does not have ny of the results.  Any ideas?  How can I programatically get the results page?</p>\n"},{"tags":["c#","json","rest","json.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13266100,"title":"Deserializing JSON data containing a varying number of parameters to C# (using Json.NET)","body":"<p>I'm trying to deserialize the following JSON response:</p>\n\n<pre><code>[{\"pollid\":\"1\", \"question\":\"This is a test\", \"start\":\"2011-06-28\", \"end\":\"2012-03-21\", \"category\":\"Roads\", \"0\":\"Yes\", \"1\":\"No\"} … ]\n</code></pre>\n\n<p>A problem arises, however, in the fact that the number of parameters following \"category\" can vary from 0 to 10. Meaning all the following are possible JSON responses:</p>\n\n<pre><code>[{\"pollid\":\"1\", \"question\":\"This is a test\", \"start\":\"2011-06-28\", \"end\":\"2012-03-21\", \"category\":\"Roads\"} … ]\n[{\"pollid\":\"1\", \"question\":\"This is a test\", \"start\":\"2011-06-28\", \"end\":\"2012-03-21\", \"category\":\"Roads\", \"0\":\"Yes\", \"1\":\"No\"} … ]\n[{\"pollid\":\"1\", \"question\":\"This is a test\", \"start\":\"2011-06-28\", \"end\":\"2012-03-21\", \"category\":\"Roads\", \"0\":\"Bad\", \"1\":\"OK\", \"2\":\"Good\", \"3\":\"Very good\"} … ]\n</code></pre>\n\n<p>I'm deserializing responses to objects of the following form:</p>\n\n<pre><code>class Poll\n    {\n        public int pollid { get; set; }\n        public string question { get; set; }\n        public DateTime start { get; set; }\n        public DateTime end { get; set; }\n        public string category { get; set; }\n\n        [JsonProperty(\"0\")]\n        public string polloption0 { get; set; }\n        [JsonProperty(\"1\")]\n        public string polloption1 { get; set; }\n        [JsonProperty(\"2\")]\n        public string polloption2 { get; set; }\n        [JsonProperty(\"3\")]\n        public string polloption3 { get; set; }\n        [JsonProperty(\"4\")]\n        public string polloption4 { get; set; }\n        [JsonProperty(\"5\")]\n        public string polloption5 { get; set; }\n        [JsonProperty(\"6\")]\n        public string polloption6 { get; set; }\n        [JsonProperty(\"7\")]\n        public string polloption7 { get; set; }\n        [JsonProperty(\"8\")]\n        public string polloption8 { get; set; }\n        [JsonProperty(\"9\")]\n        public string polloption9 { get; set; }\n    }\n</code></pre>\n\n<p>My questions is: Is there perhaps a better way to handle the storing of a varying number of parameters? Having 10 class properties which may or may not be used (depending on the response) seems like such a \"hack\".</p>\n\n<p>Any help would be truly appreciated!</p>\n\n<p>Many thanks,\nTed</p>\n"},{"tags":["c#"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":66,"score":-2,"question_id":13265713,"title":"Update string in List","body":"<p>I have loaded a txt comma delimited into multiple lists. For example</p>\n\n<pre><code>static public void File()    \n{    \n    var order_no = new List&lt;String&gt;();    \n    var quantity = new List&lt;String&gt;();    \n    order_no.Add(fields[0]);    \n    quantity.Add(fields[1]);    \n}       \n</code></pre>\n\n<p>Now what i am trying to is in a loop while the same order is found down the list and the quantity is null then update the quantity in the previous.  </p>\n\n<p>For example</p>\n\n<blockquote>\n  <p>order NO : 1     quantity: null</p>\n  \n  <p>order NO : 5     quantity: 2</p>\n  \n  <p>order no : 1     quantity: 1</p>\n</blockquote>\n\n<p>what it should do is to update the quantity in the first value to 1.</p>\n\n<p>How can i accomplish that?</p>\n"},{"tags":["c#",".net-4.0","windows-services"],"answer_count":7,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":1963,"score":6,"question_id":6441614,"title":"Cannot find windows service (just installed)","body":"<p>I just installed a windows service using VS 2010, using the installutil.exe, the cmd prompt window said the commit phase completed successfully, but I cannot see the windows service in the local services folder.  </p>\n\n<p>What did I miss here?</p>\n\n<p>I am using Windows 7 and VS 2010</p>\n\n<p><strong>UPDATE:</strong><br>\nI un-installed the service (which was named service1) changed the name to something that made sense, installed the service (same process as above), still cannot find it in the services browser.  </p>\n\n<p>FWIW... I renamed my service1.cs in the properties window (filename value).. but it was still showing service1 in the services browser. I ended up changing the values in the code behind as well (auto generated code) this.serviceInstaller1.ServiceName = \"service1\";</p>\n\n<p><strong>Update (2)</strong>\nI created a dummy windows service, and was able to successfully install that (it prompted me for Domain Login ID &amp; password) and I was able to see it in the services browser.</p>\n\n<p>However, I am not able to see the actual windows service (related to my project) in the services browser. Obviously I have permissions, since I was able to install the dummy service.</p>\n\n<p>According this this site <a href=\"http://www.pcreview.co.uk/forums/cant-see-windows-service-after-installation-t2273909.html\" rel=\"nofollow\">Can't see windows service after installation</a></p>\n\n<p>I cannot see the service in the registry in \"HKLM\\System\\CurrentControlSet\\Services\" path.</p>\n\n<p><strong>Update (3)</strong><br>\nThe log file says </p>\n\n<blockquote>\n  <p>No public installers with the\n  RunInstallerAttribute.Yes attribute\n  could be found in the C:..</p>\n</blockquote>\n\n<p>however, I do have a ProjectInstaller.cs file in the project solution.</p>\n\n<p>I added </p>\n\n<blockquote>\n  <p>[RunInstaller(true)]</p>\n</blockquote>\n\n<p>to the ProjectInstaller.cs file, still no luck  </p>\n\n<p>Any suggesstions?</p>\n"},{"tags":["c#","asp.net","response"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3376,"score":1,"question_id":374555,"title":"Closing a Pop-Up Window after Writing File to Response","body":"<p>In my code, I am using javascript to fire off a window.open on an ASPX page. In the page-load of that page, I'm outputting a file:</p>\n\n<pre><code>Response.Clear();\nResponse.ClearContent();\nResponse.ClearHeaders();\nResponse.Charset = \"\";\nResponse.ContentType = \"application/octet-stream\";\nResponse.AddHeader(\"Content-Disposition\", \"attachment;filename=\\\"\" + filename + \"\\\";\");\noutputStream.WriteTo(Response.OutputStream);\noutputStream.Flush();\noutputStream.Close();\nResponse.Flush();\nResponse.Close();\n</code></pre>\n\n<p>After this, I would ideally like to close the popup window. However, because I have changed my response type, I cannot output the normal window.close javascript. It will merely get appended to the file being given to the users. The closest I have come to a solution is this thread:</p>\n\n<p><a href=\"http://forums.asp.net/t/1186371.aspx?PageIndex=1\" rel=\"nofollow\">http://forums.asp.net/t/1186371.aspx?PageIndex=1</a></p>\n\n<p>But even there in the end the guy didn't get any answers. As far as I can see, there is no way to do this. However, I'd like to ask you for your help before I give it up entirely and just have something telling the users to close the window manually. Any suggestions?</p>\n"},{"tags":["c#"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":19,"score":-1,"question_id":13265223,"title":"Stop Location Sensor error from prompting","body":"<p>I am using the below code to retrieve the GPS, but because the location sensor is not install, an error is prompted, how do I stop it?</p>\n\n<pre><code>// Get the latitude and longitude\nGeoCoordinateWatcher watcher = new GeoCoordinateWatcher();\n\n// Do not suppress prompt, and wait 1000 milliseconds to start.\nwatcher.TryStart(false, TimeSpan.FromMilliseconds(1000));\n\nGeoCoordinate coord = watcher.Position.Location;\n</code></pre>\n\n<p>The Prompt message is :</p>\n\n<pre><code>Enter a default location.\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13265618,"title":"Repeating controls in windows form application","body":"<p>I am developing a Windows Forms application to generate incentive reports for staff in different groups. In order to match the report template, I need to manually put controls in the form for only one staff. If I finished all the logic inside, how can I make it dynamic so that it could auto generate reports for all the staff by using same template?</p>\n"},{"tags":["c#","exception-handling","quartz.net"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":837,"score":6,"question_id":3246277,"title":"Handle JobExecutionException in Quartz.net","body":"<p>Probably a stupid question... but here goes anyway...</p>\n\n<p>I have set up quartz, and can schedule jobs, and I can confirm that jobs (implementing the IJob interface) are working. Looking at the documentation on the site, (Lesson 3 of the tutorial) \"The only type of exception that you are allowed to throw from the execute method is JobExecutionException.\" I would like that when an exception occurs that I haven't explicitly handled, it should throw a JobExecutionException, so that I can log it in the 'parent' application. I have wrapped my code in a try catch, and have thrown the JobExecutionException, but now where to handle it?</p>\n\n<p>I don't call the execute method anywhere, that is handled by Quartz (on a separate thread). So, how do I handle that error when it occurs. I don't really want to swallow the error in the Job</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["c#","android","html"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":35,"score":0,"question_id":13209876,"title":"Mono for Android Get table value from HTML website","body":"<p>I'm using MonoDevelop (Android C#). Is there a way to get values from a HTML table from a specified URL?</p>\n"},{"tags":["c#","web-services"],"answer_count":4,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":5071,"score":1,"question_id":2622003,"title":"Call Webservice without adding a WebReference - with Complex Types","body":"<p>I'm using the code at <a href=\"http://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=4750&amp;lngWId=10\" rel=\"nofollow\">This Site</a> to call a webservice dynamically.</p>\n\n<pre><code>[SecurityPermissionAttribute(SecurityAction.Demand, Unrestricted = true)]\n    public static object CallWebService(string webServiceAsmxUrl, string serviceName, string methodName, object[] args)\n    {\n        System.Net.WebClient client = new System.Net.WebClient();\n        //-Connect To the web service\n        using (System.IO.Stream stream = client.OpenRead(webServiceAsmxUrl + \"?wsdl\"))\n        {\n            //--Now read the WSDL file describing a service.\n            ServiceDescription description = ServiceDescription.Read(stream);\n            ///// LOAD THE DOM /////////\n            //--Initialize a service description importer.\n            ServiceDescriptionImporter importer = new ServiceDescriptionImporter();\n            importer.ProtocolName = \"Soap12\"; // Use SOAP 1.2.\n            importer.AddServiceDescription(description, null, null);\n            //--Generate a proxy client. importer.Style = ServiceDescriptionImportStyle.Client;\n            //--Generate properties to represent primitive values.\n            importer.CodeGenerationOptions = System.Xml.Serialization.CodeGenerationOptions.GenerateProperties;\n            //--Initialize a Code-DOM tree into which we will import the service.\n            CodeNamespace nmspace = new CodeNamespace();\n            CodeCompileUnit unit1 = new CodeCompileUnit();\n            unit1.Namespaces.Add(nmspace);\n            //--Import the service into the Code-DOM tree. This creates proxy code\n            //--that uses the service.\n            ServiceDescriptionImportWarnings warning = importer.Import(nmspace, unit1);\n            if (warning == 0) //--If zero then we are good to go\n            {\n                //--Generate the proxy code \n                CodeDomProvider provider1 = CodeDomProvider.CreateProvider(\"CSharp\");\n                //--Compile the assembly proxy with the appropriate references\n                string[] assemblyReferences = new string[5] { \"System.dll\", \"System.Web.Services.dll\", \"System.Web.dll\", \"System.Xml.dll\", \"System.Data.dll\" };\n                CompilerParameters parms = new CompilerParameters(assemblyReferences);\n                CompilerResults results = provider1.CompileAssemblyFromDom(parms, unit1);\n                //-Check For Errors\n                if (results.Errors.Count &gt; 0)\n                {\n                    StringBuilder sb = new StringBuilder();\n                    foreach (CompilerError oops in results.Errors)\n                    {\n                        sb.AppendLine(\"========Compiler error============\");\n                        sb.AppendLine(oops.ErrorText);\n                    }\n                    throw new System.ApplicationException(\"Compile Error Occured calling webservice. \" + sb.ToString());\n                }\n                //--Finally, Invoke the web service method \n                Type foundType = null;\n                Type[] types = results.CompiledAssembly.GetTypes();\n                foreach (Type type in types)\n                {\n                    if (type.BaseType == typeof(System.Web.Services.Protocols.SoapHttpClientProtocol))\n                    {\n                        Console.WriteLine(type.ToString());\n                        foundType = type;\n                    }\n                }\n\n                object wsvcClass = results.CompiledAssembly.CreateInstance(foundType.ToString());\n                MethodInfo mi = wsvcClass.GetType().GetMethod(methodName);\n                return mi.Invoke(wsvcClass, args);\n            }\n            else\n            {\n                return null;\n            }\n        }\n    }\n</code></pre>\n\n<p>This works fine when I use built in types, but for my own classes, I get this:</p>\n\n<pre><code>Event Type: Error\nEvent Source:   TDX Queue Service\nEvent Category: None\nEvent ID:   0\nDate:       12/04/2010\nTime:       12:12:38\nUser:       N/A\nComputer:   TDXRMISDEV01\nDescription:\nSystem.ArgumentException: Object of type 'TDXDataTypes.AgencyOutput' cannot be converted to type 'AgencyOutput'.\n\nServer stack trace: \n   at System.RuntimeType.CheckValue(Object value, Binder binder, CultureInfo culture, BindingFlags invokeAttr)\n   at System.Reflection.MethodBase.CheckArguments(Object[] parameters, Binder binder, BindingFlags invokeAttr, CultureInfo culture, Signature sig)\n   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture, Boolean skipVisibilityChecks)\n   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)\n   at System.Reflection.MethodBase.Invoke(Object obj, Object[] parameters)\n   at TDXQueueEngine.GenericWebserviceProxy.CallWebService(String webServiceAsmxUrl, String serviceName, String methodName, Object[] args) in C:\\CkAdmDev\\TDXQueueEngine\\TDXQueueEngine\\TDXQueueEngine\\GenericWebserviceProxy.cs:line 76\n   at TDXQueueEngine.TDXQueueWebserviceItem.Run() in C:\\CkAdmDev\\TDXQueueEngine\\TDXQueueEngine\\TDXQueueEngine\\TDXQueueWebserviceItem.cs:line 99\n   at System.Runtime.Remoting.Messaging.StackBuilderSink._PrivateProcessMessage(IntPtr md, Object[] args, Object server, Int32 methodPtr, Boolean fExecuteInContext, Object[]&amp; outArgs)\n   at System.Runtime.Remoting.Messaging.StackBuilderSink.PrivateProcessMessage(RuntimeMethodHandle md, Object[] args, Object server, Int32 methodPtr, Boolean fExecuteInContext, Object[]&amp; outArgs)\n   at System.Runtime.Remoting.Messaging.StackBuilderSink.AsyncProcessMessage(IMessage msg, IMessageSink replySink)\n\nException rethrown at [0]: \n   at System.Runtime.Remoting.Proxies.RealProxy.EndInvokeHelper(Message reqMsg, Boolean bProxyCase)\n   at System.Runtime.Remoting.Proxies.RemotingProxy.Invoke(Object NotUsed, MessageData&amp; msgData)\n   at TDXQueueEngine.TDXQueue.RunProcess.EndInvoke(IAsyncResult result)\n   at TDXQueueEngine.TDXQueue.processComplete(IAsyncResult ar) in C:\\CkAdmDev\\TDXQueueEngine\\TDXQueueEngine\\TDXQueueEngine\\TDXQueue.cs:line 130\n\nFor more information, see Help and Support Center at http://go.microsoft.com/fwlink/events.asp.\n</code></pre>\n\n<p>The classes reference the same assembly and the same version.  Do I need to include my assembly as a reference when building the temporary assembly?  If so, how?</p>\n\n<p>Thanks.</p>\n\n<hr>\n\n<p><strong>Update</strong></p>\n\n<p>It appears that the best solution will be to build a routine that can map from <code>AssemblyX.MyCustomType</code> to an equivalent <code>GeneratedAssembly.MyCustomType</code>.</p>\n\n<p>In my example, <code>MyCustomType</code> contains more types (which should all be part of the generated assembly) so it appears I need a method to do this \"deep copy\".  Also, some of the properties of the TDXDataTypes.AgencyOutput are arrays of other classes, just to make things more fun...</p>\n\n<p>I've created a <a href=\"http://stackoverflow.com/questions/2646578/using-automapper-to-dynamically-map-objects-including-arrays\">new question</a> for the mapping.</p>\n"},{"tags":["c#",".net"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":30,"score":-1,"question_id":13265883,"title":"non closable window in windows form using c#?","body":"<p>When I click a submit button on the windows form, it should throw up a popup window (asking for yes or no) which doesn't have a close (X) button even if we click wherever that popup window should blink for that response.</p>\n\n<p>So how to do it?</p>\n"},{"tags":["c#","android"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13235794,"title":"Mono for Android Release error","body":"<p>I'm using Mono for Android (C#). I'm trying to get the .apk file using MonoDevelop, but when I set project for release (using this guide: <a href=\"http://docs.xamarin.com/Android/Guides/Deployment,_Testing,_and_Metrics/publishing_an_application/Part_1_-_Preparing_an_Application_for_Release\" rel=\"nofollow\">LINK</a>) I get this Error:</p>\n\n<blockquote>\n  <p>Error MSB4018: The \"GenerateJavaStubs\" task failed unexpectedly.\n  System.InvalidOperationException: /manifest/@package attribute MUST\n  contain a period ('.').    at\n  Xamarin.Android.Tasks.ManifestDocument.Merge(List<code>1 subclasses, List</code>1\n  selectedWhitelistAssemblies, Boolean embed)    at\n  Xamarin.Android.Tasks.GenerateJavaStubs.Execute()    at\n  Microsoft.Build.BackEnd.TaskExecutionHost.Microsoft.Build.BackEnd.ITaskExecutionHost.Execute()\n  at\n  Microsoft.Build.BackEnd.TaskBuilder.ExecuteInstantiatedTask(ITaskExecutionHost\n  taskExecutionHost, TaskLoggingContext taskLoggingContext, TaskHost\n  taskHost, ItemBucket bucket, TaskExecutionMode howToExecuteTask,\n  Boolean&amp; taskResult) (MSB4018)</p>\n</blockquote>\n"},{"tags":["c#","oop"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":31,"score":0,"question_id":13265690,"title":"How to know derived class which method is called/executed from the base class","body":"<p>I have a class called <strong>logIT</strong></p>\n\n<pre><code>public class LogIT\n{\n    public string strMessage = string.Empty;\n    public string strClassName = string.Empty;\n    public string strMethodName = string.Empty;\n    public LogIT()\n    {\n        strMethodName = new StackFrame(1).GetMethod().Name;\n        strClassName = new StackFrame(1).GetMethod().DeclaringType.Name;\n    }\n}\n</code></pre>\n\n<p>Another class which inherits the LogIT class named \"<strong>product</strong>\"</p>\n\n<pre><code>public class Product : LogIT\n{\n    public Product()\n    {\n\n    }\n    public void GetProduct()\n    {\n\n    }\n\n    public void AddEditProduct()\n    {\n\n    }\n}\n</code></pre>\n\n<p>THis is my <strong>main</strong> method:</p>\n\n<pre><code>static void Main(string[] args)\n    {\n        Product objProduct = new Product();\n        objProduct.GetProduct();\n    }\n</code></pre>\n\n<p>My question is, when i call the <strong>product</strong> class's <strong>GetProduct</strong> method, i want <strong>logit</strong> class constructor to be called and known which method of <strong>dervied</strong> class has been called.</p>\n\n<p>Please suggest how to accomplish it or any other alternative for the same.\nThanks</p>\n"},{"tags":["c#","pwm"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":15,"score":-2,"question_id":13266036,"title":"dimming LEDs using Software PWM","body":"<p>I want to let LEDs pulse. After some googeling I found out I have to use pulse width modulation to achieve this.</p>\n\n<p>My board doesn't support hardware pwm. That's why I have to use software pwm. </p>\n\n<p>Can anyone provide me a good link where I can get a sample in C# how to do software pwm and in addition it would be good this sample doesn't use a while(true)-loop because of the CPU usage.</p>\n"},{"tags":["c#",".net","string"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":72,"score":4,"question_id":13246313,"title":"Format a String literal","body":"<p>I want to format a string value by a certain format that the <code>first letter</code> of it be in <code>Uppercase</code>.<br>\ne.g:  </p>\n\n<pre><code>string.Format(\"{0}\", \"myName\"); //Output must be : \"MyName\"\n</code></pre>\n\n<p>How can I do it?</p>\n"},{"tags":["c#","ef-code-first","one-to-many","entity-framework-5","one-to-one"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13258314,"title":"Both One-To-One and One-To-Many relationships in Entity Framework 5 Code First","body":"<p>i tried the whole day to get this working. I learned a lot about EF's Fluent API (e.g. <a href=\"http://weblogs.asp.net/manavi/archive/2010/12/19/entity-association-mapping-with-code-first-one-to-one-shared-primary-key-associations.aspx\" rel=\"nofollow\">this</a> is an excellent article), however i had no success.</p>\n\n<p>I have three Entities:</p>\n\n<pre><code>public class Address\n{\n   [Key]\n   public virtual int AddressId { get; set; }\n   public virtual string AddressString { get; set; }\n}\npublic class User\n{\n   [Key]\n   public virtual int UserId { get; set; }\n   public virtual ICollection&lt;Address&gt; Addresses { get; set; }\n}\npublic class House\n{\n   [Key]\n   public virtual int HouseId { get; set; }\n   public virtual Address Address { get; set; }\n}\n</code></pre>\n\n<p>and tried all combinations of <code>HasMany, HasOptional, WithOptional, WithOptionalDependent</code> and <code>WithOptionalPrincipial</code> i could think of for both <code>User</code> and <code>House</code> in the </p>\n\n<pre><code>protected override void OnModelCreating(DbModelBuilder modelBuilder)\n</code></pre>\n\n<p>I just cannot get it to work. I think it should be clear, what i want. A User may have more than one address (in the first place i want to force at least one, but now i would be happy if a user may have the addresses optional...) while a House has exactly one Address - and this is required. It would be nice if the address of a house would be cascading deleted.</p>\n"},{"tags":["c#","asp.net","way2sms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1332,"score":0,"question_id":12204551,"title":"Send Sms Using way2sms api in c#","body":"<p>I want to send SMS using way2sms. I have tried following code</p>\n\n<p><strong>login.aspx.cs</strong></p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\nusing System.Web.UI;\nusing System.Web.UI.WebControls;\n\nnamespace WebApplication1\n{\npublic partial class Login : System.Web.UI.Page\n{\n    protected void Page_Load(object sender, EventArgs e)\n    {\n\n    }\n\n    protected void btnconnect_Click(object sender, EventArgs e)\n    {\n        Session[\"id\"] = txtmobileno.Text;\n        Session[\"pw\"] = txtpw.Text;\n        Response.Redirect(\"/send.aspx\");\n    }\n  }\n }\n</code></pre>\n\n<p><strong>send.aspx.cs</strong></p>\n\n<pre><code>using System;\nusing System.Data;\nusing System.Configuration;\nusing System.Collections;\nusing System.Web;\nusing System.Web.Security;\nusing System.Web.UI;\nusing System.Web.UI.WebControls;\nusing System.Web.UI.WebControls.WebParts;\nusing System.Web.UI.HtmlControls;\nusing System.IO;\nusing System.Net;\nusing System.Text;\nusing System.Text.RegularExpressions;\n\nnamespace WebApplication1\n{\npublic partial class send : System.Web.UI.Page\n{\n    string mbno, mseg, ckuser, ckpass;\n    private HttpWebRequest req;\n    private CookieContainer cookieCntr;\n    private string strNewValue;\n    public static string responseee;\n    private HttpWebResponse response;\n\n    protected void Page_Load(object sender, EventArgs e)\n    {\n        if (Session[\"id\"] == null &amp;&amp; Session[\"pw\"] == null)\n        {\n            Server.Transfer(\"login.aspx\");\n        }\n        connect();\n\n        try\n        {\n\n            lblError.Text = \"\";\n            lblError.Visible = false;\n            if (!(IsPostBack))\n            {\n                btnSend.Attributes.Add(\"onclick\", \"return Validate('\" + txtTo.ClientID + \"','\" + txtMessage.ClientID + \"');\");\n                txtMessage.Attributes.Add(\"onchange\", \"TextChange('\" + txtMessage.ClientID + \"','\" + lblLeft.ClientID + \"');\");\n                txtMessage.Attributes.Add(\"onkeyup\", \"TextChange('\" + txtMessage.ClientID + \"','\" + lblLeft.ClientID + \"');\");\n            }\n        }\n        catch (Exception ex)\n        {\n            lblError.Text = ex.Message;\n            lblError.Visible = true;\n        }\n    }\n\n    protected void btnSend_Click(object sender, EventArgs e)\n    {\n        try\n        {\n            mbno = txtTo.Text;\n            mseg = txtMessage.Text;\n\n            sendSms(mbno, mseg);\n            txtTo.Text = \"\";\n            txtMessage.Text = \"\";\n        }\n        catch (Exception ex)\n        {\n            lblError.Text = ex.Message;\n            lblError.Visible = true;\n        }\n    }\n\n    public void connect()\n    {\n        ckuser = Session[\"id\"].ToString();\n        ckpass = Session[\"pw\"].ToString();\n\n        try\n        {\n            this.req = (HttpWebRequest)WebRequest.Create(\"http://wwwd.way2sms.com/auth.cl\");\n\n            this.req.CookieContainer = new CookieContainer();\n            this.req.AllowAutoRedirect = false;\n            this.req.Method = \"POST\";\n            this.req.ContentType = \"application/x-www-form-urlencoded\";\n            this.strNewValue = \"username=\" + ckuser + \"&amp;password=\" + ckpass;\n            this.req.ContentLength = this.strNewValue.Length;\n            StreamWriter writer = new StreamWriter(this.req.GetRequestStream(), Encoding.ASCII);\n            writer.Write(this.strNewValue);\n            writer.Close();\n            this.response = (HttpWebResponse)this.req.GetResponse();\n            this.cookieCntr = this.req.CookieContainer;\n            this.response.Close();\n            this.req = (HttpWebRequest)WebRequest.Create(\"http://wwwd.way2sms.com//jsp/InstantSMS.jsp?val=0\");\n            this.req.CookieContainer = this.cookieCntr;\n            this.req.Method = \"GET\";\n            this.response = (HttpWebResponse)this.req.GetResponse();\n            responseee = new StreamReader(this.response.GetResponseStream()).ReadToEnd();\n            int index = Regex.Match(responseee, \"custf\").Index;\n            responseee = responseee.Substring(index, 0x12);\n            responseee = responseee.Replace(\"\\\"\", \"\").Replace(\"&gt;\", \"\").Trim();\n            this.response.Close();\n\n            pnlsend.Visible = true;\n            lblErrormsg.Text = \"connected\";\n        }\n        catch (Exception ex)\n        {\n            lblErrormsg.Text = \"Error connecting to the server...\";\n            Session[\"error\"] = \"Error connecting to the server...\";\n            lblError.Text = ex.ToString();\n\n            lblError.Text= ex.ToString();\n            //Server.Transfer(\"login.aspx\");\n        }\n    }\n    public void sendSms(string mbno, string mseg)\n    {\n        if ((mbno != \"\") &amp;&amp; (mseg != \"\"))\n        {\n            try\n            {\n                this.req = (HttpWebRequest)WebRequest.Create(\"http://wwwd.way2sms.com//FirstServletsms?custid=\");\n                this.req.AllowAutoRedirect = false;\n                this.req.CookieContainer = this.cookieCntr;\n                this.req.Method = \"POST\";\n                this.req.ContentType = \"application/x-www-form-urlencoded\";\n                this.strNewValue = \"custid=undefined&amp;HiddenAction=instantsms&amp;Action=\" + responseee + \"&amp;login=&amp;pass=&amp;MobNo=\" + this.mbno + \"&amp;textArea=\" + this.mseg;\n\n                string msg = this.mseg;\n                string mbeno = this.mbno;\n\n                this.req.ContentLength = this.strNewValue.Length;\n                StreamWriter writer = new StreamWriter(this.req.GetRequestStream(), Encoding.ASCII);\n                writer.Write(this.strNewValue);\n                writer.Close();\n                this.response = (HttpWebResponse)this.req.GetResponse();\n\n                this.response.Close();\n                lblErrormsg.Text = \"Message Sent..... \" + mbeno + \": \" + msg;\n            }\n            catch (Exception)\n            {\n                lblErrormsg.Text = \"Error Sending msg....check your connection...\";\n            }\n        }\n        else\n        {\n            lblErrormsg.Text = \"Mob no or msg missing\";\n        }\n    }\n\n    protected void btnLogOut_Click(object sender, EventArgs e)\n    {\n        Session[\"id\"] = null;\n        Session[\"pw\"] = null;\n        Session[\"error\"] = null;\n        Server.Transfer(\"login.aspx\");\n    }\n\n  }\n}\n</code></pre>\n\n<p>But it doesn't work. Is there any changes in this code that I have to do? \nPlease tell me any other way to <strong>send sms</strong> from desktop application or web application</p>\n"},{"tags":["c#",".net","database","asp.net-membership","membership-provider"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13265957,"title":"Setting Membership provider's database at runtime...?","body":"<p>We're using ASP.Net membership providers (the SQL Server provider), and I want to be able to change only the database name in the class . To do this, I need the ASP.Net membership provider configured so that my installer can use it </p>\n\n<p>i used code as</p>\n\n<pre><code>public class CodeFirstMembershipProvider : SqlMembershipProvider\n    {    \n      public override void Initialize(string name, System.Collections.Specialized.NameValueCollection config)  \n      { \n          base.Initialize(name, config);  \n\n          // hard coded for testing  \n          string connectionString = @\"server=localhost;database=masterdb;uid=master;pwd=password\";\n\n          // Set private property of Membership provider.  \n          FieldInfo connectionStringField = GetType().BaseType.GetField(\"_sqlConnectionString\", BindingFlags.Instance | BindingFlags.NonPublic);  \n          if(connectionStringField != null)\n            connectionStringField.SetValue(this, connectionString);  \n      }\n}\n</code></pre>\n\n<p>in above code i need to enter and change the full connection string values..</p>\n\n<p>it too works fine .....</p>\n\n<p>but my query is to change only the database name only of the current connection string mentioned in web.config file..</p>\n\n<p>So is there a way to switch the databse name through an ASP.Net membership through code ?</p>\n"},{"tags":["c#",".net","design-patterns","data-access-layer"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":13265445,"title":"Should my DAL return Person or Datatable?","body":"<p><em>After reading <a href=\"http://stackoverflow.com/questions/836621/should-my-dal-return-datatables-or-i-whatever\">this</a>  , I still have a question :</em> </p>\n\n<p>I use this code to query the db : </p>\n\n<p><kbd>c# : </kbd></p>\n\n<pre><code>new BLL().GetPersonById(1)\n</code></pre>\n\n<p><kbd>BLL : </kbd></p>\n\n<pre><code>public Person GetPersonById(int id)\n{\n  return new DAL ().GetPersonById(1);\n}\n</code></pre>\n\n<p><kbd>DAL : </kbd></p>\n\n<pre><code>public Person  GetPersonById(int id)\n{\n   // goto db and create instance of Person and fill its data...\n}\n</code></pre>\n\n<p>However , am I doing it wrong , </p>\n\n<p>Should my DAL return <code>DataTable</code> <strong>instead</strong> ?  ( so the BLL will create Person .... ?)</p>\n\n<p><kbd>DAL : </kbd></p>\n\n<pre><code>public DataTable  GetPersonById(int id)\n{\n   // goto db ...\n}\n</code></pre>\n\n<p>Thank you.</p>\n\n<p>Edit : </p>\n\n<p>the Person object is defined in <strong>BE</strong> dll ( business entity).</p>\n"},{"tags":["c#","msbuild","culture","stylecop"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":12514750,"title":"C# + StyleCop + MSBuild + Global culture settings failing to be picked up","body":"<p>I've got my C# project file set up to import a StyleCop.Targets project that runs all the StyleCop rules on build. This is great and I've got the project down to zero errors when compiling through Visual Studio.</p>\n\n<p>However when I compile through MSBuild (on the same machine) I get errors along the line of :</p>\n\n<p><code>The documentation text within the constructor's summary tag must begin with the text: Initializes a new instance of the &lt;see cref=\"MyClass\" /&gt; class.</code></p>\n\n<p>Focus on the 'Z' in initialises... I've configured my Settings.StyleCop with an <strong>en-GB</strong> global setting so that I don't get errors about Americanisms within the code. However I can't fathom out why this causes errors in MSBuild.</p>\n\n<p>I know MSBuild is using the same Settings.StyleCop file as if I change a rule (say TabsMustNotBeUsed) MSBuild (and Visual Studio) picks this change up and throws errors all over the place.</p>\n\n<p>I am using StyleCop 4.7, Visual Studio 2012 and MSBuild 4.</p>\n\n<p>Here is a snippet of my Settings.StyleCop file :</p>\n\n<pre><code>&lt;StyleCopSettings Version=\"105\"&gt;\n  &lt;GlobalSettings&gt;\n    &lt;StringProperty Name=\"Culture\"&gt;en-GB&lt;/StringProperty&gt;\n  &lt;/GlobalSettings&gt;\n  &lt;Parsers&gt;\n    &lt;Parser ParserId=\"StyleCop.CSharp.CsParser\"&gt;\n      &lt;ParserSettings&gt;\n        &lt;BooleanProperty Name=\"AnalyzeDesignerFiles\"&gt;False&lt;/BooleanProperty&gt;\n      &lt;/ParserSettings&gt;\n    &lt;/Parser&gt;\n  &lt;/Parsers&gt;\n  &lt;Analyzers&gt;\n    &lt;Analyzer AnalyzerId=\"StyleCop.CSharp.SpacingRules\"&gt;\n      &lt;Rules&gt;\n        &lt;Rule Name=\"TabsMustNotBeUsed\"&gt;\n          &lt;RuleSettings&gt;\n            &lt;BooleanProperty Name=\"Enabled\"&gt;False&lt;/BooleanProperty&gt;\n          &lt;/RuleSettings&gt;\n        &lt;/Rule&gt;\n      &lt;/Rules&gt;\n      &lt;AnalyzerSettings /&gt;\n    &lt;/Analyzer&gt;\n  &lt;/Analyzers&gt;\n&lt;/StyleCopSettings&gt;\n</code></pre>\n\n<p>Any clues ?</p>\n\n<p>Cheers!</p>\n"},{"tags":["c#","sql-server","microsoft","sync"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":10,"score":1,"question_id":13265884,"title":"Microsoft Sync Framework for File (Client) and SQL Server Database (Server) synchronization","body":"<p>I'm trying to implement the syncing solution using Microsoft Sync Framework. The server will be SQL server database contains the documents in FileStream and client will be the File system (Windows OS). \nI have seen file synchronization provider with the Azure Blob Storage/Custom provider. But have not seen this. Do anybody have any idea on this.\nMy application scenario is :The database server contains the File/Documents in the form of byte array by the FileStream mechanism from SQL server.\nAnd the Sync activity will syncronize the documents from SQL server to any given file system.\nPlease help me out.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","class"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":50,"score":-2,"question_id":13123061,"title":"Updating GUI components in class B from class A in c#","body":"<p>EDIT: I see I'm getting a lot of downvotes on this post. I've tried to explain what I try to do, where my errors and in which direction want to go. I'm asking for insight in what I'm doing wrong. If you downvote; pleas tell me why, so I can improve the question. Thanks.</p>\n\n<p>I'm creating an application where I have one main form, and several different User Controls which the user works on. This helps me splitting the code, managing the different parts of the program. And it would be easy to expand the application later on.</p>\n\n<p>I'm trying to create a class where I manage the active controls I want to call one function in that class with as argument the form that should become active.</p>\n\n<p>An image can illustrate how I try to setup this application. <img src=\"http://i.stack.imgur.com/Jwimk.png\" alt=\"Illustration\"> Note that the control manager class is not a seperate class in the code i show below, but a partial class of the mainform. Any tips on how to get it like in the image are very welcome :)</p>\n\n<p>The class to manage all active forms looks like this: Please note that all user controls are just a user control with some buttons/textboxes etc on it. No code is added at all yet.</p>\n\n<pre><code>    public partial class STP2Main \n        {\n// I make each UserControl accessable for the whole class\n            SetupDeviceControl.SetupDevice SetupDev = new SetupDeviceControl.SetupDevice();\n            GenConfigFileControl.GenConfigFileControl GenConfFile = new GenConfigFileControl.GenConfigFileControl();\n            Monitoring.MonitoringControl Monitor = new Monitoring.MonitoringControl();\n            GenEncKeyControl.GenEncKeyControl GenEncKey = new GenEncKeyControl.GenEncKeyControl();\n            MenuControl.MenuControl MenuControl = new MenuControl.MenuControl();        \n\n            public void SelectActiveWindow()\n            {\n                // Any active control should be hidden thats what this function does:\n                HideCurrentActiveControl();\n                // Check whether the window is already created\n                if (!WindowExists())\n                { // if not created; create the windows: \n                    switch (STP_Design.ProgramParameters.C.NextActiveControl)\n                    {\n                        case STP_Data.Data.SetupDeviceControl: // control 1:\n                            STP_Design.ProgramParameters.C.CurrentActiveControl = STP_Data.Data.SetupDeviceControl;\n                            STP_Design.ProgramParameters.C.SetupDeviceControlIsCreated = true;\n                            SetupDev.Parent = this;\n                            SetupDev.Location = new Point(3, 30);\n                            SetupDev.Show();\n                            SetupDev.BringToFront();\n                            break;\n                        case STP_Data.Data.MonitoringControl: //control 2:\n                            STP_Design.ProgramParameters.C.CurrentActiveControl = STP_Data.Data.MonitoringControl;\n                            STP_Design.ProgramParameters.C.MonitoringControlIsCreated = true;\n                            Monitor.Parent = this;\n                            Monitor.Location = new Point(3, 125);\n                            Monitor.Show();\n                            Monitor.BringToFront();\n                            break;\n                        case STP_Data.Data.MenuControl: // control 3\n                            STP_Design.ProgramParameters.C.CurrentActiveControl = STP_Data.Data.MenuControl;\n                            STP_Design.ProgramParameters.C.MenuControlIsCreated = true;  \n                            MenuControl.Location = new Point(3, 30);\n                            MenuControl.Parent = this;\n                            MenuControl.Show();\n                            MenuControl.BringToFront();\n                            break;\n                    }\n                }\n                else\n                { // window is already created so needs to be called to front again:\n                    switch (STP_Design.ProgramParameters.C.NextActiveControl)\n                    {\n                        case STP_Data.Data.SetupDeviceControl:\n                            STP_Design.ProgramParameters.C.CurrentActiveControl = STP_Data.Data.SetupDeviceControl;\n                            SetupDev.BringToFront();\n                            break;\n                        case STP_Data.Data.MonitoringControl:\n                            STP_Design.ProgramParameters.C.CurrentActiveControl = STP_Data.Data.MonitoringControl;\n                            Monitor.Visible = true;\n                            Monitor.BringToFront();\n                            break;\n                        case STP_Data.Data.AdvancedMenu:\n                            STP_Design.ProgramParameters.C.CurrentActiveControl = STP_Data.Data.AdvancedMenu;\n                            tabControl1.Visible = true;\n                            tabControl1.BringToFront();\n                            break;\n\n                        case STP_Data.Data.MenuControl:\n                            STP_Design.ProgramParameters.C.CurrentActiveControl = STP_Data.Data.MenuControl;\n                            MenuControl.Visible = true;\n                            MenuControl.BringToFront();\n                            break;\n                    }\n\n                }\n                btnMenu.BringToFront();\n\n            }\n    // some functions which are called above are not shown; not relevant for this question\n    }\n</code></pre>\n\n<p>What I experience is the following: I get no errors at all. But the controls simply not change at all. If I call a window, it is created only once, because I did make it as partial class of my Mainform. (I've tried a complete seperate class, which did result in errors with threading, As I am not an experienced c# programmer, I tried to avoid that using a partial class.)</p>\n\n<p>I'll add another function; which does not do anything at all: </p>\n\n<pre><code>    private void HideCurrentActiveControl()\n    {\n        switch (STP_Design.ProgramParameters.C.CurrentActiveControl)\n        {\n            case STP_Data.Data.SetupDeviceControl:\n                SetupDev.Visible = false;\n                break;\n            case STP_Data.Data.MonitoringControl:\n                tabControl1.Visible = false;\n                Monitor.Visible = false;\n                break;\n            case STP_Data.Data.GenConfFileControl:\n                GenConfFile.Visible = false;\n                break;\n            case STP_Data.Data.GenEncKeyControl:\n                GenEncKey.Visible = false;\n                break;\n            case STP_Data.Data.MenuControl:\n                MenuControl.Visible = false;\n                break;\n            case STP_Data.Data.AdvancedMenu:\n                tabControl1.Visible = false;\n                break;\n            default:\n                tabControl1.Visible = false;\n                break;\n\n        }\n    }\n</code></pre>\n\n<p>I've tried debugging this part of code and it executes the statements, but I see no changes at all.</p>\n\n<p>I think I've shown what I am trying to do; and how I try to do that. My question is: How do I acces those forms so I can manage them from a seperate class (or in this case partial class of the main form).</p>\n\n<p>Then I have this last function, which does some wierd things. Before I call the SelectActiveWindow() function I update the variable STP_Design.ProgramParameters.C.NextActiveControl to for example:  ...AdvancedMenu. (this was before that ...MenuControl) But it does always show that it is still MenuControl. Nowhere in my code is something where I change that value besides right before I start the function. (I've also tried to make the nextcontrol as an argument of the function SelectActiveWindow() but this did the same)</p>\n\n<pre><code>    private bool WindowExists()\n    {\n        switch (STP_Design.ProgramParameters.C.NextActiveControl)\n        {\n            case STP_Data.Data.SetupDeviceControl:\n                if (STP_Design.ProgramParameters.C.SetupDeviceControlIsCreated)\n                    return true;\n                else\n                    return false;\n            case STP_Data.Data.MonitoringControl:\n                if (STP_Design.ProgramParameters.C.MonitoringControlIsCreated)\n                    return true;\n                else\n                return false;\n            case STP_Data.Data.GenConfFileControl:\n                if (STP_Design.ProgramParameters.C.GenConfFileIsCreated)\n                    return true;\n                else\n                    return false;\n            case STP_Data.Data.GenEncKeyControl:\n                if (STP_Design.ProgramParameters.C.GenEncKeyControlIsCreated)\n                    return true;\n                else\n                    return false;\n            case STP_Data.Data.AdvancedMenu:\n                return true;\n            case STP_Data.Data.MenuControl:\n                if (STP_Design.ProgramParameters.C.MenuControlIsCreated)\n                    return true;\n                else\n                    return false;\n\n            default:\n                return false;\n        }\n    }\n</code></pre>\n\n<p>Summery of what I am looking for: \nI am having a main form where display different user controlls in. I am trying to create a seperate class which is accessable from each control/form in my project. This class should manage the controls which are shown. In the code above I illustrated how I tried to do this, but this does not result in the expected result.</p>\n"},{"tags":["c#","wcf"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":419,"score":2,"question_id":11043909,"title":"how to detect WCF service shutdown or disconnect from client?","body":"<p>I'm building a WCF service,after a client connects to this service,when the service disconnect, the client doesn't notice that, and it doesn't fire any action, i would like to close client form whenever the connection lost,so how would i detect WCF service disconnect or shutdown from client side.</p>\n"},{"tags":["c#",".net","winforms","datagridview","editmode"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13261895,"title":"Exit edit mode from a control hosted in a cell","body":"<p>I have a custom datagridviewcolumn, a custom control hosted in a cell. I want to programmatically exit edit mode and validate the current value in the cell (this value is correct). I have checked below ways but without success:</p>\n\n<pre><code>this.datagridview.currentCell.datagridview.endEdit()\nthis.EditingControlDataGridView.endEdit()\nthis.datagridview.endEdit();\n</code></pre>\n\n<p>also by forcing the current cell to change:</p>\n\n<pre><code>this.datagridview.currentCell = this.datagridview.Rows[rowIndex].Cells[columnIndex]\n</code></pre>\n\n<p>I need to programmatically force the commit of the pending value in the cell because for example, there are cases that I need to delete a row of datagridview but as cell (in the same row being deleted) is in edit mode, I cannot do it if I do not commit changes for the cell and exit edit mode before.</p>\n\n<p>Also, I have similar strange behaviour when I want to exit edit mode but, in this case, discarding the changes in the cell: depending on the state of my application, sometimes doing this.datagridview.CancelEdit() works and sometimes not.</p>\n\n<p>Using C#, .NET Framework 4.0, WinForms.</p>\n"},{"tags":["c#",".net","winforms","picturebox","imagelist"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13263608,"title":"populate PictureBox with Images using Foreach loop","body":"<p>In my project I have collection of PictureBoxes and a filled ImageList. I want to populate each pictureBox with the each Image in ImageList using <code>foreach</code> Loop. I know how to do using For loop but I dont know how to do it using foreach loop. I am asking this just for knowledge purpose. I think this can be achieved using Linq inside foreach loop but I am a beginner so I have no Idea how to do it.</p>\n\n<p>I tried the below code in for loop:</p>\n\n<pre><code>        for (intimgcount = 0; intimgcount &lt; intMaxPics; intimgcount++)\n        {                \n            pbxCollection[intimgcount].Image = imglst.Images[intimgcount];          \n        }     \n</code></pre>\n\n<p>the code which  I want to use in <code>foreach</code> loop is:</p>\n\n<pre><code>        var pbxCollection = new List&lt;PictureBox&gt;();  //PictureBox collection\n</code></pre>\n\n<p>EDIT:  How to set the positions of Picture Box collection in the form?</p>\n\n<p>I tried:</p>\n\n<pre><code>        var i = 0;\n        foreach (var pbx in pbxCollection)\n        {\n            pbx.Image = imglst.Images[i++];\n            //set location:\n            pbx.Width = 100;\n            pbx.Height = 100;\n            pbx.Location = new Point(0, pbx.Height * i);\n            //add to form:\n            this.Controls.Add(pbx);\n        }  \n</code></pre>\n"},{"tags":["c#","datetime","time","timezone","nodatime"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":86,"score":4,"question_id":12902043,"title":"Is noda-time applicable in this case?","body":"<p>The project I work on is basically a data collector.  By way of orientation, it may help to think of it as Wireshark (or equivalent) with parsing/analysis capabilities of the Application layer (OSI Layer 7).  The current version is a legacy MFC application with 15+ years under its belt.  It still works, but maintenance, stability, and scalability are real concerns that we are facing.  The project leadership team has recently agreed that we need to begin developing the next generation of the product, and we are targeting .NET as the product is strictly a Windows desktop-based product.</p>\n\n<p>Given that our users routinely analyze log files collected literally around the world, message timestamping is very important.  The current product uses <code>_ftime_s()</code> to assign a timestamp, and I had assumed we would simply use <code>System.DateTime.UtcNow</code> to get timestamps in the future on the .NET side.  That is, until I read about <a href=\"http://code.google.com/p/noda-time/\" rel=\"nofollow\">noda-time</a>.  Now, I'm thinking that our problem domain requires more care concerning time-related functionality than I had ever cared to consider.</p>\n\n<p>So a few questions.</p>\n\n<ol>\n<li><p>From the description I've provided above, does it make sense to incorporate <a href=\"http://code.google.com/p/noda-time/\" rel=\"nofollow\">noda-time</a> using <code>NodaTime.Instant</code> for timestamping?</p></li>\n<li><p>Given a choice, I'd much prefer to pay for dedicated support than use an open-source project for fear (paranoia?) that the project is abandoned.  Any thoughts or guidance on this point from those more inclined to embrace the open-source philosophy?</p></li>\n<li><p><a href=\"http://code.google.com/p/noda-time/\" rel=\"nofollow\">noda-time</a> is currently in its 2nd beta.  Is there a target date for NodaTime 1.0.0?</p></li>\n</ol>\n"},{"tags":["c#",".net","vb.net","richtextbox","rtf"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13265762,"title":"How to add a rtf formatting in the text string for a Richt Text Box?","body":"<p>In a .NET project I have a long plain text build as concatenation of several strings</p>\n\n<pre><code>StringLongText = text1 + text2 + ... + textN\n</code></pre>\n\n<p>each string \"textX\" is the result of an evaluation. \nAt the end of a started process, I show the result in a RichTextBox doing simply:</p>\n\n<pre><code>rtfTxt.Text = StringLongText\n</code></pre>\n\n<p>All works fine, but I am not able to add any text formatting in the previous text1, text2, textN blocks.</p>\n\n<p>For example I would like to write some words in bold or italic including the formatting directly in the strings before concatenating them.</p>\n\n<p>Doing</p>\n\n<pre><code>text1 = \"This is some {\\b bold} text\"\nrtfTxt.Text = text1\n</code></pre>\n\n<p>did not work.</p>\n\n<p>Any suggestion? Thank you for your help.</p>\n"},{"tags":["c#","asp.net","jquery-ui","internet-explorer-7"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2477,"score":0,"question_id":405043,"title":"Response.Redirect with # anchor, does not work in IE7","body":"<pre><code>Response.Redirect(string.Format(\"myprofile.aspx?uid={0}&amp;result=saved#main\",user.UserID));\n</code></pre>\n\n<p>said code translates to</p>\n\n<p>IE7 - myprofile.aspx?uid=933fdf8e-1be0-4bc2-a269-ac0b01ba4755&amp;result=saved</p>\n\n<p>FF- myprofile.aspx?uid=933fdf8e-1be0-4bc2-a269-ac0b01ba4755&amp;result=saved#main</p>\n\n<p>why does IE7 drop my anchor?</p>\n\n<p>edit: I should mention I am using this in conjunction with jQuery UI's tab control.  I want the postback to tab into a specific tab.</p>\n"},{"tags":["c#","ports"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13265757,"title":"How do I make sure my packet goes to my router before returning to my pc?","body":"<p>I'm new to socket programming and trying to create a port scanner to check if my router ports are open but I dont know how I can make it go via the router, can someone help please? Here is my code: </p>\n\n<pre><code>int port;\n    IPAddress ipa;\n    private void scanPort()\n    {\n            ipa = IPAddress.Parse(tbIP.Text);\n            for (port = Convert.ToInt32(tbMinPort.Text); port &lt;= Convert.ToInt32(tbEndPort.Text); port++)\n            {\n                listener = new Thread(listening);//create listener\n                listener.Start();\n                try\n                {\n                    sock = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);\n                    sock.Connect(ipa, port);\n                    if (sock.Connected == true)  // Port is in use and connection is successful\n                        lboxPortOpen.Invoke(new MethodInvoker(delegate { lboxPortOpen.Items.Add(port.ToString()); lboxPortOpen.SelectedIndex += 1; }));\n                    sock.Close();\n                }\n                catch (SocketException ex)\n                {\n                    if (ex.ErrorCode == 10061)  // Port could not establish connection \n                        lboxPortClosed.Invoke(new MethodInvoker(delegate { lboxPortClosed.Items.Add(port.ToString() + \"*\"); lboxPortClosed.SelectedIndex += 1; }));\n                    else //blocked for a other reason\n                        lboxPortClosed.Invoke(new MethodInvoker(delegate { lboxPortClosed.Items.Add(port.ToString()); lboxPortClosed.SelectedIndex += 1; }));\n                }\n            }\n    }\n    TcpClient client;\n    private void listening()\n    {\n        try\n        {\n            TcpListener server = new TcpListener(ipa, port);\n            server.Start();\n            client = server.AcceptTcpClient();\n            client.Close();\n        }\n        catch (SocketException e)\n        {\n            MessageBox.Show(\"SocketException: \" + e);\n        }\n    }\n</code></pre>\n"},{"tags":["c#",".net","ado.net"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13265704,"title":"Conversion error from database smallint into C# nullable int","body":"<p>I have a security_role_cd column in database of <code>smallint</code> datatype. I am selecting this column using following code into a <code>nullable int</code> variable. </p>\n\n<p>I am getting following error: </p>\n\n<blockquote>\n  <p>Error     3       Type of conditional expression cannot be determined because there is no implicit conversion between 'null' and 'short'        </p>\n</blockquote>\n\n<p>What is the correct code to overcome this error?</p>\n\n<pre><code>SELECT R.security_role_cd  FROM Security_Role R WHERE security_role_name = 'Admin'\n</code></pre>\n\n<p>C# </p>\n\n<pre><code>        int? roleID = null;\n        string commandText = \"SELECT R.security_role_cd  FROM Security_Role R WHERE security_role_name = @roleName\";\n        SqlCommand command = new SqlCommand(commandText, connection);\n        command.CommandType = System.Data.CommandType.Text;\n        command.Parameters.AddWithValue(\"@roleName\",roleName);\n        SqlDataReader readerRole = command.ExecuteReader();\n        if (readerRole.HasRows)\n        {\n            while (readerRole.Read())\n            {\n                roleID = readerRole.GetInt16(0) == 0 ? null : readerRole.GetInt16(0) ;\n\n            }\n        }\n        readerRole.Close();\n</code></pre>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13262949,"title":"Change Cursor when combobox dropdown is open","body":"<p>I want to change the cursor to \"Hand\" when dropdown of a combobox is open.\nSo I did the below on <code>comboBox1_DropDownOpened</code> event. But the problem is cursor changes. But when I move through the menu Items the Cursor is remaining  as a Arrow.</p>\n\n<p>Please advice me.</p>\n\n<pre><code>private void comboBox1_DropDownOpened(object sender, EventArgs e)\n{    \n    this.Cursor = Cursors.Hand;    \n}\n</code></pre>\n"},{"tags":["c#","design","model","resx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13242254,"title":"resx location relative to model classes","body":"<p>What's the recommended strategy for storing resource files that are used by data annotations in a model project? For example by the resourcetype property of the displayattribute.</p>\n\n<p>Should these resource files be stored in the same project as the model classes or contained separately elsewhere? </p>\n\n<p>I am just wondering if they should be stored elsewhere to allow the resource files to be updated without recompiling the model project.</p>\n"},{"tags":["c#","asp.net","radiobuttonlist"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13264783,"title":"Repeater control radiobuttonlist always retun null value","body":"<p>I'm using the below code to read radio button list value. But it always returns null. Please help me to fix this issue.</p>\n\n<pre><code>foreach (RepeaterItem item in repeaterItems.Items)\n{\n    if (item.ItemType == ListItemType.Item || item.ItemType == ListItemType.AlternatingItem)\n    {\n        lbl_slno = (Label)item.FindControl(\"id\");\n        lbl_ques = (Label)item.FindControl(\"lblques\");\n        radiobtn = (RadioButtonList)item.FindControl(\"rdbtn\");\n        string radio_value = radiobtn.SelectedItem.Value;\n        //radio_value return \"Object reference not set to an instance of an object.\"\n    }\n}\n\n&lt;ItemTemplate&gt;\n    &lt;table cellspacing=\"0\" width=\"100%\" align=\"center\"&gt;\n        &lt;tr&gt;\n            &lt;td style=\"width: 42px;\" class=\"cu_style\" &gt;\n                &lt;asp:Label ID=\"id\" runat=\"server\" Text='&lt;%#Bind(\"fld_id\")%&gt;'&gt;&lt;/asp:Label&gt;\n            &lt;/td&gt;\n            &lt;td style=\"width: 503px;\" class=\"cu_style\"&gt;\n                &lt;asp:Label ID=\"lblques\" runat=\"server\" Text='&lt;%#Bind(\"fld_Question\")%&gt;'&gt;&lt;/asp:Label&gt;\n            &lt;/td&gt;\n            &lt;td style=\"width: 80px;\" class=\"cu_style\" colspan=\"3\"&gt;\n                &lt;asp:RadioButtonList ID=\"rdbtn\" Width=\"229px\" runat=\"server\" RepeatDirection=\"Horizontal\" &gt;\n                &lt;asp:ListItem Text=\"Agree\"&gt;Agree&amp;nbsp;&lt;/asp:ListItem&gt;\n                &lt;asp:ListItem Text=\"Neutral\"&gt;Neutral&amp;nbsp;&amp;nbsp;&lt;/asp:ListItem&gt;\n                &lt;asp:ListItem Text=\"Disagree\"&gt;Disagree&lt;/asp:ListItem&gt;\n                &lt;/asp:RadioButtonList&gt;\n            &lt;/td&gt;\n\n        &lt;/tr&gt;\n    &lt;/table&gt;\n&lt;/ItemTemplate&gt;\n</code></pre>\n\n<p>My deign code is here,..</p>\n"},{"tags":["c#",".net","asp.net-mvc-3","svn","ssl"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":1020,"score":5,"question_id":8121189,"title":"Ignoring invalid SSL certificate","body":"<p>I`m trying to print out log messages from our sub version. But I'm struggling with bypassing the invalid SSL certificate. This is the error:</p>\n\n<blockquote>\n  <p>OPTIONS of\n  'https://xxxxx/svn/SiteFabrics/trunk/AppLaunch/Bloc/Frontend': Server\n  certificate verification failed: certificate issued for a different\n  hostname, issuer is not trusted (https://xxxx)</p>\n</blockquote>\n\n<p>My attempt of ignoring the certificate error was to add this line:</p>\n\n<pre><code>ServicePointManager.ServerCertificateValidationCallback += (sender, cert, chain, sslPolicyErrors) =&gt; true;\n</code></pre>\n\n<p>However that didn't make any difference as the .net error is still the same. Below is the code, can anyone see what I am doing wrong?</p>\n\n<pre><code>        using (SvnClient client = new SvnClient())\n        {\n            Collection&lt;SvnLogEventArgs&gt; list;\n            client.Authentication.DefaultCredentials = new NetworkCredential(\"user\", \"pass\");\n\n            ServicePointManager.ServerCertificateValidationCallback += (sender, cert, chain, sslPolicyErrors) =&gt; true;\n\n            SvnLogArgs la = new SvnLogArgs(); //{ Start=128; End=132; };\n            client.LoadConfiguration(Path.Combine(Path.GetTempPath(), \"Svn\"), true);\n            client.GetLog(new Uri(\"https://[svnurl]\"), la, out list);\n            ViewBag.SVNLog = list;\n        }\n</code></pre>\n\n<p>FOUND THE SOLUTION TO THIS PROBLEM:</p>\n\n<p>First add this:</p>\n\n<pre><code>        static void SVN_SSL_Override(object sender, SharpSvn.Security.SvnSslServerTrustEventArgs e)\n    {\n        e.AcceptedFailures = e.Failures;\n        e.Save = true;\n    }\n</code></pre>\n\n<p>and then replace my original magic line:</p>\n\n<pre><code>            ServicePointManager.ServerCertificateValidationCallback += (sender, cert, chain, sslPolicyErrors) =&gt; true;\n</code></pre>\n\n<p>with this:</p>\n\n<pre><code>client.Authentication.SslServerTrustHandlers += new EventHandler&lt;SharpSvn.Security.SvnSslServerTrustEventArgs&gt;(SVN_SSL_Override);\n</code></pre>\n"},{"tags":["c#","oop","inheritance"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":13265284,"title":"Will a method overriden in a subclass still be called when the object of subclass is called as superclass?","body":"<p>Ok lets say I have two classes with the same method(sampleMethod) which is overridden by the child: ObjectParent and ObjectChild</p>\n\n<pre><code>ObjectChild ExampleVariable = new ObjectChild();\n(ExampleVariable as ObjectParent).sampleMethod();\n</code></pre>\n\n<p>Will this call the sampleMethod from ObjectChild or from ObjectParent??</p>\n\n<p>I think it will call the sampleMethod from ObjectChild, but I want to make sure before I throw down a bunch of code based on that assumption.</p>\n"},{"tags":["c#","jquery",".net","infragistics","ignite-ui"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1282,"score":1,"question_id":734312,"title":"jQuery Modal Example with .Net 2.0 Infragistics Grid","body":"<p>I'm new to jQuery (I must have had my head buried in sand for the last few years!) and I'm wondering if I could use it with an Infragistics grid for updating and inserting instead of the edit row template. We're currently constrained to using the 2.0 framework, and I'm stuck with the infra grids as well.</p>\n\n<ul>\n<li><p>Does anyone know if this is possible?</p></li>\n<li><p>Do you think this is a bad/good idea?</p></li>\n<li><p>Any good sample/walk-throughs out<br />\nthere?</p></li>\n</ul>\n\n<p>Any, and all, advice/opinions appreciated! </p>\n"},{"tags":["c#","itextsharp","wkhtmltopdf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13265592,"title":"Unable to print Check Boxes in pdf","body":"<p>We are using WkHtmlToPdf to convert from html to pdf. Now I have make all the form fields editable on request as well. Since there is a bug in WkHtmlToPdf while converting Html to Pdf it makes all the form field's property as Visible Not Printable. </p>\n\n<p>To get around this problem we are using ITextSharp to read existing pdf that has been generated by WkHtmlToPdf and setting that property as Visible for every form field.</p>\n\n<p>This is how I am doing that</p>\n\n<pre><code>        var pdfReader = new PdfReader(inputFilename);\n\n        using (var outputStream = new FileStream(outputFilename, FileMode.OpenOrCreate))\n        {\n            var stamper = new PdfStamper(pdfReader, outputStream);\n\n            // Regenarating all the fileds using itextSharp. \n            // Since wkHtmltoPdf has differnt default settings for pdf form fields (Visible and not Printable)\n            var formFields = stamper.AcroFields;\n            var filedNames = formFields.Fields.Keys;\n\n            foreach (var keyName in filedNames)\n            {\n                formFields.SetFieldProperty(keyName, \"setflags\", PdfAnnotation.FLAGS_PRINT, null);\n                formFields.SetFieldProperty(keyName, \"setflags\", PdfFormField.FF_EDIT, null);\n                formFields.SetFieldProperty(keyName, \"textsize\", 8.0f, null);\n                formFields.RegenerateField(keyName);\n              }\n          }\n</code></pre>\n\n<p>This solved my problem for all the fields but check Boxes. I have few check boxes in html which are converted to pdf using WkHtmlToPdf. I realized that when ever I try to RegenerateField() (Last line in foreach loop) check box is loosing all its properties (Whether I checked or unchecked) it is only showing empty check box, and its not editable.</p>\n\n<p>To solve this problem I came up with the following </p>\n\n<pre><code>if (formFields.GetFieldType(keyName).Equals(AcroFields.FIELD_TYPE_CHECKBOX))\n{\n                    // Regenerate checkbox formfield causing it to reset all its properties \n                    // including checkd/uncheked property     \n                    formFields.SetFieldProperty(keyName, \"setflags\", PdfAnnotation.FLAGS_PRINT, null);\n\n// Ignore the commented code as it is not working Not sure why??? and how\n\n                    //var item = formFields.GetFieldItem(keyName);\n                    //var appearance = item.GetValue(0).Get(PdfName.AS);\n\n                    //if (appearance != null)\n                    /{\n                    //    if (appearance.tostring().tolower().equals(\"/yes\"))\n                    //    {\n                    //        formfields.regeneratefield(keyname);\n\n                     // Not even one working when I try to set the check box status like below\n                    //        success  = formfields.setfield(keyname, \"yes\");\n                    //        success  = formfields.setfield(keyname, \"/yes\");\n                    //        success  = formfields.setfield(keyname, \"/yes\");\n                    //        success = formfields.setfield(keyname, \"on\");\n                    //        success =  formfields.setfield(keyname, \"1\");\n\n\n                    //    }\n                    }\n</code></pre>\n\n<p>With the code (excluding commented) code Check box successfully retaining its status and displaying in the generated Pdf. But it's not printing. I checked the properties of check box it's visible like any other fields in the pdf. Apart from check boxes all the fields(text boxes) are printing its values. </p>\n\n<p>I am checking properties through --> Open pdf document--> Forms--> Add/Edit Fields</p>\n\n<p>What am I doing wrong here? Instead of setting property on check box I tried to construct a brand new check box using Itextsharp but I couldn't using ItexSharp manual example. DO anyone did this stuff before? </p>\n\n<p>Even if I generate a new check box using ItextSharp, how can I replace exactly existing check box?    </p>\n\n<p>Thanks a lot for reading my story..</p>\n"},{"tags":["c#","wpf","vb.net"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":176,"score":1,"question_id":9263965,"title":"How to calculate font size of TextBlock to fill in Canvas?","body":"<p>What I need is some <strong>formula</strong> to calculate <strong>font size</strong> of <code>TextBlock</code> for its owner -  <code>Canvas</code>.</p>\n\n<p>Let's say I have <code>Canvas</code> height 100.0 then which <strong><code>TextBlock</code> font size</strong> should be to fill all space of the <code>Canvas</code>?</p>\n\n<p><em>P.S. The main problem is that I scroll those TextBlocks horizontally...</em></p>\n"},{"tags":["c#","itunes","com-interop","itunes-sdk"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":218,"score":1,"question_id":6718142,"title":"How can I use iTunesLib in unattended mode?","body":"<p>I'm making a little app to automate my iPod update. My purpose is sync my iTunes library with my actual one and reencode songs in a lower quality for the iPod.</p>\n\n<p>I use the Interop \"iTunesLib\" from iTunes.exe and I'm working on C#.</p>\n\n<p>My program works pretty well but I have a big issue with iTunes. If a modal box is opened by iTunes during the process (could be \"error while importing song\", or just even \"a new update is available\" at iTunes startup...), then my app is completely stuck and must wait for the user to close the popup.</p>\n\n<p>This is annoying because I expected to run my app at night and the process of reimporting/reencoding takes a while.</p>\n\n<p>Is there any way to either tell iTunes to not pop any message, or to ask it to close an already opened one?</p>\n"},{"tags":["c#","excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":20,"score":-4,"question_id":13265560,"title":"write a string value into a excel sheet using c# with parameterized function","body":"<p>I have to write a set of string values into a excel sheet using function parameters to a particular cell row,col .</p>\n\n<p>Please give inputs   </p>\n"},{"tags":["c#","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13265483,"title":"Height/2 is equal to the maximum font size to fill the height. Is it correct?","body":"<p>I found that half of the text height is same as to the maximum font size to fill the Height.</p>\n\n<pre><code>double fontSize = textHeight/ 2;\n</code></pre>\n\n<p>Is it true?</p>\n"},{"tags":["c#",".net","eval","repeater"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13255146,"title":"Can I manage variables on #Eval inside a repeater?","body":"<p>Tried :</p>\n\n<pre><code>string immagine = (Eval(\"Immagine\").ToString());\n</code></pre>\n\n<p>inside a C# repeater .ascx, but seems that I can't? <em>System.InvalidOperationException: Databinding methods such as Eval(), XPath(), and Bind() can only be used in the context of a databound control.</em></p>\n\n<p><strong>EDIT</strong></p>\n\n<p>The only way I found is to write :</p>\n\n<pre><code>&lt;%#(Eval(\"Immagine\").ToString() != Eval(\"Immagine\").ToString() ? \"\" : \"\")%&gt;\n</code></pre>\n\n<p>Dunno why it doesnt works with an if/else statement...</p>\n"},{"tags":["c#","asp.net-mvc","razor","infragistics","ignite-ui"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":13121902,"title":"Infragistics grid's GET returning empty response","body":"<p>I'm trying to use Infragistics' grid to display a list of items from my Database. I'm using code-first method with Entity Framework in an MVC application with Razor engine. Every thing is working fine in the view except the Infragistics grid.</p>\n\n<p>Here is my home view:</p>\n\n<pre><code>@using Infragistics.Web.Mvc\n@model IEnumerable&lt;BusinessModel.Models.TestPlan&gt;\n\n@{\n    ViewBag.Title = \"Home\";\n}\n\n@( Html.Infragistics().Grid&lt;BusinessModel.Models.TestPlan&gt;(Model)\n.AutoGenerateColumns(true)\n.DataSourceUrl(Url.Action(\"igListTestPlan\"))\n.DataBind()\n.Render())\n</code></pre>\n\n<p>Here is my controller:</p>\n\n<pre><code>[GridDataSourceAction]\npublic ActionResult igListTestPlan()\n{\n    return View(service.getListTestPlan());\n}\n</code></pre>\n\n<p>Using firebug I can clearly see that the request is sent with a status code \"200 OK\", but the response tab is empty. It also causes an error in the console (in infragistics.js):</p>\n\n<pre><code>Uncaught TypeError: Cannot read property 'length' of undefined \n</code></pre>\n\n<p>I guess it's because of the empty response.</p>\n\n<p><strong>What I tried:</strong></p>\n\n<p>Debugging my controller showed me that <code>return View(service.getListTestPlan());</code> doesn't return an empty list: I have 3 valid items in.</p>\n\n<p>I also tried <code>Html.Infragistics().Grid&lt;BusinessModel.Models.TestPlan&gt;(Model__.ToList())</code> but nothing changed. Also <code>Html.Infragistics().Grid(Model)</code> tells me I've got invalid parameters</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","asp.net-mvc-3","stream"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13265392,"title":"The downloaded file as stream in controller (ASP.NET MVC 3) will automatically disposed?","body":"<p>Let's assume the controller which download selected file:</p>\n\n<pre><code> public FileResult Download( string f ) {\n\n         Stream file = MyModel.DownloadFiles( f );\n\n         return File( file, \"application/octet-stream\", (file as FileStream).Name );\n }\n</code></pre>\n\n<p>and <strong>MyModel</strong> contains</p>\n\n<pre><code>public static Stream DownloadFiles(string file){\n\n   return new FileStream(file, FileMode.Open, FileAccess.Read);\n}\n</code></pre>\n\n<p>If I use <code>using</code> keyword in controller then the exception will be thrown: <strong><code>Cannot access closed file</code></strong>.</p>\n\n<p>Well, I want to be sure that downloaded file will be disposed (I don't know if is possible, how to do that) or not ?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","linq","odata","infragistics","ignite-ui"],"answer_count":1,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":503,"score":2,"question_id":8711709,"title":"Mapping $filter from oData parameter to linq Where","body":"<p>I've got (what I think is a odata format) url like this:</p>\n\n<pre><code>http://localhost:2282/SSE.Web/History.cshtml?GetData=true&amp;itemId=AKE-00129&amp;pid=1&amp;%24filter=indexof(ItemType%2C%27Attri%27)+ge+0&amp;%24skip=0&amp;%24top=50&amp;%24inlinecount=allpages&amp;_=1325589443808\n</code></pre>\n\n<p>what is interesting here is the $filter parameter. It has the format \"indexof(ItemType,'Attri') ge 0\"</p>\n\n<p>The source is an grid (iggrid from infragistics) that is filtering on the ItemType column with text 'Attri'</p>\n\n<p>My question is: Mapping the top and skip parameters was trivial, but how to do the filter. Do I need to parse it and build my own linq, or are there some other ways?</p>\n\n<p>This is the code I have so far:</p>\n\n<pre><code>        var skip = int.Parse(Request[\"$Skip\"]);\n    var top = int.Parse(Request[\"$top\"]);\n    var filter = Request([\"$filter\"]);\n\n    var db = Database.Open(\"SSEConnectionString\");\n\n    var entries = db.Query(\"select * from eHistory order by timestamp desc\")\n    Json.Write(new { results = entries.Where(????).Skip(skip).Take(top), totalRecCount = entries.Count() }, Response.Output);\n</code></pre>\n\n<p>Thanks for any help!</p>\n\n<p>Larsi</p>\n"},{"tags":["c#","qt","tcp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13256775,"title":"How can I compare arrived TCP/IP data in Qt","body":"<p>I’m trying to compare arrived data in TCP-Client with a QString. But I think, it’s a wring format for comparison. My TCP client is written in Qt and TCP server in C#. Here is example code of Qt my read-function: </p>\n\n<pre><code>void MyClient::slotReadyRead()\n{\n    QString okStr = \"OK!\";\n    ui-&gt;textEdit-&gt;append(okStr);\n    ui-&gt;textEdit-&gt;append(\"Reading...\");\n    QString str = socket-&gt;readAll();\n    ui-&gt;textEdit-&gt;append(str);\n    if(str == okStr)\n        ui-&gt;textEdit-&gt;append(\"OK! is true\");\n    else\n        ui-&gt;textEdit-&gt;append(\"OK! is false\");\n}\n</code></pre>\n\n<p>And here is C#-server code for writing commands “OK!”:</p>\n\n<pre><code>private void WriteOutput(Commands cmd)\n{\n    if (NS == null)\n        return;\n\n    string str = Enum.GetName(typeof(Commands), cmd);\n    StreamWriter writer = new StreamWriter(NS);\n    writer.WriteLine(str + \"!\");\n    writer.Flush();\n}\n</code></pre>\n\n<p>In this case cmd would be <strong>„OK“</strong>.In Qt-TCP Client I get following messages:\n<strong>OK!\nReading...\nOK!</strong></p>\n\n<p>OK! is false\nBut I would like to have a <strong>OK! is true</strong> :). Which data-format should I choose?</p>\n"},{"tags":["c#","sql","linq","linq-to-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13265209,"title":"Executing SQL Function Using Linq","body":"<p>I have created a function in MSSQL 2005 and I want to run this function using linq. My function has 2 parameters. The definition is seen below:</p>\n\n<pre><code>USE [MobileGateway]\nGO\n/****** Object:  UserDefinedFunction [dbo].[Fn_GetNoLocationAddress]    Script Date: 11/07/2012 08:27:58 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nALTER FUNCTION [dbo].[Fn_GetNoLocationAddress] \n(   \n    -- Add the parameters for the function here\n    @Site nvarchar(255),\n    @ReceivedDate int\n)\nRETURNS @noLocationAddress TABLE (\n\nRequestID int NOT NULL,\nBarcode varchar(50) NOT NULL,\nAdrID int NOT NULL,\nName varchar(50) NOT NULL,\nStreet varchar(50) NOT NULL,\nHouseNo varchar(4) NOT NULL,\nPostal varchar(8) NOT NULL,\nCity varchar(50) NOT NULL,\nCountry varchar(50) NOT NULL,\nLatitude varchar(50) NOT NULL,\nLongitude varchar(50) NOT NULL,\nReveivedDate datetime NOT NULL\n)\nAS \nBEGIN\n    -- Add the SELECT statement with parameter references here\nINSERT INTO @noLocationAddress \nSELECT     TOP (100) PERCENT Request1.RequestID, TrackIT.dbo.Sending.Barcode, TrackIT.dbo.Address_View.AdrID, TrackIT.dbo.Address_View.Name, \n                      TrackIT.dbo.Address_View.Street, TrackIT.dbo.Address_View.HouseNo, TrackIT.dbo.Address_View.Postal, TrackIT.dbo.Address_View.City, \n                      TrackIT.dbo.Address_View.Country, Request1.Latitude, Request1.Longitude, Request1.ReceivedDate\nFROM         (SELECT DISTINCT RequestID, LTRIM([Content]) AS Barcode, Latitude, Longitude, ReceivedDate\n                       FROM          dbo.RequestWithLocation\n                       WHERE      (Site LIKE @Site) AND ([Content] &lt;&gt; '') AND (AddressID = '0') AND (ReceivedDate &gt; DATEADD(day, -@ReceivedDate, GETDATE()))) AS Request1 INNER JOIN\n                      TrackIT.dbo.Sending ON Request1.Barcode = TrackIT.dbo.Sending.Barcode INNER JOIN\n                      TrackIT.dbo.Address_View ON TrackIT.dbo.Sending.DeliveryAdrID = TrackIT.dbo.Address_View.AdrID\n\nORDER BY TrackIT.dbo.Address_View.AdrID\n\nRETURN\n\nEND\n</code></pre>\n\n<p>As you can see I have 2 parameters and I'm returning a table with the information. But I need to use linq for executing the this function.\nCan anyone help? thanks</p>\n"},{"tags":["c#","outlook"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":16,"score":-3,"question_id":13265374,"title":"How to retrieve the URL in the email content from Outlook 2010","body":"<p>I try to develop an c# application which will retrieve the URL in the email content from Outlook 2010, means it will auto detect the URL in the email content. Is there any method to do that?</p>\n"},{"tags":["c#","jquery","asp.net-mvc-4"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13265047,"title":"MVC 4.0 assign model property to j query varibale","body":"<p>Please assist here if its possible or suggest me the other way</p>\n\n<p>C# code is as</p>\n\n<pre><code> public ActionResult Create()\n    {\n        var newCircuit = new CircuitViewModel();\n        newCircuit.Workouts = _db.Workouts.ToList();\n        newCircuit.MemberId = _memberId;\n        return View(newCircuit);\n    }\n</code></pre>\n\n<p>on cshtml page code is as</p>\n\n<pre><code> @Html.DropDownList(\"ddlWorkout\", new SelectList(Model.Workouts, \"Id\", \"Name\"), \"--Select Workout--\", new { required = true, style = \"width:310px\", onchange = \"GetExercise(this)\" })\n</code></pre>\n\n<p>Jquey Code is as:</p>\n\n<pre><code>function GetExercise() {     \n    var Workouts = @Model.Workouts\n    var AllExercises = Workouts[0].Exercises; \n}\n</code></pre>\n\n<p>Basically in model I have workouts and under each workout there are multiple exercises, so when I select workout I want to show all exercises and If I choose another workout then so its relevant exercises, so on...</p>\n\n<p>So basically I want to set @Model.Workouts in jquery Workouts variable. But above jqury code is not working for me. </p>\n"},{"tags":["c#","asp.net","linq","gridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13261444,"title":"Appending LINQ to exist datasource/gridview in C#","body":"<p>I have the following in my .aspx page:</p>\n\n<pre><code>&lt;asp:GridView ID=\"Table1\" runat=\"server\" AutoGenerateColumns=\"False\"    BorderColor=\"Black\" OnRowCreated=\"Table1_RowCreated\" OnRowDataBound=\"Table1_RowDataBound\" CellPadding=\"3\" CellSpacing=\"0\" DataSourceID=\"Table1DataSrc\" DataKeyNames=\"Field1\"&gt;\n&lt;Columns&gt;\n&lt;asp:BoundField DataField=\"Field1\" HeaderText=\"Field1\" SortExpression=\"Field1\"&gt;\n     &lt;ItemStyle HorizontalAlign=\"Left\" Font-Size=\"8\" Wrap=\"false\" /&gt;\n     &lt;HeaderStyle CssClass=\"header\" Font-Size=\"8\" /&gt;\n &lt;/asp:BoundField&gt;\n &lt;/Columns&gt;\n &lt;/asp:GridView&gt;\n</code></pre>\n\n<p>Where the gridview has a DataSource that loads a few fields. In my C# code behind, I have the following function which runs a LINQ query to process a stored procedure (on a different server than my other datasource) </p>\n\n<pre><code>    private void RenderTables()\n    {\n        SqlDataAdapter adapter = new SqlDataAdapter();\n        DataTable dt = new DataTable();\n\n        using (SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings[\"MyConnectionString\"].ConnectionString))\n        {\n            conn.Open();\n            SqlCommand cmd = new SqlCommand(\"sp_special\", conn);\n            cmd.CommandType = System.Data.CommandType.StoredProcedure;\n            cmd.Parameters.AddWithValue(\"@AmIY\", \"Y\");\n            adapter.SelectCommand = cmd;\n            adapter.Fill(dt);\n            adapter.Dispose();\n            conn.Close();\n        }\n        var enumvar = dt.AsEnumerable();\n        var query = from x in enumvar\n                    orderby x.Field&lt;string&gt;(3)\n                    select new \n                    { \n                        Field3 = x.Field&lt;string&gt;(3),\n                        Field4 = x.Field&lt;int&gt;(4),\n                    };\n        //I do some data manipulation using LINQ, but omitted here\n        //do something with query.....\n    }\n</code></pre>\n\n<p>How would I add new columns Field3 and Field4 to my Gridview and bind these new records? I do not want to store anything in temp tables on either servers</p>\n"},{"tags":["c#","sql-server","linq","linq-to-sql","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":52,"score":-2,"question_id":13262409,"title":"Why not get the desired output from stored procedure","body":"<p>To fulfill one of my requirements I need to pass a SQL query as a parameter to a stored procedure.</p>\n\n<p>My stored procedure syntax is:</p>\n\n<pre><code>create PROCEDURE spSelect \n    @Query VARCHAR(500)\nAS \n    EXEC( @Query)  \n    return  \n</code></pre>\n\n<p>To execute that stored procedure, I use this C# code:</p>\n\n<pre><code>DataContex db=new DataContex();\n    String sSQL = \" SELECT OrderID,ShipName FROM dbo.Orders\";\n    var result = db.spSelect(sSQL);\n</code></pre>\n\n<p>After execution, the <code>result</code> is <code>0</code>.</p>\n\n<p>Need help to understand what happen, why not I get desired output</p>\n\n<p>If have any query please ask, thanks in advance</p>\n"},{"tags":["c#","asp.net","web-services","api"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13263674,"title":"Which object will I spend from client to webservices function?","body":"<p>I use AddWebReference in VisualStudio tools.\nIt auto generate Reference.cs class.\nI don't know which object class will I need to pass from web client to webservices function.\nIt's seem use \"out\" parameter at Webservices function.So that,It can't pass a object from client to webservices.</p>\n\n<pre><code>[SoapRpcMethod(\"\", RequestNamespace = \"urn:ALBAPI\", ResponseNamespace = \"urn:ALBAPI\")]\npublic ResponseInfo getAdvSoftware(out AdvSoftwareValues values);\npublic void getAdvSoftwareAsync();\npublic void getAdvSoftwareAsync(object userState);\n\n[Serializable]\n[DesignerCategory(\"code\")]\n[GeneratedCode(\"System.Xml\", \"2.0.50727.4927\")]\n[SoapType(Namespace = \"urn:ALBAPI\")]\n[DebuggerStepThrough]\npublic class AdvSoftwareValues\n{\n    public AdvSoftwareValues();\n\n    [SoapElement(IsNullable = true)]\n    public string configDownloadDate { get; set; }\n    [SoapElement(IsNullable = true)]\n    public string confirmNewConfigIP { get; set; }\n    [SoapElement(IsNullable = true)]\n    public string downloadFilename { get; set; }\n    [SoapElement(IsNullable = true)]\n    public string filename { get; set; }\n}\npublic void call()\n    {\n        string WebserviceUrl = \"http://192.168.2.22:3333/ALBAPI.wsdl\";\n        string serviceName = \"ALBAPI\";\n        string methodName = \"getSetupLicenseRows\";\n        object[] args = new object[1];//-I didn't pass parameter in here.So that,It generate error.Which object will I need pass to webservices function\n        object sSessionID = CallWebService(WebserviceUrl, serviceName, methodName, args);\n        foreach (PropertyInfo property in sSessionID.GetType().GetProperties())\n        {\n            object value = property.GetValue(sSessionID, null);\n\n            Console.WriteLine(\"{0} = {1}\", property.Name, value);\n        }\n    }\n\npublic object CallWebService(string webServiceAsmxUrl, string serviceName, string methodName, object[] args)\n{\n    System.Net.WebClient client = new System.Net.WebClient();\n    //-Connect To the web service\n    using (System.IO.Stream stream = client.OpenRead(webServiceAsmxUrl + \"?wsdl\"))\n    {\n        //--Now read the WSDL file describing a service.\n        ServiceDescription description = ServiceDescription.Read(stream);\n        ///// LOAD THE DOM /////////\n        //--Initialize a service description importer.\n        ServiceDescriptionImporter importer = new ServiceDescriptionImporter();\n        importer.ProtocolName = \"Soap12\"; // Use SOAP 1.2.\n        importer.AddServiceDescription(description, null, null);\n        //--Generate a proxy client. importer.Style = ServiceDescriptionImportStyle.Client;\n        //--Generate properties to represent primitive values.\n        importer.CodeGenerationOptions = System.Xml.Serialization.CodeGenerationOptions.GenerateProperties;\n        //--Initialize a Code-DOM tree into which we will import the service.\n        CodeNamespace nmspace = new CodeNamespace();\n        CodeCompileUnit unit1 = new CodeCompileUnit();\n        unit1.Namespaces.Add(nmspace);\n        //--Import the service into the Code-DOM tree. This creates proxy code\n        //--that uses the service.\n        ServiceDescriptionImportWarnings warning = importer.Import(nmspace, unit1);\n        if (warning == 0) //--If zero then we are good to go\n        {\n            //--Generate the proxy code \n            CodeDomProvider provider1 = CodeDomProvider.CreateProvider(\"CSharp\");\n            //--Compile the assembly proxy with the appropriate references\n            string[] assemblyReferences = new string[5] { \"System.dll\", \"System.Web.Services.dll\", \"System.Web.dll\", \"System.Xml.dll\", \"System.Data.dll\" };\n            CompilerParameters parms = new CompilerParameters(assemblyReferences);\n            CompilerResults results = provider1.CompileAssemblyFromDom(parms, unit1);\n            //-Check For Errors\n            if (results.Errors.Count &gt; 0)\n            {\n                StringBuilder sb = new StringBuilder();\n                foreach (CompilerError oops in results.Errors)\n                {\n                    sb.AppendLine(\"========Compiler error============\");\n                    sb.AppendLine(oops.ErrorText);\n                }\n                throw new System.ApplicationException(\"Compile Error Occured calling webservice. \" + sb.ToString());\n            }\n            //--Finally, Invoke the web service method \n            Type foundType = null;\n            Type[] types = results.CompiledAssembly.GetTypes();\n            foreach (Type type in types)\n            {\n                if (type.BaseType == typeof(System.Web.Services.Protocols.SoapHttpClientProtocol))\n                {\n                    Console.WriteLine(type.ToString());\n                    foundType = type;\n                }\n            }\n\n            object wsvcClass = results.CompiledAssembly.CreateInstance(foundType.ToString());\n            MethodInfo mi = wsvcClass.GetType().GetMethod(\"getSetupLicenseRows\");\n            object o = new object();//I didn't pass parameter in here.So that,It generate error.Which object will I need pass to webservices function\n            Line error:o = mi.Invoke(wsvcClass, args);\n        return o;\n    }\n    else\n    {\n        return null;\n    }\n}\n</code></pre>\n\n<p>Thanks for any helping</p>\n"},{"tags":["c#",".net","image","bitmap"],"answer_count":3,"favorite_count":3,"up_vote_count":13,"down_vote_count":0,"view_count":12139,"score":13,"question_id":946926,"title":"Image vs Bitmap class","body":"<p>As this is my first post, let me introduce myself, I am Kadrin. I'm a developer at a large corporation in the central United States and have been out of college for about 1 year. </p>\n\n<p>Anyway, I've been reading up on my C# a lot lately (my team is slowly moving over to C#) and am having trouble understanding the differences between the <code>Image</code> class and the <code>Bitmap</code> class. Now I know <code>Bitmap</code> inherits the Image class but from what I understand both are very similar. Can anyone shed some light on this please? </p>\n"},{"tags":["c#","pdf","itextsharp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13263818,"title":"RawData is equal null for jpg images","body":"<p>I want to add image to pdf file. I'm using iTextSharp for this.\nI have the following code:</p>\n\n<pre><code>var imageBanner = iTextSharp.text.Image.GetInstance(bannerImagePath);\n</code></pre>\n\n<p>The problem in that the <code>RawData</code> property is equal <code>NULL</code> for <code>jpg</code> images, but for <code>png</code> is all ok.</p>\n"},{"tags":["c#","multithreading"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":56,"score":-1,"question_id":13265053,"title":"Background Worker vs Thread","body":"<p>For long runnings tasks(Asynchronous) in C# 4.0 windows Application.</p>\n\n<p>The choices are:</p>\n\n<ol>\n<li><p>BackgroundWorker (Thread Pool)</p></li>\n<li><p>Thread</p></li>\n</ol>\n\n<p>The above two are recommended for long running tasks(throughout application lifetime). Any other choices? In Additon,</p>\n\n<ul>\n<li><p><strong>BackgroundWorker</strong> - Uses ThreadPool Thread and for long running process with UI updates.</p></li>\n<li><p><strong>Thread</strong> - User defined Thread (Thread Creation overhead etc.) and for long running process (can use priority)</p>\n\n<p>Which would be a best choice </p>\n\n<ol>\n<li><p>if no need for UI update,priority and for Thread (which is created only on application/process start)?</p></li>\n<li><p>if number of tasks increased? (Care of ThreadPool Starvation)</p></li>\n</ol></li>\n</ul>\n\n<p>Any other interesting things?</p>\n"},{"tags":["c#"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":354,"score":0,"question_id":7659286,"title":"CRC_CCITT Kermit 16 in C#","body":"<p>I'm currently working on a hard way that requires the CRC_CCITT Kermit 16 protocol with the formula (X16 + X12 + X5 + 1). However some of the code I've found online both on this site or the web in general I don't seem to get my desired result. I saw this website (http://www.lammertbies.nl/comm/info/crc-calculation.html) that actually provides me with the exact match I want but it was written in C++. So can anyone help me with this? </p>\n\n<p>I look forward to hearing from you.</p>\n\n<p>Kind regards</p>\n\n<p>Michael</p>\n"},{"tags":["c#","sql-server-2008"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":7,"view_count":31,"score":-7,"question_id":13265225,"title":"\"Enumeration yielded no results\" in sqldatareader","body":"<p>I getting this error in my application \n\"Enumeration yielded no results\". I don't know how to solve. can any one please help me</p>\n"},{"tags":["c#","wpf","file","process","delete"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13262548,"title":"Delete a file being used by another process","body":"<p>I'm trying to programmically delete a file, but the file is apparently being used by another process (which happens to be my program). Basically, the program loads images from a folder by using FromUri to create a Bitmap, which is then loaded into an Image array, which in turn becomes the child of a stackpanel. Not very efficient, but it works.</p>\n\n<p>I've tried clearing the stackpanel's children, and making the images in the array null, but I'm still getting the IOException telling me that the file is being used by another process.</p>\n\n<p>Is there some other way to remove the file from my application's processes?</p>\n"},{"tags":["c#","asp.net-mvc","asp.net-mvc-3","partial-views"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13264645,"title":"MVC3 Display the edit view on the same page as the list of items","body":"<p>I have a list of transactions. When I click one of them, I'd like to be able to display the edit form (populated with the selected item's data) to the right of the list. Any ideas?</p>\n\n<p>Below is the partial view that displays the list of transactions.</p>\n\n<pre><code>@model IEnumerable&lt;BudgetPlus.Models.Transaction&gt;\n@{\n    ViewBag.Title = \"Index\";\n}\n&lt;p&gt;\n    @Html.ActionLink(\"Create New\", \"Create\", null, new { @class = \"button-link\" })\n&lt;/p&gt;\n&lt;table&gt;\n    &lt;thead&gt;\n        &lt;tr&gt;\n            &lt;th class=\"column-Date\"&gt;Date&lt;/th&gt;\n            &lt;th class=\"column-Description\"&gt;Description&lt;/th&gt;\n            &lt;th class=\"column-Category\"&gt;Category&lt;/th&gt;\n            &lt;th class=\"column-Amount\"&gt;Amount&lt;/th&gt;\n            &lt;th class=\"action-button\"&gt;&lt;/th&gt;\n            &lt;th class=\"action-button\"&gt;&lt;/th&gt;\n        &lt;/tr&gt;\n    &lt;/thead&gt;\n    &lt;tbody&gt;\n        @foreach (var item in Model)\n        {\n            &lt;tr&gt;\n                &lt;td&gt;\n                    @Html.DisplayFor(modelItem =&gt; item.Date)\n                &lt;/td&gt;\n                &lt;td&gt;\n                    @Html.DisplayFor(modelItem =&gt; item.Description)\n                &lt;/td&gt;\n                &lt;td&gt;\n                    @Html.DisplayFor(modelItem =&gt; item.Category.DisplayName)\n                &lt;/td&gt;\n                &lt;td&gt;\n                    @Html.DisplayFor(modelItem =&gt; item.Amount)\n                &lt;/td&gt;\n                &lt;td&gt;\n                    @Html.ActionLink(\"Edit\", \"Edit\", new { id = item.Id })\n                &lt;/td&gt;\n                &lt;td&gt;\n                    @Html.ActionLink(\"Delete\", \"Delete\", new { id = item.Id })\n                &lt;/td&gt;\n            &lt;/tr&gt;\n        }\n    &lt;/tbody&gt;\n&lt;/table&gt;\n&lt;div&gt;\n    @Html.EditorForModel(\"Edit\")\n&lt;/div&gt;\n</code></pre>\n\n<p>And this is what the edit method in my TransactionController looks like.</p>\n\n<pre><code>    public ActionResult Edit(int id)\n    {\n        Transaction transaction = db.Transactions.Find(id);\n        ViewBag.CategoryId = new SelectList(db.Categories, \"Id\", \"DisplayName\", transaction.CategoryId);\n        return View(transaction);\n    }\n</code></pre>\n"},{"tags":["c#","string","encryption","salt"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":11182535,"title":"Retrieving salt stored as plaintext alongside ciphertext using C#","body":"<p>I am writing a C# app designed to encrypt text files using Rijndeal (block size 128, key size 256, in other words AES256). I use the user supplied password and a random salt to generate a key using PBKDF2. (The IV is also derived from the password and salt)</p>\n\n<p>I want to store the salt as cleartext prepended to the ciphertext. In other words, line 1 would contain something like <code>&gt;&gt;&gt;SALTGOESHERE</code>. Line 3 and onward would store the ciphertext. </p>\n\n<p>How should I go about retrieving the salt for decryption?</p>\n\n<p>I'm very new to C#, this is my first real app, so please bear with my ignorance. Thanks.</p>\n"},{"tags":["c#","pdf","itextsharp","password-protection"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13264688,"title":"Email a existing pdf file with password protection","body":"<p>I have created a pdf using itextsharp. The requirement is that while sending the pdf as attachment in an email, it should be password protected.</p>\n\n<p>I know that we can make a pdf password protected while creating it using itextsharp. </p>\n\n<p>Is there any way to make an existing pdf password protected?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","php","jquery","xml","rss"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13262991,"title":"Item section of an rss xml - any unique field","body":"<p>I have a specification not to include the description element in a returned rss items to a mobile device. This is because the client claims the description text is too big for the mobile device to handle. The client is now asking there should be a unique field to identify each item that when sent to my application would retrieve the description for that item section.</p>\n\n<p>My question is which of these elements value can be used to identify the item? I read that the <code>&lt;guid&gt;</code> element is not reliable and is an optional element.</p>\n\n<pre><code>  &lt;item&gt;\n    &lt;title&gt;RSS Tutorial&lt;/title&gt;\n    &lt;link&gt;http://www.w3schools.com/rss&lt;/link&gt;\n    &lt;description&gt;New RSS tutorial on W3Schools&lt;/description&gt;\n    &lt;guid&gt;http://www.w3schools.com/rss/item0768&lt;/guid&gt;\n    ...\n    ...\n  &lt;/item&gt;\n</code></pre>\n\n<p>What I currently have in mind now is assume the items will always have a fixed position [1,2,3,4,5]. items[1] will always be items[1]. So I want to add another element <code>&lt;index&gt;i&lt;/index&gt;</code>. Any suggestion? Thanks.</p>\n\n<p><strong>update</strong></p>\n\n<p>I think I need to focus on the implementation at hand. According to the rss specification, sub-elements in the item element are optional, and so is guid. Now it is present in the rss am working with, and I think I'll use that</p>\n"},{"tags":["c#","asp.net","sql","database","informix"],"answer_count":7,"favorite_count":7,"up_vote_count":11,"down_vote_count":0,"view_count":9467,"score":11,"question_id":7026566,"title":"Failed to enable constraints. One or more rows contain values violating non-null, unique, or foreign-key constraints","body":"<p>I make an outer join and executed successfully in the <code>informix</code> database but I get the following exception in my code:</p>\n\n<pre><code>DataTable dt = TeachingLoadDAL.GetCoursesWithEvalState(i, bat);\n</code></pre>\n\n<blockquote>\n  <p>Failed to enable constraints. One or more rows contain values\n  violating non-null, unique, or foreign-key constraints.</p>\n</blockquote>\n\n<p>I know the problem, but I don't know how to fix it.</p>\n\n<p>The second table I make the outer join on contains a composite primary key which are null in the previous outer join query.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<pre><code>    SELECT UNIQUE a.crsnum_e,  a.crsnum_e  || '/ ' || a.crstteng crs_name, b.period,\n           b.crscls, c.crsday, c.from_lect, c.to_lect,\n           c.to_lect - c.from_lect + 1 Subtraction, c.lect_kind, e.eval, e.batch_no,\n           e.crsnum, e.lect_code, e.prof_course\n    FROM rg1course a, rg3crsgrp b, ct1table c, ct1tablelect d,\n         OUTER(cc1assiscrseval e)  \n    WHERE a.crsnum = b.crsnum \n    AND b.crsnum = c.crsnum \n    AND b.crscls = c.crscls \n    AND b.batch_no = c.batch_no \n    AND c.serial_key = d.serial_key  \n    AND c.crsnum = e.crsnum  \n    AND c.batch_no = e.batch_no  \n    AND d.lect_code= e.lect_code \n    AND d.lect_code = .... \n    AND b.batch_no = ....\n</code></pre>\n\n<p>The problem happens with the table <code>cc1assiscrseval</code>. The primary key is (batch_no, crsnum, lect_code).</p>\n\n<p>How to fix this problem?</p>\n\n<p>EDIT:</p>\n\n<p>According to @PaulStock advice:\nI do what he said, and i get:</p>\n\n<blockquote>\n  <p>? dt.GetErrors()[0] {System.Data.DataRow} HasErrors: true ItemArray:\n  {object[10]} RowError: \"Column 'eval' does not allow DBNull.Value.\"</p>\n</blockquote>\n\n<p>So I solve my problem by replacing  <code>e.eval</code> to ,<code>NVL (e.eval,'') eval</code>.and this solves my problem.\nThanks a lot.</p>\n"},{"tags":["c#","exchange","ews"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":2,"view_count":17,"score":-2,"question_id":13265096,"title":"Get mailbox count from Exchange 2010 using EWS","body":"<p>Can anyone help me to find number of mailboxes in my Exchange Server instance using Exchange Web Service.</p>\n\n<p>Thanks in advance.\nSebastian</p>\n"},{"tags":["c#","asp.net-mvc-3","dapper"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13254846,"title":"A parameterless default constructor is required to allow for dapper materialization error when reading object with list of child objects","body":"<p>I have this:</p>\n\n<pre><code>public class object_a\n{\n    public int ta_Id { get; set; }\n    public string ta_Label { get; set; }\n    public IEnumerable&lt;table_c&gt; SomeName { get; set; }\n}\n\npublic class table_b\n{\n    public int Id {get;set;}\n    public int SomeId {get;set;}\n    public int FK_A {get;set;}\n}\n\npublic class table_c\n{\n    public int Id {get;set;}\n    public int Max {get;set;}\n    public string Label {get;set;}\n    public int FK_A {get;set;}\n}\n</code></pre>\n\n<p>Using Dapper I retrieve a list of <code>object_a</code> with any number of child objects <code>table_c</code></p>\n\n<pre><code>using (System.Data.SqlClient.SqlConnection sqlConnection = new System.Data.SqlClient.SqlConnection(_con))\n{\n        sqlConnection.Open();\n        var sql = string.Format(\n        @\"\n        select ta.Id as ta_Id, ta.Label as ta_label, splitLimit = '', tc.Id, tc.Max, tc.Label\n        from table_a as ta\n        left join table_b as tb\n        on tb.FK_A = ta.Id\n        left join table_c as tc\n        on tc.FK_A = ta.Id\n        where tb.SomeId = SomeInt);\n\n        var items = sqlConnection.Query&lt;object_a, IEnumerable&lt;table_c&gt;, object_a&gt;(sql, (a, c) =&gt; { a.c = table_c; return a; }, splitOn: \"splitLimit\");\n        return items;\n    }\n</code></pre>\n\n<p>When calling the Dapper code from a controller I get this error:</p>\n\n<blockquote>\n  <p><em>A parameterless default constructor is required to allow for dapper materialization</em></p>\n</blockquote>\n\n<p>I have also tried this:</p>\n\n<pre><code>var items = sqlConnection.Query&lt;object_a,IEnumerable&lt;table_c&gt;, object_a&gt;(sql, (a, c) =&gt; \n{ \n                    if (c!= null) \n                    {\n                        a.SomeName = c;\n                    } \n                    return a; \n\n                }, splitOn: \"splitLimit\");\n</code></pre>\n\n<p>I think it might has something to do with the <code>IEnumerable&lt;table_c&gt;</code> but I don't understand what I am doing wrong here. I have read related questions that SO suggest, but I don't 'get' it.</p>\n\n<p>I would like to know what I am doing wrong and what the correct code is. Thanks!</p>\n"},{"tags":["c#","fft","wave","spectrum"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":227,"score":0,"question_id":11440371,"title":"Display a frequency spectrum of a FFT data in C#","body":"<p>I have already converted the wave file using FFT, and with the return double array I need to display a spectrum of the transformed data, which will look like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/A6iWS.png\" alt=\"example of image spectrum\"></p>\n"},{"tags":["c#","report","viewer"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":10,"score":-3,"question_id":13265034,"title":"Use more data sources in Report Viewer VS2010","body":"<p>how I can Use more data sources in Report Viewer VS2010\"</p>\n"},{"tags":["c#","asp.net",".net","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":106,"score":0,"question_id":11502803,"title":"Gridview not showing records?","body":"<p>I just attached linq data to gridview it is not showing row ?<br></p>\n\n<blockquote>\n<pre><code>    DataDataContext db = new DataDataContext();\n    protected void Page_Load(object sender, EventArgs e)\n    {\n        if (!IsPostBack)\n            BindData();\n    }\n\n    private void BindData()\n    {\n\n        var source = from n in db.Names\n                     select n;\n\n        gridSample.DataSource = source.ToList&lt;Name&gt;();\n        gridSample.DataBind();'\n    }\n\n\n\n\n    &lt;asp:UpdatePanel ID=\"panelGrid\" runat=\"server\"&gt;\n                        &lt;ContentTemplate&gt;\n                            &lt;asp:GridView runat=\"server\" ID=\"gridSample\" AutoGenerateColumns=\"false\"&gt;\n                                &lt;Columns&gt;\n                                    &lt;asp:TemplateField HeaderText=\"First Name\"&gt;\n                                        &lt;EditItemTemplate&gt;\n                                            &lt;asp:TextBox ID=\"txtFirstName\" runat=\"server\" Text='&lt;%Bind(\"FirstName\") %&gt;' /&gt;\n                                        &lt;/EditItemTemplate&gt;\n                                        &lt;ItemTemplate&gt;\n                                            &lt;asp:Label runat=\"server\" ID=\"lblFirstName\" Text='&lt;%Eval(\"FirstName\") %&gt;' /&gt;\n                                        &lt;/ItemTemplate&gt;\n                                    &lt;/asp:TemplateField&gt;\n                                    &lt;asp:TemplateField HeaderText=\"Last Name\"&gt;\n                                        &lt;EditItemTemplate&gt;\n                                            &lt;asp:TextBox ID=\"txtLastName\" runat=\"server\" Text='&lt;%Bind(\"LastName\") %&gt;' /&gt;\n                                        &lt;/EditItemTemplate&gt;\n                                        &lt;ItemTemplate&gt;\n                                            &lt;asp:Label runat=\"server\" ID=\"lblLastName\" Text='&lt;%Eval(\"LastName\") %&gt;' /&gt;\n                                        &lt;/ItemTemplate&gt;\n                                    &lt;/asp:TemplateField&gt;\n                                    &lt;asp:TemplateField HeaderText=\"Date of Birth\"&gt;\n                                        &lt;EditItemTemplate&gt;\n                                            &lt;asp:TextBox ID=\"txtDOB\" runat=\"server\" Text='&lt;%Bind(\"DOB\") %&gt;' /&gt;\n                                        &lt;/EditItemTemplate&gt;\n                                        &lt;ItemTemplate&gt;\n                                            &lt;asp:Label runat=\"server\" ID=\"lblDOB\" Text='&lt;%Eval(\"DOB\") %&gt;' /&gt;\n                                        &lt;/ItemTemplate&gt;\n                                    &lt;/asp:TemplateField&gt;\n                             &lt;/Columns&gt;\n                   &lt;/asp:GridView&gt;\n           &lt;/ContentTemplate&gt;\n       &lt;/asp:UpdatePanel&gt;\n</code></pre>\n</blockquote>\n"},{"tags":["c#","xaml","microsoft-metro","winrt","share"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13249102,"title":"How to set subject and message part in email with attachment while share charm usage in XAML/C# Windows store app","body":"<p>my app has share charm. It is used to share files and rich text. I have set <code>Title</code> (TextBlock) and <code>Description</code> (RichEditBox) properties and used <code>SetStorageItems()</code> &amp; <code>SetRtf()</code> methods to share files of class <a href=\"http://msdn.microsoft.com/en-us/library/windows/apps/br205873.aspx\" rel=\"nofollow\"><code>DataPackage</code></a>, but while using mail app in share charm the <code>Title</code> should be fill as subject and the <code>Description</code> should be set as body of email but it is not working, please help me.</p>\n\n<p>If I use only <code>SetText()</code> then it sets automatically.</p>\n\n<p>PS : Here the <a href=\"http://code.msdn.microsoft.com/windowsapps/Sharing-Content-Source-App-d9bffd84\" rel=\"nofollow\">sample</a> for sharing source content</p>\n"},{"tags":["c#","winforms","create-directory"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13264620,"title":"Inserting Selected Item on Specific Folder [SOLVED]","body":"<p>I have 2 buttons (Button1 - Browse ; Button2 - Upload) and 1 textBox </p>\n\n<p>Here is the scenario. When I click on Browse, it will open a window and will browse for a specific item.\nThe selected item will display on textbox.</p>\n\n<pre><code>private void Browse_Click(object sender, EventArgs e)\n{\n    btnSample.Title = \"Sample File Upload\";\n    btnSample.InitialDirectory = @\"c:\\\";\n    btnSample.Filter = \"TIF|*.tif|JPG|*.jpg|GIF|*.gif|PNG|*.png|BMP|*.bmp|PDF|*.pdf|XLS|*.xls|DOC|*.doc|XLSX|*.xlsx|DOCX|*.docx\";\n    btnSample.FilterIndex = 2;\n    btnSample.RestoreDirectory = true;\n    if (btnSample.ShowDialog() == DialogResult.OK)\n    {\n        textBox1.Text = btnSample.FileName;\n    }\n}\n</code></pre>\n\n<p>When I click on the Upload Button the file on the textbox will be on the created folder.\nI'm done with creating the folder. but my problem is how can i insert the selected file on the folder.</p>\n\n<pre><code>private void button4_Click(object sender, EventArgs e)\n{\n    string path = @\"C:\\SampleFolder\\NewFolder\";\n    if (!Directory.Exists(path))\n    {\n        Directory.CreateDirectory(path);\n        MessageBox.Show(\"Successfully Created New Directory\");\n    }\n    else\n    {\n        MessageBox.Show(\"Filename Exist\");\n    }\n}\n</code></pre>\n"},{"tags":["c#","setup-deployment"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13264232,"title":"Antivirus prevents setup program from running","body":"<p>Hi all: <br />I'm working on a visual Studio setup program. The problem is that the antivirus (AVG) reports that I don't have enough permissions to run the setup program. When I disable the antivirus, the setup works fine. My setup does't modify the registry and it is so simple. It just installs a program in the program files(x86). I log in to my computer as administrator and I run the setup as administrator too. <br />Could anyone point out how I can bypass the antivirus?<br />\nThanks</p>\n"},{"tags":["c#","quartz.net"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":608,"score":2,"question_id":5114698,"title":"Setting a Quartz.NET trigger to fire on a specific object instance","body":"<p>How can I get Quartz to fire a trigger on an already created &amp; initialized object?</p>\n\n<p>e.g.</p>\n\n<pre><code>public class Foo : IJob\n{\n    public Foo ( configuration items ... ) { }\n}\n\n// Calling Code...\nFoo f = new Foo( /*Non empty constructor*/ );\nSchedular sched = new SchedulerFactory().GetScheduler();\nJobDetail jD = new JobDetail(\"fooDetail\", null typeof(Foo));\nTrigger trig = TriggerUtils.MakeSecondlyTrigger(15);\nsched.ScheduleJob( jD, trig );\nsched.Start();\n</code></pre>\n\n<p>As foo doesn't have a 0 args constructor Quartz.NET is having issues instantiating the Job and running it. Is there any way I can get Quartz to trigger the instance of Foo, f?</p>\n\n<p>Please forgive me if I'm missing a fundamental fact about Quartz and its usage.</p>\n"},{"tags":["c#","winforms","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13264150,"title":"How do I change color of cell which have greater than zero value in datagrid","body":"<p><code>enter code here</code><p> i have two cell in grid i want to chage one cell color and value by zero when i entered in other cell greater then zero value </p></p>\n\n<pre><code>    private void grdDetail_CellBeginEdit(object sender, DataGridViewCellCancelEventArgs e)\n        { \n            if (this.IsLoadComplete) \n              { \n                UpdateValueofQtyCell(e.ColumnIndex); \n              } \n       }\n  private void UpdateValueofQtyCell(int index)\n        {\n            int cur_row = grdDetail.CurrentRow.Index;\n\n            if (index == 1)\n            {\n                grdDetail[1, cur_row].Style.BackColor = Color.White;\n                grdDetail[2, cur_row].Style.BackColor = Color.FromArgb(224, 224, 224);\n                grdDetail[2, cur_row].Value = 0;\n            }\n           else  if (index == 1)\n            {\n                grdDetail[2, cur_row].Style.BackColor = Color.White;\n                grdDetail[1 cur_row].Style.BackColor = Color.FromArgb(224, 224, 224);\n                grdDetail[1, cur_row].Value = 0;\n             }\n        }\n</code></pre>\n"},{"tags":["c#","serialization"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13264754,"title":"How to get File Name when Exception in Serialization Constructor Occures?","body":"<p>I do serialization via a serialization constructor like this:</p>\n\n<pre><code>private MyClass(SerializationInfo info, StreamingContext c)\n{\n   try\n   {\n      MyIntVar = info.GetInt32(\"MyIntVar\");\n   }\n   catch(Exception)\n   {\n      Trace.WriteLine(\"Exception occured! Setting default value.\");\n      MyIntVar = 4711;\n   }\n}\n</code></pre>\n\n<p>What I'm now trying to achieve is to trace the name and path of the file that is beeing serialized when this exception occures.</p>\n\n<p>Something like:</p>\n\n<pre><code>if( c is file)\n{\n   Trace.WriteLine(\"Don't bother, I proceed anyway, but maybe you should repair the file \" + FilePath);\n}\n</code></pre>\n\n<p>So I have two questions concerning this:</p>\n\n<ol>\n<li>How can I determine that the current serialization context is a file?</li>\n<li>How can I get the corresponding file name and path of this file?</li>\n</ol>\n"},{"tags":["c#","sql","ms-access","exception-handling","ado.net"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":48,"score":0,"question_id":13264491,"title":"Syntax error in FROM clause on DataAdapter.Fill()","body":"<p>I am having a problem with my codes, not knowing whats the issue. Can anyone advise?</p>\n\n<p>The whole program is for a biometric program. This is just the login User controller. How can i solve this problem?</p>\n\n<p>I am facing this problem in the line: </p>\n\n<pre><code>dbAdapter.Fill(uds);\n</code></pre>\n\n<p>Stating:</p>\n\n<blockquote>\n  <p>OleDbException was unhandled:Syntax error in FROM clause. </p>\n</blockquote>\n\n<p>My codes are below: \n<strong>USER CONTROLLER</strong> </p>\n\n<pre><code>namespace Privacy_Biometric_Defender\n{\n    class UserController\n    {\n        User[] user;\n        User searchUser;\n        DataRowCollection rows;\n        DataSet uds;\n        OleDbDataAdapter dbAdapter;\n        DataTable userTable;\n\n        //A kind of gobal var to share in project\n        public static string uNameExist;\n        public static string passwordExist;\n        public static string roleExist;\n\n        public UserController(){\n\n        // Set up Connection String\n        OleDbConnection dbConn = new  OleDbConnection(\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=PrivacyDefenderDatabase.mdb\");\n\n        // Setup SQL select statement\n        string sqlStatement = \"Select * from User\";\n\n        // Setup DBAdapter (Scientist Table)\n\n        dbAdapter = new OleDbDataAdapter(sqlStatement, dbConn);\n        OleDbCommandBuilder OrderDetailsCmdBuilder = new OleDbCommandBuilder(dbAdapter);\n\n        // Create a Data Set to hold data from DB\n        uds = new DataSet();\n\n        // fill ds with data from DB\n        dbAdapter.Fill(uds);\n\n        // get contacts table\n        DataTable userTab = uds.Tables[0];\n\n        // get all rows\n        rows = userTab.Rows;\n        }\n\n        public User[] GetAllUsers()\n        {\n            DataRow row;\n\n            user = new User[rows.Count];\n\n            for (int i = 0; i &lt; rows.Count; ++i)\n            {\n                row = rows[i];\n                user[i] = new User();\n                user[i].SetId((Int32)row[\"ID\"]);\n                user[i].SetEmployeeID((string)row[\"EmployeeID\"]);\n                user[i].SetUsername((string)row[\"Username\"]);\n                user[i].SetFName((string)row[\"FName\"]);\n                user[i].SetLName((string)row[\"LName\"]);\n                user[i].SetPassword((string)row[\"Password\"]);\n                user[i].SetEmail((string)row[\"Email\"]);\n                user[i].SetContact((Int32)row[\"Contact\"]);\n                user[i].SetRole((string)row[\"Roles\"]);\n            }\n            return user;\n        }\n\n        public User SearchUser(string uname)\n        {\n            searchUser = new User();\n\n            //get all rows from DB\n            GetAllUsers();\n            for (int i = 0; i &lt; rows.Count; ++i)\n            {\n                if (user[i].GetUsername() == uname)\n                {\n                    searchUser.SetId(user[i].GetId());\n                    searchUser.SetEmployeeID(user[i].GetEmployeeID());\n                    searchUser.SetUsername(user[i].GetUsername());\n                    searchUser.SetFName(user[i].GetFName());\n                    searchUser.SetLName(user[i].GetLName());\n                    searchUser.SetPassword(user[i].GetPassword());\n                    searchUser.SetEmail(user[i].GetEmail());\n                    searchUser.SetContact(user[i].GetContact());\n                    searchUser.SetRole(user[i].GetRole());\n                }\n            }\n            return searchUser;\n        }\n\n        public User SearchUserName(string userName)\n        {\n        User searchUserName = new User();\n\n        //get all rows from DB\n        GetAllUsers();\n        for (int i = 0; i &lt; rows.Count; ++i)\n        {\n            //Get UserName to store in this container\n            string checkUname = user[i].GetUsername();\n            if (checkUname == userName)\n            {\n                uNameExist = \"Exists\";\n                roleExist = user[i].GetRole();\n            }\n        }\n        return searchUserName;\n        }\n\n        // Search password for Login function\n        public User SearchPassword(string password)\n        {\n        User searchPassword = new User();\n\n        //get all rows from DB\n        GetAllUsers();\n        for (int i = 0; i &lt; rows.Count; ++i)\n        {\n            //Get password to store in this container\n\n            string checkPassword = user[i].GetPassword();\n            if (checkPassword == password)\n            {\n                passwordExist = \"Exists\";\n            }\n        }\n        return searchPassword;\n    }\n        public static string GetSHA512(string text)\n        {\n            UnicodeEncoding UE = new UnicodeEncoding();\n            byte[] hashValue;\n            byte[] message = UE.GetBytes(text);\n\n            SHA512Managed hashString = new SHA512Managed();\n            string hex = \"\";\n\n            hashValue = hashString.ComputeHash(message);\n            foreach (byte x in hashValue)\n            {\n                hex += String.Format(\"{0:x2}\", x);\n            }\n            return hex;\n        }\n    }\n}\n</code></pre>\n\n<p>This is my login page form: With the following codes. Whenever i click login, the errors come up. Whats wrong with my codes?</p>\n\n<p>My codes are below:<strong>LOGIN PAGE FORM</strong></p>\n\n<pre><code>namespace Privacy_Biometric_Defender\n{\npublic partial class Login : Form\n{\n    //A kind of gobal var to share in project\n    public static string fixedUName;\n\n    public Login()\n    {\n        InitializeComponent();\n    }\n\n    private void LoginClearButton_Click(object sender, EventArgs e)\n    {\n        LoginUsernameTextBox.Clear();\n        LoginPasswordTextBox.Clear();\n        LoginUsernameTextBox.Focus();\n    }\n\n    private void Login_Load(object sender, EventArgs e)\n    {\n        LoginUsernameTextBox.Focus();\n    }\n\n    private void LoginButton_Click(object sender, EventArgs e)\n    {\n\n        string userName = this.LoginUsernameTextBox.Text;\n        MessageBox.Show(\"Codes Stops Here\");\n        UserController cont1 = new UserController();\n        User SearchUserName = new User();      \n        // Passing textbox input to Controller\n        fixedUName = LoginUsernameTextBox.Text;\n        SearchUserName = cont1.SearchUserName(userName);\n\n        string passwd = this.LoginPasswordTextBox.Text;\n        UserController cont2 = new UserController();\n        User SearchPassword = new User();\n        // Passing textbox input to Controller\n        SearchPassword = cont2.SearchPassword(UserController.GetSHA512(passwd));\n\n        // Collect information from Controller\n        string checkUnameExist = UserController.uNameExist;\n        string checkPasswordExist = UserController.passwordExist;\n        string checkRoleExist = UserController.roleExist;\n\n        if (checkPasswordExist == \"Exists\" &amp;&amp; checkUnameExist == \"Exists\")\n        { \n            MessageBox.Show(\"Login Successfully\");\n        }\n        else\n        {\n            MessageBox.Show(\"Login Unsuccessfully!\");\n        }   \n    }\n\n    private void LoginUsernameTextBox_TextChanged(object sender, EventArgs e)\n    {\n\n    }\n\n}\n}\n</code></pre>\n"},{"tags":["c#","pdf","itextsharp"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":253,"score":4,"question_id":13027074,"title":"How to insert files into folders of an existing PDF portfolio with folders using iTextsharp","body":"<p>Using the answers in <a href=\"http://stackoverflow.com/questions/9833572/how-to-merge-pdf-using-itextsharp-into-a-pdf-portfolio\">How to merge PDF using itextsharp; into a PDF Portfolio?</a>, I've been able to create an PDF portfolio using iTextSharp. However, using Adobe Acrobat I'm able to create folders, and I'm able to put files in those folders.</p>\n\n<p>How do I create folders and how do I put files in those folders in a PDF portfolio using iTextSharp?</p>\n\n<p>I've tried using a pdf inspector program to see the differences between a portfolio with and without folders, but I haven't been able to see any. I guess I'm looking in the wrong places</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>For this specific use case of mine it is actually possible to create the PDF portfolio with folder up front. So it's way more important to be able to insert files in folders in an existing PDF portfolio as opposed to actually creating the folders themselves.</p>\n"},{"tags":["c#","winforms","datagridview","checkbox"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13263288,"title":"Unchecking the user checked checkbox in the datagridview cell","body":"<p>I have a column in my <code>DataGridView</code> which has the <code>DataGridViewCheckBoxColumn</code> as column template. When user checks the checkbox, I need to uncheck it programmatically if it fails some conditions. I have done this, but this uncheck logic only takes effect after I change the focus from the cell manually. I tried changing the focus programmatically but didn't work. Is there any solution for this?</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13263646,"title":"Menu in child process inside a tab not shown on mouse click","body":"<p>I am developing a chrome like application. I do have two applications Say Parent and Child Application. Child application contains menus. When i am attaching an instance of child application to a tab of parent application. Menu in child application is not shown on mouse click.</p>\n\n<p>Code snippet used for attaching process is</p>\n\n<pre><code>Process P = Process.GetProcessesByName(\"Child\");\nP.WaitForInputIdle();\nIntPtr handle = P.MainWindowHandle;\nSetParent(handle, this.tabPage1.Handle);\nMoveWindow(handle, rec.X, rec.Y, rec.Width, rec.Height, true);\n</code></pre>\n\n<p>I cannot make any changes to Child application.</p>\n"},{"tags":["c#","nunit","resharper"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13264573,"title":"nunit agent hangs even after using .NET 4.0 in config file","body":"<p>I am facing issues with nunit.</p>\n\n<p>When I run unit tests and close the nunit application, the application closes with significant delay and nunit86.exe process remains in memory. I need to kill it to build the code again with changes.</p>\n\n<p>I face the same issue when I run the unit test cases with ReSharper. </p>\n\n<p>After searching on web, I came across <a href=\"http://stackoverflow.com/questions/4303421/nunit-2-5-8-lots-of-nunit-agent-exe\">this</a> and <a href=\"https://bugs.launchpad.net/nunitv2/+bug/602761\" rel=\"nofollow\">this</a> solution.</p>\n\n<p>I made the required changes in config file and found that the application closes promptly but a pop up comes saying \"Nunit agent stopped working\". I had to close it each time.</p>\n\n<p>It is really painful as we are also using nunit on CC.NET.</p>\n\n<p>Any solution for this will be appreciated.</p>\n\n<p>I have used following version's of Nunit but no success</p>\n\n<ol>\n<li>NUnit 2.5.5</li>\n<li>NUnit 2.5.9</li>\n<li>NUnit 2.5.10</li>\n<li>NUnit 2.6.2</li>\n</ol>\n\n<p>I tried it using following version's of Nunit.</p>\n"},{"tags":["c#","windows-8","microsoft-metro"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13264463,"title":"Suspend camera when user switches away from app, and resume camera when user switches back to app","body":"<p>Currently, I would like to suspend my camera when user switches away from my app, and resume camera when user switches back to app</p>\n\n<p>I am referring to <a href=\"http://msdn.microsoft.com/en-us/library/windows/apps/hh464925.aspx#app_suspend\" rel=\"nofollow\">Application lifecycle (Windows Store apps) (Windows)</a></p>\n\n<p>However, <strong>Suspending | suspending event</strong> isn't being triggered immediately once the user switches away from my app. You need to wait for few seconds (Or it will not trigger at all if OS decides not to do so).</p>\n\n<p>So, how I can know, when I should run my camera suspension code when user switches away from my app.</p>\n\n<p>If I referring to <a href=\"http://code.msdn.microsoft.com/windowsapps/Media-Capture-Sample-adf87622\" rel=\"nofollow\">Media capture using capture device sample</a>, they are using</p>\n\n<p><code>Windows.Media.MediaControl.SoundLevelChanged += m_soundLevelHandler;</code></p>\n\n<p>They run camera suspension code when there is a sound level changes? But this is also not what I want. As detecting <code>SoundLevelChanged</code> event, is not able to let me know, whether user is <strong>switching away from my app</strong>, or <strong>switching back to my app</strong>. <code>SoundLevelChanged</code> event will be triggered in both scenarios.</p>\n"},{"tags":["c#","regex"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13264190,"title":"Restrict all the special characters through a regex","body":"<p>There is a long set of characters that are not allowed to validate an input box of winform app.</p>\n\n<p>So i figured that rather than making the long list that are not allowed make the shorter one that are allowed.</p>\n\n<p>The set that is allowed are <code>(a-z,A-Z, 0-9,@,.)</code> .Rest every thing that can be entered are not allowed.</p>\n\n<p>This is the regex that i have made for this.</p>\n\n<pre><code>Regex.IsMatch(textBox1.Text, @\"[@\\.\\w]+$\")\n</code></pre>\n\n<p>It seem to work in some cases but when i enter the data in this format <code>normal character or number special character normal character or number</code> it seems to break few example <code>ee(vv, 55)44,aba&amp;3B</code>. </p>\n\n<p>Not able to figure out whats wrong in this.</p>\n"},{"tags":["c#","arrays","variables"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":6,"view_count":117,"score":-1,"question_id":13256433,"title":"C# array of variables","body":"<p>Is it possible to do something like this:</p>\n\n<pre><code>string A = \"A\";\nstring B = \"B\";\n\nobject[] O = { A, B };\nO[0] = \"C\";\n</code></pre>\n\n<p>Where <code>A</code> will hold the value <code>\"C\"</code> in the end?</p>\n\n<p>The code above will replace <code>O[0]</code> with <code>\"C\"</code>, but <code>A</code> remains unchanged.</p>\n"},{"tags":["c#","asp.net","excel","gridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13259420,"title":"Export GridView into Excel","body":"<p>I'm trying to export my GridView into a 2010 Excel file <code>.xlsx</code> format.  It works with an <code>.xls</code> I was wondering if anyone could help me out.  Here is what I have so far:</p>\n\n<pre><code>protected void Button2_Click(object sender, EventArgs e)\n    {\n        Response.Clear();\n        Response.Buffer = true;\n        Response.AddHeader(\"content-disposition\",\n        \"attachment;filename=GridViewExport.xls\");\n        Response.Charset = \"\";\n        Response.ContentType = \"application/vnd.xls\";\n        StringWriter sw = new StringWriter();\n        HtmlTextWriter hw = new HtmlTextWriter(sw);\n        GridView1.AllowPaging = false;\n        GridView1.DataBind();\n\n        GridView1.HeaderRow.Style.Add(\"background-color\", \"#FFFFFF\");\n\n        GridView1.HeaderRow.Cells[0].Style.Add(\"background-color\", \"#D1EEEE\");\n\n        GridView1.HeaderRow.Cells[1].Style.Add(\"background-color\", \"#D1EEEE\");\n\n        GridView1.HeaderRow.Cells[2].Style.Add(\"background-color\", \"#D1EEEE\");\n\n        GridView1.HeaderRow.Cells[3].Style.Add(\"background-color\", \"#D1EEEE\");\n        GridView1.HeaderRow.Cells[4].Style.Add(\"background-color\", \"#D1EEEE\");\n        GridView1.HeaderRow.Cells[5].Style.Add(\"background-color\", \"#D1EEEE\");\n        GridView1.HeaderRow.Cells[6].Style.Add(\"background-color\", \"#D1EEEE\");\n        GridView1.HeaderRow.Cells[7].Style.Add(\"background-color\", \"#D1EEEE\");\n        GridView1.HeaderRow.Cells[8].Style.Add(\"background-color\", \"#D1EEEE\");\n        for (int i = 0; i &lt; GridView1.Rows.Count; i++)\n        {\n\n            GridViewRow row = GridView1.Rows[i];\n            row.BackColor = System.Drawing.Color.White;\n            row.Attributes.Add(\"class\", \"textmode\");\n            if (i % 2 != 0)\n            {\n\n                row.Cells[0].Style.Add(\"background-color\", \"#FFFFFF\");\n                row.Cells[1].Style.Add(\"background-color\", \"#FFFFFF\");\n                row.Cells[2].Style.Add(\"background-color\", \"#FFFFFF\");\n                row.Cells[3].Style.Add(\"background-color\", \"#FFFFFF\");\n\n            }\n        }\n        GridView1.RenderControl(hw);\n        string style = @\"&lt;style&gt; .textmode { mso-number-format:\\@; } &lt;/style&gt;\";\n        Response.Write(style);\n        Response.Output.Write(sw.ToString());\n        Response.Flush();\n        Response.End();\n\n    }\n</code></pre>\n"},{"tags":["c#","asp.net-mvc","extension-methods","timeline"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13235110,"title":"TimelineJS in C# Mvc","body":"<p>How to add TimelineJS (<a href=\"http://timeline.verite.co/\" rel=\"nofollow\">http://timeline.verite.co/</a>) to your website with C# Mvc.\nIf you want to view a complete project, visit <a href=\"http://www.m33.se/timelinejs.html\" rel=\"nofollow\">http://www.m33.se/timelinejs.html</a>.\nI know there's several peoples that wonder how to get the TimelineJs to be displayed.\nI've created some helper classes that makes it easy to extend from your original class.</p>\n\n<p>What I'm doing right now is to extend the TimlineJS javascript file with an extension that will set the current slide from (or nearest) from today's date.</p>\n\n<pre><code>/// &lt;summary&gt;\n/// Helpers for the Timeline classes to return Json objects\n/// &lt;/summary&gt;\npublic class date\n{\n    public string startDate { get; set; }\n    public string endDate { get; set; }\n    public string headline { get; set; }\n    public string text { get; set; }\n}\n\n\npublic class timeline\n{\n    public string headline { get; set; }\n    public string text { get; set; }\n    public string type { get; set; }\n    public string lang { get; set; }\n    public List&lt;date&gt; date { get; set; }\n    public string font { get; set; }\n}\n\n\npublic class Wrapper\n{\n    public timeline timeline { get; set; }\n}\n\npublic static class Ext\n{\n    public static string Quote(this string text)\n    {\n        return string.Format(\"\\\"{0}\\\"\", text);\n    }\n\n    public static string Embed(this string text)\n    {\n        if ((!text.Contains(\"&lt;p&gt;\")) &amp;&amp; (!text.Contains(\"&lt;/p&gt;\")))\n            return string.Format(\"&lt;p&gt;{0}&lt;/p&gt;\", text);\n        return text;\n    }\n}   \n\n public JsonResult GetTimelineJs(Int32 ? pageid)\n    {\n        //Create your own list from your datasource below.\n        var tm = ActiveRecordMediator&lt;Timeline&gt;.FindFirst(Restrictions.Eq(\"PageId\", pageid));\n\n        var events = new List&lt;date&gt;();\n        var datelist = tm.GetItems();\n\n        foreach (var item in datelist) {\n            if (!item.Active) continue;\n\n            events.Add( new date {  \n                headline = item.Title, \n                text = item.Html.Embed(),   \n                startDate = new DateTime(item.EventDate.Year, item.EventDate.Month, item.EventDate.Day, item.EventDate.Hour, item.EventDate.Minute, item.EventDate.Second).ToShortDateString().Replace(\"-\", \",\"), \n                endDate = new DateTime(item.EndEventDate.Year, item.EndEventDate.Month, item.EndEventDate.Day, item.EndEventDate.Hour, item.EndEventDate.Minute, item.EventDate.Second).ToShortDateString().Replace(\"-\", \",\") }\n            );\n        }\n        //The wrapper class just surrounds the timline object.\n        var wrapper = new Wrapper\n        {\n            timeline = new timeline()\n            {\n                headline = tm.Title,\n                text = tm.Html.Embed(),\n                type = \"default\",\n                lang = \"sv\",\n                font = \"Arvo &amp; PT Sans\",\n                date = events\n            }\n        };\n\n         string json2 = JsonConvert.SerializeObject(wrapper, Formatting.Indented);\n         var dez = JsonConvert.DeserializeObject&lt;Wrapper&gt;(json2);\n\n         return Json(dez, JsonRequestBehavior.AllowGet);\n    }\n\n//This produces a timline data (Json).\n\n{\"timeline\":\n{\n\"headline\":\"Headline text\",\n\"text\":\"\\u003cp\\u003eThis is some markup text\\u003c/p\\u003e\",\n\"type\":\"default\",\n\"lang\":\"sv\",\n\"date\":[\n    {\"startDate\":\"2012,08,10\",\"endDate\":\"2012,08,15\",\"headline\":\"Love at First Feel\",\"text\":\"\\u003cp\\u003eThis is some markup text one\\u003c/p\\u003e\"},\n    {\"startDate\":\"2012,09,09\",\"endDate\":\"2012,09,09\",\"headline\":\"Love at Second Feel\",\"text\":\"\\u003cp\\u003eThis is some markup text two\\u003c/p\\u003e\"},\n    {\"startDate\":\"2012,10,10\",\"endDate\":\"2012,10,10\",\"headline\":\"Love at third Feel\",\"text\":\"\\u003cp\\u003eThis is some markup text two\\u003c/p\\u003e\"},\n    {\"startDate\":\"2012,11,10\",\"endDate\":\"2012,11,12\",\"headline\":\"Love at fourth Feel\",\"text\":\"\\u003cp\\u003eThis is some markup text two\\u003c/p\\u003e\"},\n    {\"startDate\":\"2012,12,10\",\"endDate\":\"2012,12,15\",\"headline\":\"Love at Fifth Feel\",\"text\":\"\\u003cp\\u003eThis is some markup text two\\u003c/p\\u003e\"}],\n\"font\":\"Arvo \\u0026 PT Sans\"}\n}\n</code></pre>\n\n<p>IMPORTANT!! \nI noticed that is Timeline.js there's this line(about line 7000):</p>\n\n<pre><code>VMM.getJSON(raw_data + \"?callback=onJSONP_Data\", VMM.Timeline.DataObj.parseJSON);\n</code></pre>\n\n<p>If you send any other data to your controller it will break and not function.\nTo allow other parameters, just change to the line below:</p>\n\n<pre><code>VMM.getJSON(raw_data + \"&amp;callback=onJSONP_Data\", VMM.Timeline.DataObj.parseJSON);\n</code></pre>\n\n<p><strong>I'm not sure that this always will return the closest date. Can anyone verify this?</strong></p>\n\n<pre><code>    public Int32 GetClosestDate(Int32 pageid)\n    {\n        var tm = ActiveRecordMediator&lt;Timeline&gt;.FindFirst(Restrictions.Eq(\"PageId\", pageid));\n        List&lt;CDate&gt; datelist = new List&lt;CDate&gt;();\n        DateTime today = DateTime.Now;\n\n        int slide = 1;\n        foreach (var item in tm.GetItems().OrderBy(d =&gt; d.Id))\n        {\n            datelist.Add(new CDate { Date = DateTime.ParseExact(item.EventDate.ToShortDateString(), \"yyyy-mm-dd\", null), Slide = slide, Diff = DateDiff(today, item.EventDate) });\n            slide++;\n        }\n\n        var closest = datelist.OrderBy(d =&gt; d.Diff).First();\n        return closest.Slide;\n    }\n\n private int DateDiff(DateTime Date1, DateTime Date2)\n    {\n        TimeSpan time = Date1 - Date2;\n        return Math.Abs(time.Days);\n    }\n</code></pre>\n"},{"tags":["c#","version-control","github","changes"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13263774,"title":"How to discard Git changes between files","body":"<p>I have a repository cloned from GitHub, and I made changes to file A, however Git is detecting\nchanges to file B,C and D. All three files are detecting the changes as basically the entire contents of B,C,D. i.e. +all lines in B,C,D, -all lines in B,C,D.</p>\n\n<p>I don't want to commit this as it makes for a dirty commit. Why is git detecting these changes and how to I get git to ignore these changes forever?</p>\n\n<p>The project is in C#, I use the GitHub windows application and the IDE is VS Express 2012.</p>\n\n<p><strong>Edit:</strong>\nI realize the files have changed, but is there a way to a) find out what changed and b) tell git to ignore them and not pick them up again between commits. It seems my editor is modifying files B,C,D in some way after I first openened the cloned project.</p>\n\n<p>Even after running a git reset --hard, git diff still reports the changes.</p>\n"},{"tags":["c#","syntax","tags","formating","human-readable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13263867,"title":"C# human readable formating of a special syntax","body":"<p>Hi all i kinda need some help at creating a function for turning a plain syntax in human readable format:</p>\n\n<p>Syntax looks like this:</p>\n\n<pre><code>[OPENTAG]\n(type)name:value\n[OPENTAG]\n(type)name:value\n(type)name:value\n(type)name:value\n[/CLOSETAG]\n[/CLOSETAG]\n</code></pre>\n\n<p>Would like to turn this into this:</p>\n\n<pre>\n\n    [OPENTAG]\n         (type)name:value\n         [OPENTAG]\n             (type)name:value\n             (type)name:value\n             (type)name:value\n         [/CLOSETAG]\n    [/CLOSETAG]\n\n</pre>\n\n<pre><code>    private string textFormater(string input)\n    {\n        string[] lines = Regex.Split(input, \"\\r\\n\");\n        int tabs = 0;\n        string newtext = \"\";\n        foreach (string line in lines)\n        {\n\n            Match m = Regex.Match(line, \"\\\\[.*\\\\]\");\n            bool isTop;\n            bool isTopClose = false;\n            string tabtext = \"\";\n\n            if (m.Success)\n            {\n                if (line.Contains(\"/\"))\n                {\n                    tabs--;\n                    isTopClose = true;\n                }\n                else\n                {\n                    tabs++;\n                }\n                isTop = true;\n            }\n            else\n            {\n                isTop = false;\n            }\n\n            if (isTop &amp;&amp; !isTopClose &amp;&amp; tabs == 1)\n            {\n                newtext += line;\n            }\n            else if (isTop &amp;&amp; !isTopClose)\n            {\n                for (int i = 1; i &lt;= tabs - 1; i++)\n                {\n                    tabtext += \"\\t\";\n                }\n                newtext += \"\\r\\n\" + tabtext + line;\n            }\n            else\n            {\n                for (int i = 1; i &lt;= tabs; i++)\n                {\n                    tabtext += \"\\t\";\n                }\n                newtext += \"\\r\\n\" + tabtext + line;\n            }\n\n        }\n        return newtext;\n    }\n</code></pre>\n\n<p>I have atm a solution but the code is so messy and slow, in a 2mb file it takes ages :)\nThanks for your help!</p>\n\n<p>Cheers</p>\n"},{"tags":["c#","api","rest","permissions","amazon-s3"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13262302,"title":"Amazon S3 file storage via Rest API in C# with roles","body":"<p>I'm building a project that will use Amazon S3 to store documents. In particular there are two apps:</p>\n\n<ul>\n<li>A public facing app will allow users to create and upload documents</li>\n<li>An admin app where you can view documents available and download them</li>\n</ul>\n\n<p>...so the public app should only have 'write' permission, and the admin tool 'read' and 'list' permissions.</p>\n\n<p>The coding for this project will be done with ASP.NET and C#, and the preference is to use S3's REST API. This use case (uploading, listing and downloading documents) seems pretty basic, but I haven't had much luck finding simple examples. Can some you suggest some links?</p>\n"},{"tags":["c#","linq-to-entities"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13261991,"title":"Get last index of character with LINQ to Entities","body":"<p>I'm getting the error:</p>\n\n<pre><code>LINQ to Entities does not recognize the method 'Int32 LastIndexOf(System.String)' \nmethod, and this method cannot be translated into a store expression.\n</code></pre>\n\n<p>When using this code to tell if a person's last name starts with certain characters:</p>\n\n<pre><code>persons = persons.Where(c =&gt; c.FullName.IndexOf(\" \") &gt; 0 &amp;&amp;\nc.FullName.Substring(c.FullName.LastIndexOf(\" \")+1).StartsWith(lastNameSearch));\n</code></pre>\n\n<p>Any clue how to achieve this without using LastIndexOf()? Maybe I have to check for this after I grab results from the database using ToList()?</p>\n"},{"tags":["c#","json","json.net","deserialization"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13263931,"title":"Convert JSON String to List of Dynamic Objects in C#","body":"<p>Ive got a JSON string im sending from my web client to my webapi. This JSON string kind of dynamically formed.</p>\n\n<p>So I want to know if there is a way if I can convert this JSON string into a list/array of dynamic objects. So can handle it along the same line as:</p>\n\n<pre><code>var DynamicArray = WhatEverJSONConvertor(JSONString);\n\nfor (int i = 0; i &lt; DynamicArray.length; i++)\n{\n      Console.WriteLine(DynamicArray[i].AFieldInTheObject);\n}\n</code></pre>\n\n<p>Is this possible? What JSON convertor would I use this to accomplish this?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","asp.net",".net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13264149,"title":"Dll changes or not if i do change in my web.config file","body":"<p>I have UPDATED my web.config code , now i have to send patch for the changed code to be deployed on the production.\nI am not sure that .dll file should be send along with web.config file or not?</p>\n\n<p>if yes then why?\nif not then why?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#",".net","vb.net"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":56,"score":1,"question_id":13264057,"title":"is there is any globalization issues using '==' operator and string.Equals() method for comparing a string?","body":"<p>Are there any globalization issues using '<code>==</code>' operator and <code>string.Equals()</code> method for comparing a string? If yes what is the solution to avoid this?</p>\n"},{"tags":["c#","c#-4.0"],"answer_count":0,"favorite_count":2,"up_vote_count":2,"down_vote_count":7,"view_count":48,"score":-5,"question_id":13264123,"title":"C#.NET - Windows Forms","body":"<p>C#.NET - Windows Forms</p>\n\n<p>Do a simple Event Alert Application as follows,</p>\n\n<ol>\n<li>A simple screen to get input name, email and event description</li>\n<li>There should be a button says Alert</li>\n<li>Once user click on the Alert the name and email should gets stored in the database and a email should trigger to the admin. </li>\n<li>Upon successfully database entry the application screen should close automatically else exception should raise and notify user. </li>\n</ol>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13264095,"title":"How to Detect color from the image object","body":"<p>Hello I want to detect the color of car in image\nFollowing Steps I've done \nI have detected the car in image,\n    i have created  the bins of colors for example ranging the  value 0-25 will be equal to  0  and have ten bins for each part of color of <code>RGB</code> so could you have any algorithm to get the color of <code>car/object</code>.</p>\n"},{"tags":["c#","xaml","windows-8","microsoft-metro"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13262782,"title":"Using style in StandardStyle xaml from another Style xaml","body":"<p>I have a custom Color.xaml as</p>\n\n<pre><code>&lt;ResourceDictionary\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" \n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;\n    &lt;SolidColorBrush x:Key=\"MyColor1\" Color=\"#7d897d\"/&gt;\n    &lt;SolidColorBrush x:Key=\"MyColor2\" Color=\"#078ab4\"/&gt;\n&lt;/ResourceDictionary&gt;\n</code></pre>\n\n<p>And App.xaml as</p>\n\n<pre><code>&lt;Application.Resources&gt;\n        &lt;ResourceDictionary&gt;\n            &lt;ResourceDictionary.MergedDictionaries&gt;\n                &lt;!-- Defines the colors used in the app--&gt;\n                &lt;ResourceDictionary Source=\"Color.xaml\"/&gt;\n                &lt;!-- Styles that define common aspects of the platform look and\n                     feel Required by Visual Studio project and item templates--&gt;\n                &lt;ResourceDictionary Source=\"StandardStyles.xaml\"/&gt;\n                &lt;ResourceDictionary&gt;\n                ............\n</code></pre>\n\n<p>In My StandardStyle.xaml I'm not able to use the Color defined in the xaml.</p>\n\n<pre><code>&lt;Style x:Key=\"HeadingTextStyle\" TargetType=\"TextBlock\"&gt;\n    &lt;Setter Property=\"FontWeight\" Value=\"SemiLight\"/&gt;\n    &lt;Setter Property=\"FontSize\" Value=\"20\"/&gt;\n    &lt;Setter Property=\"Foreground\" Value=\"{StaticResource MyColor1}\"/&gt;\n&lt;/Style&gt;\n</code></pre>\n\n<p>It gives me an exception when I run the code</p>\n\n<pre><code>\"Cannot find a Resource with the Name/Key MyColor1 [Line: 20 Position: 44]\"\n</code></pre>\n\n<p>However I'm able to use this color in the UI xaml files.</p>\n"},{"tags":["c#","ftp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13264173,"title":"How to read files one by one from ftp server using c#?","body":"<p>I am getting files from ftp folder like this.</p>\n\n<pre><code>request = (FtpWebRequest)FtpWebRequest.Create(new Uri(\"ftp://ipaddress/foldername\"));\n                request.UseBinary = true;\n                request.Credentials = new NetworkCredential(\"username\", \"password\");\n                request.Method = WebRequestMethods.Ftp.ListDirectory;\n                request.UseBinary = true;\n\n                WebResponse response = request.GetResponse();\n\n                StreamReader reader = new StreamReader(response.GetResponseStream());\n\n                    string line = reader.ReadLine();\n                    while (line != null)\n                    {\n                        result.Append(line);\n                        result.Append(\"\\n\");\n                        line = reader.ReadLine();\n                    }\n                    // to remove the trailing '\\n'\n                    result.Remove(result.ToString().LastIndexOf('\\n'), 1);\n                    reader.Close();\n                    response.Close();\n\n                    string[] results = result.ToString().Split('\\n');\n\n                    foreach (string filename in results)\n\n                    {\n connetionString = \"Data Source=testservername;Initial Catalog=testdb;User ID=sa;Password=sa\";\n                   connection = new SqlConnection(connetionString);\n\n\n                   FtpWebRequest request1 = (FtpWebRequest)FtpWebRequest.Create(new Uri(\"ftp://servername/\"  + filename));\n                   request1.Method = WebRequestMethods.Ftp.DownloadFile;\n                   request1.UseBinary = true;\n                   request1.Credentials = new NetworkCredential(\"username\", \"password\");\n                   responses = (FtpWebResponse)request1.GetResponse();\n                   StreamReader reader1 = new StreamReader(responses.GetResponseStream());\n\n                   string xml = reader1.ReadToEnd();\n\n\n\n                   ds.ReadXml(new XmlTextReader(new StringReader(xml)));\n\n                   int i = 0;\n                   connection.Open();\n                   for (i = 0; i &lt;= ds.Tables[1].Rows.Count - 1 ; i++)\n                    {\n\n                   sql = \"insert into Details values('\" + ds.Tables[1].Rows[i].ItemArray[0]            \n                                                       + \"')\";\n\n                        command = new SqlCommand(sql, connection);\n                        adpter.InsertCommand = command;\n                        adpter.InsertCommand.ExecuteNonQuery();\n\n                    }\n\n\n                        FtpWebRequest requestDelete = (FtpWebRequest)WebRequest.Create(\"ftp://sername/\" + filename);\n                        requestDelete.Method = WebRequestMethods.Ftp.DeleteFile;\n                        requestDelete.UseBinary = true;\n                        requestDelete.Credentials = new NetworkCredential(\"username\", \"password\");\n                        responseDelete = (FtpWebResponse)requestDelete.GetResponse();\n                        try\n                        {\n                            string res = responseDelete.StatusDescription;\n                            if (res == \"250 Delete operation successful.\")\n                            {\n                                MessageBox.Show(\"Done......\");\n\n                            }\n                        }\n                        catch (Exception ex)\n                        {\n                            System.Windows.Forms.MessageBox.Show(ex.Message);\n\n                        }\n                    }\n\n                    responseDelete.Close();\n                    connection.Close();\n                    responses.Close();\n\n\n\n            }\n            catch (Exception ex)\n            {\n               System.Windows.Forms.MessageBox.Show(ex.Message);\n\n            }\n        }\n</code></pre>\n\n<p>Hi need to get files from ftp folder and read that xml files one by one and save it as records in my Databse after that need to delete that file ftp folder.</p>\n\n<p>if for testing i placed two files in ftp folder first files reading successfully .but getting error for reading second file like \"Object Reference is not set instance of object \"in the below line. </p>\n\n<pre><code>ds.ReadXml(new XmlTextReader(new StringReader(xml)));\n</code></pre>\n\n<p>please tell me any thing wrong in my code.i am sending ftp request multiple times it is good or suggest me by seeing above lines of code how to do that?</p>\n"},{"tags":["c#","add-in"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12949301,"title":"How to Load MS Word 2010 Add-in load after login and unload when exit","body":"<p>I have windows application which enables user log-in. After Login I want the Add-in get loaded. and when user Exits that paticular Word instance(Only one instance of word can exists when the login application runs) then add-in is also unloaded. I have tried to do it by </p>\n\n<pre><code> addin.Connect = false;//Application.COMAddins. Connect \n</code></pre>\n\n<p>It sets the LoadBehaviour( COM add-ins list) to 2\nand when it loads i set it to 3</p>\n\n<p>Its working but MSword displays so many error messages while exit and sometimes disables my add-in. \nIs there any other way to load and unload add-in dynamically?</p>\n"},{"tags":["c#",".net","wpf","xaml","data-binding"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13263917,"title":"WPF Binding how to get object reference","body":"<p>I have a ListView showing a list of Accounts using MVVM &amp; a custom template and working fine\nNow on clicking the Acct Name, we need to execute a custom action which requires the current Acct object</p>\n\n<p>Is there a way to set the Label.Tag property to the Acct object ?</p>\n\n<p>the xaml def is below\nenv is vs2010 .net 4.0 c#</p>\n\n<pre><code>&lt;ListView Name=\"lv1\" Grid.Column=\"1\" Grid.Row=\"4\"\n    ItemsSource=\"{Binding AccountsList}\"\n    Background=\"Transparent\" BorderThickness=\"0\"&gt;\n    &lt;ItemsControl.ItemTemplate&gt;\n        &lt;DataTemplate&gt;\n            &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                &lt;Image Source=\"/asm1;component/Images/Icons/pdf1.png\" Width=\"12\" Height=\"12\" /&gt;\n                &lt;Label Content=\"{Binding Name}\" Margin=\"0,0,25,0\" \n                    ContextMenu=\"{x:Null}\" Name=\"lblacctItem\" \n                    MouseDoubleClick=\"lbl_MouseDoubleClick\" /&gt;\n            &lt;/StackPanel&gt;\n        &lt;/DataTemplate&gt;\n    &lt;/ItemsControl.ItemTemplate&gt;\n    &lt;ListView.ItemsPanel&gt;\n        &lt;ItemsPanelTemplate&gt;\n            &lt;WrapPanel Background=\"Transparent\" \n                Width=\"{Binding (FrameworkElement.ActualWidth), RelativeSource={RelativeSource AncestorType=ScrollContentPresenter}}\" \n                ItemWidth=\"{Binding (ListView.View).ItemWidth, RelativeSource={RelativeSource AncestorType=ListView}}\" \n                MinWidth=\"{Binding ItemWidth, RelativeSource={RelativeSource Self}}\" \n                ItemHeight=\"{Binding (ListView.View).ItemHeight, RelativeSource={RelativeSource AncestorType=ListView}}\" /&gt;\n        &lt;/ItemsPanelTemplate&gt;\n    &lt;/ListView.ItemsPanel&gt;\n&lt;/ListView&gt;\n</code></pre>\n"},{"tags":["c#",".net","pcap.net"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13117290,"title":"How to get audio data from rtp packet...?","body":"<p>I'm using .net to do call recroding with pcap.net.</p>\n\n<p>till now I have got the rtp packet. And its length is 32 bytes.</p>\n\n<p>The codec used is G729 and payload type is 18.</p>\n\n<pre><code>byte[] bytes = HexString2Bytes(udp.Payload.ToHexadecimalString());          \nstring rtppayload = ASCIIEncoding.ASCII.GetString(bytes);\n</code></pre>\n\n<p>I need to get the actual rtp payload.\n Plz help me...</p>\n"},{"tags":["c#","linq-to-xml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13263167,"title":"Easy with with large nested xml document to prevent NULL Ref Exceptions","body":"<p>Is there an easy way to prevent NULL ref exceptions on larger nested xml documents when there is  chance that portions of the xml may not exist in some of the transmission messages? So for example if I am using Linq to Xml to traverse an xml doc and need to get to something like the CustomerName xml tag, but the parent node \"Customer\" is for whatever reason not present.  I know you can write if statements to check and you can use extension methods (I couldn't get those to work on deeply nested docs)?</p>\n\n<p>I also had tried using some of the linq \"let\" statements to check if an element exists, but that is also giving me some strange behavior when the element is not present.</p>\n\n<p>Are there other options?</p>\n\n<p>Code example below where if the entire customer node is not present I can prevent myself from getting a NULL Ref on OrderName?</p>\n\n<pre><code>    class Program\n{\n    static void Main(string[] args)\n    {\n        Order order = new Order();\n        XDocument xdoc = XDocument.Parse(\"&lt;business&gt;\" +\n                                        \"&lt;customer&gt;\" + \n                                            \"&lt;customername&gt;Mike&lt;/customername&gt;&lt;order&gt;&lt;ordernumber&gt;101010&lt;/ordernumber&gt;&lt;orderitem&gt;orderitem&lt;/orderitem&gt;&lt;/order&gt;\"+\n                                            \"&lt;/customer&gt;\" +\n                                            \"&lt;/business&gt;\");\n        var busXml = xdoc.Descendants(\"business\").FirstOrDefault();\n        order.Customer = (string)busXml.Element(\"customer\").Element(\"customername\");\n        order.OrderName = (string)busXml.Element(\"customer\").Element(\"order\").Element(\"ordernumber\");\n\n        Console.WriteLine(\"Customer: {0} Order: {1} OrderItem: {2}\", order.Customer, order.OrderName, order.OrderItem);\n        Console.Read();\n    }\n}\n\npublic class Order\n{\n    public string Customer { get; set; }\n    public string OrderName { get; set; }\n    public string OrderItem { get; set; }\n}\n</code></pre>\n"},{"tags":["c#","asp.net",".net","asp.net-mvc-4","iis-7.5"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13263002,"title":"Is there a way to change .net mvc bin dir location?","body":"<p>I have a fairly standard and simple MVC4 website.</p>\n\n<p>In root dir we have: bin, content, scripts, views. Using default settings the project's DLL, let's call it \"web.dll\" and all the necessary extras go in the bin dir.</p>\n\n<p>Somehow, ASP.NET dev server and IIS7.5 both know to look for \"web.dll\" in the bin folder when hosting the site, and if it's not there they throw error: \"Could not load type 'CVD.Web.MvcApplication'\". The standard solution for that error is to build directly into bin folder, which doesn't work for me because...</p>\n\n<p>For debugging purposes, I'd like to be able to build Debug &amp; Release configurations into into bin/Debug and bin/Release respectively and then deploy both dirs, then change a setting either in IIS, web.config, global.asax, or anywhere else to pick whether Debug or Release build should be loaded and executed by the server.</p>\n\n<p>I haven't been able to find if that's possible or if .net webapps have a silly hard-coded rule saying all code must live in the bin dir.</p>\n"},{"tags":["c#","nhibernate","fluent-nhibernate","foreign-key-relationship"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13249462,"title":"Fluent NHibernate one to one mapping insert issue","body":"<p>One to one mapping works fine when retriving the values based on bellow mapping. But when inserting values </p>\n\n<blockquote>\n  <p>unable to resolve property: MasterData </p>\n</blockquote>\n\n<p>is thrown. </p>\n\n<p>Tables are listed bellow</p>\n\n<blockquote>\n  <p>MasterDataTable [MasterDataID (PK), Name ]</p>\n  \n  <p>OtherDataTable [MasterDataID (PK)(FK), OtherName]</p>\n</blockquote>\n\n<p>Fluent NHibernare Classes are </p>\n\n<pre><code>Public class MasterData{\npublic virtual long MasterDataID {get;set;}\npublic virtual string Name {get;set;}\npublic virtual OtherData OtherDataProp {get;set;}\n}\n\npublic class OtherData{\npublic virtual long MasterDataID {get;set;}\npublic virtual string OtherName {get;set;}\n}\n\npublic class MasterDataMap: ClassMap&lt;MasterData&gt;{\n public MasterDataMap(){\n //table declaration\n\n   Id(x =&gt; x.MasterDataID).Column(\"MasterDataID\").GeneratedBy.gui.Sequence(\"MASTER_DATA_SEQ\");\n Map(x =&gt; x.Name).Column(\"Name\");\n}\n}\n\npublic class OtherDataMap: ClassMap&lt;OtherData&gt;{\n public OtherDataMap(){\n //table declaration\n\n   Id(x =&gt; x.MasterDataID, \"MASTER_DATA_ID\").GeneratedBy.Foreign(\"MasterData\")\n Map(x =&gt; x.Name).Column(\"OtherName\");\n}\n}\n</code></pre>\n\n<p>Please let me know what other information is needed to resolve this. I am able to retrieve values but when i insert values i am not able. </p>\n\n<p>Regards,\nDesmond</p>\n"},{"tags":["c#","crystal-reports","dataset","subreport","ondemand"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":3072,"score":2,"question_id":529400,"title":"Crystal Reports Subreport Using DataSets","body":"<p>I use Crystal Reports XI with C# Visual Studio 2005.\nI am trying to create a subreport from a summary dataset.\nA simple example would be Company listing with Employees.\nI load the Company dataset (with CompanyId).\nI want to create a subreport which is linked by CompanyId whereby the dataset is loaded (obviously) on demand.  I can create this subreport if I load all the detail into one monster dataset, but in my real-world implementation this would involve loading millions of detail rows (not an option).</p>\n\n<p>Is there a way I can capture the SubReport event and load the dataset from my database connection?  I basically want to intercept the subreport link call to build the dataset myself.</p>\n"},{"tags":["c#","asp.net",".net","gridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13263751,"title":"Сhanging read-only field value with method","body":"<p>I have a working GridView in an ASP.Net webapp which tracks DNS records I have requested. It's defined as follows:</p>\n\n<pre><code>&lt;asp:GridView ID=\"gvExistingEntries\" runat=\"server\" AutoGenerateColumns=\"False\" \n    DataKeyNames=\"DNSId\" DataSourceID=\"dsDNS\" Width=\"100%\" \n    BackColor=\"White\" BorderColor=\"#DEDFDE\" BorderStyle=\"None\" BorderWidth=\"1px\" \n    CellPadding=\"4\" ForeColor=\"Black\" GridLines=\"Vertical\" AllowSorting=\"True\" ShowFooter=\"true\"&gt;\n    &lt;AlternatingRowStyle BackColor=\"White\" /&gt;\n    &lt;Columns&gt;\n        &lt;asp:BoundField DataField=\"DNSId\" Visible=\"false\" ReadOnly=\"true\" /&gt;\n        &lt;asp:BoundField DataField=\"DNSName\" HeaderText=\"DNS Name\" SortExpression=\"DNSName\" /&gt;\n        &lt;asp:BoundField DataField=\"IPAddress\" HeaderText=\"IP Address\" ReadOnly=\"True\" SortExpression=\"IPAddress\" /&gt;\n        &lt;asp:BoundField DataField=\"RecordType\" HeaderText=\"Record Type\" SortExpression=\"RecordType\" /&gt;\n        &lt;asp:BoundField DataField=\"RequestTicket\" HeaderText=\"Request Ticket\" SortExpression=\"RequestTicket\" /&gt;\n        &lt;asp:BoundField DataField=\"LastUpdateBy\" HeaderText=\"Updated By\" ReadOnly=\"True\" SortExpression=\"LastUpdateBy\" /&gt;\n\n        &lt;asp:TemplateField ShowHeader=\"false\" ItemStyle-HorizontalAlign=\"Center\"&gt;\n            &lt;ItemTemplate&gt;\n                &lt;asp:LinkButton ID=\"updateButton\" runat=\"server\" CommandName=\"Edit\" Text=\"Update\" /&gt;\n                &lt;asp:LinkButton ID=\"deleteButton\" runat=\"server\" CommandName=\"Delete\" Text=\"Delete\" onClientClick=\"return confirm('Are you sure you want to delete this entry?');\" /&gt;\n            &lt;/ItemTemplate&gt;\n\n            &lt;EditItemTemplate&gt;\n                &lt;asp:LinkButton ID=\"saveUpdate\" runat=\"server\" CommandName=\"Update\" Text=\"Save\" onClientClick=\"return confirm('Are you sure you want to save these changes?');\" /&gt;\n                &lt;asp:LinkButton ID=\"cancelUpdate\" runat=\"server\" CommandName=\"Cancel\" Text=\"Cancel\" /&gt;\n            &lt;/EditItemTemplate&gt;\n        &lt;/asp:TemplateField&gt;\n    &lt;/Columns&gt;\n    &lt;FooterStyle BackColor=\"#CCCC99\" /&gt;\n    &lt;HeaderStyle BackColor=\"#6B696B\" Font-Bold=\"True\" ForeColor=\"White\" /&gt;\n    &lt;PagerStyle BackColor=\"#F7F7DE\" ForeColor=\"Black\" HorizontalAlign=\"Right\" /&gt;\n    &lt;RowStyle BackColor=\"#F7F7DE\" /&gt;\n    &lt;SelectedRowStyle BackColor=\"#CE5D5A\" Font-Bold=\"True\" ForeColor=\"White\" /&gt;\n    &lt;SortedAscendingCellStyle BackColor=\"#FBFBF2\" /&gt;\n    &lt;SortedAscendingHeaderStyle BackColor=\"#848384\" /&gt;\n    &lt;SortedDescendingCellStyle BackColor=\"#EAEAD3\" /&gt;\n    &lt;SortedDescendingHeaderStyle BackColor=\"#575357\" /&gt;\n&lt;/asp:GridView&gt;\n</code></pre>\n\n<p>The datasource is defined as follows:</p>\n\n<pre><code>&lt;asp:SqlDataSource ID=\"dsDNS\" runat=\"server\" \n    ConnectionString=\"&lt;%$ ConnectionStrings:DNSMonConnectionString %&gt;\" \n    SelectCommand=\"SELECT [DNSId], [DNSName], [RecordType], [StartValidityDate], [EndValidityDate], [IPAddress], [LastUpdate], [RequestTicket], (select [FirstName] + ' ' + [LastName] + ' (' + [Login] + ')' FROM [User] where [User].[UserID] = [DomainName].[LastUpdateBy]) AS [LastUpdateBy] FROM [DomainName] ORDER BY [DNSName]\"\n\n    UpdateCommandType=\"StoredProcedure\"\n    UpdateCommand=\"sp_update_DNSEntry\" OnUpdating\n    DeleteCommandType=\"StoredProcedure\"\n    DeleteCommand=\"sp_drop_DNSEntry\"&gt;\n    &lt;DeleteParameters&gt;\n        &lt;asp:Parameter Name=\"DNSId\" Type=\"Int32\" /&gt;\n    &lt;/DeleteParameters&gt;\n    &lt;UpdateParameters&gt;\n        &lt;asp:Parameter Name=\"DNSId\" /&gt;\n        &lt;asp:Parameter Name=\"DNSName\" /&gt;\n        &lt;asp:Parameter Name=\"RecordType\" /&gt;\n        &lt;asp:Parameter Name=\"IPAddress\" /&gt;\n        &lt;asp:Parameter Name=\"RequestTicket\" /&gt;\n    &lt;/UpdateParameters&gt;\n&lt;/asp:SqlDataSource&gt;\n</code></pre>\n\n<p>Whenever the user uses the update feature this works and saves it to the database, but I want the code to resolve the IP address before it saves it. I have the method ready to go for this, but I do not know how to incorporate that into the code.</p>\n\n<p>Any ideas? I'd rather avoid having the code on the database if possible.</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13262727,"title":"how to check Object Reference?","body":"<p>I have like this entity,</p>\n\n<pre><code>public class Receiving{\n  [Key]\n  public int ID {get; set;}\n  public string shipperID {get; set;}\n\n  [Foregign(\"shipperID\")]\n  public virtual Shipper shipper {get; set;}\n}\n</code></pre>\n\n<p>the Shipper relationship could be <strong>1:0 or 1:1</strong></p>\n\n<p>and I got an error when the shipper is 0.</p>\n\n<pre><code>var result = from p in productRepository\n             join o in receivingRepository\n             on p.fk equals o.ID\n             select new {\n               test = o.shipper.name // if the shipper is nothing related then it occur an error.\n             }\n</code></pre>\n\n<p>The error message say,\n<strong>\"Object reference not set to an instance of an object.\"</strong></p>\n\n<p>How can I check that in select {}?</p>\n\n<p>I tried,</p>\n\n<pre><code>select new {\n  test = o.shipper.name ?? \"\"\n}\n</code></pre>\n\n<p>but it is not working.</p>\n"},{"tags":["c#",".net","collections","concurrency","thread-safety"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":80,"score":3,"question_id":13096519,"title":"Making a \"modify-while-enumerating\" collection thread-safe","body":"<p>I want to create a thread-safe collection that can be modified while being enumerated.</p>\n\n<p>The sample <code>ActionSet</code> class stores <code>Action</code> handlers. It has the <code>Add</code> method that adds a new handler to the list and the <code>Invoke</code> method that enumerates and invokes all of the collected action handlers. The intended working scenarios include very frequent enumerations with occasional modifications while enumerating.</p>\n\n<p>Normal collections throw exception if you modify them using the <code>Add</code> method while the enumeration is not over. I've created a sample \"recursion-safe\" collection that allows adding new values even while enumerating. If you add new values while the main <code>_actions</code> collection is being enumerated, the values are added to the temporary <code>_delta</code> collection instead of the main one. After all enumerations are finished, the <code>_delta</code> values are added to the <code>_actions</code> collection. If you add some new values while the main <code>_actions</code> collection is being enumerated (creating the <code>_delta</code> collection) and then re-enter the Invoke method again we have to create a new merged collection (<code>_actions</code> + <code>_delta</code>) and replace <code>_actions</code> with it.</p>\n\n<p>So, this collection looks \"recursion-safe\", but I want to make it thread-safe. I think that I need to use the <code>Interlocked.*</code> constructs, classes from <code>System.Threading</code> and other synchronization primitives to make this collection thread-safe, but I don't have a good idea on how to do that.</p>\n\n<p>How to make this collection thread-safe?</p>\n\n<pre><code>class ActionSet {\n    List&lt;Action&gt; _actions = new List&lt;Action&gt;(); //The main store\n    List&lt;Action&gt; _delta; //Temporary buffer for storing added values while the main store is being enumerated\n    int _lock = 0; //The number of concurrent Invoke enumerations\n\n    public void Add(Action action) {\n        if (_lock == 0) { //_actions list is not being enumerated and can be modified\n            _actions.Add(action);\n        } else { //_actions list is being enumerated and cannot be modified\n            if (_delta == null) {\n                _delta = new List&lt;Action&gt;();\n            }\n            _delta.Add(action); //Storing the new values in the _delta buffer\n        }\n    }\n\n    public void Invoke() {\n        if (_delta != null) { //Re-entering Invoke after calling Add:  Invoke-&gt;Add,Invoke\n            Debug.Assert(_lock &gt; 0);\n            var newActions = new List&lt;Action&gt;(_actions); //Creating a new list for merging delta\n            newActions.AddRange(_delta); //Merging the delta\n            _delta = null;\n            _actions = newActions; //Replacing the original list (which is still being iterated)\n        }\n        _lock++;\n        foreach (var action in _actions) {\n            action();\n        }\n        _lock--;\n        if (_lock == 0 &amp;&amp; _delta != null) {\n            _actions.AddRange(_delta); //Merging the delta\n            _delta = null;\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","file-io","unmanaged-memory"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13263825,"title":"How to create a file from UmanagedMemoryStream in C#","body":"<p>How to create a file on disk from an UnManagedMemoryStream.\nIs there any direct command exists in C# for it, or some simple procedure for it.</p>\n"},{"tags":["c#",".wav"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13263783,"title":"Playing Multiple wav files simultaneously","body":"<p>I have to play 5-10 wav files together.In my application, When any camera(each camera has a different wav file to play as alarm on motion detection) detects a motion an alarm(wav) file is played.\nwhen multiple cameras (5-10) gets motion detection simultaneously then there we have to play multiple alarms(wav files) which are different for each camera.If I am using WMPlayer then the alarms are getting interrupted and also the whole wave is not getting played.</p>\n\n<p>code for WMPlayer</p>\n\n<pre><code>var player = new WindowsMediaPlayer();\n                ////player.settings.rate = .5; //slow\n                player.URL = soundfilepath;\n                player.controls.play();\n</code></pre>\n\n<p>I also tried Windows API but it pauses my application(cameras) during which the alarm is getting played</p>\n\n<p>Code for Windows API</p>\n\n<pre><code>PlaySound(soundfilepath, IntPtr.Zero, SoundFlags.SND_FILENAME | SoundFlags.SND_SYNC);\n\npublic enum SoundFlags : int\n    {\n        SND_SYNC = 0x0000,  // play synchronously (default) \n        SND_ASYNC = 0x0001,  // play asynchronously \n        SND_NODEFAULT = 0x0002,  // silence (!default) if sound not found \n        SND_MEMORY = 0x0004,  // pszSound points to a memory file\n        SND_LOOP = 0x0008,  // loop the sound until next sndPlaySound \n        SND_NOSTOP = 0x0010,  // don't stop any currently playing sound \n        SND_NOWAIT = 0x00002000, // don't wait if the driver is busy \n        SND_ALIAS = 0x00010000, // name is a registry alias \n        SND_ALIAS_ID = 0x00110000, // alias is a predefined ID\n        SND_FILENAME = 0x00020000, // name is file name \n        SND_RESOURCE = 0x00040004  // name is resource name or atom \n    }\n</code></pre>\n\n<p>Now My problem is how to play multiple wav files simultaneously without interruption?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","wcf","authorization","role"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13206862,"title":"WCF service Role-based authorization. Retrieving roles from database","body":"<p>I have Wcf service (Instanscontext mode - PerCall, concurrency - Multiple) and I want to use this thing:</p>\n\n<pre><code>    [PrincipalPermission(SecurityAction.Demand, Role = \"customrole\")]\n    public string AnyMethod()\n    {\n        //any implementation\n    }\n</code></pre>\n\n<p>According this <a href=\"http://msdn.microsoft.com/en-us/magazine/cc948343.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/magazine/cc948343.aspx</a>\nGetRolesForUser looks like this:</p>\n\n<pre><code>    class CustomRoleProvider : RoleProvider\n    {\n         public override string[] GetRolesForUser(string username)\n         {\n              //?? n Hibernate initialization\n\n              //implementation role retrieving from database\n         }\n\n         public override bool IsUserInRole(string username, string roleName)\n         {\n              return GetRolesForUser(username).Contains(roleName);\n         }\n    }\n</code></pre>\n\n<p>I need to retrieve roles from database and I don't want to initialize n Hibernate inside GetRolesForUser. What should i do to avoid initialize n Hibernate in GetRolesForUser ?\nIs there a good approach initialize ORM from service class constructor?</p>\n"},{"tags":["c#","silverlight","datagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":119,"score":1,"question_id":11781859,"title":"The checkbox in the DataGridTemplateColumn is malfunctional","body":"<p>I add a DataGridTemplateColumn with a checkbox to my Datagrid in Silverlight. The Checkbox is successfully added to the datagrid as a column. However,if I check more that one chcekbox, some other checkboxes in this column will be affected automatically (i.e.,changed from checked to unchecked, or vise versa.). I didn't add any event handler for this checkbox, so how could this happen? It seems to me, if I scroll the datagrid to view more records, the datagrid is refreshed/updated automatically, and the checkboxes are messed up at that point. My code is listed below:</p>\n\n<pre><code>            DataGridTemplateColumn templateColumn = new DataGridTemplateColumn() { Header = \"header\",Width=new DataGridLength(50) };               \n            StringBuilder CellTemp = new StringBuilder();\n            CellTemp.Append(\"&lt;DataTemplate \");\n            CellTemp.Append(\"xmlns='http://schemas.microsoft.com/winfx/\");\n            CellTemp.Append(\"2006/xaml/presentation' \");\n            CellTemp.Append(\"xmlns:x='http://schemas.microsoft.com/winfx/2006/xaml' &gt;\");\n            CellTemp.Append(\"&lt;CheckBox  x:Name='\" + \"checkBoxHeader\" + \"' Margin='4'  IsChecked='False'/&gt;\");\n            CellTemp.Append(\"&lt;/DataTemplate&gt;\");\n            templateColumn.CellTemplate = (DataTemplate)XamlReader.Load(CellTemp.ToString());\n            ftrDataGrid.Columns.Add(templateColumn);\n</code></pre>\n\n<p>How should I resolve this problem, should I add an event handler to this datagrid, but how? </p>\n\n<p>Many thanks for your input,</p>\n\n<p>Wei</p>\n"},{"tags":["c#","entity-framework","ado.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13263557,"title":"db.savechanges() is not working","body":"<p>I'm following this tutorial <a href=\"http://msdn.microsoft.com/en-us/data/ff706685.aspx\" rel=\"nofollow\">Creating Master-Details Windows Forms with the Entity Framework</a>\nbut the <code>db.Savechanges()</code> isn't working if I modified some column or add a new row. According to this video tutorial it will work but it doesn't.</p>\n\n<p><b>Product_Form.cs</b></p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Windows.Forms;\n\nnamespace RemoteSynchronizer\n{\n    public partial class Product : Form\n    {\n\n        ProductsEntities db = new ProductsEntities();\n        public Product()\n        {\n            InitializeComponent();\n        }\n\n        private void Product_Form_Load(object sender, EventArgs e)\n        {\n            product_DBindingSource.DataSource = db.Product_D.ToList();\n        }\n\n        private void bindingNavigatorAddNewItem_Click(object sender, EventArgs e)\n        {\n\n        }\n\n        private void product_DBindingNavigatorSaveItem_Click(object sender, EventArgs e)\n        {\n            // Product_D obj = new Product_D();\n            // obj.PCode = pCodeTextBox.Text;\n            // obj.Name = nameTextBox.Text;\n            // obj.Batch = batchTextBox.Text;\n            // obj.Expiry = expiryTextBox.Text;\n            // obj.Price = priceTextBox.Text;\n\n            //try\n            // {\n            //     Product_D temp = db.Product_D.Single(t =&gt; t.PCode == pCodeTextBox.Text);\n\n            //     MessageBox.Show(\"Product Exists\");\n            // }\n            // catch \n            // {\n            //     db.Product_D.Add(obj);\n                 db.SaveChanges();\n\n             //}\n\n        }\n\n        private void bindingNavigatorDeleteItem_Click(object sender, EventArgs e)\n        {\n\n        }\n\n    }\n}\n</code></pre>\n\n<p>When I try to use comment method in code it gives an error</p>\n\n<p><b>Error</b></p>\n\n<pre class=\"lang-none prettyprint-override\"><code>************** Exception Text **************\nSystem.Data.Entity.Infrastructure.DbUpdateException: Unable to update the EntitySet 'Product_D' because it has a DefiningQuery and no &lt;InsertFunction&gt; element exists in the &lt;ModificationFunctionMapping&gt; element to support the current operation. ---&gt; System.Data.UpdateException: Unable to update the EntitySet 'Product_D' because it has a DefiningQuery and no &lt;InsertFunction&gt; element exists in the &lt;ModificationFunctionMapping&gt; element to support the current operation.\n   at System.Data.SqlClient.SqlGen.DmlSqlGenerator.ExpressionTranslator.Visit(DbScanExpression expression)\n   at System.Data.Common.CommandTrees.DbScanExpression.Accept(DbExpressionVisitor visitor)\n   at System.Data.SqlClient.SqlGen.DmlSqlGenerator.GenerateInsertSql(DbInsertCommandTree tree, SqlVersion sqlVersion, List`1&amp; parameters)\n   at System.Data.SqlClient.SqlGen.SqlGenerator.GenerateSql(DbCommandTree tree, SqlVersion sqlVersion, List`1&amp; parameters, CommandType&amp; commandType, HashSet`1&amp; paramsToForceNonUnicode)\n   at System.Data.SqlClient.SqlProviderServices.CreateCommand(DbProviderManifest providerManifest, DbCommandTree commandTree)\n   at System.Data.SqlClient.SqlProviderServices.CreateCommand(DbCommandTree commandTree)\n   at System.Data.Mapping.Update.Internal.UpdateTranslator.CreateCommand(DbModificationCommandTree commandTree)\n   at System.Data.Mapping.Update.Internal.DynamicUpdateCommand.CreateCommand(UpdateTranslator translator, Dictionary`2 identifierValues)\n   at System.Data.Mapping.Update.Internal.DynamicUpdateCommand.Execute(UpdateTranslator translator, EntityConnection connection, Dictionary`2 identifierValues, List`1 generatedValues)\n   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)\n   at System.Data.EntityClient.EntityAdapter.Update(IEntityStateManager entityCache)\n   at System.Data.Objects.ObjectContext.SaveChanges(SaveOptions options)\n   at System.Data.Entity.Internal.InternalContext.SaveChanges()\n   --- End of inner exception stack trace ---\n   at System.Data.Entity.Internal.InternalContext.SaveChanges()\n   at System.Data.Entity.Internal.LazyInternalContext.SaveChanges()\n   at System.Data.Entity.DbContext.SaveChanges()\n   at RemoteSynchronizer.Product.product_DBindingNavigatorSaveItem_Click(Object sender, EventArgs e) in e:\\Study\\Project\\RemoteSynchronizer\\RemoteSynchronizer\\Product_Form.cs:line 50\n   at System.Windows.Forms.ToolStripItem.RaiseEvent(Object key, EventArgs e)\n   at System.Windows.Forms.ToolStripButton.OnClick(EventArgs e)\n   at System.Windows.Forms.ToolStripItem.HandleClick(EventArgs e)\n   at System.Windows.Forms.ToolStripItem.HandleMouseUp(MouseEventArgs e)\n   at System.Windows.Forms.ToolStripItem.FireEventInteractive(EventArgs e, ToolStripItemEventType met)\n   at System.Windows.Forms.ToolStripItem.FireEvent(EventArgs e, ToolStripItemEventType met)\n   at System.Windows.Forms.ToolStrip.OnMouseUp(MouseEventArgs mea)\n   at System.Windows.Forms.Control.WmMouseUp(Message&amp; m, MouseButtons button, Int32 clicks)\n   at System.Windows.Forms.Control.WndProc(Message&amp; m)\n   at System.Windows.Forms.ScrollableControl.WndProc(Message&amp; m)\n   at System.Windows.Forms.ToolStrip.WndProc(Message&amp; m)\n   at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message&amp; m)\n   at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp; m)\n   at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)\n\n\n************** Loaded Assemblies **************\nmscorlib\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.18010 built by: FX45RTMGDR\n    CodeBase: file:///C:/Windows/Microsoft.NET/Framework/v4.0.30319/mscorlib.dll\n----------------------------------------\nRemoteSynchronizer\n    Assembly Version: 1.0.0.0\n    Win32 Version: 1.0.0.0\n    CodeBase: file:///E:/Study/Project/RemoteSynchronizer/RemoteSynchronizer/bin/Debug/RemoteSynchronizer.exe\n----------------------------------------\nSystem.Windows.Forms\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Windows.Forms/v4.0_4.0.0.0__b77a5c561934e089/System.Windows.Forms.dll\n----------------------------------------\nSystem.Drawing\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Drawing/v4.0_4.0.0.0__b03f5f7f11d50a3a/System.Drawing.dll\n----------------------------------------\nSystem\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.18016 built by: FX45RTMGDR\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System/v4.0_4.0.0.0__b77a5c561934e089/System.dll\n----------------------------------------\nSystem.Configuration\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Configuration/v4.0_4.0.0.0__b03f5f7f11d50a3a/System.Configuration.dll\n----------------------------------------\nSystem.Xml\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Xml/v4.0_4.0.0.0__b77a5c561934e089/System.Xml.dll\n----------------------------------------\nSystem.Web\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_32/System.Web/v4.0_4.0.0.0__b03f5f7f11d50a3a/System.Web.dll\n----------------------------------------\nSystem.Core\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Core/v4.0_4.0.0.0__b77a5c561934e089/System.Core.dll\n----------------------------------------\nEntityFramework\n    Assembly Version: 5.0.0.0\n    Win32 Version: 5.0.20627.0\n    CodeBase: file:///E:/Study/Project/RemoteSynchronizer/RemoteSynchronizer/bin/Debug/EntityFramework.DLL\n----------------------------------------\nSystem.Data.Entity\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Data.Entity/v4.0_4.0.0.0__b77a5c561934e089/System.Data.Entity.dll\n----------------------------------------\nAnonymously Hosted DynamicMethods Assembly\n    Assembly Version: 0.0.0.0\n    Win32 Version: 4.0.30319.18010 built by: FX45RTMGDR\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_32/mscorlib/v4.0_4.0.0.0__b77a5c561934e089/mscorlib.dll\n----------------------------------------\nAccessibility\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/Accessibility/v4.0_4.0.0.0__b03f5f7f11d50a3a/Accessibility.dll\n----------------------------------------\nSystem.Data\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_32/System.Data/v4.0_4.0.0.0__b77a5c561934e089/System.Data.dll\n----------------------------------------\nSystem.Transactions\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_32/System.Transactions/v4.0_4.0.0.0__b77a5c561934e089/System.Transactions.dll\n----------------------------------------\nSystem.Numerics\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Numerics/v4.0_4.0.0.0__b77a5c561934e089/System.Numerics.dll\n----------------------------------------\nSystem.Data.OracleClient\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_32/System.Data.OracleClient/v4.0_4.0.0.0__b77a5c561934e089/System.Data.OracleClient.dll\n----------------------------------------\nSystem.Xml.Linq\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Xml.Linq/v4.0_4.0.0.0__b77a5c561934e089/System.Xml.Linq.dll\n----------------------------------------\nSystem.EnterpriseServices\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_32/System.EnterpriseServices/v4.0_4.0.0.0__b03f5f7f11d50a3a/System.EnterpriseServices.dll\n----------------------------------------\nEntityFrameworkDynamicProxies-RemoteSynchronizer\n    Assembly Version: 1.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Data.Entity/v4.0_4.0.0.0__b77a5c561934e089/System.Data.Entity.dll\n----------------------------------------\nSystem.Runtime.Serialization\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Runtime.Serialization/v4.0_4.0.0.0__b77a5c561934e089/System.Runtime.Serialization.dll\n----------------------------------------\nSystem.ComponentModel.DataAnnotations\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.ComponentModel.DataAnnotations/v4.0_4.0.0.0__31bf3856ad364e35/System.ComponentModel.DataAnnotations.dll\n----------------------------------------\nMicrosoft.SqlServer.Types\n    Assembly Version: 11.0.0.0\n    Win32 Version: 2011.0110.2100.060 ((SQL11_RTM).120210-1917 )\n    CodeBase: file:///C:/Windows/assembly/GAC_MSIL/Microsoft.SqlServer.Types/11.0.0.0__89845dcd8080cc91/Microsoft.SqlServer.Types.dll\n----------------------------------------\n\n************** JIT Debugging **************\nTo enable just-in-time (JIT) debugging, the .config file for this\napplication or computer (machine.config) must have the\njitDebugging value set in the system.windows.forms section.\nThe application must also be compiled with debugging\nenabled.\n\nFor example:\n\n&lt;configuration&gt;\n    &lt;system.windows.forms jitDebugging=\"true\" /&gt;\n&lt;/configuration&gt;\n\nWhen JIT debugging is enabled, any unhandled exception\nwill be sent to the JIT debugger registered on the computer\nrather than be handled by this dialog box.\n</code></pre>\n\n<p>How to get rid of this problem? I'm trying to solve this by simple method <code>db.savechanges()</code> but it won't work.</p>\n"},{"tags":["c#"],"answer_count":10,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":262,"score":1,"question_id":3196207,"title":"Stuck with List<>","body":"<p>I have this:</p>\n\n<pre><code>public class accounts\n{\n    private string mName;\n    private string mEmail;\n    private string mAddress;\n\n    public accounts(string Name,\n    string Email,\n    string Address)\n    {\n        this.mName = Name;\n        this.mEmail = Email;\n        this.mAddress = Address;\n    }\n}\n</code></pre>\n\n<p>then, somewhere else, I create this:</p>\n\n<pre><code>private static List&lt;accounts&gt; mlocalaccountList = new List&lt;accounts&gt;()\n</code></pre>\n\n<p>then I fill it like this:</p>\n\n<pre><code>mlocalaccountList.Add(new accounts(\"John Smith\",\"johnsmith@mail.com\",\"CA USA\"));\n</code></pre>\n\n<p>Now, everything is OK, except, how can I access the list&lt;> items?? </p>\n"},{"tags":["c#","regex"],"answer_count":4,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":275,"score":5,"question_id":9096811,"title":"Parsing strings recursively","body":"<p>I am trying to extract information out of a string - a fortran formatting string to be specific. The string is formatted like:</p>\n\n<pre><code>F8.3, I5, 3(5X, 2(A20,F10.3)), 'XXX'\n</code></pre>\n\n<p>with formatting fields delimited by \",\" and formatting groups inside brackets, with the number in front of the brackets indicating how many consecutive times the formatting pattern is repeated. So, the string above expands to:</p>\n\n<pre><code>F8.3, I5, 5X, A20,F10.3, A20,F10.3, 5X, A20,F10.3, A20,F10.3, 5X, A20,F10.3, A20,F10.3, 'XXX'\n</code></pre>\n\n<p>I am trying to make something in C# that will expand a string that conforms to that pattern. I have started going about it with lots of switch and if statements, but am wondering if I am not going about it the wrong way? </p>\n\n<p>I was basically wondering if some Regex wizzard thinks that Regular expressions can do this in one neat-fell swoop? I know nothing about regular expressions, but if this could solve my problem I am considering putting in some time to learn how to use them... on the other hand if regular expressions can't sort this out then I'd rather spend my time looking at another method.</p>\n"},{"tags":["c#","winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":69,"score":3,"question_id":13252643,"title":"Child Application Menu not shown in a Chrome like application","body":"<p>I am developing a chrome like application. I do have two applications Say Parent and Child Application. Child application contains menus. \nWhen i am attaching an instance of child application to a tab of parent application. Menu in child application is not shown on mouse click.</p>\n\n<p>Code snippet used for attaching process is</p>\n\n<pre><code>Process P = Process.GetProcessesByName(\"Child\");\nP.WaitForInputIdle();\nIntPtr handle = P.MainWindowHandle;\nSetParent(handle, this.tabPage1.Handle);\nMoveWindow(handle, rec.X, rec.Y, rec.Width, rec.Height, true);\n</code></pre>\n\n<p>I cannot make any changes to Child application.</p>\n"},{"tags":["c#","wpf","combobox"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13262316,"title":"ComboBox selected item is not working","body":"<p>I create a simple combo box in my main XAML file but when I click on the combo box's item, the combo box does not update. It's just blank whenever I click on the combo box item.\nHowever, when I try to do it on a new XML file, it works. Guys, any idea what may cause the combo box to not function properly?</p>\n\n<p>I summaries my code  :</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;Window xmlns:my=\"clr-namespace:Microsoft.Windows.Controls;assembly=WPFToolkit\"  x:Class=\"BeaconProject.MainWindow\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\" \n    xmlns:UserControls=\"clr-namespace:BeaconProject.UserControls\"\n    xmlns:local=\"clr-namespace:BeaconProject\"\n    Title=\"MainWindow\" Height=\"610\" Width=\"910\" MinHeight=\"610\" MinWidth=\"910\"    WindowStartupLocation=\"CenterScreen\" Icon=\"/pictures/cardsIcon.png\"&gt;\n\n&lt;Window.Background&gt;\n    &lt;LinearGradientBrush StartPoint=\"0.6,0\" EndPoint=\"0.6,1\"&gt;\n        &lt;LinearGradientBrush.GradientStops&gt;\n            &lt;GradientStop Color=\"#FF00142D\" Offset=\"0\"/&gt;\n            &lt;GradientStop Color=\"#FF2A4570\" Offset=\"1\"/&gt;\n        &lt;/LinearGradientBrush.GradientStops&gt;\n    &lt;/LinearGradientBrush&gt;\n&lt;/Window.Background&gt;\n\n&lt;DockPanel Name=\"baccaratPanel\" &gt;\n                &lt;GroupBox Height=\"120\" Name=\"baccaratPreSettingGB\" DockPanel.Dock=\"Top\" &gt;                      \n                &lt;Grid&gt;                           \n                   &lt;Grid.ColumnDefinitions&gt;\n                       &lt;ColumnDefinition /&gt;                            \n                       &lt;ColumnDefinition /&gt;\n                   &lt;/Grid.ColumnDefinitions&gt;\n                   &lt;Grid.RowDefinitions&gt;\n                        &lt;RowDefinition  /&gt;\n                        &lt;RowDefinition  /&gt;                       \n                   &lt;/Grid.RowDefinitions&gt;\n\n              &lt;StackPanel Orientation=\"Horizontal\"  &gt;\n                 &lt;TextBlock Text=\"Date from:\" FontWeight=\"Bold\" Margin=\"10,10,5,0\"  /&gt;\n                 &lt;DatePicker Name=\"datafromDP\"  Margin=\"5,8,5,5\"  /&gt;\n                 &lt;TextBlock Text=\"Date to:\" FontWeight=\"Bold\" Margin=\"10,10,5,0\" /&gt;\n                 &lt;DatePicker Name=\"dateToDp\" Margin=\"5,8,5,5\"/&gt;                               \n              &lt;/StackPanel&gt;\n\n\n             &lt;StackPanel Orientation=\"Horizontal\" HorizontalAlignment=\"Right\" Grid.Column=\"1\"  &gt;\n             &lt;TextBlock Text=\"Select table:\" FontWeight=\"Bold\" Margin=\"5,15,3,0\"&gt;&lt;/TextBlock&gt;\n             &lt;ComboBox Name=\"tableComboBox\" Width=\"70\" Margin=\"5,6,5,0\" Height=\"25\"&gt;     //My combo box**\n                  &lt;ComboBoxItem Content=\"Table1\" /&gt;\n                  &lt;ComboBoxItem Content=\"Table2\" /&gt;\n                  &lt;ComboBoxItem Content=\"Table3\" /&gt;\n                  &lt;ComboBoxItem Content=\"Table4\" /&gt;\n                  &lt;ComboBoxItem Content=\"Table5\" /&gt;\n              &lt;/ComboBox&gt;\n                   &lt;Rectangle Fill=\"Black\" Width=\"30\" Height=\"35\"/&gt;\n              &lt;/StackPanel&gt;\n\n\n                   &lt;/Grid&gt;                       \n              &lt;/GroupBox&gt;\n</code></pre>\n"},{"tags":["c#","sql-server","entity-framework"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13259655,"title":"Data integrity in Entity Framework","body":"<p>Are there any consensus as to what is considered the best method in always maintaining data integrity in Entity Framework. i.e. when adding or deleting entities, how do I make sure the loaded model is the most recent, and that nothing has changed on the db behind my back?</p>\n\n<p>A rough method that seem to work for me in the majority of cases, is to reload the context between sessions, i.e. not to have a persistent model, and reload/refresh in case of an error. This seems to work in cases of low data clashes, however is very costly when lots of changes happen in different services. Is there a flag to query if the data/row on disk have changed or event to make this refresh automatic, i.e. update any subscribers of certain tables/rows?</p>\n"},{"tags":["c#","printing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2940,"score":0,"question_id":5563788,"title":"How to check a print job status with C#","body":"<p>I'm printing a PDF file by executing a commandline application from within my C# application. Now I wanna know when this job is printed. I was hoping there would be some kind of event I could subscribe to, and handle it. But I couldn't find it.</p>\n\n<p>So now I'm resorting to polling. And checking the JobStatus of a PrinterSystemJobInfo object. But in my case this either gives me JobStatus = None or JobStatus = Printing.</p>\n\n<pre><code>PrinterSystemJobInfo.JobStatus\n</code></pre>\n\n<p>Can someone tell me how to reliably check a print job status using C#?</p>\n"},{"tags":["c#",".net","silverlight","xaml","iis7"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12812670,"title":"Critical Viewer Error - Cannot Load XAML Resource","body":"<p>I have a silverlight application and it works completely fine in VS2010 then when I upload it to IIS7 and try to browse it I get an error saying</p>\n\n<p>\"An error occurred during initialization and the Viewer could not be started. This may be due to network connectivity problems, viewer configuration problems, or site configuration problems\" </p>\n\n<p>Further details of the error are:</p>\n\n<p>\"Cannot load Xaml resource from /config/themes/map/map.xaml.\"</p>\n\n<p>If I navigate to the folder where it says that it cannot load it I can see that it is there and that it looks to be in the correct formatting(as it should be if it was working on my local machine). So I thought maybe permissions were stopping it so I checked that and there are sufficint permissions to access the file. </p>\n\n<p>Does anyone know what might be causing this error and how to fix it?</p>\n"},{"tags":["c#","string","combobox"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":947,"score":1,"question_id":9648381,"title":"how to prevent manual input into a ComboBox in C#","body":"<p>i have a form in C# that uses ComboBox\nhow do i prevent a user form manualy input text in the ComboBox in C#?</p>\n\n<pre><code>this.comboBoxType.Font = new System.Drawing.Font(\"Arial\", 15.75F);\n            this.comboBoxType.FormattingEnabled = true;\n            this.comboBoxType.Items.AddRange(new object[] {\n            \"a\",\n            \"b\",\n            \"c\"});\n            this.comboBoxType.Location = new System.Drawing.Point(742, 364);\n            this.comboBoxType.Name = \"comboBoxType\";\n            this.comboBoxType.Size = new System.Drawing.Size(89, 32);\n            this.comboBoxType.TabIndex = 57;   \n</code></pre>\n\n<p>i want A B C to be the only options</p>\n"},{"tags":["c#","winforms","combobox"],"answer_count":2,"favorite_count":1,"up_vote_count":23,"down_vote_count":0,"view_count":18755,"score":23,"question_id":598447,"title":"How to disable editing of elements in combobox for c#?","body":"<p>I have some elements in a ComboBox (WinForms with C#). I want their content to be static so that a user cannot change the values inside when the application is ran. I also do not want the user adding new values to the ComboBox</p>\n"},{"tags":["c#","database","caching","dynamic","storage"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":181,"score":3,"question_id":13108416,"title":"Best approach to incremently update application data","body":"<p>I have been working on an application for a couple of years that I updated using a back-end database. The whole key is that everything is cached on the client, so that it never requires an network connection to operate, but when it does have a connection it will always pickup the latest updates. Every application updated is shipped with the latest version of the database and I wanted it to download only the minimum amount of data when the database has been updated.</p>\n\n<p>I currently use a table with a timestamp to check for updates. It looks something like this.</p>\n\n<pre><code>ID - Name - Description- Severity - LastUpdated\n0 - test.exe - KnownVirus - Critical - 2009-09-11 13:38\n1 - test2.exe - Firewall - None - 2009-09-12 14:38\n</code></pre>\n\n<p>This approach was fine for what I previously needed, but I am looking to expand more function of the application to use this type of dynamic approach. All the data is currently stored as <code>XML</code>, but I do not want to store complete XML files in the database and only transmit changed data.</p>\n\n<p>So how would you go about allowing a fairly simple approach to storing dynamic content (text/xml/json/xaml) in a database, and have the client only download new updates? I was thinking of having logic that can handle XML inserted directly</p>\n\n<pre><code>ID - Data - Revision\n15 - XXX - 15\n</code></pre>\n\n<p><code>XXX</code> would be something like <code>&lt;Content&gt;&lt;File&gt;Test.dll&lt;File/&gt;&lt;Description&gt;New DLL to load.&lt;/Description&gt;&lt;/Content&gt;</code> and would be inserted into the cache, but this would obviously be complicated as I would need to load them in sequence. </p>\n\n<p>Another approach that has been mentioned was to base it on something similar to Source Control, storing the version in the root of the file and calculating the delta to figure out the minimal amount of data that need to be sent to the client.</p>\n\n<p>Anyone got any suggestions on how to approach this with no risk for data corruption? I would also to expand with features that allows me to revert possibly bad revisions, and replace them with new working ones.</p>\n"},{"tags":["c#","visual-studio-2010","stylecop"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13229961,"title":"Using stylecop to set boolean variable rule","body":"<p>A boolean variable must have a prefix is, such as: <code>bool isFinished;</code>\nHow can I write a custom rule for it? (I'm using stylecop)</p>\n"},{"tags":["c#","linq","sorting","paging"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13263216,"title":"Entity IQueryable with page, search and sort","body":"<p>I'm sure this has been answered before, but can't seem to find it.</p>\n\n<p>I'm looking for a simple download (or tutorial) for building an IQueryable that can be sorted, paged and searched.</p>\n\n<p>e.g.</p>\n\n<pre><code>IQueryable&lt;T&gt; myThings , params[] searchKeyValuePairs, params[] orderKeyValuePairs, int pageSize, int pageNumber\n</code></pre>\n\n<p>Or something similar.  Guessing it will be using Dynamic Linq.</p>\n\n<p>My requirement is for a number of MVC3 views for broadly similar data.  BA specified about 20 views of each of 10 data types...but MOST of these views are simply \"All Today\" and \"Sorted by Cost\" type views.</p>\n\n<p>Data is from SQL or Oracle through EF4.</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":62,"score":0,"question_id":13263099,"title":"pass object between forms c#","body":"<p>I am working on a form application that has two windows. In the main window, Form1 I create an instance of the class Treatment. I would like to pass that instance, once a image is clicked to the other window form2. So far I have:\nForm1:</p>\n\n<pre><code>public partial class Form1 : Form\n{\n\n    private Treatment treatment;\n\n//method where i inistantiate the treatment\nprivate void processTreatment(int id, Button button)\n    {\n        treatment = new Treatment(wirelessResult, id);\n        Alarm alarm = new Alarm(count, treatment);\n        wirelessResult.GenerateNumber();\n        alarm.setColor();\n        events.add(alarm);\n        if (getResult(treatment) == true)\n        {\n            storeSuccess(button);  \n        }\n        else if (getResult(treatment) == false)\n        {\n            storeFailed(button);\n        }\n    }\n// image clicked   \nprivate void treatmentStation1_Click(object sender, EventArgs e)\n    {\n\n        Form2 secondForm = new Form2(treatment);\n        secondForm.Show();\n    }\n</code></pre>\n\n<p>and in form2:</p>\n\n<pre><code>public partial class Form2 : Form\n{\n    private Treatment treatment;\n\n\n    public Form2()\n    {\n        InitializeComponent();\n\n    }\n\n    public Form2(Treatment treatment)\n    {\n        InitializeComponent();\n        this.treatment = treatment;\n    }\n  }\n}\n</code></pre>\n\n<p>I get 1 error : Error   1   Inconsistent accessibility: parameter type 'WasteTreatment.Treatment' is less accessible than method 'WasteTreatment.Form2.Form2(WasteTreatment.Treatment)'</p>\n\n<p>Someone can help me to fix this?</p>\n"},{"tags":["c#","authentication","azure"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13259938,"title":"Azure Data Service Authentication","body":"<p>So I am trying to connect to a azure data service using <strong>basic authentication</strong>:</p>\n\n<pre><code>string ROOT_URL = \"https://api.datamarket.azure.com/Data.ashx/MelissaData/AddressCheck/v1\";\nprivate Uri serviceUri = new Uri(ROOT_URL);\nprivate AddressCheckContainer context = new AddressCheckContainer(serviceUri);\nstring SECURE_ACCOUNT_ID = \"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\";\ncontext.Credentials = new NetworkCredential(\"\", SECURE_ACCOUNT_ID);\n</code></pre>\n\n<p>I get this error even though I am using basic authentication: <br/>\n<code>The authorization type you provided is not supported.  Only Basic and OAuth are supported</code> <br/></p>\n"},{"tags":["c#","javascript","jquery"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13221230,"title":"How to view an image when scroll position is located at the bottom of the page?","body":"<p>I need the browser to scroll my ASP.NET page to the top when the user\nclicks on a server-side link or button at the bottom of the page. </p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;div id=\"box\" style=\" position: fixed; bottom:5px;\"&gt;\n&lt;a href=\"#top\" &gt;Back to up&lt;img  height=\"40\" src=\"../images/btnup.png\" /&gt;&lt;/a&gt; \n</code></pre>\n\n<p></p>\n\n<p>I use this code for it:</p>\n\n<pre><code> $(document).ready(function () {\n\n        $('a[href=#top]').click(function () {\n            $('html, body').animate({ scrollTop: 0 }, 'slow');\n            return false;\n        });\n\n    });\n</code></pre>\n\n<p>I want to show this button when the scroll position is at the bottom of the page and don't want to show this when the scroll position is at the top of the page.</p>\n\n<p>How to view this button when the scroll position is at the bottom of the page?</p>\n"},{"tags":["c#",".net","templates","ms-word","template-engine"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13195973,"title":"What template engines are there that allow creating templates in Microsoft Word?","body":"<p>In a project I'm working on we will (most likely) need the following feature: the user uploads a word document (can be limited to DOCX, I believe), that is a template with placeholders. The system then takes this document, fills in the placeholders with data, and produces a final word document (and optionally also converts it to a PDF).</p>\n\n<p>In the worst case I can dig through the bowels of DOCX myself, we did this with XLSX in another project (using the low-level library Microsoft provides), but it was quite painful, and I wonder if there is something premade.</p>\n\n<p><strong>Added:</strong> Completely forgot - we're working in Visual Studio 2012, C# 4.5.</p>\n"},{"tags":["c#","ruby","openssl","padding","ruby-1.9.2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13241489,"title":"How to set Padding Mode with Ruby/OpenSSL decryption / encryption?","body":"<p>I am starting with the following <code>C#</code> encryption code, and want to decrypt with <code>Ruby</code>. My problem is that I don't know how to set the padding mode in <code>Ruby/OpenSSL</code>. I specifically need to use <code>PKCS7</code>.</p>\n\n<p><strong>C# encryption</strong></p>\n\n<pre><code>System.Security.Cryptography.Aes c = new System.Security.Cryptography.AesManaged();\nc.Mode = CipherMode.CBC;\nc.Padding = PaddingMode.PKCS7;   # &lt;-- how to set this in Ruby world?\nc.KeySize = 256;\nc.BlockSize = 128;\nc.Key = key;\nc.IV = iv;\n...\n</code></pre>\n\n<p><strong>Ruby decryption</strong></p>\n\n<pre><code>d = OpenSSL::Cipher.new('AES-128-CBC') # oops, this should have been AES-256-CBC\nd.decrypt\nd.key = key\nd.iv  = iv\n...\n</code></pre>\n\n<p>I am currently using <code>Ruby 1.9.2</code>, but can use whatever version necessary.</p>\n"},{"tags":["c#","asp.net","appfabric","windows-server"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13262839,"title":"datacacheexception Cache referred to does not exist","body":"<p>I get the following error when I invoke the call factory.GetDefaultCache()... </p>\n\n<p><strong>ErrorCode:SubStatus:Cache referred to does not exist. Contact administrator or use the Cache administration tool to create a Cache.</strong></p>\n\n<p>Please help.. thanks..</p>\n\n<p>Here is my simple application: </p>\n\n<pre><code>var config = new Microsoft.ApplicationServer.Caching.DataCacheFactoryConfiguration();\nvar servers = new List&lt;Microsoft.ApplicationServer.Caching.DataCacheServerEndpoint&gt;();\nservers.Add(new Microsoft.ApplicationServer.Caching.DataCacheServerEndpoint(\"mymachine123\", 22233));\nconfig.Servers = servers;\nvar factory = new Microsoft.ApplicationServer.Caching.DataCacheFactory(config);\n\n////var factory = _cacheFactory;\n\nvar cache = factory.GetDefaultCache();  &lt;---- *** Error happens here..***\nvar key = \"mykey\";\nvar obj = cache[key];\nif (obj == null)\n{\n    cache[key] = \"I am data for caching\";\n}\nobj = cache[key];\nConsole.WriteLine(obj);\n</code></pre>\n\n<p>When I run the command: start-cachecluster, I get the following:</p>\n\n<p>HostName : CachePort      Service Name            Service Status Version Info\n--------------------      ------------            -------------- ------------\nmymachine123:22233         AppFabricCachingService UP             1 [1,1][1,1]</p>\n"},{"tags":["c#","asp.net","web-services","webservices-client"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13244829,"title":"Connect multiple server by webservices from asp.net","body":"<p>Thanks for reading my question.I wondered if you have any idea about this problem.</p>\n\n<ol>\n<li><p>I wrote a SOAP-SERVER. Running it at CentOS. Changing Soap-Server's IPAddress for match with CentOS Ifconfig.</p></li>\n<li><p>Running SOAP-SERVER in CentOS.</p></li>\n<li><p>Using VisualStudio tools for AddWebReference .It'll auto generate a define object class.In this class,It containt all of function of SOAP-SERVER.</p></li>\n<li><p>Developer will use these function for do something at ASP.Net-Client.</p></li>\n</ol>\n\n<p>But,When I want to connect from ASP-NET to more SOAP-SERVER(in other CentOSs).And we musn't using AddWebReference .Because User will use web form for input IPAddress of these SOAP-SERVER.</p>\n\n<p>Do you have any idea? Thanks for helping by anyway.Thanks</p>\n"},{"tags":["c#","php","wcf","flash","real-time"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13262992,"title":"real-time web update using WCF","body":"<p>I have been reading a lot of forums regarding the use of WCF in web, most specifically, this topic: <a href=\"http://stackoverflow.com/questions/3306744/wcf-with-flash-tutorial\">WCF with Flash tutorial</a>, but I am really confused. </p>\n\n<p>I have an existing feed server that is using WCF service. It is, with no problems, supplying real-time information to its windows applications clients. What i would like to do is to have a web application to subscribe to the feeds that i am supplying to the windows application clients. With the forum that i have read (the one i have indicated), it seems like it will be a request reply method. And i think, using that, i wouldn't be able to achieve the real-time transfer of feeds for it. </p>\n\n<p>I would like to know if there is an equivalent for the callback function in web development.</p>\n"},{"tags":["c#","asp.net","web-services","asmx"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":94,"score":0,"question_id":13188860,"title":"Get Custom Class from webservices","body":"<p>After calling <code>Webservices</code>, it returns an object (This object is a custom object class) to client. So, I want to convert from this object to custom class.</p>\n\n<p>-Webservices:</p>\n\n<pre><code>[WebMethod]\npublic Cls_ROLES GetRoles(int firstNum)\n{\n    Cls_ROLES o = new Cls_ROLES();\n    o.Role_ID = 2;\n    o.RoleName = \"binh\";\n    return o;\n}\n</code></pre>\n\n<p>-Client:</p>\n\n<p>+Function:</p>\n\n<pre><code>public object CallWebService(string webServiceAsmxUrl, string serviceName, string methodName, object[] args)\n{\n    System.Net.WebClient client = new System.Net.WebClient();\n    //-Connect To the web service\n    using (System.IO.Stream stream = client.OpenRead(webServiceAsmxUrl + \"?wsdl\"))\n    {\n        //--Now read the WSDL file describing a service.\n        ServiceDescription description = ServiceDescription.Read(stream);\n        ///// LOAD THE DOM /////////\n        //--Initialize a service description importer.\n        ServiceDescriptionImporter importer = new ServiceDescriptionImporter();\n        importer.ProtocolName = \"Soap12\"; // Use SOAP 1.2.\n        importer.AddServiceDescription(description, null, null);\n        //--Generate a proxy client. importer.Style = ServiceDescriptionImportStyle.Client;\n        //--Generate properties to represent primitive values.\n        importer.CodeGenerationOptions = System.Xml.Serialization.CodeGenerationOptions.GenerateProperties;\n        //--Initialize a Code-DOM tree into which we will import the service.\n        CodeNamespace nmspace = new CodeNamespace();\n        CodeCompileUnit unit1 = new CodeCompileUnit();\n        unit1.Namespaces.Add(nmspace);\n        //--Import the service into the Code-DOM tree. This creates proxy code\n        //--that uses the service.\n        ServiceDescriptionImportWarnings warning = importer.Import(nmspace, unit1);\n        if (warning == 0) //--If zero then we are good to go\n        {\n            //--Generate the proxy code \n            CodeDomProvider provider1 = CodeDomProvider.CreateProvider(\"CSharp\");\n            //--Compile the assembly proxy with the appropriate references\n            string[] assemblyReferences = new string[5] { \"System.dll\", \"System.Web.Services.dll\", \"System.Web.dll\", \"System.Xml.dll\", \"System.Data.dll\" };\n            CompilerParameters parms = new CompilerParameters(assemblyReferences);\n            CompilerResults results = provider1.CompileAssemblyFromDom(parms, unit1);\n            //-Check For Errors\n            if (results.Errors.Count &gt; 0)\n            {\n                StringBuilder sb = new StringBuilder();\n                foreach (CompilerError oops in results.Errors)\n                {\n                    sb.AppendLine(\"========Compiler error============\");\n                    sb.AppendLine(oops.ErrorText);\n                }\n                throw new System.ApplicationException(\"Compile Error Occured calling webservice. \" + sb.ToString());\n            }\n            //--Finally, Invoke the web service method \n            Type foundType = null;\n            Type[] types = results.CompiledAssembly.GetTypes();\n            foreach (Type type in types)\n            {\n                if (type.BaseType == typeof(System.Web.Services.Protocols.SoapHttpClientProtocol))\n                {\n                    Console.WriteLine(type.ToString());\n                    foundType = type;\n                }\n            }\n\n            object wsvcClass = results.CompiledAssembly.CreateInstance(foundType.ToString());\n            MethodInfo mi = wsvcClass.GetType().GetMethod(methodName);\n            object o = new object();\n            o=mi.Invoke(wsvcClass, args);\n            return o;\n        }\n        else\n        {\n            return null;\n        }\n    }\n}\n</code></pre>\n\n<p>+Page_Load function:</p>\n\n<pre><code>Line 1:object[] args=new object[1];\nLine 2:args[0]=1;  \nLine 3:o = this.CallWebService(\"http://localhost:1814/HelloServices/Service.asmx\", \"Hello\", \"GetRoles\", args);\n</code></pre>\n\n<p>it returns an object at Line3 (This object is a custom object class) to client. So, I want to convert from this object to custom class(Cls_Role object).\n//======================================================================================\n//======================================================================================\n//======================================================================================\nAs Selalu_Ingin_Belajar's answer,I can get value from webservices to client fine.</p>\n\n<p>object yourObject = new object();</p>\n\n<pre><code>foreach (PropertyInfo property in yourObject.GetType().GetProperties())\n{           \n    object value = property.GetValue(yourObject , null);\n    Console.WriteLine(\"{0} = {1}\", property.Name, value);\n}\n</code></pre>\n\n<p>Beside it,When I apply to another project,It show another error: Parameter count mismatch.\nIf I use AddWebReference by VisualStudio tool.\nIt'll auto generate Reference.cs file.It contain:</p>\n\n<pre><code>/// &lt;remarks/&gt;\n    [System.Web.Services.Protocols.SoapRpcMethodAttribute(\"\", RequestNamespace=\"urn:ALBAPI\", ResponseNamespace=\"urn:ALBAPI\")]\n    [return: System.Xml.Serialization.SoapElementAttribute(\"info\")]\n    public ResponseInfo getSetupLicenseRows(out SetupLicenseRowsValues values) {\n        object[] results = this.Invoke(\"getSetupLicenseRows\", new object[0]);\n        values = ((SetupLicenseRowsValues)(results[1]));\n        return ((ResponseInfo)(results[0]));\n    }\n</code></pre>\n\n<p>So that,It's easy to call from webClient by passing a object SetupLicenseRowsValues class.\nNow,I must pass parameter to WebServices by manually.Don't use this generate file.</p>\n\n<p>Client:</p>\n\n<pre><code>public object CallWebService(string webServiceAsmxUrl, string serviceName, string methodName, object[] args)\n        {\n            System.Net.WebClient client = new System.Net.WebClient();\n            //-Connect To the web service\n            using (System.IO.Stream stream = client.OpenRead(webServiceAsmxUrl + \"?wsdl\"))\n            {\n                //--Now read the WSDL file describing a service.\n                ServiceDescription description = ServiceDescription.Read(stream);\n                ///// LOAD THE DOM /////////\n                //--Initialize a service description importer.\n                ServiceDescriptionImporter importer = new ServiceDescriptionImporter();\n                importer.ProtocolName = \"Soap12\"; // Use SOAP 1.2.\n                importer.AddServiceDescription(description, null, null);\n                //--Generate a proxy client. importer.Style = ServiceDescriptionImportStyle.Client;\n                //--Generate properties to represent primitive values.\n                importer.CodeGenerationOptions = System.Xml.Serialization.CodeGenerationOptions.GenerateProperties;\n                //--Initialize a Code-DOM tree into which we will import the service.\n                CodeNamespace nmspace = new CodeNamespace();\n                CodeCompileUnit unit1 = new CodeCompileUnit();\n                unit1.Namespaces.Add(nmspace);\n                //--Import the service into the Code-DOM tree. This creates proxy code\n                //--that uses the service.\n                ServiceDescriptionImportWarnings warning = importer.Import(nmspace, unit1);\n                if (warning == 0) //--If zero then we are good to go\n                {\n                    //--Generate the proxy code \n                    CodeDomProvider provider1 = CodeDomProvider.CreateProvider(\"CSharp\");\n                    //--Compile the assembly proxy with the appropriate references\n                    string[] assemblyReferences = new string[5] { \"System.dll\", \"System.Web.Services.dll\", \"System.Web.dll\", \"System.Xml.dll\", \"System.Data.dll\" };\n                    CompilerParameters parms = new CompilerParameters(assemblyReferences);\n                    CompilerResults results = provider1.CompileAssemblyFromDom(parms, unit1);\n                    //-Check For Errors\n                    if (results.Errors.Count &gt; 0)\n                    {\n                        StringBuilder sb = new StringBuilder();\n                        foreach (CompilerError oops in results.Errors)\n                        {\n                            sb.AppendLine(\"========Compiler error============\");\n                            sb.AppendLine(oops.ErrorText);\n                        }\n                        throw new System.ApplicationException(\"Compile Error Occured calling webservice. \" + sb.ToString());\n                    }\n                    //--Finally, Invoke the web service method \n                    Type foundType = null;\n                    Type[] types = results.CompiledAssembly.GetTypes();\n                    foreach (Type type in types)\n                    {\n                        if (type.BaseType == typeof(System.Web.Services.Protocols.SoapHttpClientProtocol))\n                        {\n                            Console.WriteLine(type.ToString());\n                            foundType = type;\n                        }\n                    }\n\n                    object wsvcClass = results.CompiledAssembly.CreateInstance(foundType.ToString());\n                    MethodInfo mi = wsvcClass.GetType().GetMethod(methodName);\n                    object o = new object();\n                    Line error: o = mi.Invoke(wsvcClass, new object[0]);\n                    return o;\n                }\n                else\n                {\n                    return null;\n                }\n            }\n        }\npublic void call()\n    {\n        string WebserviceUrl = \"http://192.168.2.19:3333/ALBAPI.wsdl\";\n        string serviceName = \"ALBAPI\";\n        string methodName = \"getSetupLicenseRows\";\n        object[] args=new object[0];\n        object sSessionID = CallWebService(WebserviceUrl, serviceName, methodName,args);\n        foreach (PropertyInfo property in sSessionID.GetType().GetProperties())\n        {\n            object value = property.GetValue(sSessionID, null);\n\n            Console.WriteLine(\"{0} = {1}\", property.Name, value);\n        }\n\n    }\n</code></pre>\n\n<p>Now,It show error \"Parameter count mismatch\" at Line error.\nThanks for your help anyway</p>\n"},{"tags":["c#","cross-platform","bytearray","long-integer","endianness"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13262021,"title":"LongToByte and LongFromByte","body":"<p>I have the two functions shown below which I built for serialisation of long and byte[] values.</p>\n\n<pre><code>    public static byte[] LongToByte(long Value)\n    {\n        byte[] Output = new byte[8];\n        Output[0] = (byte)Value;\n        Output[1] = (byte)(Value &gt;&gt; 8);\n        Output[2] = (byte)(Value &gt;&gt; 16);\n        Output[3] = (byte)(Value &gt;&gt; 24);\n        Output[4] = (byte)(Value &gt;&gt; 32);\n        Output[5] = (byte)(Value &gt;&gt; 40);\n        Output[6] = (byte)(Value &gt;&gt; 48);\n        Output[7] = (byte)(Value &gt;&gt; 56);\n        return Output;\n    }\n\n    public static long LongFromByte(byte[] Value)\n    {\n        long Output = Value[0];\n        Output += ((long)Value[1] &lt;&lt; 8);\n        Output += ((long)Value[2] &lt;&lt; 16);\n        Output += ((long)Value[3] &lt;&lt; 24);\n        Output += ((long)Value[4] &lt;&lt; 32);\n        Output += ((long)Value[5] &lt;&lt; 40);\n        Output += ((long)Value[6] &lt;&lt; 48);\n        Output += ((long)Value[7] &lt;&lt; 56);\n        return Output;\n    }\n</code></pre>\n\n<p>Will using the above methods ensure endianness remains the same across any platform which is using them.</p>\n\n<p>Or will the result of either or change based on the endianness of the system processing the code?</p>\n\n<p>Thanking all.</p>\n"},{"tags":["c#","pdf","text-files"],"answer_count":6,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":6088,"score":4,"question_id":1944576,"title":"Convert a pdf file to text in C#","body":"<p>I need to convert a .pdf file to a .txt file (or .doc, but I prefer .txt).</p>\n\n<p>How can I do this in C#?</p>\n"},{"tags":["c#","windows-8","microsoft-metro"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13262936,"title":"Proper way to perform camera preview mirroring mode","body":"<p>Currently, when tested using <a href=\"http://code.msdn.microsoft.com/windowsapps/Media-Capture-Sample-adf87622\" rel=\"nofollow\">Media capture using capture device sample</a>, I realize the camera is not something I want. <strong>I wish it to be in mirroring mode. Currently, it is not.</strong></p>\n\n<ol>\n<li><p>For a camera preview to be in mirroring mode, may I know is it hardware dependent or hardware independent. Possible that if I run the same code with different hardware, the camera preview will be in mirroring mode? If it is hardware dependent, how can I check whether my camera preview is in mirroring/non-mirroring mode?</p></li>\n<li><p>To make it in mirroring mode, I try to follow <a href=\"http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/51d3d2c2-0407-4c6d-9691-942939344aac\" rel=\"nofollow\">this thread</a>. I try <code>MediaCapture.SetPreviewMirroring(true)</code>. No effect as all. The camera preview is still in non-mirroring mode.</p></li>\n<li><p>I try <code>captureElement.RenderTransform = new ScaleTransform() { ScaleX = -1 };</code>. The whole camera preview become plain grey color.</p></li>\n<li><p>The last approach I would like to try, is try to perform flipping in C++ code through <code>MediaCapture.AddEffectAsync()</code>. However, that need to go back to my <strong>first question</strong>. Can I just simply perform flipping, or do I first need to check whether the incoming buffer is in mirroring/non-mirroring mode? If yes, how do I check?</p></li>\n</ol>\n"},{"tags":["c#","mysql","query","datetime"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13262638,"title":"Search datetime in MySQL","body":"<p>I have a MySQL database, there's a table which have column Time's Type is <strong>Nvachar(50)</strong> and <strong>its values</strong> is <strong>kind like this \"05/09/2012 20:53:40:843\"</strong> *<em>(Month-date-year hour:mins:second:msecond)</em>*</p>\n\n<p>Now I want to query to get a record have Time after \"10/05/2012 01:00:30 PM\".\nI had code in C# to converted it to \"05/10/2012 13:00:30\" before making a query.\nMy Query : </p>\n\n<pre><code>SELECT * FROM ABCDFEGH WHERE capTime &gt; '05/10/2012 13:00:30' LIMIT 0, 1\n</code></pre>\n\n<p>But i got no record. So please tell me how can I can make it return record have time after the time above ???  </p>\n\n<p>More Info My C# code :</p>\n\n<pre><code>string tableName = \"ABCDFEGH\";\nstring date = \"05/10/2012 13:00:30\";\n\nvar query = \"SELECT * FROM \" + tableName + \" WHERE capTime &gt; '\" + date + \"' LIMIT 0, 1\";\n\nvar cmd = new MySqlCommand(query, connection);\nMySqlDataReader dataReader = null;\ntry\n{\ndataReader = cmd.ExecuteReader();\n}\n</code></pre>\n\n<p>I'm so so so so so so sorry. I made a mistake the query must be</p>\n\n<pre><code>SELECT * FROM ABCDFEGH WHERE capTime &gt; '05/10/2012 13:00:30' LIMIT 0, 1\n</code></pre>\n\n<p>This query is successful return the record i need :)</p>\n\n<p>But soemhow I have mistyped it into </p>\n\n<pre><code>SELECT * FROM ABCDFEGH WHERE capTime &gt; '05-10-2012 13:00:30' LIMIT 0, 1\n</code></pre>\n\n<p>Sorry again, topic close. But tks for evveryone tried :) </p>\n"},{"tags":["c#","asp.net","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13244767,"title":"unable to read a particular cell from excel using reader","body":"<p>I am importing excel into sql server db the excel sheet has three columns :   </p>\n\n<blockquote>\n  <p>id(number only)|data|passport  </p>\n</blockquote>\n\n<p>before importing it i want to check for certain things such as:<br>\n\n<li>the passport should begin a letter and rest of the characters must be numbers </li>\n<li>id must be numeric only </li></p>\n\n<p>I am able to check for passport but i am not able to check id even though i am using same code i used for checking passport. </p>\n\n<pre><code>             using (DbDataReader dr = command.ExecuteReader())\n        {\n            // SQL Server Connection String\n            string sqlConnectionString = \"Data Source=DITSEC3;Initial Catalog=test;Integrated Security=True\";\n\n            con.Open();\n            DataTable dt7 = new DataTable();\n            dt7.Load(dr);\n            DataRow[] ExcelRows = new DataRow[dt7.Rows.Count];\n            DataColumn[] ExcelColumn = new DataColumn[dt7.Columns.Count];\n\n            //=================================================\n            for (int i1 = 0; i1 &lt; dt7.Rows.Count; i1++)\n            {\n\n                if (dt7.Rows[i1][\"passport\"] == null)\n                {\n                    dt7.Rows[i1][\"passport\"] = 0;\n\n                }\n                if (dt7.Rows[i1][\"id\"] == null)\n                {\n                    dt7.Rows[i1][\"id\"] = 0;\n                }\n\n                string a = Convert.ToString(dt7.Rows[i1][\"passport\"]);\n                string b = dt7.Rows[i1][\"id\"].ToString();\n\n                if (!string.IsNullOrEmpty(b))\n                {\n                    int idlen = b.Length;\n\n                    for (int j = 0; j &lt; idlen; j++)\n                    {\n                        if (Char.IsDigit(b[j]))\n                        {\n                            //action\n                        }\n                        if(!Char.IsDigit(b[j]))\n                        {\n                            flag = flag + 1;\n                            int errline = i1 + 2;\n                            Label12.Text = \"Error at line: \" + errline.ToString();\n                            //Label12.Visible = true;\n                        }\n                    }\n                    if (!String.IsNullOrEmpty(a))\n                    {\n                        int len = a.Length;\n\n                        for (int j = 1; j &lt; len; j++)\n                        {\n                            if (Char.IsLetter(a[0]) &amp;&amp; Char.IsDigit(a[j]) &amp;&amp; !Char.IsSymbol(a[j]))\n                            {\n                                //action\n                            }\n                            else\n                            {\n                                flag = flag + 1;\n                                int errline = i1 + 2;\n                                Label12.Text = \"Error at line: \" + errline.ToString();\n                                //Label12.Visible = true;\n                            }\n\n\n                    }\n                }\n\n\n\n\n                 }\n</code></pre>\n\n<p>For some strange reason when i use breakpoint i can see the values of id as long as id is numeric in excel the moment flow comes to cell which has id as 25h547 the value if b turn \"\" any reason for this? i can give you entire code if you require. </p>\n"},{"tags":["c#","casting","floating-point","double","naudio"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":121,"score":0,"question_id":13259482,"title":"Loss of double precision C#","body":"<p>I am experiencing precision loss when im using doubles and i cant seem to find where the precision is lost.\nI am writing a software synthesizer and for some reason the input frequency for an oscillator(sound-wave generator) gets heavily aliased somewhere along the way.\nThe oscillator is supposed to generate a triangle waveform and the correct frequency is passed to the method but when the result is played in the speakers i can clearly hear that the sound snaps to different frequencies.</p>\n\n<p>I am using NAudio (http://naudio.codeplex.com/) and this method is run once for every sample i want to generate.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>double counter = 0;\nint samplecounter = 0;\n\npublic double GetNextTriangle(double frequency)\n{\n    double samplesperwave = (double)Parent.WaveFormat.SampleRate / frequency;\n    double length = (double)samplecounter / samplesperwave;\n    if (length.CompareTo(0.25) == -1)\n    {\n        counter = length * 4.0;\n    }\n    else if (length.CompareTo(0.75) == -1)\n    {\n        counter = 1.0 - (length - 0.25) * 4.0;\n    }\n    else\n    {\n        counter = -1.0 + (length - 0.75) * 4.0;\n    }\n    samplecounter++;\n    samplecounter = samplecounter &gt; samplesperwave ? 0 : samplecounter;\n    return counter;\n}\n</code></pre>\n\n<p>Thanks in advance! //Mats</p>\n"},{"tags":["c#","sap"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13250845,"title":"bapi_material_savedata","body":"<p>I'm connecting .NET application with SAP using SAP .NET Connector.its working fine with \"BAPI_MATERIAL_SAVEDATA\" BAPI .\ni need to update field \"J_1IMTCHID - J_1IGRXREF\" which is not available in this bapi .Is it possible to update this field using extension of this bapi?</p>\n\n<p>or kindly help me for any other standard bapi for  updating this field \"J_1IMTCHID - J_1IGRXREF\" in sap while creating material?</p>\n\n<p>thanks in advance\nVignesh</p>\n"},{"tags":["c#","tabcontrol"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":235,"score":0,"question_id":7386777,"title":"C#: Add TabControl tab by name","body":"<p>I have form with TabControl. I can add Tab by doing:</p>\n\n<p><code>TabControl.TabPages.Add(TabPage)</code></p>\n\n<p><code>TabPage</code> is name of one of tab pages I have.</p>\n\n<p>I would like to do</p>\n\n<p><code>TabControl.TabPages.Add(\"TabPage\")</code></p>\n\n<p>Where <code>TabPage</code> is String object.</p>\n\n<p>How can I achieve this?</p>\n"},{"tags":["c#","filesysteminfo"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":21,"score":2,"question_id":13262755,"title":"DirectoryInfo().GetFileSystemInfos() - how to avoid hidden folders?","body":"<p>If I do this:</p>\n\n<pre><code>var entries = new DirectoryInfo(@\"C:\\Folder1\")\n                   .GetFileSystemInfos(\"test*\", SearchOption.AllDirectories);\n</code></pre>\n\n<p>when I have a folder structure like this, where the \"HiddenFolder\" is hidden but the \"test.txt\" file is not hidden:</p>\n\n<pre><code>C:\\Folder1\\\nC:\\Folder1\\HiddenFolder\\\nC:\\Folder1\\HiddenFolder\\test.txt\n</code></pre>\n\n<p>Then how can I code to NOT get the \"test.txt\" file?</p>\n\n<p>(You might think that GetFileSystemInfos would skip hidden folders, but it doesn't.)</p>\n\n<h3>Here is a partial solution</h3>\n\n<p>This code strips out hidden files and folders, but doesn't handle a non-hidden file inside a hidden folder!</p>\n\n<pre><code>  var includeLocalFolderNames = true; // to include folder names in the list\n\n  var hiddenFolders = new List&lt;FileSystemInfo&gt;();\n  return entries\n    .Where(entry =&gt;\n      {\n        // skip if this entry is hidden, or it is in a hidden folder\n\n        var isHidden = (entry.Attributes &amp; FileAttributes.Hidden) != 0;\n        if (isHidden)\n        {\n          hiddenFolders.Add(entry);\n          return false;\n        }\n        return !hiddenFolders.Any(fsi =&gt; entry.FullName.StartsWith(fsi.FullName));\n      })\n    .Where(entry =&gt;\n      {\n        // include folder names if requested...\n\n        if (includeLocalFolderNames) return true;\n        return (entry.Attributes &amp; FileAttributes.Directory) == 0;\n      })\n    .Select(entry =&gt; {\n        // do something...\n        return entry.Name;\n      });\n</code></pre>\n"},{"tags":["c#",".net","smtp","smtpclient"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13260772,"title":"SmtpException: The client or server is only configured for e-mail addresses with ASCII local-parts","body":"<p>The <a href=\"http://msdn.microsoft.com/en-us/library/swas0fwc.aspx\" rel=\"nofollow\">SmtpClient.Send()</a> method is throwing this exception when I try to send an email to an address containing an accentuated character (é):</p>\n\n<blockquote>\n  <p>System.Net.Mail.SmtpException: The client or server is only configured\n  for e-mail addresses with ASCII local-parts: léo.xxx@xxx.com.<br>\n    at System.Net.Mail.MailAddress.GetAddress(Boolean allowUnicode)<br>\n    at System.Net.Mail.SmtpClient.ValidateUnicodeRequirement(MailMessage...)<br>\n    at System.Net.Mail.SmtpClient.Send(MailMessage message)  </p>\n</blockquote>\n\n<p>The formulation of the message makes me thing there might be a setting that I can activate to make this work, though I haven't found anything on this subject.</p>\n\n<p>I have tried several SMTP servers, including Gmail. Here are the relevant bits for a repro:</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>var msg = new MailMessage();\nmsg.Subject = \"Test\";\nmsg.From = new MailAddress(\"xxx@gmail.com\");\nmsg.To.Add(new MailAddress(\"léo.yyy@gmail.com\"));\n\nnew SmtpClient().Send(msg);\n</code></pre>\n\n<p><strong>app.config</strong></p>\n\n<pre><code>&lt;system.net&gt;\n    &lt;mailSettings&gt;\n        &lt;smtp from=\"xxx@gmail.com\"&gt;\n            &lt;network host=\"smtp.gmail.com\" port=\"587\" userName=\"xxx@gmail.com\" password=\"password\" enableSsl=\"true\" /&gt;\n        &lt;/smtp&gt;\n    &lt;/mailSettings&gt;\n&lt;/system.net&gt;\n</code></pre>\n\n<p>Would appreciate any pointers. Thanks.</p>\n"},{"tags":["c#","c","mono","monomac","cfstring"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":191,"score":2,"question_id":7027962,"title":"Mono C# PInvoke - Get CFString from external lib","body":"<p>I have a lib that returns a CFString, and I'm trying to get that string value in C#..\nThe problem is that I don't know how to do this in C#..</p>\n\n<p>Making the external function return a CFString won't work as it throws an exception \"Type MonoMac.CoreFoundation.CFString which is passed to unmanaged code must have a StructLayout attribute.\"</p>\n\n<p>Then I thought that I could get the string as a byte array and then convert it to a string in C#, but then, I have another problem, I don't know how to convert in C the CFString to a byte array :/</p>\n\n<pre><code>C# Dll Import stuff\n[DllImport(\"lib\")]\npublic static extern MonoMac.CoreFoundation.CFString  test();   \n\n[DllImport(\"lib\")]\npublic static extern byte[] test();     \n\n\nC Library sample\nCFStringRef test()\n{\nreturn CFSTR(\"test string\");\n}\n</code></pre>\n\n<p>If anyone knows a way to do this please help me out ;)</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","spellchecking","stylecop"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":114,"score":2,"question_id":12682642,"title":"Specify path to CustomDictionary file for StyleCop spellchecking","body":"<p>Spell checking of the comments was added to the recent versions of StyleCop. It seems I can reuse my existing CustomDictionary file (that I created for FxCop) with StyleCop. SA1650 rule <a href=\"http://www.stylecop.com/docs/SA1650.html\" rel=\"nofollow\">documentation</a> does not say that it is possible. But in <a href=\"http://stylecop.codeplex.com/downloads/get/386813\" rel=\"nofollow\">release notes</a> for version 4.7.39 I see </p>\n\n<blockquote>\n  <p>Add support for specifying dictionary folders in the settings.StyleCop\n  file.</p>\n</blockquote>\n\n<p>How do I configure StyleCop to search for this file in the root folder of my solution?</p>\n"},{"tags":["c#","winforms","rdlc"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":299,"score":0,"question_id":7412249,"title":"Khmer unicode doesn't display correctly in Microsoft Client Side Report(rdlc)","body":"<p>I building a winform application that records information using khmer unicode font. For my application i use c# with sqlserver and microsoft client report (rdlc) to generate reports. \nNow i have a problem with the rdlc report that does not display khmer unicode font correctly.\nIt displays like the image in the links below:</p>\n\n<p><a href=\"http://i1138.photobucket.com/albums/n522/sandeep251183/CRViewer.png\" rel=\"nofollow\">http://i1138.photobucket.com/albums/n522/sandeep251183/CRViewer.png</a></p>\n\n<p>It should look like this</p>\n\n<p><a href=\"http://i1138.photobucket.com/albums/n522/sandeep251183/CRExportHTML-1.png\" rel=\"nofollow\">http://i1138.photobucket.com/albums/n522/sandeep251183/CRExportHTML-1.png</a></p>\n\n<p>Can anyone find a solution for me?</p>\n"},{"tags":["c#","path","mono","monodevelop","monomac"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":423,"score":3,"question_id":6395688,"title":"Finding the path of an image file inside a monomac project","body":"<p>I am new to mono and monomac and i got stuck with something that i hope should be really easy to fix. </p>\n\n<p>In my application i want to change some images at runtime, so i created an \"Images\" folder with my pics inside the root of the project.\nBut when i try to change the image in my code the image can't be found, so i think i'm writing the wrong path.</p>\n\n<p>I try to get the image like this:</p>\n\n<pre><code>NSImage image = new NSImage(\"Images/image2.jpg\"); // I tried with different paths but nothing changed...\npic1.Image = image;\n</code></pre>\n\n<p>If i use the full path to the image, everything work fine, but i need to use a relative one.\nHow should i get the right relative path?</p>\n\n<p>I'm using Monodevelop.</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","bing-maps-api"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3,"score":0,"question_id":13262745,"title":"Bing Map Service Auto Suggestion If Location Is Not Found","body":"<p>Does Bing have such a feature that if the query I sent doesn't have a match, it would return suggestions that might possibly match the location? </p>\n\n<p>Same with the <strong>Find Near</strong> in the <a href=\"http://www.bing.com/maps/\" rel=\"nofollow\">http://www.bing.com/maps/</a></p>\n\n<p>Thanks</p>\n"},{"tags":["c#","wpf","export-to-excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13232408,"title":"How to export from sql to a formatted excel","body":"<p>I have a C# WPF application which interacts with SQL Server Database. In application I want user be able to export some kind of data from SQL to Excel. I'm trying firstly to fill a Datatable and then export it to excel file. Everything was fine, untill I faced up with a task to export a datatable filled with this sql query:<img src=\"http://i.stack.imgur.com/1zyeO.jpg\" alt=\"enter image description here\"></p>\n\n<p>to a formatted excel file like this:\n<img src=\"http://i.stack.imgur.com/CxKka.jpg\" alt=\"report\"></p>\n\n<p>So how can I sort selldetails of every sell in one region in excel file?\nIt's been a long time I'm puzzling my mind over this problem, please, help me!</p>\n"},{"tags":["c#","exit","monomac"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":181,"score":4,"question_id":7843097,"title":"Application shutdown in MonoMac","body":"<p>I'm trying to shutdown a MonoMac application by using <code>Environment.Exit(0)</code>. However, this call for some reason does not return. It does not throw an exception, either. When I execute the function in the immediate window in MonoDevelop, it times out.</p>\n\n<p>I have no idea how to approach debugging this. I thought that Environment.Exit kills the process...</p>\n"},{"tags":["c#","multicast"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13262639,"title":"C# udp multicast not reaching","body":"<p>I'm trying to make a simple discovery program. I am using UDP and multicast in order to make it but the problem is that it works on the loopback but it doesn't work on lan with my other computers.</p>\n\n<p>I would to know if I'm missing something in my code or maybe if my router could not have that functionality enabled... </p>\n\n<p>I am using the ipadress 230.0.0.1 which is meant to be used for multicast with the port 5567. Whenever I send something, the message box only appears on the sending computer, and not on the other comps.</p>\n\n<pre><code>using System;\nusing System.Net;\nusing System.Net.Sockets;    \nusing System.Text;\nusing System.Threading;\nusing System.Windows.Forms;\n\nnamespace Cobalt\n{\npublic class Discovery\n{\n\n    private IPAddress group;\n    private int port;\n    private Socket server;\n    private byte[] buffer;\n\n    public Discovery(IPAddress group, int port)\n    {\n        this.group = group;\n        this.port = port;\n\n        server = new Socket(AddressFamily.InterNetwork, SocketType.Dgram, ProtocolType.Udp);\n        //server.SetSocketOption(SocketOptionLevel.Udp,SocketOptionName.NoDelay,1);\n        //server.SetSocketOption(SocketOptionLevel.Socket,SocketOptionName.ReuseAddress,1); \n\n        server.Bind(new IPEndPoint(IPAddress.Any, port));\n\n        server.SetSocketOption(SocketOptionLevel.IP,SocketOptionName.MulticastTimeToLive, 1); \n        server.SetSocketOption(SocketOptionLevel.IP, SocketOptionName.AddMembership, new MulticastOption(group));\n        buffer = new byte[1024];\n    }\n\n    public void Start()\n    {\n        var endPoint = (EndPoint) new IPEndPoint(IPAddress.Any, port);\n\n        server.BeginReceiveFrom(buffer, 0, buffer.Length, SocketFlags.None, ref endPoint, ReceiveData, null);\n    }\n\n    public void Send(String message)\n    {\n        var bytes = Encoding.UTF8.GetBytes(message);\n\n        var endPoint = (EndPoint) new IPEndPoint(group, port);\n\n        server.BeginSendTo(bytes, 0, bytes.Length, SocketFlags.None, endPoint, SendData, null);\n    }\n\n    // Callback!\n    private void SendData(IAsyncResult iar)\n    {\n        server.EndSendTo(iar);\n    }\n\n\n    // Callback!\n    private void ReceiveData(IAsyncResult iar)\n    {\n        var endPoint = (EndPoint)new IPEndPoint(IPAddress.Any, port);\n\n        int size = server.EndReceiveFrom(iar, ref endPoint);\n\n        if (size != 0)\n        {\n            MessageBox.Show(Encoding.UTF8.GetString(buffer).Trim());\n        }\n\n\n        server.BeginReceiveFrom(buffer, 0, buffer.Length, SocketFlags.None, ref endPoint, ReceiveData, 0);\n    }\n\n\n}\n}\n</code></pre>\n"},{"tags":["c#","asp.net-mvc","spark"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13262585,"title":"How to override view folder for one controller with Spark","body":"<p>I have two controllers which I want to use the same view folder.</p>\n\n<p>My two controllers are DocumentTypeAController and DocumentTypeBController which both inherit from a general document controller.</p>\n\n<p>My views are currently inside the ~\\views\\DocumentTypeA and I want the DocumentTypeB to reference the same views.</p>\n\n<p>How can I do this with the Spark view engine? (I'm using it with MVC2 [might be an oldish version])</p>\n"},{"tags":["c#","xaml","windows-8","winrt","winrt-xaml"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13246151,"title":"Access Page resource element","body":"<p>How can I access page resource element in C# coding? I have the following piece of code in my XAML. I want to access the <code>image</code> element in my C# Code, but it is not accessible.</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;Page.Resources&gt;\n &lt;DataTemplate x:Key=\"Standard250x250ItemTemplate\"&gt;\n     &lt;Grid HorizontalAlignment=\"Left\" Width=\"150\" Height=\"150\"&gt;\n         &lt;Border Background=\"{StaticResource ListViewItemPlaceholderBackgroundThemeBrush}\"&gt;\n             &lt;Image x:Name=\"image\" Source=\"{Binding Image}\"  Stretch=\"UniformToFill\" AutomationProperties.Name=\"{Binding Title}\" /&gt;\n         &lt;/Border&gt;    \n     &lt;/Grid&gt;\n &lt;/DataTemplate&gt;\n</code></pre>\n"},{"tags":["c#","mvvm","service","prism"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13254606,"title":"Force a service to close on Windows closing - Prism","body":"<p>I'm using a Prism and the MVVM pattern</p>\n\n<p>I've got a service running in a repository that is registered in my container like this:</p>\n\n<pre><code>_container.RegisterType&lt;ITheService, TheService&gt;();\n_container.RegisterType&lt;IRepository&lt;Order&gt;, Repository&gt;(new ContainerControlledLifetimeManager());\n</code></pre>\n\n<p>The constructor of the repository will subscribe to the service, that will then received new element (like 5 to 10 every second). \nThe problem is that because of this subscription, when i close the window of my GUI, the module holding the service is not closed, and the service keeps on running, instead of being shut down by the dispose. </p>\n\n<p>If i wasn't in MVVM i would just unsubsribe the service when i close the the window, but the shell window can't do that. </p>\n\n<p>I see 2 solutions\n* have an eventaggregator that will let my repository know when the shell close, and then unsubscribe the service (not sure it would work though)\n* resolve the repository from the shell (as it's registered as a singleton), and unsubscribe when the service, but that would be very ugly....</p>\n"},{"tags":["c#",".net","multithreading","architecture","software-engineering"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13261769,"title":"Best architecture to set a realtime logging window to write from different threads like output window in visualstudio","body":"<p>I am designing an application and it runs different components each on a different thread. I need a way to report back to the user interface the state of those components and the tasks they complete and if any errors occurred. My first approach was to write from all the different components to a log file. And then I monitored that file for changes, to reload the changes in a text box (my output window). However I noticed that using file monitor does not perform very well, and it slows downs the component threads and their tasks. So I was thinking to create something like the output windows in vs2010, where they can log any data while debugging, it seems to be very efficient, and can hold a lot of data. Any ideas what would be the best approach? One important fact, is that there should be a way to communicate all the component threads with the logging output window, to display results, avoid collisions, etc. I am using .NET 4.0</p>\n"},{"tags":["c#","windows","forms","upload","ftp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":44,"score":-1,"question_id":13262253,"title":"How to upload a folder through FTP?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2252000/upload-a-folder-by-ftp\">Upload a folder by FTP</a>  </p>\n</blockquote>\n\n\n\n<p>I am trying to upload a folder (and its content) through FTP but when I try to do it, I keep getting an error saying no file is selected.</p>\n\n<p><strong>Do you know any way to make it so it'll upload the folder and its content?</strong></p>\n\n<p>Here's the code I am using. (I want to upload all the files in the folder Plugins):</p>\n\n<pre><code>UploadFile(@\"C:\\\\MainPlugins\\\\Plugins\", \"ftp://testsiteurl.com/public_html/wp-content/plugins/test plugin\", \"username\", \"password\");\n</code></pre>\n\n<p>This is the sub I am using:</p>\n\n<pre><code>public void UploadFile(string _FileName, string _UploadPath, string _FTPUser, string _FTPPass)\n{\n    System.IO.FileInfo _FileInfo = new System.IO.FileInfo(_FileName);\n\n    // Create FtpWebRequest object from the Uri provided\n    System.Net.FtpWebRequest _FtpWebRequest = (System.Net.FtpWebRequest)System.Net.FtpWebRequest.Create(new Uri(_UploadPath));\n\n    // Provide the WebPermission Credintials\n    _FtpWebRequest.Credentials = new System.Net.NetworkCredential(_FTPUser, _FTPPass);\n\n    // By default KeepAlive is true, where the control connection is not closed\n    // after a command is executed.\n    _FtpWebRequest.KeepAlive = false;\n\n    // set timeout for 20 seconds\n    _FtpWebRequest.Timeout = 20000;\n\n    // Specify the command to be executed.\n    _FtpWebRequest.Method = System.Net.WebRequestMethods.Ftp.UploadFile;\n\n    // Specify the data transfer type.\n    _FtpWebRequest.UseBinary = true;\n\n    // Notify the server about the size of the uploaded file\n    _FtpWebRequest.ContentLength = _FileInfo.Length;\n\n    // The buffer size is set to 2kb\n    int buffLength = 2048;\n    byte[] buff = new byte[buffLength];\n\n    // Opens a file stream (System.IO.FileStream) to read the file to be uploaded\n    System.IO.FileStream _FileStream = _FileInfo.OpenRead();\n\n    try\n    {\n        // Stream to which the file to be upload is written\n        System.IO.Stream _Stream = _FtpWebRequest.GetRequestStream();\n\n        // Read from the file stream 2kb at a time\n        int contentLen = _FileStream.Read(buff, 0, buffLength);\n\n        // Till Stream content ends\n        while (contentLen != 0)\n        {\n            // Write Content from the file stream to the FTP Upload Stream\n            _Stream.Write(buff, 0, contentLen);\n            contentLen = _FileStream.Read(buff, 0, buffLength);\n        }\n\n        // Close the file stream and the Request Stream\n        _Stream.Close();\n        _Stream.Dispose();\n        _FileStream.Close();\n        _FileStream.Dispose();\n    }\n    catch (Exception ex)\n    {\n        MessageBox.Show(ex.Message, \"Upload Error\", MessageBoxButtons.OK, MessageBoxIcon.Error);\n    }\n}\n</code></pre>\n"},{"tags":["c#","wpf","data-binding","binding","datagrid"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13251456,"title":"Binding datagrid","body":"<p>I've been trying to bind DataGridTextColumns column-wise to arrays (int[] I think) and have been unsuccessful. Nothing I've found on msdn, stackoverflow etc has been particularly helpful .</p>\n\n<pre><code>&lt;DataGrid AutoGenerateColumns=\"False\" VerticalAlignment=\"Top\" Margin=\"0,47,0,0\" Height=\"351\" Name=\"dataGrid1\" IsReadOnly=\"True\" CanUserAddRows=\"False\" CanUserDeleteRows=\"False\"&gt;\n            &lt;DataGrid.Columns&gt;\n                &lt;DataGridTextColumn Header=\"Slave Address\" Width=\"100\" Binding=\"{Binding SlaveAddressValues}\"/&gt;\n                &lt;DataGridTextColumn Header=\"Meter Readings\" Width=\"100\" Binding=\"{Binding MeterReadingValues}\"/&gt;\n            &lt;/DataGrid.Columns&gt;\n        &lt;/DataGrid&gt;\n</code></pre>\n\n<p>I've tried a number of things including putting binding in with datagrid instead or as well as datagridtextcolumns (itemsource etc), defining datacontext in code (I'd like to keep as much as possible out of code for mvvm reasons), using paths and sources, and also trying to combine my two arrays in a class (which isn't really what I want anyway). However nothing has worked in getting even the following simple test case to properly bind with the datagrid.</p>\n\n<pre><code>private int[] SlaveAddressValues = { 0, 0, 0, 0 };\nprivate int[] MeterAddressValues = { 2, 2, 2, 3 };\n</code></pre>\n\n<p>Anyone got any ideas?</p>\n\n<p>Right, maybe I should have put my solution here but it was a bit long so I put it as an answer. it's one of many ways anyway so post another answer if you feel so inclined.</p>\n"},{"tags":["c#",".net","reference-type","idictionary"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":99,"score":4,"question_id":13262106,"title":"Dictionary.ContainsKey() - How does it work?","body":"<p>I've read the MSDN documentation on how <code>Dictionary.ContainsKey()</code> works, but I was wondering how it actually makes the equality comparison? Basically, I have a dictionary keyed to a reference type* and I want the <code>ContainsKey()</code> method to check a certain property of that reference type as its basis for determining if the key exists or not. For example, if I had a <code>Dictionary(MyObject, int)</code> and <code>MyObject</code> has a public property (of <code>int</code>) called \"TypeID\", could I get <code>ContainsKey(MyObject myObject)</code> to check to see if one of the keys has a <code>TypeID</code> that is equal to <code>myObject</code>? Could I just overload the <code>==</code> operator?</p>\n\n<ul>\n<li>The reference type is an object called \"Duration\" which holds a value (<code>double Length</code>); \"Duration\" is a base type used in my music program to denote how long a particular sound lasts. I derive classes from it which incorporate more sophisticated timing concepts, like Western musical time signatures, but want all of them to be comparable in terms of their length.</li>\n</ul>\n\n<p>EDIT: As suggested, I implemented IEquitable on my object like so:</p>\n\n<pre><code> public class Duration : IEquatable&lt;Duration&gt;\n {\n    protected double _length;\n\n    /// &lt;summary&gt;\n    /// Gets or Sets the duration in Miliseconds.\n    /// &lt;/summary&gt;\n    public virtual double Length\n{\n        get\n        {\n            return _length;\n        }\n        set\n        {\n            _length = value;\n        }\n    }\n\n// removed all the other code that as it was irrelevant\n\n    public override bool Equals(object obj)\n    {\n        Duration otherDuration = (Duration)obj;\n        if (otherDuration._length == _length)\n        {\n            return true;\n        }\n        else\n        {\n            return false\n        }\n    }\n\n}\n</code></pre>\n\n<p>Is this all I need to do?</p>\n"},{"tags":["c#","xml-parsing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":47,"score":-3,"question_id":13262424,"title":"What are the popular ways of parsing XML?","body":"<p>I've seen a number of threads that are about 3 years old now about parsing XML in C#.</p>\n\n<p>Have any new methods arisen, aside from XML Document? I saw a reference in a thread about LINQ to XML, but the examples for converting the XML document into an object was a bit thin. </p>\n"},{"tags":["c#","asp.net","c#-3.0","metadata","connection-string"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1420,"score":1,"question_id":8291733,"title":"ASP.NET login control connection string error : Keyword not supported: 'metadata'","body":"<p>I was working with normal connection until now and everything was smooth\nbut now I have switched to data entity model and with new connection string, I am having this error... How can i keep my entity string for my data manipulation and use the regular conn string only for login control?</p>\n\n<pre><code>Keyword not supported: 'metadata'.\nDescription: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.\n\nException Details: System.ArgumentException: Keyword not supported: 'metadata'.\n\nSource Error:\n\nAn unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.\n\nStack Trace:\n\n[ArgumentException: Keyword not supported: 'metadata'.]\n   System.Data.Common.DbConnectionOptions.ParseInternal(Hashtable parsetable, String connectionString, Boolean buildChain, Hashtable synonyms, Boolean firstKey) +5055124\n   System.Data.Common.DbConnectionOptions..ctor(String connectionString, Hashtable synonyms, Boolean useOdbcRules) +98\n   System.Data.SqlClient.SqlConnectionString..ctor(String connectionString) +64\n   System.Data.SqlClient.SqlConnectionFactory.CreateConnectionOptions(String connectionString, DbConnectionOptions previous) +24\n   System.Data.ProviderBase.DbConnectionFactory.GetConnectionPoolGroup(String connectionString, DbConnectionPoolGroupOptions poolOptions, DbConnectionOptions&amp; userConnectionOptions) +150\n   System.Data.SqlClient.SqlConnection.ConnectionString_Set(String value) +59\n   System.Data.SqlClient.SqlConnection.set_ConnectionString(String value) +4\n   System.Data.SqlClient.SqlConnection..ctor(String connectionString) +26\n   System.Web.DataAccess.SqlConnectionHolder..ctor(String connectionString) +54\n\n[ArgumentException: An error occurred while attempting to initialize a System.Data.SqlClient.SqlConnection object. The value that was provided for the connection string may be wrong, or it may contain an invalid syntax.\nParameter name: connectionString]\n   System.Web.DataAccess.SqlConnectionHolder..ctor(String connectionString) +136\n   System.Web.DataAccess.SqlConnectionHelper.GetConnection(String connectionString, Boolean revertImpersonation) +119\n   System.Web.Security.SqlMembershipProvider.GetPasswordWithFormat(String username, Boolean updateLastLoginActivityDate, Int32&amp; status, String&amp; password, Int32&amp; passwordFormat, String&amp; passwordSalt, Int32&amp; failedPasswordAttemptCount, Int32&amp; failedPasswordAnswerAttemptCount, Boolean&amp; isApproved, DateTime&amp; lastLoginDate, DateTime&amp; lastActivityDate) +827\n   System.Web.Security.SqlMembershipProvider.CheckPassword(String username, String password, Boolean updateLastLoginActivityDate, Boolean failIfNotApproved, String&amp; salt, Int32&amp; passwordFormat) +105\n   System.Web.Security.SqlMembershipProvider.ValidateUser(String username, String password) +106\n   System.Web.UI.WebControls.Login.AuthenticateUsingMembershipProvider(AuthenticateEventArgs e) +60\n   System.Web.UI.WebControls.Login.OnAuthenticate(AuthenticateEventArgs e) +129\n   System.Web.UI.WebControls.Login.AttemptLogin() +127\n   System.Web.UI.WebControls.Login.OnBubbleEvent(Object source, EventArgs e) +101\n   System.Web.UI.Control.RaiseBubbleEvent(Object source, EventArgs args) +37\n   System.Web.UI.WebControls.Button.OnCommand(CommandEventArgs e) +125\n   System.Web.UI.WebControls.Button.RaisePostBackEvent(String eventArgument) +167\n   System.Web.UI.WebControls.Button.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument) +10\n   System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument) +13\n   System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData) +36\n   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +5563\n</code></pre>\n\n<p>Connection string</p>\n\n<pre><code>&lt;connectionStrings&gt;\n    &lt;add name=\"LoginDB\" connectionString=\"Data Source=****;Initial Catalog=int422_113b16;User ID=****;Password=****\" /&gt;\n    &lt;add name=\"BlogEntities\" connectionString=\"metadata=res://*/App_Code.BlogModel.csdl|res://*/App_Code.BlogModel.ssdl|res://*/App_Code.BlogModel.msl;provider=System.Data.SqlClient;provider connection string=&amp;quot;data source****;initial catalog=int422_113b16;user id=****;password=****;multipleactiveresultsets=True;App=EntityFramework&amp;quot;\" providerName=\"System.Data.EntityClient\" /&gt;\n&lt;/connectionStrings&gt;\n</code></pre>\n"},{"tags":["c#",".net","winforms","visual-studio-2010"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":3,"view_count":1100,"score":-1,"question_id":9096078,"title":"How to download a file to a specific path in from a given url in a windows form?","body":"<p>I need to download pdf files from a specified links(url) to a specific folder in a windows application using winforms please any one can suggest me with a solution.</p>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13262226,"title":"Mouse activity slowing down WPF graphics demo","body":"<p>Below is a small graphics demo in WPF. It looks something like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/Cq3h2.png\" alt=\"enter image description here\"></p>\n\n<p>When it's running, if I move the mouse around the main area of the window, the animation slows down (at least on my system). If I move the mouse pointer out of the window entirely, the animation come back up to speed.</p>\n\n<p>Any suggestions for how to prevent the mouse movement interfering with the animation speed?</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Windows;\nusing System.Windows.Controls;\nusing System.Windows.Data;\nusing System.Windows.Documents;\nusing System.Windows.Input;\nusing System.Windows.Media;\nusing System.Windows.Media.Imaging;\nusing System.Windows.Navigation;\nusing System.Windows.Shapes;\nusing System.Threading;\nusing System.Windows.Threading;\n\nnamespace WPF_Golden_Section\n{\n    class DrawingVisualElement : FrameworkElement\n    {\n        public DrawingVisual visual;\n\n        public DrawingVisualElement() { visual = new DrawingVisual(); }\n\n        protected override int VisualChildrenCount { get { return 1; } }\n\n        protected override Visual GetVisualChild(int index) { return visual; }\n    }\n\n    public static class CanvasUtils\n    {\n        public static Canvas SetCoordinateSystem(this Canvas canvas, Double xMin, Double xMax, Double yMin, Double yMax)\n        {\n            var width = xMax - xMin;\n            var height = yMax - yMin;\n\n            var translateX = -xMin;\n            var translateY = height + yMin;\n\n            var group = new TransformGroup();\n\n            group.Children.Add(new TranslateTransform(translateX, -translateY));\n            group.Children.Add(new ScaleTransform(canvas.ActualWidth / width, canvas.ActualHeight / -height));\n\n            canvas.RenderTransform = group;\n\n            return canvas;\n        }\n    }\n\n    public static class ColorUtils\n    {\n        public static Color Write(this Color color)\n        {\n            Console.Write(\"Color[{0} {1} {2} {3}]\", color.A, color.R, color.G, color.B);\n\n            return color;\n        }\n\n        static byte ColorComponentToByte(double n)\n        {\n            return \n                (byte)\n                    Math.Round(Math.Min(Math.Max(n, 0), 1) * 255);\n        }\n\n        public static Color Rgb(double r, double g, double b)\n        {\n            return\n                Color.FromRgb(\n                    ColorComponentToByte(r),\n                    ColorComponentToByte(g),\n                    ColorComponentToByte(b));\n        }\n\n        public static Color SetArgb(this Color color, double a, double r, double g, double b)\n        {\n            color.A = ColorComponentToByte(a);\n            color.R = ColorComponentToByte(r);\n            color.G = ColorComponentToByte(g);\n            color.B = ColorComponentToByte(b);\n\n            return color;\n        }\n    }\n\n    public partial class MainWindow : Window\n    {\n        public MainWindow()\n        {\n            InitializeComponent();\n\n            Width = 600;\n            Height = 600;\n\n            var dockPanel = new DockPanel();\n\n            Content = dockPanel;\n\n            var slider =\n                new Slider()\n                {\n                    Minimum = 0.1,\n                    Maximum = 10,\n                    LargeChange = 0.001,\n                    Value = 1\n                };\n\n            dockPanel.Children.Add(slider);\n\n            DockPanel.SetDock(slider, Dock.Top);\n\n            var incrementSlider =\n                new Slider()\n                {\n                    Maximum = 0.001,\n                    Minimum = 0.00001,\n                    Value = 0.0001\n                };\n\n            dockPanel.Children.Add(incrementSlider);\n\n\n            DockPanel.SetDock(incrementSlider, Dock.Top);\n\n            var pauseButton = new Button() { Content = \"Pause\" };\n\n            dockPanel.Children.Add(pauseButton);\n\n            DockPanel.SetDock(pauseButton, Dock.Top);\n\n            var canvas = new Canvas();\n\n            dockPanel.Children.Add(canvas);\n\n            DockPanel.SetDock(canvas, Dock.Top);\n\n            SizeChanged += (s, e) =&gt; canvas.SetCoordinateSystem(-400, 400, -400, 400);\n\n            var element = new DrawingVisualElement();\n\n            Action draw = () =&gt;\n                {\n                    canvas.Children.Clear();\n\n                    // var element = new DrawingVisualElement();\n\n                    using (var dc = element.visual.RenderOpen())\n                    {\n                        for (var i = 0.0; i &lt; 720.0; i += slider.Value)\n                        {\n                            var radius = Math.Sin(i / 720.0 * Math.PI) * 30;\n\n                            var phi = (1 + Math.Sqrt(5)) / 2;\n\n                            var omega = 2 * Math.PI * (phi - 1) * i;\n\n                            var x = Math.Cos(omega) * 0.5 * i;\n                            var y = Math.Sin(omega) * 0.5 * i;\n\n                            dc.DrawEllipse(\n                                new SolidColorBrush(ColorUtils.Rgb(i / 360.0, i / 360.0, 0.25)),\n                                new Pen(Brushes.Black, Math.Max(radius / 6, 1)),\n                                new Point(x, y),\n                                radius / 2,\n                                radius / 2);\n                        }\n                    }\n\n                    canvas.Children.Add(element);\n                };\n\n            slider.ValueChanged += (s, e) =&gt;\n            {\n                Title = slider.Value.ToString() + \"     \" + incrementSlider.Value;\n                draw();\n            };\n\n            var timer = new DispatcherTimer();\n\n            timer.Tick += (s, e) =&gt;\n                {\n                    if (slider.Value &lt; 10.0)\n                        slider.Value += incrementSlider.Value;\n                };\n\n            timer.Start();\n\n            pauseButton.Click += (s, e) =&gt;\n                {\n                    if (timer.IsEnabled)\n                        timer.Stop();\n                    else\n                        timer.Start();\n                };\n\n            slider.Value = 3.5;\n            incrementSlider.Value = 0.00001;\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","casting","boxing"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13262024,"title":"Trying to understand Type Casting & Boxing/Unboxing","body":"<p>I'm currently trying to get my head around casting and boxing. As i understand it currently:</p>\n\n<ul>\n<li>Boxing - Value Type to Reference Type (ie int to object)</li>\n<li>Unboxing - Reference Type to Value Type (ie object to int)</li>\n<li>Type Casting - Seems to me at the moment to be similar to boxing but\nallows you to assign what type of object you would like the Reference\nType to be of. (ie int to customObjectType)</li>\n</ul>\n\n<p>The example im working with at the moment to try and get my around it.\nSay I have 2 classes, a method in one class calls the constructor of the other.</p>\n\n<pre><code>//1st class\npublic class FirstClass\n{\n  //code for fields,constructor &amp; other methods\n\n  public void CallOtherClass(int firstClassID)\n  {\n   int x = firstClassID;\n   SecondClass test = new SecondClass(x);\n  }\n\n}\n\n//2nd class\npublic class SecondClass\n{\n   public SecondClass(FirstClass firstClass)\n   {\n    //set some fields\n   }\n} \n</code></pre>\n\n<p>Ok, so in the above scenario we would have a problem as the method CallOtherClass attempts to set the constructor of SecondClass, however the constructor of SecondClass takes a parameter of type FirstClass and all we can provide is an int.</p>\n\n<p>So as i understand it this would be a good time to use type casting? Something like below.</p>\n\n<pre><code>//1st class\npublic class FirstClass\n{\n  //code for fields,constructor &amp; other methods\n\n  public void CallOtherClass(int firstClassID)\n  {\n   int x = firstClassID;\n\n   FirstClass a;\n   a = (FirstClass)x;\n\n   SecondClass test = new SecondClass(a);\n  }\n\n}\n\n//2nd class\npublic class SecondClass\n{\n   public SecondClass(FirstClass firstClass)\n   {\n    //set some fields\n   }\n}\n</code></pre>\n\n<p>In my head this seems to me to change the type of x to a reference type of FirstClass. Obviously my understanding is way off some where along the lines as it produces an error</p>\n\n<pre><code>\"Cannot convert type 'int' to 'Namespace.FirstClass\"\n</code></pre>\n\n<p>Any thoughts?</p>\n"},{"tags":["c#","drawing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13262078,"title":"Draw a overlaying rectangle (example)","body":"<p>How would I go about drawing a rectangle like this image?\n(Notice rectangle slight grey in the middle)\n<a href=\"http://puu.sh/1niK2\" rel=\"nofollow\">Screenshot</a></p>\n\n<p>I've got drawing Rectangles on Forms/PictureBox's ect but for the of me can't figure out how to do it over all your open applications.</p>\n\n<p>Any feedback will be much appreciated</p>\n"},{"tags":["c#","sql-server","vs2010-express"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":121,"score":0,"question_id":13213644,"title":"Windows Form Application and SQL Server","body":"<p><strong>UPDATE 2</strong></p>\n\n<p>I fixed the error by adding <code>System.Configuration</code> to the reference file.   I had already added it to my class with <code>using System.Configuration;</code><br>\nI found the answer here: <a href=\"http://stackoverflow.com/questions/1274852/the-name-configurationmanager-does-not-exist-in-the-current-context/1836938#comment18074599_1836938\">The name 'ConfigurationManager' does not exist in the current context</a></p>\n\n<p>Any further issues will be addressed in a new question.</p>\n\n<p><strong>Original(ish) Post</strong></p>\n\n<p>I have Microsoft SQL Server Management Studio. In the studio I created a database called <code>Logbook</code> that exists locally on my computer.   </p>\n\n<p>I have also created a user interface using a Windows forms application in VS C# Express. I would like to connect it to my logbook database in order to update, select, delete, and insert entries into the database through the UI.</p>\n\n<p>However, I cannot figure out how connect the two. I have played around with the \"Add new data source\" wizard to no avail. I also cannot find anything helpful in the MSDN or other tutorials online.   </p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I created a new database and project to work with until I figure out how to properly do this so I don't accidently break anything in my project.<br>\nThe Schema is:</p>\n\n<pre><code>Student(sid: int, fname: char(10), lname: char(10), age:int, major:char(10))\nCourse(cid:int, desc:char(50), dept:char(10))\nEnrolled(sid:int, cid:int, quarter:char(10), grade:char(10))\n</code></pre>\n\n<p>Here is the connection string generated by the \"Add Data Source\" wizard</p>\n\n<pre><code>&lt;add name=\"boathouseLogConnectionString\"\n        connectionString=\"Data Source=.\\SQLEXPRESS;AttachDbFilename=&amp;quot;C:\\Program Files\\Microsoft SQL Server\\MSSQL11.SQLEXPRESS\\MSSQL\\DATA\\boathouseLog.mdf&amp;quot;;Integrated Security=True;Connect Timeout=30;User Instance=True\"\n        providerName=\"System.Data.SqlClient\" /&gt;\n</code></pre>\n\n<p>I have successfully gotten my database into the project.  However, when I try running a stored procedure I get this error <code>Argument Exception was unhandled.  Format of the initialization string does not conform to specification starting at index 0.</code></p>\n\n<p>The error occurs on line 2.  </p>\n\n<pre><code>        DataTable dt = new DataTable();\n        SqlConnection sqlConn = new SqlConnection(selectedConnectionString);\n        SqlCommand myCommand = new SqlCommand(\"proc_getMember\", sqlConn);\n        myCommand.CommandType = CommandType.StoredProcedure;\n        SqlDataAdapter da = new SqlDataAdapter(myCommand); \n</code></pre>\n\n<p>the <code>selectedConnectionString</code> variable is set to <code>boathouseLogConnectionString</code></p>\n"},{"tags":["c#","oop","design","srp"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":63,"score":3,"question_id":13246977,"title":"Understand Single Responsibility Principle of SOLID design","body":"<p>I'm currently trying to learn the SOLID design principles along with behavior driven development, but am having quite the hard time getting my head around the Single Responsibility Principle.  I've tried to find a good tutorial for c# that uses test driven development, but haven't been able to find anything worthwhile in that vein.  Anyway, after spending a few days reading about it, I decided the best way to learn is by experience, so I started creating a small app using those principles best I can.  </p>\n\n<p>It's a simple bowling score calculator.  I figured the best way to go about it was to work from the simplest part up, so I started at the ball (or throw) level.  Right now I have created tests and an interface and class for dealing with ball(throw) scores, which makes sure they aren't invalid, ie. <code>&lt;10</code> or <code>&gt;0</code>.  After implementing this I realized that the ball class is basically just a nullable integer, so maybe I don't even need it... but for now it's there.</p>\n\n<p>Following the ball, I decided the next logical thing to add was a frame interface and class.  This is where I have gotten stuck.  Here is where I'm at:</p>\n\n<pre><code>namespace BowlingCalc.Frames\n{\n    public interface IFrame : BowlingCalc.Generic.ICheckValid\n    {\n        void AddThrow(int? score);\n        int? GetThrow(int throw_number);\n    }\n}\n\nnamespace BowlingCalc.Frames\n{\n    public class Frame : IFrame\n    {\n        private List&lt;Balls.IBall&gt; balls;\n        private Balls.IBall ball;\n        private int frame_number;\n\n        public Frame(Balls.IBall ball, int frame_number)\n        {\n            this.ball = ball;\n            this.frame_number = frame_number;\n            balls = new List&lt;Balls.IBall&gt;();\n            check_valid();\n        }\n\n        public void AddThrow(int? score)\n        {\n            var current_ball = ball;\n            current_ball.Score = score;\n            balls.Add(current_ball);\n        }\n\n        public int? GetThrow(int throw_number)\n        {\n            return balls[throw_number].Score;\n        }\n\n        public void check_valid()\n        {\n            if (frame_number &lt; 0 || frame_number &gt; 10)\n            {\n                throw (new Exception(\"InvalidFrameNumberException\"));\n            }\n        }\n\n    }\n}\n</code></pre>\n\n<p>The frame uses my previously implemented ball class through dependency injection to add ball scores to the frame.  It also implements a way to return the score for any given ball in the frame.</p>\n\n<p>What I want to do, and where I'm stuck, is I want to add a way to make sure the frame score is valid. (For the moment just the simple case of frames 1-9, where the combined score of both balls must be 10 or less.  I will move on to the  much more complicated frame 10 case later.)</p>\n\n<p>The problem is I have no idea how to implement this in a SOLID way.  I was thinking of adding the logic into the class, but that seems to go against the single responsibility principle.  Then I thought to add it as a separate interface/class and then call that class on each frame when its score updates.  I also thought of creating a separate interface, <code>IValidator</code> or something like that, and implementing that in the Frame class.  Unfortunately, I have no idea which, if any, of these is the best/SOLID way of doing things.</p>\n\n<p>So, what would be a good, SOLID way to implement a method that validates the score of a frame?</p>\n\n<hr>\n\n<p>Note: Any critique of my code is very welcome.  I am very excited learn to create better code, and happy to receive any help given.</p>\n"},{"tags":["c#","dll"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":808,"score":2,"question_id":9623694,"title":"TypeLoadException was unhandled in C#","body":"<p>I'm fairly new to C#, and am having a problem when loading a library into my program. Im trying to run <a href=\"http://www.matthewajohnson.org/software/svm.html\" rel=\"nofollow\">this</a> example in visual studio, but I am getting an error:</p>\n\n<pre><code>TypeLoadException was unhandled. Can't load type SVM.Problem from assembly SVM, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null.\n</code></pre>\n\n<p>This is what my code looks like:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing SVM;\n\nnamespace SVM\n{\nclass Program\n{\n    static void Main(string[] args)\n    {\n        //First, read in the training data.\n        Problem train = Problem.Read(\"a1a.train\");\n        Problem test = Problem.Read(\"a1a.test\");\n\n        //For this example (and indeed, many scenarios), the default\n        //parameters will suffice.\n        Parameter parameters = new Parameter();\n        double C;\n        double Gamma;\n\n        //This will do a grid optimization to find the best parameters\n        //and store them in C and Gamma, outputting the entire\n        //search to params.txt.\n        ParameterSelection.Grid(train, parameters, \"params.txt\", out C, out Gamma);\n        parameters.C = C;\n        parameters.Gamma = Gamma;\n\n        //Train the model using the optimal parameters.\n        Model model = Training.Train(train, parameters);\n\n        //Perform classification on the test data, putting the\n        //results in results.txt.\n        Prediction.Predict(test, \"results.txt\", model, false);\n    }\n}\n</code></pre>\n\n<p>}</p>\n\n<p>I have added the dll as a reference via the solution explorer. What could be going wrong?</p>\n\n<hr>\n\n<p>I have started a new project, added the dll as a reference, ran the project and now everything works. Very frustrating not to know what went wrong, but I suspect it had something to do with the project name and the dll name being the same. Thanks for helping!</p>\n"},{"tags":["c#","process","foreach"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13261997,"title":"Launch processes one after another in C#","body":"<p>Is there a way to iterate through an array/list and launch a process, and wait until it's exited until launching the next, and so on?</p>\n\n<p>I have the code:</p>\n\n<pre><code>string[] processPaths = new string[]{ @\"c:\\foo.exe\", @\"c:\\bar.exe\" };\nforeach(string s in processPaths){\n    Process p = new Process();\n    p.Exited += (obj, ev) =&gt; { continue; };\n}\n</code></pre>\n\n<p>but obviously processes are executed asynchronously and the lambda function isn't part of the <code>foreach</code> loop. It's a console application, and I don't mind if it runs on the main thread.</p>\n"},{"tags":["c#","dependency-injection","ninject"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":74,"score":3,"question_id":13214047,"title":"Ninject Property Injection on base class","body":"<p>I'm attempting to inject a property using <code>ninject</code>. Given the two bindings in the <code>ninject</code> module below, I would expect the <code>ConcreteDependency</code> to be injected into <code>B</code>. <br>However, it seems that <code>WhenInjectedInto</code> doesn't consider the type being injected into, just the declaring type of the target (property in this case).</p>\n\n<p>Is there a way to achieve the behaviour I expected?</p>\n\n<pre><code>static void Main(string[] args)\n{\n    var kernel = new StandardKernel(new TestModule());\n    var b = kernel.Get&lt;B&gt;();\n    var c = kernel.Get&lt;C&gt;();\n}\n\nclass TestModule : NinjectModule\n{\n    public override void Load()\n    {\n        Bind&lt;IDependency&gt;().To&lt;EmptyDependency&gt;();\n        Bind&lt;IDependency&gt;().To&lt;ConcreteDependency&gt;().WhenInjectedInto&lt;B&gt;();\n    }\n}\n\nabstract class A\n{\n    [Inject]\n    public IDependency Dependency { get; set; }\n}\n\nclass B : A {}\n\nclass C : A {}\n\ninterface IDependency {}\n\nclass EmptyDependency : IDependency { }\n\nclass ConcreteDependency : IDependency { }\n</code></pre>\n"},{"tags":["c#",".net","httpwebrequest"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13261046,"title":"Executing web requests inside of a loop only works on the first pass","body":"<p>I am taking a string message and breaking it up into chunks so that I can send it to an sms service (that consequently doesn't break it up for you). I after I do my work for break those messages up, I try loop through the resulting array and execute a web request. The problem is that it only works for the first message, and then hangs after that. After a short time, I get an error message saying \"The connection was closed unexpectedly.\" This occurs at the second time it attempts GetResponse(); I've seen a few other posts on here that were simply saying to close and dispose the response and request streams. This isn't working for me at all. This is where my code is currently:</p>\n\n<pre><code>private static void Main(string[] args)\n{\n    var oldMessage = GetFileString();\n    Console.WriteLine(string.Format(\"Old message: {0}\", oldMessage.Length));\n\n    var newMessage = UrlPathEncodeString(oldMessage);\n    Console.WriteLine(string.Format(\"New message: {0}\", newMessage.Length));\n\n    var brokenUp = SplitByLength(newMessage, 145).ToArray();\n    for(var i = 0; i &lt; brokenUp.Count(); i++)\n    {\n        brokenUp[i] = brokenUp[i].Insert(0, UrlPathEncodeString(string.Format(\"({0:D2} of {1:D2})\", i + 1, brokenUp.Count())));\n        Console.WriteLine(string.Format(\"Appended length: {0}\", brokenUp[i].Length));\n    }\n\n    System.Net.ServicePointManager.DefaultConnectionLimit = 100;\n    foreach (var block in brokenUp)\n    {\n        Thread.Sleep(1500);\n        SendSms((HttpWebRequest)WebRequest.Create(\"http://172.20.5.214:90/method/sendsms\"), block);\n    }\n    Console.ReadKey();\n}\n\npublic static void SendSms(HttpWebRequest request, string message)\n{\n    //build the request\n    var url = \"http://ipaddress/method/sendsms\";\n    //var request = (HttpWebRequest)WebRequest.Create(url);\n    request.Method = \"POST\";\n    request.ContentType = \"application/x-www-form-urlencoded\";\n\n    var fields = \"CellNumber={0}&amp;Message={1}\";\n    fields = string.Format(fields, \"16021234567\", message);\n\n    var fieldsBytes = Encoding.UTF8.GetBytes(fields);\n    request.ContentLength = fieldsBytes.Length;\n    var length = fieldsBytes.Length;\n\n    using (var requestStream = request.GetRequestStream())\n    {\n        requestStream.Write(fieldsBytes, 0, length);\n\n        using (var response = request.GetResponse())\n        {\n            using (var responseStream = response.GetResponseStream())\n            {\n                responseStream.Close();\n            }\n        }\n        requestStream.Close();\n    }\n}\n\npublic static byte[] ReadFully(Stream stream)\n{\n    var buffer = new byte[32768];\n    using (var ms = new MemoryStream())\n    {\n        while (true)\n        {\n            int read = stream.Read(buffer, 0, buffer.Length);\n            if (read &lt;= 0)\n                return ms.ToArray();\n            ms.Write(buffer, 0, read);\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","directx","texture","directx-11","sharpdx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13261427,"title":"SharpDX: Initializing a Texture2D from a DataStream fails (though Texture1D works fine)","body":"\n\n<p>I'm trying to create a SharpDX.Direct3D11.Texture2D from in-memory data but always get a SharpDXException (HRESULT: 0x80070057, \"The parameter is incorrect.\"). I have used a Texture1D for this purpose before which can be created without a problem.</p>\n\n<p>I have reduced the code to this sample which still produces the exception:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>using (var device = new Device(DriverType.Hardware, DeviceCreationFlags.Debug)) {\n    // empty stream sufficient for example\n    var stream = new DataStream(16 * 4, true, true);\n\n    var description1D = new Texture1DDescription() {\n        Width = 16,\n        ArraySize = 1,\n        Format = Format.R8G8B8A8_UNorm,\n        MipLevels = 1,\n    };\n    using (var texture1D = new Texture1D(device, description1D, new[] { new DataBox(stream.DataPointer) })) {\n        // no exception on Texture1D\n    }\n\n    var description2D = new Texture2DDescription() {\n        Width = 8,\n        Height = 2,\n        ArraySize = 1,\n        MipLevels = 1,\n        Format = Format.R8G8B8A8_UNorm,\n        SampleDescription = new SampleDescription(1, 0),\n    };\n    using (var texture2D = new Texture2D(device, description2D, new[] { new DataBox(stream.DataPointer) })) {\n        // HRESULT: [0x80070057], Module: [Unknown], ApiCode: [Unknown/Unknown], Message: The parameter is incorrect.\n    }\n}\n</code></pre>\n\n<p>Creating the texture without passing the data works fine. Can someone tell me how to fix the Texture2D initialization?</p>\n"},{"tags":["c#","webbrowser","web-scraping"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":23,"score":-2,"question_id":13261927,"title":"c# HTML web scriping how to handle link click to download files","body":"<p>In C# windows app, I am using WebBrowser Control and loading a page. I am able to push the required input details into the dropdowns and also hitting a button. It shows me a list of records with links to download files. I want to click and save the document in my c# windows app. How can i do that?</p>\n\n<p><a href=\"http://www.ceoandhra.nic.in/ceonew/home.aspx\" rel=\"nofollow\">http://www.ceoandhra.nic.in/ceonew/home.aspx</a></p>\n\n<p>In this site, Click on PDF Electrol Rolls.</p>\n\n<p>Please help me out.....</p>\n"},{"tags":["c#","error-handling","comexception"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":175,"score":1,"question_id":11729385,"title":"C# - UrlHistoryWrapper class - Not enough storage is available to process this command. (Exception from HRESULT: 0x80070008)","body":"<p>I am getting values from a database, and trying to insert them into Internet Explorers history, using the UrlHistoryWrapper class. When I set the <code>for</code> conditions to something in the thousands, I will get this error, however, when I set the for condition to less than 100, it will run fine. I have checked the memory usage, and it should cause no problems. How can I make this code able to run, if chrome.URLs and firefox.URLs have thousands of values?</p>\n\n<p>This is my code:</p>\n\n<pre><code>UrlHistoryWrapperClass urlHistory;\n        UrlHistoryWrapperClass.STATURLEnumerator enumerator;\n        List&lt;STATURL&gt; list = new List&lt;STATURL&gt;();\n        urlHistory = new UrlHistoryWrapperClass();\n        enumerator = urlHistory.GetEnumerator();\n        bool display = false;\n        chrome.GetHistory(display);\n        for (int i = 0; i &lt; chrome.URLs.Count; i++ )\n        {\n            URL url = chrome.URLs[i];\n            urlHistory.AddHistoryEntry(url.url, url.title, ADDURL_FLAG.ADDURL_ADDTOHISTORYANDCACHE);\n        }\n        Firefox firefox = new Firefox();\n        firefox.GetHistory(display:false);\n        foreach (URL url in firefox.URLs)\n        {\n            MessageBox.Show(url.url);\n\n            urlHistory.AddHistoryEntry(url.url, url.title, ADDURL_FLAG.ADDURL_ADDTOHISTORYANDCACHE);\n        }\n</code></pre>\n\n<p>And this is my error:</p>\n\n<blockquote>\n  <p><em><strong></em>**<em>*</em>**<em></strong> Exception Text <strong></em>**<em>*</em>****</strong> \n  System.Runtime.InteropServices.COMException (0x80070008): Not enough\n  storage is available to process this command. (Exception from HRESULT:\n  0x80070008)    at UrlHistoryLibrary.IUrlHistoryStg2.AddUrl(String\n  pocsUrl, String pocsTitle, ADDURL_FLAG dwFlags)    at\n  UrlHistoryLibrary.UrlHistoryWrapperClass.AddHistoryEntry(String\n  pocsUrl, String pocsTitle, ADDURL_FLAG dwFlags)    at\n  Namespace.IE.SyncIE() in C:\\Users\\Chris\\documents\\visual studio\n  2010\\Projects\\TestURLGUI4\\TestURLGUI4\\URLHistory.cs:line 270    at\n  Namespace.Program.SyncAll() in C:\\Users\\Chris\\documents\\visual studio\n  2010\\Projects\\TestURLGUI4\\TestURLGUI4\\URLHistory.cs:line 152    at\n  TestURLGUI2.Form1.button11_Click(Object sender, EventArgs e) in\n  C:\\Users\\Chris\\documents\\visual studio\n  2010\\Projects\\TestURLGUI4\\TestURLGUI4\\Form1.cs:line 247    at\n  System.Windows.Forms.Control.OnClick(EventArgs e)    at\n  System.Windows.Forms.Button.OnClick(EventArgs e)    at\n  System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)    at\n  System.Windows.Forms.Control.WmMouseUp(Message&amp; m, MouseButtons\n  button, Int32 clicks)    at\n  System.Windows.Forms.Control.WndProc(Message&amp; m)    at\n  System.Windows.Forms.ButtonBase.WndProc(Message&amp; m)    at\n  System.Windows.Forms.Button.WndProc(Message&amp; m)    at\n  System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message&amp; m)\n  at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp;\n  m)    at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32\n  msg, IntPtr wparam, IntPtr lparam)</p>\n</blockquote>\n\n<p>Edit:</p>\n\n<p>Here is my new code:</p>\n\n<pre><code>    for (var i = 0; i &lt; firefox.URLs.Count; i++ )\n    {\n        URL url = firefox.URLs[i];\n        urlHistory.AddHistoryEntry(url.url, url.title, ADDURL_FLAG.ADDURL_ADDTOHISTORYANDCACHE);\n        Thread.Sleep(3);\n        form.label1.Text = i + \"/\" + firefox.URLs.Count;\n      //  MessageBox.Show(url.url);\n        Application.DoEvents();\n    }\n</code></pre>\n\n<p>Now, with this code, I can go up to 8447 without getting this error, but then it gets thrown.</p>\n\n<p>I had someone else try to do this, and this is what he said:</p>\n\n<blockquote>\n  <p>Just tried your code and and it seems that there is a limit on the\n  number of the url records that can be added.   I did the following\n  steps.</p>\n  \n  <ol>\n  <li>In Internet Explorer, Clear the history of websites I've visited.</li>\n  <li>I tried your code.</li>\n  <li>Got a COMException (0x80070008): Not enough storage is available to process this command. The exception is thrown at record number 41021\n  for me (Windows 7, 64bit).</li>\n  <li>I tried your code again, and Got a very same exception. This time, No record have be added.   To add the url records again. I have\n  to clear the history of websites in Internet Explorer.   I could not\n  find a way to fix the problem.</li>\n  </ol>\n</blockquote>\n\n<p>For anyone who needs to know, the source code for the URLhistoryWrapper can be found on <a href=\"http://www.codeproject.com/script/Articles/ViewDownloads.aspx?aid=7500\" rel=\"nofollow\">this CodeProject project</a>.</p>\n"},{"tags":["c#","linq-to-xml"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12838207,"title":"C# - Linq to XML - Exclude elements from query","body":"<p>I have this XML file:</p>\n\n<pre><code>&lt;MyXml&gt;\n    &lt;MandatoryElement1&gt;value&lt;/MandatoryElement1&gt;\n    &lt;MandatoryElement2&gt;value&lt;/MandatoryElement2&gt;\n    &lt;MandatoryElement3&gt;value&lt;/MandatoryElement3&gt;\n    &lt;CustomElement1&gt;value&lt;/CustomElement1&gt;\n    &lt;CustomElement2&gt;value&lt;/CustomElement2&gt;\n&lt;MyXml&gt;\n</code></pre>\n\n<p>All 3 elements that are called 'MandatoryElementX' will always appear in the file. The elements called 'CustomElementX' are unknown. These can be added or removed freely by a user and have any name.<br><br>\nWhat I need is to fetch all the elements that are not MandatoryElements. So for the file above I would want this result:</p>\n\n<pre><code>&lt;CustomElement1&gt;value&lt;/CustomElement1&gt;\n&lt;CustomElement2&gt;value&lt;/CustomElement2&gt;\n</code></pre>\n\n<p>I don't know what the names of the custom elements may be, only the names of the 3 MandatoryElements, so the query needs to somehow exclude these 3.</p>\n\n<p><strong>Edit</strong>:<br>\nEven though this was answered, I want to clarify the question. Here is an actual file:</p>\n\n<pre><code>&lt;Partner&gt;\n    &lt;!--Mandatory elements--&gt;\n    &lt;Name&gt;ALU FAT&lt;/Name&gt;\n    &lt;InterfaceName&gt;Account Lookup&lt;/InterfaceName&gt;\n    &lt;RequestFolder&gt;C:\\Documents and Settings\\user1\\Desktop\\Requests\\ALURequests&lt;/RequestFolder&gt;\n    &lt;ResponseFolder&gt;C:\\Documents and Settings\\user1\\Desktop\\Responses&lt;/ResponseFolder&gt;\n    &lt;ArchiveMessages&gt;Yes&lt;/ArchiveMessages&gt;\n    &lt;ArchiveFolder&gt;C:\\Documents and Settings\\user1\\Desktop\\Archive&lt;/ArchiveFolder&gt;\n    &lt;Priority&gt;1&lt;/Priority&gt;\n\n    &lt;!--Custom elements - these can be anything--&gt;\n    &lt;Currency&gt;EUR&lt;/Currency&gt;\n    &lt;AccountingSystem&gt;HHGKOL&lt;/AccountingSystem&gt;\n&lt;/Partner&gt;\n</code></pre>\n\n<p>The result here would be:</p>\n\n<pre><code>&lt;Currency&gt;EUR&lt;/Currency&gt;\n&lt;AccountingSystem&gt;HHGKOL&lt;/AccountingSystem&gt;\n</code></pre>\n"},{"tags":["c#","ocr","screen-scraper"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":649,"score":2,"question_id":1494035,"title":"Screen scraper application (not HTML)","body":"<p></p>I need screen scraper application which will recognize text from the screen (and not use winapi to do this so source could be in image file). I found a lot of commercial solutions, but I need something open source or free.\nI plan to include it in my C# project, so there should be some SDK available.\n</p>Thanks.</p>\n"},{"tags":["c#",".net","forms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13261314,"title":"Windows Forms controls decoration","body":"<p>I am new to C# and I am trying to build my own simplified Windows Explorer. I want to apply Windows theme to decorate treeview and listview. I cam accross this great <a href=\"http://stackoverflow.com/questions/3014816/visualstylerenderer-and-themes-winforms\">link</a>, but have no idea how to attach these to my treeview. I am looking for detailed answer. As far, I understood only that I need to set DrawMode to OwnerDrawAll. What is next?</p>\n"},{"tags":["c#","wcf","x509certificate","ws-security"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":318,"score":6,"question_id":12832213,"title":"How to make WCF Client conform to specific WS-Security - sign UsernameToken and SecurityTokenReference","body":"<p>I need to create a wcf client to call a service that I have no control over. </p>\n\n<p>I have been given a wsdl and a working soapui project.</p>\n\n<p>The service uses both a username/password and a x509 certificate.</p>\n\n<hr>\n\n<p>UPDATE</p>\n\n<p>I now understand what the problem is, but am still unsure what steps I need to take to be able to create the required message, so any help would be much appreciated.</p>\n\n<p>I need to sign both the UsernameToken and the SecurityTokenReference.</p>\n\n<p>The code I had to create the custom binding has been removed from this post as its no longer used. I no longer add a SecurityBindingElement to the binding, instead I add a new behaviour that writes the security element into the header.</p>\n\n<p>So the security node is created from scratch by subclassing the SignedXml class, adding signing references and then calling ComputeSignature to create the Signature node within the Security header.</p>\n\n<p>You need to pass the xml to sign into the SignedXml constructor for this to work. It is no problem passing in the UsernameToken and this appears to be signed correctly.</p>\n\n<p>The problem is that the SecurityTokenReference is only created when ComputeSignature() is called, so I'm not able to add a signing Reference to this element, as it does not exist at the time it is required (within the overridden GetIdElement method of SignedXml which is called prior to ComputeSignature())</p>\n\n<hr>\n\n<p>The code I'm using to create the signature block to insert into the Security header is as follows</p>\n\n<pre><code>   string certificatePath = System.Windows.Forms.Application.StartupPath + \"\\\\\" + \"Certs\\\\sign-and-    enc.p12\";\n\n    XmlDocument xd = new XmlDocument();\n    xd.LoadXml(xml);\n\n    // Set Certificate \n    System.Security.Cryptography.X509Certificates.X509Certificate2 cert = new X509Certificate2(certificatePath, \"password\");\n    MySignedXml signedXml = new MySignedXml(xd);\n    signedXml.SigningKey = cert.PrivateKey;\n\n    // Create a new KeyInfo object. \n    KeyInfo keyInfo = new KeyInfo();\n    keyInfo.Id = \"\";\n\n    MemoryStream keyInfoStream = new MemoryStream();\n    XmlWriter keyInfoWriter = XmlWriter.Create(keyInfoStream);\n\n    WSSecurityTokenSerializer.DefaultInstance.WriteKeyIdentifierClause(keyInfoWriter, new LocalIdKeyIdentifierClause(\"token_reference\", typeof(X509SecurityToken)));   \n\n    keyInfoWriter.Flush();\n    keyInfoStream.Position = 0;\n    XmlDocument keyInfoDocument = new XmlDocument();\n    keyInfoDocument.Load(keyInfoStream);\n\n    XmlAttribute attrib = keyInfoDocument.CreateAttribute(\"ValueType\");\n    attrib.InnerText = \"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\";\n    keyInfoDocument.ChildNodes[1].ChildNodes[0].Attributes.Append(attrib);\n\n    KeyInfoNode keyInfoNode = new KeyInfoNode();\n    keyInfoNode.LoadXml(keyInfoDocument.DocumentElement);\n    keyInfo.AddClause(keyInfoNode);\n\n    // Add the KeyInfo object to the SignedXml object. \n    signedXml.KeyInfo = keyInfo;\n\n    // Need to use External Canonicalization method. \n    signedXml.SignedInfo.CanonicalizationMethod = \"http://www.w3.org/2001/10/xml-exc-c14n#\";\n\n    // Create a reference to be signed. \n    Reference reference = new Reference();\n    reference.Uri = \"#UsernameToken-1\";\n\n    XmlDsigEnvelopedSignatureTransform env = new XmlDsigEnvelopedSignatureTransform();\n    env.Algorithm = \"http://www.w3.org/2001/10/xml-exc-c14n#\";\n    reference.AddTransform(env);\n    reference.DigestMethod = \"http://www.w3.org/2000/09/xmldsig#sha1\";\n    signedXml.AddReference(reference);\n\n\n    Reference reference2 = new Reference();\n    reference2.Uri = \"#token_reference\";\n    XmlDsigEnvelopedSignatureTransform env2 = new XmlDsigEnvelopedSignatureTransform();\n    env2.Algorithm = \"http://www.w3.org/2001/10/xml-exc-c14n#\";\n    reference2.AddTransform(env2);\n    reference2.DigestMethod = \"http://www.w3.org/2000/09/xmldsig#sha1\";\n    signedXml.AddReference(reference2);\n\n    // Add the Signature Id \n    signedXml.Signature.Id = \"MYSIG_ID\";\n\n    // Compute the signature. \n    signedXml.ComputeSignature();\n\n    XmlElement xmlDigitalSignature = signedXml.GetXml();\n</code></pre>\n\n<p>where the xml variable is the the UsernameToken xml string, and the MySignedXml class is a subclassed SignedXml with the GetIdElement method overridden (to try to find and correctly refreence the non-existant SecurityTokenReference)</p>\n\n<p>I've spend days researching and testing this now, and unfortunately the company supplying the service isn't any help - but I need to use their service.</p>\n\n<p><strong>Full working soap message (soapUI project)</strong></p>\n\n<pre><code>&lt;soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:urn=\"urn:XXXXX\"&gt;\n   &lt;soapenv:Header xmlns:ebxml=\"http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/\"&gt;\n   &lt;wsse:Security soapenv:mustUnderstand=\"1\" xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\"&gt;\n    &lt;wsse:BinarySecurityToken EncodingType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary\" ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\" wsu:Id=\"CertId-D05E596B5ABC341FEB13505090224061\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"&gt;MIIEnDCCBAWgAwIBAgIBAjANBgkqhkiG9w0BAQUFADCBxDELMAkGA1UEBhMCTloxDTALBgNVBAgTBFdHVE4xEzARBgNVBAcTCldlbGxpbmd0b24xGDAWBgNVBAoTD0lSRFN0dWR5bGlua0IyQjEUMBIGA1UECxMLRGV2ZWxvcG1lbnQxHjAcBgNVBAMTFWRldmNhLmIyYi5pcmQuZ292dC5uejEXMBUGA1UEKRMORGV2ZWxvcG1lbnQgQ0ExKDAmBgkqhkiG9w0BCQEWGWNocmlzLnNjaHVsdHpAaXJkLmdvdnQubnowHhcNMTEwOTE1MDIwNjIwWhcNMjEwOTEyMDIwNjIwWjCByTELMAkGA1UEBhMCTloxDTALBgNVBAgTBFdHVE4xEzARBgNVBAcTCldlbGxpbmd0b24xGDAWBgNVBAoTD0lSRFN0dWR5bGlua0IyQjEUMBIGA1UECxMLRGV2ZWxvcG1lbnQxJTAjBgNVBAMTHHNpZ24tYW5kLWVuYy5kZXYuaXJkLmdvdnQubnoxFTATBgNVBCkTDHNpZ24tYW5kLWVuYzEoMCYGCSqGSIb3DQEJARYZY2hyaXMuc2NodWx0ekBpcmQuZ292dC5uejCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEAykyZHVnXjsG220zB3kNOsGBeGP2rdNbLlIqW1D8yZO1fcj3/RhRiqsopbUrb8AU1ClpfhbH2K68kg7V91VAY0qrwNxP+pPPo1vYKMU6pT38qJGQzffr+iV2BCJshZvSk9E7QSWO5mFNstdg19xc+5ST1Lgb3fefuRG2KZVxPx0sCAwEAAaOCAZUwggGRMAkGA1UdEwQCMAAwEQYJYIZIAYb4QgEBBAQDAgZAMDQGCWCGSAGG+EIBDQQnFiVFYXN5LVJTQSBHZW5lcmF0ZWQgU2VydmVyIENlcnRpZmljYXRlMB0GA1UdDgQWBBSczRKXKPe3Sin7eFrVXfI7MXckzzCB+QYDVR0jBIHxMIHugBSLWxPSZd9otEj16vhLyovMCI9OMaGByqSBxzCBxDELMAkGA1UEBhMCTloxDTALBgNVBAgTBFdHVE4xEzARBgNVBAcTCldlbGxpbmd0b24xGDAWBgNVBAoTD0lSRFN0dWR5bGlua0IyQjEUMBIGA1UECxMLRGV2ZWxvcG1lbnQxHjAcBgNVBAMTFWRldmNhLmIyYi5pcmQuZ292dC5uejEXMBUGA1UEKRMORGV2ZWxvcG1lbnQgQ0ExKDAmBgkqhkiG9w0BCQEWGWNocmlzLnNjaHVsdHpAaXJkLmdvdnQubnqCCQDL/qDdlx2j6DATBgNVHSUEDDAKBggrBgEFBQcDATALBgNVHQ8EBAMCBaAwDQYJKoZIhvcNAQEFBQADgYEAS4ZPIVVpgTOGN4XcIC3SiYlxF8wYg7qnUhH5wJsAD3VCKfj68j9FSJtdBWLlWvvRxEoDP2lZ0IbFl6Rjnl+2ibzFnyac2G1AVm5mwPrNKHBQJ9J5eDJi0iUVY7Wphz86tKnqj34GvlHPNXmrF7oGEcDhPwK0T8zRdE/pvKIUiJc=&lt;/wsse:BinarySecurityToken&gt;\n    &lt;ds:Signature Id=\"Signature-2\" xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"&gt;\n        &lt;ds:SignedInfo&gt;\n            &lt;ds:CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/&gt;\n            &lt;ds:SignatureMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\"/&gt;\n            &lt;ds:Reference URI=\"#CertId-D05E596B5ABC341FEB13505090224061\"&gt;\n                &lt;ds:Transforms&gt;\n                    &lt;ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/&gt;\n                &lt;/ds:Transforms&gt;\n                &lt;ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/&gt;\n                &lt;ds:DigestValue&gt;3iVAUEAt8vAb7Ku+jf2gwSkSm0Q=&lt;/ds:DigestValue&gt;\n            &lt;/ds:Reference&gt;\n            &lt;ds:Reference URI=\"#UsernameToken-1\"&gt;\n                &lt;ds:Transforms&gt;\n                    &lt;ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/&gt;\n                &lt;/ds:Transforms&gt;\n                &lt;ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/&gt;\n                &lt;ds:DigestValue&gt;r4HLEAWJldJwmEmcAqV6Y8rnTPE=&lt;/ds:DigestValue&gt;\n            &lt;/ds:Reference&gt;\n        &lt;/ds:SignedInfo&gt;\n        &lt;ds:SignatureValue&gt;\n        YGh2I3VcukqjT0O7hKItiykWN5tlID18ZXRCwQjXriHmnVsO4wGcHjWfmhuNDecq+xRN+SjG8E7M\n        2Rx/5/BbFKbVlNOkQOSbSxIs1YT9GaThK16pMrX5KRkkJme1W3R0pGIIQh6gGRSUf79RZUIYxyVl\n        LqdIe561TXXDdtbt/6Q=\n        &lt;/ds:SignatureValue&gt;\n        &lt;ds:KeyInfo Id=\"KeyId-D05E596B5ABC341FEB13505090224372\"&gt;\n            &lt;wsse:SecurityTokenReference wsu:Id=\"STRId-D05E596B5ABC341FEB13505090224373\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"&gt;\n                &lt;wsse:Reference URI=\"#CertId-D05E596B5ABC341FEB13505090224061\" ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\"/&gt;&lt;/wsse:SecurityTokenReference&gt;\n        &lt;/ds:KeyInfo&gt;\n    &lt;/ds:Signature&gt;\n    &lt;wsse:UsernameToken wsu:Id=\"UsernameToken-1\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"&gt;\n        &lt;wsse:Username&gt;XXXXXX&lt;/wsse:Username&gt;\n        &lt;wsse:Password Type=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText\"&gt;XXXXXXX&lt;/wsse:Password&gt;\n        &lt;/wsse:UsernameToken&gt;\n    &lt;/wsse:Security&gt;\n  &lt;ebxml:Messaging xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;\n     &lt;ebxml:UserMessage&gt;\n        &lt;ebxml:MessageInfo&gt;\n           &lt;ebxml:Timestamp&gt;2002-02-02T14:18:02.0Z&lt;/ebxml:Timestamp&gt;\n           &lt;ebxml:MessageId&gt;bf9433d9-c6e9-4c12-9c98-724008a09c21&lt;/ebxml:MessageId&gt;\n        &lt;/ebxml:MessageInfo&gt;\n        &lt;ebxml:PartyInfo&gt;\n           &lt;ebxml:From&gt;\n              &lt;ebxml:PartyId type=\"identifier\"&gt;Trading Partner X&lt;/ebxml:PartyId&gt;\n              &lt;ebxml:Role&gt;Provider&lt;/ebxml:Role&gt;\n           &lt;/ebxml:From&gt;\n           &lt;ebxml:To&gt;\n              &lt;ebxml:PartyId type=\"identifier\"&gt;XXXXXXX&lt;/ebxml:PartyId&gt;\n              &lt;ebxml:Role&gt;Requestor&lt;/ebxml:Role&gt;\n           &lt;/ebxml:To&gt;\n        &lt;/ebxml:PartyInfo&gt;\n        &lt;ebxml:CollaborationInfo&gt;\n           &lt;ebxml:AgreementRef&gt;urn:XXXXXXXXX&lt;/ebxml:AgreementRef&gt;\n           &lt;ebxml:Service type=\"Web Service\"&gt;urn:XXXXXXXX&lt;/ebxml:Service&gt;\n           &lt;ebxml:Action&gt;customerInformation&lt;/ebxml:Action&gt;\n           &lt;ebxml:ConversationId&gt;e302426a-b2d9-4ff1-a14b-fbbc2f40a017&lt;/ebxml:ConversationId&gt;\n        &lt;/ebxml:CollaborationInfo&gt;\n     &lt;/ebxml:UserMessage&gt;\n  &lt;/ebxml:Messaging&gt;\n   &lt;/soapenv:Header&gt;\n   &lt;soapenv:Body&gt;\n  &lt;urn:ConnectionTest&gt;\n     &lt;Message&gt;Bonjour&lt;/Message&gt;\n  &lt;/urn:ConnectionTest&gt;\n   &lt;/soapenv:Body&gt;\n&lt;/soapenv:Envelope&gt;\n</code></pre>\n\n<p>We were supplied with some documentation. The security section is copied below</p>\n\n<p>The following security must be applied to each request in the following order:\nA wsse:UsernameToken must be included and contain:</p>\n\n<ol>\n<li>The Agent‟s Portal Username for the value of the wsse:Username element</li>\n<li><p>The Agent‟s Portal Password for the value of the wsse:PasswordText (clear text) in the Password element\nA Signature block:\nDigital Signatures are created using x509 certificates. Each software provider is required to hold and protect a valid certificate and private key issued by [To Be Determined]. With each service request the software must:</p></li>\n<li><p>Include the Certificate that matches the private key used for signing as a wsse:BinarySecurityToken and use it as the wsse:SecurityTokenReference for the Signature</p></li>\n<li>Sign the wsse:BinarySecurityToken</li>\n<li>Sign the wsse:UsernameToken</li>\n<li>Use Canonicalization Method Algorithm: <a href=\"http://www.w3.org/2001/10/xml-exc-c14n#\" rel=\"nofollow\">http://www.w3.org/2001/10/xml-exc-c14n#</a></li>\n<li>Use Signature Method Algorithm: <a href=\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\" rel=\"nofollow\">http://www.w3.org/2000/09/xmldsig#rsa-sha1</a></li>\n<li>Use Digest Method Algorithm: <a href=\"http://www.w3.org/2000/09/xmldsig#sha1\" rel=\"nofollow\">http://www.w3.org/2000/09/xmldsig#sha1</a></li>\n</ol>\n"},{"tags":["c#","wpf","wpf-controls","rtf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13261815,"title":"Extracting raw RTF from a RichTextBox","body":"<p>There's got to be a better way to do this than what I'm doing.</p>\n\n<p>I'm trying to extract the raw RTF from a WPF RichTextBox.  Well, really I'm trying to take a bunch of my custom classes and turn it into an RTF string, but I'm using a RichTextBox to do it because I don't particularly want to write my own RTF library.</p>\n\n<p>The method I'm using (modified from something first seen <a href=\"http://stackoverflow.com/questions/3003984/how-to-set-rtf-from-winforms-to-wpf-richtextbox\" title=\"here\">here</a> and used to extract XML <a href=\"http://stackoverflow.com/questions/601838/get-rtf-from-richtextbox\">here</a>) is as follows:</p>\n\n<pre><code>RTB.Selection.Save(memstream, DataFormats.Rtf);\nmemstream.Seek(0, SeekOrigin.Begin);\nvar sr = new StreamReader(memstream);\nvar myText = sr.ReadToEnd();\n</code></pre>\n\n<p>This works, but seems ridiculously clumsy.  And I'm worried about the performance implications on large amounts of text.  Is there a better way?  (For the purpose of this question, let's assume that I can't use the WinForms RichTextBox.)</p>\n"},{"tags":["c#","internet-explorer","download","lotus-domino","rightclick"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":28,"score":-1,"question_id":13255346,"title":"How can I added a right click menu to download all attachment in some web page","body":"<p>I encountered a web page that contains several attachments that can only be downloaded one by one.</p>\n\n<p>How can I create a program that adds a right click menu in IE that shows a manu with an option to \"Save All\"?</p>\n\n<p>Please note that I am a Domino Administrator, not a programmer, but do know a little C#.  Can somebody describe how to implement this feature??</p>\n"},{"tags":["c#","visual-studio-2010"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":54,"score":-1,"question_id":13261405,"title":"Eclipse like console in Visual Studio 2010 C#","body":"<p>I am going to do some code in c# using visual studio 2010. The problem is that every time I run program it does appear in command prompt.</p>\n\n<p>I would like place the output of the program in the console like in the Eclipse. <code>System.Diagnostics.Debug.Write(\"abc\");</code> this does not work cause if I look at the output I see much more information than I want. <em>I would like to see only data which would show in the command prompt</em>.</p>\n"},{"tags":["c#","asp.net","gridview","checkbox"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3023,"score":1,"question_id":3075044,"title":"how to add checkbox column to gridview","body":"<p>How to add checkbox column to gridview .</p>\n\n<p>i've tried:</p>\n\n<pre><code>foreach (GridViewRow objRow in GridView1.Rows)\n{\n   TableCell tcCheckCell = new TableCell();\n   CheckBox chkCheckBox = new CheckBox();\n   tcCheckCell.Controls.Add(chkCheckBox);\n\n   objRow.Cells.Add( tcCheckCell);\n}\n</code></pre>\n\n<p>How can i add the <code>objrow</code> to gridview? Or is there any other method of adding a checkbox column to an ASP.net <code>GridView</code>?</p>\n"},{"tags":["c#",".net","sockets"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":13261625,"title":"One server many clients: Threads or classes","body":"<p>I'm doing an application in C#, with a server and some clients (not more than 60), and I would like to be able to deal with each client independently. The communication between server and client is simple but I have to wait for some ack's and I don't want to block any query.</p>\n\n<p>So far, I've done two versions of the server side, one it's based on this:</p>\n\n<p><a href=\"http://aviadezra.blogspot.com.es/2008/07/code-sample-net-sockets-multiple.html\" rel=\"nofollow\">http://aviadezra.blogspot.com.es/2008/07/code-sample-net-sockets-multiple.html</a></p>\n\n<p>and in the other one, I basically create a new thread for each client. Both versions work fine...but I would like to know pros and cons of the two methods.</p>\n\n<p>Any programming pattern to follow in this sort of situation?</p>\n"},{"tags":["c#","wpf","firefox","browser","gecko"],"answer_count":2,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":1785,"score":5,"question_id":7552144,"title":"Embed Firefox/Gecko in WPF/C#","body":"<p>i want to embed the current Gecko in my WPF-Project.\ni know there is the possibility with the Winforms-Host and the Skybound-Gecko-Libary.</p>\n\n<p>But i use not the standard wpf-theme für my application. its another and the scrollbar of the control will not be styled. furthermore this is an old libary which is designed for firefox 3.</p>\n\n<p>which is the best libary/strategy to use the current gecko in wpf?\nthanks for your help</p>\n"},{"tags":["c#","dynamic"],"answer_count":4,"favorite_count":5,"up_vote_count":23,"down_vote_count":0,"view_count":9970,"score":23,"question_id":4939508,"title":"Get value of c# dynamic property via string","body":"<p>I'd like to access the value of a <code>dynamic</code> c# property with a string:</p>\n\n<p><code>dynamic d = new { value1 = \"some\", value2 = \"random\", value3 = \"value\" };</code></p>\n\n<p>How can I get the value of d.value2 (\"random\") if I only have \"value2\" as a string? In javascript, I could do d[\"value2\"] to access the value (\"random\"), but I'm not sure how to do this with c# and reflection. The closest I've come is this:</p>\n\n<p><code>d.GetType().GetProperty(\"value2\")</code> ... but I don't know how to get the actual value from that.</p>\n\n<p>As always, thanks for your help!</p>\n"},{"tags":["c#","asp.net",".net","wcf","iis7"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13261184,"title":"How to open service port?","body":"<p>I'm getting an error code 10061 when calling a WCF service.  The error is </p>\n\n<blockquote>\n  <p>Could not connect to <code>&lt;service uri</code>>.  The connection attempt lasted for a time span of   xxxx.  TCP error code 10061.  No connection could be made because the target machine actively refused it.</p>\n</blockquote>\n\n<p>When I do a </p>\n\n<pre><code>netstat -a\n</code></pre>\n\n<p>I don't see that the port this net.tcp service address should be on is listening.  In IIS, the website this service is under has started.  Any ideas why the port isn't listed in TCP as listening or how I can get it to listen?</p>\n"},{"tags":["c#","wcf","azure","servicebus","azureservicebus"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":110,"score":0,"question_id":12896570,"title":"Microsoft ServiceBus - The argument entityName is null or empty","body":"<p>I am using Servicebus as a link between a web-application and BizTalk.\nIn the web-application i earlier had the whole endpoint defined in the web.config but the endpoints has to be dynamic so i tried to set the endpoint by code.</p>\n\n<p>After the change i only get an exception when i try to send a message to the queue. (ArgumentException - The argument entityName is null or empty)</p>\n\n<p>Here is the code sending the message to the queue:</p>\n\n<pre><code>string queuename = Company.GetQueueName(O.companyId);\nvar factory = new ChannelFactory&lt;IOrder&gt;(\"requestQueueClientEndpoint\", new EndpointAddress(ServiceBusEnvironment.CreateServiceUri(\"sb\", queuename, string.Empty)));\nvar OrdRspChannel = factory.CreateChannel();\n\nOrdRspChannel.Order(O);\n</code></pre>\n\n<p>And here is the configuration:</p>\n\n<pre><code>&lt;system.serviceModel&gt;\n&lt;behaviors&gt;\n  &lt;endpointBehaviors&gt;\n    &lt;behavior name=\"securityBehavior\"&gt;\n      &lt;TransportClientEndpointBehavior&gt;\n        &lt;tokenProvider&gt;\n          &lt;sharedSecret issuerName=\"owner\" issuerSecret=\"SECRET REMOVED\" /&gt;\n          &lt;serviceCertificate&gt;\n            &lt;authentication revocationMode=\"NoCheck\"/&gt;\n          &lt;/serviceCertificate&gt;\n        &lt;/tokenProvider&gt;\n      &lt;/TransportClientEndpointBehavior&gt;\n    &lt;/behavior&gt;\n  &lt;/endpointBehaviors&gt;\n&lt;/behaviors&gt;\n\n&lt;bindings&gt;\n  &lt;netMessagingBinding&gt;\n    &lt;binding name=\"netMessagingBinding\" sendTimeout=\"00:10:00\" receiveTimeout=\"00:10:00\" openTimeout=\"00:10:00\" closeTimeout=\"00:10:00\" sessionIdleTimeout=\"00:10:00\" prefetchCount=\"-1\"&gt;\n      &lt;transportSettings batchFlushInterval=\"00:00:01\" /&gt;\n    &lt;/binding&gt;\n  &lt;/netMessagingBinding&gt;\n&lt;/bindings&gt;\n\n&lt;client&gt;\n  &lt;!-- Invoke BizTalk via Service Bus Queue --&gt;\n  &lt;endpoint address=\"ADDRESS REMOVED\" behaviorConfiguration=\"securityBehavior\" binding=\"netMessagingBinding\" bindingConfiguration=\"netMessagingBinding\" contract=\"Procurement_MVC3.IOrder\" name=\"requestQueueClientEndpoint\" /&gt;\n&lt;/client&gt;\n&lt;/system.serviceModel&gt;\n</code></pre>\n\n<p>Here is the StackTrace:</p>\n\n<pre><code>{System.ArgumentException: The argument entityName is null or empty.\nParameter name: entityName\n\nServer stack trace: \n   at Microsoft.ServiceBus.Messaging.MessagingFactory.CheckValidEntityName(String entityName, Int32 maxEntityNameLength, Boolean allowSeparator, String paramName)\n   at Microsoft.ServiceBus.Messaging.MessagingFactory.&lt;&gt;c__DisplayClass1d.&lt;BeginCreateMessageSender&gt;b__1b(AsyncCallback c, Object s)\n   at Microsoft.ServiceBus.Messaging.OpenOnceManager.OpenOnceManagerAsyncResult`1.BeginOpenCompleted(IAsyncResult result)\n   at Microsoft.ServiceBus.Messaging.OpenOnceManager.OpenOnceManagerAsyncResult`1.BeginOpen()\n   at Microsoft.ServiceBus.Messaging.OpenOnceManager.OpenOnceManagerAsyncResult`1..ctor(OpenOnceManager openOnceManager, TimeSpan openTimeout, AsyncCallback callback, Object state, Func`3 beginOperation, EndOperation`1 endOperation)\n   at Microsoft.ServiceBus.Messaging.OpenOnceManager.Begin[T](AsyncCallback callback, Object state, Func`3 beginOperation, Func`2 endOperation)\n   at Microsoft.ServiceBus.Messaging.MessagingFactory.BeginCreateMessageSender(String entityPath, TimeSpan timeout, AsyncCallback callback, Object state)\n   at Microsoft.ServiceBus.Messaging.Channels.ServiceBusOutputChannel.OpenMessagingFactoryAndMessageSenderAsyncResult.CreateFactoryComplete(IAsyncResult result)\n   at Microsoft.ServiceBus.Messaging.Channels.ServiceBusOutputChannel.OpenMessagingFactoryAndMessageSenderAsyncResult..ctor(ServiceBusOutputChannel outputChannel, TimeSpan timeout, AsyncCallback callback, Object state)\n   at Microsoft.ServiceBus.Messaging.Channels.ServiceBusOutputChannel.OnOpen(TimeSpan timeout)\n   at System.ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout)\n   at System.ServiceModel.Channels.ServiceChannel.OnOpen(TimeSpan timeout)\n   at System.ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout)\n   at System.ServiceModel.Channels.ServiceChannel.CallOnceManager.CallOnce(TimeSpan timeout, CallOnceManager cascade)\n   at System.ServiceModel.Channels.ServiceChannel.EnsureOpened(TimeSpan timeout)\n   at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout)\n   at System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation)\n   at System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message)\n\nException rethrown at [0]: \n   at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)\n   at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData&amp; msgData, Int32 type)\n   at Procurement_MVC3.IOrder.Order(Order Order)\n   at Procurement_MVC3.Controllers.HomeController.ViewOrder(String id, Nullable`1 date, Nullable`1 confirmqty, String orderrowid, String supplierorderId, Boolean confirm) in c:\\Projects2\\trunk\\Procurement_MVC3\\Procurement_MVC3\\Controllers\\HomeController.cs:line 229}\n</code></pre>\n\n<p>I have searched both Google and StackOverflow for similar scenarios but found nothing.\nI also have to update a production-environment with this code and this is the last piece of the puzzle so it's starting to drag on.</p>\n"},{"tags":["c#","asp.net","customvalidator"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":890,"score":2,"question_id":10172406,"title":"CustomValidator ServerValidate method does not fire","body":"<p>I've put a <code>CustomValidator</code> on my form. I have not set its <code>ControlToValidate</code> property. In its <code>ServerValidate</code> event I've written the following:</p>\n\n<pre><code>protected void CustomValidator1_ServerValidate(object source,      \n                                               ServerValidateEventArgs args)\n{\n    args.IsValid = false;\n}\n</code></pre>\n\n<p>I put a breakpoint to this method but it seems to never come to that point. But if I do this on another form it works like a charm.</p>\n\n<ol>\n<li>The <code>ValidationGroup</code> property of both the button and the <code>CustomValidator</code> are the same</li>\n<li>I tried deleting this property in both the button and the <code>CustomValidator</code>, still does not work.</li>\n</ol>\n\n<p>It seems as there's something formwide. I just put a <code>CustomValidator</code> on the form and do not touch any of its properties other than just setting its <code>ServerValidate</code> event method.</p>\n\n<p>EDIT: Here's the aspx part:</p>\n\n<pre><code> &lt;asp:CustomValidator ID=\"CustomValidator2\" runat=\"server\" \n       ErrorMessage=\"This is a test\" \n   onservervalidate=\"CustomValidator1_ServerValidate\" \n   ValidationGroup=\"PA\"&gt;&lt;/asp:CustomValidator&gt;\n\n\n&lt;asp:Button ID=\"btnPensionersOK\" runat=\"server\" Text=\"OK\" Width=\"75px\" \n          onclick=\"Button1_Click\" ValidationGroup=\"PA\" /&gt;\n</code></pre>\n"},{"tags":["c#","visual-studio-2010","stackoverflow"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":3,"view_count":77,"score":-1,"question_id":13258634,"title":"How to force Visual Studio to ignore 'System.StackOverflowException'?","body":"<p>I've implemented recursive algorithm that can be found under this <a href=\"http://stackoverflow.com/questions/12978253/whats-the-fastest-way-to-find-deepest-path-in-a-3d-array\">link</a>.\nIt works very fine when the 3d array is 10x10x10.</p>\n\n<p>I'm trying to make it run for 200x200x200 array however, Visual Studio says that I might be ussing infinite resursive (I'm pretty sure my prog is OK). Is there any way to handle that? I've tried putting <code>[DebuggerNonUserCode]</code> right before the recursive method, but it haven't worked.</p>\n\n<p>Forgot to mention, it's Visual Studio 2010.</p>\n\n<p>Here's recursive function from my program. I'm running that for every cell, that is marked as Unvisited.</p>\n\n<pre><code>    public static int tmp_lowest_floor = 0;\n    public static int tmp_maks_size = 0;\n\n    static void function1(Point[, ,] array, int pos_y, int pos_z, int pos_x) // recursive function\n    {\n        Point cell = array[pos_y, pos_z, pos_x];\n\n        if (cell.Visited == false &amp;&amp; cell.IsCave)\n        {\n            cell.Visited = true; // changing to visited so we do not count anything for this cell anymore\n            tmp_maks_size++; // increasing for each cell in this cave (in this run)\n\n            if (tmp_lowest_floor &lt; pos_y) { tmp_lowest_floor = pos_y; }\n            cell.FillNeighbourList(array, pos_y, pos_z, pos_x);// adds neighbours into cell's list (max 6) up, down, north, east, south, west\n\n            foreach (Point p in cell.neighbours) // max 6 times recursion in here (I know it sounds horrible, but once I check all the neighbours for a cell, I'll not have to check it ever again)\n            {\n                if (p != null)\n                {\n                    if (p.IsCave == true &amp;&amp; p.Visited == false)\n                    {\n                        function1(tablica, p.pos_y, p.pos_z, p.pos_x);\n                    }\n                }\n            }\n\n        }\n\n    }\n</code></pre>\n\n<p>p.s.\nI know I can do it in a iterative way, however, the homework says it has to be done with recursion</p>\n"},{"tags":["c#","rounding"],"answer_count":3,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":106,"score":7,"question_id":13241245,"title":"When is it beneficial to convert from float to double via decimal","body":"<p>Our existing application reads some floating point numbers from a file. The numbers are written there by some other application (let's call it <em>Application B</em>). The format of this file was fixed long time ago (and we cannot change it). In this file all the floating point numbers are saved as floats in binary representation (4 bytes in the file). </p>\n\n<p>In our program as soon as we read the data we convert the floats to doubles and use doubles for all calculations because the calculations are quite extensive and we are concerned with the spread of rounding errors.</p>\n\n<p>We noticed that when we convert floats via decimal (see the code below) we are getting more precise results than when we convert directly. Note: Application B also uses doubles internally and only writes them into the file as floats. Let's say Application B had the number 0.012 written to file as float. If we convert it after reading to decimal and then to double we get exactly 0.012, if we convert it directly, we get 0.0120000001043081. </p>\n\n<p>This can be reproduced without reading from a file - with just an assignment: </p>\n\n<pre><code>    float readFromFile = 0.012f;\n    Console.WriteLine(\"Read from file: \" + readFromFile); \n    //prints 0.012\n\n    double forUse = readFromFile;\n    Console.WriteLine(\"Converted to double directly: \" + forUse);\n    //prints 0.0120000001043081\n\n    double forUse1 = (double)Convert.ToDecimal(readFromFile);\n    Console.WriteLine(\"Converted to double via decimal: \" + forUse1); \n    //prints 0.012\n</code></pre>\n\n<p>Is it always beneficial to convert from float to double via decimal, and if not, under what conditions is it beneficial?</p>\n\n<p>EDIT: Application B can obtain the values which it saves in two ways:</p>\n\n<ol>\n<li>Value can be a result of calculations</li>\n<li>Value can be typed in by user as a decimal fraction (so in the example above the user had typed 0.012 into an edit box and it got converted to double, then saved to float)</li>\n</ol>\n"},{"tags":["c#","visual-studio","visual-studio-2010","preprocessor"],"answer_count":3,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":255,"score":8,"question_id":10548319,"title":"Can visual studio automatically indent / format preprocessing directives?","body":"<p>Say I want to type this in Visual Studio:</p>\n\n<pre><code>    class Program\n    {\n        private const Byte NUM_THREADS =\n        #if DEBUG\n            1;\n        #else\n            8;\n        #endif\n    }\n</code></pre>\n\n<p>If I simply type it out (i.e. not manually fix any indentation), Visual Studio will format it like this:</p>\n\n<pre><code>    class Program\n    {\n        private const Byte NUM_THREADS =\n#if DEBUG\n 1;\n#else\n        8;\n#endif\n    }\n</code></pre>\n\n<p>Is there anything I can do so it automatically indents so it looks like the first example?</p>\n"},{"tags":["c#","asp.net","resharper","visual-studio-2010-sp1"],"answer_count":4,"favorite_count":0,"up_vote_count":10,"down_vote_count":0,"view_count":2452,"score":10,"question_id":5539131,"title":"Resharper: Cannot resolve symbol 'Eval' in VS2010 SP1","body":"<p>I just installed SP1 for VS2010, and since then I get error messages from Resharper for stuff that used to work and be ok for Resharper (5.1) before.</p>\n\n<p>The error messages are \"Cannot resolve symbol 'Eval'\" and some other methods other than Eval.</p>\n\n<p>How do I solve this?\nIs there a fix?\nIs there some resharper cache that I must delete/clear?</p>\n\n<p>(The code compiles and runs as usual)</p>\n"},{"tags":["c#","enumerations"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":41,"score":-3,"question_id":13261290,"title":"C#: How to preserve enum name with Enum.Parse?","body":"<p>So I have an enum like this... multiple constants with the same value.</p>\n\n<pre><code>public enum Example\n{\n     Example1 = 1,\n     Example2 = 1,\n     Example3 = 2,\n     Example4 = 2,\n}\n</code></pre>\n\n<p>I then try to parse it like so...</p>\n\n<pre><code>Example exampleEnumValue = (Example)Enum.Parse(typeof(Example), \"Example2\");\n</code></pre>\n\n<p>When I then go to check the value of \"exampleEnumValue,\" I get \"Example1,\" or whatever constant from the enum occurs first and has the same value as \"Example2.\"</p>\n\n<p>Is there any way around this?</p>\n"},{"tags":["c#","datagridview","add","rows"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":15,"score":-1,"question_id":13261464,"title":"Adding values to a DataGridView","body":"<p>I'm trying to display the values of an object in a DataGridView, but my code isn't working though it seems to match other code I've found around the net.  Any clues?</p>\n\n<pre><code>foreach (Package p in displayList)\n        {\n            senderDg.Rows.Add(p.SenderName, p.SenderAddress, p.SenderCity,\n                p.SenderState, p.SenderZipCode);\n            recipientsDg.Rows.Add(p.RecipientName, p.RecipientAddress, p.RecipientCity,\n                p.RecipientState, p.RecipientZipCode);\n        }\n</code></pre>\n"},{"tags":["c#"],"answer_count":6,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":383,"score":4,"question_id":3251104,"title":"Is it possible to screenshot a minimized application","body":"<p>I know it's possible to capture a screen of an application that is behind another application, but I can't seem to find anything on capturing the screen of a minimized application.  </p>\n\n<p>Anyone happen to know if this is possible?  I don't want to get into things like maximizing and minimizing the application really quick.</p>\n"},{"tags":["c#","asp.net-mvc","asp.net-mvc-3"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13247207,"title":"How to access selected item from dropdown in asp.net mvc3","body":"<p>i am using asp.net mvc3 and i populate a create view using following model </p>\n\n<p><strong>Model</strong> </p>\n\n<pre><code>public class CategoryModel\n{\n    public  int Id { get; set; }\n    public string Name { get; set; }\n    public  string URL { get; set; }\n    public  string Description { get; set; }\n    public  string Logo { get; set; }\n    public  bool IsActive { get; set; }\n    public  bool isPopular { get; set; }\n    public IList&lt;Category&gt; Parentcategories { get; set; }\n\n}\n</code></pre>\n\n<p>In my create View i populate like this </p>\n\n<p><strong>View</strong></p>\n\n<pre><code> &lt;div class=\"editor-field\"&gt;\n        @Html.DropDownList(\"parentcategories\", new SelectList(Model.Parentcategories.Select(c =&gt; c.Name), Model.Parentcategories.Select(c =&gt; c.Name)))\n        @Html.ValidationMessageFor(model =&gt; model.Parentcategories)\n    &lt;/div&gt;\n</code></pre>\n\n<p>now how can i access the selected item in my controller method </p>\n\n<p><strong>Method</strong></p>\n\n<pre><code> [HttpPost]\n    public ActionResult Create( CategoryModel model , HttpPostedFileBase file)\n    {\n     // \n    }\n</code></pre>\n\n<p>thanks,\nAhsan </p>\n"},{"tags":["c#","sharepoint2010","httpcookie","httpcookiecollection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13261316,"title":"Sharepoint 2010 setting a cookie expiration date seemsto work when viewed from browser but server code sees 01/01/0001 expiration","body":"<p>here is the to add the cookie to the request</p>\n\n<pre><code>    HttpCookie cookie = new HttpCookie(myCookie);\n    cookie.Expires = DateTime.Now.AddDays(30);\n    cookie.Value = myValue;\n    cookie.Domain = myDomain;\n    cookie.HttpOnly = true;\n    response.Cookies.Add(cookie);\n</code></pre>\n\n<p>Seems fine, until during a Sharepoint 2010 context.PostAuthenticateRequest event when i try to read the cookie</p>\n\n<pre><code>    HttpCookieCollection cookies = request.Cookies;\n        HttpCookie tosCookie = cookies.Get(TOS_COOKIE_KEY_ACKNOWLEDGEMENT);\n        tosCookie.Expires\n</code></pre>\n\n<p>i get the date 01/01/0001 when in the browser i see the cookie expiration date as 12/6/2012</p>\n"},{"tags":["c#",".net","httpwebresponse"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":50,"score":-1,"question_id":13261209,"title":"POST format in C#","body":"<p>I have just tried to use post method to send data by HTTPWebresponse but failed. And after I capture the packet, I see lots of data and I totally have no idea which data should be put into POST method. Thank you if anyone could help.</p>\n\n<pre><code>//The following is the packet\n//POST\n   //forum.php?mod=post&amp;action=reply&amp;fid=830&amp;tid=28827301&amp;extra=&amp;replysubmit=yes&amp;infloat=yes&amp;handlekey=fastpost&amp;inajax=1\n  //HTTP/1.1\n  //Accept: text/html, application/xhtml+xml,*/*\n  /*DNT: 1w\n    Referer:http://bbs.down.com/forum.php?mod=viewthread&amp;tid=28827301&amp;page=6\n    Accept-Language: en-US\n    User-Agent: Mozilla/5.0 (compatible; MSIE9.0; Windows NT 6.1; WOW64; Trident/5.0)\n    Content-Type:application/x-www-form-urlencoded\n    Accept-Encoding: gzip, deflate\n    Host: bbs.down.com\n    Content-Length: 59\n    Connection: Keep-Alive\n    Cache-Control: no-cache\n    Cookie: bbs_4477_sid=M1hwrW;\n    bbs_4477_saltkey=1mpZc0Gt; bbs_4477_lastvisit=1351433237;\n    bbs_4477_lastact=1352031022%09forum.php%09viewthread; bbs_4477_forum_lastvisit=D_830_1352030887;\n    bbs_4477_visitedfid=830; bbs_4477_cookietime=1;\n    bbs_4477_auth=3ef7t9KNHlw%2FlGabIXi8MPMY1w5V9EnFvg6jP%2B%2Braqfkg2jvHw;\n    bbs_4477_ulastactivity=f0afkWeLyCDn8PKlB9iw%2FP3PfnFF%2FgqqZ%2BVmQ5a%2FJBkQccZl5eF8;\n    bbs_4477_smile=1D1; bbs_4477_forum_lastpage=830_1; bbs_4477_sendmail=1;\n    bbs_4477_noticeTitle=1; hiido_ui=0.7695972212533371;\n    bbs_4477_fid830=1351953302;\n    Hm_lvt_0475e9919a7ba48887772bb84a8dd9e9=1325583818951;\n    Hm_lvt_899fe607527b6d40d67e743dc3f660e0=1351913248569,1351932413330,1351950688149,1352030891869;\n    Hm_lpvt_899fe607527b6d40d67e743dc3f660e0=1352031022847\n\n    message=test&amp;posttime=1352031022&amp;formhash=ca66c950&amp;subject=*/\n//the following is the code\n        private void button1_Click(object sender, EventArgs e)\n        {\n            HttpWebRequest request = (HttpWebRequest)WebRequest.Create(\"http://bbs.down.com/forum.php?mod=post&amp;action=reply&amp;fid=830&amp;tid=28827301&amp;extra=&amp;replysubmit=yes&amp;infloat=yes&amp;handlekey=fastpost&amp;inajax=1\");  \n            request.CookieContainer = new CookieContainer();  \n            CookieContainer cookie = request.CookieContainer;\n            request.Referer = \"http://bbs.down.com/forum.php?mod=viewthread&amp;tid=28827301&amp;page=6\";\n            request.Accept = \"Accept:text/html, application/xhtml+xml, */*\";  \n            request.Headers[\"Accept-Language\"] = \"en-US\";\n            request.UserAgent = \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)\";  \n            request.KeepAlive = true;  \n            request.ContentType = \"application/x-www-form-urlencoded\";  \n            request.Method = \"POST\";\n            request.Host = \"bbs.down.com\";\n            Encoding encoding = Encoding.UTF8; \n            byte[] postData = encoding.GetBytes(\"message=test&amp;posttime=1351953229&amp;formhash=ca66c950&amp;subject=\");\n            request.ContentLength = postData.Length;  \n            Stream requestStream = request.GetRequestStream();  \n            requestStream.Write(postData, 0, postData.Length);  \n            HttpWebResponse response = (HttpWebResponse)request.GetResponse();  \n            Stream responseStream = response.GetResponseStream();  \n            if (response.Headers[\"Content-Encoding\"] != null &amp;&amp; response.Headers[\"Content-Encoding\"].ToLower().Contains(\"gzip\"))  \n            {  \n                responseStream = new GZipStream(responseStream, CompressionMode.Decompress);  \n            }  \n\n            StreamReader streamReader = new StreamReader(responseStream, encoding);  \n            string retString = streamReader.ReadToEnd();  \n            streamReader.Close();  \n            responseStream.Close();  \n\n            //return retString;  \n</code></pre>\n"},{"tags":["c#","asp.net-mvc","razor"],"answer_count":3,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":13201250,"title":"How to get custom annotation attributes for a controller action in ASP.NET MVC 4?","body":"<p>I am working with a permission based authorization system for my app in ASP.NET MVC. \nFor this I have created a custom authorization attribute</p>\n\n<pre><code>public class MyAuthorizationAttribute : AuthorizeAttribute\n{\n    string Roles {get; set;}\n    string Permission {get; set;}\n}\n</code></pre>\n\n<p>so that I can authorize a user by both role or a specific permission key with annotation for actions like</p>\n\n<pre><code>public class UserController : Controller\n{\n    [MyAuthorization(Roles=\"ADMIN\", Permissions=\"USER_ADD\")]\n    public ActionResult Add()\n\n    [MyAuthorization(Roles=\"ADMIN\", Permissions=\"USER_EDIT\")]\n    public ActionResult Edit()\n\n    [MyAuthorization(Roles=\"ADMIN\", Permissions=\"USER_DELETE\")]\n    public ActionResult Delete()\n}\n</code></pre>\n\n<p>then I override AuthorizeCore() method in MyAuthorizationAttribute class with similar logic(pseudo code)</p>\n\n<pre><code>protected override bool AuthorizeCore(HttpContextBase httpContext)\n{\n    if(user not authenticated)\n        return false;\n\n    if(user has any role of Roles)\n        return true;\n\n    if(user has any permission of Permissions)\n        return true;\n\n    return false;\n}\n</code></pre>\n\n<p>Up to this is working fine. </p>\n\n<p>Now I need some sort of extension methods so that I can dynamically generate action url in view pages that will return action url based on MyAuthorization attribute authorization logic for the given action. Like</p>\n\n<pre><code>@Url.MyAuthorizedAction(\"Add\", \"User\")\n</code></pre>\n\n<p>will return url to \"User/Add\" if user has admin role or has permission of \"USER_ADD\" (as defined in attributes for the action) or return empty string otherwise.</p>\n\n<p>But after searching in internet for few days I could not figure it out. :(</p>\n\n<p>So far I have found only this <a href=\"http://stackoverflow.com/questions/2721869/security-aware-action-link/2722026\">&quot;Security aware&quot; action link?</a> which works by executing all action filters for the action until it fails.</p>\n\n<p>It's nice, but I think it would be an overhead to execute all the action filters for each time I call the MyAuthorizedAction() method. Besides It also didn't work with my version (MVC 4 and .NET 4.5)</p>\n\n<p>What all I need is to check authenticated user's role, permissions (will be stored in session) against authorized role and permission for the given action. Like something as following (pseudo code)</p>\n\n<pre><code>MyAuthorizedAction(string actionName, string controllerName)\n{\n    ActionObject action = SomeUnknownClass.getAction(actionName, controllerName)\n    MyAuthorizationAttribute attr = action.returnsAnnationAttributes()\n\n    if(user roles contains any in attr.Roles \n       or \n       user permissions contains any attr.Permissions)\n    {\n        return url to action\n    }\n    return empty string\n}\n</code></pre>\n\n<p>I am searching the solution of getting action attributes value for quite a long time, could not find enough good resources at all. Am I missing out right keywords? :/</p>\n\n<p>If anyone can provide me the solution that would be truly a great help.\nThanks in advance for the solutions</p>\n"},{"tags":["c#","asp.net","content-management-system","sitecore","sitecore6"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13261332,"title":"Sitecore tree expand event handler","body":"<p>Does anyone know which event/pipeline/command I can hook into when someone clicks on a item node to expand the tree?</p>\n"},{"tags":["c#","subtraction","subtract"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":30,"score":-4,"question_id":13260954,"title":"C# code for subtracting column values","body":"<p>I got a datagridview that has several columns, but I'm interested in doing subtract calculation in only one column, that will have indefinite amount of entries over time (either because there are being written more, or different subjects have different amount of data). So I'd like to subtract the very first entry in that column from the last one, like I have illustrated on the Print Screen image, that you can see here:</p>\n\n<p><img src=\"http://img203.imageshack.us/img203/6749/samplex.jpg\" alt=\"Example\"></p>\n"},{"tags":["c#","tcp","network-programming"],"answer_count":1,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13260960,"title":"Network Programming : receiving image file in dynamic Image Object in TCP client server","body":"<p>um use this code to store a received Image in the Hard disk Memory <br>\ni try to edit this code to store the received Image file in dynamic Image Object with out storing in the Hard disk Memory </p>\n\n<pre><code>    private void StartReceiving()\n    {\n        try\n        {\n              string hstServer = Dns.GetHostName();\n             IPAddress ipaLocal =\"127.0.0.1\";\n\n\n            if (tlsServer == null)\n            {\n                tlsServer = new TcpListener(ipaLocal, Convert.ToInt32(txtPort.Text));\n            } \n            tlsServer.Start(); \n            TcpClient tclServer = tlsServer.AcceptTcpClient(); \n            strRemote = tclServer.GetStream(); \n            int bytesSize = 0;\n            byte[] downBuffer = new byte[2048];\n            bytesSize = strRemote.Read(downBuffer, 0, 2048);\n           FileName = System.Text.Encoding.ASCII.GetString(downBuffer, 0, bytesSize);\n           try\n           {\n               strLocal = new FileStream(FileName, FileMode.Create, FileAccess.Write, FileShare.ReadWrite);\n           }catch(Exception exp)\n           {\n               strLocal = new FileStream(FileName.Substring(0,5), FileMode.Create, FileAccess.Write, FileShare.ReadWrite);\n           }\n            downBuffer = new byte[2048];\n\n            bytesSize = strRemote.Read(downBuffer, 0, 2048);\n\n            downBuffer = new byte[2048];\n\n            while ((bytesSize = strRemote.Read(downBuffer, 0, downBuffer.Length)) &gt; 0)\n            {\n                strLocal.Write(downBuffer, 0, bytesSize);\n            }\n\n        }\n        finally\n        {\n            strLocal.Close();\n            strRemote.Close();\n\n        }\n    }\n</code></pre>\n\n<p>edit by using CopyTo in .net 4 </p>\n\n<pre><code>            tlsServer.Start(); \n            TcpClient tclServer = tlsServer.AcceptTcpClient();\n           tclServer.GetStream().CopyTo(ms);\n\n            //Get the image out of the stream\n            Image img = Image.FromStream(ms);\n\n\n        }\n        finally\n        {\n            m = Image.FromStream(strLocal);\n            strLocal.Close();\n            strRemote.Close();\n\n        }\n</code></pre>\n"},{"tags":["c#","linq-to-sql","datacontext","transactionscope","submitchanges"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13261299,"title":"DataContext.Submit and TransactionScope","body":"<p>Please explain me pseudocode below.</p>\n\n<p>My idea is: 3-nd SubmitChanges will commit o.Status and will not commit o.TransactionId, and my object will get corrupted in database (I mean it will not be consistent anymore).</p>\n\n<pre><code>XDataContext DB = .....; \nXOrder o = DB.XOrders.Single(.......);\n\ntry\n{\n    using (var t = new TransactionScope())\n    {\n        o.Status = XOrderStatus.Completed;\n        DB.SubmitChanges(); // 1\n        string s = null;\n        s.Trim(); // crash here;\n        o.TransactionId = ......; // some calculations here\n        DB.SubmitChanges(); // 2\n        t.Complete();\n    }\n}\ncatch (Exception ex)\n{\n    XEvent e = new XEvent();\n    e.Type = XEventType.Exception;\n    e.Data = .........; // some calculations here\n    DB.XEvents.InsertOnSubmit(e);\n    DB.SubmitChanges(); // 3\n}\n</code></pre>\n\n<p>Is it any 'best practices' for my case?</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13259816,"title":"Editable combobox with valid selection","body":"<p>I have a editable combobox in WPF (IsEditable=True). I would also like to ensure that the values which the user enters are in the list only. I don't want user to add their own values to the combo. I cannot make IsReadonly=true as that will not allow users to type. So is validation the only option in SelectionChange event? or is there a better way to do the same?</p>\n\n<p>Thanks\nShankara Narayanan.</p>\n"},{"tags":["c#","email","oauth","linkedin","hammock"],"answer_count":5,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":189,"score":1,"question_id":12860359,"title":"Retrieve Linkedin email address","body":"<p>I'm using the Hammock library and C# to get the basic profile and email address of user from linked in following post <a href=\"http://ovaismehboob.wordpress.com/2011/09/12/linkedin-authentication-in-asp-net/\" rel=\"nofollow\">here</a> . </p>\n\n<p>I've also followed these posts <a href=\"http://mrsarker.wordpress.com/2011/08/20/linkedin-rest-api-in-asp-net-mvc/\" rel=\"nofollow\">here</a> and <a href=\"http://www.suddenelfilio.net/2010/08/24/linkedin-oauth-using-hammock-in-csharp-asp-net/\" rel=\"nofollow\">here</a></p>\n\n<p>However for the life of me I cannot get the email address of the linkedin user. </p>\n\n<p>Reading <a href=\"https://developer.linkedin.com/forum/can-we-get-email-address\" rel=\"nofollow\">this</a> linkedin post I got new created a new application to get new keys however still no luck.</p>\n\n<p>Went through <a href=\"http://developer.linkedin.com/forum/permission-scope-request-token-query-not-working\" rel=\"nofollow\">this</a> linkedin post but could not get it to work either</p>\n\n<p>I'm posting the code below but it's heavily lifted form the links I followed</p>\n\n<pre><code>var credentials = new OAuthCredentials\n            {\n\n                CallbackUrl = \"http://localhost:2715/Callback.aspx\",\n\n                ConsumerKey = \"my consumer key\",//not shown\n\n                ConsumerSecret = \"my consumer secret\",//not shown\n\n                Type = OAuthType.RequestToken,\n\n            };\n\n\n        var client = new RestClient\n            {\n                Authority = \"https://api.linkedin.com/uas/oauth\",\n                Credentials = credentials\n            };\n\n        //var scope = HttpUtility.UrlEncode(\"r_basicprofile r_emailaddress\");\n\n        var request = new RestRequest\n                        {\n                            Path = \"requestToken?scope=r_basicprofile+r_emailaddress\",\n                        };\n</code></pre>\n\n<p>I get this screen when user navigates to linkedin.</p>\n\n<p><img src=\"http://i.stack.imgur.com/mg5x9.png\" alt=\"enter image description here\"></p>\n\n<p>To actually request the email I use this code below</p>\n\n<pre><code> var request = new RestRequest { Path = \"people/~/email-address\" };\n\n        var credentials = new Hammock.Authentication.OAuth.OAuthCredentials\n\n        {\n\n            Type = OAuthType.AccessToken,\n\n            SignatureMethod = OAuthSignatureMethod.HmacSha1,\n\n            ParameterHandling = OAuthParameterHandling.HttpAuthorizationHeader,\n\n            ConsumerKey = \"my consumer key\", //not shown\n\n            ConsumerSecret = \"my consumer secret\", //not shown\n\n            Token = Session[\"AccessToken\"].ToString(),\n\n            TokenSecret = Session[\"AccessSecretToken\"].ToString(),\n\n            Verifier = Session[\"Verifier\"].ToString()\n\n        };\n\n\n        var client = new RestClient()\n        {\n            Authority = \"http://api.linkedin.com/v1/\",\n            Credentials = credentials,\n            Method = WebMethod.Get\n        };\n\n\n        var MyInfo = client.Request(request);\n\n        String content = MyInfo.Content;\n</code></pre>\n\n<p>This is the error I get on MyInfo.Content</p>\n\n<p><img src=\"http://i.stack.imgur.com/nzTSY.png\" alt=\"enter image description here\"></p>\n\n<p>Thanks in advance for your help.</p>\n\n<p>On trying Kamyar's suggestion I get the following error message. What else should I try?</p>\n\n<p><img src=\"http://i.stack.imgur.com/MA619.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","sql-server","tsql","clr","jit"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":68,"score":-2,"question_id":13260889,"title":"Why does T-SQL run so slowly?","body":"<p>At work, we've got a program with MS SQL Server database backend.  There are a handful of places where we use CLR UDFs, not to provide new functionality, but for performance reasons.  They are doing things that we could do just as well in T-SQL, but an order of magnitude or two faster.  And that just makes me wonder.</p>\n\n<p>Why is it that expressing the exact same concept in one language that runs off a parser built by Microsoft (C#) executes so much more quickly than expressing it in another language that runs off a parser built by Microsoft (T-SQL)?  If anything, I would expect the CLR UDFs to be <em>slower</em>, because the native SQL data being worked on has to be marshaled into the CLR functions and back, which ought to introduce some overhead.</p>\n\n<p>Is there any particular reason why MS SQL Server queries are (apparently) not JITed and executed as quickly as possible?  And I could understand the overhead of JIT compilation possibly being an issue for external queries, but we see the same thing even in stored procedures, where compilation would definitely make sense.</p>\n"},{"tags":["c#","asp.net","winforms","logging","log4net"],"answer_count":9,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":7533,"score":6,"question_id":2898120,"title":"Creating a new log file each day","body":"<p>As the title implies how can I create a new log file each day in C#? Now the program may not necessarily run all day and night but only get invoked during business hours. So I need to do two things.</p>\n\n<ol>\n<li>How can I create a new log file each day? The log file will be have the name in a format like MMDDYYYY.txt</li>\n<li>How can I create it just after midnight in case it is running into all hours of the night?</li>\n</ol>\n"},{"tags":["c#","extension-methods"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":756,"score":1,"question_id":1831072,"title":"Extension Method to return random alphabet","body":"<p>How to develop an extension method that may return random character(single character) from alphabet (a,b,....z).</p>\n\n<pre><code>public static char RandomLetter(this char randomchar)\n{\n\n}\n</code></pre>\n"},{"tags":["c#","iis7","iis-7.5","wmi","adsi"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13144657,"title":"How to enable/disable/get status for extended protection for authentication in IIS using WMI/ADSI and C#?","body":"<p>Can someone provide a code sample or resource which can help me programatically <strong>get status, enable and disable</strong> extended protection for authentication in IIS 7/IIS 7.5 using C#?</p>\n\n<p>C# with WMI/ADSI is preferred. </p>\n\n<p>i.e I am asked to use <strong>System.Management</strong> API or <strong>Microsoft.Web.Administration</strong> API using C# and i need to determine if <strong>EAP is enabled or not on a web server level</strong> (as web server default for all future websites).</p>\n\n<p>Any other solution using C# is also welcome.</p>\n\n<p>Looking forward to helpful answers. Thanks</p>\n\n<p>Steve</p>\n"},{"tags":["c#","windows-mobile","compact-framework","smartdevice"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":653,"score":2,"question_id":2533266,"title":"SmartDevice application hide on startup","body":"<p>I made a <code>SmartDevice</code> application runs on startup and it should be hidden at first time launch.</p>\n\n<p>I've tried <code>this.Hide()</code>, <code>this.Visible = false</code> and <code>ShowWindow(Handle, SW_HIDE)</code> in Form <code>Load()</code> event and <code>InitializeComponent()</code> with no luck.</p>\n\n<p>Anyone can help?</p>\n"},{"tags":["c#","encryption","hash","md5"],"answer_count":5,"favorite_count":2,"up_vote_count":10,"down_vote_count":0,"view_count":4853,"score":10,"question_id":2435695,"title":"Converting a md5 hash byte array to a string","body":"<p>How can I convert the hashed result, which is a byte array, to a string?</p>\n\n<pre><code>byte[] bytePassword = Encoding.UTF8.GetBytes(password);\n\nusing (MD5 md5 = MD5.Create())\n{\n    byte[] byteHashedPassword = md5.ComputeHash(bytePassword);\n} \n</code></pre>\n\n<p>I need to convert <code>byteHashedPassword</code> to a string. </p>\n"},{"tags":["c#",".net","linq","collections"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":2,"view_count":47,"score":-2,"question_id":13261060,"title":"Condition in the LINQ","body":"<p>I have collection (list) of strings and I want to write LINQ lambda expression in C#.\nIf I have only one element in the List, return only that element, but if I have more than one element, return me all other elements except that one which is equals to \"Blue\").\nThanks for your help.</p>\n"},{"tags":["c#",".net","c#-4.0","json.net"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":117,"score":2,"question_id":12381636,"title":"Why is JSON.NET is not working with inheritance while deserializing","body":"<p>I am deserializing the JSON string to root object by using the following class which works fine .</p>\n\n<pre><code>[Serializable]\n    public class MoviesListRootObject\n    {\n        public int count { get; set; }\n        public Pagination pagination { get; set; }\n        public List&lt;Response&gt; response { get; set; }\n    }\n</code></pre>\n\n<p>...................................  </p>\n\n<pre><code>var json = wc.DownloadString(jsonRequestURL);\nvar rootObj = JsonConvert.DeserializeObject&lt;MoviesListRootObject&gt;(json);\n</code></pre>\n\n<p>But if I am generalizng the root object bt creating parent class and then inheriting from it , then I get null after deserialization!!!!</p>\n\n<pre><code>[Serializable]\n    public class RootObject\n    {\n        public int count { get; set; }\n        public Pagination pagination { get; set; }\n    }\n\n[Serializable]\n    public class MoviesListRootObject:RootObject\n    {\n        public List&lt;MovieResponse&gt; movieResponse { get; set; }\n\n    }\n</code></pre>\n\n<p>..............................................</p>\n\n<pre><code> var json = wc.DownloadString(jsonRequestURL);\n var rootObj = JsonConvert.DeserializeObject&lt;MoviesListRootObject&gt;(json);\n</code></pre>\n"},{"tags":["c#","wpf","codebehind","attached-properties"],"answer_count":3,"favorite_count":5,"up_vote_count":26,"down_vote_count":0,"view_count":12184,"score":26,"question_id":541420,"title":"How to I access an attached property in code behind?","body":"<p>I have a rectangle in my XAML and want to change its <code>Canvas.Left</code> property in code behind:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;UserControl x:Class=\"Second90.Page\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" \n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\" \n    Width=\"400\" Height=\"300\" KeyDown=\"txt_KeyDown\"&gt;\n    &lt;Canvas&gt;\n        &lt;Rectangle \n            Name=\"theObject\" \n            Canvas.Top=\"20\" \n            Canvas.Left=\"20\" \n            Width=\"10\" \n            Height=\"10\" \n            Fill=\"Gray\"/&gt;\n    &lt;/Canvas&gt;\n&lt;/UserControl&gt;\n</code></pre>\n\n<p>But this doesn't work:</p>\n\n<pre><code>private void txt_KeyDown(object sender, KeyEventArgs e)\n{\n    theObject.Canvas.Left = 50;\n}\n</code></pre>\n\n<p>Does anyone know what the syntax is to do this?</p>\n"},{"tags":["c#","asp.net-mvc"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":33,"score":-5,"question_id":13259741,"title":"Fileupload control display","body":"<p>how do we need to code a fileupload control so that it appears same in all browsers. Each browser shows the fileupload button in different ways. How do we need to code the CSS so that it displays the same in all browsers.</p>\n"},{"tags":["c#","messagebox","cross-threading","synchronizationcontext"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13260891,"title":"is it possible to return a value with synchronizationcontext .send","body":"<p>We have a need to use SynchronizationContext to return a value (specifically a MessageBox DialogResult) via Send (we don't want asynch via 'Post'). Just not sure of the syntax.\nWe were having issues with MessageBox appearing behind main window which was thought to be caused by not being able to access the main forms IWin32Window value easily...We're using this, but to be honest I'm uncomfortable with it. </p>\n\n<pre><code> DialogResult dr;\n SynchronizationContext synchContext;\n\n //in main forms constructor\n  {\n       ...\n       synchContext = AsyncOperationManager.SynchronizationContext;\n  }\n\n void workerThread( object obj, DoWorkEventArgs args)\n {\n\n   // SynchronizationContext passed into worker thread via args\n   sc.Send( delegate {dr = MessageBoxEx.Show( \"Yes or no?\", \"Continue?\",   MessageBoxButtons.OKCancel, MessageBoxIcon.Question );},null);\n }\n</code></pre>\n"},{"tags":["c#","list","extension-methods","reverse","shuffle"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13261135,"title":"How is sample2 code different from sample1 code?","body":"<p>I have the following shuffle extension method,</p>\n\n<pre><code>    //from http://stackoverflow.com/a/13255957/677607\n    //Fisher-Yates_shuffle http://en.wikipedia.org/wiki/Fisher-Yates_shuffle\n\n    private static readonly ThreadLocal&lt;Random&gt; RandomThreadLocal = new ThreadLocal&lt;Random&gt;(() =&gt; new Random());\n    public static void Shuffle&lt;T&gt;(this IList&lt;T&gt; list, int seed)\n    {\n        list.Shuffle(new Random(seed));\n    }\n\n    public static void Shuffle&lt;T&gt;(this IList&lt;T&gt; list)\n    {\n        list.Shuffle(null);\n    }\n\n    public static void Shuffle&lt;T&gt;(this IList&lt;T&gt; list, Random rand)\n    {\n        var r = rand ?? RandomThreadLocal.Value;\n\n        var len = list.Count;\n        for (var i = len - 1; i &gt;= 1; --i)\n        {\n            var j = r.Next(i);\n            var tmp = list[i];\n            list[i] = list[j];\n            list[j] = tmp;\n        }\n    }\n</code></pre>\n\n<p>I have the following button click which works well,</p>\n\n<p><strong>Sample1:</strong></p>\n\n<pre><code>    private async void button1_Click(object sender, RoutedEventArgs e)\n    {\n         await Task.Factory.StartNew(words.Sort);\n         await Task.Factory.StartNew(words.Reverse);\n         await Task.Factory.StartNew(() =&gt; words.Shuffle());\n    }\n</code></pre>\n\n<p>but the following doesn't work,</p>\n\n<p><strong>Sample2:</strong></p>\n\n<pre><code>    private async void button1_Click(object sender, RoutedEventArgs e)\n    {\n         await Task.Factory.StartNew(words.Sort);\n         await Task.Factory.StartNew(words.Reverse);\n         await Task.Factory.StartNew(words.Shuffle);\n    }\n</code></pre>\n\n<p>it raises an exception,</p>\n\n<pre><code>    Common Language Runtime detected an invalid program.\n    System.InvalidProgramException\n</code></pre>\n\n<p>could someone explain why, </p>\n\n<p><code>await Task.Factory.StartNew(words.Sort);</code> and</p>\n\n<p><code>await Task.Factory.StartNew(words.Reverse);</code> works and </p>\n\n<p><code>await Task.Factory.StartNew(words.Shuffle)</code> doesn't work but only </p>\n\n<p><code>await Task.Factory.StartNew(() =&gt; words.Shuffle());</code> works for Shuffle extension method? Whats the difference?</p>\n\n<p>I am testing this in <strong>Visual Studio 2010</strong> and <strong>Async CTP Library</strong>.</p>\n"},{"tags":["c#","webbrowser-control"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13261101,"title":"Alternative to FiddlerCore? Or a Better Webbrowser Control?","body":"<p>Hello guys I have an issue bugging me for the past few weeks. </p>\n\n<p>What I'm trying to accomplish: I need a webbrowser control with the ability to change user agent (once at start) and referrer. But most important The ability to see the urls responses. What I mean by that for example if you navigate to a website you get back Images/Javascripts files in response I need access to those urls (Regular Webbrowser Control will not show you those &amp; you can't access it in any way). </p>\n\n<p>I was able to do that with webbrowser + fiddlercore I can see and do what ever with those urls addresses. The problem was if you run few instances of this program (or sometimes once if the program has some automation to work with the url responses) It gets stuck or doesn't work. I tried fixing it and making it work but it's kind of a hacky solution that doesn't work right. I need a simple way to access those urls just as if you used httpwebrequest but as a webbrowser. Why I need it as a webbrowser? The way I work I need the execution of all the tracking pixels and scripts and images etc.. a normal webbrowser behaivor in httpwebrequest if you want google analytics you have to create a code to re create it, you can't just navigate and all the scripts will be execute as webbrowser, or can you? </p>\n\n<p>can you guys can offer me some help or guide me in what direction should I look? \nThanks a lot!</p>\n"},{"tags":["c#","casting"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":23,"score":-1,"question_id":13260964,"title":"Cast to Int from a VB Collection","body":"<p>Do you see wrong code in here? I am getting a InvalidCaseException on the foreach loop that is using an INT variable:</p>\n\n<pre><code> Microsoft.VisualBasic.Collection oHeaders = GetFieldIdsByName(msREPORT_HEADER);\n\nforeach (int FieldId in oHeaders)\n</code></pre>\n"},{"tags":["c#",".net"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13260951,"title":"How to proxy a REST API with .NET 4","body":"<p>I'm trying to write a simple, pass-through proxy in .NET.</p>\n\n<p>I have a REST api hosted at some external domain (http://exampleapi.com),</p>\n\n<p>And I want to pass through all requests sent to my application (get, post, etc). JSONP isn't an option.</p>\n\n<p>So if I ask for  <code>GET localhost:1234/api/pages</code>  =>  <code>GET http://exampleapi.com/pages</code>\nLikewise if I <code>POST localhost:1234/api/pages</code>  =>  <code>POST http://exampleapi.com/pages</code></p>\n\n<p>The big problem I have, and what I can't seem to find elsewhere - is that I <em>don't</em> want to parse this JSON. Everything I've searched through seems to center around <code>HttpClient</code>, but I can't seem to figure out how to use it correctly.</p>\n\n<p>Here's what I have so far:</p>\n\n<pre><code>public ContentResult Proxy()\n{\n    // Grab the path from /api/*\n    var path = Request.RawUrl.ToString().Substring(4);\n    var target = new UriBuilder(\"http\", \"exampleapi.com\", 25001);\n    var method = Request.HttpMethod;\n\n    var client = new HttpClient();\n    client.BaseAddress = target.Uri;\n\n    // Needs to get filled with response.\n    string content;\n\n    HttpResponseMessage response;\n    switch (method)\n    {\n        case \"POST\":\n        case \"PUT\":\n            StreamReader reader = new StreamReader(Request.InputStream);\n            var jsonInput = reader.ReadToEnd();\n\n            // Totally lost here.\n            client.PostAsync(path, jsonInput);\n\n            break;\n        case \"DELETE\":\n            client.DeleteAsync(path);\n            break;\n        case \"GET\":\n        default:\n            // need to capture client data\n            client.GetAsync(path);\n            break;\n    }\n\n    return Content(content, \"application/json\");\n}\n</code></pre>\n"},{"tags":["c#",".net","winforms"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":78,"score":0,"question_id":13242945,"title":"converting textbox string to int","body":"<p>I'm trying to compare and multiply 2 random number variables with the int value entered in textboxes. If it is the correct increment the correct answers it does not increase the number although it increment works alone but it does not work with the textbox.</p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n{\n    int x = Randomnumber.Next(12);\n    int z = Randomnumber.Next(12);\n\n    //int cv = +correct;\n    textBox2.Text = x.ToString();\n    textBox3.Text = z.ToString();\n\n    int s = x * z;\n    if (s == int.Parse(textBox4.Text))\n    {\n        correct++;\n        numbercorrect.Text = correct.ToString();\n    }\n}\n</code></pre>\n"},{"tags":["c#"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":64,"score":0,"question_id":13260771,"title":"How to solve the following method issue in c#","body":"<p>I have this in my main:</p>\n\n<pre><code>static void Main(string[] args)\n    {\n        Money m1 = new Money(2315.99);\n\n        Money m2 = new Money(4000, 25);\n\n        Console.WriteLine(m1);\n        Console.WriteLine(m2);\n\n        Console.WriteLine(m1.IncrementMoney(m2));\n    }\n\n\n\n    public void IncrementMoney(Money x)\n    {\n        //what do I put in here?\n    }\n</code></pre>\n\n<p>So\n <br/><code>Money m1 = new Money(2315.99);</code><br/> is supposed to turn 2315.99 into \"$2315.99\"</p>\n\n<p>and </p>\n\n<p><code>Money m2 = new Money(4000, 25);</code><br/> forms \"$4000.25\"</p>\n\n<p>I have all that done in Money class and it works fine.            </p>\n\n<p>Now what I'm supposed to do is add those two together using \n     <br/>       <code>m1.IncrementMoney(m2);</code></p>\n\n<p>This is my \"Money\" class</p>\n\n<pre><code>class Money\n{\n\n    //instance variables\n    private int dollars;\n    private int cents;\n\n\n    double amount;\n\n\n    public int Dollars\n    {\n        get { return dollars; }\n        set\n        {\n            if (value &gt; 0)\n                dollars = value;\n        }\n    }\n\n\n\n    public int Cents\n    {\n        get { return cents; }\n        set\n        {\n            if (value &gt; 0)\n                cents = value;\n        }\n    }\n\n\n\n    public Money(int Dol, int Cen)\n    {\n        Dollars = Dol;\n        Cents = Cen;\n\n        double Dollar = Convert.ToDouble(Dollars);\n        double Cent = Convert.ToDouble(Cents);\n\n        amount = Dollar + (Cent / 100);\n\n    }\n\n\n    public Money(double am)\n    {\n        int dol = Convert.ToInt32(am);\n\n        if (dol &gt; am)\n            Dollars = dol - 1;\n\n        else if (dol &lt; am)\n            Dollars = dol;\n        //Dollars\n\n        double cen = am % 1;\n\n        cen = cen * 100;\n\n        Cents = Convert.ToInt32(cen);\n        //Cents\n\n        double Dollar = Convert.ToDouble(Dollars);\n        double Cent = Convert.ToDouble(Cents);\n\n        amount = Dollar + (Cent / 100);\n    }\n\n    //override ToString()\n    public override string ToString()\n    {\n        return string.Format(\"{0:c}\", amount);\n    }\n\n\n}//end class Money\n</code></pre>\n\n<p>But I have no idea what to put into the <code>IncrementMoney</code> method. <br/>Please help?\n<br/>and if not too much trouble, maybe a little insight to how it works? I'd really like to know.</p>\n\n<p>Sorry if I didn't give enough info,\n<br/>If anything else is required please let me know.\n<br/>and thanks!</p>\n"},{"tags":["c#","service","xmlhttprequest"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":54,"score":3,"question_id":13260691,"title":"Best Practice: Converting an application to a service with a schedule","body":"<p>I'm a bit of a beginner as far as programming is concerned. And looking at stack overflow I haven't found anything that quite answers my question. \nI have created a C# console application that is used to push an XML file to a web service that I don't control. It does this by creating an http webrequest. The service will probably be running on windows server 2008, or a win 7 varient. Development is done in VS 2010.\nMy end goal is to run this program twice a day with little user involement. And I was told that services were the best way to do this. I know that services do not take user input and that outputs are usually to a log file. My console app dosn't take user input but must have the ability to C.R.U.D. files. Beacuse it creates and then reads an XMl file into the web request. If needed I should have no problems having it write any errors to a log file, but at current though it creates/sends an error report via email. </p>\n\n<p>I have 2 questions:</p>\n\n<p>Question 1:\nI would like this service to call the application every 12 hours, Is it more reliable/better practice to use a service to determine when to run the application? Or use windows' built in scheduler, or a .net solution like quark? I'm looking for reliability and also, little user involvement. Kind of a set and forget deal.</p>\n\n<p>Question 2: \nWhat would the suggested  best practice be for converting my program?\nINFO: I have previously created a empty windows service that I would like to fold my application into. (This was done via tutorial, the service contains all that is needed to for a service but it dosn't do anything... yet! OnStart, OnStop, installer etc.) What would be the best way to do it? Should I call my application inside the service's OnStart() method? Our should I add the application as a dll to the service. It's not that I don't think I could do it. It's just my searches on the matter seem to point out that it would be better to just start from a service and add some code to that. My goal would be to minimise the code needed to convert this application.</p>\n\n<p>Thanks for all your help,\nChris </p>\n"},{"tags":["c#","inheritance","serialization","xml-serialization"],"answer_count":7,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":3993,"score":6,"question_id":1708924,"title":".NET XML Serialization and inheritance","body":"<p>I have structure like this:</p>\n\n<pre><code>public interface A\n{\n    public void method();\n}\n\npublic class B : A\n{\n}\n\npublic class C : A\n{\n}\n\nList&lt;A&gt; list;\n</code></pre>\n\n<p>List contains objects of type B and C they also have some fields that I would like to keep, can I now serialize it, deserialize back and get the proper object instances? \nPreferably to XML</p>\n\n<p>EDIT:</p>\n\n<p>Is there any simple way to serialize this list that contains interfaces, and then deserialize it back to B and C instances?</p>\n"},{"tags":["c#","compact-framework","sql-server-ce"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":665,"score":0,"question_id":3152248,"title":"problem with sql server compact 3.5 and smart device project","body":"<p>Recently i downloaded SQLServer Compact 3.5 from Microsoft web site, and i have already installed Visual Studio 2008.\nWhen i make a new Smart Device project and try to connect some Dataset to local database, the following error rises :\n\"Error  1   Custom tool error: This operation requires a reference to SQL Server Compact 3.5. The project has a reference to a different version. Update the reference and try again.\"</p>\n\n<p>i tried reinstalling  Visual Studio 2008, but it did not work.</p>\n"},{"tags":["c#","asp.net","vb.net","visual-studio","webforms"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":28,"score":0,"question_id":13260995,"title":"How to get a collection of page elements?","body":"<p>On Page_Init, I check if Button1 was pressed, if so I create a series of LiteralControls in a Panel, called Panel1:</p>\n\n<pre><code>   Panel1.Controls.Add(new LiteralControl(\"&lt;table&gt;\"));\n\n   Panel1.Controls.Add(new LiteralControl(\"&lt;tr&gt;\"));\n   Panel1.Controls.Add(new LiteralControl(\"&lt;td&gt;Header 1&lt;/td&gt;\"));\n   Panel1.Controls.Add(new LiteralControl(\"&lt;td&gt;Header 2&lt;/td&gt;\"));\n   Panel1.Controls.Add(new LiteralControl(\"&lt;td&gt;Header 3&lt;/td&gt;\"));\n   Panel1.Controls.Add(new LiteralControl(\"&lt;/tr&gt;\"));\n\n   Panel1.Controls.Add(new LiteralControl(\"&lt;tr&gt;\"));\n   Panel1.Controls.Add(new LiteralControl(\"&lt;td&gt;Data 1&lt;/td&gt;\"));\n   Panel1.Controls.Add(new LiteralControl(\"&lt;td&gt;Data 2&lt;/td&gt;\"));\n   Panel1.Controls.Add(new LiteralControl(\"&lt;td&gt;&lt;input type=\\\"text\\\" name=\\\"txtCode3\\\"&gt;&lt;/td&gt;\"));                \n   Panel1.Controls.Add(new LiteralControl(\"&lt;/tr&gt;\"));\n\n   Panel1.Controls.Add(new LiteralControl(\"&lt;/table&gt;\"));\n</code></pre>\n\n<p>I have a second button, that on click, I want to fill a NameValueCollection (or any other list) with all table cell elements (or values).</p>\n\n<p>How can I do this?\nI've tried:</p>\n\n<pre><code>protected void Button2_Click(object sender, EventArgs e)\n    {\n             NameValueCollection coll = Request.Form;\n    }\n</code></pre>\n\n<p>But this only gives me:</p>\n\n<pre><code>AllKeys:\n    [0] \"_VIEWSTATE\"\n    [1] \"_EVENTVALIDATION\"\n    [2] \"Button2\"\n    [3] \"txtCode3\"\n</code></pre>\n\n<p>As you can see, I can't get all cell elements.\nI should get:</p>\n\n<pre><code>AllKeys:\n    [0] \"_VIEWSTATE\"\n    [1] \"_EVENTVALIDATION\"\n    [2] \"Button2\"\n    [3] Header 1\n    [4] Header 2\n    [5] Header 3\n    [6] Data 1\n    [7] Data 2\n    [3] \"txtCode3\"\n</code></pre>\n\n<p>Thank you.</p>\n"},{"tags":["c#","visual-studio-2012"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":41,"score":-1,"question_id":13260788,"title":"Can´t add item to ListBox in different form","body":"<p>I´m trying to build an application that can store different persons in a ListBox-control. </p>\n\n<p>My ListBox-control is located in <strong>Form1</strong> and so is this method that´s giving me some problem:</p>\n\n<pre><code>  public void addPersonToList(Person person) {\n            string newPerson = person.firstName + \" \" + person.lastName + \" \" + person.age;\n\n            personList.Items.Add(newPerson);\n\n }\n</code></pre>\n\n<p>In another Form, I call the addPersonsToList-method like this:</p>\n\n<pre><code>Form1 form1 = new Form1();\n  form1.addPersonToList(person);\n</code></pre>\n\n<p>Now, I´ve checked (while debugging) that the string <strong>newPerson</strong> in addPersonToList actually stores the correct string. <strong>The problem is that the string won´t show up in my ListBox</strong>(named personList).</p>\n\n<p>Any suggestions? </p>\n"},{"tags":["c#","database","entity-framework","ef-code-first","foreign-keys"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":72,"score":3,"question_id":13260306,"title":"Entity Framework 5: Code-First Cyclical Relationship Issues","body":"<p>I understand why EF does not allow \"cyclical references\" in the PK/FK relationships. I am looking for advice on how to alter my model to make the following scenario work.</p>\n\n<h3>Scenario</h3>\n\n<p>Three entities: <code>Employee</code>, <code>Agency</code>, <code>WorkRecord</code>. Their purpose is to log Employee time spent doing work. <code>Employee</code> then contains reference to the <code>Agency</code> he/she is employed by, and his/her <code>WorkRecord</code> contain reference to the <code>Agency</code> the work was done for.</p>\n\n<pre><code>public class Employee\n{\n    [Key]\n    public int Id { get; set; }\n\n    public string Name { get; set; }\n\n    public int AgencyId { get; set; }\n    public virtual Agency Agency { get; set; }\n\n    public virtual IEnumerable&lt;WorkRecord&gt; WorkRecords { get; set; }\n}\n\npublic class Agency\n{\n    [Key]\n    public int Id { get; set; } \n}\n\npublic class WorkRecord\n{\n    [Key]\n    public int Id { get; set; } \n\n    public int Hours { get; set; } \n\n    public int AgencyId { get; set; } \n    public virtual Agency Agency { get; set; } \n\n    public int EmployeeId { get; set; }\n    public virtual Employee { get; set; }\n}\n</code></pre>\n\n<p>Like this, it bitches: <code>FK_dbo.WorkRecords_dbo.Employees_EmployeeId</code> causes a cyclical reference.</p>\n\n<h3>Experiments</h3>\n\n<p>My first thought was because of the bi-directional virtual properties, so I decided to designate one of the two a top-level entity with a 1-way relationship:</p>\n\n<p>First, I designated <code>WorkRecord</code> as a top-level entity and remove the virtual <code>WorkRecords</code> reference reference from the <code>Employee</code> entity... the same message is produced.</p>\n\n<p>Second, I made <code>Employee</code> the top-level entity, leaving its virtual <code>WorkRecords</code> collection, and removing the virtual <code>Employee</code> reference property from the <code>WorkRecord</code> entity... works fine but does not achieve my goal.</p>\n\n<p>After more investigation, I find it is the Agency virtual reference property on both entities that causes the circular reference. If one entity removes this, the <code>Employee</code>/<code>WorkRecord</code> entity relationships work in all directions. </p>\n\n<h3>Question:</h3>\n\n<p>So, clear as i can ask - how can I express this business model, using <code>WorkRecord</code> as my top-level entity, without making EF5 upset?</p>\n"},{"tags":["c#","math","rounding","significant-digits"],"answer_count":10,"favorite_count":6,"up_vote_count":12,"down_vote_count":0,"view_count":20336,"score":12,"question_id":374316,"title":"Round a double to x significant figures","body":"<p>If I have a double (234.004223) etc.\nI would like to round this to x significant digits in C#</p>\n\n<p>So far I can only find ways to round to x decimal places but this simply removes the precision if there are any 0s in the number.</p>\n\n<p>e.g. 0.086 to 1 decimal place becomes 0.1 but I would like it to stay 0.08.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","wcf","wcf-client","wcf-hosting"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1493,"score":1,"question_id":1959383,"title":"Hosting and Consuming WCF Service from Same Process","body":"<p>Can you become a client of a WCF Service from with the Process that is hosting the WCF Service?  I have tried creating seperate App Domains within the same process and still no success.  The service is confirmed to be available on Http, Net.TCP and Net.Pipe.</p>\n\n<p>Thank you for any help!</p>\n\n<p>Nat</p>\n"},{"tags":["c#","regex"],"answer_count":3,"favorite_count":0,"up_vote_count":15,"down_vote_count":1,"view_count":110,"score":14,"question_id":13258315,"title":"Check if two strings share the same pattern of repeated characters","body":"<p>Is there an efficient Regex to assert that two string share the same pattern of repeated characters.</p>\n\n<pre><code>(\"tree\", \"loaa\") =&gt; true\n(\"matter\", \"essare\") =&gt; false\n(\"paper\", \"mime\") =&gt; false\n(\"acquaintance\", \"mlswmodqmdvp\") =&gt; true\n(\"tree\", \"aoaa\") =&gt; false\n</code></pre>\n\n<p>Event if it's not through Regex, I'm looking for the most efficient way to perform the task</p>\n"},{"tags":["c#","xpath","html-agility-pack","selectnodes"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":81,"score":5,"question_id":13225438,"title":"HtmlAgilityPack SelectNodes expression to ignore an element with a certain attribute","body":"<p>I am trying to select nodes except from script nodes and a ul that has a class called 'relativeNav'. Can someone please direct me to the right path? I have been searching for this for a week and I can't find it anywhere. Currently I have this but it obviously selecting the //ul[@class='relativeNav'] as well. Is there anyway to put an NOT expression of it so that SelectNode will ignore that one?</p>\n\n<pre><code>        foreach (HtmlNode node in doc.DocumentNode.SelectNodes(\"//body//*[not(self::script)]/text()\"))\n        {\n            Console.WriteLine(\"Node: \" + node);\n            singleString += node.InnerText.Trim() + \"\\n\";\n        }\n</code></pre>\n"},{"tags":["c#","search","windows-8","windows-store-apps"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13195477,"title":"How do you actually implement the Search Contract? (C#)","body":"<p>I'm having some trouble understanding and getting the search contract to work in my Store app. I have been unable to find any sort of documentation or guide that explains the structure of using the contract. (I've looked at the quickstarts on MSDN, the Search Contract sample and the build video, but that only really deals with javascript)</p>\n\n<p>So far I've been able to run a query and get a list (of Custom Objects) into my search contract page, and from there I try to assign that to defaultviewmodel.results, but no matter what query I type nothing shows up I on the page. Is there something else I need to set?\nWhat I have so far is as follows (excerpts):</p>\n\n<p>App.xaml.cs </p>\n\n<pre><code>protected override void OnSearchActivated(Windows.ApplicationModel.Activation.SearchActivatedEventArgs args)\n        {\n            SearchCharmResultsPage.Activate(args.QueryText, args.PreviousExecutionState);\n            SearchCharmResultsPage.ProcessSearchQuery(args.QueryText);\n        }    \n\n\npublic async static void ProcessSearchQuery(string queryString)\n        {\n            try\n            {\n                StorageFile file = await ApplicationData.Current.LocalFolder.GetFileAsync(\"recipeCustomObject                  Debug.WriteLine(\"Database exists, connecting\");\n                SQLiteAsyncConnection connection = new SQLiteAsyncConnection(\"CustomObject_db\");\n                List&lt;CustomObject&gt; resultsList = new List&lt;CustomObject&gt;();\n                string query = \"SELECT * FROM CustomObjectDB\";\n                resultsList =  await connection.QueryAsync&lt;RecipeRecord&gt;(query);  \n            }\n            catch (FileNotFoundException fnfExc)\n            {\n                Debug.WriteLine(\"FNFEXC: \" + fnfExc.ToString());\n            }\n        }\n</code></pre>\n\n<p>I think it is possible that here lies the problem, though I'm not sure if it is, or how to change it.\nthe resultsList list is created here, but because the method it asynchronous, I can't return from the method. Because of this I'm guess that when I try to assign <code>this.DefaultViewModel[Results] = resultsList;</code> in the LoadStateMethod, the object doesn't exist (thought the program throws no error). When I try to add the same line in the <code>ProcessSearchQuery</code> method, i'm told that <code>this</code> is not valid in a static method, but I think I need the method to be static? My problem might just be a fundamental logic error?</p>\n"},{"tags":["c#","asp.net","asp.net-mvc","webclient"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13259348,"title":"Show downloadable link to csv","body":"<p>I am trying to show a stream of data in a downloadable .csv file with the following code:</p>\n\n<pre><code>WebClient wc = new WebClient();\n                    byte[] csvBytes = wc.DownloadData(url);\n                    return File(csvBytes, \"text/csv\", \"Test.csv\");\n</code></pre>\n\n<p>The URL returns data in this format:</p>\n\n<p>\n    \"PAUL\",\"SMITH\",\"A &amp; P CONSTRUCTION\",\"211 N JACKSON ST\",\"New York\",\"NY\",\"98055\"\n    \"JEROME\",\"HALSEY\",\"A A A LOCATING INC\",\"1906 SOUTHVIEW DR\",\"PAPILLION\",\"NE\",\"68046\"\n    \"MIKE\",\"GIBILISCO\",\"ABSOLUTE SECURITY INC\",\"944 S JEFFERSON ST\",\"PAPILLION\",\"NE\",\"84102\"\n</p>\n\n<p>The above works well, and I get a downloadable link ... but when I open the .csv file - I get the records in just one row:</p>\n\n<pre><code>\\\"PAUL\\\"    \\\"SMITH\\\"   \\\"A &amp; P CONSTRUCTION\\\"  \\\"211 N JACKSON ST\\\"    \\\"PAPILLION\\\"   \\\"NE\\\"  \\\"68046\\\"...\n</code></pre>\n\n<p>How should I modify the above code so that I get the values in the right format (without the \"\\\" and under the right columns)?</p>\n"},{"tags":["c#","methods","iterator","enumerator","yield-return"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":13213130,"title":"How can yield return statement return no elements?","body":"<p>I'm practicing deletion of nodes on a binary search tree, and I created a special type for null links (<strong>NullNode</strong>) using null pattern, so I can add some desirable behaviour to \"null\" types. Both <strong>Node</strong> type and <strong>Nullnode</strong> type share the same <strong>INode</strong> interface, which includes recursive methods.</p>\n\n<p>The <strong>INode</strong> interface includes <strong>IEnumerable</strong> recursive methods por PreOrder, InOrder and PostOrder traversal, but I don't want NullNode to return any element (through yield return statements).</p>\n\n<p>What can I do?</p>\n\n<p>I know that I can use an impossible if-condition and then put there a yield return statement in the method, but I don't think this solution is good. There should be a better approach.</p>\n"},{"tags":["c#","asp.net-mvc-3","linq-to-sql"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13259088,"title":"Linq redundant db access for related models","body":"<p>Why does my model go out to the DB again for related properties which have already been loaded in a separate LINQ join statement?</p>\n\n<p><strong>Background info:</strong></p>\n\n<p>I recently ran some Performance profiling on my ASP.NET MVC3 Linq application I got some puzzling results that I hope to resolve. </p>\n\n<p>Here is a simplified version of db structure. Foreign key relationships are set up. </p>\n\n<p><strong>Table Client:</strong></p>\n\n<pre><code>ID|Client Name|Vertical ID|\n___________________________\n1 |Client1    |2          |\n2 |Client2    |5          |\n3 |Client3    |           |\n</code></pre>\n\n<p><strong>Table Vertical</strong></p>\n\n<pre><code>ID|Vertical Name|\n_________________\n2 |Life         |\n5 |Guilt        |\n</code></pre>\n\n<p>When I display the list of clients, I am displaying them the client name and the vertical. My Controller is simple:</p>\n\n<pre><code>public ActionResult Index()\n    {\n        ...\n    var model = repository.GetAllClients();\n        return View(model);\n    }\n</code></pre>\n\n<p>Get all clients runs the join on the vertical table (as well as a few others). </p>\n\n<pre><code> public IEnumerable&lt;client&gt; GetAllClients()\n    {\n        OperationsMetricsDataContext db = new OperationsMetricsDataContext();\n        var clients = from c in db.clients\n                      join v in db.verticals on c.vertical equals v into tmp1\n                      from v in tmp1.DefaultIfEmpty()\n                      join sm in db.cel_sm_staffs on c.sm_id equals sm.cel_sm_id into tmp2\n                      from sm in tmp2.DefaultIfEmpty()\n                      join cel in db.cel_sm_staffs on c.cel_id equals cel.cel_sm_id into tmp3\n                      from cel in tmp3.DefaultIfEmpty()\n                      select c;\n        return clients;\n    }\n</code></pre>\n\n<p>In my View, I then attempt to display the vertical name I have bound using this method in my partial client class</p>\n\n<pre><code>public string getVerticalName()\n    {\n        return this.vertical == null ? \"N/A\" : this.vertical.vertical_name;\n    }\n</code></pre>\n\n<p><strong>The problem:</strong></p>\n\n<pre><code>@foreach (var item in Model) {\n&lt;tr&gt;\n    &lt;td&gt;\n        @Html.Raw(item.client_name)\n    &lt;/td&gt;\n    &lt;td&gt;\n        @Html.Raw(item.getVerticalName())\n    &lt;/td&gt;\n</code></pre>\n\n<p>The problem that I uncovered is that even though I specified the join in the original model,  (and I've been able to verify that the vertical property has a value loaded before the model is passed to the view), each time I call the getVerticalName method, Linq automatically goes out to the db again to load the vertical so that I can access the vertical name. This is pretty inefficient because I end up with a separate db call for each client just to get their vertical information.</p>\n\n<p>What am I missing here? Shouldn't LINQ know that the property is already bound and not go out to the db to retrieve it or is there something I need to specify to tell LINQ that my information already exists in the model?</p>\n"},{"tags":["c#",".net","winforms","visual-studio-2010","controls"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13260688,"title":"how to remove the default control buttons from a windows form","body":"<p>The image describes what I am trying to do.</p>\n\n<p>I have a \"connect four\" game which works perfectly well but I want to remove the default buttons provided at the top right hand corner of the window. Any quick help on this?</p>\n\n<p><img src=\"http://i.stack.imgur.com/Ws3ss.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#"],"answer_count":15,"favorite_count":6,"up_vote_count":57,"down_vote_count":0,"view_count":31301,"score":57,"question_id":1859248,"title":"how to change time in datetime","body":"<p>How can i change the time alone in DateTime variable in c#.</p>\n\n<pre><code>DateTime s = some datetime;\n</code></pre>\n\n<p>i need to the change the time alone in the 's'..</p>\n"},{"tags":["c#","wpf","xaml","multibinding","syncfusion"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":13256286,"title":"WPF MultiBinding fails in Syncfusion TabItemExt header","body":"<p>I have a subclass of <code>TabItem</code> as follows, for which I'm trying to set the <code>Header</code> property. I've tried this with a <code>MultiBinding</code>:</p>\n\n<pre><code>&lt;DataEditPane x:TypeArguments=\"MyType\" x:Class=\"MyDataEditPane\"&gt;\n    &lt;DataEditPane.Header&gt;\n        &lt;MultiBinding StringFormat=\"Hello world {0} {1}\"&gt;\n            &lt;Binding Path=\"BoundVariable1\" /&gt;\n            &lt;Binding Path=\"BoundVariable2\" /&gt;\n        &lt;/MultiBinding&gt;    \n    &lt;/DataEditPane.Header&gt;\n&lt;/DataEditPane&gt;\n</code></pre>\n\n<p>But it fails as such:</p>\n\n<pre><code>System.Windows.Data Error: 28 : MultiBinding failed because it has no valid Converter. MultiBindingExpression:target element is 'MyDataEditPane' (Name=''); target property is 'Header' (type 'Object')\nSystem.Windows.Data Error: 28 : MultiBinding failed because it has no valid Converter. MultiBindingExpression:target element is 'MyDataEditPane' (Name=''); target property is 'Header' (type 'Object')\n</code></pre>\n\n<p>I'd always thought the <code>StringFormat</code> served the role of the converter, but perhaps not?</p>\n\n<p>Wrapping the fields together in some kind of container, like a <code>Label</code>, also doesn't seem to work:</p>\n\n<pre><code>&lt;DataEditPane x:TypeArguments=\"MyType\" x:Class=\"MyDataEditPane\"&gt;\n    &lt;DataEditPane.Header&gt;\n        &lt;Label&gt;\n            &lt;Label.Text&gt;\n                &lt;MultiBinding StringFormat=\"Hello world {0} {1}\"&gt;\n                    &lt;Binding Path=\"BoundVariable1\" /&gt;\n                    &lt;Binding Path=\"BoundVariable2\" /&gt;\n                &lt;/MultiBinding&gt;    \n            &lt;/Label.Text&gt;\n        &lt;/Label&gt;\n    &lt;/DataEditPane.Header&gt;\n&lt;/DataEditPane&gt;\n</code></pre>\n\n<p>In this case, the <code>.ToString()</code> representation of the label (\"<code>System.Windows.Controls.Label</code>\") is shown as the header.</p>\n\n<p>Note that a single binding works just fine:</p>\n\n<pre><code>&lt;DataEditPane x:TypeArguments=\"MyType\" x:Class=\"MyDataEditPane\"&gt;\n    &lt;DataEditPane.Header&gt;\n        &lt;Binding Path=\"BoundVariable1\" /&gt;\n    &lt;/DataEditPane.Header&gt;\n&lt;/DataEditPane&gt;\n</code></pre>\n\n<p>If it matters, I'm using the Syncfusion <code>TabItemExt</code> as one of my superclasses in the inheritance hierarchy, but as that class doesn't override the <code>Header</code> property I don't think that makes a difference.</p>\n\n<p>What am I doing wrong? I know I can make another property in the ViewModel to act as the Header (and then single-bind that) but I want to learn how to do this properly in XAML.</p>\n"},{"tags":["c#",".net","dynamic","expression","iqueryable"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13252206,"title":"Dynamic IQueryable order by using string","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/41244/dynamic-linq-orderby\">Dynamic LINQ OrderBy</a>  </p>\n</blockquote>\n\n\n\n<p>I'm trying to create a dynamic sorting to Iqueryable.<br>\nSo bellow you can see that I am following some examples I see here in stackoverflow.</p>\n\n<pre><code> var query = dalSession.Query&lt;T&gt;();\n            var res = (from x in query orderby Extensions.Sort&lt;T&gt;(query, \"FirstName\") select x).Skip((paging.CurrentPageRecord)).Take(paging.PageSize);\n\n\npublic static class Extensions\n{\n    public static IQueryable&lt;T&gt; Sort&lt;T&gt;(this IQueryable&lt;T&gt; query,\n                                             string sortField)\n    {\n        return query.OrderByDescending(s =&gt; s.GetType()\n                                             .GetProperty(sortField));\n\n    }\n} \n</code></pre>\n\n<p>This is the exception that I get:</p>\n\n<blockquote>\n  <p>System.Linq.IQueryable<code>1[Partners.BusinessObjects.Affiliate] Sort[Affiliate](System.Linq.IQueryable</code>1[Partners.BusinessObjects.Affiliate], System.String)</p>\n</blockquote>\n\n<pre><code>Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. \n\nException Details: System.NotSupportedException: System.Linq.IQueryable`1[Partners.BusinessObjects.Affiliate] Sort[Affiliate](System.Linq.IQueryable`1[Partners.BusinessObjects.Affiliate], System.String)\n</code></pre>\n"},{"tags":["c#","multithreading"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13260322,"title":"how to use .NET Action to execute a method with unknown number of parameters?","body":"<p>Certaintly this is a dumb and basic question but i i'm trying to figure out how this works. </p>\n\n<p>What i want to achieve is to execute some operations on a worker thread while displaying a progress bar to the user. I've created a class </p>\n\n<pre><code>public class ProgressBar\n\n {\n   public void StartAsyncTask(Action action)\n    {\n      Task t = new Task(action);\n      t.start();\n    }\n }\n</code></pre>\n\n<p>I found out that i can send any  method to the StartAsyncTask in the following way:</p>\n\n<pre><code>      ProgressBar pb = new ProgressBar();\n      pb.StartAsyncTask( () =&gt; DoSomething(15, \"something\"));\n\n\n      public void DoSomething(int i, string s)\n       {\n          //do something\n       }\n</code></pre>\n\n<p>First of all, i can't seem to understand what is and how is lambda () => expression translated and how is the Action object passed a delegate with an unknown number of parameters. </p>\n\n<p>I would like to use a </p>\n\n<pre><code>    BackgroundWorker \n</code></pre>\n\n<p>with my ProgressBar but in this case i would need to invoke the action. So something like this:</p>\n\n<pre><code>    void m_backgroundWorker_DoWork(object sender, DoWorkEventArgs e)\n    {\n        Action action = e.Argument as Action; //same action here passed through EventArgs\n       //but already in a worker thread so no need for the Task object \n\n\n       //and now i need to somehow invoke the action object but i don't know what the parameters are. \n\n       action.Invoke( ? ); \n\n        }\n</code></pre>\n\n<p>How is it possible in the first example to execute the action without knowing the parameters in </p>\n\n<pre><code>         StartAsyncTask(Action action) method. \n</code></pre>\n\n<p>Why do i need to know the parameters when invoking the action in this case? </p>\n\n<p>Everything about how/why/when to use \"Action\" is pretty unclear to me even if i read msdn documentation and some other threads here on stackoverflow. \nAny information on this will help me.</p>\n\n<p>Thank you,\nDan</p>\n"},{"tags":["c#","java","c++","oop"],"answer_count":16,"favorite_count":1,"up_vote_count":13,"down_vote_count":1,"view_count":917,"score":12,"question_id":2289642,"title":"The best learning route into Object Oriented Programming from C?","body":"<p>What is the best route to go for learning OOP if one has done some programming in C.</p>\n\n<p>My intention was first to take the natural leap and \"increment with one\" and go for Stroustrup. But since I got my hands on the little old Bertrand Meyers OOSC2 and I qoute from the appendix page 1135 <em>\"..according to Donald Knuth, it would make Edsger Dijkstra 'physically ill to think of programming in C++\"</em>\nAnd Meyer himself <em>\"..that C++ is not the ideal OOP language...\"</em></p>\n\n<p>And what about this A critiqe on C++ on this question: <a href=\"http://burks.brighton.ac.uk/burks/pcinfo/progdocs/cppcrit/\" rel=\"nofollow\">A critique of C++</a></p>\n\n<p>Should I skip C++ and go for C# and or Java directly if my intention is a great and deep understanding of a modern OOP-language, or do I miss good points on this subject in C++?</p>\n\n<p>Well I know this is a discussion-thing but I mark it wiki and you're answers could mean a lot for me in choices to come.</p>\n"},{"tags":["c#","xml","xdocument","xelement"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13260437,"title":"How can I get a node from an XML document based on its attribute value and into an XElement object?","body":"<p>I need to inject some XML into a pre-existing XML file under a certain node.  Here is the code I have to create my XML:</p>\n\n<pre><code>//Define the nodes\nXElement dataItemNode = new XElement(\"DataItem\");\nXElement setterNodeDisplayName = new XElement(\"Setter\");\nXElement setterNodeOU = new XElement(\"Setter\");\n\n//Create the tree with the nodes\ndataItemNode.Add(setterNodeDisplayName);\ndataItemNode.Add(setterNodeOU);\n\n//Define the attributes\nXAttribute nameAttrib = new XAttribute(\"Name\", \"OrganizationalUnits\");\nXAttribute displayNameAttrib = new XAttribute(\"Property\", \"DisplayName\");\nXAttribute ouAttrib = new XAttribute(\"Property\", \"OU\");\n\n//Attach the attributes to the nodes\nsetterNodeDisplayName.Add(displayNameAttrib);\nsetterNodeOU.Add(ouAttrib);\n\n//Set the values for each node\nsetterNodeDisplayName.SetValue(\"TESTING DISPLAY NAME\");\nsetterNodeOU.SetValue(\"OU=funky-butt,OU=super,OU=duper,OU=TMI,DC=rompa-room,DC=pbs,DC=com\");\n</code></pre>\n\n<p>Here is the code I have so far to load up the XML document and try to get the node that I need to insert my XML under:</p>\n\n<pre><code>//Load up the UDI Wizard XML file\nXDocument udiXML = XDocument.Load(\"UDIWizard_Config.xml\");\n\n//Get the node that I need to append to and then append my XML to it\nXElement ouNode = THIS IS WHAT I DONT KNOW HOW TO DO\nouNode.Add(dataItemNode);\n</code></pre>\n\n<p>Here is the XML from the existing document I am trying to work with:</p>\n\n<pre><code>&lt;Data Name=\"OrganizationalUnits\"&gt;\n        &lt;DataItem&gt;\n          &lt;Setter Property=\"DisplayName\"&gt;TESTING DISPLAY NAME&lt;/Setter&gt;\n          &lt;Setter Property=\"OU\"&gt;OU=funky-butt,OU=super,OU=duper,OU=TMI,DC=rompa-room,DC=pbs,DC=com&lt;/Setter&gt;\n        &lt;/DataItem&gt;\n</code></pre>\n\n<p>I have multiple nodes that with the name of \"Data\", but I need to get the node that is , and I don't know how.  Just learning how to use XML with C#.</p>\n\n<p>Thank you.</p>\n"},{"tags":["c#","session","service","user-profile"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13259488,"title":"How can I detect when a user's session has finished logging off","body":"<p>I have a Windows service that is successfully detecting SessionLogon and SessionLogoff (and most of the othes) by overriding the ServiceBase object. This works well. However, it appears these events are fired immediately after authentication and immediately after the user clicks the Log off button (or some automated process logs the user off). In addition to knowing when the user first starts to log in and first starts to log out, I need to know about when the user finishes logging on and finishes logging off. I currently look for the user's shell process to start executing (typically explorer.exe) for log in and for the most part that works pretty well. By the time their shell has launched if they're using roaming profiles or other log in actions are taking place, I can pretty much be sure that by the time the shell is running that the lion's share of the log on process has occurred. </p>\n\n<p>However for log off, this hasn't proven to be reliable. I'm looking for a way to accurately detect when a user's log off has finished including when all their profile information has finished being synchronized or copied and whatever other log off actions have occurred. Simply watching for their shell program to end doesn't seem to be enough as it may take from a few seconds to several minutes for log off to occur (say if they have a roaming profile).</p>\n\n<p>So in short, <strong>I'm looking for a programmatic way in C# to detect when the full log off has occurred and all profile synchronization or what have you has finished <em>after the SessionLogoff event</em> has fired.</strong></p>\n\n<p>I've looked high and wide, but haven't seen anyone talking about the time difference between when that event occurs and when the actual log off finishes.</p>\n\n<p>NOTE: I also cannot rely on the disconnect event because the user might disconnect after logoff but before their profile finishes synchronizing/copying what have you. I'm looking for a way to detect (within a few seconds of it occuring) the finished log off.</p>\n"},{"tags":["c#",".net","flash","youtube","youtube-api"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13260361,"title":"How to control the youtube flash player with c#?","body":"<p>So far this is what I have:</p>\n\n<pre><code>private AxShockwaveFlashObjects.AxShockwaveFlash player;\nplayer.movie = \"http://youtube.googleapis.com/v/9bZkp7q19f0\"\n...\nprivate void playBtn_Click(object sender, EventArgs e)\n{\n    player.CallFunction(\"&lt;invoke name=\\\"playVideo\\\" returntype=\\\"xml\\\"&gt;&lt;/invoke&gt;\");\n}\n</code></pre>\n\n<p>Unfortunately this returns: </p>\n\n<pre><code>\"Error HRESULT E_FAIL has been returned from a call to a COM component.\"\n</code></pre>\n\n<p>What am I missing? Should I load a different URL? <a href=\"https://developers.google.com/youtube/articles/youtube_as3_chromeless\" rel=\"nofollow\">The documentation</a> states that YouTube player uses <strong>ExternalInterface class</strong> to control it from JavaScript or AS3 so <a href=\"http://bojolais.livejournal.com/251383.html\" rel=\"nofollow\">it should work with c#</a>.</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":5,"view_count":32,"score":-4,"question_id":13260426,"title":"Create form not affected by ShowDialog()","body":"<p>I'm currently doing a security assessment of an extremely large C# application.  I have wrote a tool to help me do the assessment that also runs in C#.  The entire application uses ShowDialog aka modal forms.  I'm trying to come up with a way where I can still use my tool (click on it for example) while modal dialog boxes are popped up.  I figure, this may require another thread or something else.  If anyone has any easy tips on a way to make it so that my form doesn't get blocked by ShowDialog, that would be great.  </p>\n"},{"tags":["c#","multithreading"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12470991,"title":"Know Thread Count","body":"<p>i have developed application which uses threads to finish the task and i want to close the running application in middle of the process its closes but thread is running in background. </p>\n\n<p>now i want to show active threads by which my application is created. but difficulty is, when i start the application from vs threads are shown in task manager like 14-19 threads without running the application.</p>\n\n<p>can u tell me to display only those threads which is created by my application and not by system.</p>\n"},{"tags":["c#","wpf","c#-4.0","xamdatagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13256056,"title":"How to add a tooltip to the XamDataGrid record programmatically","body":"<p>I already know how to set the tooltip for a XamDataGrid using a style, e.g.:</p>\n\n<pre><code>&lt;Style TargetType={x:Type ig:DataRecordCellArea&gt;...\n</code></pre>\n\n<p>However, for a specific reason (don't have time to explain it all), I really need to invoke the tooltip programmatically, preferably hooked to a <code>MouseOver</code> event. </p>\n\n<p>I would really appreciate it if someone could illustrate the way.  What have I done so far? Not much, because the Infragistics site is full of XAML examples and doesn't offer any guidance on doing this programmatically (except for one trivial cell-level tooltip example).</p>\n"},{"tags":["c#","filesystemwatcher"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13257203,"title":"FileSystemWatcher: max number of folders","body":"<p>I have a server where my app is using FileSystemWatcher to monitor a folder say, <strong>e:\\A</strong>.\nInside the folder A, there are as many as 16,000 folders and each subfolder has numerous other folders and files.</p>\n\n<p>The app is crashing to desktop in about 1 hour.\nWhen there were fewer folders, the app was working fine.\nI have increased the internal buffer to twice the default value. </p>\n\n<p>Is there a limit on the maximum number of folders to be monitored?\nOr the folder itself is unstable due to the huge number of folders?</p>\n\n<p><strong>Update:</strong>\nThe app runs on a virtual machine(vmware).<br/>\nWindows Server 2008.<br/>\ndual 2.53 Intel Xeon.<br/>\n4 GB of RAM.<br/>\nRAID. [ 1.3TB, may be increased. ]</p>\n"},{"tags":["c#","mvvm","prism","enterprise"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13259308,"title":"Localization in enterprise application","body":"<p>where would you place \"localization &amp; globalization\" in an enterprise application 3-layered builded in c# WPF with MVVM and Prism? I mean in an application built like the pattern describe in msdn (http://msdn.microsoft.com/en-us/library/ee658124.aspx) in which layer would you put the logic for localization? what kind of approach would you use (resx files, db...)?</p>\n"},{"tags":["c#"],"answer_count":6,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":397,"score":4,"question_id":1724128,"title":"C# - custom explicit conversion with checked/unchecked operator","body":"<p>I'm learning to write custom type conversions in C# and I have a question I can't manage to resolve with Google / MSDN / earlier posted SO items.</p>\n\n<p>Normally, a C# program that narrows a numeric type does that via unchecked explicit conversion, e.g.:</p>\n\n<pre><code>int i = 256;\nbyte b = (byte)i; // b == 0\n</code></pre>\n\n<p>however, the following will give an overflow exception:</p>\n\n<pre><code>byte b = checked((byte)i);\n</code></pre>\n\n<p>My question is as follows: is the behavior of the checked / unchecked keyword implementable in an custom type conversion, e.g.:</p>\n\n<pre><code>class Foo {\n  public static explicit operator int(Foo bar) {\n    if (checked)\n      throw someEception\n    else\n      return some Foo to int conversion\n  }\n}\n</code></pre>\n\n<p>Of course, the code above is not the answer, but does anyone know if something like this is possible?</p>\n"},{"tags":["c#",".net","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":13260315,"title":"LINQ query for the following","body":"<p>Could someone help formulate a LINQ query for the following problem.\nI have the following list of Key-Value number sets (mind that Duplicate Keys are allowed). There are thousands of such sets.</p>\n\n<pre><code>{4,3}, {4,1}, {4,8}, {4,9}, {2,3}, {4,9}, {3,1} , {3,4}\n</code></pre>\n\n<p>What data structure would suit me best.\nAlso, I want to group the above list of key-pairs, and OrderByDescending() so that i can extract the highest Key-Value pair of a Key-group.</p>\n\n<p>For example in the above case, expected output:</p>\n\n<pre><code>{4,9}, {4,9}, {4, 8}, {4, 3}, {4, 1}, {2, 3}, {3, 4}, {3, 1}\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["c#","wpf","video-streaming","expression","broadcasting"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":268,"score":4,"question_id":10990427,"title":"wpf application for broadcasting video with 15sec delay","body":"<p>I have a WPF application for broadcasting video using Microsoft.expression.encoder and framework 4.0, but i got a delay of 15 sec while broadcasting.Is there any suggestion to reduce the delay while broadcasting.</p>\n\n<p>below is the Code</p>\n\n<pre><code>using Microsoft.Expression.Encoder.Live; \nusing Microsoft.Expression.Encoder;\n\nprivate void button1_Click(object sender, RoutedEventArgs e)\n{ \n    try \n    { \n        EncoderDevice video = null; \n        EncoderDevice audio = null;\n        GetSelectedVideoAndAudioDevices(out video, out audio);\n        StopJob();\n\n        if (video == null)\n        {\n            return;\n        }\n\n        StopJob();\n        _job = new LiveJob();\n\n        if (video != null &amp;&amp; audio != null)\n        {\n            //StopJob();\n            _deviceSource = null;\n            _deviceSource = _job.AddDeviceSource(video, audio);\n            _job.ActivateSource(_deviceSource);\n\n            // Finds and applys a smooth streaming preset        \n            //_job.ApplyPreset(LivePresets.VC1HighSpeedBroadband4x3);\n\n            // Creates the publishing format for the job\n            PullBroadcastPublishFormat format = new PullBroadcastPublishFormat();\n            format.BroadcastPort = 9090;\n            format.MaximumNumberOfConnections = 50;\n\n            // Adds the publishing format to the job\n            _job.PublishFormats.Add(format);\n\n            // Starts encoding\n            _job.StartEncoding();\n        }\n        //webCamCtrl.StartCapture();\n    }\n    catch (Exception ex)\n    {\n        WriteLogFile(this.GetType().Name, \"button1_Click\", ex.Message.ToString());\n    }\n\n}\n</code></pre>\n\n<p>I am using MediaElement to show  the webcam both on my server and client systems.</p>\n\n<p>on Client Side </p>\n\n<pre><code> try\n            {\n\n                theMainWindow.getServerIPAddress();\n                IP = theMainWindow.machineIP;\n                MediaElement1.Source = new Uri(\"http://\" + IP + \":9090/\");\n            }\n            catch (Exception ex)\n            {\n            }\n</code></pre>\n"},{"tags":["c#","winforms","path","treeview","directory"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":13259963,"title":"Why does Path.GetFileName() return the name of the correct folder, but Path.GetDirectoryName() returns it parent folder?","body":"<p>I have found that using Path.GetFileName() in the code below works as I intend and gives me the name of the correct folder, but if I use Path.GetDirectoryName() it returns the name of the parent (UserGeneratedContent) folder instead. Why does this occur when both methods are passed the same path as a string? And why does Path.GetFileName() work on directories?</p>\n\n<p>When I use Path.GetFileName() the text of the nodes in the Treeview are those of the folders it finds - this is what I want to happen, but if I use Path.GetDirectoryName() the text is the full path from @\"UserGeneratedContent\" on down for each node. Why does that happen?</p>\n\n<p>And lastly, can my code be improved?      </p>\n\n<pre><code>private void CheckForBaseFolder()\n    {\n\n        if (Directory.Exists(@\"UserGeneratedContent\"))\n        {\n\n            DirectoryInfo info = new DirectoryInfo(@\"UserGeneratedContent\");\n            DirectoryInfo[] subdirs = info.GetDirectories();\n\n            if (subdirs.Length != 0)\n            {\n\n                string path = Path.Combine(@\"UserGeneratedContent\", subdirs[0].ToString());\n\n                treeView1.Nodes.Add(CheckForSubFolders(path));\n\n                treeView1.SelectedNode = treeView1.Nodes[0];\n\n            }\n            else { MessageBox.Show(\"No User-Generated Folders Or Files Found\");}\n\n        }\n        else\n        {\n\n            Directory.CreateDirectory(@\"UserGeneratedContent\");\n\n        }\n\n    }\n\n    private TreeNode CheckForSubFolders(string path)\n    {\n\n        TreeNode folder = new TreeNode(path);\n\n        folder.Text = Path.GetFileName(path); // Works as intended, but.....\n        folder.Text = Path.GetDirectoryName(path); // Returns the name of the parent folder \n\n        foreach(var subdirectory in Directory.GetDirectories(path))\n        {\n\n            folder.Nodes.Add(CheckForSubFolders(subdirectory));\n\n        }\n\n        folder.ImageIndex = 0;\n        folder.SelectedImageIndex = 1;\n\n        return folder;\n\n    }\n</code></pre>\n"},{"tags":["c#","windows-azure-storage","azure-storage-tables","azure-diagnostics"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13260298,"title":"Tracking and scheduling Azure diagnostic Performance Metrics on demand","body":"<p>I've been reading many MSDN articles on the Diagnostics API's that the Azure platform provides and I'm having a bit of trouble. I listed my problems and showed below how I'm implementing my logic. </p>\n\n<p>My issue's are: \n1, that it seems I can only start keeping track of metrics at the start of a WebRole (RoleEntryPoint). This means if I want to turn off the diagnostics, I'll need to stop the webrole and restart it. </p>\n\n<p>2, The most recent counters I see are always from ~2 minutes in the past, despite my settings to record and transfer the counters every 10 seconds. (I will need to look into what sampling rates and transfer rates are appropriate)</p>\n\n<p>3, All the Counters are 0 when I look at the list's data. How can I assure they are measuring what I'm looking for? Currently I am opening a thread and sending requests (Posts to a URL) to the role for 30 seconds. I assume Requests/sec should be above 0. </p>\n\n<p>It looks like in the OnStart() method within the WebRole.cs class I must add the diagnostic performance counters I want to be tracked, as well as how often they should be sampled and transferred (to storage), as well as a max buffer size. I've done it as follows:</p>\n\n<pre><code>public override bool OnStart(){\n    DiagnosticMonitorConfiguration diagnosticConfig = DiagnosticMonitor.GetDefaultInitialConfiguration();       \n   // this is for scaling tests to measure WCF load\n   // Add a performance counter for requests per second.\n   // Use 5 Seconds for the performance counter sample rate.\n   TimeSpan perfSampleRate = TimeSpan.FromSeconds(5.0);\n   // Limit amount of data to be stored\n   diagnosticConfig.PerformanceCounters.BufferQuotaInMB = 1;\n   // Transfer the counters every 10 seconds\n   diagnosticConfig.PerformanceCounters.ScheduledTransferPeriod = TimeSpan.FromSeconds(10.0);\n   diagnosticConfig.PerformanceCounters.DataSources.Add(new PerformanceCounterConfiguration()\n   {\n        CounterSpecifier = @\"\\ASP.NET\\Requests/Sec\",\n        SampleRate = perfSampleRate\n   });\n   diagnosticConfig.PerformanceCounters.DataSources.Add(new PerformanceCounterConfiguration()\n   {\n       CounterSpecifier = @\"\\ASP.NET\\Requests Queued\",\n       SampleRate = perfSampleRate\n   });\n</code></pre>\n\n<p>then upon wanting to view the data I perform the following to put the data into a list of performance metrics:</p>\n\n<pre><code>        CloudStorageAccount storageAccount = CloudStorageAccount.Parse(\n                \"UseDevelopmentStorage=true\");\n\n        CloudTableClient cloudTableClient = storageAccount.CreateCloudTableClient();\n\n        TableServiceContext serviceContext = cloudTableClient.GetDataServiceContext();\n\n        IQueryable&lt;PerformanceCountersEntity&gt; performanceCountersTable =\n            serviceContext.CreateQuery&lt;PerformanceCountersEntity&gt;(\"WADPerformanceCountersTable\");\n\n        // Get all performance counters that exist from the last 10 seconds\n        var selection = from row in performanceCountersTable\n                        where row.EventTickCount &gt; DateTime.UtcNow.AddMinutes(-10.0).Ticks\n                        //where row.CounterName.Equals(@\"\\ASP.NET\\Requests/Sec\")\n                        select row;\n        CloudTableQuery&lt;PerformanceCountersEntity&gt; query = selection.AsTableServiceQuery&lt;PerformanceCountersEntity&gt;();\n\n        // Use the Execute commmand explicitly on the TableServiceQuery to \n        // take advantage of continuation tokens automatically and get all the data.\n        IEnumerable&lt;PerformanceCountersEntity&gt; result = query.Execute();\n\n        List&lt;PerformanceCountersEntity&gt; list = result.ToList();\n</code></pre>\n"},{"tags":["c#","wpf","webkit","webbrowser"],"answer_count":8,"favorite_count":8,"up_vote_count":18,"down_vote_count":0,"view_count":6470,"score":18,"question_id":4001547,"title":"C# WPF WebBrowser alternative","body":"<p>I need a web browser inside my .NET 3.5 application and I don't want to use the default webbrowser (because it feels buggy and slow). I tried Chris Cavanagh's chromium but I just couldn't get it to work... are there any easier to use alternatives? I'm looking for something very simple and light on the computer, it will host a webstore front if that matters.</p>\n"},{"tags":["c#","xna","xna-4.0","deferred-rendering"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13259725,"title":"XNA Deferred Shader, Replace BasicEffect","body":"<p>I have implemented deferred shading in my XNA 4.0 project, meaning that I need all objects to start out with the same shader \"<em>RenderGBuffer.fx</em>\". How can I use a custom Content Processor to:</p>\n\n<ol>\n<li>Not load any textures by default (I want to manually do this)</li>\n<li>Use \"<em>RenderGBuffer.fx</em>\" as the default shader instead of BasicEffect</li>\n</ol>\n\n<p>Below is the work so far:</p>\n\n<pre><code>public class DeferredModelProcessor : ModelProcessor\n{\n   EffectMaterialContent deferredShader;\n\n   public DeferredModelProcessor()\n   {\n\n   }\n\n   protected override MaterialContent ConvertMaterial(MaterialContent material, ContentProcessorContext context)\n   {\n       deferredShader = new EffectMaterialContent();\n       deferredShader.Effect = new ExternalReference&lt;EffectContent&gt;(\"DeferredShading/RenderGBuffer.fx\");         \n\n       return context.Convert&lt;MaterialContent, MaterialContent&gt;(deferredShader, typeof(MaterialProcessor).Name);\n   }\n}\n</code></pre>\n"},{"tags":["c#","xaml","microsoft-metro"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13243763,"title":"TextBlock won't display the rest of it's text even when it's resized","body":"<p>An app I'm working on retrieves information from the Internet and displays it in-app in a series of Grids inside of a StackPanel, itself nested inside of a ScrollViewer.</p>\n\n<p>My problem is this: The app shows a short summary of the content, and the idea is that clicking the content makes the Grid and TextBlock expand to show the rest of the content, however resizing the TextBlock doesn't show the text that was cut off by being too short originally. The TextBlock is created dynamically in c# code.</p>\n\n<p>Additionally, but not vital: I don't know how to get the full required height from the TextBlock to change it's text to, and without it I have to set the new size to a static number, which I feel detracts from the UX of my app.</p>\n\n<p>Thanks,\nJase</p>\n\n<hr>\n\n<p><strong>Update:</strong> This is the code used to generate the TextBlock:</p>\n\n<pre><code>this.message = new TextBlock()\n{\n    VerticalAlignment = VerticalAlignment.Top,\n    TextWrapping = TextWrapping.Wrap,\n    MaxWidth = getWidth()\n};\nif(post.message != null) { message.Text = post.message; }\n</code></pre>\n\n<p><strong>Update 2:</strong> This is the code that creates the StackPanel (XAML):</p>\n\n<pre><code>&lt;ScrollViewer Grid.Column=\"1\" Style=\"{StaticResource MainColumn}\" VerticalScrollBarVisibility=\"Auto\" SizeChanged=\"Feed_SizeChanged\"&gt;\n    &lt;StackPanel x:Name=\"Feed\"/&gt;\n&lt;/ScrollViewer&gt;\n</code></pre>\n\n<p>This is where the parent Grid is generated:</p>\n\n<pre><code>Post grid = new Post() { Margin = new Thickness(0, 0, 0, 5) };\nFeed.Children.Add(grid);\ngrid.layoutPost(oldCount, count--, post, Feed, this);\n</code></pre>\n\n<p>The height of the Grid is set in the layoutPost method, and ends up at 75px, Post is a class that extends Grid, and is defined here:</p>\n\n<pre><code>class Post : Windows.UI.Xaml.Controls.Grid\n</code></pre>\n"},{"tags":["c#","linq","divide-by-zero"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":204,"score":0,"question_id":10243382,"title":"How to prevent division by zero?","body":"<pre><code>ads = ads.Where(x =&gt; (x.Amount - x.Price) / (x.Amount / 100) &gt;= filter.Persent);\n</code></pre>\n\n<p>if x.Amount == 0 I have error \"Divide by zero error encountered.\"</p>\n\n<p>like me in this request is to avoid?</p>\n\n<p><strong>update:</strong></p>\n\n<p>this helped, but I do not like the decision:</p>\n\n<pre><code>ads = ads.Where(x =&gt; (x.Amount - x.Price) / ((x.Amount / 100)==0?0.1:(x.Amount / 100)) &gt;= filter.Persent);\n</code></pre>\n\n<p>there is another way?</p>\n"},{"tags":["c#","asp.net",".net","asp.net-mvc","routing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13260084,"title":"Route URLs from a web client back to the web client","body":"<p>I have an ASP.NET Controller, that has a function, that simply returns a ContentResult of a WebClient.</p>\n\n<p>In this case, CNN is my testbed, my WebClient, downloads CNN as a string, into it's content, and returns the result as an ActionResult/ContentResult on a controller.</p>\n\n<p>I'm calling a RenderPartial on this action, to get CNN to display \"below\" and to the right of my current content, in its own box.</p>\n\n<p>The problem I'm running into, is when you click a link on CNN, it redirects to a \"relative\" url sometimes, and that relative url, doesn't exist in my localhost, and won't exist on my web server, thus the link fails.</p>\n\n<p>When it does redirect to an absolute url, that's also a problem, as the resulting page \"replaces\" my .NET shell.</p>\n\n<p>What I need it to do, is take any URLs that are inside that ContentResult I returned, and if any of those URLs are clicked, pass them back to my .NET application, to be downloaded by the WebClient, and rendered back in that shell.</p>\n\n<p>I'm aware I could use an IFRAME to do this instead of WebClient, but an IFRAME is impossible in my case, as its restricted by the public API we're consuming, its restricted/has flaws in the framework that API is servicing, and its blocked on some of our client machines, which we have no control over.</p>\n\n<p>Also, the client machines will be off our network, so I can't use an AJAX load, as that'd be XSS.</p>\n\n<p>One idea that I can think of, is basically to create custom routes, with filters/rules, that look for \"CNN\" like links, and pass them to my controller, as a parameter; then have my controller render my page, and pass those links to the web client.</p>\n\n<p>This would obviously be a lot of work, and not even really sure where to start with it in the routing engine.</p>\n\n<p>The only other thing I can think of that might work, is checking the validity of the URL, by attempting to see if it points to a valid link. If it doesn't point to a valid link, adding CNN's url prefix to it, and seeing if that is then a valid link. But that seems like a lot of work, for a solution that would be a heavy hit on performance, as checking each link on a page like CNN, could be very costly. Also, since I'd be running each link twice, that'd be a problem where POST operations were required, as it'd essentially run each operation twice, and being that this is a public API I'm consuming off a public framework, I wouldn't have control of the source code to safeguard against that.</p>\n\n<p>Any other suggestions?\nIs there any way to accomplish what I'm trying to do easily?</p>\n"},{"tags":["c#","visual-studio-2010","intellisense"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":97,"score":2,"question_id":9181890,"title":"Intellisense Issues in strings and methods/members","body":"<p>While coding in C# for Visual Studio 2010, I've noticed, that for some reason, after creating a delegate method, or using the \"Extract method\" menu option from Visual Studio, my IntelliSense decides it wants to go overboard. It starts activating inside a string, trying to complete stuff from outside (for instance, if I type \"To be continued...\" as I start to type continued, it suggests \"const\" as an option, thinking I'm still coding, and not recognizing I'm in a string.</p>\n\n<p>Also, when it starts doing the above, it also starts doing stuff like suggesting a while loop, while trying to do a Debug.WriteLine, and the Debug class has no members listed in the IntelliSense popup window, all it lists is base classes for my current namespaces.</p>\n\n<p>Now if I push <kbd>ctrl</kbd> <kbd>space</kbd> manually, I get the proper intellisense options.</p>\n\n<p>Sometimes, closing all open files, and reopening them fixes it; sometimes I have to completely close visual studio and reopen it to fix it.</p>\n\n<p>Is anyone else experiencing similar issues, or know of any fixes to the issue?</p>\n"},{"tags":["c#","mono","monodevelop"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":99,"score":2,"question_id":10766998,"title":"MonoDevelop Addin: how to set the CopyToOutput build option in the \"xpt.xml\" file","body":"<p>I was wonder how you set the \"Copy to output directory\" option to \"copy if newer\" when making MonoDevelop Addins for new project types??</p>\n\n<p>Take this block of code for example, ... what do I need to add to get the \"manifest.json\" to copy to the output directory at build time?</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;Template originator = \"Andrew Witte\"&gt;\n\n    &lt;TemplateConfiguration&gt;\n        &lt;_Name&gt;MonoNaCl Project&lt;/_Name&gt;\n        &lt;_Category&gt;C#/MonoNaCl&lt;/_Category&gt;\n        &lt;LanguageName&gt;C#&lt;/LanguageName&gt;\n        &lt;_Description&gt;Creates a MonoNaCl project.&lt;/_Description&gt;\n    &lt;/TemplateConfiguration&gt;\n\n    &lt;!-- Actions --&gt;\n    &lt;Actions&gt;\n        &lt;Open filename = \"Internal.c\"/&gt;\n        &lt;Open filename = \"Main.cs\"/&gt;\n    &lt;/Actions&gt;\n\n    &lt;Combine name = \"${ProjectName}\" directory = \".\"&gt;\n        &lt;Options&gt;\n            &lt;StartupProject&gt;${ProjectName}&lt;/StartupProject&gt;\n        &lt;/Options&gt;\n        &lt;References&gt;\n            &lt;Reference type=\"Gac\" refto=\"System\" /&gt;\n        &lt;/References&gt;\n        &lt;Project name = \"${ProjectName}\" directory = \".\" type = \"MonoNaCl\"&gt;\n            &lt;Options Target = \"Exe\"/&gt;\n            &lt;Files&gt;\n&lt;File name=\"manifest.json\"&gt;\n&lt;![CDATA[{\n\"name\": \"MonoNaCl\",\n  \"description\": \"Mono for NaCl project.\",\n  \"version\": \"1.0.0\",\n  \"icons\": {\n  },\n  \"requirements\": {\n    \"3D\": {\n      \"features\": [\"css3d\", \"webgl\"]\n    }\n  },\n  \"app\": {\n    \"launch\": {\n      \"local_path\": \"${ProjectName}.html\"\n    }\n}\n}\n]]&gt;&lt;/File&gt;\n&lt;/Files&gt;\n        &lt;/Project&gt;\n    &lt;/Combine&gt;\n&lt;/Template&gt;\n</code></pre>\n"},{"tags":["c#","vb.net","operator-overloading","operator-keyword"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":75,"score":4,"question_id":13259162,"title":"VB.Net Power operator (^) overloading from C#","body":"<p>I am writing a C# class that is exposed to VB.Net. I would like to overload the vb.net <code>^</code> operator so that I can write:</p>\n\n<pre><code>Dim c as MyClass\nSet c = New ...\nDim d as MyClass\nSet d = c^2\n</code></pre>\n\n<p>In C#, the <code>^</code> operator is the <code>xor</code> operator and the power operator doesn't exist. Is there a way I can do this anyway?</p>\n"},{"tags":["c#","asp.net","postback"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1627,"score":4,"question_id":9136510,"title":"ASP.NET postback from wrong dropdownlist after using browser Back button","body":"<p>I've got an ASP.NET 2.0 web application that is partly navigated by using <code>DropDownList</code> controls.  When one of them is changed, it causes a postback, which is then redirected to another URL depending on what was chosen in the dropdown.</p>\n\n<p>I've noticed strange behavior when using the browser's Back button after using the dropdowns.  The procedure is this:</p>\n\n<ol>\n<li>Make a selection in one of the dropdowns, causing a postback and redirect.  Good so far.</li>\n<li>Click the browser's Back button.</li>\n<li>In another navigation dropdown <b>below the one used before</b> (they're all contained in one <code>div</code>), make a selection.  The page redirects to the same URL as the first time, not what it should redirect to based on this other dropdown.</li>\n</ol>\n\n<p>I've tried this in both Firefox 10 and IE9 and seen the same thing.  I looked at the Net tab in Firebug and saw that in the POST for step 3, the correct control is referenced.  But when I debug it, the event handler for the wrong dropdown (the one used in step 1) fires.</p>\n\n<p>The code is pretty simple and straightforward.  Example of markup:</p>\n\n<pre><code>&lt;asp:DropDownList runat=\"server\" ID=\"ddlTest\" AutoPostBack=\"true\" /&gt;\n</code></pre>\n\n<p>The dropdowns actually aren't plain <code>&lt;asp:DropDownList ... /&gt;</code> elements; I'm inserting <code>optgroup</code> elements with an approach similar to <a href=\"http://www.codeproject.com/Articles/15505/ASP-NET-DropDownList-with-OptionGroup-support\" rel=\"nofollow\">this</a>.</p>\n\n<p>Example of C#:</p>\n\n<pre><code>ddlTest.Click += new EventHandler(ddlTest_SelectedIndexChanged);\n</code></pre>\n\n<p>And in <code>ddlTest_SelectedIndexChanged</code>:</p>\n\n<pre><code>if (ddlTest.SelectedValue != \"\")\n{\n   Response.Redirect(MyUtilClass.GetUrl(ddlTest.SelectedValue));\n}\n</code></pre>\n\n<p>What's going on here?</p>\n\n<p><b>UPDATE 2/6/2012</b>: I've fixed this by checking for the content of <code>Request[\"__EVENTTARGET\"]</code> in my <code>SelectedIndexChanged</code> event handlers.  I'm still curious why it happens, though.  Why is the first event repeated?  And why does it only happen when the second postback happens from a control below the first one?</p>\n"},{"tags":["c#","regex","string"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":68,"score":0,"question_id":13259723,"title":"Extracting value from string","body":"<p>I've got problem with extracting a string from a html code (that's basically problem with regex expression).\nHere's the code:</p>\n\n<pre><code>string wheretosearch = @\"\n&lt;td class=\"\"name\"\"&gt;\n&lt;div&gt;\n&lt;a href=\"\"/addr1.html\"\" class=\"\"link \"\"&gt;\n&lt;span&gt;Title1&lt;/span&gt;\n&lt;/a&gt;&lt;/td&gt;\n\n[some code]\n\n&lt;td class=\"\"name\"\"&gt;\n&lt;div&gt;\n&lt;a href=\"\"/addr2.html\"\" class=\"\"link \"\"&gt;\n&lt;span&gt;Title2&lt;/span&gt;\n&lt;/a&gt;&lt;/td&gt;\";\n</code></pre>\n\n<p>I want to extract titles between  tags. What my problem is that I cannot put the unknown number of chars in regex (.* section after td class=\"\"name\"\"  ):</p>\n\n<pre><code>&lt;td class=\"\"name\"\"&gt;.*&lt;span&gt;(?&lt;title&gt;.*)&lt;/span&gt;\n</code></pre>\n\n<p>To put things simply: I want regex to find <code>&lt;td class=\"\"name\"\"&gt;</code> and then after unknown number of characters find first occurrence of <code>&lt;span&gt;</code> and then take the value between that first <code>&lt;span&gt;</code> and <code>&lt;/span&gt;</code>.</p>\n\n<p>What it actually does it takes the last occurrence of <code>&lt;span&gt;</code> and gives the last title only.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Okay, besides the HTML issue, the problem is like:\nI've got string:</p>\n\n<p><em>\"This is a text: NICE. This is a great text: NICE TOO.\"</em></p>\n\n<p>I would like to take \"This\" then unknown number of characters, then string between \": \" and \".\" How this could be done?</p>\n\n<p>Of course I'm interested in each occurance of that complex expression, so the output would be \"NICE\" and \"NICE TOO\" in collection. </p>\n\n<p>For my expression  like <code>\"This.*(?&lt;title&gt;.*).\"</code> i get only the \"NICE TOO\" string, as @urlreader mentioned, it finds the max length matched string.</p>\n"},{"tags":["c#",".net","uri"],"answer_count":4,"favorite_count":1,"up_vote_count":14,"down_vote_count":0,"view_count":8084,"score":14,"question_id":2884551,"title":"Get individual query parameters from Uri","body":"<p>I have a uri string like: <a href=\"http://example.com/file?a=1&amp;b=2&amp;c=string%20param\">http://example.com/file?a=1&amp;b=2&amp;c=string%20param</a></p>\n\n<p>Is there an existing function that would convert query parameter string into a dictionary same way as ASP.NET Context.Request does it.</p>\n\n<p>I'm writing a console app and not a web-service so there is no Context.Request to parse the URL for me.</p>\n\n<p>I know that it's pretty easy to crack the query string myself but I'd rather use a FCL function is if exists.</p>\n"},{"tags":["c#","asp.net","gridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13257173,"title":"selected value of dropdown list not changing in template field","body":"<p>I have a dropdown list in a template field that has it's selected value on load set to another field in the gridview. In the rowupdating event the dropdown goes back to the initial selected value and does not retain the new value. I have the method that fills the grid wrapped in a if this.page.IsPostBack on the page_load event. How do I bind the control's new selected value during rowupdating event and ignore it's initial databind?? </p>\n\n<p>I have the auto post back property set to true as well. </p>\n\n<p>Here is the rowupdating event ( I am actually inserting into a different table NOT updating this grid)</p>\n\n<pre><code>protected void grd_add_bins__RowUpdating(object sender, GridViewUpdateEventArgs e)\n        {\n            GridViewRow row = (GridViewRow)grd_add_bins.Rows[e.RowIndex];\n            //int id = Int32.Parse(grdBins.DataKeys[e.RowIndex].Value.ToString());\n\n            Label room1 = (Label)row.FindControl(\"grd_add_room\");\n            Label grower1 = (Label)row.FindControl(\"grd_add_grower_id\");\n            TextBox bins1 = (TextBox)row.FindControl(\"grd_add_txtbins_to_pack\");\n            DropDownList packas1 = (DropDownList)row.FindControl(\"grd_add_ddl_pack_as\");\n            TextBox block1 = (TextBox)row.FindControl(\"grd_add_txt_block\");\n            Label pool1 = (Label)row.FindControl(\"grd_add_pool\");\n\n            SqlCommand cmd = new SqlCommand();\n            cmd.CommandText = \"insert into t_run_schedule_lots  \" +\n                              \"(record_key,room_id,grower_id,block_id,pool_id,total_bins,pack_as) \" +\n                              \"values (@rec_id,@room,@grower,@block,@pool,@bins,@pack_as)\";\n\n            cmd.Parameters.Add(\"@rec_id\", SqlDbType.VarChar).Value = lblRec_key.Text;\n            cmd.Parameters.Add(\"@room\", SqlDbType.VarChar).Value = room1.Text;\n            cmd.Parameters.Add(\"@grower\", SqlDbType.VarChar).Value = grower1.Text;\n            cmd.Parameters.Add(\"@bins\", SqlDbType.Int).Value = Convert.ToInt32(bins1.Text);\n            cmd.Parameters.Add(\"@pack_as\", SqlDbType.VarChar).Value = packas1.Text;\n            cmd.Parameters.Add(\"@block\", SqlDbType.VarChar).Value = block1.Text;\n            cmd.Parameters.Add(\"@pool\", SqlDbType.VarChar).Value = pool1.Text;\n\n            cmd.CommandType = CommandType.Text;\n            cmd.Connection = this.sqlConnection1;\n            this.sqlConnection1.Open();\n            // execute insert statement\n            cmd.ExecuteNonQuery();\n            this.sqlConnection1.Close();\n\n            fill_grid();&lt;-- fills other grid that shows the result of the insert\n            fill_bins_grid();&lt;-- fills this grid\n            //Reset the edit index.\n            grd_add_bins.EditIndex = -1;\n            //Bind data to the GridView control.\n            grd_add_bins.DataBind();\n\n\n\n        }\n</code></pre>\n"},{"tags":["c#","sql","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13257925,"title":"Update the dataset after rows changed","body":"<p>Scenario:</p>\n\n<ol>\n<li>Excel file is read and displayed in datagrid.</li>\n<li>Values in sql server must be updated  if excel values are different.</li>\n<li>Table in Sql server don't have primary key</li>\n</ol>\n\n<p>After all these steps, when I am about to update the table, it throws the error saying \"Update requires a valid UpdateCommand when passed DataRow collection with modified rows.\" </p>\n\n<p>There is no primary key. So I need to use update command. BUt how and what would be in update command? importdata is dictionary where data from excel are stored. PLz help!!! What should I do now? I have No idea....</p>\n\n<pre><code>foreach (DataColumn column in ds.Tables[0].Columns)\n{\n    string fieldName = column.ColumnName;\n    string fieldNameValueE = string.Empty;\n    if (importdata.ContainsKey(fieldName))\n    {\n        fieldNameValueE = importdata[fieldName];\n        foreach (DataRow dr in ds.Tables[0].Rows)\n        {\n            string fieldNameValueD = dr[fieldName].ToString();\n            if (fieldNameValueD != fieldNameValueE)\n            {\n                dr[fieldName] = fieldNameValueE;\n\n            }\n        }\n\n    }\n\n}\n\nda.Update(ds);\nconnection.Close();    \n</code></pre>\n"},{"tags":["c#"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":13259533,"title":"Is there a better way to split an array into a string","body":"<p>I am trying to pass an Array to a method and then return a string I can use for a SQL WHERE clause.  I have the following and it works just fine.  But is there a better way?  I am looking for one of the two results;</p>\n\n<ol>\n<li><code>WHERE (ColumnName IN (12, 34, 56, 78, 90))</code></li>\n<li><code>WHERE (ColumnName IN ('12', '34', '56', '78', '90'))</code></li>\n</ol>\n\n<hr/>\n\n<pre><code>    public static string setInSearchFilter(string psSearchFilter, string psColumnName, \n        string[] paObjectValues, bool pbIsString)\n    {\n        string lsDelimiter = \"'\", lsRetVal = string.Empty, lsObjectValues = string.Empty;\n\n        if (!pbIsString)\n        {\n            lsDelimiter = string.Empty;\n        }\n\n        if (!string.IsNullOrEmpty(psSearchFilter))\n        {\n            lsRetVal = psSearchFilter + \" AND \";\n        }\n\n        for (int i = 0; i &lt;= paObjectValues.GetUpperBound(0); i++)\n        {\n            lsObjectValues += lsDelimiter + paObjectValues[i] + lsDelimiter;\n\n            if (i &lt; paObjectValues.GetUpperBound(0))\n            {\n                lsObjectValues += \", \";\n            }\n        }\n\n        return lsRetVal += \"(\" + psColumnName + \" IN (\" + lsObjectValues + \"))\";\n    }\n</code></pre>\n"},{"tags":["c#","deserialization","datacontract","datamember"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13259840,"title":"Why do I need to specify [DataMember(IsRequired=false)] on a property of a Class when it is contained in a list by a parent Class?","body":"<p>I have a class MyClass that has a list of another class MyOtherClass</p>\n\n<pre><code>[Serializable]\n[DataContract(Namespace = \"\")]\npublic class MyClass\n{\n    public string Something { get; set; }\n    public Guid SomethingElse { get; set; }\n    [DataMember]\n    public string Name { get; set; }\n    [DataMember]\n    public List&lt;MyOtherClass&gt; Things { get; set; }\n</code></pre>\n\n<p>}</p>\n\n<p>In this example, Name and Things are expected to be set in the incoming Json. The props without a DataMember attribute are allowed to be ignored.</p>\n\n<pre><code>{\"Things\":[{\"Value\":\"$$$\",\"Id\":\"8836C0C2-EDB2-4A8A-ACCB-44EC7C566551\"},{\"Value\":\"qwerty\",\"Id\":\"AF987F24-6EBC-4D3B-A48A-DCE5FF1A660F\"},{\"Value\":\"asdf\",\"Id\":\"226CECC6-BE9C-4D14-B355-F52D414FCD97\"}],\"Name\":\"poi\"}\n</code></pre>\n\n<p>I also wanted the same sort of behaviour in MyOtherClass</p>\n\n<pre><code>[Serializable]\n[DataContract(Namespace = \"\")]\npublic class MyOtherClass\n{\n    [DataMember(IsRequired = true)]\n    public Guid Id { get; set; }\n    [DataMember(IsRequired = false)]\n    public String Description { get; set; }\n    [DataMember(IsRequired = true)]\n    public string Value { get; set; }\n}\n</code></pre>\n\n<p>But I found if I didn't specify a DataMember attribute on the properties I wasn't requiring, in this case Description, I would get a DataContract de-serialization error stating that no value was provided for Description.</p>\n\n<p>Deserialization is not as strict for the parent class, which doesn't give out errors for missing values when DataMember is not attached.</p>\n\n<p>So as depicted in my example, I had to attach DataMemeber to each property of MyOtherClass and explicitly specify IsRequired=false for properties that aren't necessary.</p>\n\n<p>Why can't I just forgo the DataMemeber attribute?</p>\n"},{"tags":["c#","rally"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13241881,"title":"Rally API: Adding Users to a Project","body":"<p>I'm new to the Rally world and am struggling through how to use the RallyRestAPI. There are a number of examples of how to query Rally to get back pertinent information that I have found most helpful. What I'm trying to do is create a C# command line tool to add users to a project. It appears that I use the RallyRestAPI.Create(\"projectpermission\",some dynamic json object) interface to accomplish the creation. My problem is understanding the \"some dynamic json object\" part. I'm not sure how to correctly set it up. If someone has a small example of how to set it up, I would appreciate it.</p>\n"},{"tags":["c#","javascript","ajax","mvc","web-api"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13259774,"title":"How can I debug a 500 Internal Server Error when calling a WebApi from ajax?","body":"<p>I am receiving a 500 Internal Server Error in a MVC 4.5 WebApi project.  I can successfully call my webservice with a GET and a GET with an Id.  But, when I POST a file I am getting the error.  I can set a breakpoint in <code>Application_BeginRequest()</code> and confirm that I am receiving first an OPTIONS request and then the POST.  The method in the controller is not getting called and I have added an <code>Application_Error()</code> method to Global.asax.cs that does not get hit either.  The html page is doing a CORS but I have already handled that using <a href=\"http://nuget.org/packages/Thinktecture.IdentityModel\" rel=\"nofollow\">ThinkTecture.IdentityModel</a>.  I am following the code <a href=\"http://stackoverflow.com/questions/5392344/sending-multipart-formdata-with-jquery-ajax\">here</a> for the file upload.</p>\n\n<p>Any ideas?</p>\n\n<p>Here is the client code:</p>\n\n<pre><code>    &lt;script type=\"text/javascript\"&gt;\n        var UploadDocument = function () {\n            var url = sessionStorage.getItem(\"url\");\n            var auth = sessionStorage.getItem(\"auth\");\n            var data = new FormData();\n\n            jQuery.each($('#fileToUpload')[0].files, function (i, file) {\n                data.append('file-' + i, file);\n            });\n\n            jQuery.support.cors = true;\n            $.ajax({\n                type: \"POST\",\n                url: url,\n                data: data,\n                cache: false,\n                processData: false,\n                contentType: false,\n                //dataType: \"json\",\n                headers: { Authorization: 'Basic ' + auth },\n                crossDomain: true,\n                success: function (data, textStatus, jqXHR) {\n                    alert('Success');\n                },\n                error: function (jqXHR, textStatus, errorThrown) { alert('Error: ' + textStatus + ' ' + errorThrown.message); }\n            });\n        };\n\n    &lt;/script&gt;\n</code></pre>\n\n<p>My controller code looks like this:</p>\n\n<pre><code>    public int Post(HttpPostedFileBase FileToUpload)\n    {\n        // Do stuff with the file\n    }\n</code></pre>\n\n<p>The request and response look like this:</p>\n\n<pre><code>Request URL:http://localhost:51234/api/TaxDocument\nRequest Method:POST\nStatus Code:500 Internal Server Error\n\nRequest Headers\nAccept:*/*\nAccept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3\nAccept-Encoding:gzip,deflate,sdch\nAccept-Language:en-US,en;q=0.8\nAuthorization:Basic YmNhbGxlbjpuZWxsYWM=\nConnection:keep-alive\nContent-Length:2054044\nContent-Type:multipart/form-data; boundary=----WebKitFormBoundaryIGzPKhvRVwFXbupu\nHost:localhost:51234\nOrigin:http://localhost:52386\nReferer:http://localhost:52386/Upload.html\nUser-Agent:Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.4 (KHTML, like Gecko) Chrome/22.0.1229.94 Safari/537.4\n\nResponse Headers:\nAccess-Control-Allow-Credentials:true\nAccess-Control-Allow-Origin:http://localhost:52386\nCache-Control:no-cache\nContent-Length:1133\nContent-Type:application/json; charset=utf-8\nDate:Tue, 06 Nov 2012 21:10:23 GMT\nExpires:-1\nPragma:no-cache\nServer:Microsoft-IIS/8.0\nX-AspNet-Version:4.0.30319\nX-Powered-By:ASP.NET\nX-SourceFiles:=?UTF-8?B?QzpccHJvamVjdHNcU2F2ZU15VzJcU2F2ZU15VzIuV2Vic2VydmljZVxhcGlcVGF4RG9jdW1lbnQ=?=\n</code></pre>\n"},{"tags":["c#","sql-server-2008","iis","iis7","iis-7.5"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13154836,"title":"One application pool keeps hanging IIS 7","body":"<p>For some reason my application pool keeps crashing once in a couple of days. The biggest problem is that there are no logs about errors or warnings in my administrative events about this pool. (there are several warnings in other pools, but it is only this pool that keeps crashing). Changes I make can only be tested if they worked if I wait a couple of days.</p>\n\n<p>I tried to bring my code back to the stage where the problems did not occur, but this does not seem to help.</p>\n\n<p>Most crashes happen when the site is not very busy, although not that inactive that IIS shuts it down for inactivity.</p>\n\n<p>Windows server 2008 R2 (SP 1),\nIIS Build 7.5.76,\nUmbraco,\nSql server 2008</p>\n\n<p>IIS logs: only showing some recycling of the pool (once every 3 hours)\nRapid fail detection: disabled</p>\n\n<p>Where should I start with solving this problem?</p>\n"},{"tags":["c#","neo4jclient"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":64,"score":2,"question_id":12884172,"title":"Neo4jClient C# How to get all nodes","body":"<p>I am using Neo4jClient and Neo4j graph database in C# and I am wondering how I can retrieve all nodes with Neo4jClient.</p>\n\n<p>Here is the cypher query to retrieve all nodes which have a relationship to \"KNOWS\" independently of the relationship direction :</p>\n\n<pre><code>start n =node(*) match n-[r:KNOWS]-(friend) return friend;\n</code></pre>\n\n<p>And here is the C# code with Neo4jClient :</p>\n\n<pre><code>var client = new GraphClient(new Uri(\"http://localhost:7474/db/data\"));\nclient.Connect();\n\nvar cypherFluentQueryReturned = client.RootNode\n                .StartCypher(\"n\")\n                .Match(\"n-[:KNOWS]-&gt;friend\")\n                .Return&lt;Node&lt;Person&gt;&gt;(\"friend\");\n</code></pre>\n\n<p>However Neo4jClient doesn't allow to retrieve all nodes from * but only from a start point, here the root node.<br>\nHow can I say with Neo4jClient to retrieve all nodes and not only nodes attached to root node?</p>\n\n<p>It seems there is no way to query nodes from * through Neo4jClient.GraphClient.</p>\n\n<p>However I can do that by executing a query with RawGraphClient :</p>\n\n<pre><code>CypherQuery query = new CypherQuery(\"start n=node(*) match n-[KNOWS]-(person) return person\", new Dictionary&lt;string, object&gt;(), CypherResultMode.Set);\nvar persons = ((IRawGraphClient)client).ExecuteGetCypherResults&lt;Person&gt;(query).ToList();\n</code></pre>\n"},{"tags":["c#","math","overflow","checked"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":73,"score":1,"question_id":13259408,"title":"Why doesn't C# use arithmetic overflow checking by default?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/103654/why-dont-languages-raise-errors-on-integer-overflow-by-default\">Why don’t languages raise errors on integer overflow by default?</a>  </p>\n</blockquote>\n\n\n\n<p><strong>Why doesn't C# use arithmetic overflow checking by default?</strong></p>\n\n<p>I figure that it would generally be better to have exceptions occur when this occurs so that errors aren't obscured. I know that it's occasionally useful to take advantage of the 'wrapping' behaviour that occurs, but the <code>unchecked</code> keyword could be used in these circumstances to make the intentions explicit.</p>\n\n<p>I expect that this decision was made intentionally, perhaps to increase compatibility with other C-based languages.</p>\n"},{"tags":["c#","asp.net","vb.net","visual-studio","webforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13259505,"title":"How to preserve user input in literal control on postback?","body":"<p>On Page_Init, if is post back, I check if a button called Button1 was clicked, if so I add a LiteralControl to a Panel called Panel1:</p>\n\n<pre><code>Panel1.Controls.Add(new LiteralControl(\"Enter Code:&lt;input type=\\\"text\\\" name=\\\"txtCode\\\"&gt;&lt;/td&gt;\"));  \n</code></pre>\n\n<p>As you can see, it is just the text \"Enter Code:\" followed by a TextBox called txtCode.</p>\n\n<p>I have a second button (Button2) that, when clicked, I would like to retrieve the text entered in txtCode:</p>\n\n<pre><code>protected void Button2_Click(object sender, EventArgs e)\n    {\n        foreach (Control c in Panel1.Controls)\n        {\n            if (c is LiteralControl) ...                \n        }\n    }\n</code></pre>\n\n<p>I'm not sure how to do this... How can I get the text entered in txtCode?</p>\n"}]}
